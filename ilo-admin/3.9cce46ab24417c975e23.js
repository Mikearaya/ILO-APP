(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"5z4G":function(e,t,i){"use strict";i.d(t,"a",function(){return a}),i.d(t,"b",function(){return r});var s=i("LoAr"),a=(i("IfiR"),i("XkFk"),s.nb({encapsulation:2,styles:[],data:{}}));function r(e){return s.Eb(2,[],null,null)}},"6E1o":function(e,t,i){"use strict";i.d(t,"a",function(){return s});var s=function(){return function(){}}()},XkFk:function(e,t,i){"use strict";var s=i("D57K"),a=i("Riy9"),r=i("HknC"),o=i("fKhW"),l="e-upload-file-list",n="e-file-status",c="e-file-remove-btn",u="e-file-delete-btn",h="e-file-abort-btn",p="e-file-reload-btn",d="e-upload-progress-wrap",f="e-upload-progress-bar",b="e-upload-success",m="e-upload-fails",y="e-file-pause-btn",g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.c)(t,e),Object(s.b)([Object(r.q)("")],t.prototype,"name",void 0),Object(s.b)([Object(r.q)(null)],t.prototype,"size",void 0),Object(s.b)([Object(r.q)("")],t.prototype,"type",void 0),t}(r.e),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.c)(t,e),Object(s.b)([Object(r.q)("Browse...")],t.prototype,"browse",void 0),Object(s.b)([Object(r.q)("Upload")],t.prototype,"upload",void 0),Object(s.b)([Object(r.q)("Clear")],t.prototype,"clear",void 0),t}(r.e),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.c)(t,e),Object(s.b)([Object(r.q)("")],t.prototype,"saveUrl",void 0),Object(s.b)([Object(r.q)("")],t.prototype,"removeUrl",void 0),Object(s.b)([Object(r.q)(0)],t.prototype,"chunkSize",void 0),Object(s.b)([Object(r.q)(3)],t.prototype,"retryCount",void 0),Object(s.b)([Object(r.q)(500)],t.prototype,"retryAfterDelay",void 0),t}(r.e),S=function(e){function t(t,i){var s=e.call(this,t,i)||this;return s.initialAttr={accept:null,multiple:!1,disabled:!1},s.fileList=[],s.filesData=[],s.uploadedFilesData=[],s.isForm=!1,s.allTypes=!1,s.pausedData=[],s.uploadMetaData=[],s.tabIndex="0",s.btnTabIndex="0",s.disableKeyboardNavigation=!1,s.count=-1,s.actionCompleteCount=0,s.flag=!0,s.selectedFiles=[],s}return Object(s.c)(t,e),t.prototype.onPropertyChanged=function(e,t){for(var i=0,s=Object.keys(e);i<s.length;i++)switch(s[i]){case"allowedExtensions":this.setExtensions(this.allowedExtensions),this.clearAll();break;case"enabled":this.setControlStatus();break;case"multiple":this.setMultipleSelection();break;case"enableRtl":this.setRTL(),this.reRenderFileList();break;case"buttons":this.buttons.browse=Object(r.M)(this.buttons.browse)?"":this.buttons.browse,this.buttons.clear=Object(r.M)(this.buttons.clear)?"":this.buttons.clear,this.buttons.upload=Object(r.M)(this.buttons.upload)?"":this.buttons.upload,this.renderButtonTemplates();break;case"dropArea":this.unBindDropEvents(),this.setDropArea();break;case"files":this.renderPreLoadFiles();break;case"directoryUpload":this.updateDirectoryAttributes();break;case"minFileSize":case"maxFileSize":case"template":case"autoUpload":case"sequentialUpload":this.clearAll();break;case"locale":this.l10n.setLocale(this.locale),this.setLocalizedTexts(),this.preLocaleObj=Object(r.L)("currentLocale",this.l10n);break;case"cssClass":this.setCSSClass(t.cssClass)}},t.prototype.setLocalizedTexts=function(){Object(r.M)(this.template)&&("string"==typeof this.buttons.browse&&(this.browseButton.innerText="Browse..."===this.buttons.browse?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.innerText),this.uploadWrapper.querySelector(".e-file-drop").innerHTML=this.localizedTexts("dropFilesHint")),this.updateFileList())},t.prototype.getKeyValue=function(e){for(var t,i=0,s=Object.keys(this.preLocaleObj);i<s.length;i++){var a=s[i];this.preLocaleObj[a]===e&&(t=a)}return t},t.prototype.updateFileList=function(){if(this.fileList.length>0&&!Object(r.M)(this.uploadWrapper.querySelector(".e-upload-files")))for(var e=0;e<this.fileList.length;e++)this.fileList[e].querySelector(".e-file-status").innerHTML=this.localizedTexts(this.getKeyValue(this.filesData[e].status)),this.filesData[e].status=this.localizedTexts(this.getKeyValue(this.filesData[e].status)),this.fileList[e].classList.contains(b)&&this.fileList[e].querySelector(".e-icons").setAttribute("title",this.localizedTexts("delete")),this.fileList[e].querySelector(".e-file-play-btn")&&this.fileList[e].querySelector(".e-icons").setAttribute("title",this.localizedTexts("resume")),this.fileList[e].querySelector(".e-file-remove-btn")&&this.fileList[e].querySelector(".e-icons").setAttribute("title",this.localizedTexts("remove")),this.fileList[e].querySelector(".e-file-reload-btn")&&this.fileList[e].querySelector(".e-icons").setAttribute("title",this.localizedTexts("retry")),this.autoUpload||(this.uploadButton.innerText="Upload"===this.buttons.upload?this.localizedTexts("Upload"):this.buttons.upload,this.uploadButton.setAttribute("title",this.localizedTexts("Upload")),this.clearButton.innerText="Clear"===this.buttons.clear?this.localizedTexts("Clear"):this.buttons.clear,this.clearButton.setAttribute("title",this.localizedTexts("Clear")))},t.prototype.reRenderFileList=function(){this.listParent&&(Object(r.C)(this.listParent),this.listParent=null,this.fileList=[],this.createFileList(this.filesData),this.actionButtons&&(this.removeActionButtons(),this.renderActionButtons(),this.checkActionButtonStatus()))},t.prototype.preRender=function(){this.cloneElement=this.element.cloneNode(!0),this.localeText={Browse:"Browse...",Clear:"Clear",Upload:"Upload",dropFilesHint:"Or drop files here",invalidMaxFileSize:"File size is too large",invalidMinFileSize:"File size is too small",invalidFileType:"File type is not allowed",uploadFailedMessage:"File failed to upload",uploadSuccessMessage:"File uploaded successfully",removedSuccessMessage:"File removed successfully",removedFailedMessage:"Unable to remove file",inProgress:"Uploading",readyToUploadMessage:"Ready to upload",abort:"Abort",remove:"Remove",cancel:"Cancel",delete:"Delete file",pauseUpload:"File upload paused",pause:"Pause",resume:"Resume",retry:"Retry",fileUploadCancel:"File upload canceled"},this.l10n=new r.o("uploader",this.localeText,this.locale),this.preLocaleObj=Object(r.L)("currentLocale",this.l10n),this.checkHTMLAttributes();var e=this.element.parentElement;if(!Object(r.M)(e))for(;e&&e!==document.documentElement;e=e.parentElement)"FORM"===e.tagName&&(this.isForm=!0,this.formElement=e,e.setAttribute("enctype","multipart/form-data"),e.setAttribute("encoding","multipart/form-data"));var t=Object(r.L)("ej2_instances",this.element);if("EJS-UPLOADER"===this.element.tagName){for(var i=this.createElement("input",{attrs:{type:"file"}}),s=0;s<this.element.attributes.length;s++)i.setAttribute(this.element.attributes[s].nodeName,this.element.attributes[s].nodeValue),i.innerHTML=this.element.innerHTML;i.hasAttribute("name")||i.setAttribute("name","UploadFiles"),this.element.appendChild(i),this.element=i,Object(r.eb)("ej2_instances",t,this.element)}t[0].isPureReactComponent&&(Object(r.M)(t[0].props.name)?!Object(r.M)(t[0].props.id)&&Object(r.M)(t[0].props.name)?this.element.setAttribute("name",t[0].props.id):this.element.setAttribute("name","UploadFiles"):this.element.setAttribute("name",t[0].props.name)),Object(r.M)(this.element.getAttribute("name"))&&this.element.setAttribute("name",this.element.getAttribute("id")),this.element.hasAttribute("type")||this.element.setAttribute("type","file"),this.updateDirectoryAttributes(),this.keyConfigs={enter:"enter"},this.element.hasAttribute("tabindex")&&(this.tabIndex=this.element.getAttribute("tabindex"))},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.getModuleName=function(){return"uploader"},t.prototype.updateDirectoryAttributes=function(){this.directoryUpload?(this.element.setAttribute("directory","true"),this.element.setAttribute("webkitdirectory","true")):(this.element.removeAttribute("directory"),this.element.removeAttribute("webkitdirectory"))},t.prototype.render=function(){this.renderBrowseButton(),this.initializeUpload(),this.wireEvents(),this.setMultipleSelection(),this.setExtensions(this.allowedExtensions),this.setRTL(),this.renderPreLoadFiles(),this.setControlStatus(),this.setCSSClass()},t.prototype.renderBrowseButton=function(){this.browseButton=this.createElement("button",{className:"e-css e-btn",attrs:{type:"button"}}),this.browseButton.setAttribute("tabindex",this.tabIndex),"string"==typeof this.buttons.browse?(this.browseButton.innerText="Browse..."===this.buttons.browse?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.innerText)):this.browseButton.appendChild(this.buttons.browse),this.element.setAttribute("aria-label","Uploader")},t.prototype.renderActionButtons=function(){this.element.setAttribute("tabindex","-1"),this.actionButtons=this.createElement("div",{className:"e-upload-actions"}),this.uploadButton=this.createElement("button",{className:"e-file-upload-btn e-css e-btn e-flat e-primary",attrs:{type:"button",tabindex:this.btnTabIndex}}),this.clearButton=this.createElement("button",{className:"e-file-clear-btn e-css e-btn e-flat",attrs:{type:"button",tabindex:this.btnTabIndex}}),this.actionButtons.appendChild(this.clearButton),this.actionButtons.appendChild(this.uploadButton),this.renderButtonTemplates(),this.uploadWrapper.appendChild(this.actionButtons),this.browseButton.blur(),this.uploadButton.focus(),this.wireActionButtonEvents()},t.prototype.wireActionButtonEvents=function(){r.l.add(this.uploadButton,"click",this.uploadButtonClick,this),r.l.add(this.clearButton,"click",this.clearButtonClick,this)},t.prototype.unwireActionButtonEvents=function(){r.l.remove(this.uploadButton,"click",this.uploadButtonClick),r.l.remove(this.clearButton,"click",this.clearButtonClick)},t.prototype.removeActionButtons=function(){this.actionButtons&&(this.unwireActionButtonEvents(),Object(r.C)(this.actionButtons),this.actionButtons=null)},t.prototype.renderButtonTemplates=function(){var e,t;"string"==typeof this.buttons.browse?(this.browseButton.innerText="Browse..."===this.buttons.browse?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.innerText)):(this.browseButton.innerHTML="",this.browseButton.appendChild(this.buttons.browse)),this.uploadButton&&(e=Object(r.M)(this.buttons.upload)?"Upload":this.buttons.upload,this.buttons.upload=e,"string"==typeof this.buttons.upload?(this.uploadButton.innerText="Upload"===this.buttons.upload?this.localizedTexts("Upload"):this.buttons.upload,this.uploadButton.setAttribute("title",this.uploadButton.innerText)):(this.uploadButton.innerHTML="",this.uploadButton.appendChild(this.buttons.upload))),this.clearButton&&(t=Object(r.M)(this.buttons.clear)?"Clear":this.buttons.clear,this.buttons.clear=t,"string"==typeof this.buttons.clear?(this.clearButton.innerText="Clear"===this.buttons.clear?this.localizedTexts("Clear"):this.buttons.clear,this.clearButton.setAttribute("title",this.clearButton.innerText)):(this.clearButton.innerHTML="",this.clearButton.appendChild(this.buttons.clear)))},t.prototype.initializeUpload=function(){this.element.setAttribute("tabindex","-1");var e=this.createElement("span",{className:"e-file-select"});this.element.parentElement.insertBefore(e,this.element),this.dropAreaWrapper=this.createElement("div",{className:"e-file-select-wrap"}),this.element.parentElement.insertBefore(this.dropAreaWrapper,this.element),e.appendChild(this.element),this.dropAreaWrapper.appendChild(this.browseButton),this.dropAreaWrapper.appendChild(e);var t=this.createElement("span",{className:"e-file-drop"});t.innerHTML=this.localizedTexts("dropFilesHint"),this.dropAreaWrapper.appendChild(t),this.uploadWrapper=this.createElement("div",{className:"e-upload",attrs:{"aria-activedescendant":"li-focused"}}),this.dropAreaWrapper.parentElement.insertBefore(this.uploadWrapper,this.dropAreaWrapper),this.uploadWrapper.appendChild(this.dropAreaWrapper),this.setDropArea()},t.prototype.renderPreLoadFiles=function(){if(!Object(r.M)(this.files[0].size)){var e=[].slice.call(this.files),t=[];this.multiple||(this.clearData(),e=[e[0]]);for(var i=0,s=e;i<s.length;i++){var a=s[i],o={name:a.name+"."+a.type.split(".")[a.type.split(".").length-1],rawFile:"",size:a.size,status:this.localizedTexts("uploadSuccessMessage"),type:a.type,validationMessages:{minSize:"",maxSize:""},statusCode:"2"};t.push(o),this.filesData.push(o)}this.createFileList(t),this.autoUpload||!this.listParent||this.actionButtons||this.isForm||!this.showFileList||this.renderActionButtons(),this.checkActionButtonStatus()}},t.prototype.checkActionButtonStatus=function(){if(this.actionButtons){var e=this.uploadWrapper.querySelectorAll(".e-validation-fails").length+this.uploadWrapper.querySelectorAll(".e-upload-fails:not(.e-upload-progress)").length+this.uploadWrapper.querySelectorAll("span."+b).length+this.uploadWrapper.querySelectorAll("span.e-upload-progress").length;e>0&&e===this.uploadWrapper.querySelectorAll("li").length?this.uploadButton.setAttribute("disabled","disabled"):this.uploadButton.removeAttribute("disabled")}},t.prototype.setDropArea=function(){var e=this.dropAreaWrapper.querySelector(".e-file-drop");if(this.dropArea){this.dropZoneElement="string"!=typeof this.dropArea?this.dropArea:document.querySelector(this.dropArea);for(var t=this.element,i=!1;t.parentNode;)(t=t.parentNode)===this.dropZoneElement&&(i=!0,e.textContent=this.localizedTexts("dropFilesHint"));i||(e.textContent="")}else this.dropZoneElement=this.uploadWrapper,e.textContent=this.localizedTexts("dropFilesHint");this.bindDropEvents()},t.prototype.setMultipleSelection=function(){if(this.multiple&&!this.element.hasAttribute("multiple")){var e=document.createAttribute("multiple");this.element.setAttributeNode(e)}else this.multiple||this.element.removeAttribute("multiple")},t.prototype.checkAutoUpload=function(e){this.autoUpload?(this.sequentialUpload?this.sequenceUpload(e):this.upload(e),this.removeActionButtons()):this.actionButtons||this.renderActionButtons(),this.checkActionButtonStatus()},t.prototype.sequenceUpload=function(e){this.filesData.length-e.length!=0&&"1"===this.filesData[this.filesData.length-e.length-1].statusCode||(++this.count,"object"==typeof this.filesData[this.count]?(this.upload(this.filesData[this.count],!this.showFileList),"0"===this.filesData[this.count].statusCode&&this.sequenceUpload(e)):--this.count)},t.prototype.setCSSClass=function(e){this.cssClass&&Object(r.s)([this.uploadWrapper],this.cssClass.split(this.cssClass.indexOf(",")>-1?",":" ")),e&&Object(r.X)([this.uploadWrapper],e.split(" "))},t.prototype.wireEvents=function(){r.l.add(this.browseButton,"click",this.browseButtonClick,this),r.l.add(this.element,"change",this.onSelectFiles,this),r.l.add(document,"click",this.removeFocus,this),this.keyboardModule=new r.n(this.uploadWrapper,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.isForm&&r.l.add(this.formElement,"reset",this.resetForm,this)},t.prototype.unWireEvents=function(){r.l.remove(this.browseButton,"click",this.browseButtonClick),r.l.remove(this.element,"change",this.onSelectFiles),r.l.remove(document,"click",this.removeFocus),this.isForm&&r.l.remove(this.formElement,"reset",this.resetForm),this.keyboardModule.destroy()},t.prototype.resetForm=function(){this.clearAll()},t.prototype.keyActionHandler=function(e){var t=e.target;switch(e.action){case"enter":if(e.target===this.clearButton)this.clearButtonClick();else if(e.target===this.uploadButton)this.uploadButtonClick();else if(e.target===this.browseButton)this.browseButtonClick();else if(t.classList.contains(y))(i=this.getCurrentMetaData(null,e)).file.statusCode="4",i.file.status=this.localizedTexts("pauseUpload"),this.abortUpload(i,!1);else if(t.classList.contains("e-file-play-btn"))this.resumeUpload(this.getCurrentMetaData(null,e),e);else if(t.classList.contains(p)){var i=this.getCurrentMetaData(null,e);if(Object(r.M)(i)){var s=this.filesData[this.fileList.indexOf(e.target.parentElement)];this.retry(s)}else i.file.statusCode="1",i.file.status=this.localizedTexts("readyToUploadMessage"),this.chunkUpload(i.file)}else this.removeFiles(e),t.classList.contains(h)||this.browseButton.focus();e.preventDefault(),e.stopPropagation()}},t.prototype.getCurrentMetaData=function(e,t){var i,s;i=Object(r.M)(e)?this.filesData[this.fileList.indexOf(t.target.parentElement)]:e;for(var a=0;a<this.uploadMetaData.length;a++)this.uploadMetaData[a].file.name===i.name&&(s=this.uploadMetaData[a]);return s},t.prototype.removeFocus=function(){this.uploadWrapper&&this.listParent&&this.listParent.querySelector(".e-clear-icon-focus")&&(document.activeElement.blur(),this.listParent.querySelector(".e-clear-icon-focus").classList.remove("e-clear-icon-focus"))},t.prototype.browseButtonClick=function(){this.element.click()},t.prototype.uploadButtonClick=function(){this.sequentialUpload?this.sequenceUpload(this.filesData):this.upload(this.filesData)},t.prototype.clearButtonClick=function(){this.clearAll(),this.sequentialUpload&&(this.count=-1),this.actionCompleteCount=0},t.prototype.bindDropEvents=function(){this.dropZoneElement&&(r.l.add(this.dropZoneElement,"drop",this.dropElement,this),r.l.add(this.dropZoneElement,"dragover",this.dragHover,this),r.l.add(this.dropZoneElement,"dragleave",this.onDragLeave,this),r.l.add(this.dropZoneElement,"paste",this.onPasteFile,this))},t.prototype.unBindDropEvents=function(){this.dropZoneElement&&(r.l.remove(this.dropZoneElement,"drop",this.dropElement),r.l.remove(this.dropZoneElement,"dragover",this.dragHover),r.l.remove(this.dropZoneElement,"dragleave",this.onDragLeave))},t.prototype.onDragLeave=function(e){this.dropZoneElement.classList.remove("e-upload-drag-hover")},t.prototype.dragHover=function(e){this.enabled&&(this.dropZoneElement.classList.add("e-upload-drag-hover"),e.preventDefault(),e.stopPropagation())},t.prototype.dropElement=function(e){this.dropZoneElement.classList.remove("e-upload-drag-hover"),"chrome"===r.d.info.name?this.element.files=e.dataTransfer.files:this.onSelectFiles(e),e.preventDefault(),e.stopPropagation()},t.prototype.onPasteFile=function(e){var t=e.clipboardData.items;if(1===t.length){var i=[].slice.call(t)[0];"file"===i.kind&&i.type.match("^image/")&&this.renderSelectedFiles(e,[i.getAsFile()],!1,!0)}},t.prototype.removeFiles=function(e){if(this.enabled){var t=this.fileList.indexOf(e.target.parentElement),i=this.fileList[t],s=this.filesData[t];if(!Object(r.M)(s)){if(e.target.classList.contains(h)){if(s.statusCode="5",!Object(r.M)(i)){var a=i.querySelector("."+h);Object(o.a)({target:a,width:"20px"}),Object(o.c)(a)}this.sequentialUpload&&this.uploadSequential(),i.classList.contains("e-restrict-retry")||this.checkActionComplete(!0)}else this.remove(s,!1,!1,e);this.element.value="",this.checkActionButtonStatus()}}},t.prototype.removeFilesData=function(e,t){var i;if(t)this.showFileList||(i=this.filesData.indexOf(e),this.filesData.splice(i,1));else{var s=this.getLiElement(e);Object(r.M)(s)||(Object(r.C)(s),i=this.fileList.indexOf(s),this.fileList.splice(i,1),this.filesData.splice(i,1),0!==this.fileList.length||Object(r.M)(this.listParent)||(Object(r.C)(this.listParent),this.listParent=null,this.removeActionButtons()),this.sequentialUpload&&i<=this.count&&--this.count)}},t.prototype.removeUploadedFile=function(e,t,i,s){var a=this,l=e,n=this.element.getAttribute("name"),h=new r.a(this.asyncSettings.removeUrl,"POST",!0,null);h.emitError=!1;var p=new FormData,d=this.getLiElement(e);h.beforeSend=function(e){var s;(t.currentRequest=h.httpRequest,i||a.trigger("removing",t),t.cancel)?e.cancel=!0:(Object(r.M)(d)||Object(r.M)(d.querySelector("."+u))&&Object(r.M)(d.querySelector("."+c))||(s=d.querySelector("."+u)?d.querySelector("."+u):d.querySelector("."+c),Object(o.a)({target:s,width:"20px"}),Object(o.c)(s)),t.postRawFile&&!Object(r.M)(l.rawFile)&&""!==l.rawFile?p.append(n,l.rawFile):p.append(n,l.name),a.updateFormData(p,t.customFormData))},h.onLoad=function(e){return a.removeCompleted(e,l,s),{}},h.onError=function(e){return a.removeFailed(e,l,s),{}},h.send(p)},t.prototype.updateFormData=function(e,t){if(t.length>0&&t[0])for(var i=function(i){var s=t[i],a=Object.keys(s).map(function(e){return s[e]});e.append(Object.keys(s)[0],a)},s=0;s<t.length;s++)i(s)},t.prototype.removeCompleted=function(e,t,i){var s={e:e,response:e&&e.currentTarget?this.getResponse(e):null,operation:"remove",file:this.updateStatus(t,this.localizedTexts("removedSuccessMessage"),"2")};this.trigger("success",s),this.removeFilesData(t,i);var a=this.uploadedFilesData.indexOf(t);this.uploadedFilesData.splice(a,1),this.trigger("change",{files:this.uploadedFilesData})},t.prototype.removeFailed=function(e,t,i){var s={e:e,response:e&&e.currentTarget?this.getResponse(e):null,operation:"remove",file:this.updateStatus(t,this.localizedTexts("removedFailedMessage"),"0")};if(!i){var a=this.filesData.indexOf(t),l=this.fileList[a];if(l){var c=l.querySelector("."+n);l.classList.remove(b),c.classList.remove(b),l.classList.add(m),c.classList.add(m)}this.checkActionButtonStatus()}this.trigger("failure",s);var h=this.getLiElement(t);if(!Object(r.M)(h)&&!Object(r.M)(h.querySelector("."+u))){var p=h.querySelector("."+u);Object(o.b)(p),Object(r.C)(h.querySelector(".e-spinner-pane"))}},t.prototype.getFilesFromFolder=function(e){var t;if(this.filesEntries=[],this.checkDirectoryUpload(t=this.multiple?e.dataTransfer.items:[e.dataTransfer.items[0]]))for(var i=function(i){var a=t[i].webkitGetAsEntry();if(a.isFile){var r=[];a.file(function(e){r.push({path:a.fullPath,file:e})}),s.renderSelectedFiles(e,r,!0)}else a.isDirectory&&s.traverseFileTree(a,e)},s=this,a=0;a<t.length;a++)i(a)},t.prototype.checkDirectoryUpload=function(e){for(var t=0;t<e.length;t++)if(e[t].webkitGetAsEntry().isDirectory)return!0;return!1},t.prototype.traverseFileTree=function(e,t){var i=this;if("boolean"==typeof e){for(var s=[],a=function(e){r.filesEntries[e].file(function(t){s.push({path:i.filesEntries[e].fullPath,file:t})})},r=this,o=0;o<this.filesEntries.length;o++)a(o);this.renderSelectedFiles(t,s,!0)}else e.isFile?this.filesEntries.push(e):e.isDirectory&&e.createReader().readEntries(function(e){for(var t=0;t<e.length;t++)i.traverseFileTree(e[t]);i.traverseFileTree(!0),i.filesEntries=[]})},t.prototype.onSelectFiles=function(e){var t;if(this.enabled)if("drop"===e.type)if(this.directoryUpload)this.getFilesFromFolder(e);else{var i=e.dataTransfer.files;t=this.multiple?this.sortFileList(i):[i[0]],this.renderSelectedFiles(e,t)}else t=[].slice.call(e.target.files),this.renderSelectedFiles(e,t)},t.prototype.renderSelectedFiles=function(e,t,i,s){var a={event:e,cancel:!1,filesData:[],isModified:!1,modifiedFilesData:[],progressInterval:"",isCanceled:!1};if(t.length<1)return a.isCanceled=!0,void this.trigger("selected",a);this.flag=!0;var o=[];this.multiple||(this.clearData(!0),t=[t[0]]);for(var l=0;l<t.length;l++){var n=i?t[l].file:t[l],c={name:i?t[l].path.substring(1,t[l].path.length):s?Object(r.K)(n.name.substring(0,n.name.lastIndexOf(".")))+"."+this.getFileType(n.name):this.directoryUpload?t[l].webkitRelativePath:n.name,rawFile:n,size:n.size,status:this.localizedTexts("readyToUploadMessage"),type:this.getFileType(n.name),validationMessages:this.validatedFileSize(n.size),statusCode:"1"};s&&(c.fileSource="paste"),c.status=""!==c.validationMessages.minSize?this.localizedTexts("invalidMinFileSize"):""!==c.validationMessages.maxSize?this.localizedTexts("invalidMaxFileSize"):c.status,""===c.validationMessages.minSize&&""===c.validationMessages.maxSize||(c.statusCode="0",this.checkActionComplete(!0)),o.push(c)}if(a.filesData=o,this.allowedExtensions.indexOf("*")>-1&&(this.allTypes=!0),this.allTypes||(o=this.checkExtension(o)),this.trigger("selected",a),this.selectedFiles=o,!a.cancel){if(this.btnTabIndex=this.disableKeyboardNavigation?"-1":"0",this.showFileList){if(a.isModified&&a.modifiedFilesData.length>0){var u=this.allTypes?a.modifiedFilesData:this.checkExtension(a.modifiedFilesData);this.updateSortedFileList(u),this.filesData=u,this.isForm||this.checkAutoUpload(u)}else this.createFileList(o),this.filesData=this.filesData.concat(o),this.isForm||this.checkAutoUpload(o);Object(r.M)(a.progressInterval)||""===a.progressInterval||(this.progressInterval=a.progressInterval)}else this.filesData=this.filesData.concat(o),this.autoUpload&&this.upload(this.filesData,!0);this.raiseActionComplete()}},t.prototype.clearData=function(e){Object(r.M)(this.listParent)||(Object(r.C)(this.listParent),this.listParent=null),"msie"===r.d.info.name||e||(this.element.value=""),this.fileList=[],this.filesData=[],this.removeActionButtons()},t.prototype.updateSortedFileList=function(e){var t=this.createElement("div",{id:"clonewrapper"}),i=-1;if(this.listParent){for(var s=0;s<this.listParent.querySelectorAll("li").length;s++){var a=this.listParent.querySelectorAll("li")[s];t.appendChild(a.cloneNode(!0))}for(var o=0,l=this.listParent.querySelectorAll("li");o<l.length;o++){var n=l[o];Object(r.C)(n)}this.removeActionButtons();var c=[].slice.call(t.childNodes);Object(r.C)(this.listParent),this.listParent=null,this.fileList=[],this.createParentUL();for(var u=0;u<e.length;u++){for(var h=0;h<this.filesData.length;h++)this.filesData[h].name===e[u].name&&(this.listParent.appendChild(c[h]),r.l.add(c[h].querySelector(".e-icons"),"click",this.removeFiles,this),this.fileList.push(c[h]),i=u);i!==u&&this.createFileList([e[u]])}}else this.createFileList(e)},t.prototype.isBlank=function(e){return!e||/^\s*$/.test(e)},t.prototype.checkExtension=function(e){var t=e;if(!this.isBlank(this.allowedExtensions)){for(var i=[],s=0,a=this.allowedExtensions.split(",");s<a.length;s++)i.push(a[s].trim().toLocaleLowerCase());for(var r=0;r<e.length;r++)-1===i.indexOf(("."+e[r].type).toLocaleLowerCase())&&(e[r].status=this.localizedTexts("invalidFileType"),e[r].statusCode="0")}return t},t.prototype.validatedFileSize=function(e){var t="",i="";return e<this.minFileSize?t=this.localizedTexts("invalidMinFileSize"):e>this.maxFileSize?i=this.localizedTexts("invalidMaxFileSize"):(t="",i=""),{minSize:t,maxSize:i}},t.prototype.isPreLoadFile=function(e){for(var t=!1,i=0;i<this.files.length;i++)this.files[i].name===e.name.slice(0,e.name.lastIndexOf("."))&&this.files[i].type===e.type&&(t=!0);return t},t.prototype.createCustomfileList=function(e){this.createParentUL();for(var t=0,i=e;t<i.length;t++){var s=i[t],a=this.createElement("li",{className:l,attrs:{"data-file-name":s.name}});this.uploadTemplateFn=this.templateComplier(this.template);var o=[].slice.call(this.uploadTemplateFn(s)),n=e.indexOf(s);Object(r.t)(o,a);var c={element:a,fileInfo:s,index:n,isPreload:this.isPreLoadFile(s)},u={element:a,fileInfo:s,index:n,isPreload:this.isPreLoadFile(s)};this.trigger("rendering",c),this.trigger("fileListRendering",u),this.listParent.appendChild(a),this.fileList.push(a)}},t.prototype.createParentUL=function(){Object(r.M)(this.listParent)&&(this.listParent=this.createElement("ul",{className:"e-upload-files"}),this.uploadWrapper.appendChild(this.listParent))},t.prototype.createFileList=function(e){if(this.createParentUL(),""===this.template||Object(r.M)(this.template))for(var t=0,i=e;t<i.length;t++){var s=i[t],a=this.createElement("li",{className:l,attrs:{"data-file-name":s.name}}),o=this.createElement("span",{className:"e-file-container"}),h=this.createElement("span",{className:"e-file-name",attrs:{title:s.name}});h.innerHTML=this.getFileNameOnly(s.name);var p=this.createElement("span",{className:"e-file-type"});if(p.innerHTML="."+this.getFileType(s.name),this.enableRtl){var d=this.createElement("span",{className:"e-rtl-container"});d.appendChild(p),d.appendChild(h),o.appendChild(d)}else o.appendChild(h),o.appendChild(p);var f=this.createElement("span",{className:"e-file-size"});f.innerHTML=this.bytesToSize(s.size),o.appendChild(f);var m=this.createElement("span",{className:n});o.appendChild(m),m.innerHTML=s.status,a.appendChild(o);var y=this.createElement("span",{className:" e-icons",attrs:{tabindex:this.btnTabIndex}});"msie"===r.d.info.name&&y.classList.add("e-msie"),y.setAttribute("title",this.localizedTexts("remove")),a.appendChild(y),r.l.add(y,"click",this.removeFiles,this),"2"===s.statusCode?(m.classList.add(b),y.classList.add(u),y.setAttribute("title",this.localizedTexts("delete"))):"1"!==s.statusCode&&(m.classList.remove(b),m.classList.add("e-validation-fails")),this.autoUpload&&"1"===s.statusCode&&""!==this.asyncSettings.saveUrl&&(m.innerHTML=""),y.classList.contains(u)||y.classList.add(c);var g=e.indexOf(s),v={element:a,fileInfo:s,index:g,isPreload:this.isPreLoadFile(s)},O={element:a,fileInfo:s,index:g,isPreload:this.isPreLoadFile(s)};this.trigger("rendering",v),this.trigger("fileListRendering",O),this.listParent.appendChild(a),this.fileList.push(a),this.truncateName(h)}else this.createCustomfileList(e)},t.prototype.truncateName=function(e){var t;e.offsetWidth<e.scrollWidth&&(e.dataset.tail=(t=e.textContent).slice(t.length-10))},t.prototype.getFileType=function(e){var t,i=e.lastIndexOf(".");return i>=0&&(t=e.substring(i+1)),t||""},t.prototype.getFileNameOnly=function(e){var t=this.getFileType(e);return e.split("."+t)[0]},t.prototype.setInitialAttributes=function(){if(this.initialAttr.accept&&this.element.setAttribute("accept",this.initialAttr.accept),this.initialAttr.disabled&&this.element.setAttribute("disabled","disabled"),this.initialAttr.multiple){var e=document.createAttribute("multiple");this.element.setAttributeNode(e)}},t.prototype.filterfileList=function(e){for(var t=[],i=0;i<e.length;i++)this.getLiElement(e[i]).classList.contains(b)||t.push(e[i]);return t},t.prototype.updateStatus=function(e,t,i,s){if(void 0===s&&(s=!0),""===t||Object(r.M)(t)||""===i||Object(r.M)(i)||(e.status=t,e.statusCode=i),s){var a=this.getLiElement(e);Object(r.M)(a)||Object(r.M)(a.querySelector("."+n))||""===t||Object(r.M)(t)||(a.querySelector("."+n).textContent=t)}return e},t.prototype.getLiElement=function(e){for(var t,i=0;i<this.filesData.length;i++)this.filesData[i].name===e.name&&(t=i);return this.fileList[t]},t.prototype.createProgressBar=function(e){var t=this.createElement("span",{className:d}),i=this.createElement("progressbar",{className:f,attrs:{value:"0",max:"100"}}),s=this.createElement("span",{className:"e-progress-inner-wrap"});i.setAttribute("style","width: 0%");var a=this.createElement("span",{className:"e-progress-bar-text"});a.textContent="0%",s.appendChild(i),t.appendChild(s),t.appendChild(a),e.querySelector(".e-file-container").appendChild(t)},t.prototype.updateProgressbar=function(e,t){if(!isNaN(Math.round(e.loaded/e.total*100))&&!Object(r.M)(t.querySelector("."+f)))if(Object(r.M)(this.progressInterval)||""===this.progressInterval)this.changeProgressValue(t,Math.round(e.loaded/e.total*100).toString()+"%");else{var i=Math.round(e.loaded/e.total*100)%parseInt(this.progressInterval,10);0!==i&&100!==i||this.changeProgressValue(t,Math.round(e.loaded/e.total*100).toString()+"%")}},t.prototype.changeProgressValue=function(e,t){e.querySelector("."+f).setAttribute("style","width:"+t),e.querySelector(".e-progress-bar-text").textContent=t},t.prototype.uploadInProgress=function(e,t,i,s){var a=this.getLiElement(t);if(!Object(r.M)(a)||i){if(Object(r.M)(a))this.cancelUploadingFile(t,e,s);else{"5"===t.statusCode&&this.cancelUploadingFile(t,e,s,a),a.querySelectorAll("."+d).length>0||!a.querySelector("."+n)||(a.querySelector("."+n).classList.add("e-upload-progress"),this.createProgressBar(a),this.updateProgressBarClasses(a,"e-upload-progress"),a.querySelector("."+n).classList.remove(m)),this.updateProgressbar(e,a);var o=a.querySelector("."+c);Object(r.M)(o)||(o.classList.add(h,"e-upload-progress"),o.setAttribute("title",this.localizedTexts("abort")),o.classList.remove(c))}var l={e:e,operation:"upload",file:this.updateStatus(t,this.localizedTexts("inProgress"),"3")};this.trigger("progress",l)}},t.prototype.cancelUploadingFile=function(e,t,i,s){var a=this;if("5"===e.statusCode){var l={event:t,fileData:e,cancel:!1};if(this.trigger("canceling",l),l.cancel){if(e.statusCode="3",!Object(r.M)(s)){var n=s.querySelector("."+h);Object(r.M)(n)||(Object(o.b)(n),Object(r.C)(s.querySelector(".e-spinner-pane")))}return}i.emitError=!1,i.httpRequest.abort();var c=new FormData;if("5"===e.statusCode){var u=this.element.getAttribute("name");c.append(u,e.name),c.append("cancel-uploading",e.name);var p=new r.a(this.asyncSettings.removeUrl,"POST",!0,null);p.emitError=!1,p.onLoad=function(t){return a.removecanceledFile(t,e),{}},p.send(c)}}},t.prototype.removecanceledFile=function(e,t){var i=this.getLiElement(t);if(!i.querySelector("."+p)&&!Object(r.M)(i.querySelector("."+h))){this.updateStatus(t,this.localizedTexts("fileUploadCancel"),"5"),this.renderFailureState(e,t,i);var s=i.querySelector("."+c);Object(r.M)(i)||(Object(o.b)(s),Object(r.C)(i.querySelector(".e-spinner-pane")));var a=e&&e.currentTarget?this.getResponse(e):null;this.trigger("success",{event:e,response:a,operation:"cancel",file:t})}},t.prototype.renderFailureState=function(e,t,i){var s=this;this.updateProgressBarClasses(i,m),this.removeProgressbar(i,"failure"),Object(r.M)(i.querySelector(".e-file-status"))||i.querySelector(".e-file-status").classList.add(m);var a=i.querySelector("."+h);Object(r.M)(a)||(a.classList.remove(h,"e-upload-progress"),a.classList.add(c),a.setAttribute("title",this.localizedTexts("remove")),this.pauseButton=this.createElement("span",{className:"e-icons e-file-reload-btn",attrs:{tabindex:this.btnTabIndex}}),i.insertBefore(this.pauseButton,a),this.pauseButton.setAttribute("title",this.localizedTexts("retry")),i.querySelector("."+p).addEventListener("click",function(e){s.reloadcanceledFile(e,t,i,!1)},!1))},t.prototype.reloadcanceledFile=function(e,t,i,s){t.statusCode="1",t.status=this.localizedTexts("readyToUploadMessage"),s||(i.querySelector("."+n).classList.remove(m),Object(r.M)(i.querySelector("."+p))||Object(r.C)(i.querySelector("."+p)),this.pauseButton=null),i.classList.add("e-restrict-retry"),this.upload([t])},t.prototype.uploadComplete=function(e,t,i){var s=e.target;if(4===s.readyState&&s.status>=200&&s.status<=299){var a=this.getLiElement(t);if(Object(r.M)(a)&&(!i||Object(r.M)(i)))return;if(!Object(r.M)(a)){this.updateProgressBarClasses(a,b),this.removeProgressbar(a,"success");var o=a.querySelector("."+h);Object(r.M)(o)||(o.classList.add(u),o.setAttribute("title",this.localizedTexts("delete")),o.classList.remove(h),o.classList.remove("e-upload-progress"))}this.raiseSuccessEvent(e,t)}else this.uploadFailed(e,t)},t.prototype.getResponse=function(e){var t=e.currentTarget;return{readyState:t.readyState,statusCode:t.status,statusText:t.statusText,headers:t.getAllResponseHeaders(),withCredentials:t.withCredentials}},t.prototype.raiseSuccessEvent=function(e,t){var i=e&&e.currentTarget?this.getResponse(e):null,s=this.localizedTexts("uploadSuccessMessage"),a={e:e,response:i,operation:"upload",file:this.updateStatus(t,s,"2",!1),statusText:s};this.trigger("success",a),this.updateStatus(t,a.statusText,"2"),this.uploadedFilesData.push(t),this.trigger("change",{file:this.uploadedFilesData}),this.checkActionButtonStatus(),this.fileList.length>0&&(this.getLiElement(t).classList.contains("e-restrict-retry")?this.getLiElement(t).classList.remove("e-restrict-retry"):(this.uploadSequential(),this.checkActionComplete(!0)))},t.prototype.uploadFailed=function(e,t){var i=this.getLiElement(t),s=e&&e.currentTarget?this.getResponse(e):null,a=this.localizedTexts("uploadFailedMessage"),o={e:e,response:s,operation:"upload",file:this.updateStatus(t,a,"0",!1),statusText:a};Object(r.M)(i)||this.renderFailureState(e,t,i),this.trigger("failure",o),this.updateStatus(t,o.statusText,"0"),this.checkActionButtonStatus(),this.uploadSequential(),this.checkActionComplete(!0)},t.prototype.uploadSequential=function(){this.sequentialUpload&&(this.autoUpload?this.checkAutoUpload(this.filesData):this.uploadButtonClick())},t.prototype.checkActionComplete=function(e){e?++this.actionCompleteCount:--this.actionCompleteCount,this.raiseActionComplete()},t.prototype.raiseActionComplete=function(){if(this.filesData.length===this.actionCompleteCount&&this.flag){this.flag=!1;var e={fileData:[]};e.fileData=this.getSelectedFileStatus(this.selectedFiles),this.trigger("actionComplete",e)}},t.prototype.getSelectedFileStatus=function(e){for(var t=[],i=0,s=0;s<e.length;s++)for(var a=e[s],r=0;r<this.filesData.length;r++)this.filesData[r].name===a.name&&(t[i]=this.filesData[r],++i);return t},t.prototype.updateProgressBarClasses=function(e,t){var i=e.querySelector("."+f);Object(r.M)(i)||i.classList.add(t)},t.prototype.removeProgressbar=function(e,t){var i=this;Object(r.M)(e.querySelector("."+d))||(this.progressAnimation=new r.b({duration:1250}),this.progressAnimation.animate(e.querySelector("."+d),{name:"FadeOut"}),this.progressAnimation.animate(e.querySelector(".e-progress-bar-text"),{name:"FadeOut"}),setTimeout(function(){i.animateProgressBar(e,t)},750))},t.prototype.animateProgressBar=function(e,t){"success"===t?(e.classList.add(b),Object(r.M)(e.querySelector("."+n))||(e.querySelector("."+n).classList.remove("e-upload-progress"),this.progressAnimation.animate(e.querySelector("."+n),{name:"FadeIn"}),e.querySelector("."+n).classList.add(b))):Object(r.M)(e.querySelector("."+n))||(e.querySelector("."+n).classList.remove("e-upload-progress"),this.progressAnimation.animate(e.querySelector("."+n),{name:"FadeIn"}),e.querySelector("."+n).classList.add(m)),e.querySelector("."+d)&&Object(r.C)(e.querySelector("."+d))},t.prototype.setExtensions=function(e){this.element.setAttribute("accept",e)},t.prototype.templateComplier=function(e){if(e)try{if(document.querySelectorAll(e).length)return Object(r.y)(document.querySelector(e).innerHTML.trim())}catch(t){return Object(r.y)(e)}},t.prototype.setRTL=function(){this.enableRtl?Object(r.s)([this.uploadWrapper],"e-rtl"):Object(r.X)([this.uploadWrapper],"e-rtl")},t.prototype.localizedTexts=function(e){return this.l10n.setLocale(this.locale),this.l10n.getConstant(e)},t.prototype.setControlStatus=function(){this.enabled?(this.uploadWrapper.classList.contains("e-disabled")&&this.uploadWrapper.classList.remove("e-disabled"),!Object(r.M)(this.browseButton)&&this.element.hasAttribute("disabled")&&(this.element.removeAttribute("disabled"),this.browseButton.removeAttribute("disabled")),!Object(r.M)(this.clearButton)&&this.clearButton.hasAttribute("disabled")&&this.clearButton.removeAttribute("disabled"),!Object(r.M)(this.uploadButton)&&this.uploadButton.hasAttribute("disabled")&&this.uploadButton.hasAttribute("disabled")):(this.uploadWrapper.classList.add("e-disabled"),this.element.setAttribute("disabled","disabled"),this.browseButton.setAttribute("disabled","disabled"),Object(r.M)(this.clearButton)||this.clearButton.setAttribute("disabled","disabled"),Object(r.M)(this.uploadButton)||this.uploadButton.setAttribute("disabled","disabled"))},t.prototype.checkHTMLAttributes=function(){this.element.hasAttribute("accept")&&(this.allowedExtensions=this.element.getAttribute("accept"),this.initialAttr.accept=this.allowedExtensions),this.element.hasAttribute("multiple")&&(this.multiple=!0,this.initialAttr.multiple=!0),this.element.hasAttribute("disabled")&&(this.enabled=!1,this.initialAttr.disabled=!0)},t.prototype.chunkUpload=function(e,t){var i=Math.min(this.asyncSettings.chunkSize,e.size),s=e.rawFile.slice(0,i);this.sendRequest(e,{chunkIndex:0,blob:s,file:e,start:0,end:i,retryCount:0,request:null},t)},t.prototype.sendRequest=function(e,t,i){var s=this,a=new FormData,o=e.rawFile.slice(t.start,t.end);a.append("chunkFile",o,e.name),a.append("chunk-index",t.chunkIndex.toString()),a.append("chunkIndex",t.chunkIndex.toString());var l=Math.max(Math.ceil(e.size/this.asyncSettings.chunkSize),1);a.append("total-chunk",l.toString()),a.append("totalChunk",l.toString());var n=new r.a({url:this.asyncSettings.saveUrl,type:"POST",async:!0,contentType:null});n.emitError=!1,n.onLoad=function(e){return s.chunkUploadComplete(e,t,i),{}},n.onUploadProgress=function(e){return s.chunkUploadInProgress(e,t,i),{}};var c={fileData:e,customFormData:[],cancel:!1,chunkSize:0===this.asyncSettings.chunkSize?null:this.asyncSettings.chunkSize};n.beforeSend=function(i){c.currentRequest=n.httpRequest,c.currentChunkIndex=t.chunkIndex,0===c.currentChunkIndex&&s.trigger("uploading",c),s.trigger("chunkUploading",c),c.cancel?s.eventCancelByArgs(i,c,e):s.updateFormData(a,c.customFormData)},n.onError=function(e){return s.chunkUploadFailed(e,t,i),{}},n.send(a),t.request=n},t.prototype.eventCancelByArgs=function(e,t,i){var s=this;if(e.cancel=!0,"5"!==t.fileData.statusCode){var a=this.getLiElement(t.fileData);a.querySelector("."+n).innerHTML=this.localizedTexts("fileUploadCancel"),a.querySelector("."+n).classList.add(m),t.fileData.statusCode="5",t.fileData.status=this.localizedTexts("fileUploadCancel"),this.pauseButton=this.createElement("span",{className:"e-icons e-file-reload-btn",attrs:{tabindex:this.btnTabIndex}}),a.insertBefore(this.pauseButton,a.querySelector("."+c)),this.pauseButton.setAttribute("title",this.localizedTexts("retry")),this.pauseButton.addEventListener("click",function(e){s.reloadcanceledFile(e,i,a)},!1),this.checkActionButtonStatus()}},t.prototype.checkChunkUpload=function(){return!(this.asyncSettings.chunkSize<=0||Object(r.M)(this.asyncSettings.chunkSize))},t.prototype.chunkUploadComplete=function(e,t,i){var s,a=this,l=e.target;if(4===l.readyState&&l.status>=200&&l.status<300){var n=e&&e.currentTarget?this.getResponse(e):null,c=Math.max(Math.ceil(t.file.size/this.asyncSettings.chunkSize),1);if(this.trigger("chunkSuccess",{event:e,file:t.file,chunkIndex:t.chunkIndex,totalChunk:c,chunkSize:this.asyncSettings.chunkSize,response:n}),!Object(r.M)(i)&&i||(s=this.getLiElement(t.file)),this.updateMetaData(t),t.end===t.file.size&&(t.file.statusCode="3"),"5"===t.file.statusCode){var u={event:e,fileData:t.file,cancel:!1};if(this.trigger("canceling",u),u.cancel){t.file.statusCode="3";var p=s.querySelector("."+h);return Object(r.M)(s)||Object(r.M)(p)||(Object(o.b)(p),Object(r.C)(s.querySelector(".e-spinner-pane"))),void this.sendNextRequest(t)}t.request.emitError=!1,l.abort();var d=new FormData,f=this.element.getAttribute("name");d.append(f,t.file.name),d.append("cancel-uploading",t.file.name),d.append("cancelUploading",t.file.name);var b=new r.a(this.asyncSettings.removeUrl,"POST",!0,null);b.emitError=!1,b.onLoad=function(e){return a.removeChunkFile(e,t,i),{}},b.send(d)}else{if(c-1===t.chunkIndex&&c>t.chunkIndex){var m=this.pausedData.indexOf(t);return m>=0&&this.pausedData.splice(m,1),Object(r.M)(this.template)&&(Object(r.M)(i)||!i)&&s&&(s&&Object(r.C)(s.querySelector("."+y)),this.removeChunkProgressBar(t)),void this.raiseSuccessEvent(e,t.file)}this.sendNextRequest(t)}}else this.chunkUploadFailed(e,t)},t.prototype.sendNextRequest=function(e){e.start=e.end,e.end+=this.asyncSettings.chunkSize,e.end=Math.min(e.end,e.file.size),e.chunkIndex+=1,this.sendRequest(e.file,e)},t.prototype.removeChunkFile=function(e,t,i){if(Object(r.M)(this.template)&&Object(r.M)(i)&&!i){var s=this.getLiElement(t.file),a=s.querySelector("."+h),l=a;this.updateStatus(t.file,this.localizedTexts("fileUploadCancel"),"5"),this.updateProgressBarClasses(s,m),this.removeProgressbar(s,"failure"),a.classList.remove(h),a.classList.add(c),a.setAttribute("title",this.localizedTexts("remove"));var n=s.querySelector("."+y);n.classList.add(p),n.classList.remove(y),n.setAttribute("title",this.localizedTexts("retry")),Object(r.M)(s)||Object(r.M)(a)||(Object(o.b)(l),Object(r.C)(s.querySelector(".e-spinner-pane")))}},t.prototype.pauseUpload=function(e,t,i){e.file.statusCode="4",e.file.status=this.localizedTexts("pause"),this.updateMetaData(e);var s={event:t||null,file:e.file,chunkIndex:e.chunkIndex,chunkCount:Math.round(e.file.size/this.asyncSettings.chunkSize),chunkSize:this.asyncSettings.chunkSize};this.abortUpload(e,i,s)},t.prototype.abortUpload=function(e,t,i){e.request.emitError=!1,e.request.httpRequest.abort();var s=this.getLiElement(e.file);if(Object(r.M)(this.template)&&(Object(r.M)(t)||!t)){var a=s.querySelector("."+y);a.classList.remove(y),a.classList.add("e-file-play-btn"),a.setAttribute("title",this.localizedTexts("resume")),a.nextElementSibling.classList.add(c),a.nextElementSibling.classList.remove(h),a.nextElementSibling.setAttribute("title",this.localizedTexts("remove"))}for(var o=0;o<this.pausedData.length;o++)this.pausedData[o].file.name===e.file.name&&this.pausedData.splice(o,1);this.pausedData.push(e),this.trigger("pausing",i)},t.prototype.resumeUpload=function(e,t,i){var s,a=this.getLiElement(e.file);Object(r.M)(a)||(s=a.querySelector(".e-file-play-btn")),Object(r.M)(s)||!Object(r.M)(i)&&i||(s.classList.remove("e-file-play-btn"),s.classList.add(y),s.setAttribute("title",this.localizedTexts("pause")),s.nextElementSibling.classList.remove(c),s.nextElementSibling.classList.add(h),s.nextElementSibling.setAttribute("title",this.localizedTexts("abort"))),e.file.status=this.localizedTexts("inProgress"),e.file.statusCode="3",this.updateMetaData(e);var o={event:t||null,file:e.file,chunkIndex:e.chunkIndex,chunkCount:Math.round(e.file.size/this.asyncSettings.chunkSize),chunkSize:this.asyncSettings.chunkSize};this.trigger("resuming",o);for(var l=0;l<this.pausedData.length;l++)this.pausedData[l].end===this.pausedData[l].file.size?this.chunkUploadComplete(t,e,i):this.pausedData[l].file.name===e.file.name&&(this.pausedData[l].start=this.pausedData[l].end,this.pausedData[l].end=this.pausedData[l].end+this.asyncSettings.chunkSize,this.pausedData[l].end=Math.min(this.pausedData[l].end,this.pausedData[l].file.size),this.pausedData[l].chunkIndex=this.pausedData[l].chunkIndex+1,this.sendRequest(this.pausedData[l].file,this.pausedData[l],i))},t.prototype.updateMetaData=function(e){-1===this.uploadMetaData.indexOf(e)?this.uploadMetaData.push(e):(this.uploadMetaData.splice(this.uploadMetaData.indexOf(e),1),this.uploadMetaData.push(e))},t.prototype.removeChunkProgressBar=function(e){var t=this.getLiElement(e.file);if(!Object(r.M)(t)){this.updateProgressBarClasses(t,b),this.removeProgressbar(t,"success");var i=t.querySelector("."+h);Object(r.M)(i)||(i.classList.add(u),i.setAttribute("title",this.localizedTexts("delete")),i.classList.remove(h,"e-upload-progress"))}},t.prototype.chunkUploadFailed=function(e,t,i){var s,a=this,o=Math.max(Math.ceil(t.file.size/this.asyncSettings.chunkSize),1);!Object(r.M)(this.template)||!Object(r.M)(i)&&i||(s=this.getLiElement(t.file));var l=e&&e.currentTarget?this.getResponse(e):null,n={event:e,file:t.file,chunkIndex:t.chunkIndex,totalChunk:o,chunkSize:this.asyncSettings.chunkSize,cancel:!1,response:l};if(this.trigger("chunkFailure",n),!n.cancel)if(t.retryCount<this.asyncSettings.retryCount)setTimeout(function(){a.retryRequest(s,t,i)},this.asyncSettings.retryAfterDelay);else{if(!Object(r.M)(s)){var d=s.querySelector("."+y)?s.querySelector("."+y):s.querySelector(".e-file-play-btn");Object(r.M)(d)||(d.classList.add(p),d.classList.remove(y,"e-file-play-btn")),this.updateProgressBarClasses(s,m),this.removeProgressbar(s,"failure"),s.querySelector(".e-icons").classList.remove("e-upload-progress");var f=s.querySelector("."+h);f.classList.remove(h),Object(r.M)(s.querySelector("."+y))||Object(r.C)(s.querySelector("."+y)),t.start>0?(f.classList.add(u),f.setAttribute("title",this.localizedTexts("delete"))):(f.classList.add(c),f.setAttribute("title",this.localizedTexts("remove")))}t.retryCount=0;var b=t.file,g=this.localizedTexts("uploadFailedMessage"),v={e:e,response:l,operation:"upload",file:this.updateStatus(b,g,"0",!1),statusText:g};this.trigger("failure",v),this.updateStatus(b,v.statusText,"0"),this.uploadSequential(),this.checkActionComplete(!0)}},t.prototype.retryRequest=function(e,t,i){Object(r.M)(this.template)&&(Object(r.M)(i)||!i)&&e&&this.updateProgressBarClasses(e,m),t.retryCount+=1,this.sendRequest(t.file,t)},t.prototype.checkPausePlayAction=function(e){var t=e.target,i=this.fileList.indexOf(e.target.parentElement),s=this.getCurrentMetaData(this.filesData[i]);t.classList.contains(y)?this.pauseUpload(s,e):t.classList.contains("e-file-play-btn")?this.resumeUpload(s,e):t.classList.contains(p)&&(s.file.status===this.localizedTexts("fileUploadCancel")?this.retryUpload(s,!1):this.retryUpload(s,!0))},t.prototype.retryUpload=function(e,t){t?(e.end=e.end+this.asyncSettings.chunkSize,e.start=e.start+this.asyncSettings.chunkSize,this.sendRequest(e.file,e)):(e.file.statusCode="1",e.file.status=this.localizedTexts("readyToUploadMessage"),this.chunkUpload(e.file)),this.getLiElement(e.file).classList.add("e-restrict-retry")},t.prototype.chunkUploadInProgress=function(e,t,i){var s=this;if("4"!==t.file.statusCode){"4"!==t.file.statusCode&&"5"!==t.file.statusCode&&(t.file.statusCode="3",t.file.status=this.localizedTexts("inProgress")),this.updateMetaData(t);var a=this.getLiElement(t.file);if(!Object(r.M)(a)){var o=a.querySelector("."+p);if(Object(r.M)(o)||(o.classList.add(y),o.setAttribute("title",this.localizedTexts("pause")),o.classList.remove(p)),!Object(r.M)(a)){if(!(a.querySelectorAll("."+d).length>0)){var l=a.querySelector("."+n);Object(r.M)(this.template)&&(l.classList.add("e-upload-progress"),l.classList.remove(m),this.createProgressBar(a),this.updateProgressBarClasses(a,"e-upload-progress"));var f=a.querySelector("."+c)?a.querySelector("."+c):a.querySelector("."+u);Object(r.M)(f)||(f.classList.add(h),f.setAttribute("title",this.localizedTexts("abort")),f.classList.remove(c))}if(!isNaN(Math.round(e.loaded/e.total*100))&&Object(r.M)(this.template)&&"4"!==t.file.statusCode){var b=Math.min((t.chunkIndex*this.asyncSettings.chunkSize+e.loaded)/t.file.size*100,100);this.changeProgressValue(a,Math.round(b).toString()+"%")}0===t.chunkIndex&&this.checkActionButtonStatus()}Object(r.M)(a.querySelector("."+y))&&Object(r.M)(this.template)&&(this.pauseButton=this.createElement("span",{className:"e-icons e-file-pause-btn",attrs:{tabindex:this.btnTabIndex}}),"msie"===r.d.info.name&&this.pauseButton.classList.add("e-msie"),a.insertBefore(this.pauseButton,a.querySelector("."+h)),this.pauseButton.setAttribute("title",this.localizedTexts("pause")),this.pauseButton.addEventListener("click",function(e){s.checkPausePlayAction(e)},!1))}}},t.prototype.bytesToSize=function(e){var t=-1;if(!e)return"0.0 KB";do{e/=1024,t++}while(e>99);return t>=2&&(e*=1024,t=1),Math.max(e,0).toFixed(1)+" "+["KB","MB"][t]},t.prototype.sortFileList=function(e){for(var t=e,i=[],s=0;s<t.length;s++)i.push(t[s].name);for(var a=[],r=0,o=i.sort();r<o.length;r++){var l=o[r];for(s=0;s<t.length;s++)l===t[s].name&&a.push(t[s])}return a},t.prototype.destroy=function(){this.element.value=null,this.clearAll(),this.unWireEvents(),this.unBindDropEvents(),this.multiple&&this.element.removeAttribute("multiple"),this.enabled||this.element.removeAttribute("disabled"),this.element.removeAttribute("accept"),this.setInitialAttributes();for(var t=0,i=["aria-label","directory","webkitdirectory","tabindex"];t<i.length;t++)this.element.removeAttribute(i[t]);this.uploadWrapper.parentElement.appendChild(this.element),Object(r.C)(this.uploadWrapper),this.uploadWrapper=null,e.prototype.destroy.call(this)},t.prototype.upload=function(e,t){var i=this.validateFileType(e);this.uploadFiles(i,t)},t.prototype.validateFileType=function(e){var t=[];return e instanceof Array?t=e:t.push(e),t},t.prototype.uploadFiles=function(e,t){var i=this,s=[];if(""!==this.asyncSettings.saveUrl&&!Object(r.M)(this.asyncSettings.saveUrl)){if(!t||Object(r.M)(t))if(this.multiple)s=this.filterfileList(e);else{var a=[];a.push(e[0]),s=this.filterfileList(a)}else s=e;for(var o=this.checkChunkUpload(),l=function(e){var a=new r.a(n.asyncSettings.saveUrl,"POST",!0,null);a.emitError=!1;var l={fileData:s[e],customFormData:[],cancel:!1},c=new FormData;if(a.beforeSend=function(t){l.currentRequest=a.httpRequest,i.trigger("uploading",l),l.cancel&&i.eventCancelByArgs(t,l,s[e]),i.updateFormData(c,l.customFormData)},"1"===s[e].statusCode){var u=n.element.getAttribute("name");c.append(u,s[e].rawFile,s[e].name),o&&s[e].size>n.asyncSettings.chunkSize?n.chunkUpload(s[e],t):(a.onLoad=function(a){return i.uploadComplete(a,s[e],t),{}},a.onUploadProgress=function(r){return i.uploadInProgress(r,s[e],t,a),{}},a.onError=function(t){return i.uploadFailed(t,s[e]),{}},a.send(c))}},n=this,c=0;c<s.length;c++)l(c)}},t.prototype.remove=function(e,t,i,s){var a,o={event:s,cancel:!1,filesData:[],customFormData:[],postRawFile:!0};if(this.isForm)return o.filesData=this.getFilesData(),this.trigger("removing",o),void(o.cancel||this.clearAll());var l=[];(e=Object(r.M)(e)?this.filesData:e)instanceof Array?l=e:l.push(e),o.filesData=l;for(var n=this.asyncSettings.removeUrl,c=""!==n&&!Object(r.M)(n),u=0,h=l;u<h.length;u++){var p=h[u];if(a=this.filesData.indexOf(p),"2"!==p.statusCode&&"4"!==p.statusCode||!c){if(i||this.trigger("removing",o),o.cancel)return;this.removeFilesData(p,t)}else this.removeUploadedFile(p,o,i,t);this.sequentialUpload?a<=this.actionCompleteCount&&this.checkActionComplete(!1):this.checkActionComplete(!1)}},t.prototype.clearAll=function(){if(Object(r.M)(this.listParent))return"msie"!==r.d.info.name&&(this.element.value=""),void(this.filesData=[]);var e={cancel:!1,filesData:this.filesData};this.trigger("clearing",e),e.cancel||(this.clearData(),this.actionCompleteCount=0,this.count=-1)},t.prototype.getFilesData=function(){return this.filesData},t.prototype.pause=function(e,t){var i=this.validateFileType(e);this.pauseUploading(i,t)},t.prototype.pauseUploading=function(e,t){for(var i=this.getFiles(e),s=0;s<i.length;s++)"3"===i[s].statusCode&&this.pauseUpload(this.getCurrentMetaData(i[s],null),null,t)},t.prototype.getFiles=function(e){var t=[];return Object(r.M)(e)||e instanceof Array?t=e:t.push(e),t},t.prototype.resume=function(e,t){var i=this.validateFileType(e);this.resumeFiles(i,t)},t.prototype.resumeFiles=function(e,t){for(var i=this.getFiles(e),s=0;s<i.length;s++)"4"===i[s].statusCode&&this.resumeUpload(this.getCurrentMetaData(i[s],null),null,t)},t.prototype.retry=function(e,t,i){var s=this.validateFileType(e);this.retryFailedFiles(s,t,i)},t.prototype.retryFailedFiles=function(e,t,i){for(var s=this.getFiles(e),a=0;a<s.length;a++)if("5"===s[a].statusCode||"0"===s[a].statusCode)if(this.asyncSettings.chunkSize>0)this.retryUpload(this.getCurrentMetaData(s[a],null),t);else{var r=void 0;i||(r=this.fileList[this.filesData.indexOf(s[a])]),this.reloadcanceledFile(null,s[a],r,i)}},t.prototype.cancel=function(e){var t=this.validateFileType(e);this.cancelUpload(t)},t.prototype.cancelUpload=function(e){var t=this.getFiles(e);if(this.asyncSettings.chunkSize>0){for(var i=0;i<t.length;i++)if("3"===t[i].statusCode){var s=this.getCurrentMetaData(t[i],null);s.file.statusCode="5",s.file.status=this.localizedTexts("fileUploadCancel"),this.updateMetaData(s),this.showHideUploadSpinner(t[i])}}else for(i=0;i<t.length;i++)"3"===t[i].statusCode&&(t[i].statusCode="5",t[i].status=this.localizedTexts("fileUploadCancel"),this.showHideUploadSpinner(t[i]))},t.prototype.showHideUploadSpinner=function(e){var t=this.getLiElement(e);if(!Object(r.M)(t)&&Object(r.M)(this.template)){var i=t.querySelector("."+h);Object(o.a)({target:i,width:"20px"}),Object(o.c)(i)}},Object(s.b)([Object(r.g)({saveUrl:"",removeUrl:""},O)],t.prototype,"asyncSettings",void 0),Object(s.b)([Object(r.q)(!1)],t.prototype,"sequentialUpload",void 0),Object(s.b)([Object(r.q)(!1)],t.prototype,"enableRtl",void 0),Object(s.b)([Object(r.q)("")],t.prototype,"cssClass",void 0),Object(s.b)([Object(r.q)(!0)],t.prototype,"enabled",void 0),Object(s.b)([Object(r.q)(null)],t.prototype,"template",void 0),Object(s.b)([Object(r.q)(!0)],t.prototype,"multiple",void 0),Object(s.b)([Object(r.q)(!0)],t.prototype,"autoUpload",void 0),Object(s.b)([Object(r.g)({},v)],t.prototype,"buttons",void 0),Object(s.b)([Object(r.q)("")],t.prototype,"allowedExtensions",void 0),Object(s.b)([Object(r.q)(0)],t.prototype,"minFileSize",void 0),Object(s.b)([Object(r.q)(3e7)],t.prototype,"maxFileSize",void 0),Object(s.b)([Object(r.q)(null)],t.prototype,"dropArea",void 0),Object(s.b)([Object(r.f)([{}],g)],t.prototype,"files",void 0),Object(s.b)([Object(r.q)(!0)],t.prototype,"showFileList",void 0),Object(s.b)([Object(r.q)(!1)],t.prototype,"directoryUpload",void 0),Object(s.b)([Object(r.k)()],t.prototype,"created",void 0),Object(s.b)([Object(r.k)()],t.prototype,"actionComplete",void 0),Object(s.b)([Object(r.k)()],t.prototype,"rendering",void 0),Object(s.b)([Object(r.k)()],t.prototype,"fileListRendering",void 0),Object(s.b)([Object(r.k)()],t.prototype,"selected",void 0),Object(s.b)([Object(r.k)()],t.prototype,"uploading",void 0),Object(s.b)([Object(r.k)()],t.prototype,"success",void 0),Object(s.b)([Object(r.k)()],t.prototype,"failure",void 0),Object(s.b)([Object(r.k)()],t.prototype,"removing",void 0),Object(s.b)([Object(r.k)()],t.prototype,"clearing",void 0),Object(s.b)([Object(r.k)()],t.prototype,"progress",void 0),Object(s.b)([Object(r.k)()],t.prototype,"change",void 0),Object(s.b)([Object(r.k)()],t.prototype,"chunkSuccess",void 0),Object(s.b)([Object(r.k)()],t.prototype,"chunkFailure",void 0),Object(s.b)([Object(r.k)()],t.prototype,"chunkUploading",void 0),Object(s.b)([Object(r.k)()],t.prototype,"canceling",void 0),Object(s.b)([Object(r.k)()],t.prototype,"pausing",void 0),Object(s.b)([Object(r.k)()],t.prototype,"resuming",void 0),Object(s.b)([r.p],t)}(r.h);i.d(t,"a",function(){return L});var j=["focus","blur","actionComplete","canceling","change","chunkFailure","chunkSuccess","chunkUploading","clearing","created","failure","fileListRendering","pausing","progress","removing","rendering","resuming","selected","success","uploading"],C=[],L=function(e){function t(t,i,s,r){var o=e.call(this)||this;return o.ngEle=t,o.srenderer=i,o.viewContainerRef=s,o.injector=r,o.tags=["files"],o.element=o.ngEle.nativeElement,o.injectedModules=o.injectedModules||[],o.registerEvents(j),o.addTwoWay.call(o,C),Object(a.g)("currentInstance",o,o.viewContainerRef),o}return Object(s.c)(t,e),t.prototype.registerOnChange=function(e){},t.prototype.registerOnTouched=function(e){},t.prototype.writeValue=function(e){},t.prototype.setDisabledState=function(e){},t.prototype.ngOnInit=function(){},t.prototype.ngAfterViewInit=function(){},t.prototype.ngOnDestroy=function(){},t.prototype.ngAfterContentChecked=function(){},Object(s.b)([Object(a.f)(),Object(s.d)("design:type",Object)],t.prototype,"template",void 0),Object(s.b)([Object(a.d)([a.c,a.e])],t)}(S)}}]);