{"version":3,"sources":["webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-angular-documenteditor/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-angular-documenteditor/src/document-editor-container/documenteditorcontainer-all.module.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-angular-documenteditor/src/document-editor-container/documenteditorcontainer.component.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-angular-documenteditor/src/document-editor-container/documenteditorcontainer.module.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-angular-documenteditor/src/document-editor/documenteditor-all.module.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-angular-documenteditor/src/document-editor/documenteditor.component.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-angular-documenteditor/src/document-editor/documenteditor.module.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-angular-documenteditor/src/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor-container/document-editor-container.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor-container/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor-container/properties-pane/header-footer-pane.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor-container/properties-pane/image-properties-pane.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor-container/properties-pane/paragraph-properties.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor-container/properties-pane/status-bar.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor-container/properties-pane/table-of-content-pane.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor-container/properties-pane/table-properties-pane.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor-container/properties-pane/text-properties-pane.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor-container/properties-pane/text-properties.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor-container/tool-bar/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor-container/tool-bar/tool-bar.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/base/dictionary.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/base/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/base/unique-format.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/base/unique-formats.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/document-editor.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/context-menu.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/bookmark-dialog.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/borders-and-shading-dialog.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/bullets-and-numbering-dialog.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/cell-options-dialog.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/font-dialog.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/hyperlink-dialog.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/list-dialog.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/list-view-model.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/page-setup-dialog.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/paragraph-dialog.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/style-dialog.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/styles-dialog.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/table-dialog.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/table-of-contents-dialog.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/table-options-dialog.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/table-properties-dialog.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/editor-history/base-history-info.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/editor-history/editor-history.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/editor-history/history-helper.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/editor-history/history-info.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/editor-history/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/editor/editor-helper.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/editor/editor.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/editor/image-resizer.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/editor/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/editor/table-resizer.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/format/border.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/format/borders.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/format/cell-format.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/format/character-format.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/format/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/format/list-format.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/format/paragraph-format.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/format/row-format.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/format/section-format.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/format/shading.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/format/style.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/format/table-format.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/list/abstract-list.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/list/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/list/level-override.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/list/list-level.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/list/list.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/print.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/search/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/search/options-pane.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/search/search-results.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/search/search.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/search/text-search-result.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/search/text-search-results.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/search/text-search.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/selection/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/selection/selection-format.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/selection/selection-helper.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/selection/selection.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/layout.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/page.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/render.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/sfdt-reader.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/text-helper.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/viewer.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/zooming.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/writer/html-export.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/writer/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/writer/sfdt-export.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/writer/text-export.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/writer/word-export.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/index.js","webpack:////var/www/html/ilo_app/myworkspace/node_modules/@syncfusion/ej2-documenteditor/src/index.js","webpack:///./src/app/features/articles/article-catagory-form/article-catagory-form.component.css","webpack:///./src/app/features/articles/article-catagory-form/article-catagory-form.component.html","webpack:///./src/app/features/articles/article-catagory-form/article-catagory-form.component.ts","webpack:///./src/app/features/articles/article-catagory-view/article-catagory-view.component.css","webpack:///./src/app/features/articles/article-catagory-view/article-catagory-view.component.html","webpack:///./src/app/features/articles/article-catagory-view/article-catagory-view.component.ts","webpack:///./src/app/features/articles/articles-api.service.ts","webpack:///./src/app/features/articles/articles-data.model.ts","webpack:///./src/app/features/articles/articles-form/articles-form.component.css","webpack:///./src/app/features/articles/articles-form/articles-form.component.html","webpack:///./src/app/features/articles/articles-form/articles-form.component.ts","webpack:///./src/app/features/articles/articles-routing.module.ts","webpack:///./src/app/features/articles/articles-view/articles-view.component.css","webpack:///./src/app/features/articles/articles-view/articles-view.component.html","webpack:///./src/app/features/articles/articles-view/articles-view.component.ts","webpack:///./src/app/features/articles/articles.module.ts"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAC4B;AAC5B,iC;;;;;;;;;;;;ACJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyC;AACM;AACkC;AACxB;AAClD,sBAAsB,6CAA6C,sEAAO;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,OAAO,sDAAQ;AACxB,8BAA8B,4DAAY,EAAE,6FAA6B;AACzE;AACA,wBAAwB,6FAA6B;AACrD;AACA;AACA;AACA;AACA,iBAAiB,IAAI;AACrB;AACA;AACA,mEAAmE,WAAW;AAC9E;AACA,CAAC;AAC2C;AAC5C,8D;;;;;;;;;;;;AC3BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,kBAAkB,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,kBAAkB,SAAI,IAAI,SAAI;AAC9B;AACA;AACsH;AAC9B;AACf;AAClE;AACA;AACA;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA,QAAQ,6EAAQ;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,OAAO,uDAAS;AACzB;AACA;AACA;AACA;AACA,qCAAqC,qEAAuB;AAC5D;AACA,iBAAiB,IAAI;AACrB;AACA;AACA,mEAAmE;AACnE,SAAS,OAAO,wDAAU,GAAG;AAC7B,SAAS,OAAO,uDAAS,GAAG;AAC5B,SAAS,OAAO,8DAAgB,GAAG;AACnC,SAAS,OAAO,sDAAQ,GAAG;AAC3B,MAAM;AACN;AACA,QAAQ,oFAAe,EAAE,0EAAa;AACtC,yCAAyC,wDAAU,EAAE,uDAAS,EAAE,8DAAgB,EAAE,sDAAQ;AAC1F;AACA;AACA,CAAC,CAAC,sFAAuB;AACmB;AAC5C,6D;;;;;;;;;;;;ACrFA;AAAA;AAAA;AAAA;AAAA;AAAyC;AACM;AACwC;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,OAAO,sDAAQ;AACxB,8BAA8B,4DAAY;AAC1C;AACA,wBAAwB,mGAAgC;AACxD;AACA;AACA,wBAAwB,mGAAgC;AACxD;AACA,iBAAiB,IAAI;AACrB;AACA;AACA,gEAAgE,WAAW;AAC3E;AACA,CAAC;AACwC;AACzC,0D;;;;;;;;;;;;ACzBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyC;AACM;AACgB;AAC0X;AAClb,oBAAoB,2CAA2C,oEAAK;AACpE,yBAAyB,gDAAgD,yEAAU;AACnF,yBAAyB,gDAAgD,yEAAU;AACnF,yBAAyB,gDAAgD,yEAAU;AACnF,wBAAwB,+CAA+C,wEAAS;AAChF,qBAAqB,4CAA4C,qEAAM;AACvE,qBAAqB,4CAA4C,qEAAM;AACvE,4BAA4B,mDAAmD,4EAAa;AAC5F,0BAA0B,iDAAiD,0EAAW;AACtF,0BAA0B,iDAAiD,0EAAW;AACtF,2BAA2B,kDAAkD,2EAAY;AACzF,8BAA8B,qDAAqD,8EAAe;AAClG,0BAA0B,iDAAiD,0EAAW;AACtF,6BAA6B,oDAAoD,6EAAc;AAC/F,oCAAoC,2DAA2D,oFAAqB;AACpH,8BAA8B,qDAAqD,8EAAe;AAClG,8BAA8B,qDAAqD,8EAAe;AAClG,yBAAyB,gDAAgD,yEAAU;AACnF,0BAA0B,iDAAiD,0EAAW;AACtF,2BAA2B,kDAAkD,2EAAY;AACzF,wCAAwC,+DAA+D,wFAAyB;AAChI,yBAAyB,gDAAgD,yEAAU;AACnF,oCAAoC,2DAA2D,oFAAqB;AACpH,sCAAsC,6DAA6D,sFAAuB;AAC1H,iCAAiC,wDAAwD,iFAAkB;AAC3G,gCAAgC,uDAAuD,gFAAiB;AAC/G;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,OAAO,sDAAQ;AACxB,8BAA8B,4DAAY,EAAE,2EAAoB;AAChE;AACA,wBAAwB,2EAAoB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,IAAI;AACrB;AACA;AACA,0DAA0D,WAAW;AACrE;AACA,CAAC;AACkC;AACnC,qD;;;;;;;;;;;;AC7EA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,kBAAkB,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA,kBAAkB,SAAI,IAAI,SAAI;AAC9B;AACA;AACsH;AAC9B;AACxB;AACzD;AACA;AACA;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA,QAAQ,6EAAQ;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,OAAO,uDAAS;AACzB;AACA;AACA;AACA;AACA,qCAAqC,qEAAuB;AAC5D;AACA,iBAAiB,IAAI;AACrB;AACA;AACA,0DAA0D;AAC1D,SAAS,OAAO,wDAAU,GAAG;AAC7B,SAAS,OAAO,uDAAS,GAAG;AAC5B,SAAS,OAAO,8DAAgB,GAAG;AACnC,SAAS,OAAO,sDAAQ,GAAG;AAC3B,MAAM;AACN;AACA,QAAQ,oFAAe,EAAE,0EAAa;AACtC,yCAAyC,wDAAU,EAAE,uDAAS,EAAE,8DAAgB,EAAE,sDAAQ;AAC1F;AACA;AACA,CAAC,CAAC,6EAAc;AACmB;AACnC,oD;;;;;;;;;;;;ACpQA;AAAA;AAAA;AAAA;AAAA;AAAyC;AACM;AACsB;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,OAAO,sDAAQ;AACxB,8BAA8B,4DAAY;AAC1C;AACA,wBAAwB,iFAAuB;AAC/C;AACA;AACA,wBAAwB,iFAAuB;AAC/C;AACA,iBAAiB,IAAI;AACrB;AACA;AACA,uDAAuD,WAAW;AAClE;AACA,CAAC;AAC+B;AAChC,iD;;;;;;;;;;;;ACzBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAqF;AACN;AACskB;AACpiB;AACN;AACuB;AACnF;AAC/C,iC;;;;;;;;;;;;ACPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAC4B;;;;;;;;;;;;;ACH5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,kBAAkB,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACwF;AAC3C;AACuB;AACI;AACM;AACJ;AACF;AACE;AACjB;AACF;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,gBAAgB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,yDAAI;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,oFAAc;AAChD,0CAA0C,0FAAsB;AAChE,mCAAmC,sFAAe;AAClD,iCAAiC,oFAAa;AAC9C,mCAAmC,sFAAe;AAClD,6BAA6B,qEAAS;AACtC;AACA,QAAQ,4EAAa,EAAE,2DAA2D;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,wBAAwB;AAClF,2DAA2D,mEAAmE;AAC9H;AACA;AACA,0DAA0D,2EAA2E;AACrI;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE,mEAAmE;AACrI;AACA;AACA,2DAA2D,+BAA+B;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,6BAA6B,cAAc;AACzG,kCAAkC,+EAAc;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,kEAAK;AACb;AACA;AACA,QAAQ,kEAAK;AACb;AACA;AACA,QAAQ,0EAAqB;AAC7B;AACA;AACA,CAAC,CAAC,8DAAS;AACwB;;;;;;;;;;;;;ACrcnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACiC;AACW;;;;;;;;;;;;;ACJ5C;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACsE;AACnB;AACK;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+EAA+E,+BAA+B,EAAE;AAChH,+EAA+E,+BAA+B,EAAE;AAChH;AACA;AACA,8EAA8E,2BAA2B,gCAAgC,EAAE;AAC3I,8EAA8E,2BAA2B,gCAAgC,EAAE;AAC3I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,2BAA2B,gCAAgC,EAAE;AACrG;AACA;AACA;AACA;AACA,wCAAwC,2BAA2B,gCAAgC,EAAE;AACrG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,yDAAI;AAC/B;AACA;AACA,uBAAuB,0EAAa,SAAS,8EAA8E;AAC3H;AACA,QAAQ,sEAAS;AACjB,0BAA0B,0EAAa,WAAW,sCAAsC;AACxF;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA,0DAA0D;AAC1D;AACA;AACA,2CAA2C;AAC3C;AACA,2DAA2D;AAC3D;AACA,wBAAwB,0EAAa;AACrC;AACA;AACA,0CAA0C,eAAe,eAAe;AACxE,SAAS;AACT,yDAAyD,iBAAiB,EAAE;AAC5E;AACA;AACA;AACA,QAAQ,sEAAS;AACjB,2BAA2B,0EAAa,WAAW,yDAAyD,GAAG;AAC/G;AACA;AACA;AACA,8GAA8G;AAC9G,wBAAwB,0EAAa,WAAW,oDAAoD;AACpG;AACA;AACA,6BAA6B,gEAAQ,EAAE,mJAAmJ;AAC1L;AACA;AACA;AACA;AACA,wBAAwB,0EAAa,WAAW,oDAAoD;AACpG;AACA;AACA,6BAA6B,gEAAQ,EAAE,yJAAyJ;AAChM;AACA;AACA;AACA;AACA,8HAA8H,mBAAmB;AACjJ,qEAAqE,2DAA2D,GAAG;AACnI;AACA;AACA,qIAAqI;AACrI,+HAA+H;AAC/H,sEAAsE,mBAAmB;AACzF;AACA,2CAA2C,sDAAsD;AACjG;AACA;AACA,qEAAqE,kBAAkB;AACvF;AACA,0CAA0C,oDAAoD;AAC9F;AACA,kEAAkE,gEAAgE,GAAG;AACrI;AACA;AACA;AACA,QAAQ,sEAAS;AACjB,4BAA4B,0EAAa,WAAW,yDAAyD,GAAG;AAChH;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC,sDAAsD;AACtD;AACA;AACA,kCAAkC;AAClC,qDAAqD;AACrD;AACA;AACA,gHAAgH;AAChH;AACA,6BAA6B,0EAAa,WAAW,4DAA4D;AACjH;AACA;AACA;AACA,4BAA4B,0EAAa,WAAW,wDAAwD;AAC5G;AACA;AACA,iCAAiC,qEAAc;AAC/C;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,0EAAa,WAAW,4DAA4D;AACpH;AACA;AACA;AACA,4BAA4B,0EAAa,WAAW,wDAAwD;AAC5G;AACA;AACA,iCAAiC,qEAAc;AAC/C;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,0EAAa,SAAS,wBAAwB;AACvE;AACA;AACA,yBAAyB,0EAAa,SAAS,SAAS;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiC;;;;;;;;;;;;;AC/QlC;AAAA;AAAA;AAAA;AAAA;AAA2D;AACH;AACL;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,0EAAa,SAAS,wEAAwE;AAC1H;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,yDAAI;AACnC;AACA,2BAA2B,0EAAa,SAAS,+FAA+F;AAChJ;AACA,wBAAwB,0EAAa,WAAW,oCAAoC;AACpF;AACA;AACA,2BAA2B,0EAAa;AACxC;AACA;AACA;AACA;AACA,wCAAwC,qEAAc,EAAE,wGAAwG;AAChK;AACA;AACA;AACA;AACA,yCAAyC,qEAAc,EAAE,wGAAwG;AACjK;AACA;AACA,iCAAiC,0EAAa,SAAS,0CAA0C;AACjG;AACA;AACA;AACA,8BAA8B,0EAAa,WAAW,0EAA0E;AAChI;AACA,uCAAuC,gEAAQ,EAAE,sEAAsE;AACvH;AACA;AACA;AACA;AACA,6BAA6B,0EAAa,SAAS,uDAAuD,YAAY,mCAAmC;AACzJ;AACA;AACA;AACA,+BAA+B,0EAAa,WAAW,4EAA4E,GAAG;AACtI;AACA,8BAA8B,0EAAa,UAAU,kCAAkC;AACvF;AACA;AACA;AACA;AACA;AACA;AACA,iFAAiF,2BAA2B,EAAE;AAC9G,kFAAkF,4BAA4B,EAAE;AAChH;AACA;AACA,gFAAgF,yBAAyB,4BAA4B,EAAE;AACvI,iFAAiF,0BAA0B,6BAA6B,EAAE;AAC1I;AACA;AACA;AACA,wCAAwC,yBAAyB,4BAA4B,EAAE;AAC/F;AACA;AACA;AACA;AACA,wCAAwC,0BAA0B,6BAA6B,EAAE;AACjG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;;;;;;;;;;;;;ACnL3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyF;AAChC;AACR;AAC0B;AAC9B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,gCAAgC,EAAE;AACtE;AACA;AACA;AACA;AACA;AACA,oCAAoC,6BAA6B,EAAE;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,4BAA4B,yDAAI;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,sEAAS;AACjB,oBAAoB,0EAAa,WAAW,qBAAqB,sCAAsC;AACvG;AACA;AACA;AACA;AACA;AACA,0BAA0B,0EAAa,WAAW,8CAA8C,gBAAgB,uBAAuB,GAAG;AAC1I;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,sEAAS;AACrB;AACA;AACA,oGAAoG;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0GAA0G;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8FAA8F;AAC9F,QAAQ,sEAAS;AACjB;AACA,YAAY,sEAAS;AACrB;AACA,yBAAyB,0EAAa,YAAY,8BAA8B;AAChF;AACA;AACA;AACA;AACA,2BAA2B,0EAAa,YAAY,0BAA0B;AAC9E;AACA,4BAA4B,0EAAa,YAAY,iCAAiC;AACtF;AACA;AACA;AACA;AACA;AACA,wBAAwB,0EAAa,SAAS,+BAA+B;AAC7E;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,wBAAwB;AACpE;AACA;AACA,sBAAsB,0EAAa,SAAS,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,0EAAa,YAAY,SAAS;AAC9D;AACA;AACA;AACA,sBAAsB,8DAAM;AAC5B;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA,aAAa;AACb,2BAA2B,2EAAc;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,0EAAa,SAAS,qCAAqC,aAAa,eAAe;AACzG,oBAAoB,0EAAa;AACjC,oCAAoC,cAAc;AAClD;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,2BAA2B,wEAAW;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,0EAAa,SAAS,0CAA0C,aAAa,eAAe;AAC9G,oBAAoB,0EAAa;AACjC,oCAAoC,cAAc;AAClD;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,2BAA2B,wEAAW;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,0EAAa;AACjC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,yBAAyB,0EAAa;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,0EAAa;AACjC,mCAAmC;AACnC;AACA,SAAS;AACT;AACA;AACA,uCAAuC,oBAAoB;AAC3D,yBAAyB,0EAAa;AACtC,sGAAsG,UAAU;AAChH;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,0EAAa;AACjC,mCAAmC;AACnC;AACA,SAAS;AACT;AACA,yBAAyB,0EAAa,SAAS,mEAAmE;AAClH,sBAAsB,0EAAa;AACnC;AACA,mBAAmB,0EAAa,UAAU,qBAAqB;AAC/D;AACA;AACA;AACA;AACA;AACA,yBAAyB,sEAAY;AACrC,0BAA0B,oDAAoD;AAC9E;AACA;AACA;AACA,uBAAuB,0DAAK;AAC5B,qBAAqB,wCAAwC;AAC7D;AACA;AACA;AACA,0CAA0C,MAAM,IAAI,UAAU;AAC9D;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,0BAA0B,8EAAiB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,sBAAsB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D;AAC3D;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B,+EAA+E;AAC/E;AACA,aAAa,8EAAiB;AAC9B,iFAAiF;AACjF;AACA,aAAa,8EAAiB;AAC9B,0CAA0C;AAC1C;AACA,aAAa,8EAAiB;AAC9B,2CAA2C;AAC3C;AACA;AACA,8EAA8E;AAC9E;AACA;AACA,gEAAgE;AAChE;AACA;AACA;AACA;AACA;AACA,kEAAkE,6BAA6B,EAAE;AACjG,mEAAmE,8BAA8B,EAAE;AACnG,oEAAoE,+BAA+B,EAAE;AACrG,4DAA4D,uBAAuB,EAAE;AACrF,mEAAmE,8BAA8B,EAAE;AACnG,mEAAmE,8BAA8B,EAAE;AACnG;AACA,qEAAqE,+BAA+B,EAAE;AACtG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,sEAAS;AACrB,YAAY,sEAAS;AACrB,YAAY,sEAAS;AACrB,YAAY,sEAAS;AACrB;AACA,gBAAgB,sEAAS;AACzB;AACA;AACA,gBAAgB,sEAAS;AACzB;AACA;AACA,gBAAgB,sEAAS;AACzB;AACA;AACA,gBAAgB,sEAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;;;;;;;;;;;;;ACjwBrB;AAAA;AAAA;AAAA;AAA2D;AACG;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,yDAAI;AACrC;AACA,0CAA0C;AAC1C;AACA,sBAAsB,0EAAa,SAAS,+CAA+C;AAC3F;AACA,wBAAwB,0EAAa;AACrC;AACA;AACA;AACA,oCAAoC,0EAAa,WAAW,oCAAoC,gBAAgB,gBAAgB,iBAAiB,YAAY,YAAY,kBAAkB;AAC3L,uCAAuC,0EAAa,SAAS,+BAA+B,aAAa,iBAAiB,sCAAsC;AAChK;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,0EAAa,WAAW,uBAAuB;AACxE;AACA;AACA,8BAA8B,0EAAa;AAC3C;AACA;AACA,0BAA0B,0EAAa;AACvC;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA,6BAA6B,2EAAc,EAAE,4FAA4F;AACzI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;;;;;;;;;;;;;ACtMrB;AAAA;AAAA;AAAA;AAAA;AAA2D;AACA;AACF;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,yDAAI;AACrC;AACA,4BAA4B,0EAAa,SAAS,sEAAsE;AACxH,4BAA4B,0EAAa,SAAS,+DAA+D;AACjH;AACA;AACA,wBAAwB,0EAAa,SAAS,sCAAsC;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2EAA2E,iBAAiB,EAAE;AAC9F;AACA,qEAAqE,iBAAiB,EAAE;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD;AAChD,qDAAqD;AACrD,sDAAsD;AACtD;AACA;AACA,+CAA+C;AAC/C,sDAAsD;AACtD,qDAAqD;AACrD;AACA,4BAA4B,0EAAa;AACzC;AACA,wCAAwC;AACxC,aAAa;AACb;AACA;AACA,wBAAwB,0EAAa;AACrC;AACA,aAAa;AACb;AACA;AACA,gCAAgC,0EAAa;AAC7C;AACA,yCAAyC,qBAAqB,eAAe;AAC7E,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,4DAA4D,wBAAwB,8BAA8B,GAAG,EAAE;AACvH;AACA;AACA,iCAAiC,0EAAa;AAC9C;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,mCAAmC,0EAAa;AAChD;AACA,aAAa;AACb;AACA;AACA,mCAAmC,0EAAa;AAChD;AACA,aAAa;AACb;AACA;AACA,mCAAmC,0EAAa;AAChD;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,6BAA6B,0EAAa;AAC1C;AACA;AACA;AACA;AACA;AACA,wBAAwB,0EAAa,WAAW,oCAAoC;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA,gEAAgE;AAChE;AACA,sCAAsC,0EAAa,SAAS,yBAAyB;AACrF;AACA;AACA;AACA,0CAA0C,mCAAmC;AAC7E;AACA;AACA,gCAAgC,YAAY;AAC5C;AACA;AACA;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA,wBAAwB,0EAAa,WAAW,4DAA4D;AAC5G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D;AAC3D;AACA;AACA,4DAA4D;AAC5D;AACA;AACA,kCAAkC,0EAAa,SAAS,oDAAoD,GAAG;AAC/G;AACA,oCAAoC,0EAAa,SAAS,kCAAkC;AAC5F;AACA;AACA;AACA,gDAAgD,0EAAa,WAAW,2CAA2C,YAAY,sDAAsD;AACrL;AACA,uCAAuC,gEAAQ;AAC/C;AACA;AACA,aAAa;AACb;AACA,gCAAgC,0EAAa,SAAS,kCAAkC;AACxF;AACA;AACA;AACA,sDAAsD,0EAAa,WAAW,iDAAiD,gDAAgD;AAC/K;AACA,6CAA6C,gEAAQ;AACrD;AACA;AACA,aAAa;AACb;AACA,+BAA+B,0EAAa,SAAS,kCAAkC;AACvF;AACA;AACA;AACA,2CAA2C,0EAAa,WAAW,yCAAyC,gDAAgD;AAC5J;AACA,kCAAkC,gEAAQ;AAC1C;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,0EAAa,SAAS,8CAA8C;AACpG;AACA,kDAAkD,0EAAa,YAAY,8BAA8B;AACzG;AACA,kCAAkC,8DAAM;AACxC;AACA,aAAa;AACb;AACA,kDAAkD,0EAAa,YAAY,8BAA8B;AACzG;AACA,kCAAkC,8DAAM;AACxC;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,oBAAoB,0EAAa;AACjC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+FAA+F;AAC/F;AACA;AACA;AACA,+FAA+F;AAC/F;AACA,yBAAyB,0EAAa;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,4BAA4B,0EAAa,WAAW,SAAS;AAC7D;AACA;AACA,8BAA8B,sEAAY,EAAE,qGAAqG;AACjJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;;;;;;;;;;;ACvUzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsE;AACpB;AACM;AACP;AACa;AACO;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,yDAAI;AACrC,oCAAoC,0EAAa,SAAS,2CAA2C;AACrG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,0EAAa,SAAS,sBAAsB,cAAc,4CAA4C;AACxI,4BAA4B,0EAAa,SAAS,0EAA0E;AAC5H;AACA,0BAA0B,UAAU,4CAA4C,kCAAkC,GAAG,UAAU,2CAA2C,8CAA8C;AACxN,sCAAsC,+DAAG,EAAE,2BAA2B,YAAY,iBAAiB,SAAS,iBAAiB,EAAE,kCAAkC;AACjK;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,yBAAyB,2CAA2C,0CAA0C,EAAE,MAAM,EAAE;AAChM;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2EAA2E,+BAA+B,EAAE;AAC5G,6EAA6E,iCAAiC,EAAE;AAChH,4EAA4E,gCAAgC,EAAE;AAC9G,8EAA8E,kCAAkC,EAAE;AAClH;AACA;AACA;AACA;AACA,0EAA0E,wBAAwB,gCAAgC,EAAE;AACpI,4EAA4E,0BAA0B,kCAAkC,EAAE;AAC1I,2EAA2E,yBAAyB,iCAAiC,EAAE;AACvI,6EAA6E,2BAA2B,mCAAmC,EAAE;AAC7I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,wBAAwB,gCAAgC,EAAE;AAClG;AACA;AACA;AACA;AACA,wCAAwC,2BAA2B,mCAAmC,EAAE;AACxG;AACA;AACA;AACA;AACA,wCAAwC,yBAAyB,iCAAiC,EAAE;AACpG;AACA;AACA;AACA;AACA,wCAAwC,0BAA0B,kCAAkC,EAAE;AACtG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA,0BAA0B,0EAAa,SAAS,gGAAgG;AAChJ;AACA,wBAAwB,0EAAa,WAAW,mCAAmC;AACnF;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,oBAAoB;AAC9D;AACA;AACA;AACA,YAAY,sEAAS;AACrB;AACA;AACA,iCAAiC,0EAAa,SAAS,yCAAyC;AAChG;AACA,wBAAwB,0EAAa,WAAW,oCAAoC;AACpF;AACA;AACA;AACA;AACA,4BAA4B,0EAAa,SAAS,2GAA2G,GAAG;AAChK,2BAA2B,0EAAa,SAAS,sBAAsB,+CAA+C;AACtH,uBAAuB,0EAAa,SAAS,iEAAiE;AAC9G;AACA,uBAAuB,0EAAa,SAAS,oEAAoE;AACjH;AACA,uBAAuB,0EAAa,SAAS,oEAAoE;AACjH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,0EAAa,SAAS,+BAA+B;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,sEAAS;AACrB,mCAAmC,0EAAa,YAAY,yGAAyG,YAAY,GAAG;AACpL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0EAAa,SAAS,yCAAyC;AACzF;AACA,wBAAwB,0EAAa,WAAW,oCAAoC;AACpF;AACA;AACA;AACA,4BAA4B,0EAAa,SAAS,mCAAmC;AACrF;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,0EAAa,SAAS,yCAAyC;AACnG;AACA,wBAAwB,0EAAa,WAAW,oCAAoC;AACpF;AACA;AACA;AACA,4BAA4B,0EAAa,SAAS,mEAAmE;AACrH,uBAAuB,0EAAa,SAAS,oCAAoC;AACjF;AACA,uBAAuB,0EAAa,SAAS,oCAAoC;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,0EAAa,SAAS,8DAA8D;AACpH;AACA,wBAAwB,0EAAa,WAAW,oCAAoC;AACpF;AACA;AACA;AACA,4BAA4B,0EAAa,SAAS,sDAAsD,sBAAsB;AAC9H;AACA;AACA;AACA;AACA,4DAA4D,WAAW;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,0EAAa,SAAS,4EAA4E;AACjI;AACA,wBAAwB,0EAAa,WAAW,oCAAoC;AACpF;AACA;AACA;AACA,4BAA4B,0EAAa,SAAS,4DAA4D,GAAG;AACjH;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,oCAAoC;AAChF;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,0EAAa,SAAS,sBAAsB;AAClF;AACA,kCAAkC,0EAAa,WAAW,mCAAmC;AAC7F;AACA;AACA;AACA,oCAAoC,0EAAa,WAAW,wDAAwD;AACpH;AACA;AACA,4CAA4C,qEAAc,EAAE,qFAAqF;AACjJ;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,iDAAiD;AAC7F,wBAAwB,0EAAa;AACrC,wCAAwC,cAAc,cAAc,cAAc;AAClF;AACA,aAAa;AACb;AACA;AACA,8DAA8D,uCAAuC,EAAE;AACvG;AACA,6DAA6D,iCAAiC,EAAE;AAChG;AACA,iEAAiE,mCAAmC,EAAE;AACtG;AACA,6DAA6D,iCAAiC,EAAE;AAChG;AACA,+DAA+D,iCAAiC,EAAE;AAClG;AACA,8DAA8D,iCAAiC,EAAE;AACjG;AACA,8DAA8D,iCAAiC,EAAE;AACjG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,2EAAc;AAC7C;AACA;AACA,+BAA+B,yCAAyC;AACxE;AACA;AACA;AACA;AACA,gDAAgD,4BAA4B;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,0CAA0C,EAAE;AAChF;AACA;AACA,wBAAwB,0EAAa;AACrC;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sHAAsH,iCAAiC;AACvJ;AACA;AACA;AACA,qHAAqH,iCAAiC;AACtJ;AACA,6BAA6B,0EAAa;AAC1C;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,gCAAgC,0EAAa,YAAY,yBAAyB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,2EAAc,EAAE,yFAAyF;AAC3I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,0EAAa,WAAW,SAAS;AAChE;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,kEAAW,EAAE,gGAAgG;AAC/I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,oEAAc;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,4BAA4B,0EAAa,YAAY,yBAAyB;AAC9E;AACA,sBAAsB,8DAAM;AAC5B;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;;;;;;;;;;;;;ACrmB3B;AAAA;AAAA;AAAA;AAAA;AAAqD;AACZ;AACU;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,qDAAI;AAC5B,6BAA6B,+DAAS;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,uBAAuB,0EAAa,SAAS,wEAAwE;AACrH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;;;;;;;;;;;;;ACpG1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsE;AACjB;AACJ;AACU;AACN;AACR;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,0EAAa,YAAY,SAAS;AAClE;AACA;AACA;AACA;AACA,mCAAmC,wEAAW;AAC9C;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,0EAAa,WAAW,iBAAiB,kBAAkB,EAAE;AAC5F;AACA;AACA;AACA,8CAA8C,kEAAW,EAAE,8FAA8F;AACzJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gCAAgC,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,oFAAoF,EAAE;AAC9H;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,gFAAgF,EAAE;AAC1H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,4BAA4B,yDAAI;AAChC;AACA;AACA;AACA,QAAQ,sEAAS;AACjB,oBAAoB,0EAAa,WAAW,oCAAoC;AAChF;AACA;AACA,2FAA2F;AAC3F,QAAQ,sEAAS;AACjB;AACA,YAAY,sEAAS;AACrB;AACA;AACA,yBAAyB,0EAAa;AACtC;AACA;AACA,qCAAqC,uBAAuB;AAC5D,SAAS;AACT;AACA,QAAQ,sEAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0EAAa;AACpC;AACA,qCAAqC,uBAAuB;AAC5D;AACA,SAAS;AACT;AACA,QAAQ,sEAAS;AACjB;AACA,4BAA4B,0EAAa;AACzC;AACA,yCAAyC;AACzC;AACA,SAAS;AACT;AACA,YAAY,sEAAS;AACrB;AACA;AACA,sBAAsB,0EAAa;AACnC;AACA,kEAAkE;AAClE,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0EAAa,SAAS,kFAAkF,GAAG;AAClI;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0EAAa,SAAS,6GAA6G,GAAG;AAC7J;AACA,YAAY,sEAAS;AACrB;AACA;AACA;AACA;AACA,QAAQ,sEAAS;AACjB;AACA;AACA;AACA,QAAQ,sEAAS;AACjB;AACA;AACA;AACA;AACA;AACA,qCAAqC,0EAAa;AAClD;AACA,kCAAkC;AAClC;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,+BAA+B;AAC3E;AACA;AACA,yBAAyB,0EAAa,SAAS,qBAAqB,YAAY,yBAAyB,WAAW,qBAAqB;AACzI;AACA,8BAA8B,0EAAa,SAAS,8DAA8D;AAClH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0EAAa,SAAS,0CAA0C;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,0EAAa,SAAS,wBAAwB;AAChE;AACA;AACA,kBAAkB,0EAAa,SAAS,SAAS;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,0EAAa,YAAY,SAAS;AACvD;AACA;AACA;AACA,sBAAsB,8DAAM;AAC5B;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,0EAAa;AACrC;AACA,oBAAoB,kBAAkB,0BAA0B;AAChE,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,kEAAQ;AACpC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,2CAA2C,4BAA4B;AACvE;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,uBAAuB,GAAG,oBAAoB;AACxE,aAAa,sBAAsB,GAAG,sBAAsB,GAAG,2BAA2B,GAAG,sBAAsB;AACnH,aAAa,0BAA0B,GAAG,sBAAsB,GAAG,qBAAqB,GAAG,0BAA0B;AACrH,aAAa,2BAA2B,GAAG,uBAAuB,GAAG,qBAAqB;AAC1F,aAAa,8BAA8B,GAAG,sBAAsB,GAAG;AACvE;AACA,8BAA8B,kEAAQ;AACtC;AACA,uBAAuB,0DAAK;AAC5B,qBAAqB,sCAAsC;AAC3D;AACA;AACA,uDAAuD,UAAU,IAAI,SAAS;AAC9E;AACA;AACA;AACA,SAAS;AACT,6CAA6C,4BAA4B;AACzE;AACA;AACA;AACA;AACA;AACA,gEAAgE,0BAA0B,EAAE;AAC5F,8DAA8D,wBAAwB,EAAE;AACxF,yDAAyD,4BAA4B,oBAAoB,EAAE;AAC3G,2DAA2D,4BAA4B,sBAAsB,EAAE;AAC/G,8DAA8D,4BAA4B,yBAAyB,EAAE;AACrH,kEAAkE,4BAA4B,6BAA6B,EAAE;AAC7H,gEAAgE,4BAA4B,2BAA2B,EAAE;AACzH,8DAA8D,4BAA4B,yBAAyB,EAAE;AACrH;AACA,+EAA+E,4BAA4B,6BAA6B,EAAE;AAC1I,gEAAgE,4BAA4B,2BAA2B,EAAE;AACzH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;;;;;;;;;;;;;AC/lBhB;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAC2B;;;;;;;;;;;;;ACH3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiG;AAC7B;AACnB;AACa;AACI;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,6BAA6B,0EAAa,SAAS,iCAAiC;AACpF,4BAA4B,0EAAa,SAAS,mDAAmD;AACrG;AACA;AACA;AACA;AACA,gCAAgC,0EAAa,SAAS,6CAA6C;AACnG,4BAA4B,0EAAa;AACzC;AACA;AACA;AACA;AACA;AACA,wCAAwC,8DAAM;AAC9C;AACA;AACA,SAAS;AACT;AACA,QAAQ,iEAAY;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,yGAAyG;AACzH;AACA;AACA;AACA;AACA,8BAA8B,2EAAc;AAC5C;AACA;AACA;AACA,iBAAiB,uGAAuG;AACxH,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,6BAA6B,2EAAc;AAC3C,0BAA0B,0EAAa;AACvC,oBAAoB,gEAAgE;AACpF,SAAS;AACT,2BAA2B,0EAAa;AACxC,oBAAoB,+CAA+C;AACnE,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,iEAAY;AACpB,QAAQ,iEAAY;AACpB;AACA;AACA;AACA;AACA;AACA,2BAA2B,mEAAU;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,sEAAS;AACrB;AACA;AACA,YAAY,sEAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,0EAAW;AAC3B;AACA;AACA;AACA;AACA;AACA,QAAQ,0EAAW;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,gBAAgB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,sEAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,sEAAS;AACrB;AACA;AACA,YAAY,sEAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;ACthBnB;AAAA;AAAA;AAAyD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;AC5HtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6B;AACG;AACC;;;;;;;;;;;;;ACFjC;AAAA;AAAA;AAAA;AAAyD;AACf;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,sDAAU;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,8EAAiB,kBAAkB,8EAAiB;AACnG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,sDAAU;AACjC;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;;;;;;;;;;;AC3vBzB;AAAA;AAAA;AAAA;AAAyD;AACT;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,gCAAgC,4DAAa;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,gCAAgC,4DAAa;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,2BAA2B,uBAAuB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;;;;;;;;;;;;;ACtF1B;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,kBAAkB,SAAI,IAAI,SAAI;AAC9B;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACyF;AACjB;AACtB;AACkC;AACpD;AACsB;AACuB;AACxC;AACD;AACY;AACd;AACD;AACK;AACD;AACA;AACC;AACC;AACF;AACuE;AACZ;AACgB;AAChH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,uDAAgB;AAC3C,2BAA2B,iDAAU;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,0CAA0C,8EAAiB;AAC3D;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,8EAAiB;AACjE,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,sCAAsC,8EAAiB,uBAAuB,8EAAiB;AAC/F,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,8EAAiB;AAChE,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,gBAAgB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,yDAAI;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,mDAAY;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,4DAAO;AACtD;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,qCAAqC,8CAAO;AAC5C,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,4CAAK,EAAE,iDAAU,EAAE,iDAAU,EAAE,iDAAU,EAAE,gDAAS,EAAE,6CAAM,EAAE,6CAAM,EAAE,mDAAY,EAAE,oDAAa,EAAE,kDAAW,EAAE,kDAAW,EAAE,sDAAe,EAAE,kDAAW,EAAE,qDAAc,EAAE,4DAAqB,EAAE,sDAAe,EAAE,kDAAW,EAAE,iDAAU,EAAE,sDAAe,EAAE,gEAAyB,EAAE,iDAAU,EAAE,4DAAqB,EAAE,8DAAuB,EAAE,yDAAkB,EAAE,wDAAiB,EAAE,mDAAY;AACva;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE,iDAAU;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,WAAW;AAC1B;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,YAAY,+DAAI;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,0BAA0B,iDAAU;AACpC;AACA,oCAAoC,qDAAc;AAClD,4BAA4B,sDAAe;AAC3C;AACA,wCAAwC,uDAAgB;AACxD,wCAAwC,uDAAgB;AACxD;AACA;AACA;AACA;AACA;AACA,iDAAiD,WAAW,YAAY,gBAAgB,gBAAgB,qBAAqB,qBAAqB,EAAE;AACpJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,6BAA6B,8EAAiB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,qEAAQ;AAChB;AACA;AACA,QAAQ,kEAAK;AACb;AACA;AACA,QAAQ,kEAAK;AACb;AACA;AACA,QAAQ,kEAAK;AACb;AACA;AACA,QAAQ,kEAAK;AACb;AACA;AACA,QAAQ,kEAAK;AACb;AACA;AACA,QAAQ,kEAAK;AACb;AACA;AACA,QAAQ,kEAAK;AACb;AACA;AACA,QAAQ,kEAAK;AACb;AACA;AACA,QAAQ,kEAAK;AACb;AACA;AACA,QAAQ,kEAAK;AACb;AACA;AACA,QAAQ,0EAAqB;AAC7B;AACA;AACA,CAAC,CAAC,8DAAS;AACe;;;;;;;;;;;;;ACv8C1B;AAAA;AAAA;AAAA;AAAA;AAAkE;AACQ;AAC1B;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,aAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,yDAAI;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,uCAAuC,uEAAI;AAC3C;AACA;AACA,gBAAgB,sEAAS;AACzB;AACA;AACA;AACA;AACA;AACA,gBAAgB,sEAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,sEAAS;AACjB,QAAQ,sEAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,sEAAS;AACjB,QAAQ,sEAAS;AACjB,QAAQ,sEAAS;AACjB,QAAQ,sEAAS;AACjB,QAAQ,sEAAS;AACjB,sDAAsD,8EAAiB;AACvE,QAAQ,sEAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;AClhBvB;AAAA;AAAA;AAAA;AAAA;AAAiD;AACA;AAC6B;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,qCAAqC;AACjF;AACA,wBAAwB,0EAAa,SAAS,4DAA4D;AAC1G;AACA,wBAAwB,0EAAa,SAAS,iCAAiC;AAC/E;AACA,wBAAwB,0EAAa,SAAS,+BAA+B;AAC7E;AACA;AACA;AACA;AACA,yBAAyB,0EAAa,SAAS,qCAAqC;AACpF;AACA;AACA,4BAA4B,0EAAa,WAAW,iFAAiF,oBAAoB,EAAE;AAC3J;AACA;AACA,0BAA0B,0EAAa,SAAS,+DAA+D;AAC/G;AACA;AACA,oCAAoC,8DAAQ;AAC5C;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,wBAAwB,0EAAa,SAAS,iCAAiC;AAC/E;AACA,2BAA2B,0EAAa,SAAS,oCAAoC;AACrF;AACA,+BAA+B,0EAAa,YAAY,sDAAsD;AAC9G;AACA,6BAA6B,8DAAM,EAAE,8BAA8B;AACnE;AACA;AACA;AACA;AACA;AACA,8BAA8B,0EAAa,SAAS,uCAAuC;AAC3F;AACA,kCAAkC,0EAAa,YAAY,4DAA4D;AACvH;AACA,gCAAgC,8DAAM,EAAE,8BAA8B;AACtE;AACA;AACA;AACA,4BAA4B,0EAAa,SAAS,qCAAqC;AACvF;AACA,gCAAgC,0EAAa,YAAY,yDAAyD;AAClH;AACA,8BAA8B,8DAAM,EAAE,8BAA8B;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,yDAAI;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;;;;;;;;;;;;;ACrK1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8E;AACtB;AACiC;AAChC;AACJ;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,yDAAW;AACzC,+BAA+B,0DAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,sDAAQ;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,sDAAQ;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,sDAAQ;AACvD,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA,oFAAoF,sDAAQ;AAC5F;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA,+CAA+C,sDAAQ;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,sDAAQ;AACxD,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA,qFAAqF,sDAAQ;AAC7F;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA,gDAAgD,sDAAQ;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa;AACnC;AACA;AACA,SAAS;AACT,0BAA0B,0EAAa;AACvC,uFAAuF,UAAU;AACjG;AACA,SAAS;AACT,+BAA+B,0EAAa;AAC5C,2CAA2C,mBAAmB,WAAW,aAAa,cAAc,mBAAmB;AACvH;AACA,SAAS;AACT;AACA;AACA,kDAAkD;AAClD;AACA;AACA,kDAAkD;AAClD;AACA,6BAA6B,0EAAa;AAC1C;AACA,2CAA2C,mBAAmB,yCAAyC,aAAa,cAAc,mBAAmB,mBAAmB,oBAAoB;AAC5L;AACA,SAAS;AACT;AACA;AACA,oDAAoD;AACpD;AACA;AACA,mDAAmD;AACnD;AACA,8BAA8B,0EAAa;AAC3C;AACA,2CAA2C,mBAAmB,yCAAyC,aAAa,cAAc,aAAa,mBAAmB;AAClK;AACA,SAAS;AACT,wBAAwB,0EAAa;AACrC,8EAA8E,qBAAqB;AACnG;AACA,SAAS;AACT,2BAA2B,0EAAa;AACxC;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,0EAAa;AACrC,6EAA6E,kBAAkB,qBAAqB;AACpH;AACA,SAAS;AACT,2BAA2B,0EAAa;AACxC;AACA,SAAS;AACT,wBAAwB,0EAAa;AACrC,oFAAoF;AACpF;AACA,SAAS;AACT,uCAAuC,0EAAa;AACpD,oBAAoB,kBAAkB;AACtC;AACA,iCAAiC,mBAAmB,WAAW;AAC/D;AACA,SAAS;AACT,0BAA0B,0EAAa;AACvC,gFAAgF,mBAAmB;AACnG;AACA,SAAS;AACT,+BAA+B,0EAAa;AAC5C;AACA,SAAS;AACT;AACA;AACA,kDAAkD;AAClD;AACA;AACA,iDAAiD;AACjD;AACA,uBAAuB,0EAAa;AACpC;AACA;AACA,SAAS;AACT,2BAA2B,0EAAa;AACxC;AACA,iDAAiD,mBAAmB;AACpE;AACA,SAAS;AACT,8BAA8B,0EAAa;AAC3C;AACA,SAAS;AACT,sBAAsB,0EAAa;AACnC;AACA;AACA,SAAS;AACT,0BAA0B,0EAAa;AACvC;AACA,iDAAiD,mBAAmB;AACpE;AACA,SAAS;AACT,8BAA8B,0EAAa;AAC3C;AACA,SAAS;AACT,sBAAsB,0EAAa;AACnC;AACA;AACA,SAAS;AACT,0BAA0B,0EAAa;AACvC;AACA,iDAAiD,mBAAmB;AACpE;AACA,SAAS;AACT,iCAAiC,0EAAa;AAC9C;AACA,SAAS;AACT,yBAAyB,0EAAa;AACtC;AACA;AACA,SAAS;AACT,6BAA6B,0EAAa;AAC1C;AACA,iDAAiD,mBAAmB;AACpE;AACA,SAAS;AACT,kCAAkC,0EAAa;AAC/C;AACA,SAAS;AACT,iCAAiC,0EAAa;AAC9C;AACA,SAAS;AACT,iCAAiC,0EAAa;AAC9C;AACA,SAAS;AACT,oCAAoC,0EAAa;AACjD;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD;AACtD;AACA;AACA,qDAAqD;AACrD;AACA,0BAA0B,0EAAa;AACvC;AACA,wCAAwC,UAAU;AAClD,SAAS;AACT,0BAA0B,0EAAa;AACvC,iCAAiC,aAAa,mBAAmB,YAAY,UAAU;AACvF;AACA,SAAS;AACT,uCAAuC,0EAAa;AACpD,wCAAwC,UAAU,aAAa,WAAW,UAAU,0BAA0B;AAC9G;AACA;AACA,SAAS;AACT,sCAAsC,0EAAa;AACnD,wCAAwC,WAAW,cAAc,WAAW,UAAU,wBAAwB;AAC9G;AACA;AACA,SAAS;AACT,kCAAkC,0EAAa;AAC/C,gCAAgC,aAAa,mBAAmB,WAAW,UAAU;AACrF;AACA;AACA,SAAS;AACT,oCAAoC,0EAAa;AACjD,iCAAiC,YAAY,mBAAmB,WAAW,UAAU;AACrF;AACA;AACA,SAAS;AACT;AACA;AACA,iDAAiD;AACjD;AACA;AACA,gDAAgD;AAChD;AACA,yCAAyC,0EAAa;AACtD,+BAA+B,mBAAmB;AAClD,SAAS;AACT,gCAAgC,0EAAa;AAC7C;AACA;AACA,SAAS;AACT,4CAA4C,0EAAa;AACzD,+BAA+B,mBAAmB;AAClD,SAAS;AACT,mCAAmC,0EAAa;AAChD;AACA;AACA,SAAS;AACT,4CAA4C,0EAAa;AACzD,gCAAgC,mBAAmB;AACnD,SAAS;AACT,mCAAmC,0EAAa;AAChD;AACA;AACA,SAAS;AACT,+CAA+C,0EAAa;AAC5D,gCAAgC,mBAAmB,WAAW;AAC9D,SAAS;AACT,sCAAsC,0EAAa;AACnD;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD;AACvD,0DAA0D;AAC1D;AACA;AACA,6CAA6C,0EAAa;AAC1D,gCAAgC,mBAAmB;AACnD;AACA,SAAS;AACT,oCAAoC,0EAAa;AACjD;AACA;AACA,SAAS;AACT,+CAA+C,0EAAa;AAC5D,gCAAgC,mBAAmB;AACnD;AACA,SAAS;AACT,sCAAsC,0EAAa;AACnD;AACA;AACA,SAAS;AACT,8CAA8C,0EAAa;AAC3D,gCAAgC,mBAAmB;AACnD;AACA,SAAS;AACT,qCAAqC,0EAAa;AAClD;AACA;AACA,SAAS;AACT,gDAAgD,0EAAa;AAC7D,gCAAgC,oBAAoB,aAAa;AACjE,SAAS;AACT,uCAAuC,0EAAa;AACpD;AACA;AACA,SAAS;AACT,2CAA2C,0EAAa;AACxD;AACA;AACA,SAAS;AACT,8CAA8C,0EAAa;AAC3D;AACA;AACA,SAAS;AACT,8CAA8C,0EAAa;AAC3D;AACA;AACA,SAAS;AACT,iDAAiD,0EAAa;AAC9D;AACA;AACA,SAAS;AACT,+CAA+C,0EAAa;AAC5D;AACA;AACA,SAAS;AACT,iDAAiD,0EAAa;AAC9D;AACA;AACA,SAAS;AACT,gDAAgD,0EAAa;AAC7D;AACA;AACA,SAAS;AACT,kDAAkD,0EAAa;AAC/D;AACA;AACA,SAAS;AACT;AACA;AACA,kDAAkD;AAClD;AACA;AACA,kDAAkD;AAClD;AACA,+BAA+B,0EAAa;AAC5C;AACA,0CAA0C,kBAAkB,iCAAiC,YAAY,aAAa,YAAY,mBAAmB,iBAAiB;AACtK;AACA,SAAS;AACT,0BAA0B,0EAAa;AACvC;AACA,uCAAuC,UAAU;AACjD,SAAS;AACT,uBAAuB,0EAAa,SAAS,uBAAuB,GAAG;AACvE,oBAAoB,0EAAa;AACjC;AACA,+BAA+B,WAAW;AAC1C,SAAS;AACT,wCAAwC,0EAAa;AACrD,oBAAoB,kBAAkB;AACtC,+EAA+E,UAAU,WAAW,YAAY;AAChH,SAAS;AACT;AACA;AACA,2CAA2C;AAC3C;AACA;AACA,4CAA4C;AAC5C;AACA,uBAAuB,0EAAa;AACpC,uCAAuC,SAAS,oCAAoC;AACpF,SAAS;AACT,kBAAkB,0EAAa;AAC/B,iCAAiC,qBAAqB;AACtD;AACA,SAAS;AACT,sBAAsB,0EAAa,SAAS,sBAAsB,kBAAkB,GAAG;AACvF,+BAA+B,0EAAa;AAC5C;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,qEAAc;AAC7C;AACA;AACA,SAAS;AACT;AACA,+BAA+B,sEAAY;AAC3C;AACA;AACA,SAAS;AACT;AACA,oCAAoC,sEAAY;AAChD;AACA;AACA,SAAS;AACT;AACA,qCAAqC,kEAAW;AAChD;AACA;AACA,SAAS;AACT;AACA,sCAAsC,kEAAW;AACjD;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,yBAAyB,qDAAO;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,yDAAI;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,kBAAkB,8EAAiB;AACjE;AACA,gBAAgB,8EAAiB,yBAAyB,8EAAiB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkC;;;;;;;;;;;;;ACnoCnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8E;AAC5B;AACb;AACiB;AACN;AACsB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,2DAAU;AAC1C,0CAA0C,8EAAiB;AAC3D;AACA;AACA;AACA;AACA,oDAAoD,8EAAiB;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,4EAA4E;AACxH,wBAAwB,0EAAa,SAAS,6EAA6E;AAC3H;AACA;AACA;AACA;AACA,yBAAyB,+DAAG;AAC5B;AACA;AACA,6BAA6B,0CAA0C;AACvE;AACA;AACA,iBAAiB;AACjB;AACA,6BAA6B,wCAAwC;AACrE;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,4BAA4B,0EAAa,SAAS,4DAA4D;AAC9G;AACA;AACA,oBAAoB,0EAAa;AACjC,oCAAoC,cAAc;AAClD;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,0EAAa;AACjC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,yBAAyB,0EAAa;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,oBAAoB,0EAAa;AACjC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,yBAAyB,0EAAa;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,oBAAoB,0EAAa;AACjC,mCAAmC;AACnC;AACA,SAAS;AACT;AACA;AACA,yBAAyB,0EAAa,SAAS,iGAAiG;AAChJ,wBAAwB,0EAAa,SAAS,qBAAqB;AACnE;AACA;AACA;AACA;AACA;AACA,4BAA4B,0EAAa,SAAS,yEAAyE;AAC3H;AACA;AACA,oBAAoB,0EAAa;AACjC,oCAAoC,cAAc;AAClD;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,kCAAkC,8EAAW;AAC7C;AACA,YAAY,8EAAiB;AAC7B,uCAAuC,gDAAK;AAC5C;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,oCAAoC,iEAAa;AACjD;AACA,yBAAyB,yDAAI;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,uBAAuB,4BAA4B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoC;AACrC;;;;;;;;;;;;;ACvXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmD;AACK;AACjB;AACuC;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC,+CAA+C,kDAAW;AAC1D;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa;AACnC;AACA,SAAS;AACT,uBAAuB,0EAAa,SAAS,uBAAuB,mBAAmB,cAAc,GAAG;AACxG,4BAA4B,0EAAa;AACzC;AACA,SAAS;AACT;AACA;AACA,oBAAoB,0EAAa;AACjC,kCAAkC,oBAAoB;AACtD,SAAS;AACT,iBAAiB,0EAAa;AAC9B,iBAAiB,0EAAa,QAAQ,sCAAsC;AAC5E,kCAAkC,0EAAa;AAC/C,oBAAoB,qBAAqB;AACzC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,gEAAQ;AAC/C;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,yDAAI;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,8EAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,wBAAwB,0EAAa,WAAW,oCAAoC;AACpF,sBAAsB,0EAAa,QAAQ,uBAAuB,GAAG;AACrE,sBAAsB,0EAAa;AACnC,2BAA2B,0EAAa;AACxC;AACA;AACA,aAAa;AACb,6BAA6B,0EAAa;AAC1C,wBAAwB,iBAAiB;AACzC,aAAa;AACb;AACA;AACA,sBAAsB,0EAAa,QAAQ,sCAAsC;AACjF,4BAA4B,0EAAa;AACzC;AACA;AACA,aAAa;AACb,8BAA8B,0EAAa;AAC3C,wBAAwB,iBAAiB;AACzC;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,QAAQ,uBAAuB,GAAG;AACrE,sBAAsB,0EAAa,QAAQ,oBAAoB,GAAG;AAClE,8BAA8B,0EAAa;AAC3C;AACA;AACA,aAAa;AACb,gCAAgC,0EAAa;AAC7C,wBAAwB,iBAAiB;AACzC;AACA,aAAa;AACb;AACA;AACA,sBAAsB,0EAAa,QAAQ,oBAAoB,GAAG;AAClE,6BAA6B,0EAAa;AAC1C;AACA;AACA,aAAa;AACb,+BAA+B,0EAAa;AAC5C,wBAAwB,iBAAiB;AACzC;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,qEAAc;AACpD;AACA;AACA,aAAa;AACb;AACA,uCAAuC,qEAAc;AACrD;AACA;AACA,aAAa;AACb;AACA,yCAAyC,qEAAc;AACvD;AACA;AACA,aAAa;AACb;AACA,wCAAwC,qEAAc;AACtD;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,CAAC;AAC4B;;;;;;;;;;;;;AC3V7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8E;AACX;AAChB;AACW;AACT;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,+BAA+B,SAAS;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,yEAAgB;AAC7C;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa;AACnC,oBAAoB,aAAa;AACjC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,2DAA2D;AACvG;AACA;AACA;AACA;AACA,uBAAuB,0EAAa,SAAS,iDAAiD,GAAG;AACjG,4BAA4B,0EAAa,SAAS,+DAA+D;AACjH,6BAA6B,0EAAa;AAC1C;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,0EAAa,SAAS,6BAA6B;AAChF,gCAAgC,0EAAa;AAC7C;AACA;AACA,SAAS;AACT,sBAAsB,0EAAa;AACnC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,0EAAa,SAAS,kEAAkE;AACxH;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,kEAAW;AAC1C;AACA,SAAS;AACT;AACA,oCAAoC,gEAAQ;AAC5C;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,uCAAuC,gEAAQ;AAC/C;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,6BAA6B,gEAAQ;AACrC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,+BAA+B,gEAAQ;AACvC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,0EAAa,SAAS,gGAAgG;AACxI,0BAA0B,0EAAa,SAAS,0CAA0C;AAC1F,wBAAwB,0EAAa,WAAW,2EAA2E;AAC3H,yCAAyC,eAAe,YAAY;AACpE,mBAAmB,0EAAa,YAAY,mDAAmD;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0EAAa;AACvC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,6BAA6B,0EAAa,WAAW,qDAAqD;AAC1G;AACA,2BAA2B,0EAAa,YAAY,oDAAoD;AACxG;AACA;AACA;AACA;AACA,gCAAgC,kEAAQ,EAAE,sFAAsF;AAChI;AACA;AACA,iCAAiC,sEAAY,EAAE,uFAAuF;AACtI;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,0DAA0D;AACtG,0BAA0B,0EAAa,SAAS,0BAA0B;AAC1E,4BAA4B,0EAAa;AACzC;AACA;AACA,SAAS;AACT,6BAA6B,0EAAa,YAAY,mCAAmC;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,oFAAoF,GAAG;AACnI;AACA;AACA;AACA,yBAAyB,0EAAa,WAAW,iFAAiF;AAClI,4CAA4C,eAAe,YAAY;AACvE,0BAA0B,0EAAa,YAAY,uDAAuD;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,kEAAQ,EAAE,wFAAwF;AAClI;AACA;AACA,iCAAiC,sEAAY,EAAE,uFAAuF;AACtI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,yDAAI;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;AACtB;;;;;;;;;;;;;ACplBA;AAAA;AAAA;AAAA;AAAA;AAA8E;AACrB;AACN;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,uCAAuC;AAClE;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,sCAAsC;AAClF,wBAAwB,0EAAa;AACrC,0BAA0B,0EAAa,SAAS,8FAA8F;AAC9I,8BAA8B,0EAAa,WAAW,oGAAoG;AAC1J;AACA;AACA;AACA,2BAA2B,0EAAa,SAAS,sFAAsF;AACvI,0BAA0B,0EAAa,WAAW,wGAAwG,oBAAoB,EAAE;AAChL;AACA;AACA;AACA;AACA,2BAA2B,0EAAa,SAAS,uBAAuB,GAAG;AAC3E,2BAA2B,0EAAa,SAAS,uFAAuF;AACxI,kCAAkC,0EAAa,SAAS,2CAA2C;AACnG;AACA,4BAA4B,0EAAa,WAAW,0CAA0C;AAC9F;AACA;AACA,oCAAoC,sEAAY,EAAE,uJAAuJ;AACzM;AACA;AACA;AACA;AACA;AACA,+BAA+B,0EAAa,SAAS,sEAAsE;AAC3H,4BAA4B,0EAAa,WAAW,SAAS,mBAAmB,kFAAkF;AAClK;AACA,oCAAoC,gEAAQ;AAC5C;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,yDAAI;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;;;;;;;;;;;;;AClS3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACmC;AACJ;AACG;AACS;AACP;AACD;AACL;AACC;AACgB;AACjB;AACY;AACG;AACN;AACD;AACN;;;;;;;;;;;;;ACjBhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwD;AACG;AACF;AACzD;AACqE;AACf;AACE;AACC;AACR;AACC;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA,gBAAgB,8EAAiB;AACjC,sDAAsD,8DAAgB;AACtE;AACA,iBAAiB,8EAAiB;AAClC,sDAAsD,8DAAgB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA,kCAAkC,8DAAa;AAC/C;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA,gBAAgB,8EAAiB;AACjC,sDAAsD,8DAAgB;AACtE;AACA,gBAAgB,8EAAiB;AACjC,sDAAsD,8DAAgB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,8DAAa;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,oDAAoD,mEAAc;AAClE;AACA;AACA;AACA,yDAAyD,iEAAa,KAAK,8EAAiB;AAC5F;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,yDAAI;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,qCAAqC;AACjF;AACA,2BAA2B,0EAAa,SAAS,iFAAiF,yJAAyJ,uHAAuH,6kBAA6kB;AAC/9B;AACA,kBAAkB,0EAAa;AAC/B;AACA;AACA,gDAAgD,cAAc,YAAY;AAC1E;AACA;AACA,+CAA+C,cAAc;AAC7D;AACA;AACA,6BAA6B,0EAAa,SAAS,+FAA+F,sJAAsJ,4HAA4H,gxBAAgxB,2IAA2I;AAC/zC;AACA;AACA,+BAA+B,0EAAa,SAAS,kIAAkI,sPAAsP,yIAAyI,yHAAyH,0HAA0H;AACzyB;AACA;AACA;AACA;AACA,kDAAkD,kBAAkB;AACpE;AACA;AACA,kDAAkD;AAClD;AACA;AACA,yBAAyB,0EAAa,SAAS,ylBAAylB,oWAAoW,gJAAgJ;AAC5nC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qEAAc;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,8BAA8B,qEAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,6BAA6B,qEAAc;AAC3C;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oCAAoC,sEAAY,EAAE,mGAAmG;AACrJ;AACA;AACA;AACA,oCAAoC,sEAAY,EAAE,yGAAyG;AAC3J;AACA;AACA;AACA,+BAA+B,sEAAY,EAAE,sGAAsG;AACnJ;AACA;AACA;AACA;AACA,6BAA6B,sEAAY,EAAE,yDAAyD;AACpG;AACA;AACA,qCAAqC,8DAAO,EAAE,aAAa;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,OAAO;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;AACtB;;;;;;;;;;;;;AC3cA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAqE;AAChC;AACiB;AACN;AACS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,iEAAa;AACxD;AACA;AACA,2CAA2C,2DAAU;AACrD,uDAAuD,8DAAgB;AACvE,uDAAuD,8DAAgB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,wBAAwB,gDAAK;AAC7B;AACA,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA,4BAA4B,2DAAU;AACtC,wCAAwC,8DAAgB;AACxD;AACA;AACA,wCAAwC,8DAAgB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,gBAAgB,8EAAiB;AAC/D,uGAAuG,OAAO;AAC9G,uCAAuC,2DAAU;AACjD,mDAAmD,8DAAgB;AACnE,mDAAmD,8DAAgB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;;;;;;;;;;;ACzLzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwD;AACG;AACF;AACO;AACP;AACY;AACnB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,2EAAc;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,oDAAoD;AAChG,6BAA6B,0EAAa,SAAS,6CAA6C;AAChG;AACA,yBAAyB,0EAAa;AACtC,mFAAmF,YAAY;AAC/F,SAAS;AACT,wBAAwB,0EAAa;AACrC,sFAAsF,YAAY;AAClG,SAAS;AACT,yBAAyB,0EAAa;AACtC,yFAAyF,YAAY;AACrG,SAAS;AACT;AACA,oBAAoB,0EAAa,SAAS,oFAAoF;AAC9H,8BAA8B,0EAAa,SAAS,4BAA4B;AAChF,2BAA2B,0EAAa;AACxC;AACA,SAAS;AACT,0BAA0B,0EAAa;AACvC;AACA,SAAS;AACT,2BAA2B,0EAAa;AACxC;AACA,SAAS;AACT;AACA;AACA;AACA,+BAA+B,0EAAa,SAAS,yBAAyB;AAC9E,4BAA4B,0EAAa,SAAS,wCAAwC;AAC1F,2BAA2B,0EAAa,SAAS,uCAAuC;AACxF,4BAA4B,0EAAa,SAAS,wCAAwC;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,+DAAG,EAAE,mBAAmB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,0EAAa;AACrC;AACA,kFAAkF;AAClF,SAAS;AACT;AACA,4BAA4B,0EAAa,SAAS,yEAAyE;AAC3H;AACA;AACA,6BAA6B,0EAAa,SAAS,uDAAuD;AAC1G;AACA;AACA;AACA;AACA;AACA,uBAAuB,0EAAa;AACpC;AACA,uEAAuE,YAAY;AACnF,SAAS;AACT,yBAAyB,0EAAa;AACtC,oBAAoB,iBAAiB;AACrC,SAAS;AACT,6BAA6B,0EAAa;AAC1C;AACA;AACA,SAAS;AACT,4BAA4B,0EAAa;AACzC,oBAAoB,iBAAiB;AACrC;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,2BAA2B,0EAAa;AACxC,yHAAyH,YAAY;AACrI;AACA,SAAS;AACT,0BAA0B,0EAAa;AACvC,oBAAoB,iBAAiB;AACrC,SAAS;AACT,yBAAyB,0EAAa;AACtC;AACA;AACA,SAAS;AACT,2BAA2B,0EAAa;AACxC,oBAAoB,iBAAiB;AACrC;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,gCAAgC,qEAAc,EAAE,qCAAqC;AACrF;AACA,iCAAiC,qEAAc,EAAE,qCAAqC;AACtF;AACA,mCAAmC,qEAAc,EAAE,qCAAqC;AACxF;AACA,kCAAkC,qEAAc,EAAE,qCAAqC;AACvF;AACA;AACA,6BAA6B,0EAAa,SAAS,6EAA6E;AAChI;AACA,kCAAkC,0EAAa,SAAS,uHAAuH;AAC/K,iCAAiC,0EAAa,SAAS,mDAAmD,sDAAsD;AAChK;AACA;AACA,oDAAoD;AACpD;AACA;AACA,qDAAqD;AACrD;AACA,0BAA0B,0EAAa,SAAS,gDAAgD;AAChG,uBAAuB,0EAAa;AACpC,oBAAoB,wBAAwB;AAC5C,SAAS;AACT,2BAA2B,0EAAa,SAAS,sBAAsB;AACvE,wBAAwB,0EAAa;AACrC,oBAAoB,wBAAwB;AAC5C,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mEAAW,EAAE,kGAAkG;AAC3I,6BAA6B,mEAAW,EAAE,qFAAqF;AAC/H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa;AACnC;AACA;AACA,SAAS;AACT;AACA,0BAA0B,0EAAa,SAAS,uEAAuE;AACvH;AACA;AACA,2BAA2B,0EAAa,SAAS,uDAAuD;AACxG;AACA;AACA;AACA;AACA;AACA,yBAAyB,0EAAa;AACtC;AACA,yEAAyE,YAAY;AACrF,SAAS;AACT,2BAA2B,0EAAa;AACxC,oBAAoB,iBAAiB;AACrC,SAAS;AACT;AACA;AACA,0BAA0B,0EAAa;AACvC,2HAA2H,YAAY;AACvI;AACA,SAAS;AACT,4BAA4B,0EAAa;AACzC,oBAAoB,iBAAiB;AACrC,SAAS;AACT;AACA;AACA;AACA,4BAA4B,qEAAc,EAAE,sCAAsC;AAClF;AACA,6BAA6B,qEAAc,EAAE,sCAAsC;AACnF;AACA;AACA,2BAA2B,0EAAa,SAAS,2CAA2C,mDAAmD;AAC/I,wBAAwB,0EAAa;AACrC,oEAAoE,qBAAqB;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,6BAA6B,sEAAY,EAAE,mEAAmE;AAC9G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,0EAAa,SAAS,2EAA2E;AACzH;AACA,2BAA2B,0EAAa,SAAS,4CAA4C,qDAAqD;AAClJ,wBAAwB,0EAAa;AACrC,oBAAoB,qBAAqB;AACzC,SAAS;AACT;AACA;AACA,2BAA2B,0EAAa,SAAS,4CAA4C,sDAAsD;AACnJ,wBAAwB,0EAAa;AACrC,oBAAoB,qBAAqB;AACzC,SAAS;AACT;AACA;AACA;AACA,6BAA6B,gEAAQ,EAAE,wEAAwE;AAC/G,6BAA6B,gEAAQ,EAAE,sEAAsE;AAC7G;AACA;AACA;AACA;AACA,2BAA2B,0EAAa,SAAS,kEAAkE;AACnH,wBAAwB,0EAAa;AACrC;AACA,SAAS;AACT;AACA;AACA;AACA,0BAA0B,0EAAa,SAAS,oGAAoG,GAAG;AACvJ;AACA,4BAA4B,0EAAa,SAAS,+EAA+E;AACjI;AACA;AACA,6BAA6B,0EAAa,SAAS,0DAA0D;AAC7G;AACA;AACA;AACA;AACA;AACA,0BAA0B,0EAAa;AACvC;AACA,0EAA0E,YAAY;AACtF,SAAS;AACT,wBAAwB,0EAAa;AACrC,oBAAoB,iBAAiB;AACrC,SAAS;AACT;AACA;AACA,0BAA0B,0EAAa;AACvC,2HAA2H,YAAY;AACvI;AACA,SAAS;AACT,wBAAwB,0EAAa;AACrC,oBAAoB,iBAAiB;AACrC,SAAS;AACT;AACA;AACA;AACA,6BAA6B,qEAAc,EAAE,sCAAsC;AACnF;AACA,6BAA6B,qEAAc,EAAE,sCAAsC;AACnF;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,yDAAI;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;;;;;;;;;;;;;ACznB3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwD;AACG;AACF;AACA;AACb;AACU;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,8EAAiB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,8EAAiB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,uDAAgB;AACjD;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,+CAA+C;AAC3F;AACA,kBAAkB,0EAAa,SAAS,0CAA0C,GAAG;AACrF,yBAAyB,0EAAa,SAAS,6DAA6D;AAC5G;AACA,uBAAuB,0EAAa,SAAS,0GAA0G;AACvJ,yBAAyB,0EAAa,SAAS,4GAA4G;AAC3J,wBAAwB,0EAAa;AACrC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,uBAAuB,0EAAa;AACpC;AACA;AACA,SAAS;AACT,qBAAqB,0EAAa,SAAS,kDAAkD;AAC7F,qBAAqB,0EAAa,SAAS,yDAAyD;AACpG,0BAA0B,0EAAa,WAAW,0BAA0B;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,0EAAa,SAAS,yDAAyD;AACpG,0BAA0B,0EAAa,WAAW,0BAA0B;AAC5E;AACA;AACA;AACA;AACA,6BAA6B,mEAAW;AACxC;AACA;AACA,SAAS;AACT;AACA,6BAA6B,mEAAW;AACxC;AACA;AACA,SAAS;AACT;AACA;AACA,2BAA2B,0EAAa,SAAS,4CAA4C,mEAAmE;AAChK,+BAA+B,0EAAa,SAAS,2CAA2C,kBAAkB,GAAG;AACrH;AACA;AACA,gCAAgC,0EAAa,SAAS,sEAAsE,kBAAkB,GAAG;AACjJ;AACA;AACA,yBAAyB,0EAAa,SAAS,0CAA0C,cAAc,6CAA6C;AACpJ,6BAA6B,0EAAa,SAAS,yCAAyC,kBAAkB,GAAG;AACjH;AACA;AACA,8BAA8B,0EAAa,SAAS,sEAAsE,kBAAkB,GAAG;AAC/I;AACA;AACA,0BAA0B,0EAAa;AACvC;AACA,SAAS;AACT,8BAA8B,0EAAa;AAC3C;AACA;AACA,SAAS;AACT;AACA,yBAAyB,0EAAa,WAAW,sCAAsC,iBAAiB,EAAE;AAC1G,2BAA2B,0EAAa,SAAS,4GAA4G;AAC7J,sBAAsB,0EAAa;AACnC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,0EAAa,SAAS,8GAA8G;AACjK,0BAA0B,0EAAa,WAAW,uCAAuC,iBAAiB,EAAE;AAC5G;AACA,sBAAsB,0EAAa,WAAW,kGAAkG;AAChJ,iBAAiB,0EAAa,WAAW,8BAA8B,iBAAiB,EAAE;AAC1F;AACA;AACA;AACA;AACA;AACA,yBAAyB,0EAAa,SAAS,4GAA4G;AAC3J,0BAA0B,0EAAa,SAAS,0GAA0G;AAC1J;AACA,4BAA4B,0EAAa,WAAW,yCAAyC,iBAAiB,EAAE;AAChH,6BAA6B,0EAAa,SAAS,mHAAmH;AACtK;AACA,0BAA0B,0EAAa;AACvC,+DAA+D;AAC/D;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,0EAAa,SAAS,wGAAwG;AACvJ,2BAA2B,0EAAa,WAAW,wCAAwC,iBAAiB,EAAE;AAC9G;AACA,sBAAsB,0EAAa,SAAS,kGAAkG;AAC9I,4BAA4B,0EAAa,WAAW,yCAAyC,iBAAiB,EAAE;AAChH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,qEAAc;AAC9C;AACA,SAAS;AACT;AACA,iCAAiC,qEAAc;AAC/C;AACA,SAAS;AACT;AACA,wBAAwB,qEAAc;AACtC;AACA,SAAS;AACT;AACA,mCAAmC,qEAAc;AACjD;AACA;AACA,SAAS;AACT;AACA,kCAAkC,qEAAc;AAChD;AACA;AACA,SAAS;AACT;AACA,wBAAwB,qEAAc;AACtC;AACA,SAAS;AACT,2BAA2B,sEAAY,EAAE,2DAA2D;AACpG;AACA,+BAA+B,sEAAY,EAAE,iEAAiE;AAC9G;AACA,6BAA6B,sEAAY,EAAE,mEAAmE;AAC9G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,yDAAI;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;;;;;;;;;;;;;AC7hB3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8E;AACX;AAClB;AACoC;AACjC;AACE;AACD;AACS;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qFAAqF,8EAAiB;AACtG;AACA;AACA,yDAAyD,kCAAkC,EAAE;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,4EAAe;AACrD;AACA;AACA;AACA;AACA,sCAAsC,4EAAe;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,gEAAyB;AACvE,uCAAuC,4EAAe,MAAM,8EAAiB;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,yCAAyC;AACrF,wBAAwB,0EAAa;AACrC;AACA,yBAAyB,0EAAa,SAAS,sFAAsF;AACrI;AACA,+BAA+B,0EAAa,SAAS,+DAA+D;AACpH;AACA,2BAA2B,0EAAa,SAAS,mCAAmC;AACpF;AACA,mBAAmB,0EAAa,SAAS,gFAAgF;AACzH;AACA;AACA,wBAAwB,0EAAa,WAAW,wEAAwE,mDAAmD;AAC3K;AACA;AACA;AACA;AACA,gCAAgC,0EAAa;AAC7C;AACA;AACA,wBAAwB,0EAAa,SAAS,2FAA2F;AACzI;AACA,kCAAkC,0EAAa,SAAS,yCAAyC;AACjG,6BAA6B,0EAAa,YAAY,8BAA8B;AACpF;AACA,gPAAgP;AAChP;AACA,6BAA6B,sEAAY,EAAE,uFAAuF;AAClI;AACA;AACA;AACA,gCAAgC,0EAAa,SAAS,iEAAiE;AACvH;AACA,mCAAmC,0EAAa,SAAS,mCAAmC;AAC5F;AACA;AACA,2BAA2B,0EAAa,SAAS,oGAAoG;AACrJ;AACA,qCAAqC,0EAAa,SAAS,6CAA6C;AACxG;AACA,gCAAgC,0EAAa,WAAW,wCAAwC;AAChG;AACA;AACA;AACA,gCAAgC,sEAAY,EAAE,0GAA0G;AACxJ;AACA;AACA,qCAAqC,0EAAa,SAAS,mCAAmC;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,0EAAa,SAAS,oHAAoH;AACvK;AACA,uCAAuC,0EAAa,SAAS,8CAA8C;AAC3G;AACA,kCAAkC,0EAAa,WAAW,yCAAyC;AACnG;AACA;AACA;AACA;AACA,kCAAkC,sEAAY,EAAE,4GAA4G;AAC5J;AACA;AACA;AACA,yBAAyB,0EAAa,SAAS,sFAAsF;AACrI;AACA,yBAAyB,0EAAa,SAAS,sCAAsC;AACrF;AACA,6BAA6B,0EAAa,SAAS,uBAAuB,oBAAoB,GAAG;AACjG;AACA;AACA,kCAAkC,0EAAa,SAAS,yDAAyD;AACjH;AACA;AACA,oEAAoE,yBAAyB;AAC7F;AACA,wEAAwE,uCAAuC;AAC/G;AACA,4EAA4E,gDAAgD,gBAAgB,EAAE;AAC9I;AACA;AACA,oDAAoD,gGAAgG;AACpJ;AACA;AACA,gEAAgE,uCAAuC;AACvG;AACA,oEAAoE,uCAAuC,gBAAgB,EAAE;AAC7H;AACA,4CAA4C,uDAAuD;AACnG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,0EAAa,YAAY,2EAA2E;AAC5H;AACA;AACA,sBAAsB,gEAAgE;AACtF,aAAa,0EAA0E;AACvF,aAAa,0EAA0E;AACvF,8BAA8B,2EAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,gCAAgC,0EAAa,YAAY,mCAAmC;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,kEAAQ;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA,8BAA8B,0EAAa;AAC3C;AACA;AACA,4BAA4B,kEAAQ;AACpC;AACA;AACA,SAAS;AACT;AACA;AACA,8BAA8B,0EAAa,SAAS,4CAA4C;AAChG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,0EAAa,WAAW,SAAS,gBAAgB,4CAA4C;AAC5H;AACA;AACA,6BAA6B,kEAAW,EAAE,4HAA4H;AACtK;AACA;AACA;AACA;AACA,2BAA2B,0EAAa,SAAS,iDAAiD;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,0EAAa,SAAS,iDAAiD;AACpG;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT,yBAAyB,0EAAa,SAAS,iDAAiD;AAChG;AACA;AACA;AACA;AACA;AACA,2BAA2B,0EAAa,SAAS,wDAAwD;AACzG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,4BAA4B,0EAAa;AACzC,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,yBAAyB,8DAAM,EAAE,wCAAwC;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gHAAgH,oBAAoB;AACpI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,yDAAI;AAC/B,wBAAwB,8EAAiB;AACzC;AACA,gCAAgC,iEAAa;AAC7C;AACA;AACA,wCAAwC,4EAAe;AACvD;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA;AACA;AACA,oDAAoD;AACpD;AACA;AACA;AACA;AACA;AACA,mEAAmE,8BAA8B,EAAE;AACnG;AACA;AACA;AACA,mGAAmG,8BAA8B,EAAE;AACnI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,4EAAe;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuE,mBAAmB,EAAE;AAC5F;AACA;AACA,mDAAmD,8EAAiB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;ACl4BvB;AAAA;AAAA;AAAA;AAAA;AAAiD;AACA;AACU;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4FAA4F,2BAA2B,EAAE;AACzH;AACA;AACA;AACA;AACA,+BAA+B,2BAA2B;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,mCAAmC;AAC/E;AACA,wBAAwB,0EAAa,SAAS,0DAA0D;AACxG;AACA,wBAAwB,0EAAa,SAAS,+BAA+B;AAC7E;AACA,wBAAwB,0EAAa,SAAS,6BAA6B;AAC3E;AACA;AACA;AACA;AACA,0BAA0B,0EAAa,SAAS,2DAA2D;AAC3G;AACA,oCAAoC,8DAAQ;AAC5C;AACA;AACA,SAAS;AACT;AACA;AACA,wBAAwB,0EAAa,SAAS,+BAA+B;AAC7E;AACA,2BAA2B,0EAAa,SAAS,kCAAkC;AACnF;AACA,+BAA+B,0EAAa,YAAY,sDAAsD;AAC9G;AACA,4BAA4B,8DAAM,EAAE,8BAA8B;AAClE;AACA;AACA,8BAA8B,0EAAa,SAAS,kCAAkC;AACtF;AACA,kCAAkC,0EAAa,YAAY,4DAA4D;AACvH;AACA,4BAA4B,8DAAM,EAAE,8BAA8B;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,yDAAI;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;;;;;;;;;;;;;AC5HxB;AAAA;AAAA;AAAA;AAAwD;AACsB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB,cAAc,8EAAiB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,yCAAyC;AACrF,wBAAwB,0EAAa;AACrC,8BAA8B,0EAAa;AAC3C;AACA,SAAS;AACT,0BAA0B,0EAAa,SAAS,2CAA2C;AAC3F,+BAA+B,0EAAa;AAC5C,oBAAoB,eAAe;AACnC,SAAS;AACT;AACA,2BAA2B,0EAAa;AACxC;AACA,SAAS;AACT,uBAAuB,0EAAa,SAAS,2CAA2C;AACxF,4BAA4B,0EAAa;AACzC,oBAAoB,eAAe;AACnC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,qEAAc;AACjD;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,qCAAqC,qEAAc;AACnD;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,yDAAI;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;AClKvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8E;AACnB;AACF;AACD;AACP;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4BAA4B;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,8CAA8C;AAC1F;AACA,yBAAyB,0EAAa,SAAS,6DAA6D;AAC5G;AACA;AACA,uBAAuB,0EAAa,SAAS,iGAAiG,6CAA6C;AAC3L;AACA;AACA;AACA;AACA,gDAAgD;AAChD,sDAAsD,kBAAkB;AACxE;AACA;AACA,+CAA+C;AAC/C,uDAAuD;AACvD;AACA;AACA,6BAA6B,0EAAa,SAAS,uEAAuE,GAAG;AAC7H;AACA;AACA,8BAA8B,0EAAa,SAAS,4BAA4B,gDAAgD;AAChI;AACA;AACA,mCAAmC,0EAAa,SAAS,+CAA+C,kBAAkB,UAAU,GAAG;AACvI;AACA;AACA,oCAAoC,0EAAa,SAAS,qFAAqF;AAC/I;AACA;AACA,4BAA4B,0EAAa,SAAS,gEAAgE;AAClH,yBAAyB,0EAAa;AACtC,oBAAoB,qBAAqB;AACzC,SAAS;AACT;AACA;AACA,4BAA4B,0EAAa,SAAS,gEAAgE;AAClH,yBAAyB,0EAAa;AACtC,oBAAoB,qBAAqB;AACzC,SAAS;AACT;AACA;AACA,8BAA8B,gEAAQ,EAAE,sHAAsH;AAC9J;AACA,8BAA8B,gEAAQ,EAAE,6HAA6H;AACrK;AACA;AACA,qBAAqB,0EAAa,SAAS,mDAAmD;AAC9F;AACA,gCAAgC,0EAAa,SAAS,2BAA2B;AACjF;AACA,6BAA6B,0EAAa,WAAW,wHAAwH;AAC7K;AACA,2BAA2B,0EAAa,SAAS,sBAAsB;AACvE,wBAAwB,0EAAa;AACrC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,sEAAY,EAAE,+BAA+B;AAC1E;AACA,wBAAwB,0EAAa;AACrC,oBAAoB,qBAAqB;AACzC,SAAS;AACT;AACA;AACA,6BAA6B,gEAAQ,EAAE,mIAAmI;AAC1K;AACA;AACA,sBAAsB,0EAAa,SAAS,wDAAwD;AACpG;AACA,gCAAgC,0EAAa,SAAS,qEAAqE;AAC3H;AACA,6BAA6B,0EAAa,WAAW,yHAAyH;AAC9K;AACA;AACA,2BAA2B,0EAAa,SAAS,+DAA+D;AAChH;AACA,wBAAwB,0EAAa,WAAW,qCAAqC,iBAAiB,EAAE;AACxG;AACA;AACA;AACA;AACA,6BAA6B,qEAAc,EAAE,uFAAuF;AACpI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,0EAAa,SAAS,gEAAgE;AAClH;AACA,8BAA8B,0EAAa,SAAS,iIAAiI,wEAAwE;AAC7P;AACA;AACA,oBAAoB,0EAAa;AACjC,oBAAoB,qBAAqB;AACzC,SAAS;AACT;AACA,yBAAyB,gEAAQ,EAAE,sGAAsG;AACzI;AACA,oBAAoB,0EAAa,WAAW,yBAAyB,GAAG;AACxE,kBAAkB,0EAAa;AAC/B,kBAAkB,0EAAa,QAAQ,sBAAsB,kBAAkB,GAAG;AAClF,6BAA6B,0EAAa;AAC1C;AACA;AACA,SAAS;AACT;AACA,kBAAkB,0EAAa;AAC/B,uBAAuB,0EAAa;AACpC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,uBAAuB,0EAAa,SAAS,mDAAmD;AAChG,qBAAqB,0EAAa;AAClC,kBAAkB,0EAAa;AAC/B,kBAAkB,0EAAa;AAC/B,4BAA4B,0EAAa;AACzC;AACA;AACA,SAAS;AACT;AACA,kBAAkB,0EAAa;AAC/B,wBAAwB,0EAAa,WAAW,+DAA+D;AAC/G;AACA;AACA;AACA;AACA;AACA,kBAAkB,0EAAa;AAC/B,kBAAkB,0EAAa;AAC/B,4BAA4B,0EAAa;AACzC;AACA;AACA,SAAS;AACT;AACA,kBAAkB,0EAAa;AAC/B,wBAAwB,0EAAa,WAAW,+DAA+D;AAC/G;AACA;AACA;AACA;AACA;AACA,kBAAkB,0EAAa;AAC/B,kBAAkB,0EAAa;AAC/B,4BAA4B,0EAAa;AACzC;AACA;AACA,SAAS;AACT;AACA,kBAAkB,0EAAa;AAC/B,wBAAwB,0EAAa,WAAW,+DAA+D;AAC/G;AACA;AACA;AACA;AACA;AACA,kBAAkB,0EAAa;AAC/B,kBAAkB,0EAAa;AAC/B,4BAA4B,0EAAa;AACzC;AACA;AACA,SAAS;AACT;AACA,mBAAmB,0EAAa;AAChC,wBAAwB,0EAAa,WAAW,+DAA+D;AAC/G;AACA;AACA;AACA;AACA,kBAAkB,0EAAa;AAC/B,mBAAmB,0EAAa;AAChC,4BAA4B,0EAAa;AACzC;AACA;AACA,SAAS;AACT;AACA,mBAAmB,0EAAa;AAChC,wBAAwB,0EAAa,WAAW,+DAA+D;AAC/G;AACA;AACA;AACA;AACA,kBAAkB,0EAAa;AAC/B,mBAAmB,0EAAa;AAChC,4BAA4B,0EAAa;AACzC;AACA;AACA,SAAS;AACT;AACA,mBAAmB,0EAAa;AAChC,wBAAwB,0EAAa,WAAW,+DAA+D;AAC/G;AACA;AACA;AACA;AACA,kBAAkB,0EAAa;AAC/B,mBAAmB,0EAAa;AAChC,4BAA4B,0EAAa;AACzC;AACA;AACA,SAAS;AACT;AACA,mBAAmB,0EAAa;AAChC,wBAAwB,0EAAa,WAAW,+DAA+D;AAC/G;AACA;AACA;AACA;AACA,kBAAkB,0EAAa;AAC/B,mBAAmB,0EAAa;AAChC,4BAA4B,0EAAa;AACzC;AACA;AACA,SAAS;AACT;AACA,mBAAmB,0EAAa;AAChC,wBAAwB,0EAAa,WAAW,+DAA+D;AAC/G;AACA;AACA;AACA;AACA,mBAAmB,0EAAa;AAChC,mBAAmB,0EAAa;AAChC,4BAA4B,0EAAa;AACzC;AACA;AACA,SAAS;AACT;AACA,mBAAmB,0EAAa;AAChC,wBAAwB,0EAAa,WAAW,+DAA+D;AAC/G;AACA;AACA;AACA;AACA,mBAAmB,0EAAa;AAChC,mBAAmB,0EAAa;AAChC,0BAA0B,0EAAa;AACvC;AACA;AACA,SAAS;AACT;AACA,mBAAmB,0EAAa;AAChC,sBAAsB,0EAAa,WAAW,6DAA6D;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,0EAAa,SAAS,yCAAyC;AAC5F;AACA;AACA;AACA,kDAAkD;AAClD,wBAAwB,0EAAa,SAAS,0CAA0C,GAAG;AAC3F;AACA,qBAAqB,0EAAa,SAAS,gBAAgB;AAC3D;AACA,yBAAyB,0EAAa,SAAS,yFAAyF;AACxI,sBAAsB,0EAAa;AACnC,oBAAoB,qBAAqB;AACzC,SAAS;AACT;AACA;AACA;AACA,2BAA2B,gEAAQ;AACnC;AACA;AACA,SAAS;AACT;AACA,6BAA6B,0EAAa,SAAS,qCAAqC;AACxF;AACA,2BAA2B,0EAAa,YAAY,sDAAsD;AAC1G;AACA,8BAA8B,8DAAM,EAAE,2BAA2B;AACjE;AACA;AACA;AACA,2BAA2B,0EAAa,SAAS,+DAA+D;AAChH;AACA,6BAA6B,0EAAa;AAC1C;AACA;AACA,SAAS;AACT;AACA;AACA,yBAAyB,0EAAa,SAAS,wCAAwC;AACvF;AACA,4BAA4B,0EAAa,WAAW,sCAAsC;AAC1F;AACA;AACA,0BAA0B,0EAAa,SAAS,kCAAkC;AAClF;AACA;AACA,oCAAoC,8DAAQ,EAAE,uDAAuD;AACrG;AACA;AACA;AACA,8BAA8B,0EAAa,SAAS,sCAAsC;AAC1F;AACA,4BAA4B,0EAAa,YAAY,wDAAwD;AAC7G;AACA,+BAA+B,8DAAM,EAAE,2BAA2B;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,yDAAI;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2BAA2B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,+BAA+B,uCAAuC;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;;;;;;;;;;;;;ACvxBjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmD;AACK;AAChB;AACsC;AAClC;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC,gDAAgD,mDAAY;AAC5D;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa;AACnC;AACA,SAAS;AACT,uBAAuB,0EAAa,SAAS,uBAAuB,mBAAmB,cAAc,GAAG;AACxG,4BAA4B,0EAAa;AACzC;AACA;AACA,SAAS;AACT;AACA,QAAQ,wDAAiB;AACzB,kBAAkB,0EAAa,SAAS,uBAAuB,oBAAoB,GAAG;AACtF,6BAA6B,0EAAa;AAC1C;AACA;AACA,SAAS;AACT;AACA;AACA,qBAAqB,0EAAa;AAClC,kCAAkC,qBAAqB;AACvD,SAAS;AACT,kBAAkB,0EAAa;AAC/B,kBAAkB,0EAAa;AAC/B,iCAAiC,0EAAa;AAC9C,oBAAoB,qBAAqB;AACzC,SAAS;AACT;AACA;AACA,6CAA6C;AAC7C;AACA;AACA,4CAA4C;AAC5C;AACA,kBAAkB,0EAAa,QAAQ,sBAAsB;AAC7D,kCAAkC,0EAAa;AAC/C,oBAAoB,iBAAiB;AACrC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,qEAAc;AAClD;AACA;AACA,SAAS;AACT;AACA,sCAAsC,gEAAQ;AAC9C;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,yDAAI;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;;;;;;;;;;;;;AC1Q9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8E;AACtB;AACgB;AACR;AACP;AACP;AACD;AACO;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,mEAAa;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,sEAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,sEAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC,+CAA+C,yDAAW;AAC1D;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC,yCAAyC,0DAAY;AACrD;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC,6CAA6C,wDAAU;AACvD;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,iDAAiD;AAC7F,6BAA6B,0EAAa,SAAS,uCAAuC;AAC1F;AACA,wBAAwB,0EAAa;AACrC;AACA,SAAS;AACT,sBAAsB,0EAAa;AACnC;AACA,SAAS;AACT,uBAAuB,0EAAa;AACpC;AACA,SAAS;AACT,4BAA4B,0EAAa,SAAS,gDAAgD;AAClG;AACA,oBAAoB,0EAAa,SAAS,qFAAqF;AAC/H,8BAA8B,0EAAa,SAAS,4BAA4B;AAChF,0BAA0B,0EAAa;AACvC;AACA,SAAS;AACT,wBAAwB,0EAAa;AACrC;AACA,SAAS;AACT,yBAAyB,0EAAa;AACtC;AACA,SAAS;AACT;AACA;AACA;AACA,+BAA+B,0EAAa,SAAS,yBAAyB;AAC9E,2BAA2B,0EAAa,SAAS,uCAAuC;AACxF,yBAAyB,0EAAa,SAAS,qCAAqC;AACpF,0BAA0B,0EAAa,SAAS,sCAAsC;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,+DAAG,EAAE,mBAAmB;AAClD;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,yDAAI;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA,8BAA8B;AAC9B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,0EAAa,SAAS,yCAAyC;AACvF,yBAAyB,0EAAa;AACtC;AACA,gCAAgC,WAAW,kBAAkB,oBAAoB;AACjF,SAAS;AACT,8BAA8B,0EAAa,SAAS,+BAA+B,GAAG;AACtF,8BAA8B,0EAAa;AAC3C,iCAAiC;AACjC;AACA,SAAS;AACT,8BAA8B,0EAAa;AAC3C;AACA,SAAS;AACT,qBAAqB,0EAAa;AAClC,qCAAqC;AACrC;AACA,SAAS;AACT,qBAAqB,0EAAa;AAClC,qCAAqC,mBAAmB;AACxD;AACA,SAAS;AACT,8BAA8B,0EAAa;AAC3C,6BAA6B,0EAAa;AAC1C,+DAA+D;AAC/D,SAAS;AACT,8BAA8B,0EAAa,WAAW,qCAAqC;AAC3F,yBAAyB,0EAAa;AACtC,6BAA6B,0EAAa;AAC1C;AACA;AACA,SAAS;AACT,wBAAwB,0EAAa;AACrC,kFAAkF,gBAAgB,qBAAqB;AACvH,SAAS;AACT,8BAA8B,0EAAa;AAC3C;AACA,iCAAiC,YAAY;AAC7C,SAAS;AACT,iCAAiC,0EAAa,SAAS,sBAAsB,sBAAsB;AACnG;AACA,2BAA2B,0EAAa,SAAS,wCAAwC;AACzF,oBAAoB,0EAAa;AACjC;AACA,oEAAoE,YAAY;AAChF,SAAS;AACT;AACA,6BAA6B,0EAAa,SAAS,wCAAwC;AAC3F,sBAAsB,0EAAa;AACnC;AACA,sEAAsE,YAAY;AAClF,SAAS;AACT;AACA,qBAAqB,0EAAa;AAClC,gCAAgC,YAAY;AAC5C;AACA,SAAS;AACT,4BAA4B,0EAAa,SAAS,wCAAwC;AAC1F;AACA,wBAAwB,0EAAa;AACrC;AACA,SAAS;AACT,0BAA0B,0EAAa;AACvC;AACA,SAAS;AACT,yBAAyB,0EAAa;AACtC;AACA,SAAS;AACT,mCAAmC,0EAAa;AAChD;AACA,SAAS;AACT;AACA;AACA;AACA,gDAAgD;AAChD,8CAA8C;AAC9C;AACA;AACA,iDAAiD;AACjD,+CAA+C;AAC/C;AACA,8BAA8B,0EAAa;AAC3C;AACA,yCAAyC,gBAAgB,kBAAkB;AAC3E,SAAS;AACT,4BAA4B,0EAAa;AACzC,sCAAsC,mBAAmB;AACzD,SAAS;AACT,0BAA0B,0EAAa,WAAW,kCAAkC;AACpF,6BAA6B,0EAAa;AAC1C;AACA,iCAAiC,YAAY,qBAAqB,iBAAiB;AACnF,SAAS;AACT,gCAAgC,0EAAa,SAAS,yBAAyB;AAC/E,qBAAqB,0EAAa,SAAS,qEAAqE;AAChH,0BAA0B,0EAAa,WAAW,6BAA6B;AAC/E;AACA;AACA,qBAAqB,0EAAa,SAAS,gEAAgE;AAC3G,0BAA0B,0EAAa,WAAW,6BAA6B;AAC/E;AACA;AACA,6BAA6B,mEAAW;AACxC;AACA;AACA;AACA,SAAS;AACT;AACA,6BAA6B,mEAAW;AACxC;AACA;AACA;AACA,SAAS;AACT;AACA,kCAAkC,0EAAa;AAC/C;AACA,SAAS;AACT;AACA;AACA;AACA,uCAAuC,0EAAa;AACpD;AACA;AACA,SAAS;AACT,iCAAiC,0EAAa;AAC9C;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,qEAAc;AAC/C;AACA,SAAS;AACT;AACA,iCAAiC,qEAAc;AAC/C;AACA,SAAS;AACT;AACA,kCAAkC,gEAAQ;AAC1C;AACA,SAAS;AACT;AACA,kCAAkC,sEAAY,EAAE,mCAAmC;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,sEAAS;AACjB,QAAQ,sEAAS;AACjB,QAAQ,sEAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA,gBAAgB,sEAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,0EAAa,SAAS,sBAAsB,GAAG;AACpE,2BAA2B,0EAAa;AACxC;AACA,iCAAiC,kBAAkB,qBAAqB;AACxE;AACA,SAAS;AACT,wBAAwB,0EAAa,SAAS,+BAA+B,YAAY,GAAG;AAC5F;AACA;AACA,2CAA2C;AAC3C;AACA;AACA,0CAA0C;AAC1C;AACA,wBAAwB,0EAAa;AACrC;AACA,SAAS;AACT,gCAAgC,0EAAa;AAC7C,oBAAoB,qBAAqB;AACzC,SAAS;AACT,wBAAwB,0EAAa;AACrC;AACA,SAAS;AACT,yBAAyB,0EAAa;AACtC,oBAAoB,iBAAiB;AACrC,SAAS;AACT;AACA;AACA,uCAAuC;AACvC;AACA;AACA,wCAAwC;AACxC;AACA,qBAAqB,0EAAa,SAAS,iCAAiC;AAC5E,qBAAqB,0EAAa;AAClC,qBAAqB,0EAAa;AAClC,yBAAyB,0EAAa;AACtC,4BAA4B,0EAAa;AACzC;AACA;AACA;AACA,SAAS;AACT,wBAAwB,0EAAa;AACrC,yFAAyF,oBAAoB,YAAY;AACzH,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0EAAa;AACxC,+EAA+E;AAC/E;AACA,SAAS;AACT;AACA,gCAAgC,0EAAa,SAAS,6CAA6C;AACnG,qCAAqC,0EAAa,SAAS,kDAAkD;AAC7G,4BAA4B,0EAAa;AACzC,oBAAoB,qBAAqB;AACzC,SAAS;AACT,2BAA2B,0EAAa;AACxC,oBAAoB,qBAAqB;AACzC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,gCAAgC,qEAAc;AAC9C;AACA,SAAS;AACT;AACA,qCAAqC,gEAAQ;AAC7C;AACA;AACA,SAAS;AACT;AACA,iCAAiC,sEAAY,EAAE,mCAAmC;AAClF;AACA,iCAAiC,gEAAQ;AACzC;AACA;AACA,SAAS;AACT;AACA,gCAAgC,gEAAQ;AACxC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iDAAiD;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa,SAAS,sBAAsB,GAAG;AACrE,kBAAkB,0EAAa;AAC/B;AACA,iCAAiC,kBAAkB,qBAAqB;AACxE,SAAS;AACT,wBAAwB,0EAAa,SAAS,sBAAsB,qBAAqB,GAAG;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,0EAAa;AACrC;AACA,SAAS;AACT,yCAAyC,0EAAa;AACtD,oBAAoB,qBAAqB;AACzC,SAAS;AACT,wBAAwB,0EAAa;AACrC;AACA,SAAS;AACT,kCAAkC,0EAAa;AAC/C,gEAAgE;AAChE,SAAS;AACT;AACA;AACA,uCAAuC;AACvC;AACA;AACA,wCAAwC;AACxC;AACA,qBAAqB,0EAAa;AAClC;AACA,SAAS;AACT,qBAAqB,0EAAa;AAClC;AACA;AACA,uCAAuC;AACvC;AACA;AACA,wCAAwC;AACxC;AACA,qBAAqB,0EAAa;AAClC,yBAAyB,0EAAa;AACtC,4BAA4B,0EAAa;AACzC;AACA;AACA,SAAS;AACT,wBAAwB,0EAAa;AACrC;AACA,qCAAqC,oBAAoB;AACzD,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0EAAa;AACxC;AACA,iCAAiC,YAAY;AAC7C;AACA,SAAS;AACT;AACA,2BAA2B,0EAAa;AACxC,iCAAiC,cAAc;AAC/C,SAAS;AACT,mCAAmC,YAAY,WAAW,mBAAmB;AAC7E,0BAA0B,0EAAa,SAAS,wCAAwC;AACxF,4BAA4B,0EAAa;AACzC;AACA;AACA,SAAS;AACT;AACA,6BAA6B,0EAAa,SAAS,wCAAwC;AAC3F,+BAA+B,0EAAa;AAC5C;AACA;AACA,SAAS;AACT;AACA,6BAA6B,0EAAa,SAAS,wCAAwC;AAC3F,+BAA+B,0EAAa;AAC5C;AACA;AACA,SAAS;AACT;AACA,uBAAuB,0EAAa;AACpC;AACA,SAAS;AACT,0BAA0B,0EAAa;AACvC;AACA,SAAS;AACT,0BAA0B,0EAAa;AACvC;AACA,SAAS;AACT,gCAAgC,0EAAa;AAC7C;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,qEAAc;AAC9C;AACA,SAAS;AACT;AACA,8CAA8C,gEAAQ,EAAE,qEAAqE;AAC7H;AACA,iCAAiC,sEAAY,EAAE,mCAAmC;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,sEAAS;AACjB,QAAQ,sEAAS;AACjB,QAAQ,sEAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2BAA2B;AAClD;AACA;AACA,gBAAgB,sEAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;;;;;;;;;;;;;AC1zCjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8D;AACJ;AACI;AACV;AACiC;AACuD;AACzF;AACE;AACI;AACb;AAC6C;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,qBAAqB,EAAE;AACjD;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,0BAA0B,sBAAsB,EAAE;AAClD,+BAA+B,uBAAuB,EAAE;AACxD;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,kCAAkC,EAAE;AAC9D;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,8BAA8B,EAAE;AAC1D,+BAA+B,+BAA+B,EAAE;AAChE;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,0BAA0B,4BAA4B,EAAE;AACxD,+BAA+B,6BAA6B,EAAE;AAC9D;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,0BAA0B,8BAA8B,EAAE;AAC1D,+BAA+B,+BAA+B,EAAE;AAChE;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,0BAA0B,2BAA2B,EAAE;AACvD,+BAA+B,4BAA4B,EAAE;AAC7D;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,yGAAyG;AACzI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,mDAAY;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mDAAY;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,8EAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,8EAAiB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,8EAAiB;AAC/B,oEAAoE,uDAAU;AAC9E,cAAc,8EAAiB;AAC/B,wEAAwE,uDAAU;AAClF,iBAAiB,8EAAiB;AAClC,oBAAoB,8EAAiB;AACrC,2EAA2E,4DAAe;AAC1F,wEAAwE,4DAAe;AACvF,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB,gBAAgB,QAAQ;AACxB,gBAAgB,OAAO;AACvB,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,qBAAqB;AACnF;AACA,sCAAsC,wDAAW,4CAA4C,wDAAW;AACxG,2CAA2C,wDAAW;AACtD,yCAAyC,4DAAe;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,wDAAW;AACxD;AACA;AACA;AACA;AACA;AACA,8DAA8D,sBAAsB;AACpF;AACA;AACA,2CAA2C,wDAAW,wBAAwB,+DAAkB;AAChG;AACA,8EAA8E,uDAAU;AACxF,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA,4CAA4C,4DAAe;AAC3D;AACA;AACA,4BAA4B,8EAAiB;AAC7C;AACA;AACA;AACA,gCAAgC,8EAAiB;AACjD;AACA;AACA;AACA;AACA;AACA,4CAA4C,wDAAW;AACvD;AACA,kDAAkD,4DAAe;AACjE;AACA;AACA,gCAAgC,8EAAiB;AACjD;AACA;AACA,oCAAoC,8EAAiB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,wDAAW;AACpD;AACA,iDAAiD,wDAAW;AAC5D;AACA;AACA;AACA;AACA,yEAAyE,wDAAW;AACpF;AACA;AACA;AACA;AACA,0EAA0E,sBAAsB;AAChG;AACA;AACA;AACA;AACA;AACA,6CAA6C,4DAAe;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,8EAAiB;AAC9C;AACA;AACA;AACA,wDAAwD,wDAAW;AACnE;AACA,gDAAgD,4DAAe;AAC/D;AACA;AACA;AACA;AACA;AACA,yCAAyC,wDAAW;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,QAAQ;AAChE;AACA,gCAAgC,uDAAU;AAC1C;AACA;AACA,qCAAqC,wDAAW;AAChD,oCAAoC,2DAAc;AAClD,yCAAyC,wDAAW;AACpD;AACA;AACA,wEAAwE,2DAAc;AACtF;AACA;AACA;AACA;AACA;AACA,0CAA0C,wDAAW;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,uDAAU;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,gEAAgB;AACtE;AACA;AACA;AACA;AACA;AACA,sDAAsD,gEAAgB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,kBAAkB;AAChF,qCAAqC,wDAAW;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,gEAAgB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,mDAAY;AAC3C,8DAA8D,2BAA2B;AACzF;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,eAAe;AAC/B,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA,wCAAwC,qEAAc;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,uDAAU;AACtD;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,yEAAgB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA,wCAAwC,yEAAgB;AACxD;AACA;AACA;AACA,4CAA4C,uDAAU;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,yEAAgB;AAC5C;AACA,gDAAgD,+DAAW;AAC3D;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC,gCAAgC,6DAAe;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA,wCAAwC,yEAAgB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,yEAAgB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,WAAW;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,6DAAa;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,6DAAa;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,eAAe;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,4FAA4F,yEAAgB;AAC5G;AACA;AACA;AACA;AACA;AACA;AACA,iGAAiG,yEAAgB;AACjH;AACA;AACA;AACA;AACA;AACA,qFAAqF,yEAAgB;AACrG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,qEAAc;AACrE;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,kDAAW;AAClE;AACA;AACA,uDAAuD,6DAAa;AACpE,+BAA+B,2DAAU;AACzC,2BAA2B,oCAAoC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,0DAAY;AACnE;AACA;AACA,uDAAuD,yDAAW;AAClE;AACA;AACA;AACA,uDAAuD,wDAAU;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,YAAY;AAC5B,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA,YAAY,8EAAiB,8BAA8B,8EAAiB;AAC5E,eAAe,8EAAiB,6BAA6B,8EAAiB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,yDAAW;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,0DAAY;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,aAAa;AAC7B,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,0DAAY;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,WAAW;AAC3B,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,wDAAU;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,YAAY;AAC5B,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,yDAAW;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,oCAAoC;AAC/D;AACA,wCAAwC,yEAAgB;AACxD;AACA;AACA,6CAA6C,yEAAgB;AAC7D;AACA;AACA,6CAA6C,qEAAc;AAC3D;AACA;AACA,6CAA6C,6DAAa;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,8BAA8B;AACzD;AACA,oCAAoC,4DAAe;AACnD;AACA;AACA,yCAAyC,uDAAU;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;;;;;;;;;;;;;AC5sC3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmD;AACU;AACJ;AACF;AACuD;AACjE;AACiB;AACN;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2DAAU;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,iCAAiC,yDAAW;AAC5C;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,yBAAyB,EAAE;AACrD;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,0BAA0B,yBAAyB,EAAE;AACrD;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,mBAAmB,8EAAiB;AACpC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,mBAAmB,8EAAiB;AACpC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,OAAO;AACvB,gBAAgB,eAAe;AAC/B;AACA;AACA;AACA,0CAA0C,kEAAe;AACzD;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,OAAO;AACvB;AACA;AACA;AACA,sCAAsC,yDAAW,mBAAmB,8EAAiB;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA,wEAAwE,gEAAgB;AACxF;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,gEAAgB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,MAAM;AACtB,gBAAgB,UAAU;AAC1B;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,oDAAoD,mEAAa;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,qDAAqD,mEAAa;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,gBAAgB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,8EAAiB;AACrE;AACA,iBAAiB,8EAAiB;AAClC,mBAAmB,8EAAiB;AACpC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,8EAAiB;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,wEAAY;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,wEAAY;AACpD;AACA,sCAAsC,wEAAY;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,cAAc;AAC9B,gBAAgB,MAAM;AACtB;AACA;AACA;AACA,0CAA0C,kEAAe;AACzD;AACA;AACA,6BAA6B,2DAAU;AACvC,uBAAuB,uCAAuC;AAC9D;AACA;AACA,oCAAoC,6DAAa;AACjD,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,kCAAkC;AAClD;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,2CAA2C,2DAAU;AACrD;AACA;AACA,uBAAuB,uCAAuC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,yEAAgB;AACzD;AACA;AACA,mCAAmC,uEAAuB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,kCAAkC;AAClD,gBAAgB,UAAU;AAC1B;AACA;AACA;AACA;AACA;AACA,uBAAuB,oCAAoC;AAC3D;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B,uBAAuB;AAClD,mCAAmC,yEAAgB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;;;;;;;;;;;AChhBzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACA;AACA;AACA;AACA;AACA,+BAA+B,yDAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+B;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgC;AACjC;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA,CAAC;AAC4B;;;;;;;;;;;;;ACrO7B;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACwD;AACH;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,gBAAgB,gBAAgB;AAChC;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,kEAAe;AACM;;;;;;;;;;;;;ACvGvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACiC;AACG;AACL;AACE;;;;;;;;;;;;;ACNjC;AAAA;AAAA;AAAA;AAAA;AAAyD;AACR;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA,+BAA+B,8EAAiB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,8EAAiB;AAChC;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,SAAS;AACxB;AACA;AACA;AACA,qCAAqC,QAAQ;AAC7C,2BAA2B,oCAAoC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,4DAAe;AAC7C,oBAAoB,8EAAiB;AACrC;AACA,mCAAmC,4DAAe;AAClD,oBAAoB,8EAAiB,wBAAwB,8EAAiB;AAC9E;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,YAAY;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,IAAI;AACnB,eAAe,QAAQ;AACvB,eAAe,iBAAiB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,8EAAiB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA,4EAA4E;AAC5E;AACA,sEAAsE;AACtE;AACA,8EAA8E;AAC9E;AACA,qEAAqE;AACrE;AACA,6EAA6E;AAC7E;AACA,oEAAoE;AACpE;AACA,4EAA4E;AAC5E;AACA,qEAAqE;AACrE;AACA,6EAA6E;AAC7E;AACA,qEAAqE;AACrE;AACA,6EAA6E;AAC7E;AACA,oEAAoE;AACpE;AACA,4EAA4E;AAC5E;AACA,oEAAoE;AACpE;AACA,4EAA4E;AAC5E;AACA,qEAAqE;AACrE;AACA,6EAA6E;AAC7E;AACA,sEAAsE;AACtE;AACA,8EAA8E;AAC9E;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D,yBAAyB,KAAK;AAC9B;AACA;AACA,CAAC;AACwB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgB;;;;;;;;;;;;;AC1ajB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA0E;AACuO;AACnP;AACd;AAC6B;AACgE;AACxG;AACiB;AACN;AACQ;AACP;AACC;AACH;AACG;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,4DAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,eAAe;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4DAAY;AAC3C;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,wBAAwB,4DAAa;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,4DAAe;AAC3C,uBAAuB,uDAAU;AACjC,6BAA6B,4DAAe;AAC5C;AACA,gCAAgC,2DAAc;AAC9C;AACA;AACA,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA,kCAAkC,2DAAc;AAChD;AACA;AACA,2BAA2B,4DAAe;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,8EAAiB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iFAAiF;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA,uCAAuC,2DAAc;AACrD;AACA;AACA,4CAA4C,2DAAc;AAC1D;AACA;AACA;AACA,kGAAkG,2DAAc;AAChH,2DAA2D,2DAAc;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,+DAAkB;AACpE;AACA;AACA,oDAAoD,2DAAc;AAClE;AACA;AACA;AACA,kEAAkE,2DAAc;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,2DAAc;AACzD;AACA;AACA;AACA,qGAAqG,2DAAc;AACnH,8DAA8D,2DAAc;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE,2DAAc;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,4DAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,sEAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,sEAAS;AAC7B;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA,+BAA+B,yEAAgB;AAC/C;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,2DAAc;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,mDAAM;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,2DAAc;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2DAAc;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,2DAAc;AAC5D,mDAAmD,2DAAc;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB,yBAAyB,8EAAiB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,wEAAY;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,4DAAe;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,wDAAW;AAC7C;AACA;AACA;AACA,kCAAkC,wDAAW;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mBAAmB;AAC9C;AACA;AACA;AACA;AACA,SAAS,SAAS,8EAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,2DAAc;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA,6CAA6C,2DAAc;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,2DAAc;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,4DAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,2DAAU;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,8EAAiB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,gDAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iEAAa;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,uDAAU;AACvD;AACA;AACA,kDAAkD,+DAAkB;AACpE;AACA;AACA,kDAAkD,4DAAe;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,2DAAc;AAC7C,2BAA2B,4DAAa;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,4DAAe;AACnD;AACA;AACA,oCAAoC,4DAAe;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,+DAAkB;AACtD;AACA;AACA;AACA;AACA,0BAA0B,2DAAc;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2DAAc;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2DAAc;AACrC;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB,oBAAoB,8EAAiB;AAClE;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2DAAc;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2DAAc;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB,uBAAuB,8EAAiB;AACrE;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,2DAAc;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,2DAAc;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,wEAAY;AAC3C;AACA,6BAA6B,wEAAY;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,yEAAgB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,4DAAe;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,4DAAe;AACvC;AACA;AACA;AACA,uBAAuB,2DAAc;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,4DAAe;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,4DAAe;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,4DAAe;AAC7C,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,4DAAe;AAClD;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,wEAAY;AACrD;AACA;AACA,6BAA6B,yEAAgB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4DAAe;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,yEAAgB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,4DAAe;AAC5C;AACA,uBAAuB,2DAAc;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,4DAAe;AAChD;AACA,aAAa,8EAAiB;AAC9B,uBAAuB,2DAAc;AACrC;AACA;AACA;AACA;AACA;AACA,2BAA2B,4DAAe;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,qCAAqC,8EAAiB;AACtD,sCAAsC,8EAAiB;AACvD;AACA;AACA;AACA;AACA,yBAAyB,yEAAgB;AACzC;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,8EAAiB;AAC9E;AACA;AACA;AACA;AACA;AACA,oCAAoC,4DAAe;AACnD;AACA;AACA;AACA,2BAA2B,2DAAc;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,QAAQ;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,4DAAe;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,uDAAU;AAC1C;AACA;AACA,qCAAqC,wDAAW;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,mCAAmC;AAClE;AACA;AACA;AACA;AACA,sCAAsC,gCAAgC;AACtE;AACA;AACA;AACA;AACA;AACA,4BAA4B,4DAAe;AAC3C;AACA;AACA;AACA;AACA,+BAA+B,sCAAsC;AACrE;AACA;AACA;AACA;AACA,sCAAsC,gCAAgC;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA,qCAAqC,wEAAY;AACjD;AACA;AACA,yCAAyC,wEAAY;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,eAAe;AAC/B,gBAAgB,IAAI;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,gBAAgB;AAC3C;AACA;AACA,oCAAoC,4DAAe;AACnD;AACA,+BAA+B,uDAAU;AACzC;AACA,0CAA0C,2DAAc;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,kCAAkC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oBAAoB;AAC3C;AACA,kCAAkC,4DAAe;AACjD,6CAA6C,uDAAU;AACvD;AACA,8DAA8D,4DAAe;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,wDAAW;AAClD;AACA,sCAAsC,wDAAW;AACjD;AACA;AACA;AACA;AACA;AACA,sCAAsC,wDAAW;AACjD,gEAAgE,wDAAW;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,+BAA+B;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA,6BAA6B,4DAAe;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,4DAAe;AAChD;AACA;AACA,iCAAiC,wDAAW;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,aAAa;AAC7B,gBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,wEAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA,sCAAsC,2DAAc;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,2DAAc;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,iCAAiC,wDAAW;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kGAAkG,wDAAW;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,8EAAiB;AAClE;AACA;AACA;AACA;AACA;AACA,6BAA6B,8EAAiB,8CAA8C,2DAAc;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,cAAc;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,2DAAc;AACpE;AACA;AACA;AACA;AACA;AACA,2CAA2C,wDAAW;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,8EAAiB;AACjD;AACA,2BAA2B,yBAAyB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iBAAiB;AAC5C,+BAA+B,+BAA+B;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,8EAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,+BAA+B;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,4BAA4B;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,8EAAiB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,wDAAW;AACnC,gCAAgC,mDAAY;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,2DAAc;AACzC,iCAAiC,iDAAU;AAC3C;AACA,uBAAuB,aAAa;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,4DAAe;AAC3C,uBAAuB,4DAAe;AACtC;AACA;AACA;AACA;AACA,mCAAmC,kDAAW;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,0BAA0B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,YAAY,8EAAiB,UAAU,8EAAiB;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB,4CAA4C,4DAAe;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB,4CAA4C,4DAAe;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,4DAAe;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,8EAAiB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,YAAY;AAC/C;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA,oBAAoB,4DAAa,oBAAoB,4DAAa;AAClE,uBAAuB,4DAAa,uBAAuB,4DAAa;AACxE,wBAAwB,8EAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,8BAA8B;AACrE;AACA,mFAAmF,4DAAe;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,YAAY,8EAAiB,uBAAuB,8EAAiB;AACrE;AACA;AACA,YAAY,8EAAiB;AAC7B,oCAAoC,+CAAQ;AAC5C;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,uDAAuD;AACvG;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,8EAAiB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,YAAY;AAC/C;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,4DAAa,wBAAwB,4DAAa;AAC5F;AACA;AACA,gCAAgC,4DAAa;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,8EAAiB;AACzD;AACA;AACA;AACA;AACA,uCAAuC,4BAA4B;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,8EAAiB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,4DAAa;AAC/C,YAAY,4DAAa,oBAAoB,4DAAa;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,4DAAa,wBAAwB,4DAAa;AAC9D,eAAe,4DAAa,uBAAuB,4DAAa;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,4BAA4B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,4BAA4B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,uDAAU;AACrC;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAA0C;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA,0EAA0E,+DAAkB;AAC5F,wCAAwC,+DAAkB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2DAAc;AACrD;AACA,+BAA+B,2DAAc;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA,oCAAoC,wEAAY;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,wEAAY;AAChD;AACA,kCAAkC,wEAAY;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,wDAAW;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,4DAAa;AACzC,qCAAqC,4DAAa;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oCAAoC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,eAAe;AAC/B;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,gCAAgC,8EAAiB;AAC/E;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,aAAa,8EAAiB;AAC9B;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD,gBAAgB,8EAAiB;AACjC,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,eAAe;AAC9B;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,cAAc;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,kBAAkB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,sBAAsB,8EAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,sBAAsB,8EAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC,gEAAgE,gBAAgB;AAChF;AACA;AACA;AACA,sDAAsD;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,mDAAmD,0BAA0B;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,eAAe;AAC/B,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mCAAmC;AAC1D;AACA,2BAA2B,0BAA0B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,UAAU;AACxC,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,oBAAoB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0BAA0B;AACrD;AACA,yCAAyC,+DAAkB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA,sCAAsC,8EAAiB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,cAAc;AAC7B;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,+BAA+B;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,+BAA+B;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,2DAAc;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,2DAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4C;AACA;AACA;AACA,8BAA8B,2DAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,4C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,+BAA+B;AAC1D;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qCAAqC;AAC5D;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,YAAY;AAChF;AACA,2BAA2B,6BAA6B;AACxD;AACA,oBAAoB,4DAAa,4BAA4B,4DAAa;AAC1E,oBAAoB,4DAAa,kBAAkB,4DAAa;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD;AACA;AACA,6BAA6B,yEAAgB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,uEAAW;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,cAAc;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,MAAM;AACtB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA,6BAA6B,kDAAW;AACxC,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,eAAe;AAC/B,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,kDAAW;AACrE;AACA;AACA;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD;AACA;AACA,6BAA6B,uDAAgB;AAC7C,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,uDAAgB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,kDAAW;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,qCAAqC,4DAAe,KAAK,8EAAiB;AAC1E,oBAAoB,8EAAiB,gCAAgC,8EAAiB;AACtF;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA,sCAAsC,8EAAiB;AACvD,aAAa,8EAAiB;AAC9B,gBAAgB,8EAAiB;AACjC;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,6BAA6B,4DAAe;AAC5C;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,4DAA4D,4DAAe;AAC3E,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gDAAK;AAC5B;AACA,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,6BAA6B,4DAAe;AAC5C;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,OAAO;AAC9B;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,uBAAuB,uCAAuC;AAC9D,gCAAgC,2DAAU;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAA0E,8DAAe;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,yCAAyC;AAC5E;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,YAAY;AAChF;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA,2BAA2B,kCAAkC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,UAAU;AACxC,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA,oCAAoC,8BAA8B;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,mBAAmB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,8EAAiB;AAC9D;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,6BAA6B,qDAAc;AAC3C,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,uBAAuB,uDAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,4CAA4C;AACvE;AACA,qCAAqC,wDAAW;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,eAAe;AAC/B,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,eAAe;AAC/B,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,eAAe;AAC/B,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,8EAAiB;AACvE,iBAAiB,8EAAiB;AAClC,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,wDAAwD,8EAAiB;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,2DAAc;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,4DAAe;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,2DAAc;AAC3D;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,kDAAkD,4DAAe;AACjE;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,wEAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,8EAAiB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA,2BAA2B,+BAA+B;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,6BAA6B;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,8EAAiB;AAC7C;AACA;AACA,uCAAuC,+BAA+B;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,4DAAe;AAC7D;AACA;AACA;AACA,kDAAkD,4DAAe;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,uDAAU;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,8DAA8D,uDAAU;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,4DAAe;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA,+CAA+C,8EAAiB;AAChE;AACA;AACA;AACA;AACA,0DAA0D,8EAAiB,iBAAiB,8EAAiB;AAC7G;AACA;AACA;AACA,+CAA+C,8EAAiB;AAChE;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,8EAAiB;AACnE,8DAA8D,uDAAU;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oCAAoC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,4DAAe,kDAAkD,wDAAW;AACzG,sCAAsC;AACtC,gBAAgB,8EAAiB,uBAAuB,8EAAiB,uEAAuE,wDAAW;AAC3J,mCAAmC,4DAAe;AAClD,yDAAyD,4DAAe;AACxE;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,mDAAM;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,4DAAe;AAC3C,wCAAwC,uDAAgB;AACxD,wCAAwC,yEAAgB;AACxD;AACA;AACA,6BAA6B,uDAAU;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,4DAAe;AAC3C;AACA;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,4DAAe;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,uDAAU;AAC3E;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD;AACA;AACA;AACA,0FAA0F,8EAAiB;AAC3G,mBAAmB,8EAAiB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA,+BAA+B,6BAA6B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,4DAAe;AAC9E;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA,qCAAqC,4DAAe;AACpD;AACA;AACA;AACA,mCAAmC,mCAAmC;AACtE;AACA,uCAAuC,4BAA4B;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oCAAoC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yGAAyG,4DAAe;AACxH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA,2CAA2C,8EAAiB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,uDAAU;AACnE;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,wDAAW;AACtC;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,8EAAiB;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C;AAC3C,uCAAuC;AACvC;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0CAA0C;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iHAAiH;AACjH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,QAAQ;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,QAAQ;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,+DAAkB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2DAAc;AACrD;AACA,+BAA+B,2DAAc;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,WAAW;AAC3B;AACA;AACA;AACA,4BAA4B,2DAAU;AACtC;AACA;AACA;AACA;AACA;AACA,gBAAgB,WAAW;AAC3B,gBAAgB,WAAW;AAC3B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,8CAA8C,uDAAgB;AAC9D;AACA;AACA,aAAa,8EAAiB;AAC9B,8CAA8C,yEAAgB;AAC9D;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,gBAAgB,eAAe;AAC/B;AACA;AACA;AACA,gCAAgC,mEAAc;AAC9C,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA,2BAA2B,oCAAoC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,4DAAe;AAC5C,iBAAiB,8EAAiB;AAClC,oBAAoB,8EAAiB;AACrC,oBAAoB,8EAAiB;AACrC,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA,kCAAkC,wDAAW;AAC7C,2BAA2B,+BAA+B;AAC1D,+BAA+B,+CAA+C;AAC9E;AACA,mCAAmC,8BAA8B;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,MAAM;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,kDAAW;AACpC,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,iBAAiB;AACjC,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,oBAAoB,8EAAiB,gFAAgF,4DAAe;AACpI;AACA;AACA;AACA,8FAA8F,4DAAe;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,YAAY,8EAAiB,YAAY,8EAAiB;AAC1D;AACA;AACA;AACA,uBAAuB,gDAAK;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,iEAAa;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,2DAAU;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,OAAO;AAC1D,gCAAgC,2DAAU;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,WAAW;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,8EAAiB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,4DAAe;AACxD;AACA;AACA,oCAAoC,2DAAc;AAClD;AACA,+BAA+B,uDAAU;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA,iGAAiG,2DAAc;AAC/G;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,4DAAe;AAC3C,6BAA6B,uDAAU;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,sIAAsI,8DAAe;AACrJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,uDAAU;AACvD;AACA,+EAA+E,8BAA8B;AAC7G;AACA;AACA,2CAA2C,6CAA6C;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,4DAAe;AACjE;AACA;AACA,0CAA0C,kBAAkB;AAC5D;AACA,uCAAuC,mBAAmB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,2DAAc;AAChE,mCAAmC,+CAA+C;AAClF;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,wDAAW;AAC7D,mCAAmC,+CAA+C;AAClF;AACA;AACA,+BAA+B,6BAA6B;AAC5D;AACA;AACA;AACA;AACA;AACA,kDAAkD,+DAAkB;AACpE,mCAAmC,+CAA+C;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yCAAyC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,wEAAY;AAC3C,2CAA2C,gCAAgC;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,4DAAe;AAC7C,gBAAgB,4DAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,4DAAe;AAC7C;AACA,sCAAsC,4DAAe;AACrD;AACA;AACA;AACA,wEAAwE;AACxE;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA,yCAAyC,+DAAkB;AAC3D,8CAA8C,+DAAkB;AAChE,kCAAkC,+DAAkB;AACpD;AACA;AACA;AACA;AACA,kEAAkE,+DAAkB,mCAAmC,+DAAkB;AACzI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,4DAAe;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,mCAAmC;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA,kCAAkC,+DAAkB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,2DAAc;AACjD;AACA;AACA,kCAAkC,4DAAa;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,sCAAsC;AAC5E;AACA;AACA;AACA,mCAAmC,wEAAY;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,gDAAgD,8EAAiB;AAC/F;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,sCAAsC,uDAAU;AAChD;AACA;AACA,iBAAiB,8EAAiB,sDAAsD,4DAAe;AACvG,wDAAwD;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA;AACA;AACA,sCAAsC,4DAAe;AACrD;AACA;AACA;AACA;AACA,yCAAyC,+DAAkB;AAC3D,0CAA0C,+DAAkB;AAC5D,kCAAkC,+DAAkB;AACpD;AACA;AACA;AACA;AACA,kEAAkE,+DAAkB;AACpF,kDAAkD,+DAAkB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,wEAAY;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,8EAAiB;AAC5D;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA,4DAA4D,4DAAe;AAC3E;AACA;AACA,4DAA4D,wDAAW;AACvE;AACA;AACA,wBAAwB,8EAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC,wBAAwB,8EAAiB;AACzC;AACA;AACA,mDAAmD,8EAAiB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA,uCAAuC,8EAAiB,0BAA0B,8EAAiB;AACnG;AACA;AACA;AACA,2DAA2D,uDAAU;AACrE;AACA,iEAAiE,wDAAW;AAC5E;AACA;AACA;AACA;AACA;AACA,4CAA4C,8EAAiB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,QAAQ;AACvE;AACA,0DAA0D,QAAQ;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,uCAAuC;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,uDAAU;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,8EAAiB;AACxD,eAAe,8EAAiB;AAChC;AACA;AACA,uCAAuC,8EAAiB;AACxD,eAAe,8EAAiB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,wDAAW;AAChE;AACA;AACA;AACA,uDAAuD,8EAAiB;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA,kCAAkC,4DAAe;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,qDAAc;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,qDAAc;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,qDAAc;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,gCAAgC,4DAAe;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,wDAAW;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,4DAAe;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB,gCAAgC,8EAAiB;AACnF;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB,kBAAkB,8EAAiB;AACrE;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,iBAAiB,8EAAiB,kBAAkB,8EAAiB;AACrE;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,4DAAe;AAClD;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD;AACA;AACA,kDAAkD,4DAAe;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,sBAAsB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,4DAAe;AAC3C,uBAAuB,uDAAU;AACjC,6BAA6B,4DAAe;AAC5C;AACA,4BAA4B,gEAAmB;AAC/C;AACA;AACA,uBAAuB,2DAAc;AACrC;AACA;AACA,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA;AACA,2BAA2B,4DAAe;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,+DAAkB;AAC7C;AACA,8BAA8B,+DAAkB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,+DAAkB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,+DAAkB;AACnD;AACA;AACA;AACA;AACA,yCAAyC,iBAAiB,kBAAkB;AAC5E;AACA;AACA,wCAAwC;AACxC;AACA;AACA,qCAAqC,4DAAe;AACpD,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,8EAAiB;AACtD;AACA;AACA,6CAA6C;AAC7C;AACA,mEAAmE;AACnE;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC,qCAAqC,4DAAe;AACpD,iDAAiD;AACjD;AACA;AACA,4BAA4B;AAC5B;AACA,qCAAqC,mDAAM;AAC3C;AACA;AACA,4BAA4B,WAAW,8EAAiB,uDAAuD,8EAAiB;AAChI;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA,oBAAoB;AACpB;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA,uEAAuE;AACvE;AACA;AACA;AACA;AACA;AACA,iCAAiC,2DAAc;AAC/C,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA,iCAAiC,4DAAe;AAChD,6CAA6C;AAC7C;AACA;AACA;AACA;AACA,iCAAiC,mDAAM;AACvC,6CAA6C;AAC7C;AACA;AACA;AACA;AACA,yCAAyC,wDAAW;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,mDAAM;AAC5C;AACA,0CAA0C,wDAAW;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA,mEAAmE;AACnE;AACA;AACA,yCAAyC;AACzC;AACA,0DAA0D;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA,mEAAmE;AACnE;AACA,yCAAyC;AACzC;AACA,mEAAmE;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA,uDAAuD,+DAAkB;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD;AACA,oCAAoC,wEAAY;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,yBAAyB;AACxD;AACA;AACA;AACA;AACA;AACA,+BAA+B,yBAAyB;AACxD;AACA;AACA;AACA;AACA;AACA,+BAA+B,yBAAyB;AACxD;AACA;AACA;AACA;AACA;AACA,+BAA+B,yBAAyB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,kBAAkB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,kBAAkB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0BAA0B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,6BAA6B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8CAAO;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,yDAAyD;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,iCAAiC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,mDAAmD;AAC7F;AACA;AACA;AACA;AACA;AACA,+BAA+B,iCAAiC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0BAA0B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,kBAAkB;AAC9E;AACA;AACA,mCAAmC,iCAAiC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8CAAO;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,SAAS;AACzB,gBAAgB,SAAS;AACzB;AACA;AACA;AACA,aAAa,8EAAiB,oBAAoB,8EAAiB;AACnE,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,SAAS;AACzB,gBAAgB,SAAS;AACzB;AACA;AACA;AACA,aAAa,8EAAiB,mBAAmB,8EAAiB;AAClE,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,mBAAmB,8EAAiB;AAClE,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,aAAa;AAC7B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,6BAA6B,mDAAY;AACzC,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,WAAW;AAC3B,gBAAgB,KAAK;AACrB;AACA;AACA;AACA,YAAY,8EAAiB,oBAAoB,8EAAiB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,6BAA6B,iDAAU;AACvC,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B,gBAAgB,YAAY;AAC5B,gBAAgB,MAAM;AACtB;AACA;AACA;AACA,YAAY,8EAAiB,oBAAoB,8EAAiB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,0BAA0B;AACrE;AACA,2BAA2B,kBAAkB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,kBAAkB;AACrD;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,4DAAa;AACxC;AACA;AACA;AACA,eAAe,4DAAa;AAC5B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,6BAA6B,kDAAW;AACxC,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,iBAAiB,8EAAiB;AAChE;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4DAAe;AAC9C;AACA,mCAAmC,4DAAe,sDAAsD,2DAAc;AACtH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,8EAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,8EAAiB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,uBAAuB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,wBAAwB;AACvC;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,4DAAe;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,4DAAe;AACjD,kCAAkC,uDAAU;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,4DAAe;AAC3C,4BAA4B,uDAAU;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,6DAA6D,8EAAiB;AAC5G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,yEAAyE,gBAAgB;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,4DAAe;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,4DAAe;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,wBAAwB;AACjE;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,wBAAwB;AACjE;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,sEAAsE,gBAAgB;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,8EAAiB;AACpC;AACA;AACA;AACA;AACA;AACA,eAAe,8EAAiB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,4DAAe;AAC5C;AACA;AACA;AACA;AACA,8BAA8B,2DAAc;AAC5C;AACA;AACA;AACA;AACA,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yFAAyF,8EAAiB;AAC1G;AACA;AACA;AACA,0BAA0B,4DAAe;AACzC;AACA;AACA;AACA,oDAAoD,8EAAiB;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,+CAAQ;AAC1C,mCAAmC,4DAAa;AAChD;AACA;AACA;AACA;AACA;AACA,0BAA0B,uDAAU;AACpC;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,+BAA+B,wCAAwC;AACvE;AACA,sCAAsC,2CAA2C;AACjF;AACA,uCAAuC,2DAAc,uBAAuB,+DAAkB;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,2DAAc;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,0DAAa;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2DAAc;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gEAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,gBAAgB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB,0CAA0C,+DAAkB;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;;;;;;;;;;;;;ACzlUlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyD;AACb;AACO;AACS;AACL;AACe;AACtE;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,eAAe;AAC9B,eAAe,aAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2DAAU;AACjD;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,gBAAgB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B,eAAe,aAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,aAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,aAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,aAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C,wBAAwB,8EAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA,qBAAqB,8EAAiB;AACtC;AACA,sCAAsC,4DAAa;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,kCAAkC,oDAAK;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,uDAAgB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA,eAAe,WAAW;AAC1B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,kCAAkC,oDAAK;AACvC;AACA,gBAAgB,8EAAiB,iCAAiC,8EAAiB;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,MAAM;AACrB;AACA;AACA;AACA;AACA;AACA,yBAAyB,oDAAK;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,MAAM;AACrB;AACA;AACA;AACA;AACA;AACA,0BAA0B,oDAAK;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,aAAa;AAC5B,eAAe,OAAO;AACtB;AACA;AACA;AACA,aAAa,8EAAiB,gBAAgB,8EAAiB;AAC/D,uCAAuC,iFAAe;AACtD;AACA;AACA,6DAA6D,uEAAW;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,iBAAiB,8EAAiB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,oDAAK;AAC/C;AACA;AACA;AACA,qCAAqC,oDAAK;AAC1C;AACA;AACA;AACA,uCAAuC,oDAAK;AAC5C;AACA;AACA;AACA,sCAAsC,oDAAK;AAC3C;AACA;AACA;AACA,wCAAwC,oDAAK;AAC7C;AACA;AACA;AACA,0CAA0C,oDAAK;AAC/C;AACA;AACA;AACA,yCAAyC,oDAAK;AAC9C;AACA;AACA;AACA,wCAAwC,oDAAK;AAC7C;AACA;AACA;AACA,yCAAyC,oDAAK;AAC9C;AACA;AACA;AACA,CAAC;AAC8B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,CAAC;AAC4B;;;;;;;;;;;;;ACtsC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACyB;AACO;AACA;AACA;;;;;;;;;;;;;ACNhC;AAAA;AAAA;AAAA;AAAA;AAAuC;AACkB;AACF;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,oDAAK;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,MAAM;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,8EAAiB;AAC3C;AACA;AACA;AACA,yDAAyD,4DAAa,yEAAyE,4DAAa;AAC5J;AACA;AACA;AACA,2BAA2B,4CAA4C;AACvE,qCAAqC,4DAAa;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA,uFAAuF;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,gBAAgB;AAC/B,eAAe,MAAM;AACrB;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iDAAiD;AAC5E;AACA,qCAAqC,4DAAa;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,8EAAiB;AAC3C;AACA;AACA;AACA,6JAA6J,8EAAiB;AAC9K;AACA;AACA,2BAA2B,qCAAqC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA,gCAAgC,4DAAa;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,oCAAoC;AAC/D;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD,kDAAkD,kDAAW;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,oCAAoC;AAC/D;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB,8BAA8B,8EAAiB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,4DAAa;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,mCAAmC,4DAAa;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,iCAAiC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,iCAAiC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,kCAAkC;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,kCAAkC;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,iCAAiC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,+BAA+B;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,+BAA+B;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,+BAA+B;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,4DAAa;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4DAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4DAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,4DAAa;AACjD;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iCAAiC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,kCAAkC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,+BAA+B;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA,6BAA6B,+BAA+B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,4BAA4B;AACnD;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,4BAA4B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;;;;;;;;;;;;;ACr+BxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmD;AACM;AACE;AACF;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,2DAAU;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iEAAa;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,sBAAsB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D;AAC1D;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,4BAA4B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,aAAa,8EAAiB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,mEAAc;AACpD;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;ACpiBnB;AAAA;AAAA;AAAA;AAAmC;AACsB;AACzD;AACA;AACA;AACA;AACA;AACA,0BAA0B,+CAAO;AACjC,2BAA2B,+CAAO;AAClC,yBAAyB,+CAAO;AAChC,4BAA4B,+CAAO;AACnC,gCAAgC,+CAAO;AACvC,8BAA8B,+CAAO;AACrC,gCAAgC,+CAAO;AACvC,kCAAkC,+CAAO;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAiB;AACvC,yBAAyB,8EAAiB;AAC1C,uBAAuB,8EAAiB;AACxC,wBAAwB,8EAAiB;AACzC,6BAA6B,8EAAiB;AAC9C,2BAA2B,8EAAiB;AAC5C,6BAA6B,8EAAiB;AAC9C,+BAA+B,8EAAiB;AAChD;AACA;AACA;AACA,aAAa,8EAAiB,0CAA0C,+CAAO;AAC/E,4BAA4B,+CAAO;AACnC;AACA;AACA,aAAa,8EAAiB,4CAA4C,+CAAO;AACjF,6BAA6B,+CAAO;AACpC;AACA;AACA,aAAa,8EAAiB,wCAAwC,+CAAO;AAC7E,2BAA2B,+CAAO;AAClC;AACA;AACA,aAAa,8EAAiB,8CAA8C,+CAAO;AACnF,8BAA8B,+CAAO;AACrC;AACA;AACA,aAAa,8EAAiB,sDAAsD,+CAAO;AAC3F,kCAAkC,+CAAO;AACzC;AACA;AACA,aAAa,8EAAiB,kDAAkD,+CAAO;AACvF,gCAAgC,+CAAO;AACvC;AACA;AACA,aAAa,8EAAiB,0DAA0D,+CAAO;AAC/F,oCAAoC,+CAAO;AAC3C;AACA;AACA,aAAa,8EAAiB,sDAAsD,+CAAO;AAC3F,kCAAkC,+CAAO;AACzC;AACA;AACA;AACA;AACA,CAAC;AACmB;;;;;;;;;;;;;ACtLpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyD;AACN;AACM;AACE;AACtB;AACA;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iDAAQ;AACnC,2BAA2B,iDAAQ;AACnC;AACA,2BAA2B,iDAAQ;AACnC,2BAA2B,iDAAQ;AACnC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2DAAU;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iEAAa;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,gBAAgB,8EAAiB;AACjC,gBAAgB,8EAAiB;AACjC,gBAAgB,8EAAiB;AACjC;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,mCAAmC,iDAAQ;AAC3C;AACA;AACA,iBAAiB,8EAAiB;AAClC,mCAAmC,iDAAQ;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,mEAAc;AACtD;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;ACnRvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiD;AACE;AACM;AACE;AACjB;AACe;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iEAAa;AACxC;AACA;AACA,aAAa,8EAAiB,yBAAyB,8EAAiB;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA,+CAA+C,4DAAe,MAAM,8EAAiB;AACrF;AACA;AACA;AACA,yBAAyB,8EAAiB,2BAA2B,sDAAe;AACpF;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,oBAAoB,8EAAiB;AACrC;AACA;AACA,6CAA6C,iEAAa;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C;AACA;AACA,wFAAwF;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2DAAU;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iEAAa;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,iCAAiC,8EAAiB;AAChF,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,iEAAa;AACtD,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,kDAAkD,mEAAc;AAChE;AACA;AACA,CAAC;AAC2B;;;;;;;;;;;;;ACne5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACiC;AACT;AACW;AACL;AACK;AACJ;AACF;AACC;AACL;AACC;AACA;;;;;;;;;;;;;ACb1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyD;AACN;AACM;AACE;AACjB;AACL;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,wBAAwB,8EAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,0CAA0C,sDAAe;AACzD;AACA;AACA,wBAAwB,8EAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC,uCAAuC,iEAAa;AACpD;AACA;AACA;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2DAAU;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iEAAa;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,aAAa,8EAAiB;AAC9B,gBAAgB,8EAAiB;AACjC,gCAAgC,gDAAK;AACrC;AACA;AACA;AACA;AACA,wCAAwC,mEAAc;AACtD;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;AC1MvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyD;AACN;AACM;AACE;AACf;AACiB;AACnB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,wDAAW;AACzC;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,+BAA+B,2DAAU;AACzC,oBAAoB,8EAAiB;AACrC,qEAAqE,gBAAgB;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,gBAAgB;AAChE;AACA;AACA;AACA;AACA;AACA,kEAAkE,qDAAqD,EAAE;AACzH,kDAAkD,gCAAgC,EAAE;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C;AACA,iBAAiB,8EAAiB,YAAY,8EAAiB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,8CAA8C,sDAAe;AAC7D;AACA;AACA,4BAA4B,8EAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C,2CAA2C,iEAAa;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iEAAa;AACxC;AACA;AACA,wDAAwD,4DAAe;AACvE,2EAA2E,uDAAU;AACrF;AACA,mCAAmC,8EAAiB,yBAAyB,8EAAiB;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2DAAU;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iEAAa;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,2BAA2B,sBAAsB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC,+BAA+B,wBAAwB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,iEAAa;AACtD,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,oCAAoC,wDAAW;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,iCAAiC,8EAAiB;AAChF,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,kDAAkD,mEAAc;AAChE;AACA;AACA,CAAC;AAC2B;;;;;;;;;;;;;ACtf5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyD;AACN;AACM;AACE;AACtB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iDAAQ;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,2DAAU;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iEAAa;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,mCAAmC,iDAAQ;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,mEAAc;AACpD;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;AChStB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyD;AACN;AACM;AACE;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,2DAAU;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iEAAa;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,iEAAa;AACpD,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,mEAAc;AAC5D;AACA;AACA,CAAC;AACyB;;;;;;;;;;;;;AC5Q1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyD;AACA;AACE;AACR;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,2DAAU;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iEAAa;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,cAAc,8EAAiB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,mEAAc;AACtD;AACA;AACA,CAAC;AACmB;;;;;;;;;;;;;AC1IpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACqD;AACA;AACE;AACC;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,kEAAgB;AACpD,oCAAoC,kEAAgB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,kEAAgB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,+DAA+D,+BAA+B,EAAE;AAChG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,gBAAgB;AAC9D;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,0BAA0B,EAAE,oBAAoB,eAAe,EAAE;AACrH;AACA;AACA;AACA,0DAA0D,0BAA0B,EAAE,oBAAoB,UAAU,EAAE;AACtH;AACA,2CAA2C,sBAAsB;AACjE;AACA;AACA;AACA;AACA,YAAY,mEAAa;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;;;;;;;;;;;;;AC5JnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmD;AACM;AACE;AACtB;AACA;AACoB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iDAAQ;AACnC,2BAA2B,iDAAQ;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,2DAAU;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iEAAa;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,8EAAiB;AAC/C,8BAA8B,8EAAiB;AAC/C;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,+BAA+B,iEAAa;AAC5C;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,mCAAmC,iDAAQ;AAC3C;AACA;AACA,iBAAiB,8EAAiB;AAClC,mCAAmC,iDAAQ;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,mEAAc;AACxD;AACA;AACA,CAAC;AACuB;;;;;;;;;;;;;ACzTxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACwB;AACO;AACA;AACF;AACE;AACG;AACH;AACA;AACQ;AACR;AACC;;;;;;;;;;;;;ACbhC;AAAA;AAAA;AAAyD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,wBAAwB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;;;;;;;;;;;ACjCzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACuB;AACS;AACH;AACI;;;;;;;;;;;;;ACNjC;AAAA;AAAA;AAAyD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;;;;;;;;;;;;;ACjB1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmD;AACM;AACE;AACG;AACA;AACd;AACS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,4DAAa;AACzC;AACA;AACA;AACA;AACA;AACA,mCAAmC,yEAAgB;AACnD,mCAAmC,yEAAgB;AACnD;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,2BAA2B,iEAAa;AACxC,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,+BAA+B,iEAAa;AAC5C;AACA;AACA,kFAAkF;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,2DAAU;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iEAAa;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA,sCAAsC,mEAAc;AACpD;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;ACtKtB;AAAA;AAAA;AAAA;AAAyD;AACP;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,oBAAoB,8EAAiB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD,kDAAkD,8DAAc;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,CAAC;AACgB;;;;;;;;;;;;;AC5DjB;AAAA;AAAA;AAAyD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,kHAAkH,eAAe,EAAE,MAAM,eAAe,cAAc,iBAAiB,KAAK,wBAAwB,EAAE,YAAY,eAAe,EAAE,MAAM,aAAa,6DAA6D,EAAE,aAAa,OAAO,aAAa,EAAE;AACxW;AACA;AACA;AACA;AACA,iEAAiE,SAAS,6DAA6D;AACvI;AACA;AACA,4FAA4F,qBAAqB,EAAE,IAAI;AACvH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6EAA6E,cAAc,sCAAsC,wCAAwC;AACzK;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACgB;;;;;;;;;;;;;ACrHjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACyB;AACM;AACD;AACO;AACC;;;;;;;;;;;;;ACPtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8E;AACtB;AACL;AACD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,aAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,8EAAiB;AAC/E;AACA;AACA;AACA,4FAA4F,8EAAiB;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,8EAAiB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB,cAAc,8EAAiB;AACzE;AACA;AACA;AACA,0CAA0C,8EAAiB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,8EAAiB,oBAAoB,8EAAiB;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,8EAAiB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,4CAA4C;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,4CAA4C;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,gDAAgD;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,4CAA4C;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAW;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,KAAK;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0EAAa,SAAS,6CAA6C,GAAG;AACjG;AACA,yBAAyB,0EAAa;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA,2BAA2B,0EAAa,YAAY,0FAA0F;AAC9I;AACA,wBAAwB,0EAAa,UAAU,qDAAqD;AACpG;AACA;AACA,uBAAuB,0EAAa,SAAS,8EAA8E;AAC3H;AACA,wBAAwB,0EAAa,SAAS,4BAA4B;AAC1E;AACA,6BAA6B,0EAAa,SAAS,wDAAwD;AAC3G;AACA;AACA,gCAAgC,0EAAa,SAAS,2DAA2D;AACjH;AACA;AACA,yBAAyB,0EAAa,SAAS,yBAAyB;AACxE,6BAA6B,0EAAa,SAAS,uBAAuB;AAC1E;AACA,iCAAiC,0EAAa,SAAS,uCAAuC;AAC9F,sCAAsC,0EAAa,SAAS,iDAAiD;AAC7G;AACA;AACA,2BAA2B,0EAAa,WAAW,gHAAgH,qDAAqD,EAAE;AAC1N;AACA,0BAA0B,0EAAa;AACvC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,wCAAwC,0EAAa,UAAU,sGAAsG;AACrK;AACA;AACA;AACA;AACA,oCAAoC,0EAAa,UAAU,0GAA0G;AACrK;AACA;AACA;AACA,kBAAkB,0EAAa,SAAS,iCAAiC;AACzE,0BAA0B,0EAAa;AACvC,oBAAoB,mBAAmB;AACvC;AACA,SAAS;AACT;AACA;AACA,6BAA6B,gEAAQ,EAAE,2GAA2G;AAClJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0EAAa;AACvC,oBAAoB,mBAAmB;AACvC;AACA,SAAS;AACT;AACA;AACA,6BAA6B,gEAAQ,EAAE,iHAAiH;AACxJ;AACA;AACA;AACA;AACA,gCAAgC,0EAAa;AAC7C;AACA,oCAAoC,0EAAa,SAAS,kEAAkE,GAAG;AAC/H;AACA;AACA;AACA,uBAAuB,0EAAa,SAAS,8CAA8C,GAAG;AAC9F;AACA,+BAA+B,0EAAa,SAAS,oBAAoB,cAAc,0CAA0C;AACjI;AACA;AACA,0BAA0B,0EAAa,SAAS,2LAA2L;AAC3O;AACA;AACA,gCAAgC,0EAAa,SAAS,kFAAkF,YAAY,gBAAgB,kBAAkB,cAAc,wCAAwC;AAC5O;AACA;AACA;AACA,+BAA+B,+DAAG,EAAE,mDAAmD;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0EAAa;AACvC;AACA,2BAA2B,0EAAa;AACxC;AACA,oBAAoB;AACpB,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,0EAAa,SAAS,qEAAqE;AAC1H;AACA,6BAA6B,0EAAa;AAC1C;AACA;AACA;AACA,SAAS;AACT;AACA,gCAAgC,0EAAa;AAC7C;AACA;AACA,SAAS;AACT;AACA,wBAAwB,0EAAa,SAAS,uBAAuB,iBAAiB,GAAG;AACzF;AACA,wBAAwB,0EAAa,SAAS,yCAAyC;AACvF;AACA,6BAA6B,0EAAa,SAAS,uBAAuB,GAAG;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA,uBAAuB,2CAA2C;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA,2BAA2B,2CAA2C;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,8EAAiB;AACjD;AACA;AACA;AACA;AACA,0BAA0B,8EAAiB;AAC3C,wBAAwB,8EAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2CAA2C;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA,uCAAuC,yDAAI;AAC3C;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA,yEAAyE,cAAc;AACvF;AACA;AACA,yEAAyE;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA,gCAAgC,mEAAa;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB,oBAAoB,8EAAiB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;AC7oCvB;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;;;;;;;;;;;;;AC9EzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmD;AACM;AACI;AACI;AAChB;AACE;AACe;AACjB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,2DAAU;AAChD,8BAA8B,uDAAU;AACxC,qCAAqC,6EAAiB;AACtD,yCAAyC,6DAAa;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,WAAW;AAC3B;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,WAAW;AAC3B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,iBAAiB;AACjC,gBAAgB,kBAAkB;AAClC;AACA;AACA;AACA,YAAY,8EAAiB,2DAA2D,8EAAiB;AACzG;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,wEAAY;AAC5C;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB,gBAAgB,WAAW;AAC3B;AACA;AACA;AACA,qCAAqC,8EAAiB;AACtD;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,kBAAkB;AAClC;AACA;AACA;AACA,YAAY,8EAAiB,2DAA2D,8EAAiB;AACzG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,QAAQ;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,8EAAiB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB,gBAAgB,WAAW;AAC3B;AACA;AACA;AACA,qCAAqC,8EAAiB;AACtD;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB,iBAAiB,8EAAiB,2BAA2B,8EAAiB;AAChH,iBAAiB,8EAAiB,UAAU,8EAAiB,sBAAsB,8EAAiB;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,2DAAU;AAChD,uBAAuB,wCAAwC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,sCAAsC,2DAAc;AACpD;AACA;AACA;AACA;AACA,sDAAsD,2DAAc;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,uBAAuB;AAC1D;AACA;AACA,uDAAuD,2DAAc;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,2DAAc;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,+DAA+D,2DAAc;AAC7E;AACA;AACA;AACA;AACA;AACA,uCAAuC,8BAA8B;AACrE;AACA,2DAA2D,2DAAc;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,2DAAc;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,mCAAmC;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,6DAAgB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,gCAAgC;AAChE;AACA;AACA;AACA;AACA;AACA,sCAAsC,2DAAc;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,uBAAuB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,2DAAc;AACzE;AACA;AACA,+CAA+C,2DAAc;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wCAAwC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,4DAAe;AACjD;AACA,4DAA4D,2DAAc;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,2DAAc;AACjD;AACA;AACA;AACA;AACA;AACA,mGAAmG,2DAAc;AACjH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,2DAAc;AACjD;AACA;AACA;AACA;AACA,8GAA8G,2DAAc,iDAAiD,4DAAe;AAC5L,mEAAmE,4DAAe;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB,kCAAkC,8EAAiB;AACpF;AACA;AACA;AACA,qBAAqB,8EAAiB,iCAAiC,8EAAiB;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;;;;;;;;;;;;;ACvoBlB;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;;;;;;;;;;;;;ACjD5B;AAAA;AAAA;AAAA;AAAyD;AACD;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,mCAAmC,oEAAgB;AACnD,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,mDAAmD,QAAQ;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,CAAC;AAC4B;;;;;;;;;;;;;AC7D7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmD;AACM;AACI;AACyC;AACtG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,qDAAqD,EAAE;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,EAAE;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,EAAE;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,4DAAe;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA,oDAAoD,8EAAiB;AACrE,gCAAgC,8EAAiB;AACjD;AACA;AACA;AACA,4BAA4B,8EAAiB;AAC7C;AACA;AACA;AACA,8DAA8D,+DAAkB;AAChF,wEAAwE,2DAAc;AACtF;AACA;AACA;AACA;AACA,4BAA4B,8EAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,6BAA6B,8EAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA,6BAA6B,8EAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,2DAAU;AAClC;AACA;AACA;AACA,yCAAyC,2DAAc,MAAM,8EAAiB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,4DAAe;AAC7D;AACA,qBAAqB,8EAAiB;AACtC;AACA,oCAAoC,8EAAiB;AACrD;AACA;AACA,iBAAiB,8EAAiB,mBAAmB,8EAAiB;AACtE;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA,uBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA,6BAA6B,uBAAuB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,wEAAY;AAC3C;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,CAAC;AAC2B;;;;;;;;;;;;;ACzT5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAC4B;AACO;AACA;;;;;;;;;;;;;ACLnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2C;AACc;AACpB;AACiB;AACN;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB,qBAAqB,8EAAiB;AACpE;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA,0BAA0B,8EAAiB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,gBAAgB,yBAAyB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,yBAAyB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,gDAAK;AACrC;AACA,yCAAyC,2DAAU;AACnD;AACA;AACA;AACA;AACA;AACA,uCAAuC,OAAO;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,aAAa,8EAAiB,qBAAqB,8EAAiB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA,0BAA0B,8EAAiB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,wBAAwB,8EAAiB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,0CAA0C,8EAAiB,kBAAkB,8EAAiB;AAC9F;AACA;AACA;AACA,YAAY,8EAAiB,uBAAuB,8EAAiB,gCAAgC,8EAAiB;AACtH;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,8BAA8B,gDAAK;AACnC,mCAAmC,iEAAa;AAChD;AACA;AACA,iBAAiB,8EAAiB;AAClC,+BAA+B,uCAAuC;AACtE;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,2DAAU;AACvD;AACA,iBAAiB,8EAAiB;AAClC,+BAA+B,gCAAgC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,MAAM;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,WAAW,8EAAiB;AAC1D,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB;AACnC;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACmC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,gBAAgB,eAAe;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,aAAa,8EAAiB,gBAAgB,8EAAiB;AAC/D;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,eAAe;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,sDAAQ;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,aAAa,8EAAiB,qBAAqB,8EAAiB;AACpE;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+B;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,sDAAQ;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB,gBAAgB,8EAAiB;AAC/D;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,WAAW;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,WAAW;AAC3B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC+B;AAChC;;;;;;;;;;;;;AC1kEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmO;AAC1L;AACR;AACwB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,4CAAK;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,4BAA4B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA,4CAA4C,sDAAe;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,4CAAK;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,uDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA,uEAAuE;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA,uEAAuE;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB;AACnC;AACA;AACA;AACA,8BAA8B,qDAAc;AAC5C,6CAA6C;AAC7C;AACA;AACA,uEAAuE;AACvE;AACA;AACA,8BAA8B,qDAAc;AAC5C,gCAAgC;AAChC;AACA;AACA;AACA;AACA,iCAAiC,iDAAU;AAC3C,6CAA6C;AAC7C;AACA;AACA;AACA;AACA,iCAAiC,6CAAM;AACvC,6CAA6C;AAC7C;AACA;AACA;AACA;AACA,yCAAyC,kDAAW;AACpD;AACA;AACA,8CAA8C,qDAAc,6BAA6B;AACzF;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,6CAAM;AAC5D;AACA,qDAAqD,kDAAW;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,8BAA8B,sDAAe,+BAA+B,8EAAiB;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB,kEAAkE,sDAAe;AACnH;AACA;AACA,+CAA+C,sDAAe;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,sDAAe;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,6DAA6D,sDAAe;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,sDAAe;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC,qEAAqE,sDAAe;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,sDAAe;AAC7C;AACA;AACA,8BAA8B,sDAAe;AAC7C;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,sCAAsC,sDAAe;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,sDAAe,+BAA+B,8EAAiB;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,8EAAiB;AAC/D;AACA,sCAAsC,sDAAe;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,sDAAe,+BAA+B,8EAAiB;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,sGAAsG,sDAAe;AACrH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,sDAAe,KAAK,8EAAiB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,sDAAe;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB,0EAA0E,sDAAe;AAC3H;AACA;AACA,+CAA+C,sDAAe;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,6BAA6B;AAC7B,iCAAiC;AACjC,6BAA6B;AAC7B,iCAAiC;AACjC,6BAA6B;AAC7B,2CAA2C;AAC3C,uCAAuC;AACvC;AACA;AACA;AACA;AACA,uBAAuB,YAAY;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,6EAA6E,sDAAe;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kGAAkG,sDAAe;AACjH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,qDAAc;AAC5C;AACA;AACA,mCAAmC,sDAAe;AAClD;AACA;AACA;AACA,mCAAmC,sDAAe;AAClD;AACA;AACA;AACA,mCAAmC,sDAAe,gDAAgD,yDAAkB;AACpH;AACA;AACA;AACA,mCAAmC,sDAAe;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,8EAAiB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAiB;AACvC;AACA;AACA;AACA;AACA;AACA,wDAAwD,oDAAa;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,oDAAa,iBAAiB,oDAAa;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,oDAAa;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,8EAAiB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,8EAAiB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,qDAAc;AAC5C;AACA;AACA;AACA,mCAAmC,sDAAe;AAClD;AACA;AACA;AACA,mCAAmC,sDAAe;AAClD;AACA;AACA;AACA,mCAAmC,sDAAe;AAClD;AACA;AACA;AACA,mCAAmC,sDAAe;AAClD;AACA;AACA;AACA,mCAAmC,yDAAkB;AACrD;AACA;AACA,mCAAmC,yDAAkB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,qDAAc;AAC/D;AACA,oBAAoB,oDAAa,6BAA6B,oDAAa;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,gCAAgC,8EAAiB;AACjD;AACA;AACA,kGAAkG,sDAAe;AACjH;AACA,kBAAkB,8EAAiB;AACnC;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,oDAAa;AACzE;AACA;AACA;AACA;AACA;AACA,iCAAiC,oDAAa,qBAAqB,oDAAa;AAChF;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,oDAAa;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,qDAAc;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,iDAAU;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA,yEAAyE,sDAAe;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB,sCAAsC,iDAAU;AACtF;AACA;AACA;AACA,iDAAiD,sDAAe,+BAA+B,8EAAiB;AAChH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA,0CAA0C,sDAAe;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,sDAAe,+BAA+B,8EAAiB;AACjG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA,2DAA2D,qDAAc;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,kDAAW;AACxD;AACA;AACA,iBAAiB,6BAA6B,kDAAW;AACzD,yCAAyC,sDAAe;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,8EAAiB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,4CAAK;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+KAA+K,8EAAiB;AAChM;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,qDAAc;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,kDAAW;AACxD;AACA;AACA,iBAAiB,6BAA6B,kDAAW;AACzD,yCAAyC,sDAAe;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,8EAAiB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,4CAAK;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,yDAAkB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA,kCAAkC,qDAAc;AAChD;AACA;AACA;AACA,kBAAkB,8EAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,sDAAe;AACjD;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA,0CAA0C,sDAAe;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,yDAAkB;AAC5E;AACA;AACA,0DAA0D,yDAAkB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,8EAAiB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,4CAAK;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,kBAAkB,8EAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,yDAAkB;AAC7D;AACA;AACA;AACA;AACA,4CAA4C,qDAAc;AAC1D;AACA;AACA,mBAAmB,8EAAiB;AACpC;AACA;AACA;AACA;AACA;AACA,wBAAwB,8EAAiB,kEAAkE,sDAAe;AAC1H;AACA;AACA;AACA;AACA;AACA,0CAA0C,sDAAe;AACzD,4BAA4B,8EAAiB;AAC7C;AACA,4BAA4B,8EAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,sDAAe;AACzD;AACA;AACA;AACA,+CAA+C,8EAAiB;AAChE;AACA;AACA,yDAAyD,iDAAU;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,8EAAiB;AAC9C;AACA;AACA;AACA,4BAA4B,4CAAK;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,8EAAiB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8EAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,8EAAiB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8EAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;;;;;;;;;;;;;ACnwEvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsR;AACvN;AACsI;AACvH;AAC3B;AAC4B;AAC5B;AACJ;AACmC;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8DAAY;AACrC,uBAAuB,8DAAY;AACnC,mCAAmC,2DAAU;AAC7C,qCAAqC,0EAAwB;AAC7D,qCAAqC,0EAAwB;AAC7D,mCAAmC,wEAAsB;AACzD,+BAA+B,oEAAkB;AACjD,gCAAgC,qEAAmB;AACnD,iCAAiC,sEAAoB;AACrD,uCAAuC,sEAAoB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC,wCAAwC,8DAAU;AAClD;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,iBAAiB,8EAAiB,iBAAiB,8EAAiB;AACpE,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,8EAAiB;AACjE,mBAAmB,8EAAiB;AACpC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,8EAAiB;AACjE,mBAAmB,8EAAiB;AACpC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,mBAAmB,8EAAiB;AACpC,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,2DAAK;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,cAAc;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,cAAc;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,2DAAS;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,qEAAmB;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,qEAAmB;AACzD;AACA;AACA;AACA;AACA,kCAAkC,qEAAmB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4GAA4G,qEAAmB;AAC/H;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,qEAAmB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,qEAAmB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,+BAA+B,iCAAiC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,uDAAgB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,qEAAmB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,+BAA+B,yCAAyC;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,uDAAU;AACxC;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA,mCAAmC,4DAAe;AAClD,oBAAoB,8EAAiB;AACrC;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA,sCAAsC,qEAAmB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,qCAAqC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB,8BAA8B,4DAAe;AACnF;AACA,sDAAsD,8EAAiB,2BAA2B,8EAAiB;AACnH;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,8EAAiB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA,oBAAoB,mEAAa,wBAAwB,mEAAa;AACtE,oBAAoB,mEAAa,kBAAkB,mEAAa;AAChE;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,sBAAsB,8EAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,8EAAiB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8DAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,qCAAqC,wDAAW;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,8EAAiB;AACvE,gBAAgB,8EAAiB,sCAAsC,8EAAiB;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,iBAAiB,8EAAiB;AAClC;AACA;AACA,+DAA+D,2DAAc;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,4DAAe;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,2DAAc;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,4DAAe;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,YAAY,8EAAiB,UAAU,8EAAiB;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,mBAAmB,8EAAiB,iBAAiB,8EAAiB;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,eAAe,8EAAiB,aAAa,8EAAiB;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,kDAAkD,8EAAiB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB,gBAAgB,8EAAiB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,8DAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB,gBAAgB,8EAAiB;AAC9D,eAAe,8EAAiB,0BAA0B,8EAAiB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,YAAY,8EAAiB,UAAU,8EAAiB,sBAAsB,8EAAiB;AAC7H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,4DAAe,KAAK,8EAAiB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,4DAAe;AACjD,uBAAuB,uDAAU;AACjC;AACA,uCAAuC,2DAAc;AACrD;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA,sCAAsC,uDAAU;AAChD,kEAAkE,2DAAc;AAChF;AACA;AACA,wDAAwD,uDAAU;AAClE;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,uDAAU,+BAA+B,uDAAU;AACzF;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,8EAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,+DAAkB;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,2DAAc;AAC3D;AACA,0BAA0B,8EAAiB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,4DAAe;AACjE,kCAAkC,uDAAU;AAC5C;AACA;AACA;AACA,yCAAyC,2DAAc;AACvD;AACA;AACA,8CAA8C,4DAAe;AAC7D,8BAA8B,uDAAU;AACxC;AACA,8CAA8C,4DAAe,KAAK,8EAAiB;AACnF,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA,SAAS,SAAS,8EAAiB;AACnC;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,4DAAe;AAC5D;AACA;AACA;AACA;AACA,iDAAiD,4DAAe;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,6BAA6B,4DAAe;AACrD;AACA;AACA;AACA;AACA,oCAAoC,mCAAmC;AACvE;AACA,uCAAuC,4BAA4B;AACnE;AACA,uCAAuC,2DAAc;AACrD;AACA;AACA,uCAAuC,4DAAe;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,4DAAe;AACnD;AACA;AACA;AACA;AACA,uCAAuC,4DAAe,sDAAsD,2DAAc;AAC1H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,uDAAU;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,uDAAU;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,4DAAe;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,0EAA0E,4DAAe;AACvH;AACA,2CAA2C,4DAAe;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,2DAAc;AACzD;AACA;AACA,2CAA2C,4DAAe,IAAI,mEAAa;AAC3E;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2DAAc;AACrD;AACA;AACA,uCAAuC,4DAAe,KAAK,mEAAa;AACxE;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,wDAAW;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,uDAAU,qCAAqC,uDAAU;AAC9G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,uDAAU,qCAAqC,uDAAU;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,+DAAkB;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,+DAAkB;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,4DAAe;AAC/D;AACA;AACA,qDAAqD,wDAAW;AAChE;AACA;AACA,6CAA6C,4DAAe;AAC5D;AACA;AACA,kDAAkD,uDAAU;AAC5D;AACA;AACA;AACA,kDAAkD,+DAAkB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,4DAAe;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,4DAAe;AACnE;AACA;AACA,yDAAyD,wDAAW;AACpE;AACA;AACA,6CAA6C,4DAAe;AAC5D;AACA;AACA,kDAAkD,uDAAU;AAC5D;AACA;AACA,kDAAkD,+DAAkB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,4DAAe;AAC5C;AACA;AACA,kCAAkC,wDAAW;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,4DAAe;AAC5C;AACA;AACA,kCAAkC,wDAAW;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D,2BAA2B,+CAA+C;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,2DAAc,sBAAsB,4DAAe;AACzF,0CAA0C,4DAAe,IAAI,mEAAa;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mCAAmC;AAC1D;AACA,mCAAmC,uDAAU;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,0CAA0C;AACpG;AACA,mCAAmC,+DAAkB;AACrD;AACA;AACA,8DAA8D,uDAAU;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA,mCAAmC,+DAAkB;AACrD;AACA;AACA;AACA,uDAAuD,8EAAiB;AACxE;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA,kCAAkC,2DAAc,sBAAsB,4DAAe,sBAAsB,+DAAkB;AAC7H,sCAAsC,4DAAe,IAAI,mEAAa;AACtE;AACA;AACA,kCAAkC,+DAAkB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,qCAAqC,4DAAe;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,4DAAe;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,4DAAe;AAC/D;AACA;AACA,qDAAqD,wDAAW;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,4DAAe;AAC5D;AACA;AACA,kDAAkD,uDAAU;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,4DAAe;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,uDAAU;AAC5D;AACA,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,4DAAe;AACnE;AACA;AACA,yDAAyD,wDAAW;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,4DAAe;AAC5D;AACA;AACA,kDAAkD,uDAAU;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,uDAAU;AAChE;AACA;AACA,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,QAAQ;AAC7D;AACA,oBAAoB,mEAAa,oBAAoB,mEAAa;AAClE,oBAAoB,mEAAa,kBAAkB,mEAAa;AAChE;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,QAAQ;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,sBAAsB,8EAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mCAAmC;AAC1D;AACA,2BAA2B,gCAAgC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,2DAAc,sBAAsB,4DAAe;AACzF,0CAA0C,4DAAe,IAAI,mEAAa;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA,yDAAyD,+DAAkB;AAC3E;AACA;AACA;AACA,sCAAsC,2DAAc,sBAAsB,4DAAe;AACzF,0CAA0C,4DAAe,IAAI,mEAAa;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2DAAK;AAC5B;AACA;AACA;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA,0CAA0C,4DAAe;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D;AAC7D;AACA;AACA;AACA;AACA;AACA,yDAAyD;AACzD;AACA;AACA,+CAA+C,4DAAe,yBAAyB,4DAAe,KAAK,8EAAiB;AAC5H;AACA,kDAAkD,4DAAe;AACjE;AACA;AACA;AACA;AACA;AACA,gEAAgE,4DAAe;AAC/E;AACA,uDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,sCAAsC,2DAAc;AACpD;AACA;AACA,sDAAsD,2DAAc;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,iCAAiC;AACpE;AACA;AACA,uDAAuD,2DAAc;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,2DAAc;AAC7D;AACA;AACA;AACA;AACA,yEAAyE,2DAAc;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB,8CAA8C,2DAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,2DAAc;AAC7E;AACA;AACA;AACA;AACA;AACA,uCAAuC,8BAA8B;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,2DAAc;AACzE;AACA,mDAAmD,2DAAc;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA,oCAAoC,4DAAe;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA,kCAAkC,4DAAe;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,uDAAU;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,uDAAU;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,YAAY;AACpF;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,oBAAoB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,kBAAkB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA,gBAAgB,mEAAa,oBAAoB,mEAAa;AAC9D,gBAAgB,mEAAa,kBAAkB,mEAAa;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA;AACA;AACA,mDAAmD,2DAAc;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,sCAAsC;AAC7D;AACA,kCAAkC,4DAAe;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAA0E,4DAAe;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,wEAAwE,4DAAe;AACrH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,8EAAiB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,4DAAe;AAChD,gBAAgB,mEAAa;AAC7B,sCAAsC,4DAAe;AACrD;AACA;AACA,2CAA2C,4DAAe;AAC1D;AACA,wBAAwB,8EAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,8EAAiB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,4DAAe;AAChD,2CAA2C,8EAAiB;AAC5D,uBAAuB,8EAAiB;AACxC;AACA,gDAAgD,8EAAiB;AACjE;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE,4DAAe;AACjF;AACA;AACA,sCAAsC,4DAAe;AACrD;AACA;AACA;AACA;AACA,+DAA+D,4DAAe;AAC9E;AACA;AACA,sCAAsC,4DAAe;AACrD,kCAAkC,4DAAe;AACjD;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB,aAAa,8EAAiB;AAC3D,kCAAkC,4DAAe,sBAAsB,+DAAkB;AACzF;AACA;AACA,uBAAuB,2DAAK;AAC5B;AACA;AACA;AACA;AACA,+BAA+B,2DAAc,6BAA6B,8EAAiB;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4DAAe;AAC9C;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,4DAAe;AACrD;AACA;AACA,gBAAgB,8EAAiB,aAAa,8EAAiB;AAC/D,mBAAmB,2DAAK;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,4DAAe;AAClD,eAAe,mEAAa;AAC5B;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,mBAAmB,2DAAK;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,4DAAe,6BAA6B,+DAAkB;AACrG;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,2CAA2C,2DAAc;AACzD;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2DAAc;AACrD;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,4DAAe;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB,0EAA0E,4DAAe;AAC1H;AACA,2CAA2C,4DAAe;AAC1D;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA,aAAa,8EAAiB;AAC9B,qDAAqD,2DAAc;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,yCAAyC,4DAAe;AACxD;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA,+BAA+B,4DAAe;AAC9C;AACA;AACA,gBAAgB,8EAAiB,oBAAoB,8EAAiB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB,mCAAmC,4DAAe;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,4DAAe;AACpD;AACA,sCAAsC,4DAAe;AACrD;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA,oBAAoB;AACpB;AACA;AACA;AACA,kCAAkC,4DAAe;AACjD;AACA;AACA,yCAAyC,4DAAe;AACxD,0CAA0C,4DAAe;AACzD,uBAAuB,mEAAa;AACpC,wBAAwB,8EAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE,4DAAe;AACpF;AACA;AACA,2CAA2C,4DAAe;AAC1D;AACA;AACA,kCAAkC,4DAAe,+BAA+B,8EAAiB;AACjG;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,8EAAiB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,2DAAc;AAC5D;AACA;AACA;AACA,kBAAkB,8EAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD,kDAAkD,uDAAU;AAC5D;AACA;AACA,uDAAuD,4DAAe;AACtE;AACA;AACA,uDAAuD,mDAAM;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA,uCAAuC,mDAAM;AAC7C;AACA,2CAA2C,4DAAe;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,mDAAM;AAC5C,mFAAmF,4DAAe;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,mDAAM;AAChD;AACA;AACA,qBAAqB,8EAAiB;AACtC,+CAA+C,4DAAe;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,gCAAgC;AAChE;AACA;AACA;AACA;AACA,sCAAsC,2DAAc;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,mCAAmC;AACxE;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,2DAAc;AACzE;AACA;AACA;AACA,+CAA+C,2DAAc;AAC7D;AACA;AACA;AACA;AACA,yEAAyE,2DAAc;AACvF;AACA;AACA;AACA;AACA;AACA,oEAAoE;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA;AACA,uCAAuC,2DAAc;AACrD;AACA;AACA,qBAAqB,8EAAiB,gEAAgE,4DAAe;AACrH;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA,kCAAkC,mEAAa;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,2DAAc;AAC5E;AACA;AACA;AACA,8EAA8E,wDAAW;AACzF;AACA;AACA,yBAAyB,8EAAiB,gBAAgB,8EAAiB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAiB;AACvC;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA,0BAA0B,mEAAa;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA;AACA,sDAAsD,4DAAe;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAmF,4DAAe;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,2DAAK;AACrC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA,kEAAkE,4BAA4B;AAC9F;AACA;AACA,+CAA+C,+DAAkB,uBAAuB,2DAAc;AACtG;AACA;AACA;AACA,mEAAmE,+DAAkB;AACrF;AACA;AACA;AACA;AACA,2CAA2C,2DAAc;AACzD;AACA;AACA;AACA;AACA;AACA,mDAAmD,2DAAc;AACjE;AACA;AACA;AACA,gDAAgD,2DAAc;AAC9D;AACA;AACA;AACA,gDAAgD,2DAAc;AAC9D,+CAA+C,2DAAc;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,qBAAqB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uFAAuF,+DAAkB;AACzG;AACA,2EAA2E,2DAAc;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,4DAAe;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA,2EAA2E,+DAAkB;AAC7F;AACA,2DAA2D,2DAAc;AACzE;AACA;AACA;AACA,2CAA2C,2DAAc;AACzD;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,2DAAc;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,2DAAc;AACrD;AACA;AACA;AACA,gGAAgG;AAChG;AACA,2CAA2C,+DAAkB;AAC7D,oDAAoD;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,8EAAiB;AACtD,gCAAgC,8EAAiB;AACjD,yCAAyC,2DAAc;AACvD,uEAAuE,4DAAe;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,2DAAK;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,+DAAkB;AAC1F,8CAA8C,+DAAkB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAAa;AACjC;AACA,uBAAuB,4BAA4B;AACnD;AACA,mCAAmC,+DAAkB,GAAG;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,mEAAa;AAC3C;AACA;AACA;AACA,uBAAuB,4BAA4B;AACnD;AACA,mCAAmC,+DAAkB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,2DAAc;AAChD;AACA,2BAA2B,WAAW;AACtC;AACA,uCAAuC,4DAAe,uBAAuB,+DAAkB;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mEAAa;AAClC;AACA,uBAAuB,4BAA4B;AACnD;AACA;AACA;AACA,eAAe,8EAAiB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAAa;AACjC;AACA;AACA;AACA,kCAAkC,2DAAc;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,+DAAkB;AAC5D;AACA;AACA;AACA;AACA;AACA,2EAA2E,+DAAkB;AAC7F,6CAA6C,+DAAkB,kCAAkC,+DAAkB;AACnH;AACA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA;AACA;AACA,yDAAyD,+DAAkB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,2DAAc;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB,wCAAwC,+DAAkB;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,4BAA4B;AACnD;AACA,mCAAmC,+DAAkB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,wDAAW;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,4DAAe;AAC5C,2BAA2B,8DAAY;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB,mBAAmB,8EAAiB;AACjE;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,4DAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,4DAAe;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,8EAAiB,sBAAsB,8EAAiB;AACxF;AACA,6BAA6B,sDAAe;AAC5C;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA,+BAA+B,6BAA6B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,+BAA+B;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,6CAA6C,8EAAiB;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,SAAS,8EAAiB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,2DAAc;AAC3D;AACA;AACA;AACA;AACA,2CAA2C,2DAAc;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,4CAA4C,mBAAmB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,4DAAe;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA,2BAA2B,kCAAkC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,4DAAe;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kCAAkC;AACzD;AACA,2BAA2B,kCAAkC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,YAAY;AAChF;AACA,2BAA2B,kCAAkC;AAC7D;AACA;AACA,oBAAoB,mEAAa,0BAA0B,mEAAa;AACxE,uBAAuB,mEAAa,kBAAkB,mEAAa;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,6CAA6C;AACpF;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,+BAA+B,8DAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,4DAAe;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,gDAAgD;AAC1F;AACA,2BAA2B,kCAAkC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,YAAY;AAChF;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA,oBAAoB,mEAAa,sBAAsB,mEAAa;AACpE,oBAAoB,mEAAa,kBAAkB,mEAAa;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,oBAAoB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,gCAAgC;AAC3D;AACA;AACA;AACA;AACA;AACA,sCAAsC,4DAAe;AACrD,uBAAuB,mEAAa;AACpC,qCAAqC,8EAAiB;AACtD;AACA;AACA;AACA;AACA;AACA,qBAAqB,SAAS,8EAAiB;AAC/C;AACA;AACA,sCAAsC,4DAAe;AACrD,uBAAuB,mEAAa;AACpC;AACA;AACA;AACA;AACA,qBAAqB,iCAAiC,4DAAe;AACrE;AACA,sCAAsC,2DAAc;AACpD;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,2DAAc,uBAAuB,4DAAe;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA,8BAA8B,8EAAiB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,8EAAiB;AACjE;AACA;AACA,2CAA2C,2DAAc;AACzD;AACA;AACA,2CAA2C,4DAAe;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,2DAAc,sBAAsB,4DAAe;AACzF;AACA;AACA,0BAA0B,8EAAiB;AAC3C;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,4DAAe;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mCAAmC;AAC1D;AACA,2BAA2B,gCAAgC;AAC3D;AACA,yCAAyC,4DAAe,uBAAuB,4DAAe;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,mCAAmC,4DAAe;AAClD;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,mEAAa;AACzB,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB,gCAAgC,8EAAiB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,uDAAU;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,uDAAU;AAClD,SAAS,SAAS,8EAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,uDAAgB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA,+BAA+B,8BAA8B;AAC7D;AACA;AACA;AACA;AACA,mCAAmC,gCAAgC;AACnE;AACA;AACA,4BAA4B;AAC5B;AACA,sCAAsC,2DAAc;AACpD;AACA;AACA;AACA,2CAA2C,4DAAe;AAC1D,0CAA0C,4DAAe;AACzD,4BAA4B,8EAAiB;AAC7C,4BAA4B,8EAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,2DAAS;AACrC;AACA;AACA,wDAAwD,8EAAiB;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,0EAAa,SAAS,4BAA4B;AACxF;AACA;AACA;AACA,2BAA2B,yDAAI;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,4DAAK;AAC1C;AACA;AACA;AACA,2BAA2B;AAC3B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,4BAA4B;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD,uEAAuE,8EAAiB;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD,gEAAgE,8EAAiB;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,uDAAU,2BAA2B,+DAAkB;AACxG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD;AACA;AACA,qBAAqB;AACrB;AACA,8CAA8C;AAC9C;AACA,iEAAiE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,8EAAiB;AAChD;AACA;AACA,uCAAuC;AACvC;AACA,uDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA,mCAAmC;AACnC,qCAAqC,4DAAe;AACpD,2CAA2C;AAC3C;AACA;AACA;AACA;AACA,qCAAqC,wDAAW;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,0BAA0B,8EAAiB;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,0BAA0B,8EAAiB;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,4DAAe;AAC7C,oCAAoC,4DAAe;AACnD;AACA,sCAAsC,4DAAe;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,4DAAe;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA,+BAA+B,6BAA6B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,8EAAiB;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,0EAAa;AAClC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2DAAK;AAC5B;AACA,mBAAmB,2DAAK;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,mEAAa;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,mEAAa;AACrC,yBAAyB,mEAAa;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,mEAAa;AAC1C;AACA;AACA;AACA;AACA,2BAA2B,mEAAa;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uCAAuC;AAC9D;AACA;AACA,4DAA4D,gBAAgB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,wDAAW;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,8DAAY;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,8DAAY;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA,sCAAsC,0CAA0C;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,0CAA0C;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACoB;;;;;;;;;;;;;AC9yOrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACyB;AACA;AACF;AACE;AACK;AACA;AACJ;;;;;;;;;;;;;ACT1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmD;AACH;AACqB;AAC3B;AACE;AACoR;AACxQ;AACC;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qBAAqB;AAC5C;AACA;AACA;AACA;AACA;AACA,iCAAiC,gCAAgC;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,iDAAW;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA,iCAAiC,iDAAW;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,qDAAe;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA,2BAA2B,0BAA0B;AACrD;AACA,uCAAuC,qDAAe;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA,2BAA2B,6BAA6B;AACxD;AACA,+BAA+B,8BAA8B;AAC7D;AACA,yCAAyC,qDAAe;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,qDAAe;AAC/C,2BAA2B,gDAAU;AACrC;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA,iCAAiC,iDAAW;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oCAAoC;AAC3D;AACA,uCAAuC,qDAAe;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qCAAqC;AAC5D;AACA,uCAAuC,oDAAc;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mCAAmC;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oCAAoC;AAC3D,sDAAsD,qDAAe;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,qDAAe;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,8EAAiB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,gDAAU;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,gDAAU;AAC7C,0CAA0C,8EAAiB;AAC3D,yBAAyB,8EAAiB;AAC1C;AACA,+CAA+C,mEAAa;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,gDAAU;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,gDAAU;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,qDAAe;AAC9C;AACA;AACA;AACA;AACA,6CAA6C,8EAAiB;AAC9D,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA,0DAA0D,8EAAiB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,wDAAkB,2CAA2C,wDAAkB;AAC9G,gBAAgB,8EAAiB;AACjC;AACA;AACA,6CAA6C,8EAAiB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,yDAAmB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,oDAAc;AAClD;AACA;AACA;AACA;AACA,+BAA+B,oDAAc;AAC7C;AACA;AACA;AACA;AACA;AACA,mCAAmC,wDAAgB;AACnD;AACA;AACA,mCAAmC,yDAAmB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA,mDAAmD,8EAAiB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,oDAAc;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,yDAAmB;AAC9D;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,yDAAmB;AAC1D;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,8EAAiB;AAC1D;AACA,iCAAiC,8EAAiB;AAClD;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA,0CAA0C,qDAAe;AACzD;AACA;AACA;AACA;AACA;AACA,0CAA0C,oDAAc;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,8EAAiB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,wDAAgB;AAC5E;AACA;AACA;AACA;AACA,0CAA0C,8EAAiB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,oDAAc;AACxD;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,8EAAiB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,8EAAiB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8EAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,wDAAgB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,mEAAa;AACrC,uBAAuB,gCAAgC;AACvD;AACA,mCAAmC,wDAAkB;AACrD;AACA,gDAAgD;AAChD;AACA;AACA,sDAAsD;AACtD;AACA;AACA,qCAAqC,4CAAM;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,oBAAoB,8EAAiB;AACrC,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,mEAAa;AAC/C;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,6BAA6B,gDAAU;AACvC;AACA;AACA,0BAA0B,wDAAkB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,wDAAgB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,wDAAkB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,mEAAa;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,gDAAU;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,OAAO;AACvD,gCAAgC,2DAAU;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,8DAAgB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,sCAAsC,gCAAgC;AACtE;AACA;AACA;AACA;AACA,oCAAoC,gDAAU;AAC9C;AACA;AACA;AACA;AACA,2BAA2B,4BAA4B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wFAAwF,oDAAc;AACtG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,oDAAc;AACvD;AACA;AACA;AACA;AACA,uBAAuB,mEAAa,iBAAiB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,oDAAc;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,mEAAa,wBAAwB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,oDAAc;AAC5D;AACA;AACA;AACA;AACA,+CAA+C,mEAAa;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,mEAAa;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,aAAa;AAC7B,gBAAgB,eAAe;AAC/B,gBAAgB,OAAO;AACvB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,mDAAa,SAAS,oDAAc;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,oDAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,mEAAa;AAC3C;AACA;AACA;AACA,2BAA2B,mEAAa;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,4CAAM;AAC1C;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA,mCAAmC,oDAAc,uBAAuB,wDAAkB;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,qDAAe;AAC9D;AACA;AACA;AACA,oCAAoC,qDAAe;AACnD;AACA;AACA;AACA;AACA,+BAA+B,yCAAyC;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,oDAAc,uBAAuB,wDAAkB;AACtF,iDAAiD,oDAAc;AAC/D;AACA;AACA,oDAAoD,oDAAc;AAClE;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA,2BAA2B,mEAAa,iBAAiB;AACzD;AACA;AACA;AACA,mDAAmD,mEAAa;AAChE;AACA,oDAAoD,mEAAa;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB,oCAAoC,8EAAiB;AACtF,mBAAmB,8EAAiB;AACpC;AACA;AACA;AACA,oCAAoC,mEAAa;AACjD;AACA;AACA;AACA;AACA,iDAAiD,mEAAa;AAC9D;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,wDAAkB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,mEAAa;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,QAAQ;AACvC;AACA,uCAAuC,oDAAc;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,oDAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,wDAAkB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,0BAA0B;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,8CAA8C,OAAO;AACrD,4CAA4C,wDAAkB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD,4CAA4C,wDAAkB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,8EAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,8EAAiB;AAC9C,aAAa,8EAAiB,mBAAmB,8EAAiB;AAClE;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,2DAAU;AACzC;AACA;AACA,2BAA2B,sBAAsB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,8EAAiB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAiB;AACvC,oBAAoB,8EAAiB;AACrC,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA,sBAAsB,8EAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,mEAAa;AAChD,8BAA8B,mEAAa;AAC3C;AACA;AACA;AACA;AACA;AACA,+BAA+B,iBAAiB;AAChD;AACA,sCAAsC,mEAAa;AACnD;AACA;AACA;AACA;AACA,iCAAiC,8EAAiB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,8EAAiB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,qDAAe,4BAA4B,wDAAkB;AACpG,0CAA0C,qDAAe;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,oDAAc;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,YAAY;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,QAAQ;AAC5D;AACA,mCAAmC,oDAAc;AACjD;AACA;AACA;AACA,wBAAwB,mEAAa;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,mEAAa;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,qDAAe;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,6CAA6C,8EAAiB;AAC9D,uDAAuD,qDAAe;AACtE;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,qDAAe,+BAA+B,oDAAc;AACtG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,uBAAuB,8EAAiB,+BAA+B,mEAAa,+DAA+D,mEAAa;AAChK,wBAAwB,8EAAiB,gCAAgC,mEAAa,gEAAgE,mEAAa;AACnK;AACA;AACA,uBAAuB,mEAAa;AACpC,wBAAwB,mEAAa;AACrC;AACA;AACA,0BAA0B,4CAAM;AAChC,qBAAqB,mEAAa;AAClC,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB,sBAAsB,8EAAiB,gCAAgC,mEAAa;AAC1H;AACA;AACA;AACA,mCAAmC,mEAAa;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,mEAAa,qBAAqB,qDAAe;AAC/E,+BAA+B,mEAAa,qBAAqB,qDAAe;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,oDAAc;AACrE;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA,qDAAqD,wDAAkB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA,uBAAuB,8EAAiB,gBAAgB,8EAAiB;AACzE;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,gDAAgD;AAC3E;AACA;AACA,mCAAmC,iBAAiB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uCAAuC;AAC9D;AACA;AACA,uBAAuB,8EAAiB,gBAAgB,8EAAiB;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,8EAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iGAAiG,wDAAgB;AACjH,0CAA0C,mEAAa;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uCAAuC;AAC9D;AACA;AACA,uBAAuB,8EAAiB,kBAAkB,8EAAiB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,wCAAwC;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wCAAwC;AAC/D;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA,yCAAyC,oDAAc;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,8EAAiB,kBAAkB,8EAAiB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,8EAAiB,qBAAqB,8EAAiB,gCAAgC,mEAAa;AAC5H;AACA;AACA;AACA;AACA,6DAA6D,8EAAiB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gIAAgI,mEAAa;AAC7I;AACA,yDAAyD,mEAAa;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,8EAAiB;AAClD,+CAA+C,kBAAkB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,mEAAa;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE,oDAAc;AACpF;AACA;AACA,oCAAoC,mEAAa,gCAAgC,mEAAa;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,8EAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,kBAAkB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oCAAoC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,uEAAuE,mEAAa;AAClH,kDAAkD,mEAAa;AAC/D;AACA;AACA;AACA;AACA,mCAAmC,mEAAa;AAChD,gDAAgD,mEAAa;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mCAAmC;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,mEAAa;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,oDAAc;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+GAA+G,wDAAgB;AAC/H;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,4CAAM;AAC3D;AACA;AACA;AACA,kCAAkC,gDAAU;AAC5C;AACA;AACA;AACA,mCAAmC,wDAAgB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oCAAoC;AAC3D,sDAAsD,iDAAW;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,0BAA0B;AACrD,gDAAgD,oDAAc;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mEAAa;AAClC,uBAAuB,mCAAmC;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,uCAAuC;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,mEAAa;AACvC;AACA,uBAAuB,uCAAuC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,QAAQ;AAC9C;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA,+BAA+B,8EAAiB,gBAAgB,8EAAiB;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oCAAoC;AAC/D,0DAA0D,qDAAe;AACzE;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,8EAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,8EAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,8EAAiB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,qDAAe;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,mEAAa;AAClD,sCAAsC,mEAAa;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iDAAW;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yCAAyC;AAChE;AACA;AACA;AACA,wEAAwE,qDAAe;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA,yCAAyC,qDAAe;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qCAAqC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,8EAAiB;AACpE;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB,gBAAgB,8EAAiB;AACvE;AACA;AACA;AACA;AACA,mCAAmC,8EAAiB;AACpD;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,8EAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,oDAAc;AACxE,0EAA0E,iDAAW;AACrF,6FAA6F,qDAAe;AAC5G;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mCAAmC;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,qDAAe;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qCAAqC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,mEAAa;AACnC;AACA,uBAAuB,mCAAmC;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oCAAoC;AAC3D;AACA;AACA,sDAAsD,iDAAW;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,gDAAU;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oCAAoC;AAC3D,sDAAsD,qDAAe;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qCAAqC;AAC5D;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B,8EAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,uBAAuB,oCAAoC;AAC3D,sDAAsD,qDAAe;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,6BAA6B,qDAAO;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,6BAA6B,qDAAO;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,6BAA6B,qDAAO;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,6BAA6B,qDAAO;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA,4BAA4B,mEAAa;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,oCAAoC,iDAAW;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,8EAAiB;AACrE,oBAAoB,mEAAa,4BAA4B,mEAAa;AAC1E,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA,mDAAmD,qDAAe;AAClE,kDAAkD,qDAAe;AACjE;AACA;AACA;AACA;AACA,qCAAqC,iDAAW;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,oDAAc;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,wDAAkB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA,iCAAiC,qDAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA,sCAAsC,oDAAc;AACpD;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA,0CAA0C,wDAAkB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,qDAAe;AAC/D,+CAA+C,qDAAe;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,qDAAe;AAClE;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,iDAAW;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,qDAAe;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,yCAAyC;AACxE;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,gDAAU;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,mEAAa;AACnE;AACA;AACA,8CAA8C,mEAAa;AAC3D,+CAA+C,mEAAa;AAC5D;AACA,kBAAkB;AAClB;AACA,8CAA8C,mEAAa;AAC3D,+CAA+C,mEAAa;AAC5D;AACA;AACA,yCAAyC,mEAAa;AACtD,4CAA4C,mEAAa;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,mEAAa,oGAAoG,wDAAgB;AACtL;AACA;AACA;AACA,0DAA0D,mEAAa;AACvE;AACA;AACA;AACA;AACA,wCAAwC,wDAAkB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qCAAqC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,2BAA2B,8EAAiB;AAC1E;AACA,kDAAkD,mEAAa;AAC/D;AACA,2BAA2B,mCAAmC;AAC9D,qBAAqB,8EAAiB;AACtC,wBAAwB,8EAAiB;AACzC;AACA,gCAAgC,qDAAe;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,mEAAa;AACvD,wCAAwC,8EAAiB;AACzD;AACA;AACA,+BAA+B,iCAAiC;AAChE;AACA,yBAAyB,8EAAiB,yCAAyC,8EAAiB;AACpG,oCAAoC,qDAAe;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,mEAAa;AACxD;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,mCAAmC;AAC9D;AACA,qBAAqB,8EAAiB,2CAA2C,8EAAiB;AAClG,gCAAgC,qDAAe;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,mEAAa;AAChD;AACA;AACA,aAAa,8EAAiB,2BAA2B,8EAAiB;AAC1E;AACA,2BAA2B,mCAAmC;AAC9D;AACA,qBAAqB,8EAAiB,2CAA2C,8EAAiB;AAClG,gCAAgC,qDAAe;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,mEAAa;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA;AACA,qCAAqC,mEAAa;AAClD;AACA,8CAA8C,8EAAiB;AAC/D;AACA;AACA,mDAAmD,8EAAiB;AACpE;AACA,wCAAwC,mEAAa;AACrD;AACA;AACA;AACA;AACA;AACA,oCAAoC,mEAAa;AACjD;AACA;AACA;AACA;AACA;AACA,kEAAkE,mEAAa;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,qDAAe;AACrD,kDAAkD,8DAAgB;AAClE,kDAAkD,8DAAgB;AAClE;AACA,iCAAiC,gDAAU;AAC3C;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB,8BAA8B,8EAAiB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,iDAAW;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,qDAAe;AAChD;AACA;AACA;AACA,qCAAqC,iDAAW;AAChD;AACA;AACA;AACA;AACA,oBAAoB,mEAAa,4BAA4B,mEAAa;AAC1E,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA,iBAAiB,8EAAiB;AAClC;AACA,qBAAqB,8EAAiB;AACtC;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA,6BAA6B,8EAAiB,2BAA2B,8EAAiB;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,qDAAe;AAC5C;AACA;AACA,kCAAkC,iDAAW;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wCAAwC;AAC/D;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,qDAAe;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA,iCAAiC,qDAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,wDAAgB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oCAAoC;AAC3D;AACA;AACA,2BAA2B,qCAAqC;AAChE;AACA;AACA,+BAA+B,mCAAmC;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,qDAAe;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,OAAO;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA,qCAAqC,0CAAI;AACzC,qCAAqC,0CAAI;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,qGAAqG,qDAAe;AACpH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wHAAwH,wDAAkB,4EAA4E,wDAAkB,sCAAsC,wDAAkB;AAChS;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,gCAAgC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,gDAAU;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yCAAyC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,2CAA2C,iDAAW;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,iBAAiB,8EAAiB;AAClC,qDAAqD,gDAAU;AAC/D;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,mCAAmC;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,8EAAiB;AAChE,uCAAuC,mEAAa;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD,kDAAkD,oDAAc;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,wDAAkB;AACrD;AACA;AACA;AACA,mCAAmC,oDAAc;AACjD;AACA;AACA;AACA;AACA,mCAAmC,wDAAkB;AACrD;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA,2BAA2B,8EAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6FAA6F,oDAAc;AAC3G;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,qDAAe;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;;;;;;;;;;;;;ACr2JlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACuE;AACgB;AAC/B;AACN;AACK;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,CAAC;AACe;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,8EAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,8EAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACiB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA,CAAC;AACyB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C;AAC3C,aAAa,8EAAiB;AAC9B;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,8BAA8B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,2FAA2F,8DAAgB;AAC3G;AACA;AACA,wFAAwF,0DAAY;AACpG;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,2FAA2F,8DAAgB;AAC3G;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gFAAgF;AAChF,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAmF,8DAAgB;AACnG;AACA;AACA,2EAA2E,0DAAY;AACvF;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,CAAC;AACsB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,8DAAgB;AACpD,oCAAoC,8DAAgB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA,6DAA6D,mEAAa;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2BAA2B;AAClD;AACA,2BAA2B,gCAAgC;AAC3D;AACA,+BAA+B,0BAA0B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mEAAa;AACxC;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,8EAAiB;AAC7C;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA,2BAA2B,0BAA0B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mEAAa;AACxC,2BAA2B,mEAAa;AACxC;AACA;AACA;AACA,+BAA+B,2DAAU;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C,kCAAkC,8EAAiB;AACnD;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB,aAAa,8EAAiB;AACnE;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA,2BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,0BAA0B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,mEAAa;AAC7C,gCAAgC,mEAAa;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,8EAAiB;AAC/C;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB,aAAa,8EAAiB;AAC/D;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,8BAA8B;AACzD;AACA;AACA,sDAAsD,8EAAiB;AACvE;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,2BAA2B,8EAAiB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,0DAAY;AAC5C;AACA,yCAAyC,2DAAU;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,2DAAU;AAC3C,uBAAuB,8BAA8B;AACrD;AACA,kCAAkC,2DAAU;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA,+BAA+B,yBAAyB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,OAAO;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,cAAc,EAAE;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,iBAAiB,8EAAiB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA,+BAA+B,4BAA4B;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,OAAO;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA,2BAA2B,4BAA4B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qCAAqC;AAC5D;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,sDAAQ;AACpC;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,+CAA+C,0DAAY;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA,2BAA2B,6BAA6B;AACxD;AACA,+BAA+B,8BAA8B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,gCAAgC;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,8BAA8B;AAC9D;AACA;AACA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,8BAA8B;AACzD;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACsB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,wDAAU;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,sDAAQ;AACpC;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,+CAA+C,wDAAU;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,qBAAqB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,sBAAsB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,4BAA4B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,8BAA8B;AACzD;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mEAAa;AAClC;AACA;AACA;AACA,uBAAuB,mCAAmC;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,yDAAW;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAiB,sBAAsB,8EAAiB;AAC9E;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAiB,sBAAsB,8EAAiB;AAC9E;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAiB,sBAAsB,8EAAiB;AAC9E;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAAiB,sBAAsB,8EAAiB;AAC9E;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,8EAAiB;AAC3C,4BAA4B,8EAAiB;AAC7C,aAAa,8EAAiB;AAC9B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,wBAAwB,8EAAiB;AACzC,mCAAmC,qCAAqC;AACxE;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,6BAA6B,qDAAO;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,oBAAoB,8EAAiB;AACnE,iBAAiB,8EAAiB,4DAA4D,0DAAY;AAC1G;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB,sCAAsC,8EAAiB;AACzF;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,sBAAsB,8EAAiB,4DAA4D,0DAAY;AAC/G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB,iDAAiD,sDAAQ;AAC5F,iBAAiB,8EAAiB,mBAAmB,8EAAiB;AACtE;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB;AACnC,gBAAgB,8EAAiB;AACjC;AACA;AACA,kBAAkB,8EAAiB;AACnC,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,8EAAiB;AAC3C,4BAA4B,8EAAiB;AAC7C,aAAa,8EAAiB;AAC9B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,8BAA8B,qDAAO;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB,gBAAgB,8EAAiB;AAC9D,iBAAiB,8EAAiB,8DAA8D,0DAAY;AAC5G;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB,kCAAkC,8EAAiB;AACrF;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,sBAAsB,8EAAiB,8DAA8D,0DAAY;AACjH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB,mDAAmD,sDAAQ;AAC9F,iBAAiB,8EAAiB,mBAAmB,8EAAiB;AACtE;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB;AACnC,gBAAgB,8EAAiB;AACjC;AACA;AACA,kBAAkB,8EAAiB;AACnC,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,8EAAiB;AAC3C,4BAA4B,8EAAiB;AAC7C,aAAa,8EAAiB;AAC9B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC,+BAA+B,iCAAiC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB,aAAa,8EAAiB;AACnE;AACA;AACA,uCAAuC,iCAAiC;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,4BAA4B,qDAAO;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB,uBAAuB,8EAAiB;AACrE,iBAAiB,8EAAiB,0DAA0D,0DAAY;AACxG;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB,yCAAyC,8EAAiB;AAC5F;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,sBAAsB,8EAAiB,0DAA0D,0DAAY;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB,+CAA+C,sDAAQ;AAC1F,iBAAiB,8EAAiB,mBAAmB,8EAAiB;AACtE;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB;AACnC,gBAAgB,8EAAiB;AACjC;AACA;AACA,kBAAkB,8EAAiB;AACnC,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,8EAAiB;AAC3C,4BAA4B,8EAAiB;AAC7C,aAAa,8EAAiB;AAC9B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA,gHAAgH;AAChH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,+BAA+B,qDAAO;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB,sBAAsB,8EAAiB;AACpE,iBAAiB,8EAAiB,gEAAgE,0DAAY;AAC9G;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB,wCAAwC,8EAAiB;AAC3F;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,sBAAsB,8EAAiB,gEAAgE,0DAAY;AACnH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB,qDAAqD,sDAAQ;AAChG,iBAAiB,8EAAiB,mBAAmB,8EAAiB;AACtE;AACA;AACA;AACA;AACA,kBAAkB,8EAAiB;AACnC,gBAAgB,8EAAiB;AACjC;AACA;AACA,kBAAkB,8EAAiB;AACnC,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE;AACnE;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,sDAAQ;AACpC,0CAA0C,yDAAW;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,8BAA8B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,oCAAoC;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mEAAa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,8EAAiB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA,0DAA0D,0CAA0C;AACpG;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,mEAAa;AAC5E;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA,4BAA4B,8EAAiB;AAC7C;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,0EAA0E;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,0BAA0B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,8DAAgB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA,wBAAwB,8EAAiB;AACzC;AACA,4BAA4B,8EAAiB;AAC7C;AACA;AACA,uDAAuD,8EAAiB;AACxE;AACA,gCAAgC,8EAAiB;AACjD;AACA;AACA;AACA;AACA,4BAA4B,8EAAiB;AAC7C;AACA,sDAAsD,8EAAiB;AACvE;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA,wBAAwB,8EAAiB;AACzC;AACA;AACA,+CAA+C,8EAAiB;AAChE;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C,gDAAgD,8EAAiB;AACjE;AACA,6BAA6B,8EAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,QAAQ;AACnC;AACA;AACA;AACA,wBAAwB,8EAAiB;AACzC;AACA;AACA,4BAA4B,8EAAiB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC8B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACwB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC0B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC6B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,oBAAoB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,gBAAgB;AACzD;AACA;AACA;AACA,wCAAwC,gBAAgB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,yBAAyB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,yBAAyB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,yBAAyB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,yBAAyB;AAC5D;AACA;AACA;AACA;AACA;AACA,mCAAmC,yBAAyB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,yBAAyB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,8BAA8B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACkB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACyB;;;;;;;;;;;;;ACnvJ1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyD;AACyG;AAChI;AACsB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA,mBAAmB,8EAAiB;AACpC,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,mBAAmB,8EAAiB;AACpC,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,KAAK;AACpB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA,YAAY,8EAAiB,qBAAqB,8EAAiB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,KAAK;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,KAAK;AACpB,eAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA,4BAA4B,mEAAa;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,mEAAa;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,mEAAa;AAC9C;AACA;AACA,wFAAwF,mEAAa;AACrG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,KAAK;AACpB,eAAe,WAAW;AAC1B;AACA;AACA,uBAAuB,oCAAoC;AAC3D;AACA,iEAAiE,iDAAW;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,KAAK;AACpB,eAAe,OAAO;AACtB;AACA;AACA,8BAA8B,qDAAe;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,KAAK;AACpB,eAAe,YAAY;AAC3B,eAAe,KAAK;AACpB;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,0CAAI;AACvE;AACA;AACA;AACA,2BAA2B,sCAAsC;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,KAAK;AACpB,eAAe,gBAAgB;AAC/B;AACA;AACA;AACA;AACA,uBAAuB,oCAAoC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,KAAK;AACpB,eAAe,YAAY;AAC3B;AACA;AACA,uBAAuB,qCAAqC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,KAAK;AACpB,eAAe,OAAO;AACtB;AACA;AACA,uBAAuB,mCAAmC;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,KAAK;AACpB,eAAe,gBAAgB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oCAAoC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B,eAAe,KAAK;AACpB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAAa;AACjC;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA,+BAA+B,uBAAuB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA,sCAAsC,qDAAe;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,wDAAkB;AACxD;AACA;AACA,2CAA2C,qDAAe;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,qDAAe;AAC9C;AACA,sBAAsB,8EAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD,kDAAkD,qDAAe;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mBAAmB;AAClC,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,mEAAa;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,8EAAiB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,eAAe;AAC9B,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA,uCAAuC,qDAAe;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,mEAAa;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,mDAAa;AAC/C;AACA,8CAA8C,8EAAiB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,8EAAiB;AAC7D;AACA;AACA;AACA,gDAAgD,8EAAiB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,YAAY;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,UAAU;AACzB,eAAe,kBAAkB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuE,wDAAkB;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,cAAc;AAC7B,eAAe,OAAO;AACtB,eAAe,kBAAkB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,gBAAgB;AAC/B,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,wCAAwC,qDAAe;AACvD;AACA,4DAA4D,qDAAe;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B;AACA;AACA,yBAAyB,8CAAM;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,aAAa;AAC5B,eAAe,gBAAgB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,oDAAc;AAChE;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,qBAAqB,mEAAa;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA,kCAAkC,mEAAa;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,qDAAe,gCAAgC,qDAAe;AAClG;AACA,6C;AACA,oBAAoB,mEAAa,4CAA4C;AAC7E;AACA;AACA;AACA,iBAAiB,qDAAe;AAChC,6CAA6C;AAC7C,oBAAoB,mEAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,qDAAe,iCAAiC,qDAAe;AAClG,iDAAiD;AACjD,wBAAwB,mEAAa;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D;AAC7D;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,yCAAyC,oDAAc;AACvD;AACA,0DAA0D,oDAAc,0DAA0D,iDAAW;AAC7I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wFAAwF,qDAAe;AACvG;AACA,kBAAkB,qDAAe;AACjC;AACA;AACA,wBAAwB,mEAAa;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,gBAAgB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,mEAAa;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,CAAC;AACmB;;;;;;;;;;;;;AC78BpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyD;AACpB;AACW;AACM;AACE;AACiF;AAC5D;AACgK;AACrL;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,uBAAuB,wBAAwB;AAC/C,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA,6BAA6B,6DAAe;AAC5C;AACA;AACA;AACA,6BAA6B,6DAAe;AAC5C;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA,uDAAuD,mDAAmD;AAC1G;AACA;AACA,uDAAuD,qDAAqD;AAC5G;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC,wBAAwB,8EAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,8EAAiB;AACnD;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA,6BAA6B,8EAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,+BAA+B;AACtD,mCAAmC,iEAAa;AAChD;AACA;AACA,iBAAiB,8EAAiB;AAClC,qBAAqB,8EAAiB;AACtC;AACA;AACA,qBAAqB,8EAAiB;AACtC,mCAAmC,4BAA4B;AAC/D;AACA,6BAA6B,8EAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,2DAAU;AACtC;AACA;AACA,sCAAsC,8EAAiB;AACvD;AACA;AACA;AACA;AACA,sCAAsC,8EAAiB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C,2BAA2B,gDAAK;AAChC;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,uBAAuB,iBAAiB;AACxC,qCAAqC,mEAAc;AACnD;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iBAAiB;AACxC,8BAA8B,gDAAU;AACxC,wCAAwC,4DAAc;AACtD;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA,6BAA6B,mCAAmC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,gCAAgC,wDAAkB;AAClD;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,gCAAgC,wDAAkB;AAClD;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iCAAiC,wDAAkB;AACnD;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iCAAiC,wDAAkB;AACnD;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,sCAAsC,wDAAkB;AACxD;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,sCAAsC,wDAAkB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA,wCAAwC,qDAAe;AACvD,oDAAoD,8DAAgB;AACpE,oDAAoD,8DAAgB;AACpE;AACA;AACA;AACA,yBAAyB,8EAAiB,4BAA4B,8EAAiB;AACvF;AACA,6BAA6B,8EAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,iDAAW;AACnC;AACA,gCAAgC,0DAAY;AAC5C,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C,0BAA0B,oDAAc;AACxC,gCAAgC,wDAAU;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,gCAAgC;AAC/D,mCAAmC,qDAAe;AAClD,0CAA0C,yDAAW;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,6BAA6B,gDAAU;AACvC,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA,sCAAsC,yDAAmB;AACzD;AACA;AACA;AACA,sCAAsC,mDAAa;AACnD;AACA;AACA;AACA;AACA;AACA,sCAAsC,oDAAc;AACpD;AACA,kDAAkD,8DAAgB;AAClE;AACA;AACA,qBAAqB,8EAAiB,6BAA6B,8EAAiB;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,qDAAe;AAC/C;AACA,4CAA4C,8DAAgB;AAC5D;AACA;AACA,kCAAkC,mEAAa;AAC/C;AACA;AACA;AACA,wDAAwD;AACxD;AACA;AACA;AACA;AACA,8BAA8B,mEAAa;AAC3C,+BAA+B,mEAAa;AAC5C;AACA;AACA;AACA,qCAAqC,qDAAe;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,qDAAe;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,yGAAyG,qDAAe;AACxH;AACA,oFAAoF,oDAAc;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,qDAAe;AAC/C;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,wDAAkB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB,4BAA4B,8EAAiB;AAC/E,4CAA4C,8EAAiB;AAC7D;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,6CAA6C,yDAAW;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC,8BAA8B,sDAAQ;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;ACzzBtB;AAAA;AAAA;AAAA;AAAA;AAAyD;AACb;AACY;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,mEAAa;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,WAAW,KAAK;AACnE;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA,4BAA4B;AAC5B;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,WAAW,aAAa,yBAAyB;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,6BAA6B,mEAAa;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mEAAa;AACxC;AACA,0CAA0C,mEAAa;AACvD,mDAAmD,mEAAa;AAChE,2BAA2B,mEAAa,wBAAwB,mEAAa;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,kBAAkB,8EAAiB;AACjE,4CAA4C;AAC5C;AACA,yEAAyE;AACzE;AACA;AACA;AACA;AACA;AACA,8DAA8D;AAC9D;AACA,2CAA2C;AAC3C;AACA;AACA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,uDAAgB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B,oBAAoB;AACpB;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA,oBAAoB;AACpB;AACA;AACA,oBAAoB;AACpB;AACA;AACA,oBAAoB;AACpB;AACA;AACA,oBAAoB;AACpB;AACA;AACA,oBAAoB;AACpB;AACA;AACA,oBAAoB;AACpB;AACA;AACA,oBAAoB;AACpB;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;ACtTtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACkD;AACG;AACE;AACsB;AAC5C;AACE;AAC0B;AAC+B;AAC5C;AACc;AACpB;AACc;AACxB;AACe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,qDAAO;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,2DAAK;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,4DAAO;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,kBAAkB;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,eAAe;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,8EAAiB;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB,mBAAmB,8EAAiB;AAC1E;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAW;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA,8HAA8H,8EAAiB;AAC/I;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,2DAAK;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,mBAAmB,WAAW;AAC9B;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,2DAAK;AAC3C;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,2DAAK;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAW;AAC9B;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA,sCAAsC,2DAAK;AAC3C;AACA;AACA;AACA;AACA,gDAAgD,8EAAiB,wBAAwB,8EAAiB;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAW;AAC9B;AACA;AACA;AACA;AACA;AACA,kCAAkC,2DAAK;AACvC;AACA,iBAAiB,8EAAiB;AAClC;AACA,qBAAqB,4DAAO;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,8EAAiB,wBAAwB,8EAAiB;AAClF;AACA;AACA;AACA,4BAA4B,4DAAO;AACnC;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB,wBAAwB,8EAAiB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mHAAmH,8EAAiB;AACpI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAW;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,8EAAiB;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,8EAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,mBAAmB,WAAW;AAC9B;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,2DAAK;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,WAAW;AAC9B;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,uFAAuF,8EAAiB,wBAAwB,8EAAiB;AACjJ;AACA,qEAAqE,2DAAK;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,8EAAiB,wBAAwB,8EAAiB;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,4DAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA,+FAA+F;AAC/F,wFAAwF;AACxF,kFAAkF;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,8EAAiB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,gDAAQ;AAClC;AACA;AACA,mCAAmC,8DAAgB;AACnD,mCAAmC,8DAAgB;AACnD,iCAAiC,2DAAU;AAC3C;AACA,0BAA0B,qDAAO;AACjC,oCAAoC,2DAAU;AAC9C;AACA,6BAA6B,2DAAU;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,8CAA8C,mDAAmD;AACjG;AACA,iDAAiD,oHAAoH,mEAAmE,oBAAoB,+MAA+M;AAC3c;AACA,iDAAiD,oHAAoH,mEAAmE,oBAAoB,8MAA8M;AAC1c;AACA,iDAAiD,oHAAoH,mEAAmE,oBAAoB,8MAA8M;AAC1c;AACA,iDAAiD,oHAAoH,iEAAiE,oBAAoB,8MAA8M;AACxc;AACA,iDAAiD,oHAAoH,mDAAmD,oBAAoB,8MAA8M;AAC1b;AACA,iDAAiD,oHAAoH,mDAAmD,oBAAoB,8MAA8M;AAC1b;AACA,8DAA8D,mDAAmD;AACjH;AACA,sDAAsD,iGAAiG,oEAAoE;AAC3N;AACA,sDAAsD,iGAAiG,oEAAoE;AAC3N;AACA,sDAAsD,iGAAiG,qEAAqE;AAC5N;AACA,sDAAsD,iGAAiG,kEAAkE;AACzN;AACA,sDAAsD,iGAAiG,oDAAoD;AAC3M;AACA,sDAAsD,iGAAiG,oDAAoD;AAC3M;AACA,iDAAiD,4GAA4G,6CAA6C;AAC1M;AACA,4CAA4C,uFAAuF,oBAAoB;AACvJ;AACA,4CAA4C,uFAAuF,uCAAuC;AAC1K;AACA,4CAA4C,uFAAuF,uCAAuC;AAC1K;AACA,4CAA4C,uFAAuF,uCAAuC;AAC1K;AACA,4CAA4C,uFAAuF,uCAAuC;AAC1K;AACA,4CAA4C,uFAAuF,uCAAuC;AAC1K;AACA,4CAA4C,uFAAuF,uCAAuC;AAC1K;AACA,4CAA4C,uFAAuF,uCAAuC;AAC1K;AACA,4CAA4C,uFAAuF,uCAAuC;AAC1K;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,uBAAuB,+BAA+B;AACtD;AACA,wCAAwC,iEAAa;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,uBAAuB,uBAAuB;AAC9C,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,mEAAc;AACzD;AACA;AACA,gDAAgD,iEAAa,KAAK,8EAAiB;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,oCAAoC,0EAAa;AACjD;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA,+BAA+B,0EAAa,SAAS,kDAAkD;AACvG,gEAAgE,wBAAwB,cAAc;AACtG;AACA;AACA;AACA,6BAA6B,0EAAa,SAAS,8EAA8E;AACjI;AACA;AACA;AACA;AACA;AACA,YAAY,4DAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,8CAAM;AAChC,8BAA8B,uDAAU;AACxC,8BAA8B,8CAAI;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAa;AACnC;AACA;AACA,8CAA8C,kBAAkB;AAChE,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA,2EAA2E,WAAW,YAAY,aAAa,aAAa;AAC5H,+EAA+E,WAAW,YAAY,aAAa,aAAa;AAChI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,4DAAO;AACpB;AACA,gBAAgB,4DAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,mEAAa;AAC5D;AACA;AACA,+CAA+C;AAC/C,0CAA0C;AAC1C,mCAAmC,mEAAa,yDAAyD;AACzG,qCAAqC,mBAAmB;AACxD;AACA,kDAAkD,WAAW,aAAa,aAAa,aAAa;AACpG,yDAAyD;AACzD,oCAAoC,oBAAoB,mBAAmB;AAC3E,iCAAiC,mEAAa,uFAAuF;AACrI,+EAA+E;AAC/E,kCAAkC,qBAAqB,mBAAmB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,0EAAa,SAAS,+BAA+B;AACrF;AACA;AACA;AACA;AACA,sCAAsC,8DAAM;AAC5C;AACA;AACA,wDAAwD,2BAA2B;AACnF,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,0EAAa,SAAS,+BAA+B;AAC9E;AACA;AACA;AACA;AACA,uCAAuC,8DAAM;AAC7C;AACA;AACA,wDAAwD,wBAAwB;AAChF,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,aAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,YAAY,mBAAmB,8BAA8B,YAAY,aAAa;AACxH;AACA,qCAAqC,YAAY,mBAAmB,wBAAwB,mBAAmB,wBAAwB,kBAAkB,oBAAoB,sBAAsB;AACnM,0BAA0B,0EAAa,SAAS,8CAA8C;AAC9F,oBAAoB,0EAAa,SAAS,kBAAkB;AAC5D,wBAAwB,0EAAa,SAAS,8CAA8C;AAC5F;AACA,kBAAkB,0EAAa,SAAS,kBAAkB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,8EAAiB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,0CAA0C,wDAAkB;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,mEAAa;AACrC,wBAAwB,mEAAa;AACrC;AACA;AACA,wBAAwB,mEAAa;AACrC;AACA;AACA;AACA,+BAA+B,wDAAkB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA,mBAAmB,2DAAK;AACxB;AACA;AACA;AACA,eAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,Y;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,uBAAuB;AACtD;AACA;AACA;AACA,6CAA6C,0CAAI;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,uBAAuB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,0CAAI;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,mEAAa;AACtC,0BAA0B,mEAAa;AACvC;AACA;AACA;AACA,iCAAiC,iDAAW;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,iDAAW,KAAK,8EAAiB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,mEAAa;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,mEAAa;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,mEAAa;AACnE;AACA;AACA;AACA;AACA;AACA,8DAA8D,mEAAa;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,iDAAW,KAAK,8EAAiB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,mEAAa;AACtE;AACA;AACA;AACA,8BAA8B,0CAAI;AAClC;AACA,oCAAoC,0CAAI;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,uBAAuB;AAClD;AACA;AACA,yCAAyC,0CAAI;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,mEAAa;AACtC,2BAA2B,mEAAa;AACxC,aAAa,8EAAiB;AAC9B,kBAAkB,mEAAa;AAC/B,6BAA6B,mEAAa;AAC1C,6BAA6B,mEAAa;AAC1C;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,oBAAoB,mEAAa;AACjC;AACA;AACA;AACA;AACA;AACA,8BAA8B,0CAAI,CAAC,mEAAa;AAChD,oCAAoC,0CAAI;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,0CAAI;AACtC;AACA,wCAAwC,0CAAI;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,0CAAI;AACtC;AACA,wCAAwC,0CAAI;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6EAA6E,mEAAa;AAC1F;AACA;AACA;AACA,kCAAkC,0CAAI;AACtC;AACA,wCAAwC,0CAAI;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB,uBAAuB,8EAAiB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,8FAA8F,mEAAa;AAC3G,qCAAqC,mEAAa;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA,+BAA+B,yCAAyC;AACxE;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,wDAAkB;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,WAAW,8EAAiB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,4DAAO;AACpB;AACA,gBAAgB,4DAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACuB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB,WAAW,8EAAiB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAAI;AAC3B;AACA;AACA,yBAAyB,8EAAiB,0BAA0B,mEAAa;AACjF;AACA,0BAA0B,8EAAiB,0BAA0B,mEAAa;AAClF;AACA;AACA;AACA;AACA,qCAAqC,0CAAI;AACzC,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,2DAAK;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,kBAAkB,8EAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,2DAAK;AAC7B;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,mEAAa;AACrC,yBAAyB,mEAAa;AACtC;AACA;AACA;AACA;AACA;AACA,6BAA6B,8EAAiB,2BAA2B,8EAAiB;AAC1F,6BAA6B,8EAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,8EAAiB,eAAe,8EAAiB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,sEAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,wDAAkB;AACjD,4BAA4B,qDAAe;AAC3C,wCAAwC,gDAAU;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAAa;AACjC;AACA;AACA;AACA;AACA;AACA,kCAAkC,0CAAI,CAAC,mEAAa,gDAAgD,mEAAa;AACjH;AACA;AACA;AACA,kCAAkC,0CAAI,CAAC,mEAAa,gDAAgD,mEAAa;AACjH;AACA,oCAAoC,0CAAI;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA,sDAAsD,0CAAI;AAC1D;AACA;AACA;AACA,sDAAsD,0CAAI;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAC2B;;;;;;;;;;;;;AClyF5B;AAAA;AAAA;AAAyD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACe;;;;;;;;;;;;;ACjEhB;AAAA;AAAA;AAAA;AAAyD;AACD;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,2BAA2B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,8EAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,oBAAoB,mEAAa;AACjC,qBAAqB,mEAAa;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC,2FAA2F;AAC3F;AACA,iBAAiB,8EAAiB;AAClC,6FAA6F;AAC7F;AACA,iBAAiB,8EAAiB;AAClC,yFAAyF;AACzF;AACA,iBAAiB,8EAAiB;AAClC,+FAA+F;AAC/F;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,uDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,uGAAuG;AACvG;AACA;AACA,kFAAkF;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B;AAC3B;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,yEAAyE;AACzE;AACA;AACA,aAAa,8EAAiB;AAC9B,wEAAwE;AACxE;AACA;AACA,aAAa,8EAAiB;AAC9B,0EAA0E;AAC1E;AACA;AACA,aAAa,8EAAiB;AAC9B,2EAA2E;AAC3E;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,yEAAyE;AACzE;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,yEAAyE;AACzE;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA,sEAAsE;AACtE;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,4BAA4B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,mGAAmG;AACnG;AACA;AACA;AACA;AACA;AACA,yDAAyD;AACzD;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B;AACxD,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;AC/oBtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAC8B;AACA;AACA;AACA;;;;;;;;;;;;;ACN9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoM;AACvJ;AACY;AACD;AACE;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,uEAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,uDAAU,uBAAuB,uDAAU;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,8EAAiB;AAC1D;AACA;AACA;AACA;AACA;AACA,yCAAyC,4DAAe;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,8EAAiB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,uDAAU;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,wBAAwB,uDAAU;AAC3C;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,wDAAW;AAC3C;AACA;AACA,8BAA8B,4DAAe;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,wDAAW;AACvC;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,+BAA+B,4DAAe;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gCAAgC;AACvD;AACA,mCAAmC,+DAAkB;AACrD;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,4DAAe;AAC9C;AACA;AACA,oCAAoC,4DAAe;AACnD;AACA,2BAA2B,mEAAa;AACxC,4BAA4B,mEAAa;AACzC;AACA,oCAAoC,+DAAkB;AACtD;AACA;AACA;AACA,oCAAoC,2DAAc;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,uDAAU;AAC7D;AACA,gCAAgC,eAAe;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA,mCAAmC,+DAAkB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,mEAAa;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,8EAAiB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA,uBAAuB,qBAAqB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,2DAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,wBAAwB,wDAAW;AAC5C;AACA;AACA;AACA,mCAAmC,2DAAc;AACjD;AACA;AACA;AACA;AACA,uBAAuB,mCAAmC;AAC1D;AACA,kCAAkC,4DAAe;AACjD;AACA,wBAAwB,8EAAiB;AACzC,wBAAwB,8EAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,wBAAwB,2DAAc;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,4DAAe;AACtD;AACA;AACA;AACA;AACA;AACA,uBAAuB,4CAA4C;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iCAAiC;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iCAAiC;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;AC9mBtB;AAAA;AAAA;AAAA;AAA0D;AACD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,uEAAY;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,uEAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qBAAqB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,8BAA8B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA,2BAA2B,sBAAsB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA,2BAA2B,uBAAuB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;ACxKtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyE;AAClB;AACE;AAChB;AACA;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8EAAiB;AACjC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,2CAA2C,iDAAU;AACrD;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,+CAA+C,iDAAU;AACzD;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,+CAA+C,iDAAU;AACzD;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,6CAA6C,iDAAU;AACvD;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,kFAAkF;AAC3H;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,sEAAU;AACtC;AACA,kCAAkC,iDAAU;AAC5C,8BAA8B,iDAAU;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,oEAAS;AAClC;AACA;AACA;AACA,iCAAiC;AACjC,8BAA8B,0EAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAmF;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,iDAAU;AACnC;AACA;AACA;AACA;AACA;AACA,uBAAuB,4BAA4B;AACnD;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,uBAAuB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,8EAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA,yBAAyB,8EAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA,2BAA2B,mBAAmB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,iDAAU;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC,qCAAqC;AACrC,qCAAqC;AACrC;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,kBAAkB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,WAAW;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4EAA4E,SAAS;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,8EAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,qCAAqC;AACrC;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qBAAqB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB,gBAAgB,8EAAiB;AAC/D;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yG;AACA;AACA;AACA;AACA;AACA,uG;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,oEAAS;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,iCAAiC,0EAAc;AAC/C,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,qCAAqC;AACrC;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,Y;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,iBAAiB,8EAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA,aAAa,8EAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,oEAAS;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,0EAAc;AAC/C;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,YAAY;AAC5E;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA,uBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,oEAAS;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,0EAAc;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,oEAAS;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,0EAAc;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,6BAA6B,oEAAS;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,0EAAc;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,oEAAS;AAClC;AACA;AACA;AACA;AACA,iCAAiC,0EAAc;AAC/C;AACA;AACA;AACA;AACA,yBAAyB,oEAAS;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,0EAAc;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iBAAiB;AAC5C;AACA;AACA,oBAAoB,8EAAiB;AACrC;AACA;AACA;AACA;AACA,oCAAoC,oDAAa;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,0EAAc;AAC3D;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qCAAqC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,oEAAS;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,0EAAc;AAC/C;AACA;AACA;AACA,yBAAyB,oEAAS;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,0EAAc;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACqB;;;;;;;;;;;;;AC3jGtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAC6B;AACK;AACK;;;;;;;;;;;;;ACLvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACwC;AACU;;;;;;;;;;;;ACJlD,+DAA+D,+N;;;;;;;;;;;ACA/D,6hEAA6hE,kCAAkC,8IAA8I,wSAAwS,uCAAuC,aAAa,4sE;;;;;;;;;;;;;;;;;;;;;;;ACAz9E;AACnB;AAOrC;AACyB;AAIjB;AAEqC;AAM7B;AAQxC;IA2BE,sCACU,UAA8B,EAC9B,WAAwB,EACxB,cAA8B,EAC9B,SAA2B;QAJrC,iBAOC;QANS,eAAU,GAAV,UAAU,CAAoB;QAC9B,gBAAW,GAAX,WAAW,CAAa;QACxB,mBAAc,GAAd,cAAc,CAAgB;QAC9B,cAAS,GAAT,SAAS,CAAkB;QA9B9B,eAAU,GAAW;YAC1B,EAAE,IAAI,EAAE,2BAA2B,EAAE;YACrC,EAAE,IAAI,EAAE,iBAAiB,EAAE;YAC3B,EAAE,IAAI,EAAE,kBAAkB,EAAE;SAC7B,CAAC;QAEK,iBAAY,GAAa;YAC9B;gBACE,IAAI,EAAE,IAAI;gBACV,IAAI,EAAE,IAAI;gBACV,IAAI,EAAE,IAAI;aACX;SACF,CAAC;QAOK,eAAU,GAAa,EAAE,CAAC;QAqIjC,iBAAY,GAAqB,UAAC,IAAS;YACzC,KAAI,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;YAC1C,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;YAC/B,OAAO,CAAC,GAAG,CAAC,KAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC;QACrD,CAAC,CAAC;QA5HA,IAAI,CAAC,UAAU,EAAE,CAAC;IACpB,CAAC;IAED,sBAAI,sDAAY;aAAhB;YACE,OAAO,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,MAAM,CAAgB,CAAC;QAC7D,CAAC;;;OAAA;IACD,sBAAI,yDAAe;aAAnB;YACE,OAAO,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,iBAAiB,CAAc,CAAC;QACtE,CAAC;;;OAAA;IAED,sBAAI,iDAAO;aAAX;YACE,OAAO,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,SAAS,CAAgB,CAAC;QAChE,CAAC;;;OAAA;IACD,sDAAe,GAAf;QACE,IAAM,eAAe,GAAG,IAAI,oEAAe,EAAE,CAAC;QAE9C,IAAI,IAAI,CAAC,mBAAmB,CAAC,KAAK,EAAE;YAClC,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,UAAU,EAAE;gBACpC,eAAe,CAAC,gBAAgB,GAAG;oBACjC,EAAE,EAAE,IAAI,CAAC,UAAU;oBACnB,IAAI,EAAE,IAAI,CAAC,YAAY,CAAC,KAAK;oBAC7B,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK;iBAC5B,CAAC;aACH;iBAAM;gBACL,eAAe,CAAC,gBAAgB,GAAG;oBACjC,IAAI,EAAE,IAAI,CAAC,YAAY,CAAC,KAAK;oBAC7B,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK;iBAC5B,CAAC;aACH;YAED,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,OAAO,CAAC,iBAAO;gBAC3C,eAAe,CAAC,uBAAuB,CAAC,IAAI,CAAC;oBAC3C,EAAE,EAAE,OAAO,CAAC,KAAK,CAAC,EAAE;oBACpB,MAAM,EAAE,OAAO,CAAC,KAAK,CAAC,MAAM;oBAC5B,IAAI,EAAE,OAAO,CAAC,KAAK,CAAC,IAAI;iBACzB,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,iBAAO;gBAC7B,eAAe,CAAC,WAAW,CAAC,uBAAuB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACpE,CAAC,CAAC,CAAC;YAEH,OAAO,eAAe,CAAC;SACxB;aAAM;YACL,OAAO,IAAI,CAAC;SACb;IACH,CAAC;IAED,+CAAQ,GAAR;QAAA,iBAYC;QAXC,IAAI,CAAC,UAAU,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;QAE3E,IAAI,CAAC,SAAS;aACX,gBAAgB,EAAE;aAClB,SAAS,CAAC,cAAI,IAAI,QAAC,KAAI,CAAC,SAAS,GAAG,IAAI,CAAC,EAAvB,CAAuB,CAAC,CAAC;QAC9C,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACrB,IAAI,CAAC,UAAU;iBACZ,sBAAsB,CAAC,IAAI,CAAC,UAAU,CAAC;iBACvC,SAAS,CAAC,UAAC,IAAqB,IAAK,YAAI,CAAC,cAAc,CAAC,IAAI,CAAC,EAAzB,CAAyB,CAAC,CAAC;SACpE;IACH,CAAC;IAED,iDAAU,GAAV;QACE,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YAChD,EAAE,EAAE,CAAC,wDAAI,CAAC,OAAO,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;YACzC,IAAI,EAAE,CAAC,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;YAC/B,OAAO,EAAE,CAAC,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;YAClC,eAAe,EAAE,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC;SACrE,CAAC,CAAC;IACL,CAAC;IAED,qDAAc,GAAd,UAAe,QAAyB;QAAxC,iBASC;QARC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YAChD,IAAI,EAAE,CAAC,QAAQ,CAAC,gBAAgB,CAAC,IAAI,EAAE,yDAAU,CAAC,QAAQ,CAAC;YAC3D,OAAO,EAAE,CAAC,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,yDAAU,CAAC,QAAQ,CAAC;YACjE,eAAe,EAAE,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE,CAAC;SAC5C,CAAC,CAAC;QACH,QAAQ,CAAC,uBAAuB,CAAC,GAAG,CAAC,gBAAM;YACzC,YAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC;QAA5D,CAA4D,CAC7D,CAAC;IACJ,CAAC;IAED,2DAAoB,GAApB,UAAqB,MAAkC;QACrD,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YAC5B,EAAE,EAAE,CAAC,MAAM,CAAC,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;YACpC,IAAI,EAAE,CAAC,MAAM,CAAC,IAAI,EAAE,yDAAU,CAAC,QAAQ,CAAC;YACxC,MAAM,EAAE,CAAC,MAAM,CAAC,MAAM,EAAE,yDAAU,CAAC,QAAQ,CAAC;SAC7C,CAAC,CAAC;IACL,CAAC;IAED,yDAAkB,GAAlB;QACE,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YAC5B,IAAI,EAAE,CAAC,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;YAC/B,MAAM,EAAE,CAAC,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;SAClC,CAAC,CAAC;IACL,CAAC;IAED,mDAAY,GAAZ,UAAa,KAAa;QACxB,IAAM,gBAAgB,GAAG,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QACxE,IAAI,gBAAgB,EAAE;YACpB,IAAM,IAAI,GAAG,OAAO,CAAC,iCAAiC,CAAC,CAAC;YAExD,IAAI,IAAI,EAAE;gBACR,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;gBAC7C,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;aACtC;SACF;aAAM;YACL,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;SACtC;IACH,CAAC;IAED,gDAAS,GAAT;QACE,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,IAAI,CAChC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YACrB,MAAM,EAAE,CAAC,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;YACjC,IAAI,EAAE,CAAC,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;SAChC,CAAC,CACH,CAAC;IACJ,CAAC;IAQD,+CAAQ,GAAR;QAAA,iBAoBC;QAnBC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,YAAY,EAAE,CAAC,CAAC;QAC7D,IAAM,QAAQ,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;QAExC,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,UAAU;iBACZ,qBAAqB,CAAC,QAAQ,CAAC;iBAC/B,SAAS,CACR,cAAM,YAAK,CAAC,kBAAkB,CAAC,EAAzB,CAAyB,EAC/B,UAAC,KAAwB,IAAK,YAAK,CAAC,KAAK,CAAC,OAAO,CAAC,EAApB,CAAoB,CACnD,CAAC;SACL;aAAM;YACL,IAAI,CAAC,UAAU,CAAC,qBAAqB,CAAC,QAAQ,CAAC,CAAC,SAAS,CACvD,UAAC,IAAS;gBACR,KAAI,CAAC,UAAU,GAAG,IAAI,CAAC;gBACvB,KAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACvB,CAAC,EACD,UAAC,KAAwB,IAAK,YAAK,CAAC,KAAK,CAAC,OAAO,CAAC,EAApB,CAAoB,CACnD,CAAC;SACH;IACH,CAAC;IA1JD;QADC,+DAAS,CAAC,eAAe,CAAC;wEACL,gFAAiB;uEAAC;IAzB7B,4BAA4B;QANxC,+DAAS,CAAC;YACT,QAAQ,EAAE,8BAA8B;YACxC,qKAAqD;YAErD,aAAa,EAAE,+DAAiB,CAAC,IAAI;;SACtC,CAAC;+EA6BsB,wEAAkB;YACjB,0DAAW;YACR,8DAAc;YACnB,oEAAgB;OA/B1B,4BAA4B,CAoLxC;IAAD,mCAAC;CAAA;AApLwC;;;;;;;;;;;;AC7BzC,+DAA+D,+N;;;;;;;;;;;ACA/D,6X;;;;;;;;;;;;;;;;;;ACAqE;AACR;AAU7D;IAsCE,sCAAoB,kBAAsC;QAAtC,uBAAkB,GAAlB,kBAAkB,CAAoB;QArCnD,SAAI,GAA+B,EAAE,CAAC;QACtC,gBAAW,GAAwB;YACxC;gBACE,GAAG,EAAE,IAAI;gBACT,KAAK,EAAE,EAAE;gBACT,MAAM,EAAE,IAAI;gBACZ,IAAI,EAAE,QAAQ;aACf;YACD;gBACE,GAAG,EAAE,MAAM;gBACX,MAAM,EAAE,cAAc;gBACtB,IAAI,EAAE,QAAQ;aACf;YACD;gBACE,GAAG,EAAE,YAAY;gBACjB,MAAM,EAAE,eAAe;gBACvB,IAAI,EAAE,QAAQ;gBACd,KAAK,EAAE,EAAE;aACV;YAED;gBACE,MAAM,EAAE,OAAO;gBACf,GAAG,EAAE,YAAY;gBACjB,IAAI,EAAE,MAAM;gBACZ,MAAM,EAAE,KAAK;gBACb,OAAO,EAAE,KAAK;gBACd,KAAK,EAAE,GAAG;aACX;YACD;gBACE,MAAM,EAAE,SAAS;gBACjB,GAAG,EAAE,cAAc;gBACnB,IAAI,EAAE,MAAM;gBACZ,MAAM,EAAE,KAAK;gBACb,OAAO,EAAE,KAAK;gBACd,KAAK,EAAE,GAAG;aACX;SACF,CAAC;IAC2D,CAAC;IAE9D,+CAAQ,GAAR;QAAA,iBAIC;QAHC,IAAI,CAAC,kBAAkB;aACpB,oBAAoB,EAAE;aACtB,SAAS,CAAC,UAAC,IAAgC,IAAK,QAAC,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC,EAAlB,CAAkB,CAAC,CAAC;IACzE,CAAC;IAED,qDAAc,GAAd,UAAe,IAAS;QACtB,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACf,IAAI,CAAC,kBAAkB;aACpB,qBAAqB,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;aAChC,SAAS,CAAC,cAAM,YAAK,CAAC,6BAA6B,CAAC,EAApC,CAAoC,CAAC,CAAC;IAC3D,CAAC;IAnDU,4BAA4B;QANxC,+DAAS,CAAC;YACT,QAAQ,EAAE,8BAA8B;YACxC,qKAAqD;YAErD,aAAa,EAAE,+DAAiB,CAAC,IAAI;;SACtC,CAAC;+EAuCwC,wEAAkB;OAtC/C,4BAA4B,CAoDxC;IAAD,mCAAC;CAAA;AApDwC;;;;;;;;;;;;;;;;;;;ACXE;AACO;AAYlD;IAEE,4BAAoB,UAAsB;QAAtB,eAAU,GAAV,UAAU,CAAY;QACxC,IAAI,CAAC,QAAQ,GAAG,IAAI,eAAe,EAAE,CAAC;IACxC,CAAC;IAED,iDAAoB,GAApB;QACE,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAA6B,kBAAkB,CAAC,CAAC;IAC7E,CAAC;IAED,mDAAsB,GAAtB,UAAuB,EAAU;QAC/B,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAkB,sBAAoB,EAAI,CAAC,CAAC;IACxE,CAAC;IAED,kDAAqB,GAArB,UACE,eAAgC;QAEhC,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CACzB,kBAAkB,EAClB,eAAe,CAChB,CAAC;IACJ,CAAC;IAED,kDAAqB,GAArB,UACE,eAAgC;QAEhC,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CACzB,6BAA2B,eAAe,CAAC,gBAAgB,CAAC,EAAI,EAChE,eAAe,CAChB,CAAC;IACJ,CAAC;IAED,kDAAqB,GAArB,UACE,UAAoB;QAEpB,IAAM,KAAK,GAAU,EAAE,CAAC;QACxB,UAAU,CAAC,OAAO,CAAC,YAAE,IAAI,YAAK,CAAC,IAAI,CAAC,EAAE,EAAE,EAAE,KAAG,EAAI,EAAE,CAAC,EAA3B,CAA2B,CAAC,CAAC;QACtD,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CACzB,yBAAyB,EACzB,KAAK,CACN,CAAC;IACJ,CAAC;IAED,2BAA2B;IAC3B,uCAAU,GAAV;QACE,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAqB,UAAU,CAAC,CAAC;IAC7D,CAAC;IAED,2CAAc,GAAd,UAAe,EAAU;QACvB,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAU,cAAY,EAAI,CAAC,CAAC;IACxD,CAAC;IAED,0CAAa,GAAb,UAAc,OAAgB;QAC5B,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CAAmB,UAAU,EAAE,OAAO,CAAC,CAAC;IACrE,CAAC;IAED,0CAAa,GAAb,UAAc,OAAgB;QAC5B,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CACzB,qBAAmB,OAAO,CAAC,OAAO,CAAC,EAAI,EACvC,OAAO,CACR,CAAC;IACJ,CAAC;IAED,0CAAa,GAAb,UAAc,UAAoB;QAChC,IAAM,KAAK,GAAU,EAAE,CAAC;QACxB,UAAU,CAAC,OAAO,CAAC,YAAE,IAAI,YAAK,CAAC,IAAI,CAAC,EAAE,EAAE,EAAE,KAAG,EAAI,EAAE,CAAC,EAA3B,CAA2B,CAAC,CAAC;QACtD,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CAAmB,iBAAiB,EAAE,KAAK,CAAC,CAAC;IAC1E,CAAC;IAnEU,kBAAkB;QAD9B,gEAAU,EAAE;+EAGqB,+DAAU;OAF/B,kBAAkB,CAoE9B;IAAD,yBAAC;CAAA;AApE8B;;;;;;;;;;;;;ACQ/B;AAAA;AAAA;AAAA;AAAA;AAAA;IAAA;QACE,mBAAc,GAAa,EAAE,CAAC;IAChC,CAAC;IAAD,wBAAC;AAAD,CAAC;;AACD;IAAA;QACE,UAAK,GAAa,EAAE,CAAC;QACrB,WAAM,GAAU,EAAE,CAAC;QACnB,WAAM,GAAU,EAAE,CAAC;QAGnB,mBAAc,GAAyB,EAAE,CAAC;QAC1C,gBAAW,GAAsB,IAAI,iBAAiB,EAAE,CAAC;IAC3D,CAAC;IAAD,cAAC;AAAD,CAAC;;AAuBD;IAAA;QACE,4BAAuB,GAAa,EAAE,CAAC;IACzC,CAAC;IAAD,gCAAC;AAAD,CAAC;;AAED;IAAA;QAEE,4BAAuB,GAAiC,EAAE,CAAC;QAC3D,gBAAW,GAA8B,IAAI,yBAAyB,EAAE,CAAC;IAC3E,CAAC;IAAD,sBAAC;AAAD,CAAC;;;;;;;;;;;;;AC/DD,+DAA+D,2M;;;;;;;;;;;ACA/D,urBAAurB,sCAAsC,oHAAoH,YAAY,84DAA84D,kCAAkC,8IAA8I,0RAA0R,uCAAuC,aAAa,6yF;;;;;;;;;;;;;;;;;;;;;;;ACAzpG;AACnB;AAOrC;AACyB;AAKjB;AAEqC;AACF;AAUnE;IA0BE,+BACU,UAA8B,EAC9B,WAAwB,EACxB,cAA8B,EAC9B,UAA4B;QAH5B,eAAU,GAAV,UAAU,CAAoB;QAC9B,gBAAW,GAAX,WAAW,CAAa;QACxB,mBAAc,GAAd,cAAc,CAAgB;QAC9B,eAAU,GAAV,UAAU,CAAkB;QA7B/B,eAAU,GAAW;YAC1B,EAAE,IAAI,EAAE,2BAA2B,EAAE;YACrC,EAAE,IAAI,EAAE,iBAAiB,EAAE;YAC3B,EAAE,IAAI,EAAE,kBAAkB,EAAE;SAC7B,CAAC;QAKK,iBAAY,GAAa;YAC9B;gBACE,IAAI,EAAE,IAAI;gBACV,IAAI,EAAE,IAAI;gBACV,IAAI,EAAE,IAAI;aACX;SACF,CAAC;QAIK,sBAAiB,GAAU,EAAE,CAAC;QAE9B,eAAU,GAAa,EAAE,CAAC;QAU/B,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,MAAM,GAAG,wDAAI,CAAC,OAAO,EAAE,CAAC;QAC7B,IAAI,CAAC,IAAI,GAAG;YACV,OAAO,EAAE,qEACP,IAAI,CAAC,MACL;YACF,SAAS,EACP,wEAAwE;SAC3E,CAAC;IACJ,CAAC;IAED,wCAAQ,GAAR;QAAA,iBAiBC;QAhBC,IAAI,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;QACzE,IAAI,CAAC,UAAU;aACZ,oBAAoB,EAAE;aACtB,SAAS,CACR,UAAC,IAAgC,IAAK,QAAC,KAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,EAA/B,CAA+B,CACtE,CAAC;QACJ,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACrB,IAAI,CAAC,UAAU;iBACZ,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC;iBAC9B,SAAS,CAAC,UAAC,IAAa,IAAK,YAAI,CAAC,cAAc,CAAC,IAAI,CAAC,EAAzB,CAAyB,CAAC,CAAC;SAC5D;QAED,IAAI,CAAC,UAAU;aACZ,gBAAgB,EAAE;aAClB,SAAS,CAAC,cAAI,IAAI,QAAC,KAAI,CAAC,SAAS,GAAG,IAAI,CAAC,EAAvB,CAAuB,CAAC,CAAC;IAChD,CAAC;IAED,0CAAU,GAAV;QACE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YACxC,QAAQ,EAAE,CAAC,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;YACnC,KAAK,EAAE,CAAC,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;YAChC,OAAO,EAAE,CAAC,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;YAClC,cAAc,EAAE,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE,CAAC;SAC3C,CAAC,CAAC;IACL,CAAC;IAED,kDAAkB,GAAlB;QACE,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YAC5B,OAAO,EAAE,CAAC,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;YAClC,MAAM,EAAE,CAAC,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;YACjC,KAAK,EAAE,CAAC,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;SACjC,CAAC,CAAC;IACL,CAAC;IACD,+CAAe,GAAf,UAAgB,MAA0B;QACxC,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YAC5B,EAAE,EAAE,CAAC,MAAM,CAAC,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;YACpC,OAAO,EAAE,CAAC,MAAM,CAAC,OAAO,EAAE,yDAAU,CAAC,QAAQ,CAAC;YAC9C,MAAM,EAAE,CAAC,MAAM,CAAC,MAAM,EAAE,yDAAU,CAAC,QAAQ,CAAC;YAC5C,KAAK,EAAE,CAAC,MAAM,CAAC,MAAM,EAAE,yDAAU,CAAC,QAAQ,CAAC;SAC5C,CAAC,CAAC;IACL,CAAC;IAED,8CAAc,GAAd,UAAe,KAAU;QACvB,IAAI,CAAC,UAAU,EAAE,CAAC;IACpB,CAAC;IACD,8CAAc,GAAd,UAAe,OAAgB;QAA/B,iBAgCC;QA/BC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YACxC,EAAE,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,EAAE,yDAAU,CAAC,QAAQ,CAAC;YAC7C,QAAQ,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,WAAW,EAAE,yDAAU,CAAC,QAAQ,CAAC;YAC5D,KAAK,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,EAAE,yDAAU,CAAC,QAAQ,CAAC;YACpD,OAAO,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,yDAAU,CAAC,QAAQ,CAAC;YACvD,cAAc,EAAE,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE,CAAC;SAC3C,CAAC,CAAC;QAEH,OAAO,CAAC,cAAc,CAAC,OAAO,CAAC,iBAAO;YACpC,KAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC,CAAC;QACnE,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC;QAC9B,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;QACvB,IAAI,OAAO,CAAC,KAAK,CAAC,MAAM,EAAE;YACxB,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,iBAAO;gBAC3B,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAClC,CAAC,CAAC,CAAC;SACJ;QAED,IAAI,OAAO,CAAC,MAAM,CAAC,MAAM,EAAE;YACzB,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,iBAAO;gBAC5B,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAClC,CAAC,CAAC,CAAC;SACJ;QAED,IAAI,OAAO,CAAC,MAAM,CAAC,MAAM,EAAE;YACzB,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,iBAAO;gBAC5B,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAClC,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;IAED,sBAAI,+CAAY;aAAhB;YACE,OAAO,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,OAAO,CAAgB,CAAC;QACtD,CAAC;;;OAAA;IAED,sBAAI,0CAAO;aAAX;YACE,OAAO,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,SAAS,CAAgB,CAAC;QACxD,CAAC;;;OAAA;IACD,sBAAI,2CAAQ;aAAZ;YACE,OAAO,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,UAAU,CAAgB,CAAC;QACzD,CAAC;;;OAAA;IAED,sBAAI,iDAAc;aAAlB;YACE,OAAO,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,gBAAgB,CAAc,CAAC;QAC7D,CAAC;;;OAAA;IAED,wCAAQ,GAAR;QACE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,YAAY,EAAE,CAAC,CAAC;IAC/D,CAAC;IAED,0CAAU,GAAV;QAAA,iBAsBC;QArBC,IAAM,QAAQ,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;QAExC,IAAI,QAAQ,EAAE;YACZ,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;gBAClB,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,SAAS,CAC/C,UAAC,IAAS;oBACR,KAAI,CAAC,UAAU,GAAG,IAAI,CAAC;oBACvB,KAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;oBACrB,KAAK,CAAC,8BAA8B,CAAC,CAAC;gBACxC,CAAC,EACD,UAAC,KAAwB,IAAK,YAAK,CAAC,KAAK,CAAC,OAAO,CAAC,EAApB,CAAoB,CACnD,CAAC;aACH;iBAAM;gBACL,IAAI,CAAC,UAAU;qBACZ,aAAa,CAAC,QAAQ,CAAC;qBACvB,SAAS,CACR,cAAM,YAAK,CAAC,8BAA8B,CAAC,EAArC,CAAqC,EAC3C,UAAC,KAAwB,IAAK,YAAK,CAAC,KAAK,CAAC,OAAO,CAAC,EAApB,CAAoB,CACnD,CAAC;aACL;SACF;IACH,CAAC;IACD,+CAAe,GAAf;QACE,IAAM,OAAO,GAAG,IAAI,4DAAO,EAAE,CAAC;QAE9B,IAAI,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE;YAC1B,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,SAAS,EAAE;gBACnC,OAAO,CAAC,OAAO,GAAG;oBAChB,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK;oBAC3B,WAAW,EAAE,IAAI,CAAC,QAAQ,CAAC,KAAK;oBAChC,MAAM,EAAE,IAAI,CAAC,YAAY,CAAC,KAAK;oBAC/B,EAAE,EAAE,IAAI,CAAC,SAAS;iBACnB,CAAC;aACH;iBAAM;gBACL,OAAO,CAAC,OAAO,GAAG;oBAChB,MAAM,EAAE,IAAI,CAAC,YAAY,CAAC,KAAK;oBAC/B,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK;oBAC3B,WAAW,EAAE,IAAI,CAAC,QAAQ,CAAC,KAAK;iBACjC,CAAC;aACH;YAED,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,OAAO,CAAC,iBAAO;gBAC1C,cAAO,CAAC,cAAc,CAAC,IAAI,CAAC;oBAC1B,EAAE,EAAE,OAAO,CAAC,KAAK,CAAC,EAAE;oBACpB,OAAO,EAAE,OAAO,CAAC,KAAK,CAAC,OAAO;oBAC9B,MAAM,EAAE,OAAO,CAAC,KAAK,CAAC,KAAK;oBAC3B,MAAM,EAAE,OAAO,CAAC,KAAK,CAAC,MAAM;iBAC7B,CAAC;YALF,CAKE,CACH,CAAC;YACF,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,iBAAO;gBAC7B,OAAO,CAAC,WAAW,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACnD,CAAC,CAAC,CAAC;YAEH,OAAO,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;YAC5B,OAAO,OAAO,CAAC;SAChB;aAAM;YACL,OAAO,IAAI,CAAC;SACb;IACH,CAAC;IAED,yCAAS,GAAT;QACE,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC;IAC/D,CAAC;IAED,4CAAY,GAAZ,UAAa,KAAa;QACxB,IAAM,gBAAgB,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QAEvE,IAAI,gBAAgB,EAAE;YACpB,IAAM,IAAI,GAAG,OAAO,CAAC,iCAAiC,CAAC,CAAC;YAExD,IAAI,IAAI,EAAE;gBACR,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;gBAC7C,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;aACrC;SACF;aAAM;YACL,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;SACrC;IACH,CAAC;IArND;QADC,+DAAS,CAAC,eAAe,CAAC;wEACL,gFAAiB;gEAAC;IAR7B,qBAAqB;QANjC,+DAAS,CAAC;YACT,QAAQ,EAAE,sBAAsB;YAChC,6IAA6C;YAE7C,aAAa,EAAE,+DAAiB,CAAC,IAAI;;SACtC,CAAC;+EA4BsB,wEAAkB;YACjB,0DAAW;YACR,8DAAc;YAClB,oEAAgB;OA9B3B,qBAAqB,CA8NjC;IAAD,4BAAC;CAAA;AA9NiC;;;;;;;;;;;;;;;;;;;;;;;AC3BO;AACc;AACgD;AACvB;AACA;AACuB;AAEvG,IAAM,MAAM,GAAW;IACrB,EAAE,IAAI,EAAE,EAAE,EAAE,SAAS,EAAE,4FAAqB,EAAE;IAC9C,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS,EAAE,4FAAqB,EAAE;IACjD,EAAE,IAAI,EAAE,mBAAmB,EAAE,SAAS,EAAE,4FAAqB,EAAE;IAC/D,EAAE,IAAI,EAAE,UAAU,EAAE,SAAS,EAAE,mHAA4B,EAAE;IAC7D,EAAE,IAAI,EAAE,cAAc,EAAE,SAAS,EAAE,mHAA4B,EAAE;IACjE;QACE,IAAI,EAAE,6BAA6B;QACnC,SAAS,EAAE,mHAA4B;KACxC;IACD,EAAE,IAAI,EAAE,mBAAmB,EAAE,SAAS,EAAE,mHAA4B,EAAE;CACvE,CAAC;AAMF;IAAA;IAAoC,CAAC;IAAxB,qBAAqB;QAJjC,8DAAQ,CAAC;YACR,OAAO,EAAE,CAAC,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;YACxC,OAAO,EAAE,CAAC,4DAAY,CAAC;SACxB,CAAC;OACW,qBAAqB,CAAG;IAAD,4BAAC;CAAA;AAAH;;;;;;;;;;;;ACxBlC,+DAA+D,2M;;;;;;;;;;;ACA/D,4X;;;;;;;;;;;;;;;;;;ACAqE;AACR;AAW7D;IAsCE,+BAAoB,UAA8B;QAA9B,eAAU,GAAV,UAAU,CAAoB;QArC3C,SAAI,GAAuB,EAAE,CAAC;QAC9B,gBAAW,GAAwB;YACxC;gBACE,GAAG,EAAE,IAAI;gBACT,KAAK,EAAE,EAAE;gBACT,MAAM,EAAE,IAAI;gBACZ,IAAI,EAAE,QAAQ;aACf;YACD;gBACE,GAAG,EAAE,QAAQ;gBACb,MAAM,EAAE,QAAQ;gBAChB,IAAI,EAAE,QAAQ;aACf;YACD;gBACE,MAAM,EAAE,aAAa;gBACrB,GAAG,EAAE,aAAa;gBAClB,IAAI,EAAE,QAAQ;gBACd,OAAO,EAAE,KAAK;gBACd,KAAK,EAAE,GAAG;aACX;YACD;gBACE,MAAM,EAAE,OAAO;gBACf,GAAG,EAAE,YAAY;gBACjB,IAAI,EAAE,MAAM;gBACZ,MAAM,EAAE,KAAK;gBACb,OAAO,EAAE,KAAK;gBACd,KAAK,EAAE,GAAG;aACX;YACD;gBACE,MAAM,EAAE,SAAS;gBACjB,GAAG,EAAE,cAAc;gBACnB,IAAI,EAAE,MAAM;gBACZ,MAAM,EAAE,KAAK;gBACb,OAAO,EAAE,KAAK;gBACd,KAAK,EAAE,GAAG;aACX;SACF,CAAC;IACmD,CAAC;IAEtD,wCAAQ,GAAR;QAAA,iBAEC;QADC,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE,CAAC,SAAS,CAAC,cAAI,IAAI,QAAC,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC,EAAlB,CAAkB,CAAC,CAAC;IACrE,CAAC;IAED,6CAAa,GAAb,UAAc,OAAyB;QACrC,IAAM,YAAY,GAAG,OAAO,CAC1B,8CAA8C,CAC/C,CAAC;QAEF,IAAI,YAAY,KAAK,IAAI,EAAE;YACzB,IAAI,CAAC,UAAU;iBACZ,aAAa,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;iBAC3B,SAAS,CACR,cAAM,YAAK,CAAC,6BAA6B,CAAC,EAApC,CAAoC,EAC1C,UAAC,KAAwB;gBACvB,YAAK,CAAC,4DAA4D,CAAC;YAAnE,CAAmE,CACtE,CAAC;SACL;IACH,CAAC;IA1DU,qBAAqB;QANjC,+DAAS,CAAC;YACT,QAAQ,EAAE,sBAAsB;YAChC,6IAA6C;YAE7C,aAAa,EAAE,+DAAiB,CAAC,IAAI;;SACtC,CAAC;+EAuCgC,wEAAkB;OAtCvC,qBAAqB,CA2DjC;IAAD,4BAAC;CAAA;AA3DiC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZO;AACM;AAEmB;AACqC;AACA;AACtC;AACe;AACA;AACpB;AACI;AACE;AACqB;AACf;AACR;AAoBhE;IAAA;IAA6B,CAAC;IAAjB,cAAc;QAlB1B,8DAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,mHAA4B;gBAC5B,mHAA4B;gBAC5B,4FAAqB;gBACrB,4FAAqB;aACtB;YACD,OAAO,EAAE;gBACP,8EAAc;gBACd,4DAAY;gBACZ,gFAAkB;gBAClB,8EAAqB;gBACrB,qGAA6B;gBAC7B,8EAAqB;gBACrB,8EAAS;aACV;YACD,SAAS,EAAE,CAAC,wEAAkB,EAAE,sFAAc,CAAC;SAChD,CAAC;OACW,cAAc,CAAG;IAAD,qBAAC;CAAA;AAAH","file":"articles-articles-module.js","sourcesContent":["/**\n * index\n */\nexport * from './src/index';\n//# sourceMappingURL=index.js.map","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { DocumentEditorContainerModule } from './documenteditorcontainer.module';\nimport { Toolbar } from '@syncfusion/ej2-documenteditor';\nexport var ToolbarService = { provide: 'DocumentEditorToolbar', useValue: Toolbar };\n/**\n * NgModule definition for the DocumentEditorContainer component with providers.\n */\nvar DocumentEditorContainerAllModule = /** @class */ (function () {\n    function DocumentEditorContainerAllModule() {\n    }\n    DocumentEditorContainerAllModule.decorators = [\n        { type: NgModule, args: [{\n                    imports: [CommonModule, DocumentEditorContainerModule],\n                    exports: [\n                        DocumentEditorContainerModule\n                    ],\n                    providers: [\n                        ToolbarService\n                    ]\n                },] },\n    ];\n    /** @nocollapse */\n    DocumentEditorContainerAllModule.ctorParameters = function () { return []; };\n    return DocumentEditorContainerAllModule;\n}());\nexport { DocumentEditorContainerAllModule };\n//# sourceMappingURL=documenteditorcontainer-all.module.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Component, ElementRef, ViewContainerRef, ChangeDetectionStrategy, Renderer2, Injector } from '@angular/core';\nimport { ComponentBase, ComponentMixins, setValue } from '@syncfusion/ej2-angular-base';\nimport { DocumentEditorContainer } from '@syncfusion/ej2-documenteditor';\nexport var inputs = ['enableLocalPaste', 'enablePersistence', 'enableRtl', 'enableToolbar', 'locale', 'restrictEditing', 'serviceUrl', 'showPropertiesPane'];\nexport var outputs = ['created', 'destroyed'];\nexport var twoWays = [];\n/**\n * `ejs-documenteditor-container` represents the Angular Document Editor Container.\n * ```html\n * <ejs-documenteditor-container></ejs-documenteditor-container>\n * ```\n */\nvar DocumentEditorContainerComponent = /** @class */ (function (_super) {\n    __extends(DocumentEditorContainerComponent, _super);\n    function DocumentEditorContainerComponent(ngEle, srenderer, viewContainerRef, injector) {\n        var _this = _super.call(this) || this;\n        _this.ngEle = ngEle;\n        _this.srenderer = srenderer;\n        _this.viewContainerRef = viewContainerRef;\n        _this.injector = injector;\n        _this.element = _this.ngEle.nativeElement;\n        _this.injectedModules = _this.injectedModules || [];\n        try {\n            var mod = _this.injector.get('DocumentEditorToolbar');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_a) { }\n        _this.registerEvents(outputs);\n        _this.addTwoWay.call(_this, twoWays);\n        setValue('currentInstance', _this, _this.viewContainerRef);\n        return _this;\n    }\n    DocumentEditorContainerComponent.prototype.ngOnInit = function () {\n    };\n    DocumentEditorContainerComponent.prototype.ngAfterViewInit = function () {\n    };\n    DocumentEditorContainerComponent.prototype.ngOnDestroy = function () {\n    };\n    DocumentEditorContainerComponent.prototype.ngAfterContentChecked = function () {\n    };\n    DocumentEditorContainerComponent.decorators = [\n        { type: Component, args: [{\n                    selector: 'ejs-documenteditorcontainer',\n                    inputs: inputs,\n                    outputs: outputs,\n                    template: '',\n                    changeDetection: ChangeDetectionStrategy.OnPush,\n                    queries: {}\n                },] },\n    ];\n    /** @nocollapse */\n    DocumentEditorContainerComponent.ctorParameters = function () { return [\n        { type: ElementRef, },\n        { type: Renderer2, },\n        { type: ViewContainerRef, },\n        { type: Injector, },\n    ]; };\n    DocumentEditorContainerComponent = __decorate([\n        ComponentMixins([ComponentBase]),\n        __metadata(\"design:paramtypes\", [ElementRef, Renderer2, ViewContainerRef, Injector])\n    ], DocumentEditorContainerComponent);\n    return DocumentEditorContainerComponent;\n}(DocumentEditorContainer));\nexport { DocumentEditorContainerComponent };\n//# sourceMappingURL=documenteditorcontainer.component.js.map","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { DocumentEditorContainerComponent } from './documenteditorcontainer.component';\n/**\n * NgModule definition for the DocumentEditorContainer component.\n */\nvar DocumentEditorContainerModule = /** @class */ (function () {\n    function DocumentEditorContainerModule() {\n    }\n    DocumentEditorContainerModule.decorators = [\n        { type: NgModule, args: [{\n                    imports: [CommonModule],\n                    declarations: [\n                        DocumentEditorContainerComponent\n                    ],\n                    exports: [\n                        DocumentEditorContainerComponent\n                    ]\n                },] },\n    ];\n    /** @nocollapse */\n    DocumentEditorContainerModule.ctorParameters = function () { return []; };\n    return DocumentEditorContainerModule;\n}());\nexport { DocumentEditorContainerModule };\n//# sourceMappingURL=documenteditorcontainer.module.js.map","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { DocumentEditorModule } from './documenteditor.module';\nimport { Print, SfdtExport, WordExport, TextExport, Selection, Search, Editor, EditorHistory, OptionsPane, ContextMenu, ImageResizer, HyperlinkDialog, TableDialog, BookmarkDialog, TableOfContentsDialog, PageSetupDialog, ParagraphDialog, ListDialog, StyleDialog, StylesDialog, BulletsAndNumberingDialog, FontDialog, TablePropertiesDialog, BordersAndShadingDialog, TableOptionsDialog, CellOptionsDialog } from '@syncfusion/ej2-documenteditor';\nexport var PrintService = { provide: 'DocumentEditorPrint', useValue: Print };\nexport var SfdtExportService = { provide: 'DocumentEditorSfdtExport', useValue: SfdtExport };\nexport var WordExportService = { provide: 'DocumentEditorWordExport', useValue: WordExport };\nexport var TextExportService = { provide: 'DocumentEditorTextExport', useValue: TextExport };\nexport var SelectionService = { provide: 'DocumentEditorSelection', useValue: Selection };\nexport var SearchService = { provide: 'DocumentEditorSearch', useValue: Search };\nexport var EditorService = { provide: 'DocumentEditorEditor', useValue: Editor };\nexport var EditorHistoryService = { provide: 'DocumentEditorEditorHistory', useValue: EditorHistory };\nexport var OptionsPaneService = { provide: 'DocumentEditorOptionsPane', useValue: OptionsPane };\nexport var ContextMenuService = { provide: 'DocumentEditorContextMenu', useValue: ContextMenu };\nexport var ImageResizerService = { provide: 'DocumentEditorImageResizer', useValue: ImageResizer };\nexport var HyperlinkDialogService = { provide: 'DocumentEditorHyperlinkDialog', useValue: HyperlinkDialog };\nexport var TableDialogService = { provide: 'DocumentEditorTableDialog', useValue: TableDialog };\nexport var BookmarkDialogService = { provide: 'DocumentEditorBookmarkDialog', useValue: BookmarkDialog };\nexport var TableOfContentsDialogService = { provide: 'DocumentEditorTableOfContentsDialog', useValue: TableOfContentsDialog };\nexport var PageSetupDialogService = { provide: 'DocumentEditorPageSetupDialog', useValue: PageSetupDialog };\nexport var ParagraphDialogService = { provide: 'DocumentEditorParagraphDialog', useValue: ParagraphDialog };\nexport var ListDialogService = { provide: 'DocumentEditorListDialog', useValue: ListDialog };\nexport var StyleDialogService = { provide: 'DocumentEditorStyleDialog', useValue: StyleDialog };\nexport var StylesDialogService = { provide: 'DocumentEditorStylesDialog', useValue: StylesDialog };\nexport var BulletsAndNumberingDialogService = { provide: 'DocumentEditorBulletsAndNumberingDialog', useValue: BulletsAndNumberingDialog };\nexport var FontDialogService = { provide: 'DocumentEditorFontDialog', useValue: FontDialog };\nexport var TablePropertiesDialogService = { provide: 'DocumentEditorTablePropertiesDialog', useValue: TablePropertiesDialog };\nexport var BordersAndShadingDialogService = { provide: 'DocumentEditorBordersAndShadingDialog', useValue: BordersAndShadingDialog };\nexport var TableOptionsDialogService = { provide: 'DocumentEditorTableOptionsDialog', useValue: TableOptionsDialog };\nexport var CellOptionsDialogService = { provide: 'DocumentEditorCellOptionsDialog', useValue: CellOptionsDialog };\n/**\n * NgModule definition for the DocumentEditor component with providers.\n */\nvar DocumentEditorAllModule = /** @class */ (function () {\n    function DocumentEditorAllModule() {\n    }\n    DocumentEditorAllModule.decorators = [\n        { type: NgModule, args: [{\n                    imports: [CommonModule, DocumentEditorModule],\n                    exports: [\n                        DocumentEditorModule\n                    ],\n                    providers: [\n                        PrintService,\n                        SfdtExportService,\n                        WordExportService,\n                        TextExportService,\n                        SelectionService,\n                        SearchService,\n                        EditorService,\n                        EditorHistoryService,\n                        OptionsPaneService,\n                        ContextMenuService,\n                        ImageResizerService,\n                        HyperlinkDialogService,\n                        TableDialogService,\n                        BookmarkDialogService,\n                        TableOfContentsDialogService,\n                        PageSetupDialogService,\n                        ParagraphDialogService,\n                        ListDialogService,\n                        StyleDialogService,\n                        StylesDialogService,\n                        BulletsAndNumberingDialogService,\n                        FontDialogService,\n                        TablePropertiesDialogService,\n                        BordersAndShadingDialogService,\n                        TableOptionsDialogService,\n                        CellOptionsDialogService\n                    ]\n                },] },\n    ];\n    /** @nocollapse */\n    DocumentEditorAllModule.ctorParameters = function () { return []; };\n    return DocumentEditorAllModule;\n}());\nexport { DocumentEditorAllModule };\n//# sourceMappingURL=documenteditor-all.module.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Component, ElementRef, ViewContainerRef, ChangeDetectionStrategy, Renderer2, Injector } from '@angular/core';\nimport { ComponentBase, ComponentMixins, setValue } from '@syncfusion/ej2-angular-base';\nimport { DocumentEditor } from '@syncfusion/ej2-documenteditor';\nexport var inputs = ['enableBookmarkDialog', 'enableBordersAndShadingDialog', 'enableContextMenu', 'enableEditor', 'enableEditorHistory', 'enableFontDialog', 'enableHyperlinkDialog', 'enableImageResizer', 'enableListDialog', 'enableOptionsPane', 'enablePageSetupDialog', 'enableParagraphDialog', 'enablePersistence', 'enablePrint', 'enableRtl', 'enableSearch', 'enableSelection', 'enableSfdtExport', 'enableStyleDialog', 'enableTableDialog', 'enableTableOfContentsDialog', 'enableTableOptionsDialog', 'enableTablePropertiesDialog', 'enableTextExport', 'enableWordExport', 'isReadOnly', 'locale', 'zoomFactor'];\nexport var outputs = ['contentChange', 'created', 'destroyed', 'documentChange', 'keyDown', 'requestNavigate', 'searchResultsChange', 'selectionChange', 'viewChange', 'zoomFactorChange'];\nexport var twoWays = [];\n/**\n * `ejs-documenteditor` represents the Angular Document Editor Component.\n * ```html\n * <ejs-documenteditor isReadOnly='true' enableSelection='true'></ejs-documenteditor>\n * ```\n */\nvar DocumentEditorComponent = /** @class */ (function (_super) {\n    __extends(DocumentEditorComponent, _super);\n    function DocumentEditorComponent(ngEle, srenderer, viewContainerRef, injector) {\n        var _this = _super.call(this) || this;\n        _this.ngEle = ngEle;\n        _this.srenderer = srenderer;\n        _this.viewContainerRef = viewContainerRef;\n        _this.injector = injector;\n        _this.element = _this.ngEle.nativeElement;\n        _this.injectedModules = _this.injectedModules || [];\n        try {\n            var mod = _this.injector.get('DocumentEditorPrint');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_a) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorSfdtExport');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_b) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorWordExport');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_c) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorTextExport');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_d) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorSelection');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_e) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorSearch');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_f) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorEditor');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_g) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorEditorHistory');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_h) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorOptionsPane');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_j) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorContextMenu');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_k) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorImageResizer');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_l) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorHyperlinkDialog');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_m) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorTableDialog');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_o) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorBookmarkDialog');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_p) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorTableOfContentsDialog');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_q) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorPageSetupDialog');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_r) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorParagraphDialog');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_s) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorListDialog');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_t) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorStyleDialog');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_u) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorStylesDialog');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_v) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorBulletsAndNumberingDialog');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_w) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorFontDialog');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_x) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorTablePropertiesDialog');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_y) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorBordersAndShadingDialog');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_z) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorTableOptionsDialog');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_0) { }\n        try {\n            var mod = _this.injector.get('DocumentEditorCellOptionsDialog');\n            if (_this.injectedModules.indexOf(mod) === -1) {\n                _this.injectedModules.push(mod);\n            }\n        }\n        catch (_1) { }\n        _this.registerEvents(outputs);\n        _this.addTwoWay.call(_this, twoWays);\n        setValue('currentInstance', _this, _this.viewContainerRef);\n        return _this;\n    }\n    DocumentEditorComponent.prototype.ngOnInit = function () {\n    };\n    DocumentEditorComponent.prototype.ngAfterViewInit = function () {\n    };\n    DocumentEditorComponent.prototype.ngOnDestroy = function () {\n    };\n    DocumentEditorComponent.prototype.ngAfterContentChecked = function () {\n    };\n    DocumentEditorComponent.decorators = [\n        { type: Component, args: [{\n                    selector: 'ejs-documenteditor',\n                    inputs: inputs,\n                    outputs: outputs,\n                    template: '',\n                    changeDetection: ChangeDetectionStrategy.OnPush,\n                    queries: {}\n                },] },\n    ];\n    /** @nocollapse */\n    DocumentEditorComponent.ctorParameters = function () { return [\n        { type: ElementRef, },\n        { type: Renderer2, },\n        { type: ViewContainerRef, },\n        { type: Injector, },\n    ]; };\n    DocumentEditorComponent = __decorate([\n        ComponentMixins([ComponentBase]),\n        __metadata(\"design:paramtypes\", [ElementRef, Renderer2, ViewContainerRef, Injector])\n    ], DocumentEditorComponent);\n    return DocumentEditorComponent;\n}(DocumentEditor));\nexport { DocumentEditorComponent };\n//# sourceMappingURL=documenteditor.component.js.map","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { DocumentEditorComponent } from './documenteditor.component';\n/**\n * NgModule definition for the DocumentEditor component.\n */\nvar DocumentEditorModule = /** @class */ (function () {\n    function DocumentEditorModule() {\n    }\n    DocumentEditorModule.decorators = [\n        { type: NgModule, args: [{\n                    imports: [CommonModule],\n                    declarations: [\n                        DocumentEditorComponent\n                    ],\n                    exports: [\n                        DocumentEditorComponent\n                    ]\n                },] },\n    ];\n    /** @nocollapse */\n    DocumentEditorModule.ctorParameters = function () { return []; };\n    return DocumentEditorModule;\n}());\nexport { DocumentEditorModule };\n//# sourceMappingURL=documenteditor.module.js.map","export { DocumentEditorComponent } from './document-editor/documenteditor.component';\nexport { DocumentEditorModule } from './document-editor/documenteditor.module';\nexport { DocumentEditorAllModule, PrintService, SfdtExportService, WordExportService, TextExportService, SelectionService, SearchService, EditorService, EditorHistoryService, OptionsPaneService, ContextMenuService, ImageResizerService, HyperlinkDialogService, TableDialogService, BookmarkDialogService, TableOfContentsDialogService, PageSetupDialogService, ParagraphDialogService, ListDialogService, StyleDialogService, StylesDialogService, BulletsAndNumberingDialogService, FontDialogService, TablePropertiesDialogService, BordersAndShadingDialogService, TableOptionsDialogService, CellOptionsDialogService } from './document-editor/documenteditor-all.module';\nexport { DocumentEditorContainerComponent } from './document-editor-container/documenteditorcontainer.component';\nexport { DocumentEditorContainerModule } from './document-editor-container/documenteditorcontainer.module';\nexport { DocumentEditorContainerAllModule, ToolbarService } from './document-editor-container/documenteditorcontainer-all.module';\nexport * from '@syncfusion/ej2-documenteditor';\n//# sourceMappingURL=index.js.map","/**\n * index\n */\nexport * from './src/index';\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n// tslint:disable-next-line:max-line-length\nimport { Component, Property, NotifyPropertyChanges, L10n } from '@syncfusion/ej2-base';\nimport { Event } from '@syncfusion/ej2-base';\nimport { DocumentEditor } from '../document-editor/document-editor';\nimport { TextProperties } from './properties-pane/text-properties-pane';\nimport { HeaderFooterProperties } from './properties-pane/header-footer-pane';\nimport { ImageProperties } from './properties-pane/image-properties-pane';\nimport { TocProperties } from './properties-pane/table-of-content-pane';\nimport { TableProperties } from './properties-pane/table-properties-pane';\nimport { StatusBar } from './properties-pane/status-bar';\nimport { createSpinner } from '@syncfusion/ej2-popups';\n/**\n * Document Editor container component.\n */\nvar DocumentEditorContainer = /** @class */ (function (_super) {\n    __extends(DocumentEditorContainer, _super);\n    /**\n     * Initialize the constructor of DocumentEditorContainer\n     */\n    function DocumentEditorContainer(options, element) {\n        var _this = _super.call(this, options, element) || this;\n        /**\n         * default locale\n         * @private\n         */\n        _this.defaultLocale = {\n            'New': 'New',\n            'Open': 'Open',\n            'Undo': 'Undo',\n            'Redo': 'Redo',\n            'Image': 'Image',\n            'Table': 'Table',\n            'Link': 'Link',\n            'Bookmark': 'Bookmark',\n            'Table of Contents': 'Table of Contents',\n            'HEADING - - - - 1': 'HEADING - - - - 1',\n            'HEADING - - - - 2': 'HEADING - - - - 2',\n            'HEADING - - - - 3': 'HEADING - - - - 3',\n            'Header': 'Header',\n            'Footer': 'Footer',\n            'Page Setup': 'Page Setup',\n            'Page Number': 'Page Number',\n            'Break': 'Break',\n            'Find': 'Find',\n            'Local Clipboard': 'Local Clipboard',\n            'Restrict Editing': 'Restrict Editing',\n            'Upload from computer': 'Upload from computer',\n            'By URL': 'By URL',\n            'Page Break': 'Page Break',\n            'Section Break': 'Section Break',\n            'Header & Footer': 'Header & Footer',\n            'Options': 'Options',\n            'Levels': 'Levels',\n            'Different First Page': 'Different First Page',\n            'Different header and footer for odd and even pages.': 'Different header and footer for odd and even pages.',\n            'Different Odd & Even Pages': 'Different Odd & Even Pages',\n            'Different header and footer for first page.': 'Different header and footer for first page.',\n            'Position': 'Position',\n            'Header from Top': 'Header from Top',\n            'Footer from Bottom': 'Footer from Bottom',\n            'Distance from top of the page to top of the header.': 'Distance from top of the page to top of the header.',\n            'Distance from bottom of the page to bottom of the footer.': 'Distance from bottom of the page to bottom of the footer.',\n            'Aspect ratio': 'Aspect ratio',\n            'W': 'W',\n            'H': 'H',\n            'Width': 'Width',\n            'Height': 'Height',\n            'Text': 'Text',\n            'Paragraph': 'Paragraph',\n            'Fill': 'Fill',\n            'Fill color': 'Fill color',\n            'Border Style': 'Border Style',\n            'Outside borders': 'Outside borders',\n            'All borders': 'All borders',\n            'Inside borders': 'Inside borders',\n            'Left border': 'Left border',\n            'Inside vertical border': 'Inside vertical border',\n            'Right border': 'Right border',\n            'Top border': 'Top border',\n            'Inside horizontal border': 'Inside horizontal border',\n            'Bottom border': 'Bottom border',\n            'Border color': 'Border color',\n            'Border width': 'Border width',\n            'Cell': 'Cell',\n            'Merge cells': 'Merge cells',\n            'Insert / Delete': 'Insert / Delete',\n            'Insert columns to the left': 'Insert columns to the left',\n            'Insert columns to the right': 'Insert columns to the right',\n            'Insert rows above': 'Insert rows above',\n            'Insert rows below': 'Insert rows below',\n            'Delete rows': 'Delete rows',\n            'Delete columns': 'Delete columns',\n            'Cell Margin': 'Cell Margin',\n            'Top': 'Top',\n            'Bottom': 'Bottom',\n            'Left': 'Left',\n            'Right': 'Right',\n            'Align Text': 'Align Text',\n            'Align top': 'Align top',\n            'Align bottom': 'Align bottom',\n            'Align center': 'Align center',\n            // tslint:disable-next-line:max-line-length\n            'Number of heading or outline levels to be shown in table of contents.': 'Number of heading or outline levels to be shown in table of contents.',\n            'Show page numbers': 'Show page numbers',\n            'Show page numbers in table of contents.': 'Show page numbers in table of contents.',\n            'Right align page numbers': 'Right align page numbers',\n            'Right align page numbers in table of contents.': 'Right align page numbers in table of contents.',\n            'Use hyperlinks': 'Use hyperlinks',\n            'Use hyperlinks instead of page numbers.': 'Use hyperlinks instead of page numbers.',\n            'Font': 'Font',\n            'Font Size': 'Font Size',\n            'Font color': 'Font color',\n            'Text highlight color': 'Text highlight color',\n            'Clear all formatting': 'Clear all formatting',\n            'Bold (Ctrl+B)': 'Bold (Ctrl+B)',\n            'Italic (Ctrl+I)': 'Italic (Ctrl+I)',\n            'Underline (Ctrl+U)': 'Underline (Ctrl+U)',\n            'Strikethrough': 'Strikethrough',\n            'Superscript (Ctrl+Shift++)': 'Superscript (Ctrl+Shift++)',\n            'Subscript (Ctrl+=)': 'Subscript (Ctrl+=)',\n            'Align left (Ctrl+L)': 'Align left (Ctrl+L)',\n            'Center (Ctrl+E)': 'Center (Ctrl+E)',\n            'Align right (Ctrl+R)': 'Align right (Ctrl+R)',\n            'Justify (Ctrl+J)': 'Justify (Ctrl+J)',\n            'Decrease indent': 'Decrease indent',\n            'Increase indent': 'Increase indent',\n            'Line spacing': 'Line spacing',\n            'Bullets': 'Bullets',\n            'Numbering': 'Numbering',\n            'Styles': 'Styles',\n            'Manage Styles': 'Manage Styles',\n            'Page': 'Page',\n            'of': 'of',\n            'Fit one page': 'Fit one page',\n            'Fit page width': 'Fit page width',\n            'Update': 'Update',\n            'Cancel': 'Cancel',\n            'Insert': 'Insert',\n            'No Border': 'No Border',\n            'Create a new document.': 'Create a new document.',\n            'Open a document.': 'Open a document.',\n            'Undo the last operation (Ctrl+Z).': 'Undo the last operation (Ctrl+Z).',\n            'Redo the last operation (Ctrl+Y).': 'Redo the last operation (Ctrl+Y).',\n            'Insert inline picture from a file.': 'Insert inline picture from a file.',\n            'Insert a table into the document': 'Insert a table into the document',\n            // tslint:disable-next-line:max-line-length\n            'Create a link in your document for quick access to web pages and files (Ctrl+K).': 'Create a link in your document for quick access to web pages and files (Ctrl+K).',\n            'Insert a bookmark in a specific place in this document.': 'Insert a bookmark in a specific place in this document.',\n            // tslint:disable-next-line:max-line-length\n            'Provide an overview of your document by adding a table of contents.': 'Provide an overview of your document by adding a table of contents.',\n            'Add or edit the header.': 'Add or edit the header.',\n            'Add or edit the footer.': 'Add or edit the footer.',\n            'Open the page setup dialog.': 'Open the page setup dialog.',\n            'Add page numbers.': 'Add page numbers.',\n            'Find text in the document (Ctrl+F).': 'Find text in the document (Ctrl+F).',\n            'Toggle between the internal clipboard and system clipboard': 'Toggle between the internal clipboard and system clipboard.</br>' +\n                'Access to system clipboard through script is denied due to browsers security policy. Instead, </br>' +\n                ' 1. You can enable internal clipboard to cut, copy and paste within the component.</br>' +\n                ' 2. You can use the keyboard shortcuts (Ctrl+X, Ctrl+C and Ctrl+V) to cut, copy and paste with system clipboard.',\n            'Restrict editing.': 'Restrict editing.',\n            // tslint:disable-next-line:max-line-length\n            'The current page number in the document. Click or tap to navigate specific page.': 'The current page number in the document. Click or tap to navigate specific page.'\n        };\n        return _this;\n    }\n    /**\n     * @private\n     */\n    DocumentEditorContainer.prototype.getModuleName = function () {\n        return 'DocumentEditorContainer';\n    };\n    /**\n     * @private\n     */\n    DocumentEditorContainer.prototype.onPropertyChanged = function (newModel, oldModel) {\n        for (var _i = 0, _a = Object.keys(newModel); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'restrictEditing':\n                    if (this.toolbarModule) {\n                        this.toolbarModule.enableDisableToolBarItem(!newModel.restrictEditing);\n                    }\n                    this.documentEditor.isReadOnly = newModel.restrictEditing;\n                    break;\n                case 'showPropertiesPane':\n                    this.showHidePropertiesPane(newModel.showPropertiesPane);\n                    break;\n                case 'enableLocalPaste':\n                    if (this.documentEditor) {\n                        this.documentEditor.enableLocalPaste = newModel.enableLocalPaste;\n                    }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    DocumentEditorContainer.prototype.preRender = function () {\n        this.localObj = new L10n('documenteditorcontainer', this.defaultLocale, this.locale);\n        this.initContainerElement();\n        //Prototype\n    };\n    /**\n     * @private\n     */\n    DocumentEditorContainer.prototype.render = function () {\n        this.initializeDocumentEditor();\n        this.textProperties = new TextProperties(this, this.element.id, false, this.enableRtl);\n        this.headerFooterProperties = new HeaderFooterProperties(this, this.enableRtl);\n        this.imageProperties = new ImageProperties(this, this.enableRtl);\n        this.tocProperties = new TocProperties(this, this.enableRtl);\n        this.tableProperties = new TableProperties(this, this.imageProperties, this.textProperties, this.enableRtl);\n        this.statusBar = new StatusBar(this.statusBarElement, this);\n        // Waiting popup\n        createSpinner({ target: this.containerTarget, cssClass: 'e-spin-overlay' });\n    };\n    /**\n     * @private\n     */\n    DocumentEditorContainer.prototype.getPersistData = function () {\n        return 'documenteditor-container';\n    };\n    //tslint:disable: max-func-body-length\n    DocumentEditorContainer.prototype.requiredModules = function () {\n        var modules = [];\n        if (this.enableToolbar) {\n            modules.push({\n                member: 'toolbar', args: [this]\n            });\n        }\n        return modules;\n    };\n    DocumentEditorContainer.prototype.initContainerElement = function () {\n        // Toolbar container\n        var isRtl = this.enableRtl;\n        this.containerTarget = this.createElement('div', { className: 'e-de-ctn' });\n        this.toolbarContainer = this.createElement('div', { className: 'e-de-ctnr-toolbar' + (isRtl ? ' e-de-ctnr-rtl' : '') });\n        this.containerTarget.appendChild(this.toolbarContainer);\n        // Editor and properties pane implementation\n        this.editorContainer = this.createElement('div', { className: 'e-de-ctnr-properties-pane' + (isRtl ? ' e-de-ctnr-rtl' : '') });\n        var propertiesPaneContainerBorder;\n        if (!isRtl) {\n            propertiesPaneContainerBorder = 'e-de-pane';\n        }\n        else {\n            propertiesPaneContainerBorder = 'e-de-pane-rtl';\n        }\n        this.propertiesPaneContainer = this.createElement('div', { className: propertiesPaneContainerBorder, styles: 'display:none' });\n        this.editorContainer.appendChild(this.propertiesPaneContainer);\n        this.containerTarget.appendChild(this.editorContainer);\n        this.statusBarElement = this.createElement('div', { className: 'e-de-status-bar' });\n        if (isRtl) {\n            this.statusBarElement.style.direction = 'rtl';\n        }\n        this.containerTarget.appendChild(this.statusBarElement);\n        this.element.appendChild(this.containerTarget);\n    };\n    DocumentEditorContainer.prototype.initializeDocumentEditor = function () {\n        var id = this.element.id + '_editor';\n        var documentEditorTarget = this.createElement('div', { id: id, styles: 'width:100%;height:100%' });\n        this.documentEditor = new DocumentEditor({\n            isReadOnly: false, enableRtl: this.enableRtl,\n            selectionChange: this.onSelectionChange.bind(this),\n            contentChange: this.onContentChange.bind(this),\n            documentChange: this.onDocumentChange.bind(this),\n            zoomFactorChange: this.onZoomFactorChange.bind(this),\n            requestNavigate: this.onRequestNavigate.bind(this),\n            viewChange: this.onViewChange.bind(this),\n            locale: this.locale\n        });\n        this.documentEditor.enableLocalPaste = this.enableLocalPaste;\n        this.documentEditor.enableAllModules();\n        this.documentEditor.pageOutline = '#E0E0E0';\n        this.editorContainer.insertBefore(documentEditorTarget, this.editorContainer.firstChild);\n        this.documentEditor.appendTo(documentEditorTarget);\n        this.documentEditor.resize();\n    };\n    /**\n     * @private\n     */\n    DocumentEditorContainer.prototype.showHidePropertiesPane = function (show) {\n        this.propertiesPaneContainer.style.display = show ? 'block' : 'none';\n        if (this.toolbarModule) {\n            this.toolbarModule.showPropertiesPane = show;\n            this.toolbarModule.propertiesPaneButton.element.style.opacity = show ? '1' : '0.5';\n        }\n        this.documentEditor.resize();\n    };\n    /**\n     * @private\n     */\n    DocumentEditorContainer.prototype.onContentChange = function () {\n        if (this.toolbarModule) {\n            this.toolbarModule.enableDisableUndoRedo();\n        }\n        if (this.statusBar) {\n            this.statusBar.updatePageCount();\n        }\n    };\n    /**\n     * @private\n     */\n    DocumentEditorContainer.prototype.onDocumentChange = function () {\n        if (this.toolbarModule) {\n            this.toolbarModule.enableDisableUndoRedo();\n        }\n        if (this.textProperties) {\n            this.textProperties.updateStyles();\n        }\n        if (this.statusBar) {\n            this.statusBar.updatePageCount();\n        }\n    };\n    /**\n     * @private\n     */\n    DocumentEditorContainer.prototype.onSelectionChange = function () {\n        var _this = this;\n        setTimeout(function () {\n            if (_this.toolbarContainer) {\n                _this.toolbarModule.showPropertiesPaneOnSelection();\n            }\n        });\n    };\n    /**\n     * @private\n     */\n    DocumentEditorContainer.prototype.onZoomFactorChange = function () {\n        if (this.statusBar) {\n            this.statusBar.updateZoomContent();\n        }\n    };\n    /**\n     * @private\n     */\n    DocumentEditorContainer.prototype.onRequestNavigate = function (args) {\n        if (args.linkType !== 'Bookmark') {\n            var link = args.navigationLink;\n            if (args.localReference.length > 0) {\n                link += '#' + args.localReference;\n            }\n            window.open(link);\n            args.isHandled = true;\n        }\n    };\n    /**\n     * @private\n     */\n    DocumentEditorContainer.prototype.onViewChange = function (args) {\n        if (this.statusBar) {\n            this.statusBar.updatePageNumberOnViewChange(args);\n        }\n    };\n    /**\n     * Destroys all managed resources used by this object.\n     */\n    DocumentEditorContainer.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        if (this.toolbarContainer && this.toolbarContainer.parentElement) {\n            this.toolbarContainer.innerHTML = '';\n            this.toolbarContainer.parentElement.removeChild(this.toolbarContainer);\n        }\n        this.toolbarContainer = undefined;\n        if (this.documentEditor) {\n            this.documentEditor.destroy();\n        }\n        this.documentEditor = undefined;\n        if (this.propertiesPaneContainer && this.editorContainer.parentElement) {\n            this.propertiesPaneContainer.innerHTML = '';\n            this.propertiesPaneContainer.parentElement.removeChild(this.propertiesPaneContainer);\n        }\n        this.propertiesPaneContainer = undefined;\n        if (this.editorContainer && this.editorContainer.parentElement) {\n            this.editorContainer.innerHTML = '';\n            this.editorContainer.parentElement.removeChild(this.editorContainer);\n        }\n        if (this.statusBarElement && this.statusBarElement.parentElement) {\n            this.statusBarElement.innerHTML = '';\n            this.statusBarElement.parentElement.removeChild(this.statusBarElement);\n        }\n        if (this.containerTarget && this.containerTarget.parentElement) {\n            this.containerTarget.innerHTML = '';\n            this.containerTarget.parentElement.removeChild(this.containerTarget);\n        }\n        this.containerTarget = undefined;\n        this.statusBarElement = undefined;\n        this.editorContainer = undefined;\n        if (this.textProperties) {\n            this.textProperties.destroy();\n        }\n        this.textProperties = undefined;\n        if (this.headerFooterProperties) {\n            this.headerFooterProperties.destroy();\n        }\n        this.headerFooterProperties = undefined;\n        if (this.imageProperties) {\n            this.imageProperties.destroy();\n        }\n        this.imageProperties = undefined;\n        if (this.tocProperties) {\n            this.tocProperties.destroy();\n        }\n        this.tocProperties = undefined;\n        if (this.tableProperties) {\n            this.tableProperties.destroy();\n        }\n        this.tableProperties = undefined;\n    };\n    __decorate([\n        Property(false)\n    ], DocumentEditorContainer.prototype, \"showPropertiesPane\", void 0);\n    __decorate([\n        Property(true)\n    ], DocumentEditorContainer.prototype, \"enableToolbar\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditorContainer.prototype, \"restrictEditing\", void 0);\n    __decorate([\n        Property(true)\n    ], DocumentEditorContainer.prototype, \"enableLocalPaste\", void 0);\n    __decorate([\n        Property()\n    ], DocumentEditorContainer.prototype, \"serviceUrl\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditorContainer.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditorContainer.prototype, \"destroyed\", void 0);\n    DocumentEditorContainer = __decorate([\n        NotifyPropertyChanges\n    ], DocumentEditorContainer);\n    return DocumentEditorContainer;\n}(Component));\nexport { DocumentEditorContainer };\n","/**\n * export document editor container\n */\nexport * from './tool-bar/index';\nexport * from './document-editor-container';\n","/**\n * Represents document editor header and footer.\n */\nimport { createElement, L10n, classList } from '@syncfusion/ej2-base';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\n/**\n * @private\n */\nvar HeaderFooterProperties = /** @class */ (function () {\n    function HeaderFooterProperties(container, isRtl) {\n        var _this = this;\n        this.isHeaderTopApply = false;\n        this.isFooterTopApply = false;\n        this.wireEvents = function () {\n            _this.headerFromTop.element.addEventListener('click', function () { _this.isHeaderTopApply = true; });\n            _this.footerFromTop.element.addEventListener('click', function () { _this.isFooterTopApply = true; });\n            _this.headerFromTop.element.addEventListener('keydown', _this.onHeaderValue);\n            _this.footerFromTop.element.addEventListener('keydown', _this.onFooterValue);\n            _this.headerFromTop.element.addEventListener('blur', function () { _this.changeHeaderValue(); _this.isHeaderTopApply = false; });\n            _this.footerFromTop.element.addEventListener('blur', function () { _this.changeFooterValue(); _this.isFooterTopApply = false; });\n        };\n        this.onClose = function () {\n            _this.toolbar.showHeaderProperties = true;\n            _this.documentEditor.selection.closeHeaderFooter();\n        };\n        this.changeFirstPageOptions = function () {\n            if (!_this.documentEditor.isReadOnly) {\n                _this.documentEditor.selection.sectionFormat.differentFirstPage = _this.firstPage.checked;\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 10);\n            }\n        };\n        this.changeoddOrEvenOptions = function () {\n            if (!_this.documentEditor.isReadOnly) {\n                _this.documentEditor.selection.sectionFormat.differentOddAndEvenPages = _this.oddOrEven.checked;\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 10);\n            }\n        };\n        this.changeHeaderValue = function () {\n            if (!_this.isHeaderTopApply) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly) {\n                var headerTop = _this.headerFromTop.value;\n                if (headerTop > _this.headerFromTop.max) {\n                    headerTop = _this.headerFromTop.max;\n                }\n                _this.documentEditor.selection.sectionFormat.headerDistance = headerTop;\n            }\n        };\n        this.onHeaderValue = function (e) {\n            if (e.keyCode === 13) {\n                setTimeout(function () { _this.changeHeaderValue(); _this.isHeaderTopApply = false; }, 30);\n            }\n        };\n        this.onFooterValue = function (e) {\n            if (e.keyCode === 13) {\n                setTimeout(function () { _this.changeFooterValue(); _this.isFooterTopApply = false; }, 30);\n            }\n        };\n        this.changeFooterValue = function () {\n            if (!_this.isFooterTopApply) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly) {\n                var footerTop = _this.footerFromTop.value;\n                if (footerTop > _this.footerFromTop.max) {\n                    footerTop = _this.footerFromTop.max;\n                }\n                _this.documentEditor.selection.sectionFormat.footerDistance = footerTop;\n            }\n        };\n        this.container = container;\n        this.isRtl = isRtl;\n        this.initHeaderFooterPane();\n        this.wireEvents();\n    }\n    Object.defineProperty(HeaderFooterProperties.prototype, \"documentEditor\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.container.documentEditor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HeaderFooterProperties.prototype, \"toolbar\", {\n        get: function () {\n            return this.container.toolbarModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    HeaderFooterProperties.prototype.initHeaderFooterPane = function () {\n        this.initializeHeaderFooter();\n        this.element.style.display = 'none';\n        this.container.propertiesPaneContainer.appendChild(this.element);\n    };\n    HeaderFooterProperties.prototype.showHeaderFooterPane = function (isShow) {\n        if (isShow) {\n            this.toolbar.enableDisablePropertyPaneButton(false);\n            this.onSelectionChange();\n        }\n        if (!isShow && this.element.style.display === 'none' || (isShow && this.element.style.display === 'block')) {\n            return;\n        }\n        this.element.style.display = isShow ? 'block' : 'none';\n        this.documentEditor.resize();\n    };\n    // tslint:disable-next-line:max-func-body-length\n    HeaderFooterProperties.prototype.initializeHeaderFooter = function () {\n        var _this = this;\n        var localObj = new L10n('documenteditorcontainer', this.container.defaultLocale, this.container.locale);\n        var elementId = 'header_footer_properties';\n        // tslint:disable-next-line:max-line-length\n        this.element = createElement('div', { id: this.documentEditor.element.id + elementId, className: 'e-de-prop-pane' });\n        var headerDiv = this.createDivTemplate('_header_footer', this.element, 'padding-bottom:0');\n        classList(headerDiv, ['e-de-cntr-pane-padding'], []);\n        var headerLabel = createElement('label', { className: 'e-de-prop-header-label' });\n        headerLabel.innerHTML = localObj.getConstant('Header & Footer');\n        var closeButtonFloat;\n        var optionsLabelDivPadding;\n        var positionLabelDivPadding;\n        if (!this.isRtl) {\n            closeButtonFloat = 'float:right;';\n            optionsLabelDivPadding = 'padding-left: 14px';\n            positionLabelDivPadding = 'padding-left: 14px;';\n        }\n        else {\n            closeButtonFloat = 'float:left;';\n            optionsLabelDivPadding = 'padding-right: 14px';\n            positionLabelDivPadding = 'padding-right: 14px;';\n        }\n        var closeIcon = createElement('span', {\n            id: '_header_footer_close',\n            className: 'e-de-ctnr-close e-icons',\n            styles: 'display:inline-block;cursor:pointer;color: #4A4A4A;' + closeButtonFloat\n        });\n        closeIcon.addEventListener('click', function () { _this.onClose(); });\n        headerDiv.appendChild(headerLabel);\n        headerDiv.appendChild(closeIcon);\n        var optionsLabelDiv = this.createDivTemplate(elementId + '_options', this.element);\n        classList(optionsLabelDiv, ['e-de-cntr-pane-padding', 'e-de-prop-separator-line'], []);\n        var optionsLabel = createElement('label', { className: 'e-de-ctnr-prop-label', styles: 'height:20px;' });\n        optionsLabel.innerHTML = localObj.getConstant('Options');\n        optionsLabelDiv.appendChild(optionsLabel);\n        var optionsDiv = this.createDivTemplate(elementId + '_optionsDiv', optionsLabelDiv);\n        var firstPageDiv = this.createDivTemplate(elementId + '_firstPageDiv', optionsDiv, 'margin-bottom:3px;');\n        var firstPage = createElement('input', { id: 'firstPage', className: 'e-de-prop-sub-label' });\n        firstPageDiv.appendChild(firstPage);\n        // tslint:disable-next-line:max-line-length\n        this.firstPage = new CheckBox({ label: localObj.getConstant('Different First Page'), change: this.changeFirstPageOptions, cssClass: 'e-de-prop-sub-label', enableRtl: this.isRtl });\n        this.firstPage.appendTo(firstPage);\n        // tslint:disable-next-line:max-line-length\n        firstPageDiv.children[0].setAttribute('title', localObj.getConstant('Different header and footer for first page.'));\n        var oddOrEvenDiv = this.createDivTemplate(elementId + '_oddOrEvenDiv', optionsDiv);\n        var oddOrEven = createElement('input', { id: 'oddOrEven', className: 'e-de-sub-prop-label' });\n        oddOrEvenDiv.appendChild(oddOrEven);\n        // tslint:disable-next-line:max-line-length\n        this.oddOrEven = new CheckBox({ label: localObj.getConstant('Different Odd & Even Pages'), change: this.changeoddOrEvenOptions, cssClass: 'e-de-prop-sub-label', enableRtl: this.isRtl });\n        this.oddOrEven.appendTo(oddOrEven);\n        // tslint:disable-next-line:max-line-length\n        oddOrEvenDiv.children[0].setAttribute('title', localObj.getConstant('Different header and footer for odd and even pages.'));\n        // tslint:disable-next-line:max-line-length\n        // let autoFieldLabelDiv: HTMLElement = this.createDivTemplate(element + '_autoFieldLabelDiv', div, 'padding-top:10px;padding-left: 10px;');\n        // let autoFieldLabel: HTMLElement = createElement('label', { className: 'e-de-header-prop-label', styles: 'height:20px;' });\n        // autoFieldLabel.innerHTML = 'Insert Autofield';\n        // autoFieldLabelDiv.appendChild(autoFieldLabel);\n        // let autofieldDiv: HTMLElement = this.createDivTemplate(element + '_autofieldDiv', autoFieldLabelDiv, 'display:inline-flex;');\n        // let pageNumberDiv: HTMLElement = this.createDivTemplate(element + '_pageNumberDiv', autofieldDiv, 'margin-right:8px;');\n        // let pageNumber: HTMLInputElement = createElement('input', { id: 'pageNumber' }) as HTMLInputElement;\n        // pageNumberDiv.appendChild(pageNumber);\n        // this.pageNumber = new CheckBox({ label: 'Page Number', change: this.changePageNumber });\n        // this.pageNumber.appendTo(pageNumber);\n        // let pageCountDiv: HTMLElement = this.createDivTemplate(element + '_pageCountDiv', autofieldDiv);\n        // let pageCount: HTMLInputElement = createElement('input', { id: 'pageCount' }) as HTMLInputElement;\n        // pageCountDiv.appendChild(pageCount);\n        // this.pageCount = new CheckBox({ label: 'Page Count', change: this.changePageCount });\n        // this.pageCount.appendTo(pageCount);\n        // let autoFieldLine: HTMLElement = createElement('div', { className: 'e-de-prop-separator-line', styles: 'margin-top:7px;' });\n        // autoFieldLabelDiv.appendChild(autoFieldLine);\n        // tslint:disable-next-line:max-line-length\n        var positionLabelDiv = this.createDivTemplate(elementId + '_positionLabelDiv', this.element);\n        classList(positionLabelDiv, ['e-de-cntr-pane-padding', 'e-de-prop-separator-line'], []);\n        var positionLabel = createElement('label', { className: 'e-de-ctnr-prop-label', styles: 'height:20px;' });\n        positionLabel.innerHTML = localObj.getConstant('Position');\n        positionLabelDiv.appendChild(positionLabel);\n        var positionDiv = this.createDivTemplate(elementId + '_positionDiv', positionLabelDiv);\n        var width;\n        var headerFooterDivMargin;\n        if (!this.isRtl) {\n            width = 'width: 128px;';\n            headerFooterDivMargin = 'margin-right:8px;';\n        }\n        else {\n            width = 'width: 150px;';\n            headerFooterDivMargin = 'margin-left:8px;';\n        }\n        // tslint:disable-next-line:max-line-length\n        var headerTopDiv = this.createDivTemplate(elementId + '_headerTopDiv', positionDiv, 'margin-bottom:15px;');\n        // tslint:disable-next-line:max-line-length\n        var headerTopLabel = createElement('label', { className: 'e-de-prop-sub-label', styles: 'display:block' });\n        headerTopLabel.innerHTML = localObj.getConstant('Header from Top');\n        headerTopDiv.appendChild(headerTopLabel);\n        // tslint:disable-next-line:max-line-length\n        var headerFromTop = createElement('input', { id: 'headerFromTop', className: 'e-de-prop-sub-label' });\n        headerTopDiv.appendChild(headerFromTop);\n        // tslint:disable-next-line:max-line-length\n        this.headerFromTop = new NumericTextBox({\n            value: 36, cssClass: 'e-de-prop-header-numeric',\n            showSpinButton: false, format: 'n0', decimals: 2, max: 1584, min: 0, enableRtl: this.isRtl\n        });\n        this.headerFromTop.appendTo(headerFromTop);\n        // tslint:disable-next-line:max-line-length\n        this.headerFromTop.element.parentElement.setAttribute('title', localObj.getConstant('Distance from top of the page to top of the header.'));\n        // tslint:disable-next-line:max-line-length\n        var footerBottomDiv = this.createDivTemplate(elementId + '_footerBottomDiv', positionDiv);\n        // tslint:disable-next-line:max-line-length\n        var footerBottomLabel = createElement('label', { className: 'e-de-prop-sub-label', styles: 'display:block' });\n        footerBottomLabel.innerHTML = localObj.getConstant('Footer from Bottom');\n        footerBottomDiv.appendChild(footerBottomLabel);\n        // tslint:disable-next-line:max-line-length\n        var footerFromTop = createElement('input', { id: 'footerFromTop', className: 'e-de-prop-sub-label' });\n        footerBottomDiv.appendChild(footerFromTop);\n        // tslint:disable-next-line:max-line-length\n        this.footerFromTop = new NumericTextBox({\n            value: 36, cssClass: 'e-de-prop-header-numeric',\n            showSpinButton: false, format: 'n0', decimals: 2, max: 1584, min: 0, enableRtl: this.isRtl\n        });\n        this.footerFromTop.appendTo(footerFromTop);\n        // tslint:disable-next-line:max-line-length\n        this.footerFromTop.element.parentElement.setAttribute('title', localObj.getConstant('Distance from bottom of the page to bottom of the footer.'));\n    };\n    HeaderFooterProperties.prototype.createDivTemplate = function (id, parentDiv, style) {\n        var divElement;\n        if (style) {\n            divElement = createElement('div', { id: id, styles: style });\n        }\n        else {\n            divElement = createElement('div', { id: id });\n        }\n        parentDiv.appendChild(divElement);\n        return divElement;\n    };\n    HeaderFooterProperties.prototype.onSelectionChange = function () {\n        if (this.documentEditor.selection.sectionFormat.differentFirstPage) {\n            this.firstPage.checked = true;\n        }\n        else {\n            this.firstPage.checked = false;\n        }\n        if (this.documentEditor.selection.sectionFormat.differentOddAndEvenPages) {\n            this.oddOrEven.checked = true;\n        }\n        else {\n            this.oddOrEven.checked = false;\n        }\n    };\n    HeaderFooterProperties.prototype.destroy = function () {\n        if (this.headerFromTop) {\n            this.headerFromTop.destroy();\n            this.headerFromTop = undefined;\n        }\n        if (this.footerFromTop) {\n            this.footerFromTop.destroy();\n            this.footerFromTop = undefined;\n        }\n    };\n    return HeaderFooterProperties;\n}());\nexport { HeaderFooterProperties };\n","import { createElement, L10n } from '@syncfusion/ej2-base';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\n/**\n * Image Property pane\n * @private\n */\nvar ImageProperties = /** @class */ (function () {\n    function ImageProperties(container, isRtl) {\n        var _this = this;\n        this.isWidthApply = false;\n        this.isHeightApply = false;\n        this.initializeImageProperties = function () {\n            // tslint:disable-next-line:max-line-length\n            _this.element = createElement('div', { id: _this.elementId + '_imageProperties', className: 'e-de-prop-pane' });\n            _this.element.style.display = 'none';\n            _this.container.propertiesPaneContainer.appendChild(_this.element);\n            _this.initImageProp();\n            _this.wireEvents();\n        };\n        this.initImageProp = function () {\n            var localObj = new L10n('documenteditorcontainer', _this.container.defaultLocale, _this.container.locale);\n            // tslint:disable-next-line:max-line-length\n            var imageDiv = createElement('div', { id: _this.elementId + '_imageDiv', className: 'e-de-cntr-pane-padding', styles: 'border:0px' });\n            _this.element.appendChild(imageDiv);\n            var label = createElement('label', { className: 'e-de-ctnr-prop-label' });\n            label.textContent = localObj.getConstant('Image');\n            imageDiv.appendChild(label);\n            var outerDiv = createElement('div');\n            imageDiv.appendChild(outerDiv);\n            // tslint:disable-next-line:max-line-length\n            _this.widthElement = _this.createImagePropertiesDiv('_widthDiv', outerDiv, '_widthInput', localObj.getConstant('W'), localObj.getConstant('Width'));\n            // tslint:disable-next-line:max-line-length\n            _this.widthNumericBox = new NumericTextBox({ min: 0, max: 23500, cssClass: 'e-de-image-property', showSpinButton: false, format: 'n0', decimals: 2 });\n            _this.widthNumericBox.appendTo(_this.widthElement);\n            // tslint:disable-next-line:max-line-length\n            _this.heightElement = _this.createImagePropertiesDiv('_heightDiv', outerDiv, '_heightInput', localObj.getConstant('H'), localObj.getConstant('Height'));\n            // tslint:disable-next-line:max-line-length\n            _this.heightNumericBox = new NumericTextBox({ min: 0, max: 23500, cssClass: 'e-de-image-property', showSpinButton: false, format: 'n0', decimals: 2 });\n            _this.heightNumericBox.appendTo(_this.heightElement);\n            // tslint:disable-next-line:max-line-length        \n            var aspectRatioDiv = createElement('div', { id: _this.elementId + '_aspectRatioDiv' });\n            aspectRatioDiv.setAttribute('title', localObj.getConstant('Aspect ratio'));\n            outerDiv.appendChild(aspectRatioDiv);\n            // tslint:disable-next-line:max-line-length\n            var aspectRatio = createElement('input', { id: _this.elementId + '_aspectRatio', className: 'e-de-ctnr-prop-label' });\n            aspectRatioDiv.appendChild(aspectRatio);\n            _this.aspectRatioBtn = new CheckBox({ label: localObj.getConstant('Aspect ratio'), enableRtl: _this.isRtl }, aspectRatio);\n        };\n        // tslint:disable-next-line:max-line-length\n        this.createImagePropertiesDiv = function (id, outerDiv, inputId, spanContent, tooltip) {\n            // tslint:disable-next-line:max-line-length\n            var divElement = createElement('div', { id: _this.elementId + id, styles: 'position: relative;width: 100%;', className: 'e-de-ctnr-segment' });\n            divElement.setAttribute('title', tooltip);\n            outerDiv.appendChild(divElement);\n            // tslint:disable-next-line:max-line-length\n            var inputElement = createElement('input', { id: _this.elementId + inputId, className: 'e-textbox', styles: 'width:100%;' });\n            divElement.appendChild(inputElement);\n            var spanElement = createElement('span', { className: 'e-de-img-prty-span' });\n            spanElement.textContent = spanContent;\n            divElement.appendChild(spanElement);\n            return inputElement;\n        };\n        this.wireEvents = function () {\n            _this.aspectRatioBtn.element.addEventListener('change', _this.onAspectRatioBtnClick);\n            _this.widthNumericBox.element.addEventListener('click', function () { _this.isWidthApply = true; });\n            _this.heightNumericBox.element.addEventListener('click', function () { _this.isHeightApply = true; });\n            _this.widthNumericBox.element.addEventListener('keydown', _this.onImageWidth);\n            _this.heightNumericBox.element.addEventListener('keydown', _this.onImageHeight);\n            _this.widthNumericBox.element.addEventListener('blur', function () { _this.applyImageWidth(); _this.isWidthApply = false; });\n            _this.heightNumericBox.element.addEventListener('blur', function () { _this.applyImageHeight(); _this.isHeightApply = false; });\n        };\n        this.onImageWidth = function (e) {\n            if (e.keyCode === 13) {\n                setTimeout(function () { _this.applyImageWidth(); _this.isWidthApply = false; }, 30);\n            }\n        };\n        this.onImageHeight = function (e) {\n            if (e.keyCode === 13) {\n                setTimeout(function () { _this.applyImageHeight(); _this.isHeightApply = false; }, 30);\n            }\n        };\n        this.applyImageWidth = function () {\n            if (!_this.isMaintainAspectRatio) {\n                // tslint:disable-next-line:max-line-length\n                var width = _this.widthNumericBox.value;\n                var height = _this.heightNumericBox.value;\n                if (width > _this.widthNumericBox.max) {\n                    width = _this.widthNumericBox.max;\n                }\n                if (height > _this.heightNumericBox.max) {\n                    height = _this.heightNumericBox.max;\n                }\n                if (!(width === null || height === null)) {\n                    _this.documentEditor.selection.imageFormat.resize(width, height);\n                }\n            }\n            else if (_this.isMaintainAspectRatio) {\n                // tslint:disable-next-line:max-line-length\n                var width = _this.widthNumericBox.value;\n                if (width > _this.widthNumericBox.max) {\n                    width = _this.widthNumericBox.max;\n                }\n                var ratio = width / _this.documentEditor.selection.imageFormat.width;\n                var height = _this.heightNumericBox.value * ratio;\n                _this.heightNumericBox.value = height;\n                if (!(width === null || height === null)) {\n                    _this.documentEditor.selection.imageFormat.resize(width, height);\n                }\n            }\n        };\n        this.applyImageHeight = function () {\n            if (!_this.isMaintainAspectRatio) {\n                // tslint:disable-next-line:max-line-length\n                var width = _this.widthNumericBox.value;\n                var height = _this.heightNumericBox.value;\n                if (!(width === null || height === null)) {\n                    _this.documentEditor.selection.imageFormat.resize(width, height);\n                }\n            }\n            else if (_this.isMaintainAspectRatio) {\n                // tslint:disable-next-line:max-line-length\n                var height = _this.heightNumericBox.value;\n                var ratio = height / _this.documentEditor.selection.imageFormat.height;\n                var width = _this.widthNumericBox.value * ratio;\n                _this.widthNumericBox.value = width;\n                if (!(width === null || height === null)) {\n                    _this.documentEditor.selection.imageFormat.resize(width, height);\n                }\n            }\n        };\n        this.onAspectRatioBtnClick = function () {\n            if (_this.isMaintainAspectRatio) {\n                _this.isMaintainAspectRatio = false;\n            }\n            else {\n                _this.isMaintainAspectRatio = true;\n            }\n        };\n        this.container = container;\n        this.elementId = this.documentEditor.element.id;\n        this.isMaintainAspectRatio = false;\n        this.isRtl = isRtl;\n        this.initializeImageProperties();\n    }\n    Object.defineProperty(ImageProperties.prototype, \"documentEditor\", {\n        get: function () {\n            return this.container.documentEditor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ImageProperties.prototype.showImageProperties = function (isShow) {\n        if (this.element.style.display === 'block') {\n            this.updateImageProperties();\n        }\n        if (!isShow && this.element.style.display === 'none' || (isShow && this.element.style.display === 'block')) {\n            return;\n        }\n        this.element.style.display = isShow ? 'block' : 'none';\n        this.documentEditor.resize();\n    };\n    ImageProperties.prototype.updateImageProperties = function () {\n        this.widthNumericBox.value = this.documentEditor.selection.imageFormat.width;\n        this.heightNumericBox.value = this.documentEditor.selection.imageFormat.height;\n    };\n    ImageProperties.prototype.destroy = function () {\n        this.container = undefined;\n        if (this.widthNumericBox) {\n            this.widthNumericBox.destroy();\n            this.widthNumericBox = undefined;\n        }\n        if (this.heightNumericBox) {\n            this.heightNumericBox.destroy();\n            this.heightNumericBox = undefined;\n        }\n    };\n    return ImageProperties;\n}());\nexport { ImageProperties };\n","import { createElement, isNullOrUndefined, classList, L10n } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { DropDownButton, SplitButton } from '@syncfusion/ej2-splitbuttons';\nimport { Query } from '@syncfusion/ej2-data';\n/**\n * Paragraph Properties\n * @private\n */\nvar Paragraph = /** @class */ (function () {\n    function Paragraph(container) {\n        var _this = this;\n        this.isRetrieving = false;\n        this.appliedBulletStyle = 'dot';\n        this.appliedNumberingStyle = 'arabic';\n        this.appliedLineSpacing = '';\n        this.splitButtonClass = 'e-de-prop-splitbutton';\n        this.updateSelectedBulletListType = function (listText) {\n            switch (listText) {\n                case '\\uf0b7':\n                    _this.dotBullet.classList.add('de-list-item-selected');\n                    break;\n                case '\\uf06f' + '\\u0020':\n                    _this.circleBullet.classList.add('de-list-item-selected');\n                    break;\n                case '\\uf0a7':\n                    _this.squareBullet.classList.add('de-list-item-selected');\n                    break;\n                case '\\uf076':\n                    _this.flowerBullet.classList.add('de-list-item-selected');\n                    break;\n                case '\\uf0d8':\n                    _this.arrowBullet.classList.add('de-list-item-selected');\n                    break;\n                case '\\uf0fc':\n                    _this.tickBullet.classList.add('de-list-item-selected');\n                    break;\n                default:\n                    _this.noneBulletTag.classList.add('de-list-item-selected');\n                    break;\n            }\n        };\n        this.updateSelectedNumberedListType = function (listText) {\n            switch (listText) {\n                case '1.':\n                    _this.numberList.classList.add('de-list-item-selected');\n                    break;\n                case 'I.':\n                    _this.upRoman.classList.add('de-list-item-selected');\n                    break;\n                case 'A.':\n                    _this.upLetter.classList.add('de-list-item-selected');\n                    break;\n                case 'a.':\n                    _this.lowLetter.classList.add('de-list-item-selected');\n                    break;\n                case 'i.':\n                    _this.lowRoman.classList.add('de-list-item-selected');\n                    break;\n                default:\n                    _this.noneNumberTag.classList.add('de-list-item-selected');\n                    break;\n            }\n        };\n        this.removeSelectedList = function () {\n            var className = 'de-list-item-selected';\n            _this.noneNumberTag.classList.remove(className);\n            _this.numberList.classList.remove(className);\n            _this.lowLetter.classList.remove(className);\n            _this.upLetter.classList.remove(className);\n            _this.lowRoman.classList.remove(className);\n            _this.upRoman.classList.remove(className);\n            _this.noneBulletTag.classList.remove(className);\n            _this.dotBullet.classList.remove(className);\n            _this.circleBullet.classList.remove(className);\n            _this.squareBullet.classList.remove(className);\n            _this.flowerBullet.classList.remove(className);\n            _this.arrowBullet.classList.remove(className);\n            _this.tickBullet.classList.remove(className);\n        };\n        this.applyLastAppliedNumbering = function () {\n            switch (_this.appliedNumberingStyle) {\n                case 'arabic':\n                    _this.numberedNumberDotClick();\n                    break;\n                case 'lowletter':\n                    _this.numberedLowLetterClick();\n                    break;\n                case 'upletter':\n                    _this.numberedUpLetterClick();\n                    break;\n                case 'lowroman':\n                    _this.numberedLowRomanClick();\n                    break;\n                case 'uproman':\n                    _this.numberedUpRomanClick();\n                    break;\n            }\n        };\n        this.applyLastAppliedBullet = function () {\n            switch (_this.appliedBulletStyle) {\n                case 'dot':\n                    _this.bulletDotClick();\n                    break;\n                case 'circle':\n                    _this.bulletCircleClick();\n                    break;\n                case 'square':\n                    _this.bulletSquareClick();\n                    break;\n                case 'arrow':\n                    _this.bulletArrowClick();\n                    break;\n                case 'tick':\n                    _this.bulletTickClick();\n                    break;\n                case 'flower':\n                    _this.bulletFlowerClick();\n                    break;\n            }\n        };\n        /* tslint:disable:no-any */\n        this.updateOptions = function (args) {\n            _this.updateStyleNames();\n            args.popup.element.getElementsByClassName('e-de-ctnr-dropdown-ftr')[0].addEventListener('click', _this.createStyle);\n        };\n        this.closeStyleValue = function (args) {\n            if (!isNullOrUndefined(_this.styleName)) {\n                _this.style.value = _this.styleName;\n                _this.style.dataBind();\n            }\n        };\n        this.createStyle = function () {\n            _this.style.hidePopup();\n            if (!_this.documentEditor.isReadOnly) {\n                _this.documentEditor.showDialog('Styles');\n            }\n        };\n        this.leftAlignmentAction = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.editor) {\n                _this.documentEditor.editor.toggleTextAlignment('Left');\n            }\n        };\n        this.lineSpacingAction = function (args) {\n            if (_this.isRetrieving) {\n                return;\n            }\n            var text = args.item.text;\n            switch (text) {\n                case 'Single':\n                    _this.documentEditor.selection.paragraphFormat.lineSpacing = 1;\n                    break;\n                case '1.15':\n                    _this.documentEditor.selection.paragraphFormat.lineSpacing = 1.15;\n                    break;\n                case '1.5':\n                    _this.documentEditor.selection.paragraphFormat.lineSpacing = 1.5;\n                    break;\n                case 'Double':\n                    _this.documentEditor.selection.paragraphFormat.lineSpacing = 2;\n                    break;\n            }\n            setTimeout(function () { _this.documentEditor.focusIn(); }, 30);\n        };\n        this.selectStyleValue = function (args) {\n            if (_this.isRetrieving || !args.isInteracted) {\n                return;\n            }\n            setTimeout(function () { _this.applyStyleValue(args); }, 10);\n        };\n        /* tslint:enable:no-any */\n        this.rightAlignmentAction = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.editor) {\n                _this.documentEditor.editor.toggleTextAlignment('Right');\n            }\n        };\n        this.centerAlignmentAction = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.editor) {\n                _this.documentEditor.editor.toggleTextAlignment('Center');\n            }\n        };\n        this.justifyAction = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.editor) {\n                _this.documentEditor.editor.toggleTextAlignment('Justify');\n            }\n        };\n        this.increaseIndentAction = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.editor) {\n                _this.documentEditor.editor.increaseIndent();\n            }\n        };\n        this.decreaseIndentAction = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.editor) {\n                _this.documentEditor.editor.decreaseIndent();\n            }\n        };\n        this.numberedNoneClick = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (_this.documentEditor.editor) {\n                _this.documentEditor.editor.clearList();\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 30);\n            }\n        };\n        this.numberedNumberDotClick = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (_this.documentEditor.editor) {\n                _this.appliedNumberingStyle = 'arabic';\n                _this.documentEditor.editor.applyNumbering('%1.', 'Arabic');\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 30);\n            }\n        };\n        this.numberedUpRomanClick = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (_this.documentEditor.editor) {\n                _this.appliedNumberingStyle = 'uproman';\n                _this.documentEditor.editor.applyNumbering('%1.', 'UpRoman');\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 30);\n            }\n        };\n        this.numberedUpLetterClick = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (_this.documentEditor.editor) {\n                _this.appliedNumberingStyle = 'upletter';\n                _this.documentEditor.editor.applyNumbering('%1.', 'UpLetter');\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 30);\n            }\n        };\n        this.numberedLowLetterClick = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (_this.documentEditor.editor) {\n                _this.appliedNumberingStyle = 'lowletter';\n                _this.documentEditor.editor.applyNumbering('%1.', 'LowLetter');\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 30);\n            }\n        };\n        this.numberedLowRomanClick = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (_this.documentEditor.editor) {\n                _this.appliedNumberingStyle = 'lowroman';\n                _this.documentEditor.editor.applyNumbering('%1.', 'LowRoman');\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 30);\n            }\n        };\n        this.bulletDotClick = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (_this.documentEditor.editor) {\n                _this.appliedBulletStyle = 'dot';\n                _this.documentEditor.editor.applyBullet('\\uf0b7', 'Symbol');\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 30);\n            }\n        };\n        this.bulletCircleClick = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (_this.documentEditor.editor) {\n                _this.appliedBulletStyle = 'circle';\n                _this.documentEditor.editor.applyBullet('\\uf06f' + '\\u0020', 'Symbol');\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 30);\n            }\n        };\n        this.bulletSquareClick = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (_this.documentEditor.editor) {\n                _this.appliedBulletStyle = 'square';\n                _this.documentEditor.editor.applyBullet('\\uf0a7', 'Wingdings');\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 30);\n            }\n        };\n        this.bulletFlowerClick = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (_this.documentEditor.editor) {\n                _this.appliedBulletStyle = 'flower';\n                _this.documentEditor.editor.applyBullet('\\uf076', 'Wingdings');\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 30);\n            }\n        };\n        this.bulletArrowClick = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (_this.documentEditor.editor) {\n                _this.appliedBulletStyle = 'arrow';\n                _this.documentEditor.editor.applyBullet('\\uf0d8', 'Wingdings');\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 30);\n            }\n        };\n        this.bulletTickClick = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (_this.documentEditor.editor) {\n                _this.appliedBulletStyle = 'tick';\n                _this.documentEditor.editor.applyBullet('\\uf0fc', 'Wingdings');\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 30);\n            }\n        };\n        this.container = container;\n    }\n    Object.defineProperty(Paragraph.prototype, \"documentEditor\", {\n        get: function () {\n            return this.container.documentEditor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Paragraph.prototype.initializeParagraphPropertiesDiv = function (wholeDiv, isRtl) {\n        this.localObj = new L10n('documenteditorcontainer', this.container.defaultLocale, this.container.locale);\n        this.isRtl = isRtl;\n        if (this.isRtl) {\n            this.splitButtonClass = 'e-rtl ' + this.splitButtonClass;\n        }\n        this.textProperties = wholeDiv;\n        var element = 'font_properties';\n        var paragraphDiv = this.createDivElement(element + '_paragraph', wholeDiv, '');\n        classList(paragraphDiv, ['e-de-cntr-pane-padding'], []);\n        var label = createElement('label', { styles: 'width:26px;', className: 'e-de-ctnr-prop-label' });\n        label.innerHTML = this.localObj.getConstant('Paragraph');\n        paragraphDiv.appendChild(label);\n        var styleDiv = this.createDivElement(element + '_styleDiv', paragraphDiv);\n        styleDiv.classList.add('e-de-ctnr-segment');\n        // tslint:disable-next-line:max-line-length\n        var styleSelect = createElement('input', { id: element + '_style', styles: 'width:248px;font-size: 12px;letter-spacing: 0.05px;' });\n        styleDiv.appendChild(styleSelect);\n        this.createStyleDropDownList(styleSelect);\n        var indentWholeDiv = this.createDivElement(element + '_indentWholeDiv', paragraphDiv);\n        indentWholeDiv.style.display = 'flex';\n        indentWholeDiv.classList.add('e-de-ctnr-segment');\n        if (isRtl) {\n            classList(indentWholeDiv, ['e-de-ctnr-segment-rtl'], []);\n        }\n        // tslint:disable-next-line:max-line-length\n        var indentDiv = this.createDivElement(element + '_indentDiv', indentWholeDiv, 'display:flex;');\n        var indentClassName = 'e-de-ctnr-group-btn e-de-char-fmt-btn-left e-btn-group';\n        if (isRtl) {\n            indentClassName = 'e-rtl ' + indentClassName;\n        }\n        indentDiv.className = indentClassName;\n        // tslint:disable-next-line:max-line-length\n        this.leftAlignment = this.createButtonTemplate(element + '_leftIndent', 'e-de-ctnr-alignleft e-icons', indentDiv, 'e-de-prop-indent-button', '40.5', this.localObj.getConstant('Align left (Ctrl+L)'));\n        // tslint:disable-next-line:max-line-length\n        this.centerAlignment = this.createButtonTemplate(element + '_centerIndent', 'e-de-ctnr-aligncenter e-icons', indentDiv, 'e-de-prop-indent-button', '40.5', this.localObj.getConstant('Center (Ctrl+E)'));\n        // tslint:disable-next-line:max-line-length\n        this.rightAlignment = this.createButtonTemplate(element + '_rightIndent', 'e-de-ctnr-alignright e-icons', indentDiv, 'e-de-prop-indent-button', '40.5', this.localObj.getConstant('Align right (Ctrl+R)'));\n        // tslint:disable-next-line:max-line-length\n        this.justify = this.createButtonTemplate(element + '_justify', 'e-de-ctnr-justify e-icons', indentDiv, 'e-de-prop-indent-last-button', '40.5', this.localObj.getConstant('Justify (Ctrl+J)'));\n        var incDecIndentDiv = this.createDivElement(element + '_indentDiv', indentWholeDiv, 'display:flex;');\n        indentClassName = 'e-de-ctnr-group-btn e-de-char-fmt-btn-right e-btn-group';\n        if (isRtl) {\n            indentClassName = 'e-rtl ' + indentClassName;\n        }\n        incDecIndentDiv.className = indentClassName;\n        // tslint:disable-next-line:max-line-length\n        this.decreaseIndent = this.createButtonTemplate(element + '_decreaseIndent', 'e-de-ctnr-decreaseindent e-icons', incDecIndentDiv, 'e-de-prop-indent-button', '37', this.localObj.getConstant('Decrease indent'));\n        // tslint:disable-next-line:max-line-length\n        this.increaseIndent = this.createButtonTemplate(element + '_increaseIndent', 'e-de-ctnr-increaseindent e-icons', incDecIndentDiv, 'e-de-prop-indent-last-button', '37', this.localObj.getConstant('Increase indent'));\n        var listDiv = this.createDivElement(element + '_listDiv', paragraphDiv, 'display:flex;');\n        classList(listDiv, ['e-de-ctnr-segment'], []);\n        if (isRtl) {\n            classList(listDiv, ['e-de-ctnr-segment-rtl'], []);\n        }\n        var lineHeight = createElement('button', { id: element + '_lineHeight' });\n        listDiv.appendChild(lineHeight);\n        this.lineSpacing = this.createLineSpacingDropdown(lineHeight);\n        var listDropDown = this.createDivElement(element + '_listDropDiv', listDiv);\n        listDropDown.className = 'de-split-button';\n        var bulletButton = createElement('button', { id: element + '_bullet' });\n        listDropDown.appendChild(bulletButton);\n        var numberingList = createElement('button', { id: element + '_numberingList' });\n        listDropDown.appendChild(numberingList);\n        this.createBulletListDropButton('e-de-ctnr-bullets e-icons', bulletButton);\n        this.createNumberListDropButton('e-de-ctnr-numbering e-icons', numberingList);\n    };\n    Paragraph.prototype.createSeperator = function (parentDiv) {\n        var seperator = createElement('div', { className: 'e-de-prop-vline' });\n        parentDiv.appendChild(seperator);\n    };\n    Paragraph.prototype.createDivElement = function (id, parentDiv, style) {\n        var element;\n        if (style) {\n            element = createElement('div', { id: id, styles: style });\n        }\n        else {\n            element = createElement('div', { id: id });\n        }\n        parentDiv.appendChild(element);\n        return element;\n    };\n    // tslint:disable-next-line:max-line-length\n    Paragraph.prototype.createButtonTemplate = function (id, iconcss, div, buttonClass, width, toolTipText) {\n        var buttonElement = createElement('Button', { id: id });\n        // buttonElement.style.width = width + 'px';\n        // buttonElement.style.height = 32 + 'px';\n        div.appendChild(buttonElement);\n        var btn = new Button({\n            cssClass: buttonClass, iconCss: iconcss\n        });\n        btn.appendTo(buttonElement);\n        buttonElement.setAttribute('title', toolTipText);\n        return buttonElement;\n    };\n    Paragraph.prototype.createLineSpacingDropdown = function (button) {\n        var _this = this;\n        var items = [{\n                text: 'Single'\n            }, {\n                text: '1.15'\n            }, {\n                text: '1.5'\n            }, {\n                text: 'Double'\n            }];\n        var dropdown = new DropDownButton({\n            items: items,\n            iconCss: 'e-de-ctnr-linespacing e-icons',\n            enableRtl: this.isRtl,\n            select: this.lineSpacingAction,\n            cssClass: this.splitButtonClass,\n            beforeItemRender: function (args) {\n                args.element.innerHTML = '<span></span>' + args.item.text;\n                var span = args.element.children[0];\n                if (args.item.text === _this.appliedLineSpacing) {\n                    span.style.marginRight = '10px';\n                    span.setAttribute('class', 'e-de-selected-item e-icons');\n                }\n                else {\n                    args.element.children[0].style.marginRight = '25px';\n                    args.element.children[0].classList.remove('e-de-selected-item');\n                }\n            }\n        });\n        dropdown.appendTo(button);\n        button.setAttribute('title', this.localObj.getConstant('Line spacing'));\n        return dropdown;\n    };\n    Paragraph.prototype.createNumberListDropButton = function (iconcss, button) {\n        var _this = this;\n        // tslint:disable-next-line:max-line-length\n        var div = createElement('div', { id: 'target', styles: 'width: 211px;height: auto;display:none' });\n        var ulTag = createElement('ul', {\n            styles: 'display: block; outline: 0px;',\n            id: 'listMenu',\n            className: 'e-de-floating-menu e-de-bullets-menu e-de-list-container e-de-list-thumbnail'\n        });\n        div.appendChild(ulTag);\n        this.noneNumberTag = this.createNumberNoneListTag(ulTag);\n        this.noneNumberTag.addEventListener('click', this.numberedNoneClick);\n        this.numberList = this.createNumberListTag(ulTag, '1.', '2.', '3.');\n        this.numberList.addEventListener('click', this.numberedNumberDotClick);\n        this.lowLetter = this.createNumberListTag(ulTag, 'a.', 'b.', 'c.');\n        this.lowLetter.addEventListener('click', this.numberedLowLetterClick);\n        this.upLetter = this.createNumberListTag(ulTag, 'A.', 'B.', 'C.');\n        this.upLetter.addEventListener('click', this.numberedUpLetterClick);\n        this.lowRoman = this.createNumberListTag(ulTag, 'i.', 'ii.', 'iii.');\n        this.lowRoman.addEventListener('click', this.numberedLowRomanClick);\n        this.upRoman = this.createNumberListTag(ulTag, 'I.', 'II.', 'III.');\n        this.upRoman.addEventListener('click', this.numberedUpRomanClick);\n        var menuOptions = {\n            target: div,\n            iconCss: iconcss,\n            cssClass: this.splitButtonClass,\n            beforeOpen: function () {\n                div.style.display = 'block';\n                _this.updateSelectedNumberedListType(_this.documentEditor.selection.paragraphFormat.listText);\n            },\n            beforeClose: function () {\n                div.style.display = 'none';\n                _this.removeSelectedList();\n            }\n        };\n        var dropdown = new SplitButton(menuOptions);\n        dropdown.click = function () {\n            _this.applyLastAppliedNumbering();\n        };\n        dropdown.appendTo(button);\n        button.parentElement.setAttribute('title', this.localObj.getConstant('Numbering'));\n    };\n    Paragraph.prototype.createBulletListDropButton = function (iconcss, button) {\n        var _this = this;\n        // tslint:disable-next-line:max-line-length\n        var div = createElement('div', { id: 'bullet_list', styles: 'width: 196px;height: auto;display:none' });\n        var ulTag = createElement('ul', {\n            styles: 'display: block; outline: 0px;', id: 'listMenu',\n            className: 'e-de-floating-menu e-de-bullets-menu e-de-list-container e-de-list-thumbnail'\n        });\n        div.appendChild(ulTag);\n        this.noneBulletTag = this.createBulletListTag(ulTag, 'e-de-ctnr-bullet-none e-icons e-de-ctnr-list');\n        this.noneBulletTag.addEventListener('click', this.numberedNoneClick);\n        this.dotBullet = this.createBulletListTag(ulTag, 'e-de-ctnr-bullet-dot e-icons e-de-ctnr-list');\n        this.dotBullet.addEventListener('click', this.bulletDotClick);\n        this.circleBullet = this.createBulletListTag(ulTag, 'e-de-ctnr-bullet-circle e-icons e-de-ctnr-list');\n        this.circleBullet.addEventListener('click', this.bulletCircleClick);\n        this.squareBullet = this.createBulletListTag(ulTag, 'e-de-ctnr-bullet-square e-icons e-de-ctnr-list');\n        this.squareBullet.addEventListener('click', this.bulletSquareClick);\n        this.flowerBullet = this.createBulletListTag(ulTag, 'e-de-ctnr-bullet-flower e-icons e-de-ctnr-list');\n        this.flowerBullet.addEventListener('click', this.bulletFlowerClick);\n        this.arrowBullet = this.createBulletListTag(ulTag, 'e-de-ctnr-bullet-arrow e-icons e-de-ctnr-list');\n        this.arrowBullet.addEventListener('click', this.bulletArrowClick);\n        this.tickBullet = this.createBulletListTag(ulTag, 'e-de-ctnr-bullet-tick e-icons e-de-ctnr-list');\n        this.tickBullet.addEventListener('click', this.bulletTickClick);\n        var menuOptions = {\n            target: div,\n            iconCss: iconcss,\n            cssClass: this.splitButtonClass,\n            beforeOpen: function () {\n                div.style.display = 'block';\n                _this.updateSelectedBulletListType(_this.documentEditor.selection.paragraphFormat.listText);\n            },\n            beforeClose: function () {\n                div.style.display = 'none';\n                _this.removeSelectedList();\n            }\n        };\n        var dropdown = new SplitButton(menuOptions);\n        dropdown.click = function () {\n            _this.applyLastAppliedBullet();\n        };\n        dropdown.appendTo(button);\n        button.parentElement.setAttribute('title', this.localObj.getConstant('Bullets'));\n    };\n    Paragraph.prototype.createNumberListTag = function (ulTag, text1, text2, text3) {\n        var liTag = createElement('li', {\n            styles: 'display:block',\n            className: 'e-de-floating-menuitem e-de-floating-menuitem-md e-de-list-items  e-de-list-item-size'\n        });\n        ulTag.appendChild(liTag);\n        // tslint:disable-next-line:max-line-length\n        var innerHTML = '<div>' + text1 + '<span class=\"e-de-list-line\"></span></div><div>' + text2 + '<span class=\"e-de-list-line\">';\n        innerHTML += '</span></div><div>' + text3 + '<span class=\"e-de-list-line\"> </span></div >';\n        var liInnerDiv = createElement('div', {\n            className: 'e-de-list-header-presetmenu',\n            id: 'ui-zlist0', innerHTML: innerHTML\n        });\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    Paragraph.prototype.createNumberNoneListTag = function (ulTag) {\n        var liTag = createElement('li', {\n            styles: 'display:block;',\n            className: 'e-de-floating-menuitem e-de-floating-menuitem-md e-de-list-items  e-de-list-item-size'\n        });\n        ulTag.appendChild(liTag);\n        var innerHTML = '<div class=\"e-de-list-items-size\"><span class=\"e-de-bullets e-de-list-items-size\"' +\n            'style=\"display:table-cell; text-align: center; vertical-align:middle\">None</span></div>';\n        var liInnerDiv = createElement('div', {\n            className: 'e-de-list-header-presetmenu e-de-list-items-size', styles: 'position:relative;left:11px;top:13px',\n            id: 'ui-zlist0', innerHTML: innerHTML\n        });\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    Paragraph.prototype.createBulletListTag = function (ulTag, iconCss) {\n        var liTag = createElement('li', {\n            styles: 'display:block;',\n            className: 'e-de-floating-menuitem e-de-floating-bullet-menuitem-md e-de-list-items  e-de-list-item-size'\n        });\n        ulTag.appendChild(liTag);\n        var liInnerDiv = createElement('div', { className: 'e-de-bullet-list-header-presetmenu', id: 'ui-zlist0' });\n        var spanDiv = createElement('div');\n        liInnerDiv.appendChild(spanDiv);\n        var span = createElement('span', { className: iconCss });\n        spanDiv.appendChild(span);\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    Paragraph.prototype.createStyleDropDownList = function (selectElement) {\n        this.style = new DropDownList({\n            dataSource: [{ StyleName: 'Normal', Class: 'e-icons e-edit-font' }],\n            cssClass: 'e-de-prop-dropdown',\n            popupHeight: '240px',\n            enableRtl: this.isRtl,\n            query: new Query().select(['StyleName', 'Style']),\n            fields: { text: 'StyleName', value: 'StyleName' },\n            open: this.updateOptions,\n            change: this.selectStyleValue,\n            close: this.closeStyleValue,\n            itemTemplate: '<span style=\"${Style}\">${StyleName}</span>',\n            footerTemplate: '<span class=\"e-de-ctnr-dropdown-ftr\">' + this.localObj.getConstant('Manage Styles') + '</span>'\n        });\n        this.style.appendTo(selectElement);\n        selectElement.parentElement.setAttribute('title', this.localObj.getConstant('Styles'));\n    };\n    Paragraph.prototype.updateStyleNames = function () {\n        this.styleName = !isNullOrUndefined(this.style.itemData) ? this.style.itemData.StyleName : undefined;\n        this.style.dataSource = this.constructStyleDropItems(this.documentEditor.getStyles('Paragraph'));\n        this.style.dataBind();\n        this.onSelectionChange();\n    };\n    Paragraph.prototype.constructStyleDropItems = function (styles) {\n        var collection = [];\n        for (var _i = 0, styles_1 = styles; _i < styles_1.length; _i++) {\n            var styleObj = styles_1[_i];\n            var obj = {};\n            obj.StyleName = styleObj.name;\n            obj.Style = this.parseStyle(styleObj.style);\n            collection.push(obj);\n        }\n        return collection;\n    };\n    Paragraph.prototype.parseStyle = function (style) {\n        var domStyle = '';\n        var styleObj = JSON.parse(style);\n        var textDecoration = '';\n        if (!isNullOrUndefined(styleObj.characterFormat.baselineAlignment) && styleObj.characterFormat.baselineAlignment !== 'Normal') {\n            var vAlign = '';\n            switch (styleObj.characterFormat.baselineAlignment) {\n                case 'Superscript':\n                    vAlign = 'super';\n                    break;\n                case 'Subscript':\n                    vAlign = 'sub';\n                    break;\n            }\n            if (vAlign.length > 1) {\n                domStyle += 'vertical-align:' + vAlign + ';';\n            }\n        }\n        if (!isNullOrUndefined(styleObj.characterFormat.underline) && styleObj.characterFormat.underline !== 'None') {\n            textDecoration += 'underline ';\n        }\n        if (!isNullOrUndefined(styleObj.characterFormat.strikethrough) && styleObj.characterFormat.strikethrough !== 'None') {\n            textDecoration += 'line-through ';\n        }\n        if (!isNullOrUndefined(styleObj.characterFormat.fontSize)) {\n            domStyle += 'font-size:' + styleObj.characterFormat.fontSize + 'px;';\n        }\n        if (!isNullOrUndefined(styleObj.characterFormat.fontFamily)) {\n            domStyle += 'font-family:' + styleObj.characterFormat.fontFamily + ';';\n        }\n        if (!isNullOrUndefined(styleObj.characterFormat.bold) && styleObj.characterFormat.bold) {\n            domStyle += 'font-weight:bold;';\n        }\n        if (!isNullOrUndefined(styleObj.characterFormat.italic) && styleObj.characterFormat.italic) {\n            domStyle += 'font-style:italic;';\n        }\n        // if (!isNullOrUndefined(styleObj.characterFormat.fontColor)) {\n        //     domStyle += 'color: ' + styleObj.characterFormat.fontColor + ';';\n        // }\n        if (textDecoration.length > 1) {\n            domStyle += 'text-decoration:' + textDecoration + ';';\n        }\n        return domStyle;\n    };\n    Paragraph.prototype.wireEvent = function () {\n        var _this = this;\n        this.leftAlignment.addEventListener('click', function () { _this.leftAlignmentAction(); });\n        this.rightAlignment.addEventListener('click', function () { _this.rightAlignmentAction(); });\n        this.centerAlignment.addEventListener('click', function () { _this.centerAlignmentAction(); });\n        this.justify.addEventListener('click', function () { _this.justifyAction(); });\n        this.increaseIndent.addEventListener('click', function () { _this.increaseIndentAction(); });\n        this.decreaseIndent.addEventListener('click', function () { _this.decreaseIndentAction(); });\n        /* tslint:disable-next-line:max-line-length */\n        this.lineSpacing.addEventListener('select', function (args) { _this.lineSpacingAction(args); });\n    };\n    Paragraph.prototype.unwireEvents = function () {\n        this.leftAlignment.click = undefined;\n        this.rightAlignment.click = undefined;\n        this.centerAlignment.click = undefined;\n        this.justify.click = undefined;\n        this.increaseIndent.click = undefined;\n        this.decreaseIndent.click = undefined;\n        this.lineSpacing.select = undefined;\n        this.style.select = undefined;\n    };\n    Paragraph.prototype.setLineSpacing = function () {\n        var lineSpacing = this.documentEditor.selection.paragraphFormat.lineSpacing;\n        if (lineSpacing === 1) {\n            this.appliedLineSpacing = 'Single';\n        }\n        else if (lineSpacing === 1.15) {\n            this.appliedLineSpacing = '1.15';\n        }\n        else if (lineSpacing === 1.5) {\n            this.appliedLineSpacing = '1.5';\n        }\n        else if (lineSpacing === 2) {\n            this.appliedLineSpacing = 'Double';\n        }\n        else {\n            this.appliedLineSpacing = '';\n        }\n    };\n    Paragraph.prototype.applyStyleValue = function (args) {\n        if (!this.documentEditor.isReadOnly && this.documentEditor.editor) {\n            this.documentEditor.editor.applyStyle(args.itemData.StyleName);\n        }\n    };\n    Paragraph.prototype.onSelectionChange = function () {\n        this.isRetrieving = true;\n        if (this.documentEditor.editor) {\n            //#region paragraph format\n            var style = this.documentEditor.selection.paragraphFormat.styleName;\n            if (style) {\n                this.style.value = style;\n                this.style.dataBind();\n            }\n            else {\n                this.style.value = '';\n            }\n            classList(this.leftAlignment, [], ['e-btn-toggle']);\n            classList(this.rightAlignment, [], ['e-btn-toggle']);\n            classList(this.centerAlignment, [], ['e-btn-toggle']);\n            classList(this.justify, [], ['e-btn-toggle']);\n            if (this.documentEditor.selection.paragraphFormat.textAlignment === 'Left') {\n                classList(this.leftAlignment, ['e-btn-toggle'], []);\n            }\n            else if (this.documentEditor.selection.paragraphFormat.textAlignment === 'Right') {\n                classList(this.rightAlignment, ['e-btn-toggle'], []);\n            }\n            else if (this.documentEditor.selection.paragraphFormat.textAlignment === 'Center') {\n                classList(this.centerAlignment, ['e-btn-toggle'], []);\n            }\n            else if (this.documentEditor.selection.paragraphFormat.textAlignment === 'Justify') {\n                classList(this.justify, ['e-btn-toggle'], []);\n            }\n            //#endregion\n        }\n        this.setLineSpacing();\n        this.isRetrieving = false;\n    };\n    Paragraph.prototype.destroy = function () {\n        this.container = undefined;\n        if (this.lineSpacing) {\n            this.lineSpacing.destroy();\n            this.lineSpacing = undefined;\n        }\n        if (this.style) {\n            this.style.destroy();\n            this.style = undefined;\n        }\n    };\n    return Paragraph;\n}());\nexport { Paragraph };\n","import { createElement, L10n } from '@syncfusion/ej2-base';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\n/**\n * Represents document editor status bar.\n * @private\n */\nvar StatusBar = /** @class */ (function () {\n    function StatusBar(parentElement, docEditor) {\n        var _this = this;\n        this.startPage = 1;\n        this.initializeStatusBar = function () {\n            var isRtl = _this.container.enableRtl;\n            _this.localObj = new L10n('documenteditorcontainer', _this.container.defaultLocale, _this.container.locale);\n            // tslint:disable-next-line:max-line-length\n            var styles = 'padding-top:8px;';\n            styles += isRtl ? 'padding-right:16px' : 'padding-left:16px';\n            var div = createElement('div', { className: 'e-de-ctnr-pg-no', styles: styles });\n            _this.statusBarDiv.appendChild(div);\n            var label = createElement('label');\n            label.textContent = _this.localObj.getConstant('Page') + ' ';\n            div.appendChild(label);\n            // tslint:disable-next-line:max-line-length\n            _this.pageNumberLabel = createElement('label', { styles: 'text-transform:capitalize;white-space:pre;overflow:hidden;user-select:none;cursor:text;height:17px;max-width:150px' });\n            _this.editablePageNumber = createElement('div', { styles: 'display: inline-flex;height: 17px;padding: 0px 4px;', className: 'e-de-pagenumber-text' });\n            _this.editablePageNumber.appendChild(_this.pageNumberLabel);\n            if (isRtl) {\n                label.style.marginLeft = '6px';\n                _this.editablePageNumber.style.marginLeft = '6px';\n            }\n            else {\n                label.style.marginRight = '6px';\n                _this.editablePageNumber.style.marginRight = '6px';\n            }\n            _this.updatePageNumber();\n            div.appendChild(_this.editablePageNumber);\n            // tslint:disable-next-line:max-line-length\n            _this.editablePageNumber.setAttribute('title', _this.localObj.getConstant('The current page number in the document. Click or tap to navigate specific page.'));\n            var label1 = createElement('label', { styles: 'width:16px' });\n            label1.textContent = ' ' + _this.localObj.getConstant('of') + ' ';\n            div.appendChild(label1);\n            _this.pageCount = createElement('label');\n            div.appendChild(_this.pageCount);\n            _this.updatePageCount();\n            var zoomBtn = createElement('button', {\n                className: 'e-de-statusbar-zoom'\n            });\n            _this.statusBarDiv.appendChild(zoomBtn);\n            zoomBtn.setAttribute('title', 'Zoom level. Click or tap to open the Zoom options.');\n            var items = [\n                {\n                    text: '200%',\n                },\n                {\n                    text: '175%',\n                },\n                {\n                    text: '150%',\n                },\n                {\n                    text: '125%',\n                },\n                {\n                    text: '100%',\n                },\n                {\n                    text: '75%',\n                },\n                {\n                    text: '50%',\n                },\n                {\n                    text: '25%',\n                },\n                {\n                    separator: true\n                },\n                {\n                    text: _this.localObj.getConstant('Fit one page')\n                },\n                {\n                    text: _this.localObj.getConstant('Fit page width'),\n                },\n            ];\n            // tslint:disable-next-line:max-line-length\n            _this.zoom = new DropDownButton({ content: '100%', items: items, enableRtl: _this.container.enableRtl, select: _this.onZoom }, zoomBtn);\n        };\n        this.onZoom = function (args) {\n            _this.setZoomValue(args.item.text);\n            _this.updateZoomContent();\n        };\n        this.updateZoomContent = function () {\n            _this.zoom.content = Math.round(_this.documentEditor.zoomFactor * 100) + '%';\n        };\n        this.setZoomValue = function (text) {\n            if (text.match(_this.localObj.getConstant('Fit one page'))) {\n                _this.documentEditor.fitPage('FitOnePage');\n            }\n            else if (text.match(_this.localObj.getConstant('Fit page width'))) {\n                _this.documentEditor.fitPage('FitPageWidth');\n            }\n            else {\n                _this.documentEditor.zoomFactor = parseInt(text, 0) / 100;\n            }\n        };\n        /**\n         * Updates page count.\n         */\n        this.updatePageCount = function () {\n            _this.pageCount.textContent = _this.editorPageCount.toString();\n        };\n        /**\n         * Updates page number.\n         */\n        this.updatePageNumber = function () {\n            _this.pageNumberLabel.textContent = _this.startPage.toString();\n        };\n        this.updatePageNumberOnViewChange = function (args) {\n            if (_this.documentEditor.selection\n                && _this.documentEditor.selection.startPage >= args.startPage && _this.documentEditor.selection.startPage <= args.endPage) {\n                _this.startPage = _this.documentEditor.selection.startPage;\n            }\n            else {\n                _this.startPage = args.startPage;\n            }\n            _this.updatePageNumber();\n        };\n        this.wireEvents = function () {\n            _this.editablePageNumber.addEventListener('keydown', function (e) {\n                if (e.which === 13) {\n                    e.preventDefault();\n                    var pageNumber = parseInt(_this.editablePageNumber.textContent, 0);\n                    if (pageNumber > _this.editorPageCount) {\n                        _this.updatePageNumber();\n                    }\n                    else {\n                        if (_this.documentEditor.selection) {\n                            _this.documentEditor.selection.goToPage(parseInt(_this.editablePageNumber.textContent, 0));\n                        }\n                        else {\n                            _this.documentEditor.scrollToPage(parseInt(_this.editablePageNumber.textContent, 0));\n                        }\n                    }\n                    _this.editablePageNumber.contentEditable = 'false';\n                    if (_this.editablePageNumber.textContent === '') {\n                        _this.updatePageNumber();\n                    }\n                }\n                if (e.which > 64) {\n                    e.preventDefault();\n                }\n            });\n            _this.editablePageNumber.addEventListener('blur', function () {\n                if (_this.editablePageNumber.textContent === '' || parseInt(_this.editablePageNumber.textContent, 0) > _this.editorPageCount) {\n                    _this.updatePageNumber();\n                }\n                _this.editablePageNumber.contentEditable = 'false';\n                _this.editablePageNumber.style.border = 'none';\n            });\n            _this.editablePageNumber.addEventListener('focus', function () {\n                _this.editablePageNumber.style.border = '1px solid #F1F1F1';\n            });\n            _this.editablePageNumber.addEventListener('click', function () {\n                _this.updateDocumentEditorPageNumber();\n            });\n        };\n        this.updateDocumentEditorPageNumber = function () {\n            _this.editablePageNumber.contentEditable = 'true';\n            _this.editablePageNumber.focus();\n            window.getSelection().selectAllChildren(_this.editablePageNumber);\n        };\n        this.statusBarDiv = parentElement;\n        this.container = docEditor;\n        this.initializeStatusBar();\n        this.wireEvents();\n    }\n    Object.defineProperty(StatusBar.prototype, \"documentEditor\", {\n        get: function () {\n            return this.container.documentEditor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(StatusBar.prototype, \"editorPageCount\", {\n        get: function () {\n            return this.documentEditor.pageCount;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    StatusBar.prototype.destroy = function () {\n        this.container = undefined;\n        if (this.zoom) {\n            this.zoom.destroy();\n            this.zoom = undefined;\n        }\n    };\n    return StatusBar;\n}());\nexport { StatusBar };\n","import { createElement, L10n } from '@syncfusion/ej2-base';\nimport { Button, CheckBox } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\n/**\n * TOC Properties pane\n * @private\n */\nvar TocProperties = /** @class */ (function () {\n    function TocProperties(container, isRtl) {\n        var _this = this;\n        this.initializeTocPane = function () {\n            _this.localObj = new L10n('documenteditorcontainer', _this.container.defaultLocale, _this.container.locale);\n            // tslint:disable-next-line:max-line-length\n            _this.element = createElement('div', { id: _this.elementId + '_tocProperties', className: 'e-de-prop-pane' });\n            var container = createElement('div', { className: 'e-de-cntr-pane-padding e-de-prop-separator-line' });\n            _this.tocHeaderDiv(container);\n            _this.initTemplates(container);\n            container = createElement('div', { className: 'e-de-cntr-pane-padding' });\n            _this.tocOptionsDiv(container);\n            _this.contentStylesDropdown(container);\n            _this.checkboxContent(container);\n            _this.buttonDiv(container);\n            _this.wireEvents();\n            _this.updateTocProperties();\n            _this.container.propertiesPaneContainer.appendChild(_this.element);\n        };\n        this.updateTocProperties = function () {\n            _this.rightalignPageNumber.checked = true;\n            _this.showPageNumber.checked = true;\n            _this.hyperlink.checked = true;\n        };\n        this.wireEvents = function () {\n            _this.cancelBtn.element.addEventListener('click', function () { _this.onClose(); });\n            _this.updateBtn.element.addEventListener('click', _this.onInsertToc);\n            _this.closeButton.addEventListener('click', function () { _this.onClose(); });\n        };\n        this.onClose = function () {\n            if (_this.toolbar.showPropertiesPane\n                && _this.toolbar.previousContext !== 'TableOfContents') {\n                _this.toolbar.showPropertiesPaneOnSelection();\n            }\n            else {\n                _this.toolbar.showPropertiesPane = false;\n                _this.showTocPane(false);\n                _this.toolbar.enableDisablePropertyPaneButton(false);\n                _this.container.showPropertiesPane = false;\n            }\n        };\n        this.tocHeaderDiv = function (container) {\n            var closeButtonFloat;\n            var headerDivMargin;\n            var closeButtonMargin;\n            if (!_this.isRtl) {\n                closeButtonFloat = 'float:right;';\n                headerDivMargin = 'margin-left:5.5px;';\n                closeButtonMargin = 'margin-right:7px;';\n            }\n            else {\n                closeButtonFloat = 'float:left;';\n                headerDivMargin = 'margin-right:5.5px;';\n                closeButtonMargin = 'margin-left:7px;';\n            }\n            var headerDiv = createElement('div', {\n                id: _this.elementId + 'toc_id',\n                styles: 'display: block;'\n            });\n            container.appendChild(headerDiv);\n            _this.element.appendChild(container);\n            var title = createElement('label', {\n                className: 'e-de-ctnr-prop-label'\n            });\n            title.textContent = _this.localObj.getConstant('Table of Contents');\n            headerDiv.appendChild(title);\n            _this.closeButton = createElement('span', {\n                className: 'e-de-ctnr-close e-icons',\n                styles: 'cursor: pointer;display:inline-block;color: #4A4A4A;' + closeButtonFloat + closeButtonMargin\n            });\n            headerDiv.appendChild(_this.closeButton);\n        };\n        this.initTemplates = function (container) {\n            _this.template1(container);\n            // tslint:disable-next-line:max-line-length\n            // let div: HTMLElement = createElement('div', { styles: 'display:block;border-top: 1px solid #E0E0E0;' }); this.element.appendChild(div);\n        };\n        this.template1 = function (container) {\n            _this.template1Div = createElement('div', {\n                className: 'e-de-toc-template1'\n            });\n            if (_this.isRtl) {\n                _this.template1Div.classList.add('e-de-rtl');\n            }\n            container.appendChild(_this.template1Div);\n            var templateContent1 = createElement('div', {\n                className: 'e-de-toc-template1-content1'\n            });\n            templateContent1.textContent = _this.localObj.getConstant('HEADING - - - - 1');\n            _this.template1Div.appendChild(templateContent1);\n            var templateContent2 = createElement('div', {\n                className: 'e-de-toc-template1-content2'\n            });\n            templateContent2.textContent = _this.localObj.getConstant('HEADING - - - - 2');\n            _this.template1Div.appendChild(templateContent2);\n            var templateContent3 = createElement('div', {\n                className: 'e-de-toc-template1-content3'\n            });\n            templateContent3.textContent = _this.localObj.getConstant('HEADING - - - - 3');\n            _this.template1Div.appendChild(templateContent3);\n        };\n        this.tocOptionsDiv = function (container) {\n            var optionsDiv = createElement('div');\n            container.appendChild(optionsDiv);\n            _this.element.appendChild(container);\n            if (_this.isRtl) {\n                optionsDiv.classList.add('e-de-rtl');\n            }\n            var label = createElement('label', { className: 'e-de-ctnr-prop-label' });\n            label.textContent = _this.localObj.getConstant('Options');\n            optionsDiv.appendChild(label);\n        };\n        /* tslint:disable */\n        this.contentStylesDropdown = function (container) {\n            var contentStyleElementMargin;\n            if (!_this.isRtl) {\n                contentStyleElementMargin = 'margin-left:5.5px;';\n            }\n            else {\n                contentStyleElementMargin = 'margin-right:5.5px;';\n            }\n            var contentStyleElement = createElement('div', { id: 'contentstyle_div' });\n            // tslint:disable-next-line:max-line-length\n            contentStyleElement.setAttribute('title', _this.localObj.getConstant('Number of heading or outline levels to be shown in table of contents.'));\n            container.appendChild(contentStyleElement);\n            // let items: ItemModel[] = [{ text: '___________', id: 'solid' }];\n            // this.borderStyle = this.createDropDownButton(\n            //     this.elementId + '_borderStyleDiv',\n            //     'width:120px;height:28px;margin-top:8px', contentStyleElement, 'e-de-icon-stroke-size', 'Solid', items\n            // );\n            var labelMargin;\n            if (!_this.isRtl) {\n                labelMargin = 'margin-right:8px;';\n            }\n            else {\n                labelMargin = 'margin-left:8px';\n            }\n            var label = createElement('label', { className: 'e-de-prop-sub-label', styles: 'display:block' });\n            label.textContent = _this.localObj.getConstant('Levels');\n            contentStyleElement.appendChild(label);\n            container.appendChild(contentStyleElement);\n            var dataSource = ['1', '2', '3', '4', '5', '6', '7', '8', '9'];\n            _this.borderLevelStyle = _this.createDropDownButton(_this.elementId + '_borderLevelDiv', contentStyleElement, '', dataSource, 2);\n            _this.borderLevelStyle.change = function (args) {\n                _this.borderLevelStyle.value = args.item.value;\n            };\n            container.appendChild(contentStyleElement);\n        };\n        this.checkboxContent = function (container) {\n            var checkboxElementMargin;\n            if (!_this.isRtl) {\n                checkboxElementMargin = 'margin-left:5.5px;';\n            }\n            else {\n                checkboxElementMargin = 'margin-right:5.5px;';\n            }\n            // tslint:disable-next-line:max-line-length\n            var checkboxElement = createElement('div', { id: 'toc_checkboxDiv', styles: 'margin-bottom:20px;' });\n            container.appendChild(checkboxElement);\n            var showPageNumberDiv = createElement('div', { className: 'e-de-toc-checkbox1' });\n            showPageNumberDiv.setAttribute('title', _this.localObj.getConstant('Show page numbers in table of contents.'));\n            checkboxElement.appendChild(showPageNumberDiv);\n            // tslint:disable-next-line:max-line-length\n            var showpagenumberCheckboxElement = createElement('input', { id: 'showpagenumber', styles: 'width:12px;height:12px;margin-bottom:8px', className: 'e-de-prop-sub-label' });\n            showPageNumberDiv.appendChild(showpagenumberCheckboxElement);\n            _this.showPageNumber = new CheckBox({\n                label: _this.localObj.getConstant('Show page numbers'),\n                enableRtl: _this.isRtl\n            });\n            _this.showPageNumber.appendTo(showpagenumberCheckboxElement);\n            var rightAlignDiv = createElement('div', { className: 'e-de-toc-checkbox2' });\n            rightAlignDiv.setAttribute('title', _this.localObj.getConstant('Right align page numbers in table of contents.'));\n            checkboxElement.appendChild(rightAlignDiv);\n            // tslint:disable-next-line:max-line-length\n            var rightalignpagenumberCheckboxElement = createElement('input', { id: 'rightalignpagenumber', styles: 'width:12px;height:12px', className: 'e-de-prop-sub-label' });\n            rightAlignDiv.appendChild(rightalignpagenumberCheckboxElement);\n            _this.rightalignPageNumber = new CheckBox({\n                label: _this.localObj.getConstant('Right align page numbers'),\n                enableRtl: _this.isRtl\n            });\n            _this.rightalignPageNumber.appendTo(rightalignpagenumberCheckboxElement);\n            var hyperlinkDiv = createElement('div', { className: 'e-de-toc-checkbox3' });\n            hyperlinkDiv.setAttribute('title', _this.localObj.getConstant('Use hyperlinks instead of page numbers.'));\n            checkboxElement.appendChild(hyperlinkDiv);\n            // tslint:disable-next-line:max-line-length\n            var hyperlinkCheckboxElement = createElement('input', { id: 'hyperlinkdiv', styles: 'width:12px;height:12px', className: 'e-de-prop-sub-label' });\n            hyperlinkDiv.appendChild(hyperlinkCheckboxElement);\n            _this.hyperlink = new CheckBox({\n                label: _this.localObj.getConstant('Use hyperlinks'),\n                enableRtl: _this.isRtl\n            });\n            _this.hyperlink.appendTo(hyperlinkCheckboxElement);\n        };\n        this.buttonDiv = function (container) {\n            var footerElementFloat;\n            if (!_this.isRtl) {\n                footerElementFloat = 'float:right';\n            }\n            else {\n                footerElementFloat = 'float:left';\n            }\n            var footerElement = createElement('div', { id: 'footerDiv', styles: footerElementFloat });\n            container.appendChild(footerElement);\n            var updatebuttoncontentStyleElement = createElement('button', { id: 'footerupdatebuttonDiv' });\n            footerElement.appendChild(updatebuttoncontentStyleElement);\n            _this.updateBtn = new Button({\n                content: _this.localObj.getConstant('Update'), cssClass: 'btn-update', isPrimary: true\n            });\n            _this.updateBtn.appendTo(updatebuttoncontentStyleElement);\n            var cancelbuttoncontentStyleElement = createElement('button', { id: 'footercancelbuttonDiv' });\n            footerElement.appendChild(cancelbuttoncontentStyleElement);\n            _this.cancelBtn = new Button({\n                content: _this.localObj.getConstant('Cancel'), cssClass: _this.isRtl ? 'e-de-btn-cancel-rtl' : 'e-de-btn-cancel'\n            });\n            _this.cancelBtn.appendTo(cancelbuttoncontentStyleElement);\n        };\n        this.showTocPane = function (isShow, previousContextType) {\n            if (!isShow && _this.element.style.display === 'none' || (isShow && _this.element.style.display === 'block')) {\n                return;\n            }\n            _this.element.style.display = isShow ? 'block' : 'none';\n            // tslint:disable-next-line:max-line-length\n            _this.updateBtn.content = _this.documentEditor.selection.contextType === 'TableOfContents' ? _this.localObj.getConstant('Update') : _this.localObj.getConstant('Insert');\n            _this.prevContext = _this.documentEditor.selection.contextType;\n            _this.documentEditor.resize();\n            if (isShow) {\n                _this.updateBtn.element.focus();\n            }\n        };\n        this.onInsertToc = function () {\n            // tslint:disable-next-line:max-line-length\n            var tocSettings = {\n                startLevel: 1,\n                endLevel: parseInt(_this.borderLevelStyle.value, 0),\n                includeHyperlink: _this.hyperlink.checked,\n                includePageNumber: _this.showPageNumber.checked,\n                rightAlign: _this.rightalignPageNumber.checked\n            };\n            _this.documentEditor.editor.insertTableOfContents(tocSettings);\n        };\n        this.container = container;\n        this.elementId = this.documentEditor.element.id;\n        this.isRtl = isRtl;\n        this.initializeTocPane();\n    }\n    Object.defineProperty(TocProperties.prototype, \"documentEditor\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.container.documentEditor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TocProperties.prototype, \"toolbar\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.container.toolbarModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /* tslint:disable */\n    TocProperties.prototype.createDropdownOption = function (ulTag, text) {\n        var liTag = createElement('li', {\n            styles: 'display:block',\n            className: 'e-de-floating-menuitem e-de-floating-menuitem-md de-list-items  de-list-item-size'\n        });\n        ulTag.appendChild(liTag);\n        var innerHTML;\n        if (text === 'None') {\n            innerHTML = '<div>' + text + '</div>';\n        }\n        else if (text === '1.5px') {\n            // tslint:disable-next-line:max-line-length\n            innerHTML = '<div>' + text + '<span class=\"e-de-list-line\" style=\"margin-left:10px;border-bottom-width:' + text + '\"></span></div>';\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            innerHTML = '<div>' + text + '<span class=\"e-de-list-line\" style=\"margin-left:20px;border-bottom-width:' + text + '\"></span></div>';\n        }\n        var liInnerDiv = createElement('div', {\n            className: 'e-de-list-header-presetmenu',\n            innerHTML: innerHTML\n        });\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    // tslint:disable-next-line:max-line-length\n    TocProperties.prototype.createDropDownButton = function (id, parentDiv, iconCss, content, selectedIndex) {\n        var buttonElement = createElement('input', { id: id });\n        parentDiv.appendChild(buttonElement);\n        // tslint:disable-next-line:max-line-length  \n        var dropDownBtn = new DropDownList({ index: selectedIndex, dataSource: content, popupHeight: '150px', cssClass: 'e-de-prop-font-button' }, buttonElement);\n        return dropDownBtn;\n    };\n    TocProperties.prototype.destroy = function () {\n        this.container = undefined;\n        if (this.showPageNumber) {\n            this.showPageNumber.destroy();\n            this.showPageNumber = undefined;\n        }\n        if (this.rightalignPageNumber) {\n            this.rightalignPageNumber.destroy();\n            this.rightalignPageNumber = undefined;\n        }\n        if (this.borderBtn) {\n            this.borderBtn.destroy();\n            this.borderBtn = undefined;\n        }\n        if (this.borderLevelStyle) {\n            this.borderLevelStyle.destroy();\n            this.borderLevelStyle = undefined;\n        }\n    };\n    return TocProperties;\n}());\nexport { TocProperties };\n","import { createElement, classList, L10n } from '@syncfusion/ej2-base';\nimport { Tab } from '@syncfusion/ej2-navigations';\nimport { TextProperties } from './text-properties-pane';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { NumericTextBox, ColorPicker } from '@syncfusion/ej2-inputs';\n/**\n * Represents table properties\n * @private\n */\nvar TableProperties = /** @class */ (function () {\n    function TableProperties(container, imageProperty, textProperties, isRtl) {\n        var _this = this;\n        this.isTopMarginApply = false;\n        this.isRightMarginApply = false;\n        this.isBottomMarginApply = false;\n        this.isLeftMarginApply = false;\n        this.borderColor = '#000000';\n        this.groupButtonClass = 'e-de-ctnr-group-btn e-btn-group';\n        this.initializeTablePropPane = function () {\n            _this.localObj = new L10n('documenteditorcontainer', _this.container.defaultLocale, _this.container.locale);\n            _this.tableProperties = createElement('div', { id: _this.elementId + '_tableProperties' });\n            _this.initFillColorDiv();\n            _this.initBorderStylesDiv();\n            _this.initCellDiv();\n            _this.initInsertOrDelCell();\n            _this.initCellMargin();\n            _this.initAlignText();\n            _this.addTablePropertyTab();\n            // wire fnt property\n            _this.wireEvent();\n        };\n        this.addTablePropertyTab = function () {\n            // tslint:disable-next-line:max-line-length\n            _this.parentElement = createElement('div', { styles: 'height:100%;overflow:auto;display:none', className: 'e-de-prop-pane' });\n            _this.element = createElement('div', { id: _this.elementId + '_propertyTabDiv', className: 'e-de-property-tab' });\n            // tslint:disable-next-line:max-line-length\n            var items = [{ header: { text: _this.localObj.getConstant('Table') }, content: _this.tableProperties }, { header: { text: _this.localObj.getConstant('Text') }, content: _this.tableTextProperties.element }];\n            _this.propertiesTab = new Tab({ items: items, animation: { previous: { effect: 'None' }, next: { effect: 'None' } }, selected: _this.onTabSelection }, _this.element);\n            _this.parentElement.appendChild(_this.element);\n            _this.container.propertiesPaneContainer.appendChild(_this.parentElement);\n        };\n        this.onTabSelection = function () {\n            _this.documentEditor.resize();\n        };\n        this.wireEvent = function () {\n            _this.shadingBtn.addEventListener('change', _this.changeBackgroundColor);\n            // tslint:disable-next-line:max-line-length\n            _this.borderBtn.addEventListener('change', function (args) { setTimeout(function () { _this.borderColor = args.currentValue.hex; _this.tableOutlineBorder.element.focus(); }, 10); });\n            _this.tableOutlineBorder.element.addEventListener('click', _this.onOutlineBorder);\n            _this.tableAllBorder.element.addEventListener('click', _this.onAllBorder);\n            _this.tableCenterBorder.element.addEventListener('click', _this.onInsideBorder);\n            _this.tableLeftBorder.element.addEventListener('click', _this.onLeftBorder);\n            _this.tableCenterVerticalBorder.element.addEventListener('click', _this.onVerticalBorder);\n            _this.tableRightBorder.element.addEventListener('click', _this.onRightBorder);\n            _this.tableTopBorder.element.addEventListener('click', _this.onTopBorder);\n            _this.tableCenterHorizontalBorder.element.addEventListener('click', _this.onHorizontalBorder);\n            _this.tableBottomBorder.element.addEventListener('click', _this.onBottomBorder);\n            _this.insertRowAbove.element.addEventListener('click', _this.onInsertRowAbove);\n            _this.insertRowBelow.element.addEventListener('click', _this.onInsertRowBelow);\n            _this.insertColumnLeft.element.addEventListener('click', _this.onInsertColumnLeft);\n            _this.insertColumnRight.element.addEventListener('click', _this.onInsertColumnRight);\n            _this.deleteRow.element.addEventListener('click', _this.onDeleteRow);\n            _this.deleteColumn.element.addEventListener('click', _this.onDeleteColumn);\n            _this.horizontalMerge.element.addEventListener('click', _this.onMergeCell);\n            _this.alignTop.element.addEventListener('click', _this.applyAlignTop);\n            _this.alignBottom.element.addEventListener('click', _this.applyAlignBottom);\n            _this.alignCenterHorizontal.element.addEventListener('click', _this.applyAlignCenterHorizontal);\n            _this.topMargin.element.addEventListener('click', function () { _this.isTopMarginApply = true; });\n            _this.rightMargin.element.addEventListener('click', function () { _this.isRightMarginApply = true; });\n            _this.leftMargin.element.addEventListener('click', function () { _this.isLeftMarginApply = true; });\n            _this.bottomMargin.element.addEventListener('click', function () { _this.isBottomMarginApply = true; });\n            _this.topMargin.element.addEventListener('keydown', _this.onTopMargin);\n            _this.rightMargin.element.addEventListener('keydown', _this.onRightMargin);\n            _this.leftMargin.element.addEventListener('keydown', _this.onLeftMargin);\n            _this.bottomMargin.element.addEventListener('keydown', _this.onBottomMargin);\n            _this.topMargin.element.addEventListener('blur', function () { _this.applyTopMargin(); _this.isTopMarginApply = false; });\n            _this.rightMargin.element.addEventListener('blur', function () { _this.applyRightMargin(); _this.isRightMarginApply = false; });\n            _this.leftMargin.element.addEventListener('blur', function () { _this.applyLeftMargin(); _this.isLeftMarginApply = false; });\n            _this.bottomMargin.element.addEventListener('blur', function () { _this.applyBottomMargin(); _this.isBottomMarginApply = false; });\n        };\n        this.getBorder = function (border) {\n            var lineWidth = (_this.borderSize.content.indexOf('No Border') >= 0) ? 0 : parseInt(_this.borderSize.content, 0);\n            var linestyle = (lineWidth === 0) ? 'Cleared' : 'Single';\n            var borderSettings = {\n                type: border,\n                borderColor: _this.borderColor,\n                lineWidth: lineWidth,\n                borderStyle: linestyle\n            };\n            return borderSettings;\n        };\n        this.onOutlineBorder = function () {\n            _this.documentEditor.editor.applyBorders(_this.getBorder('OutsideBorders'));\n        };\n        this.onAllBorder = function () {\n            _this.documentEditor.editor.applyBorders(_this.getBorder('AllBorders'));\n        };\n        this.onInsideBorder = function () {\n            _this.documentEditor.editor.applyBorders(_this.getBorder('InsideBorders'));\n        };\n        this.onLeftBorder = function () {\n            _this.documentEditor.editor.applyBorders(_this.getBorder('LeftBorder'));\n        };\n        this.onVerticalBorder = function () {\n            _this.documentEditor.editor.applyBorders(_this.getBorder('InsideVerticalBorder'));\n        };\n        this.onRightBorder = function () {\n            _this.documentEditor.editor.applyBorders(_this.getBorder('RightBorder'));\n        };\n        this.onTopBorder = function () {\n            _this.documentEditor.editor.applyBorders(_this.getBorder('TopBorder'));\n        };\n        this.onHorizontalBorder = function () {\n            _this.documentEditor.editor.applyBorders(_this.getBorder('InsideHorizontalBorder'));\n        };\n        this.onBottomBorder = function () {\n            _this.documentEditor.editor.applyBorders(_this.getBorder('BottomBorder'));\n        };\n        this.onTopMargin = function (e) {\n            if (e.keyCode === 13) {\n                setTimeout(function () { _this.applyTopMargin(); _this.isTopMarginApply = false; }, 30);\n            }\n        };\n        this.onBottomMargin = function (e) {\n            if (e.keyCode === 13) {\n                setTimeout(function () { _this.applyBottomMargin(); _this.isBottomMarginApply = false; }, 30);\n            }\n        };\n        this.onLeftMargin = function (e) {\n            if (e.keyCode === 13) {\n                setTimeout(function () { _this.applyLeftMargin(); _this.isLeftMarginApply = false; }, 30);\n            }\n        };\n        this.onRightMargin = function (e) {\n            if (e.keyCode === 13) {\n                setTimeout(function () { _this.applyRightMargin(); _this.isRightMarginApply = false; }, 30);\n            }\n        };\n        this.applyTopMargin = function () {\n            if (!_this.isTopMarginApply) {\n                return;\n            }\n            _this.documentEditor.selection.cellFormat.topMargin = (_this.topMargin.value > _this.topMargin.max)\n                ? _this.topMargin.max : _this.topMargin.value;\n        };\n        this.applyBottomMargin = function () {\n            if (!_this.isBottomMarginApply) {\n                return;\n            }\n            _this.documentEditor.selection.cellFormat.bottomMargin = (_this.bottomMargin.value > _this.bottomMargin.max)\n                ? _this.bottomMargin.max : _this.bottomMargin.value;\n        };\n        this.applyLeftMargin = function () {\n            if (!_this.isLeftMarginApply) {\n                return;\n            }\n            _this.documentEditor.selection.cellFormat.leftMargin = (_this.leftMargin.value > _this.leftMargin.max)\n                ? _this.leftMargin.max : _this.leftMargin.value;\n        };\n        this.applyRightMargin = function () {\n            if (!_this.isRightMarginApply) {\n                return;\n            }\n            _this.documentEditor.selection.cellFormat.rightMargin = (_this.rightMargin.value > _this.rightMargin.max)\n                ? _this.rightMargin.max : _this.rightMargin.value;\n        };\n        this.applyAlignTop = function () {\n            _this.documentEditor.selection.cellFormat.verticalAlignment = 'Top';\n        };\n        this.applyAlignBottom = function () {\n            _this.documentEditor.selection.cellFormat.verticalAlignment = 'Bottom';\n        };\n        this.applyAlignCenterHorizontal = function () {\n            _this.documentEditor.selection.cellFormat.verticalAlignment = 'Center';\n        };\n        this.onMergeCell = function () {\n            _this.documentEditor.editor.mergeCells();\n        };\n        this.onInsertRowAbove = function () {\n            _this.documentEditor.editor.insertRow(true);\n        };\n        this.onInsertRowBelow = function () {\n            _this.documentEditor.editor.insertRow(false);\n        };\n        this.onInsertColumnLeft = function () {\n            _this.documentEditor.editor.insertColumn(true);\n        };\n        this.onInsertColumnRight = function () {\n            _this.documentEditor.editor.insertColumn(false);\n        };\n        this.onDeleteRow = function () {\n            _this.documentEditor.editor.deleteRow();\n        };\n        this.onDeleteColumn = function () {\n            _this.documentEditor.editor.deleteColumn();\n        };\n        this.onSelectionChange = function () {\n            if (_this.documentEditor.selection) {\n                if (_this.documentEditor.editor && _this.documentEditor.editor.canMergeCells()) {\n                    _this.horizontalMerge.disabled = false;\n                }\n                else {\n                    _this.horizontalMerge.disabled = true;\n                }\n                if (_this.documentEditor.selection.contextType === 'TableText' || _this.documentEditor.selection.contextType === 'TableImage') {\n                    _this.shadingBtn.value = _this.documentEditor.selection.cellFormat.background;\n                }\n                // tslint:disable-next-line:max-line-length\n                _this.topMargin.value = _this.documentEditor.selection.cellFormat.topMargin ? _this.documentEditor.selection.cellFormat.topMargin : 0;\n                // tslint:disable-next-line:max-line-length\n                _this.bottomMargin.value = _this.documentEditor.selection.cellFormat.bottomMargin ? _this.documentEditor.selection.cellFormat.bottomMargin : 0;\n                // tslint:disable-next-line:max-line-length\n                _this.rightMargin.value = _this.documentEditor.selection.cellFormat.rightMargin ? _this.documentEditor.selection.cellFormat.rightMargin : 0;\n                // tslint:disable-next-line:max-line-length\n                _this.leftMargin.value = _this.documentEditor.selection.cellFormat.leftMargin ? _this.documentEditor.selection.cellFormat.leftMargin : 0;\n            }\n        };\n        this.changeBackgroundColor = function (args) {\n            if (!_this.documentEditor.isReadOnly) {\n                //Handle API for shading.\n                _this.documentEditor.selection.cellFormat.background = args.currentValue.hex;\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 10);\n            }\n        };\n        this.initFillColorDiv = function () {\n            // tslint:disable-next-line:max-line-length\n            var fillDiv = createElement('div', { id: _this.elementId + '_fillColorDiv', className: 'e-de-property-div-padding de-tbl-fill-clr' });\n            _this.tableProperties.appendChild(fillDiv);\n            var label = createElement('label', { className: 'e-de-prop-sub-label' });\n            label.classList.add('e-de-prop-fill-label');\n            if (_this.isRtl) {\n                label.classList.add('e-de-rtl');\n            }\n            label.textContent = _this.localObj.getConstant('Fill');\n            fillDiv.appendChild(label);\n            var buttonStyle = 'width:92px;display:inline-flex;padding:3px';\n            // tslint:disable-next-line:max-line-length\n            _this.shadingBtn = _this.createColorPickerTemplate(_this.elementId + '_tableShading', fillDiv, _this.localObj.getConstant('Fill color'), false);\n            // tslint:disable-next-line:max-line-length\n            classList(fillDiv.lastElementChild.lastElementChild.lastElementChild.firstChild, ['e-de-ctnr-cellbg-clr-picker'], ['e-caret']);\n        };\n        this.initBorderStylesDiv = function () {\n            var borderStyleDiv = createElement('div', { className: 'e-de-property-div-padding' });\n            _this.tableProperties.appendChild(borderStyleDiv);\n            var label = createElement('label', { className: 'e-de-ctnr-prop-label' });\n            label.classList.add('e-de-table-prop-label');\n            label.textContent = _this.localObj.getConstant('Border Style');\n            borderStyleDiv.appendChild(label);\n            // tslint:disable-next-line:max-line-length\n            var parentDiv = createElement('div', { id: _this.elementId + '_borderStyleDiv', className: 'e-de-border-style-div', styles: 'display:inline-flex;' });\n            var styleDiv = createElement('div', { styles: 'width:126px;height:126px', className: 'e-de-grp-btn-ctnr' });\n            var div1 = createElement('div', { className: _this.groupButtonClass + ' e-de-ctnr-group-btn-top' });\n            styleDiv.appendChild(div1);\n            var div2 = createElement('div', { className: _this.groupButtonClass + ' e-de-ctnr-group-btn-middle' });\n            styleDiv.appendChild(div2);\n            var div3 = createElement('div', { className: _this.groupButtonClass + ' e-de-ctnr-group-btn-bottom' });\n            styleDiv.appendChild(div3);\n            if (_this.isRtl) {\n                div1.classList.add('e-de-rtl');\n                div3.classList.add('e-de-rtl');\n                parentDiv.classList.add('e-de-rtl');\n                label.classList.add('e-de-rtl');\n            }\n            var btnStyle = '';\n            // tslint:disable-next-line:max-line-length\n            _this.tableOutlineBorder = _this.createButtonTemplate(_this.elementId + '_tableOutlineBorder', 'e-de-ctnr-outsideborder e-icons', div1, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Outside borders'));\n            _this.tableAllBorder = _this.createButtonTemplate(_this.elementId + '_tableAllBorder', 'e-de-ctnr-allborders e-icons', div1, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('All borders'));\n            // tslint:disable-next-line:max-line-length\n            _this.tableCenterBorder = _this.createButtonTemplate(_this.elementId + '_tableCenterBorder', 'e-de-ctnr-insideborders e-icons', div1, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Inside borders'));\n            _this.tableLeftBorder = _this.createButtonTemplate(_this.elementId + '_tableLeftBorder', 'e-de-ctnr-leftborders e-icons', div2, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Left border'));\n            // tslint:disable-next-line:max-line-length\n            _this.tableCenterVerticalBorder = _this.createButtonTemplate(_this.elementId + '_tableCenterVBorder', 'e-de-ctnr-insideverticalborder e-icons', div2, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Inside vertical border'));\n            _this.tableRightBorder = _this.createButtonTemplate(_this.elementId + '_tableRightBorder', 'e-de-ctnr-rightborder e-icons', div2, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Right border'));\n            // tslint:disable-next-line:max-line-length\n            _this.tableTopBorder = _this.createButtonTemplate(_this.elementId + '_tableTopBorder', 'e-de-ctnr-topborder e-icons', div3, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Top border'));\n            _this.tableCenterHorizontalBorder = _this.createButtonTemplate(_this.elementId + '_tableCenterHBorder', 'e-de-ctnr-insidehorizondalborder e-icons', div3, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Inside horizontal border'));\n            // tslint:disable-next-line:max-line-length\n            _this.tableBottomBorder = _this.createButtonTemplate(_this.elementId + '_tableBottomBorder', 'e-de-ctnr-bottomborder e-icons', div3, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Bottom border'));\n            parentDiv.appendChild(styleDiv);\n            // tslint:disable-next-line:max-line-length\n            var styleTypeDiv = createElement('div', { className: 'de-tbl-fill-clr' });\n            if (!_this.isRtl) {\n                styleTypeDiv.classList.add('e-de-stylediv');\n            }\n            else {\n                styleTypeDiv.classList.add('e-de-stylediv-rtl');\n            }\n            // tslint:disable-next-line:max-line-length\n            _this.borderBtn = _this.createColorPickerTemplate(_this.elementId + '_tableBorderColor', styleTypeDiv, _this.localObj.getConstant('Border color'), true);\n            _this.borderBtn.value = '#000000';\n            styleTypeDiv.firstElementChild.lastElementChild.lastElementChild.style.width = '30px';\n            styleTypeDiv.firstElementChild.lastElementChild.firstElementChild.firstElementChild.style.width = '100%';\n            // tslint:disable-next-line:max-line-length\n            classList(styleTypeDiv.lastElementChild.lastElementChild.lastElementChild.firstChild, ['e-de-ctnr-highlightcolor'], ['e-caret']);\n            var borderSizeButton = createElement('button', { id: _this.elementId + '_tableBorderSize', className: 'e-de-border-size-button', styles: 'font-size:10px;padding:0px;' });\n            styleTypeDiv.appendChild(borderSizeButton);\n            _this.borderSize = _this.createBorderSizeDropDown('e-de-ctnr-strokesize e-icons', borderSizeButton);\n            parentDiv.appendChild(styleTypeDiv);\n            _this.borderSizeColorElement = document.getElementsByClassName('e-de-border-width');\n            borderStyleDiv.appendChild(parentDiv);\n        };\n        this.initCellDiv = function () {\n            var cellDiv = createElement('div', { className: 'e-de-property-div-padding' });\n            _this.tableProperties.appendChild(cellDiv);\n            var label = createElement('label', { className: 'e-de-ctnr-prop-label' });\n            label.classList.add('e-de-table-prop-label');\n            label.textContent = _this.localObj.getConstant('Cell');\n            cellDiv.appendChild(label);\n            var parentDiv = createElement('div', { className: 'e-de-ctnr-group-btn' });\n            parentDiv.classList.add('e-de-cell-div');\n            if (_this.isRtl) {\n                parentDiv.classList.add('e-de-rtl');\n                label.classList.add('e-de-rtl');\n            }\n            var btnStyle = 'width:' + 38 + 'px;';\n            // tslint:disable-next-line:max-line-length\n            _this.horizontalMerge = _this.createButtonTemplate(_this.elementId + '_tableOutlineBorder', 'e-de-ctnr-mergecell e-icons', parentDiv, 'e-de-prop-font-button', btnStyle, 'Merge cells');\n            //this.verticalMerge = this.createButtonTemplate(this.elementId + '_tableAllBorder', 'e-de-icon-merge-column e-icons', parentDiv, 'e-de-prop-font-button', btnStyle, 'Vertical Merge');\n            cellDiv.appendChild(parentDiv);\n        };\n        this.initInsertOrDelCell = function () {\n            var tableOperationDiv = createElement('div', { className: 'e-de-property-div-padding' });\n            _this.tableProperties.appendChild(tableOperationDiv);\n            var label = createElement('label', { className: 'e-de-ctnr-prop-label' });\n            label.classList.add('e-de-table-prop-label');\n            label.textContent = _this.localObj.getConstant('Insert / Delete');\n            tableOperationDiv.appendChild(label);\n            var parentDiv = createElement('div', { className: 'e-de-insert-del-cell', styles: 'display:inline-flex' });\n            var div1 = createElement('div', { className: _this.groupButtonClass });\n            parentDiv.appendChild(div1);\n            var div2 = createElement('div', { className: _this.groupButtonClass });\n            if (!_this.isRtl) {\n                div2.style.marginLeft = '12px';\n            }\n            else {\n                div2.style.marginRight = '12px';\n                parentDiv.classList.add('e-de-rtl');\n                label.classList.add('e-de-rtl');\n            }\n            parentDiv.appendChild(div2);\n            var btnStyle = 'width:' + 38 + 'px;';\n            // tslint:disable-next-line:max-line-length\n            _this.insertColumnLeft = _this.createButtonTemplate(_this.elementId + '_insertColumnLeft', 'e-de-ctnr-insertleft e-icons', div1, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Insert columns to the left'));\n            _this.insertColumnRight = _this.createButtonTemplate(_this.elementId + '_insertColumnRight', 'e-de-ctnr-insertright e-icons', div1, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Insert columns to the right'));\n            // tslint:disable-next-line:max-line-length\n            _this.insertRowAbove = _this.createButtonTemplate(_this.elementId + '_insertRowAbove', 'e-de-ctnr-insertabove e-icons', div1, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Insert rows above'));\n            _this.insertRowBelow = _this.createButtonTemplate(_this.elementId + '_insertRowBelow', 'e-de-ctnr-insertbelow e-icons', div1, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Insert rows below'));\n            // tslint:disable-next-line:max-line-length\n            _this.deleteRow = _this.createButtonTemplate(_this.elementId + '_deleteRow', 'e-de-ctnr-deleterows e-icons', div2, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Delete rows'));\n            _this.deleteColumn = _this.createButtonTemplate(_this.elementId + '_deleteColumn', 'e-de-ctnr-deletecolumns e-icons', div2, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Delete columns'));\n            tableOperationDiv.appendChild(parentDiv);\n        };\n        this.initCellMargin = function () {\n            var cellMarginDiv = createElement('div', { className: 'e-de-property-div-padding e-de-cellmargin-text' });\n            _this.tableProperties.appendChild(cellMarginDiv);\n            var label = createElement('label', { className: 'e-de-ctnr-prop-label' });\n            label.classList.add('e-de-table-prop-label');\n            label.textContent = _this.localObj.getConstant('Cell Margin');\n            cellMarginDiv.appendChild(label);\n            var parentDiv = createElement('div', { className: 'e-de-cell-margin', styles: 'height: 60px;display:inline-flex' });\n            if (_this.isRtl) {\n                label.classList.add('e-de-rtl');\n            }\n            var textboxDivStyle = 'width:' + 48 + 'px';\n            var textboxParentDivStyle = 'width:' + 50 + 'px;float:left;';\n            // tslint:disable-next-line:max-line-length\n            _this.topMargin = _this.createCellMarginTextBox(_this.localObj.getConstant('Top'), _this.elementId + '_topMargin', parentDiv, textboxDivStyle, textboxParentDivStyle, 500, 'Top margin');\n            // tslint:disable-next-line:max-line-length\n            _this.bottomMargin = _this.createCellMarginTextBox(_this.localObj.getConstant('Bottom'), _this.elementId + '_bottomMargin', parentDiv, textboxDivStyle, textboxParentDivStyle, 500, 'Bottom margin');\n            // tslint:disable-next-line:max-line-length\n            _this.leftMargin = _this.createCellMarginTextBox(_this.localObj.getConstant('Left'), _this.elementId + '_leftMargin', parentDiv, textboxDivStyle, textboxParentDivStyle, 500, 'Left margin');\n            // tslint:disable-next-line:max-line-length\n            _this.rightMargin = _this.createCellMarginTextBox(_this.localObj.getConstant('Right'), _this.elementId + '_rightMargin', parentDiv, textboxDivStyle, textboxParentDivStyle, 500, 'Right margin');\n            cellMarginDiv.appendChild(parentDiv);\n        };\n        this.initAlignText = function () {\n            var alignmentDiv = createElement('div', { className: 'e-de-property-div-padding', styles: 'border-bottom-width:0px' });\n            _this.tableProperties.appendChild(alignmentDiv);\n            var label = createElement('label', { className: 'e-de-ctnr-prop-label' });\n            label.classList.add('e-de-table-prop-label');\n            label.textContent = _this.localObj.getConstant('Align Text');\n            alignmentDiv.appendChild(label);\n            var parentDiv = createElement('div', { className: 'e-de-align-text', styles: 'margin-bottom: 10px;' });\n            if (_this.isRtl) {\n                parentDiv.classList.add('e-de-rtl');\n                label.classList.add('e-de-rtl');\n            }\n            var div = createElement('div', { className: _this.groupButtonClass });\n            parentDiv.appendChild(div);\n            var btnStyle = 'width:' + 38 + 'px;';\n            // tslint:disable-next-line:max-line-length\n            _this.alignTop = _this.createButtonTemplate(_this.elementId + '_alignTop', 'e-de-ctnr-aligntop e-icons', div, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Align top'));\n            // tslint:disable-next-line:max-line-length\n            // this.alignCenterVertical = this.createButtonTemplate(this.elementId + '_alignCenterVertical', 'e-de-icon-merge-column e-icons', parentDiv, 'e-de-prop-font-button', btnStyle, 'Align Center Vertical');\n            // tslint:disable-next-line:max-line-length\n            // this.alignRight = this.createButtonTemplate(this.elementId + '_alignRight', 'e-de-icon-merge-column e-icons', parentDiv, 'e-de-prop-font-button', btnStyle, 'Align Right');\n            _this.alignBottom = _this.createButtonTemplate(_this.elementId + '_alignBottom', 'e-de-ctnr-alignbottom e-icons', div, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Align bottom'));\n            // tslint:disable-next-line:max-line-length\n            // this.alignCenterHorizontal = this.createButtonTemplate(this.elementId + '_alignCenterHorizontal', 'e-de-icon-merge-column e-icons', parentDiv, 'e-de-prop-font-button', btnStyle, 'Align Center Horizontal');\n            _this.alignCenterHorizontal = _this.createButtonTemplate(_this.elementId + '_alignCenterHorizontal', 'e-de-ctnr-aligncenter-table e-icons', div, 'e-de-prop-font-button', btnStyle, _this.localObj.getConstant('Align center'));\n            _this.alignCenterHorizontal.addEventListener('click', _this.applyAlignCenterHorizontal);\n            alignmentDiv.appendChild(parentDiv);\n        };\n        // tslint:disable-next-line:max-line-length\n        this.createCellMarginTextBox = function (textboxLabel, textboxId, parentDiv, styles, parentStyle, maxValue, toolTipText) {\n            var cellMarginParentDiv = createElement('div', { styles: parentStyle });\n            cellMarginParentDiv.classList.add('e-de-cell-text-box');\n            var cellMarginLabel = createElement('label', { className: 'e-de-prop-sub-label' });\n            cellMarginLabel.textContent = textboxLabel;\n            cellMarginParentDiv.appendChild(cellMarginLabel);\n            // tslint:disable-next-line:max-line-length\n            var cellMarginTextbox = createElement('input', { className: 'e-textbox', id: textboxId, styles: styles });\n            cellMarginParentDiv.appendChild(cellMarginTextbox);\n            // tslint:disable-next-line:max-line-length\n            var cellMarginNumericText = new NumericTextBox({ showSpinButton: false, min: 0, format: 'n0', max: maxValue, enableRtl: _this.isRtl }, cellMarginTextbox);\n            parentDiv.appendChild(cellMarginParentDiv);\n            cellMarginTextbox.setAttribute('title', toolTipText);\n            return cellMarginNumericText;\n        };\n        this.createBorderSizeDropDown = function (iconcss, button) {\n            var div = createElement('div', { id: 'borderSizeTarget', styles: 'display:none' });\n            var ulTag = createElement('ul', {\n                styles: 'display: block; outline: 0px; width: 126px; height: auto;',\n                id: 'borderSizeListMenu'\n            });\n            div.appendChild(ulTag);\n            var noneOption = _this.createDropdownOption(ulTag, _this.localObj.getConstant('No Border'));\n            noneOption.addEventListener('click', function () { _this.onBorderSizeChange('No Border'); });\n            var oneOption = _this.createDropdownOption(ulTag, '1px');\n            oneOption.addEventListener('click', function () { _this.onBorderSizeChange('1px'); });\n            var oneHalfOption = _this.createDropdownOption(ulTag, '1.5px');\n            oneHalfOption.addEventListener('click', function () { _this.onBorderSizeChange('1.5px'); });\n            var twoOption = _this.createDropdownOption(ulTag, '2px');\n            twoOption.addEventListener('click', function () { _this.onBorderSizeChange('2px'); });\n            var threeOption = _this.createDropdownOption(ulTag, '3px');\n            threeOption.addEventListener('click', function () { _this.onBorderSizeChange('3px'); });\n            var fourOption = _this.createDropdownOption(ulTag, '4px');\n            fourOption.addEventListener('click', function () { _this.onBorderSizeChange('4px'); });\n            var fiveOption = _this.createDropdownOption(ulTag, '5px');\n            fiveOption.addEventListener('click', function () { _this.onBorderSizeChange('5px'); });\n            var menuOptions = {\n                target: div,\n                iconCss: iconcss,\n                cssClass: 'e-de-prop-bordersize',\n                enableRtl: _this.isRtl,\n                content: '1.5px',\n            };\n            var dropdown = new DropDownButton(menuOptions);\n            dropdown.beforeOpen = function () {\n                div.style.display = 'block';\n                for (var i = 0; i < _this.borderSizeColorElement.length; i++) {\n                    // tslint:disable-next-line:max-line-length\n                    _this.borderSizeColorElement[i].style.borderBottomColor = _this.borderColor;\n                }\n            };\n            dropdown.beforeClose = function () { div.style.display = 'none'; };\n            dropdown.appendTo(button);\n            dropdown.element.setAttribute('title', _this.localObj.getConstant('Border width'));\n            return dropdown;\n        };\n        this.onBorderSizeChange = function (value) {\n            _this.borderSize.content = value;\n            setTimeout(function () { _this.tableOutlineBorder.element.focus(); }, 10);\n        };\n        this.createDropdownOption = function (ulTag, text) {\n            var liTag = createElement('li', {\n                styles: 'display:block',\n                className: 'e-de-floating-menuitem e-de-floating-menuitem-md e-de-list-items  e-de-list-item-size'\n            });\n            ulTag.appendChild(liTag);\n            var innerHTML;\n            if (text === 'No Border') {\n                innerHTML = '<div>' + text + '</div>';\n            }\n            else if (text === '1.5px') {\n                // tslint:disable-next-line:max-line-length\n                innerHTML = '<div>' + text + '<span class=\"e-de-list-line e-de-border-width\"  style=\"margin-left:10px;border-bottom-width:' + text + ';' + '\"' + '></span></div>';\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                innerHTML = '<div>' + text + '<span class=\"e-de-list-line e-de-border-width\" style=\"margin-left:20px;border-bottom-width:' + text + ';' + '\"' + '></span></div>';\n            }\n            var liInnerDiv = createElement('div', {\n                className: 'e-de-list-header-presetmenu',\n                innerHTML: innerHTML\n            });\n            liTag.appendChild(liInnerDiv);\n            return liTag;\n        };\n        // tslint:disable-next-line:max-line-length\n        this.createDropDownButton = function (id, styles, parentDiv, iconCss, content, items, target) {\n            var buttonElement = createElement('button', { id: id, styles: styles });\n            parentDiv.appendChild(buttonElement);\n            var splitButtonClass = 'e-de-prop-splitbutton';\n            if (_this.isRtl) {\n                splitButtonClass = 'e-rtl ' + splitButtonClass;\n            }\n            // tslint:disable-next-line:max-line-length\n            var dropDownBtn = new DropDownButton({ iconCss: iconCss, content: content, enableRtl: _this.isRtl, cssClass: splitButtonClass }, buttonElement);\n            if (items) {\n                dropDownBtn.items = items;\n            }\n            if (target) {\n                dropDownBtn.target = target;\n            }\n            return dropDownBtn;\n        };\n        this.createColorPickerTemplate = function (id, divElement, toolTipText, isBorderWidth) {\n            var inputElement = createElement('input', { id: id });\n            divElement.appendChild(inputElement);\n            var cssClass = 'e-de-prop-font-button e-de-prop-font-colorpicker';\n            if (isBorderWidth) {\n                cssClass = cssClass + ' e-de-border-clr-picker';\n            }\n            // tslint:disable-next-line:max-line-length\n            var colorPicker = new ColorPicker({ showButtons: true, cssClass: cssClass, enableRtl: _this.isRtl, locale: _this.container.locale }, inputElement);\n            inputElement.parentElement.setAttribute('title', toolTipText);\n            return colorPicker;\n        };\n        this.showTableProperties = function (isShow) {\n            if (isShow) {\n                if (_this.prevContext !== _this.documentEditor.selection.contextType) {\n                    _this.propertiesTab.selectedItem = 0;\n                    _this.tableTextProperties.appliedHighlightColor = _this.textProperties.appliedHighlightColor;\n                    _this.tableTextProperties.appliedBulletStyle = _this.textProperties.appliedBulletStyle;\n                    _this.tableTextProperties.appliedNumberingStyle = _this.textProperties.appliedNumberingStyle;\n                }\n                _this.onSelectionChange();\n                _this.tableTextProperties.onSelectionChange();\n                _this.textProperties.appliedHighlightColor = _this.tableTextProperties.appliedHighlightColor;\n                _this.textProperties.appliedBulletStyle = _this.tableTextProperties.appliedBulletStyle;\n                _this.textProperties.appliedNumberingStyle = _this.tableTextProperties.appliedNumberingStyle;\n            }\n            if (!isShow && _this.parentElement.style.display === 'none' || (isShow && _this.parentElement.style.display === 'block')) {\n                return;\n            }\n            _this.parentElement.style.display = isShow ? 'block' : 'none';\n            _this.documentEditor.resize();\n            _this.prevContext = _this.documentEditor.selection.contextType;\n        };\n        this.container = container;\n        this.isRtl = isRtl;\n        if (this.isRtl) {\n            this.groupButtonClass = 'e-rtl ' + this.groupButtonClass;\n        }\n        this.tableTextProperties = new TextProperties(container, 'textProperties', true, this.isRtl);\n        this.imageProperty = imageProperty;\n        this.elementId = this.documentEditor.element.id;\n        this.initializeTablePropPane();\n        this.prevContext = this.documentEditor.selection.contextType;\n        this.textProperties = textProperties;\n    }\n    Object.defineProperty(TableProperties.prototype, \"documentEditor\", {\n        get: function () {\n            return this.container.documentEditor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // tslint:disable-next-line:max-line-length\n    TableProperties.prototype.createButtonTemplate = function (id, iconcss, div, buttonClass, styles, toolTipText, content, iconPos) {\n        var buttonElement = createElement('Button', { id: id, styles: styles });\n        div.appendChild(buttonElement);\n        var btn = new Button({\n            cssClass: buttonClass, iconCss: iconcss, enableRtl: this.isRtl, iconPosition: (iconPos ? iconPos : 'Left'),\n            content: content ? content : ''\n        });\n        btn.appendTo(buttonElement);\n        buttonElement.setAttribute('title', toolTipText);\n        return btn;\n    };\n    TableProperties.prototype.destroy = function () {\n        this.container = undefined;\n        if (this.tableTextProperties) {\n            this.tableTextProperties.destroy();\n            this.tableTextProperties = undefined;\n        }\n        if (this.propertiesTab) {\n            this.propertiesTab.destroy();\n            this.propertiesTab = undefined;\n        }\n        if (this.shadingBtn) {\n            this.shadingBtn.destroy();\n            this.shadingBtn = undefined;\n        }\n        if (this.borderBtn) {\n            this.borderBtn.destroy();\n            this.borderBtn = undefined;\n        }\n        if (this.borderSize) {\n            this.borderSize.destroy();\n            this.borderSize = undefined;\n        }\n        if (this.topMargin) {\n            this.topMargin.destroy();\n            this.topMargin = undefined;\n        }\n        if (this.bottomMargin) {\n            this.bottomMargin.destroy();\n            this.bottomMargin = undefined;\n        }\n        if (this.leftMargin) {\n            this.leftMargin.destroy();\n            this.leftMargin = undefined;\n        }\n        if (this.rightMargin) {\n            this.rightMargin.destroy();\n            this.rightMargin = undefined;\n        }\n    };\n    return TableProperties;\n}());\nexport { TableProperties };\n","import { createElement } from '@syncfusion/ej2-base';\nimport { Text } from './text-properties';\nimport { Paragraph } from './paragraph-properties';\n/**\n * Text Properties pane\n * @private\n */\nvar TextProperties = /** @class */ (function () {\n    function TextProperties(container, id, isTableProperties, isRtl) {\n        var _this = this;\n        this.isInitial = true;\n        this.showTextProperties = function (isShow) {\n            if (isShow) {\n                _this.onSelectionChange();\n            }\n            if (!isShow && _this.element.style.display === 'none' || (isShow && _this.element.style.display === 'block')) {\n                return;\n            }\n            _this.element.style.display = isShow ? 'block' : 'none';\n            _this.documentEditor.resize();\n        };\n        this.generateUniqueID = function () {\n            return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);\n        };\n        this.container = container;\n        this.text = new Text(container, isRtl);\n        this.paragraph = new Paragraph(container);\n        this.initializeTextProperties(id, isTableProperties, isRtl);\n        this.wireEvents();\n    }\n    Object.defineProperty(TextProperties.prototype, \"documentEditor\", {\n        get: function () {\n            return this.container.documentEditor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextProperties.prototype.updateStyles = function () {\n        this.paragraph.updateStyleNames();\n    };\n    Object.defineProperty(TextProperties.prototype, \"appliedHighlightColor\", {\n        get: function () {\n            return this.text.appliedHighlightColor;\n        },\n        set: function (value) {\n            this.text.appliedHighlightColor = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextProperties.prototype, \"appliedBulletStyle\", {\n        get: function () {\n            return this.paragraph.appliedBulletStyle;\n        },\n        set: function (value) {\n            this.paragraph.appliedBulletStyle = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextProperties.prototype, \"appliedNumberingStyle\", {\n        get: function () {\n            return this.paragraph.appliedNumberingStyle;\n        },\n        set: function (value) {\n            this.paragraph.appliedNumberingStyle = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextProperties.prototype.initializeTextProperties = function (id, isTableProperties, isRtl) {\n        /* tslint:disable-next-line:max-line-length */\n        this.element = createElement('div', { id: id + 'id_' + this.generateUniqueID(), className: 'e-de-prop-pane' });\n        this.text.initializeTextPropertiesDiv(this.element, isRtl);\n        this.paragraph.initializeParagraphPropertiesDiv(this.element, isRtl);\n        this.paragraph.updateStyleNames();\n        if (!isTableProperties) {\n            this.container.propertiesPaneContainer.appendChild(this.element);\n        }\n    };\n    TextProperties.prototype.wireEvents = function () {\n        this.text.wireEvent();\n        this.paragraph.wireEvent();\n    };\n    TextProperties.prototype.onSelectionChange = function () {\n        this.text.onSelectionChange();\n        this.paragraph.onSelectionChange();\n    };\n    TextProperties.prototype.destroy = function () {\n        if (this.text) {\n            this.text.destroy();\n            this.text = undefined;\n        }\n        if (this.paragraph) {\n            this.paragraph.destroy();\n            this.paragraph = undefined;\n        }\n    };\n    return TextProperties;\n}());\nexport { TextProperties };\n","import { createElement, L10n, classList } from '@syncfusion/ej2-base';\nimport { ComboBox } from '@syncfusion/ej2-dropdowns';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { SplitButton } from '@syncfusion/ej2-splitbuttons';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\nimport { Query } from '@syncfusion/ej2-data';\n/**\n * Text Properties\n * @private\n */\nvar Text = /** @class */ (function () {\n    function Text(container, isRtl) {\n        var _this = this;\n        this.isRetrieving = false;\n        this.appliedHighlightColor = 'rgb(255, 255, 0)';\n        this.createHighlightColorSplitButton = function (id, width, divElement, toolTipText) {\n            var buttonElement = createElement('button', { id: id });\n            // buttonElement.style.width = width + 'px';\n            // buttonElement.style.padding = '1px';\n            // buttonElement.style.height = 30 + 'px';\n            divElement.appendChild(buttonElement);\n            var hgltSplitObj = new SplitButton({\n                cssClass: 'e-de-btn-hghlclr',\n                iconCss: 'e-de-ctnr-hglt-color',\n                target: _this.highlightColorElement, close: _this.closePopup, beforeOpen: _this.openPopup, enableRtl: _this.isRtl\n            });\n            hgltSplitObj.appendTo(buttonElement);\n            hgltSplitObj.click = function () {\n                _this.applyHighlightColor(_this.highlightColorInputElement.style.backgroundColor);\n            };\n            hgltSplitObj.element.firstChild.style.backgroundColor = 'rgb(255, 255, 0)';\n            hgltSplitObj.element.parentElement.setAttribute('title', toolTipText);\n            return hgltSplitObj;\n        };\n        this.openPopup = function () {\n            _this.highlightColorElement.style.display = 'block';\n        };\n        this.closePopup = function () {\n            _this.highlightColorElement.style.display = 'none';\n        };\n        /* tslint:disable:no-any */\n        this.onHighLightColor = function (event) {\n            if (_this.documentEditor.selection) {\n                _this.applyHighlightColor(event.currentTarget.style.backgroundColor);\n                _this.highlightColor.toggle();\n            }\n        };\n        this.applyHighlightColorAsBackground = function (color) {\n            _this.removeSelectedColorDiv();\n            if (color === 'NoColor') {\n                _this.highlightColorElement.querySelector('#noColorDiv').classList.add('e-color-selected');\n            }\n            else if (color === 'Yellow') {\n                _this.highlightColorElement.querySelector('#yellowDiv').classList.add('e-color-selected');\n            }\n            else if (color === 'BrightGreen') {\n                _this.highlightColorElement.querySelector('#brightGreenDiv').classList.add('e-color-selected');\n            }\n            else if (color === 'Turquoise') {\n                _this.highlightColorElement.querySelector('#turquoiseDiv').classList.add('e-color-selected');\n            }\n            else if (color === 'Pink') {\n                _this.highlightColorElement.querySelector('#hotPinkDiv').classList.add('e-color-selected');\n            }\n            else if (color === 'Red') {\n                _this.highlightColorElement.querySelector('#redDiv').classList.add('e-color-selected');\n            }\n            else if (color === 'DarkBlue') {\n                _this.highlightColorElement.querySelector('#darkBlueDiv').classList.add('e-color-selected');\n            }\n            else if (color === 'Teal') {\n                _this.highlightColorElement.querySelector('#tealDiv').classList.add('e-color-selected');\n            }\n            else if (color === 'Green') {\n                _this.highlightColorElement.querySelector('#greenDiv').classList.add('e-color-selected');\n            }\n            else if (color === 'Violet') {\n                _this.highlightColorElement.querySelector('#violetDiv').classList.add('e-color-selected');\n            }\n            else if (color === 'DarkRed') {\n                _this.highlightColorElement.querySelector('#darkRedDiv').classList.add('e-color-selected');\n            }\n            else if (color === 'DarkYellow') {\n                _this.highlightColorElement.querySelector('#darkYellowDiv').classList.add('e-color-selected');\n            }\n            else if (color === 'Gray50') {\n                _this.highlightColorElement.querySelector('#gray50Div').classList.add('e-color-selected');\n            }\n            else if (color === 'Gray25') {\n                _this.highlightColorElement.querySelector('#gray25Div').classList.add('e-color-selected');\n            }\n            else if (color === 'Black') {\n                _this.highlightColorElement.querySelector('#blackDiv').classList.add('e-color-selected');\n            }\n            else if (color === 'Blue') {\n                _this.highlightColorElement.querySelector('#blueDiv').classList.add('e-color-selected');\n            }\n        };\n        this.removeSelectedColorDiv = function () {\n            _this.highlightColorElement.querySelector('#noColorDiv').classList.remove('e-color-selected');\n            _this.highlightColorElement.querySelector('#yellowDiv').classList.remove('e-color-selected');\n            _this.highlightColorElement.querySelector('#brightGreenDiv').classList.remove('e-color-selected');\n            _this.highlightColorElement.querySelector('#turquoiseDiv').classList.remove('e-color-selected');\n            _this.highlightColorElement.querySelector('#hotPinkDiv').classList.remove('e-color-selected');\n            _this.highlightColorElement.querySelector('#redDiv').classList.remove('e-color-selected');\n            _this.highlightColorElement.querySelector('#darkBlueDiv').classList.remove('e-color-selected');\n            _this.highlightColorElement.querySelector('#tealDiv').classList.remove('e-color-selected');\n            _this.highlightColorElement.querySelector('#greenDiv').classList.remove('e-color-selected');\n            _this.highlightColorElement.querySelector('#violetDiv').classList.remove('e-color-selected');\n            _this.highlightColorElement.querySelector('#darkRedDiv').classList.remove('e-color-selected');\n            _this.highlightColorElement.querySelector('#darkYellowDiv').classList.remove('e-color-selected');\n            _this.highlightColorElement.querySelector('#gray50Div').classList.remove('e-color-selected');\n            _this.highlightColorElement.querySelector('#gray25Div').classList.remove('e-color-selected');\n            _this.highlightColorElement.querySelector('#blackDiv').classList.remove('e-color-selected');\n        };\n        this.applyHighlightColor = function (color) {\n            _this.appliedHighlightColor = color;\n            var hgltColor = _this.getHighLightColor(color);\n            _this.documentEditor.selection.characterFormat.highlightColor = hgltColor;\n        };\n        this.getHighLightColor = function (color) {\n            switch (color) {\n                case 'rgb(255, 255, 0)':\n                    return 'Yellow';\n                case 'rgb(0, 255, 0)':\n                    return 'BrightGreen';\n                case 'rgb(0, 255, 255)':\n                    return 'Turquoise';\n                case 'rgb(255, 0, 255)':\n                    return 'Pink';\n                case 'rgb(0, 0, 255)':\n                    return 'Blue';\n                case 'rgb(255, 0, 0)':\n                    return 'Red';\n                case 'rgb(0, 0, 128)':\n                    return 'DarkBlue';\n                case 'rgb(0, 128, 128)':\n                    return 'Teal';\n                case 'rgb(0, 128, 0)':\n                    return 'Green';\n                case 'rgb(128, 0, 128)':\n                    return 'Violet';\n                case 'rgb(128, 0, 0)':\n                    return 'DarkRed';\n                case 'rgb(128, 128, 0)':\n                    return 'DarkYellow';\n                case 'rgb(128, 128, 128)':\n                    return 'Gray50';\n                case 'rgb(192, 192, 192)':\n                    return 'Gray25';\n                case 'rgb(0, 0, 0)':\n                    return 'Black';\n                default:\n                    return 'NoColor';\n            }\n        };\n        this.createFontColorPicker = function (id, width, divElement, toolTipText) {\n            var inputElement = createElement('input', { id: id, attrs: { 'type': 'color' } });\n            inputElement.style.width = width + 'px';\n            divElement.appendChild(inputElement);\n            // tslint:disable-next-line:max-line-length\n            _this.fontColorInputElement = new ColorPicker({ value: '#000000', showButtons: true, enableRtl: _this.isRtl, locale: _this.container.locale }, inputElement);\n            _this.fontColorInputElement.element.parentElement.setAttribute('title', toolTipText);\n            return inputElement;\n        };\n        this.boldAction = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.editor) {\n                _this.documentEditor.editor.toggleBold();\n            }\n        };\n        this.italicAction = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.editor) {\n                _this.documentEditor.editor.toggleItalic();\n            }\n        };\n        this.underlineAction = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.editor) {\n                _this.documentEditor.editor.toggleUnderline('Single');\n            }\n        };\n        this.strikethroughAction = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.editor) {\n                _this.documentEditor.editor.toggleStrikethrough();\n            }\n        };\n        this.clearFormatAction = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.editor) {\n                _this.documentEditor.editor.clearFormatting();\n            }\n        };\n        this.subscriptAction = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.editor) {\n                _this.documentEditor.editor.toggleSubscript();\n            }\n        };\n        this.superscriptAction = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.editor) {\n                _this.documentEditor.editor.toggleSuperscript();\n            }\n        };\n        this.changeFontColor = function (arg) {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.selection) {\n                _this.documentEditor.selection.characterFormat.fontColor = arg.currentValue.hex;\n                setTimeout(function () { _this.documentEditor.focusIn(); }, 30);\n            }\n        };\n        this.changeFontFamily = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.selection && _this.fontFamily.value !== '') {\n                setTimeout(function () { _this.documentEditor.selection.characterFormat.fontFamily = _this.fontFamily.value; }, 10);\n            }\n        };\n        this.changeFontSize = function () {\n            if (_this.isRetrieving) {\n                return;\n            }\n            if (!_this.documentEditor.isReadOnly && _this.documentEditor.selection && _this.fontSize.value !== '') {\n                setTimeout(function () { _this.documentEditor.selection.characterFormat.fontSize = _this.fontSize.value; }, 10);\n            }\n        };\n        this.container = container;\n        this.isRtl = isRtl;\n    }\n    Object.defineProperty(Text.prototype, \"documentEditor\", {\n        get: function () {\n            return this.container.documentEditor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Text.prototype.initializeTextPropertiesDiv = function (wholeDiv, isRtl) {\n        this.localObj = new L10n('documenteditorcontainer', this.container.defaultLocale, this.container.locale);\n        this.textProperties = wholeDiv;\n        var element = 'font_properties';\n        var textDiv = this.createDiv(element + '_text', wholeDiv);\n        classList(textDiv, ['e-de-cntr-pane-padding', 'e-de-prop-separator-line'], []);\n        var label = createElement('label', { className: 'e-de-ctnr-prop-label' });\n        label.innerHTML = this.localObj.getConstant('Text');\n        textDiv.appendChild(label);\n        var fontDiv = this.createDiv(element + '_sizeStyle', textDiv, 'display:inline-flex;');\n        classList(fontDiv, ['e-de-ctnr-segment'], []);\n        if (isRtl) {\n            classList(fontDiv, ['e-de-ctnr-segment-rtl'], []);\n        }\n        var fontFamilyDiv = this.createDiv(element + '_fontFamilyDiv', fontDiv);\n        var fontFamily = createElement('input', {\n            id: element + '_fontFamily',\n            /* tslint:disable-next-line:max-line-length */\n            styles: 'font-size: 12px;letter-spacing: 0.05px;', className: 'e-prop-font-style'\n        });\n        fontFamilyDiv.appendChild(fontFamily);\n        classList(fontFamilyDiv, ['e-de-panel-left-width'], []);\n        this.createDropDownListForFamily(fontFamily);\n        var fontSizeDiv = this.createDiv(element + '_fontSizeDiv', fontDiv);\n        var divClassName = 'e-de-ctnr-group-btn e-de-char-fmt-btn-left e-btn-group';\n        if (isRtl) {\n            divClassName = 'e-rtl ' + divClassName;\n        }\n        var fontSize = createElement('input', {\n            id: element + '_fontSize',\n            styles: 'font-size: 12px;letter-spacing: 0.05px;', innerHTML: 'type:number',\n            className: 'e-prop-font-style',\n        });\n        fontSizeDiv.appendChild(fontSize);\n        classList(fontSizeDiv, ['e-de-panel-right-width'], []);\n        this.createDropDownListForSize(fontSize);\n        var propertiesDiv = createElement('div', {\n            id: element + '_properties',\n            styles: 'display:inline-flex;',\n            className: 'e-de-ctnr-segment'\n        });\n        if (isRtl) {\n            classList(propertiesDiv, ['e-de-ctnr-segment-rtl'], []);\n        }\n        textDiv.appendChild(propertiesDiv);\n        var leftDiv = createElement('div', {\n            id: element + '_leftDiv',\n            className: divClassName, styles: 'display:inline-flex;'\n        });\n        propertiesDiv.appendChild(leftDiv);\n        // tslint:disable-next-line:max-line-length\n        this.bold = this.createButtonTemplate(element + '_bold', 'e-de-ctnr-bold e-icons', leftDiv, 'e-de-prop-font-button', '40.5', this.localObj.getConstant('Bold (Ctrl+B)'));\n        // tslint:disable-next-line:max-line-length\n        this.italic = this.createButtonTemplate(element + '_italic', 'e-de-ctnr-italic e-icons', leftDiv, 'e-de-prop-font-button', '40.5', this.localObj.getConstant('Italic (Ctrl+I)'));\n        // tslint:disable-next-line:max-line-length\n        this.underline = this.createButtonTemplate(element + '_underline', 'e-de-ctnr-underline e-icons', leftDiv, 'e-de-prop-font-button', '40.5', this.localObj.getConstant('Underline (Ctrl+U)'));\n        // tslint:disable-next-line:max-line-length\n        this.strikethrough = this.createButtonTemplate(element + '_strikethrough', 'e-de-ctnr-strikethrough e-icons', leftDiv, 'e-de-prop-font-last-button', '40.5', this.localObj.getConstant('Strikethrough'));\n        divClassName = 'e-de-ctnr-group-btn e-de-char-fmt-btn-right e-btn-group';\n        if (isRtl) {\n            divClassName = 'e-rtl ' + divClassName;\n        }\n        // tslint:disable-next-line:max-line-length\n        var rightDiv = createElement('div', { id: element + '_rightDiv', className: divClassName, styles: 'display:inline-flex;' });\n        propertiesDiv.appendChild(rightDiv);\n        // tslint:disable-next-line:max-line-length\n        this.superscript = this.createButtonTemplate(element + '_superscript', 'e-de-ctnr-superscript e-icons', rightDiv, 'e-de-prop-font-button', '38.5', this.localObj.getConstant('Superscript (Ctrl+Shift++)'));\n        // tslint:disable-next-line:max-line-length\n        this.subscript = this.createButtonTemplate(element + '_subscript', 'e-de-ctnr-subscript e-icons', rightDiv, 'e-de-prop-font-last-button', '38.5', this.localObj.getConstant('Subscript (Ctrl+=)'));\n        // tslint:disable-next-line:max-line-length\n        var leftDiv2 = createElement('div', { id: element + '_color', className: 'e-de-font-clr-picker e-de-ctnr-group-btn', styles: 'display:inline-flex;' });\n        if (isRtl) {\n            classList(leftDiv2, ['e-rtl'], []);\n        }\n        textDiv.appendChild(leftDiv2);\n        // tslint:disable-next-line:max-line-length\n        this.fontColor = this.createFontColorPicker(element + '_textColor', 40.5, leftDiv2, this.localObj.getConstant('Font color'));\n        classList(leftDiv2.firstElementChild.lastElementChild.lastElementChild.firstChild, ['e-de-ctnr-fontcolor', 'e-icons'], ['e-caret']);\n        this.initializeHighlightColorElement();\n        // tslint:disable-next-line:max-line-length\n        this.highlightColor = this.createHighlightColorSplitButton(element + '_highlightColor', 34.5, leftDiv2, this.localObj.getConstant('Text highlight color'));\n        classList(this.highlightColor.element.nextElementSibling.firstElementChild, ['e-de-ctnr-highlight', 'e-icons'], ['e-caret']);\n        this.highlightColorInputElement = this.highlightColor.element.firstChild;\n        // tslint:disable-next-line:max-line-length\n        this.clearFormat = this.createButtonTemplate(element + '_clearFormat', 'e-de-ctnr-clearall e-icons', leftDiv2, 'e-de-prop-font-last-button', '40.5', this.localObj.getConstant('Clear all formatting'));\n    };\n    Text.prototype.initializeHighlightColorElement = function () {\n        this.highlightColorElement = createElement('div', {\n            id: 'highlight_color_ppty',\n            styles: 'display:none;width:157px',\n            className: 'e-de-cntr-highlight-pane'\n        });\n        var yellowDiv = this.createHightlighColorPickerDiv('#ffff00', 'yellowDiv');\n        var brightGreenDiv = this.createHightlighColorPickerDiv('#00ff00', 'brightGreenDiv');\n        var turquoiseDiv = this.createHightlighColorPickerDiv('#00ffff', 'turquoiseDiv');\n        var hotPinkDiv = this.createHightlighColorPickerDiv('#ff00ff', 'hotPinkDiv');\n        var blueDiv = this.createHightlighColorPickerDiv('#0000ff', 'blueDiv');\n        var redDiv = this.createHightlighColorPickerDiv('#ff0000', 'redDiv');\n        var darkBlueDiv = this.createHightlighColorPickerDiv('#000080', 'darkBlueDiv');\n        var tealDiv = this.createHightlighColorPickerDiv('#008080', 'tealDiv');\n        var greenDiv = this.createHightlighColorPickerDiv('#008000', 'greenDiv');\n        var violetDiv = this.createHightlighColorPickerDiv('#800080', 'violetDiv');\n        var darkRedDiv = this.createHightlighColorPickerDiv('#800000', 'darkRedDiv');\n        var darkYellowDiv = this.createHightlighColorPickerDiv('#808000', 'darkYellowDiv');\n        var gray50Div = this.createHightlighColorPickerDiv('#808080', 'gray50Div');\n        var gray25Div = this.createHightlighColorPickerDiv('#c0c0c0', 'gray25Div');\n        var blackDiv = this.createHightlighColorPickerDiv('#000000', 'blackDiv');\n        var nocolor = createElement('div', { className: 'e-hglt-no-color' });\n        this.highlightColorElement.appendChild(nocolor);\n        // tslint:disable-next-line:max-line-length\n        var nocolorDiv = createElement('div', { styles: 'width:24px;height:24px;background-color:#ffffff;margin:3px;', id: 'noColorDiv' });\n        nocolor.appendChild(nocolorDiv);\n        var nocolorDivValue = createElement('div', { innerHTML: 'No color', className: 'e-de-ctnr-hglt-no-color' });\n        nocolorDiv.appendChild(nocolorDivValue);\n        yellowDiv.addEventListener('click', this.onHighLightColor);\n        brightGreenDiv.addEventListener('click', this.onHighLightColor);\n        turquoiseDiv.addEventListener('click', this.onHighLightColor);\n        hotPinkDiv.addEventListener('click', this.onHighLightColor);\n        blueDiv.addEventListener('click', this.onHighLightColor);\n        redDiv.addEventListener('click', this.onHighLightColor);\n        darkBlueDiv.addEventListener('click', this.onHighLightColor);\n        tealDiv.addEventListener('click', this.onHighLightColor);\n        greenDiv.addEventListener('click', this.onHighLightColor);\n        violetDiv.addEventListener('click', this.onHighLightColor);\n        darkRedDiv.addEventListener('click', this.onHighLightColor);\n        darkYellowDiv.addEventListener('click', this.onHighLightColor);\n        gray50Div.addEventListener('click', this.onHighLightColor);\n        gray25Div.addEventListener('click', this.onHighLightColor);\n        blackDiv.addEventListener('click', this.onHighLightColor);\n        nocolor.addEventListener('click', this.onHighLightColor);\n    };\n    Text.prototype.createHightlighColorPickerDiv = function (backgroundColor, id) {\n        var colorDiv = createElement('div', { className: 'e-de-ctnr-hglt-btn', id: id });\n        colorDiv.style.backgroundColor = backgroundColor;\n        this.highlightColorElement.appendChild(colorDiv);\n        return colorDiv;\n    };\n    Text.prototype.createDiv = function (id, parentDiv, style) {\n        var div;\n        if (style) {\n            div = createElement('div', { id: id, styles: style });\n        }\n        else {\n            div = createElement('div', { id: id });\n        }\n        parentDiv.appendChild(div);\n        return div;\n    };\n    // tslint:disable-next-line:max-line-length\n    Text.prototype.createButtonTemplate = function (id, iconcss, div, buttonClass, width, toolTipText) {\n        var button = createElement('Button', { id: id });\n        // button.style.width = width + 'px';\n        // buttonElement.style.height = 32 + 'px';\n        div.appendChild(button);\n        var btn = new Button({\n            cssClass: buttonClass, iconCss: iconcss, enableRtl: this.isRtl\n        });\n        btn.appendTo(button);\n        button.setAttribute('title', toolTipText);\n        return button;\n    };\n    /**\n     * Adds file colot elements to parent div.\n     */\n    Text.prototype.createColorTypeInput = function (elemId) {\n        var colorType = createElement('input', {\n            id: elemId,\n            attrs: { 'type': 'color' }, styles: 'position:fixed; left:-100em'\n        });\n        this.documentEditor.getDocumentEditorElement().parentElement.appendChild(colorType);\n        return colorType;\n    };\n    Text.prototype.createDropDownListForSize = function (fontSelectElement) {\n        var _this = this;\n        var fontSize = ['8', '9', '10', '11', '12', '14', '16', '18', '20', '22', '24', '26', '28', '36', '48', '72', '96'];\n        this.fontSize = new ComboBox({\n            dataSource: fontSize, popupHeight: '180px',\n            cssClass: 'e-de-prop-dropdown',\n            allowCustom: true,\n            showClearButton: false,\n            enableRtl: this.isRtl\n        });\n        this.fontSize.focus = function () { _this.isRetrieving = false; };\n        this.fontSize.value = this.documentEditor.selection.characterFormat.fontSize.toString();\n        this.fontSize.appendTo(fontSelectElement);\n        this.fontSize.element.parentElement.setAttribute('title', this.localObj.getConstant('Font Size'));\n    };\n    Text.prototype.createDropDownListForFamily = function (fontSelectElement) {\n        var _this = this;\n        var fontStyle = [{ FontName: 'Algerian' }, { FontName: 'Arial' },\n            { FontName: 'Calibri' }, { FontName: 'Cambria' }, { FontName: 'Cambria Math' }, { FontName: 'Candara' },\n            { FontName: 'Courier New' }, { FontName: 'Georgia' }, { FontName: 'Impact' }, { FontName: 'Segoe Print' },\n            { FontName: 'Segoe Script' }, { FontName: 'Segoe UI' }, { FontName: 'Symbol' },\n            { FontName: 'Times New Roman' }, { FontName: 'Verdana' }, { FontName: 'Windings' }\n        ];\n        this.fontFamily = new ComboBox({\n            dataSource: fontStyle,\n            query: new Query().select(['FontName']),\n            fields: { text: 'FontName', value: 'FontName' },\n            popupHeight: '150px',\n            cssClass: 'e-de-prop-dropdown',\n            itemTemplate: '<span style=\"font-family: ${FontName};\">${FontName}</span>',\n            allowCustom: true,\n            showClearButton: false,\n            enableRtl: this.isRtl\n        });\n        this.fontFamily.focus = function () { _this.isRetrieving = false; };\n        this.fontFamily.appendTo(fontSelectElement);\n        this.fontFamily.element.parentElement.setAttribute('title', this.localObj.getConstant('Font'));\n    };\n    Text.prototype.wireEvent = function () {\n        var _this = this;\n        this.fontFamily.addEventListener('change', function () { _this.changeFontFamily(); });\n        this.fontSize.addEventListener('change', function () { _this.changeFontSize(); });\n        this.bold.addEventListener('click', function () { _this.isRetrieving = false; _this.boldAction(); });\n        this.italic.addEventListener('click', function () { _this.isRetrieving = false; _this.italicAction(); });\n        this.underline.addEventListener('click', function () { _this.isRetrieving = false; _this.underlineAction(); });\n        this.strikethrough.addEventListener('click', function () { _this.isRetrieving = false; _this.strikethroughAction(); });\n        this.superscript.addEventListener('click', function () { _this.isRetrieving = false; _this.superscriptAction(); });\n        this.subscript.addEventListener('click', function () { _this.isRetrieving = false; _this.subscriptAction(); });\n        /* tslint:disable-next-line:max-line-length */\n        this.fontColorInputElement.addEventListener('change', function (args) { _this.isRetrieving = false; _this.changeFontColor(args); });\n        this.clearFormat.addEventListener('click', function () { _this.isRetrieving = false; _this.clearFormatAction(); });\n    };\n    Text.prototype.unwireEvents = function () {\n        this.fontFamily.change = undefined;\n        this.fontSize.change = undefined;\n        this.bold.click = undefined;\n        this.italic.click = undefined;\n        this.underline.click = undefined;\n        this.strikethrough.click = undefined;\n        this.superscript.click = undefined;\n        this.subscript.click = undefined;\n        this.fontColorInputElement.change = undefined;\n        this.highlightColorElement.click = undefined;\n        this.highlightColor.click = undefined;\n        this.clearFormat.click = undefined;\n    };\n    Text.prototype.onSelectionChange = function () {\n        this.isRetrieving = true;\n        if (this.documentEditor.selection) {\n            //#region character format\n            if (this.documentEditor.selection.characterFormat.fontFamily) {\n                this.fontFamily.value = this.documentEditor.selection.characterFormat.fontFamily;\n                this.fontFamily.dataBind();\n            }\n            else {\n                this.fontFamily.value = '';\n            }\n            if (this.documentEditor.selection.characterFormat.fontSize) {\n                this.fontSize.value = this.documentEditor.selection.characterFormat.fontSize.toString();\n                this.fontSize.dataBind();\n            }\n            else {\n                this.fontSize.value = '';\n            }\n            if (this.documentEditor.selection.characterFormat.bold) {\n                if (!this.bold.classList.contains('e-btn-toggle')) {\n                    this.bold.classList.add('e-btn-toggle');\n                }\n            }\n            else {\n                if (this.bold.classList.contains('e-btn-toggle')) {\n                    this.bold.classList.remove('e-btn-toggle');\n                }\n            }\n            if (this.documentEditor.selection.characterFormat.italic) {\n                if (!this.italic.classList.contains('e-btn-toggle')) {\n                    this.italic.classList.add('e-btn-toggle');\n                }\n            }\n            else {\n                if (this.italic.classList.contains('e-btn-toggle')) {\n                    this.italic.classList.remove('e-btn-toggle');\n                }\n            }\n            if (this.documentEditor.selection.characterFormat.underline\n                && this.documentEditor.selection.characterFormat.underline !== 'None') {\n                if (!this.underline.classList.contains('e-btn-toggle')) {\n                    this.underline.classList.add('e-btn-toggle');\n                }\n            }\n            else {\n                if (this.underline.classList.contains('e-btn-toggle')) {\n                    this.underline.classList.remove('e-btn-toggle');\n                }\n            }\n            if (this.documentEditor.selection.characterFormat.strikethrough\n                && this.documentEditor.selection.characterFormat.strikethrough !== 'None') {\n                if (!this.strikethrough.classList.contains('e-btn-toggle')) {\n                    this.strikethrough.classList.add('e-btn-toggle');\n                }\n            }\n            else {\n                if (this.strikethrough.classList.contains('e-btn-toggle')) {\n                    this.strikethrough.classList.remove('e-btn-toggle');\n                }\n            }\n            if (this.documentEditor.selection.characterFormat.baselineAlignment\n                && this.documentEditor.selection.characterFormat.baselineAlignment === 'Subscript') {\n                if (!this.subscript.classList.contains('e-btn-toggle')) {\n                    this.subscript.classList.add('e-btn-toggle');\n                }\n            }\n            else {\n                if (this.subscript.classList.contains('e-btn-toggle')) {\n                    this.subscript.classList.remove('e-btn-toggle');\n                }\n            }\n            if (this.documentEditor.selection.characterFormat.baselineAlignment\n                && this.documentEditor.selection.characterFormat.baselineAlignment === 'Superscript') {\n                if (!this.superscript.classList.contains('e-btn-toggle')) {\n                    this.superscript.classList.add('e-btn-toggle');\n                }\n            }\n            else {\n                if (this.superscript.classList.contains('e-btn-toggle')) {\n                    this.superscript.classList.remove('e-btn-toggle');\n                }\n            }\n            if (this.documentEditor.selection.characterFormat.fontColor) {\n                this.fontColorInputElement.value = this.documentEditor.selection.characterFormat.fontColor;\n            }\n            if (this.documentEditor.selection.characterFormat.highlightColor) {\n                this.highlightColorInputElement.style.backgroundColor = this.appliedHighlightColor;\n                this.applyHighlightColorAsBackground(this.documentEditor.selection.characterFormat.highlightColor);\n            }\n            //#endregion\n        }\n    };\n    Text.prototype.destroy = function () {\n        this.container = undefined;\n        if (this.highlightColor) {\n            this.highlightColor.destroy();\n            this.highlightColor = undefined;\n        }\n        if (this.fontColorInputElement) {\n            this.fontColorInputElement.destroy();\n            this.fontColorInputElement = undefined;\n        }\n        if (this.fontSize) {\n            this.fontSize.destroy();\n            this.fontSize = undefined;\n        }\n        if (this.fontFamily) {\n            this.fontFamily.destroy();\n            this.fontFamily = undefined;\n        }\n    };\n    return Text;\n}());\nexport { Text };\n","/**\n * Export toolbar module\n */\nexport * from './tool-bar';\n","import { createElement, isNullOrUndefined, EventHandler, classList } from '@syncfusion/ej2-base';\nimport { Toolbar as EJ2Toolbar } from '@syncfusion/ej2-navigations';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { showSpinner, hideSpinner } from '@syncfusion/ej2-popups';\nvar TOOLBAR_ID = '_toolbar';\nvar NEW_ID = '_new';\nvar OPEN_ID = '_open';\nvar UNDO_ID = '_undo';\nvar REDO_ID = '_redo';\nvar INSERT_IMAGE_ID = '_image';\nvar INSERT_IMAGE_LOCAL_ID = '_image_local';\nvar INSERT_IMAGE_ONLINE_ID = '_image_url';\nvar INSERT_TABLE_ID = '_table';\nvar INSERT_LINK_ID = '_link';\nvar BOOKMARK_ID = '_bookmark';\nvar TABLE_OF_CONTENT_ID = '_toc';\nvar HEADER_ID = '_header';\nvar FOOTER_ID = '_footer';\nvar PAGE_SET_UP_ID = '_page_setup';\nvar PAGE_NUMBER_ID = '_page_number';\nvar BREAK_ID = '_break';\nvar FIND_ID = '_find';\nvar CLIPBOARD_ID = '_use_local_clipboard';\nvar RESTRICT_EDITING_ID = '_restrict_edit';\nvar PAGE_BREAK = '_page_break';\nvar SECTION_BREAK = '_section_break';\n/**\n * Toolbar Module\n */\nvar Toolbar = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function Toolbar(container) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.showPropertiesPane = true;\n        /**\n         * @private\n         */\n        this.showHeaderProperties = false;\n        /**\n         * @private\n         */\n        this.previousContext = '';\n        /**\n         * @private\n         */\n        this.showPropertiesPaneOnSelection = function () {\n            if (_this.container.restrictEditing) {\n                return;\n            }\n            var currentContext = _this.documentEditor.selection.contextType;\n            var isInHeaderFooter = currentContext.indexOf('Header') >= 0\n                || currentContext.indexOf('Footer') >= 0;\n            if (!isInHeaderFooter && !_this.showPropertiesPane) {\n                _this.container.showPropertiesPane = false;\n                _this.documentEditor.focusIn();\n                return;\n            }\n            if (!isInHeaderFooter) {\n                if (_this.container.headerFooterProperties &&\n                    _this.container.headerFooterProperties.element.style.display === 'block') {\n                    _this.container.showPropertiesPane = false;\n                    _this.documentEditor.selection.closeHeaderFooter();\n                }\n                _this.showHeaderProperties = true;\n            }\n            else if (isInHeaderFooter && _this.showHeaderProperties) {\n                _this.showPropertiesPane = true;\n            }\n            if (_this.showPropertiesPane) {\n                _this.container.showPropertiesPane = true;\n                if (isInHeaderFooter && _this.showHeaderProperties) {\n                    _this.showProperties('headerfooter');\n                }\n                else {\n                    if (currentContext.indexOf('Text') >= 0\n                        && currentContext.indexOf('Table') < 0) {\n                        _this.showProperties('text');\n                    }\n                    else if (currentContext.indexOf('Image') >= 0) {\n                        _this.showProperties('image');\n                    }\n                    else if (currentContext.indexOf('TableOfContents') >= 0) {\n                        _this.showProperties('toc');\n                    }\n                    else if (currentContext.indexOf('Table') >= 0) {\n                        _this.showProperties('table');\n                    }\n                }\n            }\n            _this.previousContext = _this.documentEditor.selection.contextType;\n        };\n        this.showProperties = function (property) {\n            if (property !== 'headerfooter' && property !== 'toc') {\n                _this.enableDisablePropertyPaneButton(true);\n            }\n            _this.container.textProperties.showTextProperties(property === 'text');\n            _this.container.tableProperties.showTableProperties(property === 'table');\n            _this.container.imageProperties.showImageProperties(property === 'image');\n            _this.container.headerFooterProperties.showHeaderFooterPane(property === 'headerfooter');\n            _this.container.tocProperties.showTocPane(property === 'toc');\n        };\n        this.container = container;\n        this.render();\n        this.wireEvent();\n    }\n    Object.defineProperty(Toolbar.prototype, \"documentEditor\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.container.documentEditor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Toolbar.prototype.getModuleName = function () {\n        return 'toolbar';\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-func-body-length\n    Toolbar.prototype.render = function () {\n        if (isNullOrUndefined(this.container)) {\n            return;\n        }\n        var toolbarContainer = this.container.toolbarContainer;\n        var toolbarWrapper = createElement('div', { className: 'e-de-tlbr-wrapper' });\n        var toolbarTarget = createElement('div', { className: 'e-de-toolbar', styles: 'height:100%' });\n        this.initToolbarItems();\n        toolbarWrapper.appendChild(toolbarTarget);\n        toolbarContainer.appendChild(toolbarWrapper);\n        // Show hide pane button initialization \n        var propertiesPaneDiv = createElement('div', { className: 'e-de-ctnr-properties-pane-btn' });\n        var buttonElement = createElement('button');\n        propertiesPaneDiv.appendChild(buttonElement);\n        var cssClassName = 'e-tbar-btn e-tbtn-txt e-control e-btn e-de-showhide-btn';\n        if (this.container.enableRtl) {\n            cssClassName += '-rtl';\n        }\n        this.propertiesPaneButton = new Button({\n            cssClass: cssClassName,\n            iconCss: 'e-icons e-de-ctnr-showhide'\n        });\n        this.propertiesPaneButton.appendTo(buttonElement);\n        EventHandler.add(buttonElement, 'click', this.showHidePropertiesPane, this);\n        toolbarContainer.appendChild(propertiesPaneDiv);\n        this.toolbar.appendTo(toolbarTarget);\n        var locale = this.container.localObj;\n        var id = this.container.element.id + TOOLBAR_ID;\n        var imageButton = toolbarTarget.getElementsByClassName('e-de-image-splitbutton')[0].firstChild;\n        var items = {\n            items: [\n                {\n                    text: locale.getConstant('Upload from computer'), iconCss: 'e-icons e-de-ctnr-upload',\n                    id: id + INSERT_IMAGE_LOCAL_ID\n                }\n            ],\n            //,{ text: locale.getConstant('By URL'), iconCss: 'e-icons e-de-ctnr-link', id: id + INSERT_IMAGE_ONLINE_ID }],\n            cssClass: 'e-de-toolbar-btn-first e-caret-hide',\n            iconCss: 'e-icons e-de-ctnr-image',\n            select: this.onDropDownButtonSelect.bind(this),\n        };\n        var insertImage = new DropDownButton(items, imageButton);\n        var breakButton = toolbarTarget.getElementsByClassName('e-de-break-splitbutton')[0].firstChild;\n        items = {\n            items: [\n                { text: locale.getConstant('Page Break'), iconCss: 'e-icons e-de-ctnr-page-break', id: id + PAGE_BREAK },\n                { text: locale.getConstant('Section Break'), iconCss: 'e-icons e-de-ctnr-section-break', id: id + SECTION_BREAK }\n            ],\n            cssClass: 'e-caret-hide',\n            iconCss: 'e-icons e-de-ctnr-break',\n            select: this.onDropDownButtonSelect.bind(this),\n        };\n        var inserBreak = new DropDownButton(items, breakButton);\n        this.filePicker = createElement('input', {\n            attrs: { type: 'file', accept: '.doc,.docx,.rtf,.txt,.htm,.html,.sfdt' }, className: 'e-de-ctnr-file-picker'\n        });\n        this.imagePicker = createElement('input', {\n            attrs: { type: 'file', accept: '.jpg,.jpeg,.png,.bmp' }, className: 'e-de-ctnr-file-picker'\n        });\n        this.toggleButton(id + CLIPBOARD_ID, this.container.enableLocalPaste);\n        this.toggleButton(id + RESTRICT_EDITING_ID, this.container.restrictEditing);\n    };\n    Toolbar.prototype.showHidePropertiesPane = function () {\n        if (this.previousContext === 'TableOfContents' && this.showPropertiesPane) {\n            this.documentEditor.focusIn();\n            return;\n        }\n        else if (this.container.tocProperties.element.style.display === 'block' && this.showPropertiesPane) {\n            this.enableDisablePropertyPaneButton(true);\n            this.showPropertiesPaneOnSelection();\n            return;\n        }\n        if (this.previousContext.indexOf('Header') >= 0\n            || this.previousContext.indexOf('Footer') >= 0) {\n            this.showHeaderProperties = !this.showHeaderProperties;\n        }\n        else {\n            this.showPropertiesPane = !this.showPropertiesPane;\n        }\n        this.enableDisablePropertyPaneButton(this.showPropertiesPane);\n        this.showPropertiesPaneOnSelection();\n        this.documentEditor.focusIn();\n    };\n    Toolbar.prototype.onWrapText = function (text) {\n        var content = '';\n        var index = text.lastIndexOf(' ');\n        content = text.slice(0, index);\n        text.slice(index);\n        content += '<div class=\"e-de-text-wrap\">' + text.slice(index) + '</div>';\n        return content;\n    };\n    Toolbar.prototype.wireEvent = function () {\n        this.propertiesPaneButton.on('click', this.togglePropertiesPane.bind(this));\n        EventHandler.add(this.filePicker, 'change', this.onFileChange, this);\n        EventHandler.add(this.imagePicker, 'change', this.onImageChange, this);\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Toolbar.prototype.initToolbarItems = function () {\n        var id = this.container.element.id + TOOLBAR_ID;\n        var locale = this.container.localObj;\n        this.toolbar = new EJ2Toolbar({\n            enableRtl: this.container.enableRtl,\n            clicked: this.clickHandler.bind(this),\n            items: [\n                {\n                    prefixIcon: 'e-de-ctnr-new', tooltipText: locale.getConstant('Create a new document.'),\n                    id: id + NEW_ID, text: locale.getConstant('New'), cssClass: 'e-de-toolbar-btn-start'\n                },\n                {\n                    prefixIcon: 'e-de-ctnr-open', tooltipText: locale.getConstant('Open a document.'), id: id + OPEN_ID,\n                    text: locale.getConstant('Open'), cssClass: 'e-de-toolbar-btn-last'\n                },\n                {\n                    type: 'Separator', cssClass: 'e-de-separator'\n                },\n                {\n                    prefixIcon: 'e-de-ctnr-undo', tooltipText: locale.getConstant('Undo the last operation (Ctrl+Z).'),\n                    id: id + UNDO_ID, text: locale.getConstant('Undo'), cssClass: 'e-de-toolbar-btn-first'\n                },\n                {\n                    prefixIcon: 'e-de-ctnr-redo', tooltipText: locale.getConstant('Redo the last operation (Ctrl+Y).'),\n                    id: id + REDO_ID, text: locale.getConstant('Redo'), cssClass: 'e-de-toolbar-btn-last'\n                },\n                {\n                    type: 'Separator', cssClass: 'e-de-separator'\n                },\n                {\n                    tooltipText: locale.getConstant('Insert inline picture from a file.'), id: id + INSERT_IMAGE_ID,\n                    text: locale.getConstant('Image'), cssClass: 'e-de-toolbar-btn-first e-de-image-splitbutton'\n                },\n                {\n                    prefixIcon: 'e-de-ctnr-table', tooltipText: locale.getConstant('Insert a table into the document'),\n                    id: id + INSERT_TABLE_ID, text: locale.getConstant('Table'), cssClass: 'e-de-toolbar-btn-middle'\n                },\n                {\n                    prefixIcon: 'e-de-ctnr-link',\n                    tooltipText: locale.getConstant('Create a link in your document for quick access to webpages and files (Ctrl+K).'),\n                    id: id + INSERT_LINK_ID, text: locale.getConstant('Link'), cssClass: 'e-de-toolbar-btn-middle'\n                },\n                {\n                    prefixIcon: 'e-de-ctnr-bookmark',\n                    tooltipText: locale.getConstant('Insert a bookmark in a specific place in this document.'),\n                    id: id + BOOKMARK_ID, text: locale.getConstant('Bookmark'), cssClass: 'e-de-toolbar-btn-middle'\n                },\n                {\n                    prefixIcon: 'e-de-ctnr-tableofcontent',\n                    tooltipText: locale.getConstant('Provide an overview of your document by adding a table of contents.'),\n                    id: id + TABLE_OF_CONTENT_ID, text: this.onWrapText(locale.getConstant('Table of Contents')),\n                    cssClass: 'e-de-toolbar-btn-last'\n                },\n                {\n                    type: 'Separator', cssClass: 'e-de-separator'\n                },\n                {\n                    prefixIcon: 'e-de-ctnr-header', tooltipText: locale.getConstant('Add or edit the header.'),\n                    id: id + HEADER_ID, text: locale.getConstant('Header'), cssClass: 'e-de-toolbar-btn-first'\n                },\n                {\n                    prefixIcon: 'e-de-ctnr-footer', tooltipText: locale.getConstant('Add or edit the footer.'),\n                    id: id + FOOTER_ID, text: locale.getConstant('Footer'), cssClass: 'e-de-toolbar-btn-middle'\n                },\n                {\n                    prefixIcon: 'e-de-ctnr-pagesetup', tooltipText: locale.getConstant('Open the page setup dialog.'),\n                    id: id + PAGE_SET_UP_ID, text: this.onWrapText(locale.getConstant('Page Setup')),\n                    cssClass: 'e-de-toolbar-btn-middle'\n                },\n                {\n                    prefixIcon: 'e-de-ctnr-pagenumber', tooltipText: locale.getConstant('Add page numbers.'),\n                    id: id + PAGE_NUMBER_ID, text: this.onWrapText(locale.getConstant('Page Number')),\n                    cssClass: 'e-de-toolbar-btn-middle'\n                },\n                {\n                    tooltipText: locale.getConstant('Break'), text: locale.getConstant('Break'), id: BREAK_ID,\n                    cssClass: 'e-de-toolbar-btn-last e-de-break-splitbutton'\n                },\n                {\n                    type: 'Separator', cssClass: 'e-de-separator'\n                },\n                {\n                    prefixIcon: 'e-de-ctnr-find', tooltipText: locale.getConstant('Find text in the document (Ctrl+F).'),\n                    id: id + FIND_ID, text: locale.getConstant('Find'), cssClass: 'e-de-toolbar-btn'\n                },\n                {\n                    type: 'Separator', cssClass: 'e-de-separator'\n                },\n                {\n                    prefixIcon: 'e-de-ctnr-paste',\n                    tooltipText: locale.getConstant('Toggle between the internal clipboard and system clipboard'),\n                    id: id + CLIPBOARD_ID, text: this.onWrapText(locale.getConstant('Local Clipboard')),\n                    cssClass: 'e-de-toolbar-btn-first'\n                },\n                {\n                    prefixIcon: 'e-de-ctnr-lock', tooltipText: locale.getConstant('Restrict editing.'), id: id + RESTRICT_EDITING_ID,\n                    text: this.onWrapText(locale.getConstant('Restrict Editing')), cssClass: 'e-de-toolbar-btn-end'\n                }\n            ]\n        });\n    };\n    Toolbar.prototype.clickHandler = function (args) {\n        var id = this.container.element.id + TOOLBAR_ID;\n        switch (args.item.id) {\n            case id + NEW_ID:\n                this.container.documentEditor.openBlank();\n                break;\n            case id + OPEN_ID:\n                this.filePicker.value = '';\n                this.filePicker.click();\n                break;\n            case id + UNDO_ID:\n                this.container.documentEditor.editorHistory.undo();\n                break;\n            case id + REDO_ID:\n                this.container.documentEditor.editorHistory.redo();\n                break;\n            case id + INSERT_TABLE_ID:\n                this.container.documentEditor.showDialog('Table');\n                break;\n            case id + INSERT_LINK_ID:\n                this.container.documentEditor.showDialog('Hyperlink');\n                break;\n            case id + BOOKMARK_ID:\n                this.container.documentEditor.showDialog('Bookmark');\n                break;\n            case id + HEADER_ID:\n                this.container.documentEditor.selection.goToHeader();\n                break;\n            case id + TABLE_OF_CONTENT_ID:\n                this.onToc();\n                break;\n            case id + FOOTER_ID:\n                this.container.documentEditor.selection.goToFooter();\n                break;\n            case id + PAGE_SET_UP_ID:\n                this.container.documentEditor.showDialog('PageSetup');\n                break;\n            case id + PAGE_NUMBER_ID:\n                this.container.documentEditor.editor.insertPageNumber();\n                break;\n            case id + FIND_ID:\n                this.container.documentEditor.showOptionsPane();\n                break;\n            case id + CLIPBOARD_ID:\n                this.toggleLocalPaste(args.item.id);\n                break;\n            case id + RESTRICT_EDITING_ID:\n                this.toggleEditing(args.item.id);\n                break;\n        }\n        if (args.item.id !== id + FIND_ID) {\n            this.container.documentEditor.focusIn();\n        }\n    };\n    Toolbar.prototype.toggleLocalPaste = function (id) {\n        this.container.enableLocalPaste = !this.container.enableLocalPaste;\n        this.toggleButton(id, this.container.enableLocalPaste);\n    };\n    Toolbar.prototype.toggleEditing = function (id) {\n        this.container.restrictEditing = !this.container.restrictEditing;\n        this.container.showPropertiesPane = !this.container.restrictEditing;\n        this.toggleButton(id, this.container.restrictEditing);\n    };\n    Toolbar.prototype.toggleButton = function (id, toggle) {\n        var element = document.getElementById(id);\n        if (toggle) {\n            classList(element, ['e-btn-toggle'], []);\n        }\n        else {\n            classList(element, [], ['e-btn-toggle']);\n        }\n    };\n    Toolbar.prototype.togglePropertiesPane = function () {\n        this.container.showPropertiesPane = !this.container.showPropertiesPane;\n    };\n    Toolbar.prototype.onDropDownButtonSelect = function (args) {\n        var parentId = this.container.element.id + TOOLBAR_ID;\n        var id = args.item.id;\n        if (id === parentId + PAGE_BREAK) {\n            this.container.documentEditor.editorModule.insertPageBreak();\n        }\n        else if (id === parentId + SECTION_BREAK) {\n            this.container.documentEditor.editorModule.insertSectionBreak();\n        }\n        else if (id === parentId + INSERT_IMAGE_LOCAL_ID) {\n            this.imagePicker.value = '';\n            this.imagePicker.click();\n        }\n        else if (id === parentId + INSERT_IMAGE_ONLINE_ID) {\n            // Need to implement image dialog;\n        }\n    };\n    Toolbar.prototype.onFileChange = function () {\n        var _this = this;\n        var file = this.filePicker.files[0];\n        if (file) {\n            if (file.name.substr(file.name.lastIndexOf('.')) === '.sfdt') {\n                var fileReader_1 = new FileReader();\n                fileReader_1.onload = function () {\n                    _this.container.documentEditor.open(fileReader_1.result);\n                };\n                fileReader_1.readAsText(file);\n            }\n            else {\n                this.convertToSfdt(file);\n            }\n            this.container.documentEditor.documentName = file.name.substr(0, file.name.lastIndexOf('.'));\n        }\n    };\n    Toolbar.prototype.convertToSfdt = function (file) {\n        var _this = this;\n        var httpRequest = new XMLHttpRequest();\n        httpRequest.open('POST', this.container.serviceUrl, true);\n        httpRequest.onreadystatechange = function () {\n            if (httpRequest.readyState === 4) {\n                if (httpRequest.status === 200 || httpRequest.status === 304) {\n                    _this.container.documentEditor.open(httpRequest.responseText);\n                }\n                else {\n                    alert('Failed to load the file');\n                }\n                hideSpinner(_this.container.containerTarget);\n            }\n        };\n        var formData = new FormData();\n        formData.append('files', file);\n        httpRequest.send(formData);\n        showSpinner(this.container.containerTarget);\n    };\n    Toolbar.prototype.onImageChange = function () {\n        var _this = this;\n        var file = this.imagePicker.files[0];\n        var fileReader = new FileReader();\n        fileReader.onload = function () {\n            _this.insertImage(fileReader.result);\n        };\n        fileReader.readAsDataURL(file);\n    };\n    Toolbar.prototype.insertImage = function (data) {\n        var image = document.createElement('img');\n        var container = this.container;\n        image.addEventListener('load', function () {\n            container.documentEditor.editor.insertImage(data, this.width, this.height);\n        });\n        image.src = data;\n    };\n    /**\n     * @private\n     */\n    Toolbar.prototype.enableDisableToolBarItem = function (enable) {\n        var id = this.container.element.id + TOOLBAR_ID;\n        for (var _i = 0, _a = this.toolbar.items; _i < _a.length; _i++) {\n            var item = _a[_i];\n            var itemId = item.id;\n            if (itemId !== id + NEW_ID && itemId !== id + OPEN_ID && itemId !== id + FIND_ID &&\n                itemId !== id + CLIPBOARD_ID && itemId !== id + RESTRICT_EDITING_ID && item.type !== 'Separator') {\n                var element = document.getElementById(item.id);\n                this.toolbar.enableItems(element.parentElement, enable);\n            }\n        }\n        classList(this.propertiesPaneButton.element.parentElement, !enable ? ['e-de-overlay'] : [], !enable ? [] : ['e-de-overlay']);\n    };\n    /**\n     * @private\n     */\n    Toolbar.prototype.enableDisableUndoRedo = function () {\n        var id = this.container.element.id + TOOLBAR_ID;\n        // tslint:disable-next-line:max-line-length\n        this.toolbar.enableItems(document.getElementById(id + UNDO_ID).parentElement, this.container.documentEditor.editorHistory.canUndo());\n        this.toolbar.enableItems(document.getElementById(id + REDO_ID).parentElement, this.container.documentEditor.editorHistory.canRedo());\n    };\n    Toolbar.prototype.onToc = function () {\n        if (this.previousContext === 'TableOfContents' && this.showPropertiesPane) {\n            this.documentEditor.focusIn();\n            return;\n        }\n        if (this.container.headerFooterProperties.element.style.display === 'block') {\n            this.documentEditor.selection.closeHeaderFooter();\n        }\n        this.enableDisablePropertyPaneButton(false);\n        this.showPropertiesPane = true;\n        this.showProperties('toc');\n    };\n    /**\n     * @private\n     */\n    Toolbar.prototype.enableDisablePropertyPaneButton = function (isShow) {\n        if (isShow) {\n            classList(this.propertiesPaneButton.element.firstChild, ['e-pane-enabled'], ['e-pane-disabled']);\n        }\n        else {\n            classList(this.propertiesPaneButton.element.firstChild, ['e-pane-disabled'], ['e-pane-enabled']);\n        }\n    };\n    /**\n     * @private\n     */\n    Toolbar.prototype.destroy = function () {\n        if (this.toolbar) {\n            var toolbarElement = this.toolbar.element;\n            this.toolbar.destroy();\n            this.toolbar = undefined;\n            toolbarElement.parentElement.removeChild(toolbarElement);\n        }\n        this.container = undefined;\n    };\n    return Toolbar;\n}());\nexport { Toolbar };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar Dictionary = /** @class */ (function () {\n    function Dictionary() {\n        this.keysInternal = [];\n        this.valuesInternal = [];\n    }\n    Object.defineProperty(Dictionary.prototype, \"length\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.keysInternal.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Dictionary.prototype, \"keys\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.keysInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    Dictionary.prototype.add = function (key, value) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key or value is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        // if (index < 0 || index > this.keysInternal.length - 1) {\n        if (index < 0) {\n            this.keysInternal.push(key);\n            this.valuesInternal.push(value);\n        }\n        return 1;\n        // else {\n        //     throw new RangeError('An item with the same key has already been added.');\n        // }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.get = function (key) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            throw new RangeError('No item with the specified key has been added.');\n        }\n        else {\n            return this.valuesInternal[index];\n        }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.set = function (key, value) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            throw new RangeError('No item with the specified key has been added.');\n        }\n        else {\n            this.valuesInternal[index] = value;\n        }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.remove = function (key) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            throw new RangeError('No item with the specified key has been added.');\n        }\n        else {\n            this.keysInternal.splice(index, 1);\n            this.valuesInternal.splice(index, 1);\n            return true;\n        }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.containsKey = function (key) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.clear = function () {\n        this.keysInternal = [];\n        this.valuesInternal = [];\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.destroy = function () {\n        this.clear();\n        this.keysInternal = undefined;\n        this.valuesInternal = undefined;\n    };\n    return Dictionary;\n}());\nexport { Dictionary };\n","export * from './dictionary';\nexport * from './unique-format';\nexport * from './unique-formats';\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from './dictionary';\n/**\n * @private\n */\nvar WUniqueFormat = /** @class */ (function () {\n    function WUniqueFormat(type) {\n        this.referenceCount = 0;\n        this.uniqueFormatType = type;\n        this.propertiesHash = new Dictionary();\n    }\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isEqual = function (source, property, modifiedValue) {\n        var isEqual = false;\n        switch (this.uniqueFormatType) {\n            case 1:\n                isEqual = this.isBorderEqual(source, property, modifiedValue);\n                break;\n            case 2:\n                isEqual = this.isCharacterFormatEqual(source, property, modifiedValue);\n                break;\n            case 3:\n                isEqual = this.isParagraphFormatEqual(source, property, modifiedValue);\n                break;\n            case 4:\n                isEqual = this.isCellFormatEqual(source, property, modifiedValue);\n                break;\n            case 5:\n                isEqual = this.isShadingEqual(source, property, modifiedValue);\n                break;\n            case 6:\n                isEqual = this.isRowFormatEqual(source, property, modifiedValue);\n                break;\n            case 7:\n                isEqual = this.isListFormatEqual(source, property, modifiedValue);\n                break;\n            case 8:\n                isEqual = this.isTableFormatEqual(source, property, modifiedValue);\n                break;\n            case 9:\n                isEqual = this.isListLevelEqual(source, property, modifiedValue);\n                break;\n            case 10:\n                isEqual = this.isSectionFormatEqual(source, property, modifiedValue);\n                break;\n            default:\n                break;\n        }\n        return isEqual;\n    };\n    // tslint:disable-next-line:max-line-length\n    WUniqueFormat.prototype.isNotEqual = function (property, source, modifiedProperty, modifiedValue, uniqueFormatType) {\n        var targetValue = undefined;\n        var propertyType = WUniqueFormat.getPropertyType(uniqueFormatType, property);\n        if (this.propertiesHash.containsKey(propertyType)) {\n            targetValue = this.propertiesHash.get(propertyType);\n        }\n        var sourceValue = undefined;\n        if (property === modifiedProperty) {\n            sourceValue = modifiedValue;\n        }\n        else if (source.containsKey(propertyType)) {\n            sourceValue = source.get(propertyType);\n        }\n        // tslint:disable-next-line:max-line-length\n        if (!(targetValue === sourceValue || (!isNullOrUndefined(targetValue) && !isNullOrUndefined(sourceValue) && targetValue === sourceValue))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.getPropertyType = function (uniqueFormatType, property) {\n        var type = 0;\n        switch (uniqueFormatType) {\n            case 1:\n                type = this.getBorderPropertyType(property);\n                break;\n            case 2:\n                type = this.getCharacterFormatPropertyType(property);\n                break;\n            case 3:\n                type = this.getParaFormatPropertyType(property);\n                break;\n            case 4:\n                type = this.getCellFormatPropertyType(property);\n                break;\n            case 5:\n                type = this.getShadingPropertyType(property);\n                break;\n            case 6:\n                type = this.getRowFormatType(property);\n                break;\n            case 7:\n                type = this.getListFormatType(property);\n                break;\n            case 8:\n                type = this.getTableFormatType(property);\n                break;\n            case 9:\n                type = this.getListLevelType(property);\n                break;\n            case 10:\n                type = this.getSectionFormatType(property);\n                break;\n            default:\n                break;\n        }\n        return type;\n    };\n    WUniqueFormat.getRowFormatType = function (property) {\n        if (property === 'allowBreakAcrossPages') {\n            return 1;\n        }\n        if (property === 'isHeader') {\n            return 2;\n        }\n        if (property === 'height') {\n            return 3;\n        }\n        if (property === 'heightType') {\n            return 4;\n        }\n        if (property === 'gridBefore') {\n            return 5;\n        }\n        if (property === 'gridBeforeWidth') {\n            return 6;\n        }\n        if (property === 'gridBeforeWidthType') {\n            return 7;\n        }\n        if (property === 'gridAfter') {\n            return 8;\n        }\n        if (property === 'gridAfterWidth') {\n            return 9;\n        }\n        if (property === 'gridAfterWidthType') {\n            return 10;\n        }\n        return 0;\n    };\n    WUniqueFormat.getListFormatType = function (property) {\n        if (property === 'listId') {\n            return 1;\n        }\n        if (property === 'listLevelNumber') {\n            return 2;\n        }\n        return 0;\n    };\n    WUniqueFormat.getTableFormatType = function (property) {\n        if (property === 'leftMargin') {\n            return 1;\n        }\n        if (property === 'rightMargin') {\n            return 2;\n        }\n        if (property === 'topMargin') {\n            return 3;\n        }\n        if (property === 'bottomMargin') {\n            return 4;\n        }\n        if (property === 'cellSpacing') {\n            return 5;\n        }\n        if (property === 'leftIndent') {\n            return 6;\n        }\n        if (property === 'tableAlignment') {\n            return 7;\n        }\n        if (property === 'preferredWidth') {\n            return 8;\n        }\n        if (property === 'preferredWidthType') {\n            return 9;\n        }\n        if (property === 'bidi') {\n            return 10;\n        }\n        if (property === 'allowAutoFit') {\n            return 11;\n        }\n        return 0;\n    };\n    WUniqueFormat.getListLevelType = function (property) {\n        if (property === 'listLevelPattern') {\n            return 1;\n        }\n        if (property === 'startAt') {\n            return 2;\n        }\n        if (property === 'followCharacter') {\n            return 3;\n        }\n        if (property === 'numberFormat') {\n            return 4;\n        }\n        if (property === 'restartLevel') {\n            return 5;\n        }\n        return 0;\n    };\n    WUniqueFormat.getShadingPropertyType = function (property) {\n        if (property === 'backgroundColor') {\n            return 1;\n        }\n        if (property === 'foregroundColor') {\n            return 2;\n        }\n        if (property === 'textureStyle') {\n            return 3;\n        }\n        return 0;\n    };\n    WUniqueFormat.getCellFormatPropertyType = function (property) {\n        if (property === 'leftMargin') {\n            return 1;\n        }\n        if (property === 'rightMargin') {\n            return 2;\n        }\n        if (property === 'topMargin') {\n            return 3;\n        }\n        if (property === 'bottomMargin') {\n            return 4;\n        }\n        if (property === 'columnSpan') {\n            return 5;\n        }\n        if (property === 'rowSpan') {\n            return 6;\n        }\n        if (property === 'verticalAlignment') {\n            return 7;\n        }\n        if (property === 'preferredWidthType') {\n            return 8;\n        }\n        if (property === 'preferredWidth') {\n            return 9;\n        }\n        if (property === 'cellWidth') {\n            return 10;\n        }\n        return 0;\n    };\n    WUniqueFormat.getBorderPropertyType = function (property) {\n        if (property === 'color') {\n            return 1;\n        }\n        if (property === 'lineStyle') {\n            return 2;\n        }\n        if (property === 'lineWidth') {\n            return 3;\n        }\n        if (property === 'shadow') {\n            return 4;\n        }\n        if (property === 'space') {\n            return 5;\n        }\n        if (property === 'hasNoneStyle') {\n            return 6;\n        }\n        return 0;\n    };\n    WUniqueFormat.getCharacterFormatPropertyType = function (property) {\n        if (property === 'fontColor') {\n            return 1;\n        }\n        if (property === 'fontFamily') {\n            return 2;\n        }\n        if (property === 'fontSize') {\n            return 3;\n        }\n        if (property === 'bold') {\n            return 4;\n        }\n        if (property === 'italic') {\n            return 5;\n        }\n        if (property === 'underline') {\n            return 6;\n        }\n        if (property === 'strikethrough') {\n            return 7;\n        }\n        if (property === 'baselineAlignment') {\n            return 8;\n        }\n        if (property === 'highlightColor') {\n            return 9;\n        }\n        if (property === 'bidi') {\n            return 10;\n        }\n        if (property === 'bdo') {\n            return 11;\n        }\n        if (property === 'boldBidi') {\n            return 12;\n        }\n        if (property === 'italicBidi') {\n            return 13;\n        }\n        if (property === 'fontFamilyBidi') {\n            return 14;\n        }\n        if (property === 'fontSizeBidi') {\n            return 15;\n        }\n        return 0;\n    };\n    WUniqueFormat.getParaFormatPropertyType = function (property) {\n        if (property === 'leftIndent') {\n            return 1;\n        }\n        if (property === 'rightIndent') {\n            return 2;\n        }\n        if (property === 'firstLineIndent') {\n            return 3;\n        }\n        if (property === 'textAlignment') {\n            return 4;\n        }\n        if (property === 'beforeSpacing') {\n            return 5;\n        }\n        if (property === 'afterSpacing') {\n            return 6;\n        }\n        if (property === 'lineSpacing') {\n            return 7;\n        }\n        if (property === 'lineSpacingType') {\n            return 8;\n        }\n        if (property === 'outlineLevel') {\n            return 9;\n        }\n        if (property === 'bidi') {\n            return 10;\n        }\n        return 0;\n    };\n    WUniqueFormat.getSectionFormatType = function (property) {\n        if (property === 'headerDistance') {\n            return 1;\n        }\n        if (property === 'footerDistance') {\n            return 2;\n        }\n        if (property === 'differentFirstPage') {\n            return 3;\n        }\n        if (property === 'differentOddAndEvenPages') {\n            return 4;\n        }\n        if (property === 'pageWidth') {\n            return 5;\n        }\n        if (property === 'pageHeight') {\n            return 6;\n        }\n        if (property === 'leftMargin') {\n            return 7;\n        }\n        if (property === 'topMargin') {\n            return 8;\n        }\n        if (property === 'rightMargin') {\n            return 9;\n        }\n        if (property === 'bottomMargin') {\n            return 10;\n        }\n        if (property === 'bidi') {\n            return 11;\n        }\n        return 0;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isBorderEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('color', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('lineStyle', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('lineWidth', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('shadow', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('space', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('hasNoneStyle', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isCharacterFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('fontColor', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('fontFamily', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('fontSize', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('bold', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('italic', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('underline', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('strikethrough', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('baselineAlignment', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('highlightColor', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('bidi', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('bdo', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('fontColor', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('fontFamilyBidi', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('fontSizeBidi', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('boldBidi', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('italicBidi', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        return true;\n    };\n    WUniqueFormat.prototype.isParagraphFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('leftIndent', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('rightIndent', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('firstLineIndent', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('textAlignment', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('beforeSpacing', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('afterSpacing', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('lineSpacing', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('lineSpacingType', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('outlineLevel', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('bidi', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isCellFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('leftMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('rightMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('topMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('bottomMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('columnSpan', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('rowSpan', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('verticalAlignment', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidthType', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidth', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('cellWidth', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isShadingEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('backgroundColor', source, modifiedProperty, modifiedValue, 5)) {\n            return false;\n        }\n        if (this.isNotEqual('foregroundColor', source, modifiedProperty, modifiedValue, 5)) {\n            return false;\n        }\n        if (this.isNotEqual('textureStyle', source, modifiedProperty, modifiedValue, 5)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isRowFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('allowBreakAcrossPages', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('isHeader', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('height', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('heightType', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridBefore', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridBeforeWidth', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridBeforeWidthType', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridAfter', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridAfterWidth', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridAfterWidthType', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isListFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('listId', source, modifiedProperty, modifiedValue, 7)) {\n            return false;\n        }\n        if (this.isNotEqual('listLevelNumber', source, modifiedProperty, modifiedValue, 7)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isTableFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('leftMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('rightMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('topMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('bottomMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('cellSpacing', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('leftIndent', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('tableAlignment', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidth', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidthType', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('bidi', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('allowAutoFit', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isListLevelEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('listLevelPattern', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('startAt', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('followCharacter', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('numberFormat', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('restartLevel', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isSectionFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('headerDistance', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('footerDistance', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('differentFirstPage', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('differentOddAndEvenPages', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('pageWidth', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('pageHeight', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('leftMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('topMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('rightMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('bottomMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('bidi', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.cloneItems = function (format, property, value, uniqueFormatType) {\n        var propertyType = WUniqueFormat.getPropertyType(uniqueFormatType, property);\n        var keys = format.propertiesHash.keys;\n        for (var i = 0; i < keys.length; i++) {\n            if (keys[i] === propertyType) {\n                this.propertiesHash.add(propertyType, value);\n            }\n            else {\n                this.propertiesHash.add(keys[i], format.propertiesHash.get(keys[i]));\n            }\n        }\n        if (!format.propertiesHash.containsKey(propertyType)) {\n            this.propertiesHash.add(propertyType, value);\n        }\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.mergeProperties = function (format) {\n        var hash = format.cloneProperties();\n        var keys = this.propertiesHash.keys;\n        for (var i = 0; i < keys.length; i++) {\n            if (!hash.containsKey(keys[i])) {\n                hash.add(keys[i], this.propertiesHash.get(keys[i]));\n            }\n        }\n        return hash;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.cloneProperties = function () {\n        var hash = new Dictionary();\n        var keys = this.propertiesHash.keys;\n        for (var i = 0; i < keys.length; i++) {\n            hash.add(keys[i], this.propertiesHash.get(keys[i]));\n        }\n        return hash;\n    };\n    // public cloneItemsInternal(format: WUniqueFormat): void {\n    //     let keys: number[] = format.propertiesHash.getItem();\n    //     for (let i: number = 0; i < keys.length; i++) {\n    //         this.propertiesHash.add(keys[i], format.propertiesHash.get(keys[i]));\n    //     }\n    //     this.referenceCount = format.referenceCount;\n    // }\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.propertiesHash)) {\n            this.propertiesHash.destroy();\n        }\n        this.propertiesHash = undefined;\n        this.referenceCount = undefined;\n        this.uniqueFormatType = undefined;\n    };\n    return WUniqueFormat;\n}());\nexport { WUniqueFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WUniqueFormat } from './unique-format';\n/**\n * @private\n */\nvar WUniqueFormats = /** @class */ (function () {\n    function WUniqueFormats() {\n        this.items = [];\n    }\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.addUniqueFormat = function (format, type) {\n        var matchedFormat = undefined;\n        for (var i = 0; i < this.items.length; i++) {\n            if (this.items[i].isEqual(format, undefined, undefined)) {\n                matchedFormat = this.items[i];\n                break;\n            }\n        }\n        if (isNullOrUndefined(matchedFormat)) {\n            matchedFormat = new WUniqueFormat(type);\n            matchedFormat.propertiesHash = format;\n            matchedFormat.referenceCount = 1;\n            this.items.push(matchedFormat);\n        }\n        else {\n            matchedFormat.referenceCount++;\n        }\n        return matchedFormat;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.updateUniqueFormat = function (uniqueFormat, property, value) {\n        var matchedFormat = undefined;\n        for (var i = 0; i < this.items.length; i++) {\n            if (this.items[i].isEqual(uniqueFormat.propertiesHash, property, value)) {\n                matchedFormat = this.items[i];\n                break;\n            }\n        }\n        if (isNullOrUndefined(matchedFormat)) {\n            matchedFormat = new WUniqueFormat(uniqueFormat.uniqueFormatType);\n            matchedFormat.cloneItems(uniqueFormat, property, value, uniqueFormat.uniqueFormatType);\n            matchedFormat.referenceCount = 1;\n            this.items.push(matchedFormat);\n        }\n        else {\n            matchedFormat.referenceCount++;\n        }\n        this.remove(uniqueFormat);\n        uniqueFormat = undefined;\n        return matchedFormat;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.remove = function (uniqueFormat) {\n        uniqueFormat.referenceCount--;\n        if (uniqueFormat.referenceCount <= 0) {\n            this.items.splice(this.items.indexOf(uniqueFormat), 1);\n            uniqueFormat.destroy();\n            uniqueFormat = undefined;\n        }\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.clear = function () {\n        if (isNullOrUndefined(this.items)) {\n            for (var i = 0; i < this.items.length; i++) {\n                this.items[i].destroy();\n            }\n        }\n        this.items = [];\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.destroy = function () {\n        this.clear();\n        this.items = undefined;\n    };\n    return WUniqueFormats;\n}());\nexport { WUniqueFormats };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Event } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, L10n, Browser } from '@syncfusion/ej2-base';\nimport { Save } from '@syncfusion/ej2-file-utils';\nimport { LayoutViewer, PageLayoutViewer, BulletsAndNumberingDialog } from './index';\nimport { Print } from './index';\nimport { BodyWidget, ParagraphWidget } from './index';\nimport { WSectionFormat, WParagraphFormat, WCharacterFormat } from './index';\nimport { SfdtReader } from './index';\nimport { Selection } from './index';\nimport { Editor, EditorHistory } from './index';\nimport { WStyles } from './index';\nimport { Search } from './index';\nimport { OptionsPane } from './index';\nimport { WordExport } from './index';\nimport { TextExport } from './index';\nimport { ContextMenu } from './index';\nimport { ImageResizer } from './index';\nimport { SfdtExport } from './index';\nimport { HyperlinkDialog, TableDialog, BookmarkDialog, StylesDialog, TableOfContentsDialog } from './index';\nimport { PageSetupDialog, ParagraphDialog, ListDialog, StyleDialog, FontDialog } from './index';\nimport { TablePropertiesDialog, BordersAndShadingDialog, CellOptionsDialog, TableOptionsDialog } from './index';\n/**\n * The Document editor component is used to draft, save or print rich text contents as page by page.\n */\nvar DocumentEditor = /** @class */ (function (_super) {\n    __extends(DocumentEditor, _super);\n    /**\n     * Initialize the constructor of DocumentEditor\n     */\n    function DocumentEditor(options, element) {\n        var _this = _super.call(this, options, element) || this;\n        //Internal Variable\n        _this.enableHeaderFooterIn = false;\n        /**\n         * @private\n         */\n        _this.isShiftingEnabled = false;\n        /**\n         * @private\n         */\n        _this.isLayoutEnabled = true;\n        /**\n         * @private\n         */\n        _this.isPastingContent = false;\n        /**\n         * @private\n         */\n        _this.parser = undefined;\n        _this.disableHistoryIn = false;\n        /**\n         * @private\n         */\n        _this.findResultsList = undefined;\n        /**\n         * Gets or sets the name of the document.\n         */\n        _this.documentName = '';\n        /**\n         * @private\n         */\n        _this.tablePropertiesDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.bordersAndShadingDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.cellOptionsDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.tableOptionsDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.paragraphDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.imageResizerModule = undefined;\n        /**\n         * Gets or Sets a value indicating whether holding Ctrl key is required to follow hyperlink on click. The default value is true.\n         */\n        _this.useCtrlClickToFollowHyperlink = true;\n        /**\n         * Gets or sets the page outline color.\n         */\n        _this.pageOutline = '#000000';\n        /**\n         * Gets or sets a value indicating whether to enable cursor in document editor on read only state or not. The default value is false.\n         */\n        _this.enableCursorOnReadOnly = false;\n        /**\n         * Gets or sets a value indicating whether local paste needs to be enabled or not.\n         */\n        _this.enableLocalPaste = false;\n        /**\n         * @private\n         */\n        _this.defaultLocale = {\n            'Table': 'Table',\n            'Row': 'Row',\n            'Cell': 'Cell',\n            'Ok': 'Ok',\n            'Cancel': 'Cancel',\n            'Size': 'Size',\n            'Preferred Width': 'Preferred width',\n            'Points': 'Points',\n            'Percent': 'Percent',\n            'Measure in': 'Measure in',\n            'Alignment': 'Alignment',\n            'Left': 'Left',\n            'Center': 'Center',\n            'Right': 'Right',\n            'Justify': 'Justify',\n            'Indent from left': 'Indent from left',\n            'Borders and Shading': 'Borders and Shading',\n            'Options': 'Options',\n            'Specify height': 'Specify height',\n            'At least': 'At least',\n            'Exactly': 'Exactly',\n            'Row height is': 'Row height is',\n            'Allow row to break across pages': 'Allow row to break across pages',\n            'Repeat as header row at the top of each page': 'Repeat as header row at the top of each page',\n            'Vertical alignment': 'Vertical alignment',\n            'Top': 'Top',\n            'Bottom': 'Bottom',\n            'Default cell margins': 'Default cell margins',\n            'Default cell spacing': 'Default cell spacing',\n            'Allow spacing between cells': 'Allow spacing between cells',\n            'Cell margins': 'Cell margins',\n            'Same as the whole table': 'Same as the whole table',\n            'Borders': 'Borders',\n            'None': 'None',\n            'Single': 'Single',\n            'Dot': 'Dot',\n            'DashSmallGap': 'DashSmallGap',\n            'DashLargeGap': 'DashLargeGap',\n            'DashDot': 'DashDot',\n            'DashDotDot': 'DashDotDot',\n            'Double': 'Double',\n            'Triple': 'Triple',\n            'ThinThickSmallGap': 'ThinThickSmallGap',\n            'ThickThinSmallGap': 'ThickThinSmallGap',\n            'ThinThickThinSmallGap': 'ThinThickThinSmallGap',\n            'ThinThickMediumGap': 'ThinThickMediumGap',\n            'ThickThinMediumGap': 'ThickThinMediumGap',\n            'ThinThickThinMediumGap': 'ThinThickThinMediumGap',\n            'ThinThickLargeGap': 'ThinThickLargeGap',\n            'ThickThinLargeGap': 'ThickThinLargeGap',\n            'ThinThickThinLargeGap': 'ThinThickThinLargeGap',\n            'SingleWavy': 'SingleWavy',\n            'DoubleWavy': 'DoubleWavy',\n            'DashDotStroked': 'DashDotStroked',\n            'Emboss3D': 'Emboss3D',\n            'Engrave3D': 'Engrave3D',\n            'Outset': 'Outset',\n            'Inset': 'Inset',\n            'Thick': 'Thick',\n            'Style': 'Style',\n            'Width': 'Width',\n            'Height': 'Height',\n            'Letter': 'Letter',\n            'Tabloid': 'Tabloid',\n            'Legal': 'Legal',\n            'Statement': 'Statement',\n            'Executive': 'Executive',\n            'A3': 'A3',\n            'A4': 'A4',\n            'A5': 'A5',\n            'B4': 'B4',\n            'B5': 'B5',\n            'Custom Size': 'Custom size',\n            'Different odd and even': 'Different odd and even',\n            'Different first page': 'Different first page',\n            'From edge': 'From edge',\n            'Header': 'Header',\n            'Footer': 'Footer',\n            'Margin': 'Margins',\n            'Paper': 'Paper',\n            'Layout': 'Layout',\n            'Orientation': 'Orientation',\n            'Landscape': 'Landscape',\n            'Portrait': 'Portrait',\n            'Table Of Contents': 'Table Of Contents',\n            'Show page numbers': 'Show page numbers',\n            'Right align page numbers': 'Right align page numbers',\n            'Nothing': 'Nothing',\n            'Tab leader': 'Tab leader',\n            'Show levels': 'Show levels',\n            'Use hyperlinks instead of page numbers': 'Use hyperlinks instead of page numbers',\n            'Build table of contents from': 'Build table of contents from',\n            'Styles': 'Styles',\n            'Available styles': 'Available styles',\n            'TOC level': 'TOC level',\n            'Heading': 'Heading',\n            'Heading 1': 'Heading 1',\n            'Heading 2': 'Heading 2',\n            'Heading 3': 'Heading 3',\n            'Heading 4': 'Heading 4',\n            'Heading 5': 'Heading 5',\n            'Heading 6': 'Heading 6',\n            'List Paragraph': 'List Paragraph',\n            'Normal': 'Normal',\n            'Outline levels': 'Outline levels',\n            'Table entry fields': 'Table entry fields',\n            'Modify': 'Modify',\n            'Color': 'Color',\n            'Setting': 'Setting',\n            'Box': 'Box',\n            'All': 'All',\n            'Custom': 'Custom',\n            'Preview': 'Preview',\n            'Shading': 'Shading',\n            'Fill': 'Fill',\n            'Apply To': 'Apply to',\n            'Table Properties': 'Table Properties',\n            'Cell Options': 'Cell Options',\n            'Table Options': 'Table Options',\n            'Insert Table': 'Insert Table',\n            'Number of columns': 'Number of columns',\n            'Number of rows': 'Number of rows',\n            'Text to display': 'Text to display',\n            'Address': 'Address',\n            'Insert Hyperlink': 'Insert Hyperlink',\n            'Edit Hyperlink': 'Edit Hyperlink',\n            'Insert': 'Insert',\n            'General': 'General',\n            'Indentation': 'Indentation',\n            'Before text': 'Before text',\n            'Special': 'Special',\n            'First line': 'First line',\n            'Hanging': 'Hanging',\n            'After text': 'After text',\n            'By': 'By',\n            'Before': 'Before',\n            'Line Spacing': 'Line spacing',\n            'After': 'After',\n            'At': 'At',\n            'Multiple': 'Multiple',\n            'Spacing': 'Spacing',\n            'Define new Multilevel list': 'Define new Multilevel list',\n            'List level': 'List level',\n            'Choose level to modify': 'Choose level to modify',\n            'Level': 'Level',\n            'Number format': 'Number format',\n            'Number style for this level': 'Number style for this level',\n            'Enter formatting for number': 'Enter formatting for number',\n            'Start at': 'Start at',\n            'Restart list after': 'Restart list after',\n            'Position': 'Position',\n            'Text indent at': 'Text indent at',\n            'Aligned at': 'Aligned at',\n            'Follow number with': 'Follow number with',\n            'Tab character': 'Tab character',\n            'Space': 'Space',\n            'Arabic': 'Arabic',\n            'UpRoman': 'UpRoman',\n            'LowRoman': 'LowRoman',\n            'UpLetter': 'UpLetter',\n            'LowLetter': 'LowLetter',\n            'Number': 'Number',\n            'Leading zero': 'Leading zero',\n            'Bullet': 'Bullet',\n            'Ordinal': 'Ordinal',\n            'Ordinal Text': 'Ordinal Text',\n            'For East': 'For East',\n            'No Restart': 'No Restart',\n            'Font': 'Font',\n            'Font style': 'Font style',\n            'Underline style': 'Underline style',\n            'Font color': 'Font color',\n            'Effects': 'Effects',\n            'Strikethrough': 'Strikethrough',\n            'Superscript': 'Superscript',\n            'Subscript': 'Subscript',\n            'Double strikethrough': 'Double strikethrough',\n            'Regular': 'Regular',\n            'Bold': 'Bold',\n            'Italic': 'Italic',\n            'Cut': 'Cut',\n            'Copy': 'Copy',\n            'Paste': 'Paste',\n            'Hyperlink': 'Hyperlink',\n            'Open Hyperlink': 'Open Hyperlink',\n            'Copy Hyperlink': 'Copy Hyperlink',\n            'Remove Hyperlink': 'Remove Hyperlink',\n            'Paragraph': 'Paragraph',\n            'Linked(Paragraph and Character)': 'Linked(Paragraph and Character)',\n            'Character': 'Character',\n            'Merge Cells': 'Merge Cells',\n            'Insert Above': 'Insert Above',\n            'Insert Below': 'Insert Below',\n            'Insert Left': 'Insert Left',\n            'Insert Right': 'Insert Right',\n            'Delete': 'Delete',\n            'Delete Table': 'Delete Table',\n            'Delete Row': 'Delete Row',\n            'Delete Column': 'Delete Column',\n            'File Name': 'File Name',\n            'Format Type': 'Format Type',\n            'Save': 'Save',\n            'Navigation': 'Navigation',\n            'Results': 'Results',\n            'Replace': 'Replace',\n            'Replace All': 'Replace All',\n            'We replaced all': 'We replaced all',\n            'Find': 'Find',\n            'No matches': 'No matches',\n            'All Done': 'All Done',\n            'Result': 'Result',\n            'of': 'of',\n            'instances': 'instances',\n            'with': 'with',\n            'Click to follow link': 'Click to follow link',\n            'Continue Numbering': 'Continue Numbering',\n            'Bookmark name': 'Bookmark name',\n            'Close': 'Close',\n            'Restart At': 'Restart At',\n            'Properties': 'Properties',\n            'Name': 'Name',\n            'Style type': 'Style type',\n            'Style based on': 'Style based on',\n            'Style for following paragraph': 'Style for following paragraph',\n            'Formatting': 'Formatting',\n            'Numbering and Bullets': 'Numbering and Bullets',\n            'Numbering': 'Numbering',\n            'Update Field': 'Update Field',\n            'Edit Field': 'Edit Field',\n            'Bookmark': 'Bookmark',\n            'Page Setup': 'Page Setup',\n            'No bookmarks found': 'No bookmarks found',\n            'Number format tooltip information': 'Single-level number format: </br>[PREFIX]%[LEVELNUMBER][SUFFIX]</br>'\n                + 'For example, \"Chapter %1.\" will display numbering like</br>Chapter 1. Item</br>Chapter 2. Item</br>…'\n                + '</br>Chapter N. Item</br>'\n                + '</br>Multilevel number format:</br>[PREFIX]%[LEVELNUMBER][SUFFIX]+[PREFIX]%[LEVELNUMBER][SUFFIX]'\n                + '</br>For example, \"%1.%2.\" will display numbering like</br>1.1. Item</br>1.2. Item</br>…</br>1.N. Item',\n            'Format': 'Format',\n            'Create New Style': 'Create New Style',\n            'Modify Style': 'Modify Style',\n            'New': 'New',\n            'Bullets': 'Bullets',\n            'Use bookmarks': 'Use bookmarks',\n            'Table of Contents': 'Table of Contents',\n            'AutoFit': 'AutoFit',\n            'AutoFit to Contents': 'AutoFit to Contents',\n            'AutoFit to Window': 'AutoFit to Window',\n            'Fixed Column Width': 'Fixed Column Width',\n            'Reset': 'Reset',\n            'Match case': 'Match case',\n            'Whole words': 'Whole words',\n            'Add': 'Add',\n            'Go To': 'Go To',\n            'Search for': 'Search for',\n            'Replace with': 'Replace with',\n            'TOC 1': 'TOC 1',\n            'TOC 2': 'TOC 2',\n            'TOC 3': 'TOC 3',\n            'TOC 4': 'TOC 4',\n            'TOC 5': 'TOC 5',\n            'TOC 6': 'TOC 6',\n            'TOC 7': 'TOC 7',\n            'TOC 8': 'TOC 8',\n            'TOC 9': 'TOC 9',\n            'Right-to-left': 'Right-to-left',\n            'Left-to-right': 'Left-to-right',\n            'Direction': 'Direction',\n            'Table direction': 'Table direction',\n            'Indent from right': 'Indent from right'\n        };\n        _this.viewer = new PageLayoutViewer(_this);\n        _this.parser = new SfdtReader(_this.viewer);\n        return _this;\n    }\n    DocumentEditor_1 = DocumentEditor;\n    Object.defineProperty(DocumentEditor.prototype, \"enableHeaderAndFooter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.enableHeaderFooterIn;\n        },\n        set: function (value) {\n            this.enableHeaderFooterIn = value;\n            this.viewer.updateScrollBars();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"pageCount\", {\n        /**\n         * Gets the total number of pages.\n         */\n        get: function () {\n            if (!this.isDocumentLoaded || isNullOrUndefined(this.viewer)) {\n                return 1;\n            }\n            return this.viewer.pages.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"selection\", {\n        /**\n         *  Gets the selection object of the document editor.\n         * @returns Selection\n         * @default undefined\n         */\n        get: function () {\n            return this.selectionModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"editor\", {\n        /**\n         *  Gets the editor object of the document editor.\n         * @returns Editor\n         * @default undefined\n         */\n        get: function () {\n            return this.editorModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"editorHistory\", {\n        /**\n         * Gets the editor history object of the document editor.\n         * @returns EditorHistory\n         */\n        get: function () {\n            return this.editorHistoryModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"search\", {\n        /**\n         * Gets the search object of the document editor.\n         * @returns { Search }\n         */\n        get: function () {\n            return this.searchModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"contextMenu\", {\n        /**\n         * Gets the context menu object of the document editor.\n         * @returns ContextMenu\n         */\n        get: function () {\n            return this.contextMenuModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"containerId\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.element.id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"isDocumentLoaded\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.isDocumentLoadedIn;\n        },\n        set: function (value) {\n            this.isDocumentLoadedIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"enableHistoryMode\", {\n        /**\n         * Determines whether history needs to be enabled or not.\n         * @default - false\n         * @private\n         */\n        get: function () {\n            return this.enableEditorHistory && !isNullOrUndefined(this.editorHistoryModule);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"documentStart\", {\n        /**\n         * Gets the start text position in the document.\n         * @default undefined\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.selectionModule)) {\n                return this.selection.getDocumentStart();\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"documentEnd\", {\n        /**\n         * Gets the end text position in the document.\n         * @default undefined\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.selectionModule)) {\n                return this.selection.getDocumentEnd();\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"isReadOnlyMode\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.isReadOnly || isNullOrUndefined(this.editorModule) || isNullOrUndefined(this.selectionModule);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"enableImageResizerMode\", {\n        /**\n         * Specifies to enable image resizer option\n         * default - false\n         * @private\n         */\n        get: function () {\n            return this.enableImageResizer && !isNullOrUndefined(this.imageResizerModule);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    DocumentEditor.prototype.preRender = function () {\n        this.findResultsList = [];\n        //pre render section\n    };\n    DocumentEditor.prototype.render = function () {\n        this.viewer.initializeComponents();\n        this.openBlank();\n        if (!isNullOrUndefined(this.element)) {\n            var container = this.element;\n            container.style.minHeight = '200px';\n            container.style.minWidth = '200px';\n        }\n    };\n    /**\n     * Get component name\n     * @private\n     */\n    DocumentEditor.prototype.getModuleName = function () {\n        return 'DocumentEditor';\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @private\n     */\n    DocumentEditor.prototype.onPropertyChanged = function (model, oldProp) {\n        for (var _i = 0, _a = Object.keys(model); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'zoomFactor':\n                    if (this.viewer) {\n                        this.viewer.zoomFactor = model.zoomFactor;\n                    }\n                    break;\n                case 'locale':\n                    this.localizeDialogs();\n                    break;\n                case 'isReadOnly':\n                    if (!isNullOrUndefined(this.optionsPaneModule) && this.optionsPaneModule.isOptionsPaneShow) {\n                        this.optionsPaneModule.showHideOptionsPane(false);\n                    }\n                    break;\n            }\n        }\n    };\n    DocumentEditor.prototype.localizeDialogs = function () {\n        if (this.locale !== '') {\n            var l10n = new L10n('documenteditor', this.defaultLocale);\n            l10n.setLocale(this.locale);\n            if (this.optionsPaneModule) {\n                this.optionsPaneModule.initOptionsPane(l10n);\n            }\n            if (this.paragraphDialogModule) {\n                this.paragraphDialogModule.initParagraphDialog(l10n);\n            }\n            if (this.pageSetupDialogModule) {\n                this.pageSetupDialogModule.initPageSetupDialog(l10n);\n            }\n            if (this.fontDialogModule) {\n                this.fontDialogModule.initFontDialog(l10n);\n            }\n            if (this.hyperlinkDialogModule) {\n                this.hyperlinkDialogModule.initHyperlinkDialog(l10n);\n            }\n            if (this.contextMenuModule) {\n                this.contextMenuModule.initContextMenu(l10n);\n            }\n            if (this.listDialogModule) {\n                this.listDialogModule.initListDialog(l10n);\n            }\n            if (this.tablePropertiesDialogModule) {\n                this.tablePropertiesDialogModule.initTablePropertyDialog(l10n);\n            }\n            if (this.bordersAndShadingDialogModule) {\n                this.bordersAndShadingDialogModule.initBordersAndShadingsDialog(l10n);\n            }\n            if (this.cellOptionsDialogModule) {\n                this.cellOptionsDialogModule.initCellMarginsDialog(l10n);\n            }\n            if (this.tableOptionsDialogModule) {\n                this.tableOptionsDialogModule.initTableOptionsDialog(l10n);\n            }\n            if (this.tableDialogModule) {\n                this.tableDialogModule.initTableDialog(l10n);\n            }\n            if (this.styleDialogModule) {\n                this.styleDialogModule.initStyleDialog(l10n);\n            }\n            if (this.tableOfContentsDialogModule) {\n                this.tableOfContentsDialogModule.initTableOfContentDialog(l10n);\n            }\n        }\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @private\n     */\n    DocumentEditor.prototype.getPersistData = function () {\n        return 'documenteditor';\n    };\n    DocumentEditor.prototype.clearPreservedCollectionsInViewer = function () {\n        if (this.viewer instanceof LayoutViewer) {\n            this.viewer.clearDocumentItems();\n        }\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.getDocumentEditorElement = function () {\n        return this.element;\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireContentChange = function () {\n        var eventArgs = { source: this };\n        this.trigger('contentChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireDocumentChange = function () {\n        var eventArgs = { source: this };\n        this.trigger('documentChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireSelectionChange = function () {\n        if (!this.viewer.isCompositionStart && Browser.isDevice && this.editorModule) {\n            this.editorModule.predictText();\n        }\n        var eventArgs = { source: this };\n        this.trigger('selectionChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireZoomFactorChange = function () {\n        var eventArgs = { source: this };\n        this.trigger('zoomFactorChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireViewChange = function () {\n        if (this.viewer && this.viewer.pages.length > 0) {\n            if (this.viewer.visiblePages.length > 0) {\n                var pages = this.viewer.visiblePages;\n                var eventArgs = {\n                    startPage: pages[0].index + 1,\n                    endPage: pages[pages.length - 1].index + 1,\n                    source: this\n                };\n                this.trigger('viewChange', eventArgs);\n            }\n        }\n    };\n    /**\n     * Shows the Paragraph dialog\n     * @private\n     */\n    DocumentEditor.prototype.showParagraphDialog = function (paragraphFormat) {\n        if (this.paragraphDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.paragraphDialogModule.show(paragraphFormat);\n        }\n    };\n    /**\n     * Shows the margin dialog\n     * @private\n     */\n    DocumentEditor.prototype.showPageSetupDialog = function () {\n        if (this.pageSetupDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.pageSetupDialogModule.show();\n        }\n    };\n    /**\n     * Shows the font dialog\n     * @private\n     */\n    DocumentEditor.prototype.showFontDialog = function (characterFormat) {\n        if (this.fontDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.fontDialogModule.showFontDialog(characterFormat);\n        }\n    };\n    /**\n     * Shows the cell option dialog\n     * @private\n     */\n    DocumentEditor.prototype.showCellOptionsDialog = function () {\n        if (this.cellOptionsDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.cellOptionsDialogModule.show();\n        }\n    };\n    /**\n     * Shows the table options dialog.\n     * @private\n     */\n    DocumentEditor.prototype.showTableOptionsDialog = function () {\n        if (this.tableOptionsDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tableOptionsDialogModule.show();\n        }\n    };\n    /**\n     * Shows insert table dialog\n     * @private\n     */\n    DocumentEditor.prototype.showTableDialog = function () {\n        if (this.tableDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tableDialogModule.show();\n        }\n    };\n    /**\n     * Shows the table of content dialog\n     * @private\n     */\n    DocumentEditor.prototype.showTableOfContentsDialog = function () {\n        if (this.tableOfContentsDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tableOfContentsDialogModule.show();\n        }\n    };\n    /* tslint:enable:no-any */\n    /**\n     * Shows the style dialog\n     * @private\n     */\n    DocumentEditor.prototype.showStyleDialog = function () {\n        if (this.styleDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.styleDialogModule.show();\n        }\n    };\n    /**\n     * Shows the hyperlink dialog\n     * @private\n     */\n    DocumentEditor.prototype.showHyperlinkDialog = function () {\n        if (this.hyperlinkDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.hyperlinkDialogModule.show();\n        }\n    };\n    /**\n     * Shows the bookmark dialog.\n     * @private\n     */\n    DocumentEditor.prototype.showBookmarkDialog = function () {\n        if (this.bookmarkDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.bookmarkDialogModule.show();\n        }\n    };\n    /**\n     * Shows the styles dialog.\n     * @private\n     */\n    DocumentEditor.prototype.showStylesDialog = function () {\n        if (this.stylesDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.stylesDialogModule.show();\n        }\n    };\n    /**\n     * Shows the List dialog\n     * @private\n     */\n    DocumentEditor.prototype.showListDialog = function () {\n        if (this.listDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.listDialogModule.showListDialog();\n        }\n    };\n    /**\n     * Shows the table properties dialog\n     * @private\n     */\n    DocumentEditor.prototype.showTablePropertiesDialog = function () {\n        if (this.tablePropertiesDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tablePropertiesDialogModule.show();\n        }\n    };\n    /**\n     * Shows the borders and shading dialog\n     * @private\n     */\n    DocumentEditor.prototype.showBordersAndShadingDialog = function () {\n        if (this.bordersAndShadingDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.bordersAndShadingDialogModule.show();\n        }\n    };\n    //tslint:disable: max-func-body-length\n    DocumentEditor.prototype.requiredModules = function () {\n        var modules = [];\n        if (this.enablePrint) {\n            modules.push({\n                member: 'Print', args: []\n            });\n        }\n        if (this.enableSfdtExport || this.enableWordExport || this.enableTextExport || this.enableSelection || this.enableEditor) {\n            modules.push({\n                member: 'SfdtExport', args: [this.viewer]\n            });\n        }\n        if (this.enableWordExport) {\n            modules.push({\n                member: 'WordExport', args: []\n            });\n        }\n        if (this.enableTextExport) {\n            modules.push({\n                member: 'TextExport', args: []\n            });\n        }\n        if (this.enableSelection || this.enableSearch || this.enableEditor) {\n            modules.push({\n                member: 'Selection', args: [this]\n            });\n            if (this.enableContextMenu) {\n                modules.push({\n                    member: 'ContextMenu', args: [this.viewer]\n                });\n            }\n        }\n        if (this.enableSearch) {\n            modules.push({\n                member: 'Search', args: [this]\n            });\n            if (this.enableOptionsPane) {\n                modules.push({\n                    member: 'OptionsPane', args: [this.viewer]\n                });\n            }\n        }\n        if (this.enableEditor) {\n            modules.push({\n                member: 'Editor', args: [this.viewer]\n            });\n            if (this.enableImageResizer) {\n                modules.push({\n                    member: 'ImageResizer', args: [this, this.viewer]\n                });\n            }\n            if (this.enableEditorHistory) {\n                modules.push({\n                    member: 'EditorHistory', args: [this]\n                });\n            }\n            if (this.enableHyperlinkDialog) {\n                modules.push({\n                    member: 'HyperlinkDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTableDialog) {\n                modules.push({\n                    member: 'TableDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableBookmarkDialog) {\n                modules.push({\n                    member: 'BookmarkDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTableOfContentsDialog) {\n                modules.push({\n                    member: 'TableOfContentsDialog', args: [this.viewer]\n                });\n            }\n            if (this.enablePageSetupDialog) {\n                modules.push({\n                    member: 'PageSetupDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableStyleDialog) {\n                modules.push({\n                    member: 'StylesDialog', args: [this.viewer]\n                });\n                modules.push({\n                    member: 'StyleDialog', args: [this.viewer]\n                });\n                modules.push({\n                    member: 'BulletsAndNumberingDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableListDialog) {\n                modules.push({\n                    member: 'ListDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableParagraphDialog) {\n                modules.push({\n                    member: 'ParagraphDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableFontDialog) {\n                modules.push({\n                    member: 'FontDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTablePropertiesDialog) {\n                modules.push({\n                    member: 'TablePropertiesDialog', args: [this.viewer]\n                });\n                modules.push({\n                    member: 'CellOptionsDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableBordersAndShadingDialog) {\n                modules.push({\n                    member: 'BordersAndShadingDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTableOptionsDialog) {\n                modules.push({\n                    member: 'TableOptionsDialog', args: [this.viewer]\n                });\n            }\n        }\n        return modules;\n    };\n    // Public Implementation Starts\n    /**\n     * Opens the given Sfdt text.\n     * @param {string} sfdtText.\n     */\n    DocumentEditor.prototype.open = function (sfdtText) {\n        if (!isNullOrUndefined(this.viewer)) {\n            this.clearPreservedCollectionsInViewer();\n            this.viewer.lists = [];\n            this.viewer.abstractLists = [];\n            this.viewer.styles = new WStyles();\n            if (!isNullOrUndefined(sfdtText) && this.viewer) {\n                this.viewer.onDocumentChanged(this.parser.convertJsonToDocument(sfdtText));\n                if (this.editorModule) {\n                    this.editorModule.intializeDefaultStyles();\n                }\n            }\n        }\n    };\n    /**\n     * Scrolls view to start of the given page number if exists.\n     * @param  {number} pageNumber.\n     * @returns void\n     */\n    DocumentEditor.prototype.scrollToPage = function (pageNumber) {\n        if (isNullOrUndefined(this.viewer) || pageNumber < 1 || pageNumber > this.viewer.pages.length) {\n            return false;\n        }\n        this.viewer.scrollToPage(pageNumber - 1);\n        return true;\n    };\n    /**\n     * Enables all the modules.\n     * @returns void\n     */\n    DocumentEditor.prototype.enableAllModules = function () {\n        this.enablePrint = this.enableSfdtExport = this.enableWordExport = this.enableTextExport\n            = this.enableSelection = this.enableContextMenu = this.enableSearch = this.enableOptionsPane\n                = this.enableEditor = this.enableImageResizer = this.enableEditorHistory\n                    = this.enableHyperlinkDialog = this.enableTableDialog = this.enableBookmarkDialog\n                        = this.enableTableOfContentsDialog = this.enablePageSetupDialog = this.enableStyleDialog\n                            = this.enableListDialog = this.enableParagraphDialog = this.enableFontDialog\n                                = this.enableTablePropertiesDialog = this.enableBordersAndShadingDialog\n                                    = this.enableTableOptionsDialog = true;\n        // tslint:disable-next-line:max-line-length\n        DocumentEditor_1.Inject(Print, SfdtExport, WordExport, TextExport, Selection, Search, Editor, ImageResizer, EditorHistory, ContextMenu, OptionsPane, HyperlinkDialog, TableDialog, BookmarkDialog, TableOfContentsDialog, PageSetupDialog, StyleDialog, ListDialog, ParagraphDialog, BulletsAndNumberingDialog, FontDialog, TablePropertiesDialog, BordersAndShadingDialog, TableOptionsDialog, CellOptionsDialog, StylesDialog);\n    };\n    /**\n     * Resizes the component and its sub elements based on given size or container size.\n     * @param width\n     * @param height\n     */\n    DocumentEditor.prototype.resize = function (width, height) {\n        if (this.element) {\n            if (!isNullOrUndefined(width) && width > 200) {\n                this.element.style.width = width + 'px';\n            }\n            if (!isNullOrUndefined(height) && height > 200) {\n                this.element.style.height = height + 'px';\n            }\n            if (this.viewer) {\n                this.viewer.updateViewerSize();\n            }\n        }\n    };\n    /**\n     * Shifts the focus to the document.\n     */\n    DocumentEditor.prototype.focusIn = function () {\n        if (this.viewer) {\n            this.viewer.updateFocus();\n        }\n    };\n    /**\n     * Fits the page based on given fit type.\n     * @param  {PageFitType} pageFitType? - Default value of ‘pageFitType’ parameter is 'None'\n     * @returns void\n     */\n    DocumentEditor.prototype.fitPage = function (pageFitType) {\n        if (isNullOrUndefined(pageFitType)) {\n            pageFitType = 'None';\n        }\n        if (this.viewer) {\n            this.viewer.pageFitType = pageFitType;\n        }\n    };\n    /**\n     * Prints the document.\n     * @param  {Window} printWindow? - Default value of 'printWindow' parameter is undefined.\n     */\n    DocumentEditor.prototype.print = function (printWindow) {\n        if (isNullOrUndefined(this.viewer)) {\n            throw new Error('Invalid operation.');\n        }\n        if (this.printModule) {\n            this.printModule.print(this.viewer, printWindow);\n        }\n        else {\n            throw new Error('Invalid operation. Print is not enabled.');\n        }\n    };\n    /**\n     * Serialize the data to JSON string.\n     */\n    DocumentEditor.prototype.serialize = function () {\n        var json = '';\n        if (this.enableSfdtExport && this.sfdtExportModule instanceof SfdtExport) {\n            json = this.sfdtExportModule.serialize();\n        }\n        else {\n            throw new Error('Invalid operation. Sfdt export is not enabled.');\n        }\n        return json;\n    };\n    /**\n     * Saves the document.\n     * @param {string} fileName\n     * @param {FormatType} formatType\n     */\n    DocumentEditor.prototype.save = function (fileName, formatType) {\n        fileName = fileName || 'Untitled';\n        if (isNullOrUndefined(this.viewer)) {\n            throw new Error('Invalid operation.');\n        }\n        if (formatType === 'Docx' && this.wordExportModule) {\n            if (this.wordExportModule) {\n                this.wordExportModule.save(this.viewer, fileName);\n            }\n        }\n        else if (formatType === 'Txt' && this.textExportModule) {\n            this.textExportModule.save(this.viewer, fileName);\n        }\n        else if (formatType === 'Sfdt' && this.enableSfdtExport && this.sfdtExportModule) {\n            var jsonString = this.serialize();\n            var blob = new Blob([jsonString], {\n                type: 'application/json'\n            });\n            Save.save(fileName + '.sfdt', blob);\n        }\n        else {\n            throw new Error('Invalid operation. Specified export is not enabled.');\n        }\n    };\n    /**\n     * Saves the document as blob.\n     * @param {FormatType} formatType\n     */\n    DocumentEditor.prototype.saveAsBlob = function (formatType) {\n        var _this = this;\n        if (isNullOrUndefined(this.viewer)) {\n            throw new Error('Invalid operation');\n        }\n        return new Promise(function (resolve, reject) {\n            if (formatType === 'Docx' && _this.wordExportModule) {\n                resolve(_this.wordExportModule.saveAsBlob(_this.viewer));\n            }\n            else if (formatType === 'Txt' && _this.textExportModule) {\n                resolve(_this.textExportModule.saveAsBlob(_this.viewer));\n            }\n            else if (formatType === 'Sfdt' && _this.enableSfdtExport && _this.sfdtExportModule) {\n                resolve(_this.sfdtExportModule.saveAsBlob(_this.viewer));\n            }\n        });\n    };\n    /**\n     * Opens a blank document.\n     */\n    DocumentEditor.prototype.openBlank = function () {\n        var section = new BodyWidget();\n        section.index = 0;\n        section.sectionFormat = new WSectionFormat(section);\n        var paragraph = new ParagraphWidget();\n        paragraph.index = 0;\n        paragraph.paragraphFormat = new WParagraphFormat(paragraph);\n        paragraph.characterFormat = new WCharacterFormat(paragraph);\n        section.childWidgets.push(paragraph);\n        paragraph.containerWidget = section;\n        var sections = [];\n        sections.push(section);\n        // tslint:disable-next-line:max-line-length\n        var hfs = this.parser.parseHeaderFooter({ header: {}, footer: {}, evenHeader: {}, evenFooter: {}, firstPageHeader: {}, firstPageFooter: {} }, undefined);\n        if (this.viewer) {\n            this.clearPreservedCollectionsInViewer();\n            this.viewer.headersFooters.push(hfs);\n            this.viewer.onDocumentChanged(sections);\n            if (this.editorModule) {\n                this.editorModule.intializeDefaultStyles();\n                var style = this.viewer.styles.findByName('Normal');\n                paragraph.paragraphFormat.baseStyle = style;\n                paragraph.paragraphFormat.listFormat.baseStyle = style;\n            }\n        }\n    };\n    /**\n     * Gets the style names based on given style type.\n     * @param styleType\n     */\n    DocumentEditor.prototype.getStyleNames = function (styleType) {\n        if (this.viewer) {\n            return this.viewer.styles.getStyleNames(styleType);\n        }\n        return [];\n    };\n    /**\n     * Gets the style objects on given style type.\n     * @param styleType\n     */\n    DocumentEditor.prototype.getStyles = function (styleType) {\n        if (this.viewer) {\n            return this.viewer.styles.getStyles(styleType);\n        }\n        return [];\n    };\n    /**\n     * Shows the dialog.\n     * @param {DialogType} dialogType\n     * @returns void\n     */\n    DocumentEditor.prototype.showDialog = function (dialogType) {\n        switch (dialogType) {\n            case 'Hyperlink':\n                this.showHyperlinkDialog();\n                break;\n            case 'Table':\n                this.showTableDialog();\n                break;\n            case 'Bookmark':\n                this.showBookmarkDialog();\n                break;\n            case 'TableOfContents':\n                this.showTableOfContentsDialog();\n                break;\n            case 'PageSetup':\n                this.showPageSetupDialog();\n                break;\n            case 'List':\n                this.showListDialog();\n                break;\n            case 'Styles':\n                this.showStylesDialog();\n                break;\n            case 'Style':\n                this.showStyleDialog();\n                break;\n            case 'Paragraph':\n                this.showParagraphDialog();\n                break;\n            case 'Font':\n                this.showFontDialog();\n                break;\n            case 'TableProperties':\n                this.showTablePropertiesDialog();\n                break;\n            case 'BordersAndShading':\n                this.showBordersAndShadingDialog();\n                break;\n            case 'TableOptions':\n                this.showTableOptionsDialog();\n                break;\n        }\n    };\n    /**\n     * Shows the options pane.\n     */\n    DocumentEditor.prototype.showOptionsPane = function () {\n        if (!isNullOrUndefined(this.optionsPaneModule) && !isNullOrUndefined(this.viewer)) {\n            this.optionsPaneModule.showHideOptionsPane(true);\n        }\n    };\n    /**\n     * Destroys all managed resources used by this object.\n     */\n    DocumentEditor.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.destroyDependentModules();\n        if (!isNullOrUndefined(this.viewer)) {\n            this.viewer.destroy();\n        }\n        this.viewer = undefined;\n        if (!isNullOrUndefined(this.element)) {\n            this.element.classList.remove('e-documenteditor');\n            this.element.innerHTML = '';\n        }\n        this.element = undefined;\n        this.findResultsList = [];\n        this.findResultsList = undefined;\n    };\n    DocumentEditor.prototype.destroyDependentModules = function () {\n        if (this.printModule) {\n            this.printModule.destroy();\n            this.printModule = undefined;\n        }\n        if (this.sfdtExportModule) {\n            this.sfdtExportModule.destroy();\n            this.sfdtExportModule = undefined;\n        }\n        if (this.optionsPaneModule) {\n            this.optionsPaneModule.destroy();\n            this.optionsPaneModule = undefined;\n        }\n        if (!isNullOrUndefined(this.hyperlinkDialogModule)) {\n            this.hyperlinkDialogModule.destroy();\n            this.hyperlinkDialogModule = undefined;\n        }\n        if (this.searchModule) {\n            this.searchModule.destroy();\n            this.searchModule = undefined;\n        }\n        if (this.contextMenuModule) {\n            this.contextMenuModule.destroy();\n            this.contextMenuModule = undefined;\n        }\n        if (this.editorModule) {\n            this.editorModule.destroy();\n            this.editorModule = undefined;\n        }\n        if (this.selectionModule) {\n            this.selectionModule.destroy();\n            this.selectionModule = undefined;\n        }\n        if (this.editorHistoryModule) {\n            this.editorHistoryModule.destroy();\n            this.editorHistoryModule = undefined;\n        }\n        if (!isNullOrUndefined(this.paragraphDialogModule)) {\n            this.paragraphDialogModule.destroy();\n            this.paragraphDialogModule = undefined;\n        }\n        if (this.pageSetupDialogModule) {\n            this.pageSetupDialogModule.destroy();\n            this.pageSetupDialogModule = undefined;\n        }\n        if (this.fontDialogModule) {\n            this.fontDialogModule.destroy();\n            this.fontDialogModule = undefined;\n        }\n        if (this.listDialogModule) {\n            this.listDialogModule.destroy();\n            this.listDialogModule = undefined;\n        }\n        if (this.imageResizerModule) {\n            this.imageResizerModule.destroy();\n            this.imageResizerModule = undefined;\n        }\n        if (this.tablePropertiesDialogModule) {\n            this.tablePropertiesDialogModule.destroy();\n            this.tablePropertiesDialogModule = undefined;\n        }\n        if (this.bordersAndShadingDialogModule) {\n            this.bordersAndShadingDialogModule.destroy();\n            this.bordersAndShadingDialogModule = undefined;\n        }\n        if (this.cellOptionsDialogModule) {\n            this.cellOptionsDialogModule.destroy();\n            this.cellOptionsDialogModule = undefined;\n        }\n        if (this.tableOptionsDialogModule) {\n            this.tableOptionsDialogModule.destroy();\n            this.tableOptionsDialogModule = undefined;\n        }\n        if (this.tableDialogModule) {\n            this.tableDialogModule.destroy();\n            this.tableDialogModule = undefined;\n        }\n        if (this.styleDialogModule) {\n            this.styleDialogModule = undefined;\n        }\n        if (this.bookmarkDialogModule) {\n            this.bookmarkDialogModule.destroy();\n            this.bookmarkDialogModule = undefined;\n        }\n        if (this.styleDialogModule) {\n            this.styleDialogModule.destroy();\n            this.styleDialogModule = undefined;\n        }\n        if (this.textExportModule) {\n            this.textExportModule.destroy();\n            this.textExportModule = undefined;\n        }\n        if (this.wordExportModule) {\n            this.wordExportModule.destroy();\n            this.wordExportModule = undefined;\n        }\n        if (this.tableOfContentsDialogModule) {\n            this.tableOfContentsDialogModule.destroy();\n            this.tableOfContentsDialogModule = undefined;\n        }\n    };\n    var DocumentEditor_1;\n    __decorate([\n        Property(1)\n    ], DocumentEditor.prototype, \"zoomFactor\", void 0);\n    __decorate([\n        Property(true)\n    ], DocumentEditor.prototype, \"isReadOnly\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enablePrint\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableSelection\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableEditor\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableEditorHistory\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableSfdtExport\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableWordExport\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTextExport\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableOptionsPane\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableContextMenu\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableHyperlinkDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableBookmarkDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTableOfContentsDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableSearch\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableParagraphDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableListDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTablePropertiesDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableBordersAndShadingDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enablePageSetupDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableStyleDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableFontDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTableOptionsDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTableDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableImageResizer\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"documentChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"viewChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"zoomFactorChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"selectionChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"requestNavigate\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"contentChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"keyDown\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"searchResultsChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"destroyed\", void 0);\n    DocumentEditor = DocumentEditor_1 = __decorate([\n        NotifyPropertyChanges\n    ], DocumentEditor);\n    return DocumentEditor;\n}(Component));\nexport { DocumentEditor };\n","import { ContextMenu as Menu } from '@syncfusion/ej2-navigations';\nimport { isNullOrUndefined, L10n, classList } from '@syncfusion/ej2-base';\nimport { FieldElementBox } from './viewer/page';\nvar CONTEXTMENU_COPY = '_contextmenu_copy';\nvar CONTEXTMENU_CUT = '_contextmenu_cut';\nvar CONTEXTMENU_PASTE = '_contextmenu_paste';\nvar CONTEXTMENU_UPDATE_FIELD = '_contextmenu_update_field';\nvar CONTEXTMENU_EDIT_FIELD = '_contextmenu_edit_field';\nvar CONTEXTMENU_HYPERLINK = '_contextmenu_hyperlink';\nvar CONTEXTMENU_OPEN_HYPERLINK = '_contextmenu_open_hyperlink';\nvar CONTEXTMENU_COPY_HYPERLINK = '_contextmenu_copy_hyperlink';\nvar CONTEXTMENU_REMOVE_HYPERLINK = '_contextmenu_remove_hyperlink';\nvar CONTEXTMENU_EDIT_HYPERLINK = '_contextmenu_edit_hyperlink';\nvar CONTEXTMENU_FONT_DIALOG = '_contextmenu_font_dialog';\nvar CONTEXTMENU_PARAGRAPH = '_contextmenu_paragraph_dialog';\nvar CONTEXTMENU_TABLE = '_contextmenu_table_dialog';\nvar CONTEXTMENU_INSERT_TABLE = '_contextmenu_insert_table';\nvar CONTEXTMENU_DELETE_TABLE = '_contextmenu_delete_table';\nvar CONTEXTMENU_INSERT_ABOVE = '_contextmenu_insert_above';\nvar CONTEXTMENU_INSERT_BELOW = '_contextmenu_insert_below';\nvar CONTEXTMENU_INSERT_RIGHT = '_contextmenu_insert_right';\nvar CONTEXTMENU_INSERT_LEFT = '_contextmenu_insert_left';\nvar CONTEXTMENU_COMPLETE_DELETE_TABLE = '_contextmenu_complete_table_delete';\nvar CONTEXTMENU_DELETE_ROW = '_contextmenu_delete_row';\nvar CONTEXTMENU_DELETE_COLUMN = '_contextmenu_delete_column';\nvar CONTEXTMENU_MERGE_CELL = '_contextmenu_merge_cell';\nvar CONTEXTMENU_AUTO_FIT = '_contextmenu_auto_fit';\nvar CONTEXTMENU_AUTO_FIT_TO_CONTENTS = '_contextmenu_auto_fit_contents';\nvar CONTEXTMENU_AUTO_FIT_TO_WINDOW = '_contextmenu_auto_fit_window';\nvar CONTEXTMENU_FIXED_COLUMN_WIDTH = '_contextmenu_fixed_column_width';\nvar CONTEXTMENU_CONTINUE_NUMBERING = '_contextmenu_continue_numbering';\nvar CONTEXTMENU_RESTART_AT = '_contextmenu_restart_at';\n/**\n * Context Menu class\n */\nvar ContextMenu = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ContextMenu(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.contextMenuInstance = undefined;\n        /**\n         * Handles on context menu key pressed.\n         * @param  {PointerEvent} event\n         * @private\n         */\n        this.onContextMenuInternal = function (event) {\n            if (_this.showHideElements(_this.viewer.selection)) {\n                _this.contextMenuInstance.open(event.y, event.x);\n                event.preventDefault();\n            }\n        };\n        this.viewer = viewer;\n        var locale = new L10n('documenteditor', this.viewer.owner.defaultLocale);\n        locale.setLocale(this.viewer.owner.locale);\n        this.initContextMenu(locale, this.viewer.owner.enableRtl);\n    }\n    /**\n     * Gets module name.\n     */\n    ContextMenu.prototype.getModuleName = function () {\n        return 'ContextMenu';\n    };\n    /**\n     * Initialize context menu.\n     * @param localValue Localize value.\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    ContextMenu.prototype.initContextMenu = function (localValue, isRtl) {\n        var _this = this;\n        var id = this.viewer.owner.element.id;\n        this.contextMenu = document.createElement('div');\n        this.contextMenu.id = this.viewer.owner.containerId + 'e-de-contextmenu';\n        document.body.appendChild(this.contextMenu);\n        var ul = document.createElement('ul');\n        ul.style.width = 'auto';\n        ul.id = this.viewer.owner.containerId + 'e-de-contextmenu-list';\n        ul.style.listStyle = 'none';\n        ul.style.margin = '0px';\n        ul.style.padding = '0px';\n        ul.style.maxHeight = 'auto';\n        ul.oncontextmenu = this.disableBrowserContextmenu;\n        this.contextMenu.appendChild(ul);\n        var menuItems = [\n            {\n                text: localValue.getConstant('Cut'),\n                iconCss: 'e-icons e-de-cut',\n                id: id + CONTEXTMENU_CUT\n            },\n            {\n                text: localValue.getConstant('Copy'),\n                iconCss: 'e-icons e-de-copy',\n                id: id + CONTEXTMENU_COPY\n            },\n            {\n                text: localValue.getConstant('Paste'),\n                iconCss: 'e-icons e-de-paste',\n                id: id + CONTEXTMENU_PASTE\n            },\n            {\n                separator: true\n            },\n            {\n                text: localValue.getConstant('Update Field'),\n                iconCss: 'e-icons e-de-update_field',\n                id: id + CONTEXTMENU_UPDATE_FIELD\n            },\n            {\n                text: localValue.getConstant('Edit Field'),\n                iconCss: 'e-icons e-de-edit_field',\n                id: id + CONTEXTMENU_EDIT_FIELD\n            },\n            {\n                text: localValue.getConstant('Continue Numbering'),\n                iconCss: 'e-icons e-de-continue-numbering',\n                id: id + CONTEXTMENU_CONTINUE_NUMBERING\n            },\n            {\n                text: localValue.getConstant('Restart At') + ' 1',\n                iconCss: 'e-icons e-de-restart-at',\n                id: id + CONTEXTMENU_RESTART_AT\n            },\n            {\n                separator: true\n            },\n            {\n                text: localValue.getConstant('Hyperlink'),\n                iconCss: 'e-icons e-de-insertlink',\n                id: id + CONTEXTMENU_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Edit Hyperlink') + '...',\n                iconCss: 'e-icons e-de-edit-hyperlink',\n                id: id + CONTEXTMENU_EDIT_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Open Hyperlink'),\n                iconCss: 'e-icons e-de-open-hyperlink',\n                id: id + CONTEXTMENU_OPEN_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Copy Hyperlink'),\n                iconCss: 'e-icons e-de-copy-hyperlink',\n                id: id + CONTEXTMENU_COPY_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Remove Hyperlink'),\n                iconCss: 'e-icons e-de-remove-hyperlink',\n                id: id + CONTEXTMENU_REMOVE_HYPERLINK\n            },\n            {\n                separator: true\n            },\n            {\n                text: localValue.getConstant('Font'),\n                iconCss: 'e-icons e-de-fonts',\n                id: id + CONTEXTMENU_FONT_DIALOG\n            },\n            {\n                text: localValue.getConstant('Paragraph'),\n                iconCss: 'e-icons e-de-paragraph',\n                id: id + CONTEXTMENU_PARAGRAPH\n            },\n            {\n                separator: true,\n            },\n            {\n                text: localValue.getConstant('Table Properties'),\n                id: id + CONTEXTMENU_TABLE,\n                iconCss: 'e-icons e-de-table'\n            },\n            {\n                text: localValue.getConstant('Merge Cells'),\n                id: id + CONTEXTMENU_MERGE_CELL,\n                iconCss: 'e-icons e-de-ctnr-mergecell'\n            },\n            {\n                text: localValue.getConstant('AutoFit'),\n                id: id + CONTEXTMENU_AUTO_FIT,\n                iconCss: 'e-icons',\n                items: [\n                    {\n                        text: localValue.getConstant('AutoFit to Contents'),\n                        id: id + CONTEXTMENU_AUTO_FIT_TO_CONTENTS,\n                        iconCss: 'e-icons e-de-icon-autofit e-de-autofit-contents'\n                    },\n                    {\n                        text: localValue.getConstant('AutoFit to Window'),\n                        id: id + CONTEXTMENU_AUTO_FIT_TO_WINDOW,\n                        iconCss: 'e-icons e-de-icon-auto-fitwindow e-de-autofit-window'\n                    },\n                    {\n                        text: localValue.getConstant('Fixed Column Width'),\n                        id: id + CONTEXTMENU_FIXED_COLUMN_WIDTH,\n                        iconCss: 'e-icons e-de-icon-fixed-columnwidth e-de-fixed-column'\n                    }\n                ]\n            },\n            {\n                text: localValue.getConstant('Insert'),\n                id: id + CONTEXTMENU_INSERT_TABLE,\n                iconCss: 'e-icons',\n                items: [\n                    {\n                        text: localValue.getConstant('Insert Above'),\n                        id: id + CONTEXTMENU_INSERT_ABOVE,\n                        iconCss: 'e-icons e-de-insertabove'\n                    },\n                    {\n                        text: localValue.getConstant('Insert Below'),\n                        id: id + CONTEXTMENU_INSERT_BELOW,\n                        iconCss: 'e-icons e-de-insertbelow'\n                    },\n                    {\n                        text: localValue.getConstant('Insert Left'),\n                        id: id + CONTEXTMENU_INSERT_LEFT,\n                        iconCss: 'e-icons e-de-insertleft'\n                    },\n                    {\n                        text: localValue.getConstant('Insert Right'),\n                        id: id + CONTEXTMENU_INSERT_RIGHT,\n                        iconCss: 'e-icons e-de-insertright'\n                    }\n                ]\n            },\n            {\n                text: localValue.getConstant('Delete'),\n                id: id + CONTEXTMENU_DELETE_TABLE,\n                iconCss: 'e-icons',\n                items: [\n                    {\n                        text: localValue.getConstant('Delete Table'),\n                        id: id + CONTEXTMENU_COMPLETE_DELETE_TABLE,\n                        iconCss: 'e-icons e-de-delete-table'\n                    },\n                    {\n                        text: localValue.getConstant('Delete Row'),\n                        id: id + CONTEXTMENU_DELETE_ROW,\n                        iconCss: 'e-icons e-de-deleterow'\n                    },\n                    {\n                        text: localValue.getConstant('Delete Column'),\n                        id: id + CONTEXTMENU_DELETE_COLUMN,\n                        iconCss: 'e-icons e-de-deletecolumn'\n                    }\n                ]\n            },\n        ];\n        var menuOptions = {\n            target: '#' + this.viewer.owner.containerId + 'e-de-contextmenu',\n            enableRtl: isRtl,\n            items: menuItems,\n            select: function (args) {\n                var item = args.element.id;\n                _this.handleContextMenuItem(item);\n            },\n        };\n        this.contextMenuInstance = new Menu(menuOptions, '#' + this.viewer.owner.containerId + 'e-de-contextmenu-list');\n        this.contextMenuInstance.beforeOpen = function () {\n            if (_this.viewer && _this.viewer.selection) {\n                classList(_this.viewer.selection.caret, [], ['e-de-cursor-animation']);\n                _this.viewer.selection.showCaret();\n            }\n        };\n        this.contextMenuInstance.onClose = function () {\n            if (_this.viewer && _this.viewer.selection) {\n                classList(_this.viewer.selection.caret, ['e-de-cursor-animation'], []);\n                _this.viewer.updateFocus();\n            }\n        };\n    };\n    /**\n     * Disable browser context menu.\n     */\n    ContextMenu.prototype.disableBrowserContextmenu = function () {\n        return false;\n    };\n    /**\n     * Handles context menu items.\n     * @param  {string} item Specifies which item is selected.\n     * @private\n     */\n    ContextMenu.prototype.handleContextMenuItem = function (item) {\n        var id = this.viewer.owner.element.id;\n        switch (item) {\n            case id + CONTEXTMENU_COPY:\n                this.viewer.selection.copy();\n                break;\n            case id + CONTEXTMENU_CUT:\n                this.viewer.owner.editor.cut();\n                break;\n            case id + CONTEXTMENU_PASTE:\n                if (!this.viewer.owner.isReadOnlyMode) {\n                    this.viewer.owner.editorModule.pasteInternal(undefined);\n                }\n                break;\n            case id + CONTEXTMENU_UPDATE_FIELD:\n                if (!this.viewer.owner.isReadOnlyMode) {\n                    this.viewer.owner.editorModule.updateToc();\n                }\n                break;\n            case id + CONTEXTMENU_EDIT_FIELD:\n                if (!this.viewer.owner.isReadOnlyMode) {\n                    this.viewer.owner.tableOfContentsDialogModule.show();\n                }\n                break;\n            case id + CONTEXTMENU_FONT_DIALOG:\n                if (this.viewer.owner.fontDialogModule) {\n                    this.viewer.owner.fontDialogModule.showFontDialog();\n                }\n                break;\n            case id + CONTEXTMENU_OPEN_HYPERLINK:\n                this.viewer.selection.navigateHyperlink();\n                break;\n            case id + CONTEXTMENU_COPY_HYPERLINK:\n                this.viewer.selection.copyHyperlink();\n                break;\n            case id + CONTEXTMENU_EDIT_HYPERLINK:\n            case id + CONTEXTMENU_HYPERLINK:\n                if (this.viewer.owner.hyperlinkDialogModule) {\n                    this.viewer.owner.hyperlinkDialogModule.show();\n                }\n                break;\n            case id + CONTEXTMENU_REMOVE_HYPERLINK:\n                this.viewer.owner.editor.removeHyperlink();\n                break;\n            case id + CONTEXTMENU_PARAGRAPH:\n                if (this.viewer.owner.paragraphDialogModule) {\n                    this.viewer.owner.paragraphDialogModule.show();\n                }\n                break;\n            case id + CONTEXTMENU_TABLE:\n                this.viewer.owner.tablePropertiesDialogModule.show();\n                break;\n            case id + CONTEXTMENU_MERGE_CELL:\n                this.viewer.owner.editor.mergeCells();\n                break;\n            case id + CONTEXTMENU_INSERT_ABOVE:\n                this.viewer.owner.editor.insertRow(true);\n                break;\n            case id + CONTEXTMENU_INSERT_BELOW:\n                this.viewer.owner.editor.insertRow(false);\n                break;\n            case id + CONTEXTMENU_INSERT_LEFT:\n                this.viewer.owner.editor.insertColumn(true);\n                break;\n            case id + CONTEXTMENU_INSERT_RIGHT:\n                this.viewer.owner.editor.insertColumn(false);\n                break;\n            case id + CONTEXTMENU_COMPLETE_DELETE_TABLE:\n                this.viewer.owner.editor.deleteTable();\n                break;\n            case id + CONTEXTMENU_DELETE_ROW:\n                this.viewer.owner.editor.deleteRow();\n                break;\n            case id + CONTEXTMENU_DELETE_COLUMN:\n                this.viewer.owner.editor.deleteColumn();\n                break;\n            case id + CONTEXTMENU_CONTINUE_NUMBERING:\n                this.viewer.owner.editorModule.applyContinueNumbering(this.viewer.selection);\n                break;\n            case id + CONTEXTMENU_RESTART_AT:\n                this.viewer.owner.editorModule.applyRestartNumbering(this.viewer.selection);\n                break;\n            case id + CONTEXTMENU_AUTO_FIT_TO_CONTENTS:\n                this.viewer.owner.editor.autoFitTable('FitToContents');\n                break;\n            case id + CONTEXTMENU_AUTO_FIT_TO_WINDOW:\n                this.viewer.owner.editor.autoFitTable('FitToWindow');\n                break;\n            case id + CONTEXTMENU_FIXED_COLUMN_WIDTH:\n                this.viewer.owner.editor.autoFitTable('FixedColumnWidth');\n                break;\n        }\n    };\n    ContextMenu.prototype.showHideElements = function (selection) {\n        if (isNullOrUndefined(selection)) {\n            return false;\n        }\n        selection.hideToolTip();\n        var owner = this.viewer.owner;\n        var id = owner.element.id;\n        var copy = document.getElementById(id + CONTEXTMENU_COPY);\n        var cut = document.getElementById(id + CONTEXTMENU_CUT);\n        var paste = document.getElementById(id + CONTEXTMENU_PASTE);\n        var updateField = document.getElementById(id + CONTEXTMENU_UPDATE_FIELD);\n        var editField = document.getElementById(id + CONTEXTMENU_EDIT_FIELD);\n        var font = document.getElementById(id + CONTEXTMENU_FONT_DIALOG);\n        var paragraph = document.getElementById(id + CONTEXTMENU_PARAGRAPH);\n        var tableProperties = document.getElementById(id + CONTEXTMENU_TABLE);\n        var insertTable = document.getElementById(id + CONTEXTMENU_INSERT_TABLE);\n        var deleteTable = document.getElementById(id + CONTEXTMENU_DELETE_TABLE);\n        var mergeCells = document.getElementById(id + CONTEXTMENU_MERGE_CELL);\n        var hyperlink = document.getElementById(id + CONTEXTMENU_HYPERLINK);\n        var openHyperlink = document.getElementById(id + CONTEXTMENU_OPEN_HYPERLINK);\n        var editHyperlink = document.getElementById(id + CONTEXTMENU_EDIT_HYPERLINK);\n        var copyHyperlink = document.getElementById(id + CONTEXTMENU_COPY_HYPERLINK);\n        var removeHyperlink = document.getElementById(id + CONTEXTMENU_REMOVE_HYPERLINK);\n        var continueNumbering = document.getElementById(id + CONTEXTMENU_CONTINUE_NUMBERING);\n        var restartAt = document.getElementById(id + CONTEXTMENU_RESTART_AT);\n        var autoFitTable = document.getElementById(id + CONTEXTMENU_AUTO_FIT);\n        cut.style.display = 'none';\n        paste.style.display = 'none';\n        paste.nextSibling.style.display = 'none';\n        hyperlink.style.display = 'none';\n        openHyperlink.style.display = 'none';\n        copyHyperlink.style.display = 'none';\n        editHyperlink.style.display = 'none';\n        removeHyperlink.style.display = 'none';\n        removeHyperlink.nextSibling.style.display = 'none';\n        mergeCells.style.display = 'none';\n        autoFitTable.style.display = 'none';\n        font.style.display = 'none';\n        paragraph.style.display = 'none';\n        paragraph.nextSibling.style.display = 'none';\n        insertTable.style.display = 'none';\n        deleteTable.style.display = 'none';\n        tableProperties.style.display = 'none';\n        updateField.style.display = 'none';\n        editField.style.display = 'none';\n        continueNumbering.style.display = 'none';\n        restartAt.style.display = 'none';\n        restartAt.nextSibling.style.display = 'none';\n        var isSelectionEmpty = selection.isEmpty;\n        classList(cut, isSelectionEmpty ? ['e-disabled'] : [], !isSelectionEmpty ? ['e-disabled'] : []);\n        classList(copy, isSelectionEmpty ? ['e-disabled'] : [], !isSelectionEmpty ? ['e-disabled'] : []);\n        if (owner.isReadOnlyMode) {\n            return true;\n        }\n        cut.style.display = 'block';\n        paste.style.display = 'block';\n        paste.nextSibling.style.display = 'block';\n        classList(insertTable, ['e-blankicon'], []);\n        classList(deleteTable, ['e-blankicon'], []);\n        classList(updateField, ['e-blankicon'], []);\n        classList(editField, ['e-blankicon'], []);\n        classList(autoFitTable, ['e-blankicon'], []);\n        var enablePaste = (owner.enableLocalPaste && !isNullOrUndefined(owner.editor.copiedData));\n        classList(paste, enablePaste ? [] : ['e-disabled'], enablePaste ? ['e-disabled'] : []);\n        if (selection.contextType === 'TableOfContents') {\n            updateField.style.display = 'block';\n            editField.style.display = 'block';\n        }\n        else {\n            var start = selection.start;\n            var end = selection.end;\n            if (selection.contextType === 'List'\n                && owner.editorModule.getListLevel(start.paragraph).listLevelPattern !== 'Bullet') {\n                continueNumbering.style.display = 'block';\n                restartAt.style.display = 'block';\n                restartAt.nextSibling.style.display = 'block';\n            }\n            var isCellOrRowSelected = start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n                || start.paragraph.associatedCell !== end.paragraph.associatedCell\n                || selection.isCellSelected(start.paragraph.associatedCell, start, end));\n            if (isCellOrRowSelected) {\n                hyperlink.classList.add('e-disabled');\n            }\n            else {\n                if (hyperlink.classList.contains('e-disabled')) {\n                    hyperlink.classList.remove('e-disabled');\n                }\n            }\n            var field = selection.getHyperlinkField();\n            if (field instanceof FieldElementBox && !selection.isImageField()) {\n                openHyperlink.style.display = 'block';\n                copyHyperlink.style.display = 'block';\n                if (owner.hyperlinkDialogModule) {\n                    editHyperlink.style.display = 'block';\n                }\n                removeHyperlink.style.display = 'block';\n                removeHyperlink.nextSibling.style.display = 'block';\n            }\n            else {\n                if (owner.hyperlinkDialogModule) {\n                    hyperlink.style.display = 'block';\n                }\n            }\n        }\n        if (this.viewer.owner.selection.start.paragraph.isInsideTable\n            && this.viewer.owner.selection.end.paragraph.isInsideTable) {\n            paragraph.nextSibling.style.display = 'block';\n            if (owner.tablePropertiesDialogModule) {\n                tableProperties.style.display = 'block';\n            }\n            insertTable.style.display = 'block';\n            deleteTable.style.display = 'block';\n            if (this.viewer.owner.editor.canMergeCells()) {\n                mergeCells.style.display = 'block';\n            }\n            autoFitTable.style.display = this.viewer.selection.isTableSelected() ? 'block' : 'none';\n        }\n        else {\n            if (this.viewer.owner.fontDialogModule) {\n                font.style.display = 'block';\n                font.previousSibling.style.display = 'block';\n            }\n            if (this.viewer.owner.paragraphDialogModule) {\n                paragraph.style.display = 'block';\n            }\n        }\n        if (selection.contextType === 'Image') {\n            font.style.display = 'none';\n            paragraph.style.display = 'none';\n            removeHyperlink.nextSibling.style.display = 'none';\n        }\n        return true;\n    };\n    /**\n     * Disposes the internal objects which are maintained.\n     * @private\n     */\n    ContextMenu.prototype.destroy = function () {\n        if (this.contextMenuInstance) {\n            this.contextMenuInstance.destroy();\n        }\n        if (this.contextMenu && this.contextMenu.parentElement) {\n            this.contextMenu.parentElement.removeChild(this.contextMenu);\n            this.contextMenu.innerHTML = '';\n        }\n        this.contextMenu = undefined;\n        this.contextMenuInstance = undefined;\n    };\n    return ContextMenu;\n}());\nexport { ContextMenu };\n","import { ListView } from '@syncfusion/ej2-lists';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { createElement, L10n, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The Bookmark dialog is used to add, navigate or delete bookmarks.\n */\nvar BookmarkDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function BookmarkDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.onKeyUpOnTextBox = function (event) {\n            _this.enableOrDisableButton();\n        };\n        this.addBookmark = function () {\n            _this.owner.owner.editorModule.insertBookmark(_this.textBoxInput.value);\n            _this.owner.dialog.hide();\n        };\n        /* tslint:disable:no-any */\n        this.selectHandler = function (args) {\n            _this.focusTextBox(args.text);\n        };\n        this.gotoBookmark = function () {\n            _this.owner.selection.selectBookmark(_this.textBoxInput.value);\n        };\n        this.deleteBookmark = function () {\n            _this.owner.owner.editorModule.deleteBookmark(_this.textBoxInput.value);\n            _this.show();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.getModuleName = function () {\n        return 'BookmarkDialog';\n    };\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.initBookmarkDialog = function (localValue, bookmarks, isRtl) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_bookmark';\n        this.target = createElement('div', { id: id, className: 'e-de-bookmark' });\n        var headerValue = localValue.getConstant('Bookmark name') + ':';\n        var dlgFields = createElement('div', { innerHTML: headerValue, className: 'e-bookmark-dlgfields' });\n        this.target.appendChild(dlgFields);\n        var commonDiv = createElement('div', { className: 'e-bookmark-common' });\n        this.target.appendChild(commonDiv);\n        var searchDiv = createElement('div', { className: 'e-bookmark-list' });\n        commonDiv.appendChild(searchDiv);\n        if (isRtl) {\n            searchDiv.classList.add('e-de-rtl');\n        }\n        var textBoxDiv = createElement('div', { className: 'e-bookmark-textboxdiv' });\n        searchDiv.appendChild(textBoxDiv);\n        // tslint:disable-next-line:max-line-length\n        this.textBoxInput = createElement('input', { className: 'e-input e-bookmark-textbox-input', id: 'bookmark_text_box', attrs: { autofocus: 'true' } });\n        this.textBoxInput.setAttribute('type', 'text');\n        textBoxDiv.appendChild(this.textBoxInput);\n        var listviewDiv = createElement('div', { className: 'e-bookmark-listViewDiv', id: 'bookmark_listview' });\n        searchDiv.appendChild(listviewDiv);\n        var arts = this.owner.bookmarks.keys;\n        this.listviewInstance = new ListView({\n            dataSource: bookmarks,\n            cssClass: 'e-bookmark-listview',\n        });\n        var hasNoBookmark = (bookmarks === undefined || bookmarks.length === 0);\n        this.listviewInstance.appendTo(listviewDiv);\n        this.listviewInstance.addEventListener('select', this.selectHandler);\n        var buttonDiv = createElement('div', { className: 'e-bookmark-button' });\n        commonDiv.appendChild(buttonDiv);\n        var addbuttonDiv = createElement('div', { className: 'e-bookmark-addbutton' });\n        buttonDiv.appendChild(addbuttonDiv);\n        var addButtonElement = createElement('button', { innerHTML: localValue.getConstant('Add'), id: 'add' });\n        addbuttonDiv.appendChild(addButtonElement);\n        this.addButton = new Button({ cssClass: 'e-button-custom' });\n        this.addButton.disabled = true;\n        this.addButton.appendTo(addButtonElement);\n        this.textBoxInput.addEventListener('input', this.onKeyUpOnTextBox);\n        this.textBoxInput.addEventListener('keyup', this.onKeyUpOnTextBox);\n        addButtonElement.addEventListener('click', this.addBookmark);\n        var deleteButtonDiv = createElement('div', { className: 'e-bookmark-deletebutton' });\n        buttonDiv.appendChild(deleteButtonDiv);\n        var deleteButtonElement = createElement('button', { innerHTML: localValue.getConstant('Delete'), id: 'delete' });\n        deleteButtonDiv.appendChild(deleteButtonElement);\n        this.deleteButton = new Button({ cssClass: 'e-button-custom' });\n        this.deleteButton.disabled = hasNoBookmark;\n        this.deleteButton.appendTo(deleteButtonElement);\n        deleteButtonElement.addEventListener('click', this.deleteBookmark);\n        var gotoButtonDiv = createElement('div', { className: 'e-bookmark-gotobutton' });\n        buttonDiv.appendChild(gotoButtonDiv);\n        var gotoButtonElement = createElement('button', { innerHTML: localValue.getConstant('Go To'), id: 'goto' });\n        gotoButtonDiv.appendChild(gotoButtonElement);\n        this.gotoButton = new Button({ cssClass: 'e-button-custom' });\n        this.gotoButton.disabled = hasNoBookmark;\n        this.gotoButton.appendTo(gotoButtonElement);\n        gotoButtonElement.addEventListener('click', this.gotoBookmark);\n    };\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.show = function () {\n        var bookmarks = this.owner.getBookmarks();\n        var localObj = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localObj.setLocale(this.owner.owner.locale);\n        // if (!this.target) {\n        this.initBookmarkDialog(localObj, bookmarks, this.owner.owner.enableRtl);\n        //}\n        this.owner.dialog.header = localObj.getConstant('Bookmark');\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.buttons = [{\n                click: this.removeObjects.bind(this),\n                buttonModel: { content: localObj.getConstant('Cancel'), cssClass: 'e-flat e-hyper-insert', isPrimary: true }\n            }];\n        this.owner.dialog.dataBind();\n        var hasNoBookmark = (bookmarks === undefined || bookmarks.length === 0);\n        if (!hasNoBookmark) {\n            /* tslint:disable:no-any */\n            var firstItem = bookmarks[0];\n            this.listviewInstance.selectItem(firstItem);\n        }\n        this.owner.dialog.show();\n    };\n    BookmarkDialog.prototype.enableOrDisableButton = function () {\n        if (!isNullOrUndefined(this.addButton)) {\n            // tslint:disable-next-line:max-line-length\n            this.addButton.disabled = (this.textBoxInput.value === '');\n        }\n    };\n    /* tslint:disable:no-any */\n    BookmarkDialog.prototype.focusTextBox = function (text) {\n        this.textBoxInput.value = text;\n        /* tslint:disable:no-any */\n        var value = document.getElementById('bookmark_text_box');\n        value.setSelectionRange(0, text.length);\n        value.focus();\n        this.enableOrDisableButton();\n    };\n    BookmarkDialog.prototype.removeObjects = function () {\n        this.owner.dialog.hide();\n    };\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.destroy = function () {\n        if (this.textBoxInput) {\n            this.textBoxInput.remove();\n            this.textBoxInput = undefined;\n        }\n        if (this.listviewInstance) {\n            this.listviewInstance.destroy();\n            this.listviewInstance = undefined;\n        }\n    };\n    return BookmarkDialog;\n}());\nexport { BookmarkDialog };\n","import { createElement, isNullOrUndefined, L10n } from '@syncfusion/ej2-base';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WTableFormat, WBorder, WBorders, WShading, WCellFormat } from '../format/index';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\n/**\n * The Borders and Shading dialog is used to modify borders and shading options for selected table or cells.\n */\nvar BordersAndShadingDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function BordersAndShadingDialog(viewer) {\n        var _this = this;\n        this.cellFormat = new WCellFormat();\n        this.tableFormat = new WTableFormat();\n        this.applyBordersShadingsProperties = function () {\n            var tablePropertiesDialog = _this.owner.owner.tablePropertiesDialogModule;\n            var selectedCell = _this.owner.selection.start.paragraph.associatedCell;\n            //Need to bind the properties with current cell and current table formats.\n            var borders = undefined;\n            if (_this.checkClassName(_this.previewDivTopTop) || _this.checkClassName(_this.previewDivTopBottom)\n                || _this.checkClassName(_this.previewDivTopCenter) || _this.checkClassName(_this.previewDivBottomcenter)\n                || _this.checkClassName(_this.previewDivBottomLeft) || _this.checkClassName(_this.previewDivBottomRight)\n                || _this.checkClassName(_this.previewDivDiagonalRight) || _this.checkClassName(_this.previewDivLeftDiagonal)) {\n                borders = new WBorders();\n                if (_this.checkClassName(_this.previewDivTopTop)) {\n                    borders.top = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivTopBottom)) {\n                    borders.bottom = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivBottomLeft)) {\n                    borders.left = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivBottomRight)) {\n                    borders.right = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivTopCenter)) {\n                    borders.horizontal = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivBottomcenter)) {\n                    borders.vertical = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivLeftDiagonal)) {\n                    borders.diagonalDown = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivDiagonalRight)) {\n                    borders.diagonalUp = _this.getBorder();\n                }\n            }\n            var shading = new WShading();\n            var editorModule = _this.owner.owner.editorModule;\n            shading.backgroundColor = _this.shadingColorPicker.value;\n            if (_this.ulelementShading.index === 0) {\n                _this.applyTo = 0;\n                if (tablePropertiesDialog) {\n                    tablePropertiesDialog.isCellBordersAndShadingUpdated = true;\n                }\n                _this.cellFormat.borders = new WBorders();\n                if (!isNullOrUndefined(borders)) {\n                    editorModule.applyBordersInternal(_this.cellFormat.borders, borders);\n                }\n                else if (_this.noneDiv.classList.contains('e-de-table-border-inside-setting-click')) {\n                    editorModule.applyBordersInternal(_this.cellFormat.borders, new WBorders());\n                }\n                // Once option has been added for texture and foreground, need to handle this similar to Shading Fill.\n                if (!isNullOrUndefined(selectedCell.cellFormat.shading)) {\n                    shading.foregroundColor = selectedCell.cellFormat.shading.foregroundColor;\n                    shading.textureStyle = selectedCell.cellFormat.shading.textureStyle;\n                }\n                _this.cellFormat.shading = new WShading();\n                editorModule.applyShading(_this.cellFormat.shading, shading);\n            }\n            else {\n                if (tablePropertiesDialog) {\n                    tablePropertiesDialog.isTableBordersAndShadingUpdated = true;\n                }\n                _this.applyTo = 1;\n                var currentTableFormat = _this.owner.owner.selection.tableFormat.table.tableFormat;\n                _this.tableFormat.copyFormat(currentTableFormat);\n                _this.tableFormat.borders = new WBorders();\n                if (!isNullOrUndefined(borders)) {\n                    editorModule.applyBordersInternal(_this.tableFormat.borders, borders);\n                }\n                else if (_this.noneDiv.classList.contains('e-de-table-border-inside-setting-click')) {\n                    editorModule.applyBordersInternal(_this.tableFormat.borders, new WBorders());\n                }\n                // Once option has been added for texture and foreground, need to handle this similar to Shading Fill.\n                if (!isNullOrUndefined(currentTableFormat.shading)) {\n                    shading.foregroundColor = currentTableFormat.shading.foregroundColor;\n                    shading.textureStyle = currentTableFormat.shading.textureStyle;\n                }\n                _this.tableFormat.shading = new WShading();\n                editorModule.applyShading(_this.tableFormat.shading, shading);\n            }\n            _this.applyFormat();\n            _this.closeDialog();\n        };\n        /**\n         * @private\n         */\n        this.closeDialog = function () {\n            _this.owner.dialog.hide();\n            _this.closeBordersShadingsDialog();\n        };\n        this.closeBordersShadingsDialog = function () {\n            _this.owner.dialog2.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        this.handleSettingCheckBoxAction = function (event) {\n            var targetId = event.target.id;\n            var tableBorderDialogId = _this.target.id;\n            var targetDiv;\n            if (targetId === tableBorderDialogId + '_None_Div' || targetId === tableBorderDialogId + '_None_Div_Container'\n                || targetId === tableBorderDialogId + '_None_Div_Transparent') {\n                _this.updateClassForSettingDivElements();\n                _this.noneDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('none');\n            }\n            else if (targetId === tableBorderDialogId + '_Box_Div' || targetId === tableBorderDialogId + '_Box_Div_Container'\n                || targetId === tableBorderDialogId + '_Box_Div_Transparent') {\n                _this.updateClassForSettingDivElements();\n                _this.boxDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('box');\n            }\n            else if (targetId === tableBorderDialogId + '_All_Div' || targetId === tableBorderDialogId + '_All_Div_Container'\n                || targetId === tableBorderDialogId + '_All_Div_Transparent') {\n                _this.updateClassForSettingDivElements();\n                _this.allDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('all');\n            }\n            else {\n                _this.updateClassForSettingDivElements();\n                _this.customDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('customDiv');\n            }\n        };\n        this.handlePreviewCheckBoxAction = function (event) {\n            var target = event.target;\n            var targetId = target.id;\n            var tableBorderDialog = _this.target;\n            var tableBorderDialogId = _this.target.id;\n            var checkBox;\n            var compareClass = 'e-de-table-border-inside-preview-click';\n            _this.customDiv.click();\n            if (targetId === tableBorderDialogId + '_Preview_Div_TopTop_Container' || targetId === tableBorderDialogId + '_Preview_Div_TopTop'\n                || targetId === tableBorderDialogId + '_previewDivTopTopTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivTopTop);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_TopTop', 'TopTop');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_TopCenter_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_TopCenter'\n                || targetId === tableBorderDialogId + '_previewDivTopCenterTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivTopCenter);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Horizontal', '_Preview_Div_TopCenter', 'TopCenter');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_TopBottom_Container' || targetId === tableBorderDialogId + '_Preview_Div_TopBottom'\n                || targetId === tableBorderDialogId + '_previewDivTopBottomTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivTopBottom);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_TopBottom', 'TopBottom');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_LeftDiagonal_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_LeftDiagonal'\n                || targetId === tableBorderDialogId + '_previewDivLeftDiagonalTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivLeftDiagonal);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Left_Diagonal', '_Preview_Div_LeftDiagonal', 'LeftDiagonal');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_BottomLeft_Container' || targetId === tableBorderDialogId + '_Preview_Div_BottomLeft'\n                || targetId === tableBorderDialogId + '_previewDivBottomLeftTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivBottomLeft);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_BottomLeft', 'BottomLeft');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_BottomCenter_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_BottomCenter'\n                || targetId === tableBorderDialogId + '_previewDivBottomcenterTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivBottomcenter);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Vertical', '_Preview_Div_BottomCenter', 'BottomCenter');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_BottomRight_Container' || targetId === tableBorderDialogId + '_Preview_Div_BottomRight'\n                || targetId === tableBorderDialogId + '_previewDivBottomRightTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivBottomRight);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_BottomRight', 'BottomRight');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_RightDiagonal_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_RightDiagonal'\n                || targetId === tableBorderDialogId + '_previewDivDiagonalRightTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivDiagonalRight);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Right_Diagonal', '_Preview_Div_RightDiagonal', 'RightDiagonal');\n            }\n        };\n        this.applyTableCellPreviewBoxes = function () {\n            _this.customDiv.click();\n            if (!isNullOrUndefined(_this.ulelementShading)) {\n                if (_this.ulelementShading.index === 0) {\n                    _this.previewDivBottomcenterContainer.style.display = 'none';\n                    _this.previewDivTopCenterContainer.style.display = 'none';\n                    _this.previewVerticalDiv.style.display = 'none';\n                    _this.previewHorizontalDiv.style.display = 'none';\n                    _this.previewDivLeftDiagonal.style.display = '';\n                    _this.previewDivDiagonalRight.style.display = '';\n                    _this.previewDivBottomRightContainer.style.left = '80px';\n                }\n                else {\n                    _this.previewDivLeftDiagonal.style.display = 'none';\n                    _this.previewDivDiagonalRight.style.display = 'none';\n                    _this.previewDivBottomcenterContainer.style.display = '';\n                    _this.previewDivTopCenterContainer.style.display = '';\n                    _this.previewVerticalDiv.style.display = '';\n                    _this.previewHorizontalDiv.style.display = '';\n                    _this.previewDivBottomRightContainer.style.left = '110px';\n                }\n            }\n        };\n        this.applyPreviewTableBackgroundColor = function (args) {\n            if (!isNullOrUndefined(args.currentValue)) {\n                var color = args.currentValue.hex;\n                _this.previewDiv.style.backgroundColor = color;\n            }\n        };\n        this.applyPreviewTableBorderColor = function (args) {\n            if (!isNullOrUndefined(args.currentValue)) {\n                var color = args.currentValue.hex;\n                _this.previewDiv.style.borderColor = color;\n                _this.previewRightDiagonalDiv.style.backgroundColor = color;\n                _this.previewLeftDiagonalDiv.style.backgroundColor = color;\n                _this.previewVerticalDiv.style.backgroundColor = color;\n                _this.previewHorizontalDiv.style.backgroundColor = color;\n            }\n        };\n        this.owner = viewer;\n    }\n    BordersAndShadingDialog.prototype.getModuleName = function () {\n        return 'BordersAndShadingDialog';\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-func-body-length\n    BordersAndShadingDialog.prototype.initBordersAndShadingsDialog = function (localeValue, isRtl) {\n        var instance = this;\n        this.target = createElement('div', {\n            id: instance.owner.owner.containerId + '_table_border_shadings',\n            className: 'e-de-table-border-shading-dlg'\n        });\n        var displayText = createElement('div', {\n            innerHTML: localeValue.getConstant('Borders'), styles: 'position: absolute;top: 65px;',\n            id: this.target.id + '_border_label', className: 'e-de-table-border-heading'\n        });\n        var settingsContiner = createElement('div', {\n            styles: 'display: inline-block;position: absolute;top: 105px;width: 100px;height: 235px;border-style: none;',\n            id: this.target.id + '_border_settings'\n        });\n        var styleContainerPosition;\n        if (isRtl) {\n            styleContainerPosition = 'left: 148px;';\n        }\n        else {\n            styleContainerPosition = 'left: 125px;';\n        }\n        var styleContainer = createElement('div', {\n            // tslint:disable-next-line:max-line-length\n            styles: 'display: inline-block;position: absolute;' + styleContainerPosition + 'top: 125px;width: 150px;height: 235px;padding-left: 40px;border-style: none;padding-right: 40px;',\n            id: this.target.id + '_border_style'\n        });\n        var previewContinerPosition;\n        if (isRtl) {\n            previewContinerPosition = 'right: 342px;';\n        }\n        else {\n            previewContinerPosition = 'left: 345px;';\n        }\n        var previewContiner = createElement('div', {\n            // tslint:disable-next-line:max-line-length\n            styles: 'display: inline-block;position: absolute;' + previewContinerPosition + 'top: 87px;width: 180px;height: 235px;padding: 0px;border-style: none;',\n            id: this.target.id + '_border_preview'\n        });\n        var styleText = createElement('div', {\n            innerHTML: localeValue.getConstant('Style'), styles: 'width: 100%;padding-bottom: 10px;',\n            className: 'e-de-table-element-subheading'\n        });\n        var dropDownList = createElement('select', {\n            id: this.target.id + '_border_style_dropDown'\n        });\n        dropDownList.innerHTML = '<option>' + localeValue.getConstant('None') + '</option><option>'\n            + localeValue.getConstant('Single') + '</option><option>' + localeValue.getConstant('Dot') + '</option><option>'\n            + localeValue.getConstant('DashSmallGap') + '</option><option>' + localeValue.getConstant('DashLargeGap') + '</option><option>'\n            + localeValue.getConstant('DashDot') + '</option><option>' + localeValue.getConstant('DashDotDot') + '</option><option>'\n            + localeValue.getConstant('Double') + '</option><option>' + localeValue.getConstant('Triple') + '</option><option>'\n            + localeValue.getConstant('ThinThickSmallGap') + '</option><option>'\n            + localeValue.getConstant('ThickThinSmallGap') + '</option><option>' + localeValue.getConstant('ThinThickThinSmallGap')\n            + '</option><option>' + localeValue.getConstant('ThinThickMediumGap') + '</option><option>'\n            + localeValue.getConstant('ThickThinMediumGap') + '</option><option>' + localeValue.getConstant('ThinThickThinMediumGap')\n            + '</option><option>' + localeValue.getConstant('ThinThickLargeGap') + '</option><option>'\n            + localeValue.getConstant('ThickThinLargeGap') + '</option><option>' + localeValue.getConstant('ThinThickThinLargeGap')\n            + '</option><option>' + localeValue.getConstant('SingleWavy') + '</option><option>'\n            + localeValue.getConstant('DoubleWavy') + '</option><option>' + localeValue.getConstant('DashDotStroked')\n            + '</option><option>' + localeValue.getConstant('Emboss3D') + '</option><option>' + localeValue.getConstant('Engrave3D')\n            + '</option><option>' + localeValue.getConstant('Outset') + '</option><option>'\n            + localeValue.getConstant('Inset') + '</option><option>' + localeValue.getConstant('Thick') + '</option>';\n        var widthText = createElement('div', {\n            innerHTML: localeValue.getConstant('Width'), styles: 'width:100%;padding-top: 20px;padding-bottom: 10px;',\n            className: 'e-de-table-element-subheading'\n        });\n        var widthNumeric = createElement('input', {\n            id: this.target.id + '_width'\n        });\n        var colorText = createElement('div', {\n            innerHTML: localeValue.getConstant('Color'), styles: 'padding-top: 25px;',\n            className: 'e-de-table-setting-heading'\n        });\n        var borderColorPickerElement = createElement('input', {\n            attrs: { 'type': 'color' },\n            id: this.target.id + '_border_color',\n            styles: 'width: 30px;position: absolute;left: 90px;',\n            className: 'e-dlg-clr-pkr-top'\n        });\n        var settingText = createElement('div', {\n            innerHTML: localeValue.getConstant('Setting'), styles: 'width: 100%;position: absolute;',\n            className: 'e-de-table-setting-heading'\n        });\n        var noneDivContainer = createElement('div', {\n            id: this.target.id + '_None_Div_Container', className: 'e-de-table-border-none'\n        });\n        var divLabelPadding;\n        if (isRtl) {\n            divLabelPadding = 'padding-right:10px;';\n        }\n        else {\n            divLabelPadding = 'padding-left:10px;';\n        }\n        this.noneDiv = createElement('div', {\n            id: this.target.id + '_None_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var noneDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('None'), className: 'e-de-table-setting-labels-heading',\n            styles: divLabelPadding + 'top: 20px;position: absolute;',\n            id: this.target.id + '_None_Div_Label'\n        });\n        var boxDivContainer = createElement('div', {\n            id: this.target.id + '_Box_Div_Container', className: 'e-de-table-border-box'\n        });\n        this.boxDiv = createElement('div', {\n            id: this.target.id + '_Box_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var boxDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('Box'), className: 'e-de-table-setting-labels-heading',\n            styles: divLabelPadding + 'top: 20px;position: absolute;',\n            id: this.target.id + '_Box_Div_Label'\n        });\n        var allDivContainer = createElement('div', {\n            id: this.target.id + '_All_Div_Container', className: 'e-de-table-border-all'\n        });\n        this.allDiv = createElement('div', {\n            id: this.target.id + '_All_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var allDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('All'), className: 'e-de-table-setting-labels-heading',\n            styles: divLabelPadding + 'top: 25px;position: absolute;',\n            id: this.target.id + '_All_Div_Label'\n        });\n        var customDivContainer = createElement('div', {\n            id: this.target.id + '_Custom_Div_Container', className: 'e-de-table-border-custom'\n        });\n        this.customDiv = createElement('div', {\n            id: this.target.id + '_Custom_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var customDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('Custom'), className: 'e-de-table-setting-labels-heading',\n            styles: divLabelPadding + 'top: 25px;position: absolute;',\n            id: this.target.id + '_Custom_Div_Label'\n        });\n        this.noneDivTransparent = createElement('div', {\n            id: this.target.id + '_None_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-none-setting'\n        });\n        this.boxDivTransparent = createElement('div', {\n            id: this.target.id + '_Box_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-box-setting'\n        });\n        this.allDivTransparent = createElement('div', {\n            id: this.target.id + '_All_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-all-setting'\n        });\n        this.customDivTransparent = createElement('div', {\n            id: this.target.id + '_Custom_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-custom-setting'\n        });\n        if (isRtl) {\n            this.noneDivTransparent.classList.add('e-de-rtl');\n            this.boxDivTransparent.classList.add('e-de-rtl');\n            this.allDivTransparent.classList.add('e-de-rtl');\n            this.customDivTransparent.classList.add('e-de-rtl');\n        }\n        var previewTextPosition;\n        if (isRtl) {\n            previewTextPosition = 'margin-right: 10px;';\n        }\n        else {\n            previewTextPosition = 'margin-left: 10px;';\n        }\n        var previewText = createElement('div', {\n            innerHTML: localeValue.getConstant('Preview'), className: 'e-de-table-setting-heading',\n            styles: 'position: absolute;top: 20px;' + previewTextPosition\n        });\n        this.previewDiv = createElement('div', {\n            styles: 'width: 80px;height: 80px;position: absolute; left: 50px;top: 50px;',\n            id: this.target.id + '_Preview_Div', className: 'e-de-border-dlg-preview-div'\n        });\n        this.previewRightDiagonalDiv = createElement('div', {\n            styles: 'position: absolute;width:1px;height:113px;left: 90px;top: 34px;transform: rotate(135deg);',\n            id: this.target.id + '_Preview_Div_Right_Diagonal',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewLeftDiagonalDiv = createElement('div', {\n            styles: 'position: absolute;width: 1px;height: 113px;left: 90px;top: 34px;transform:rotate(45deg);',\n            id: this.target.id + '_Preview_Div_Left_Diagonal',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewVerticalDiv = createElement('div', {\n            styles: 'width: 1px;height: 81px;position: absolute;left: 90px;top: 50px;',\n            id: this.target.id + '_Preview_Div_Vertical',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewHorizontalDiv = createElement('div', {\n            styles: 'width: 81px;height: 1px;position: absolute;left: 50px;top: 90px;',\n            id: this.target.id + '_Preview_Div_Horizontal',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        var previewDivTopPosition;\n        if (isRtl) {\n            previewDivTopPosition = 'right: 10px;';\n        }\n        else {\n            previewDivTopPosition = 'left: 10px;';\n        }\n        this.previewDivTopTopContainer = createElement('div', {\n            styles: 'top: 50px;position: absolute;' + previewDivTopPosition, id: this.target.id + '_Preview_Div_TopTop_Container'\n        });\n        this.previewDivTopTop = createElement('div', {\n            id: this.target.id + '_Preview_Div_TopTop',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivTopCenterContainer = createElement('div', {\n            styles: 'top: 80px;position: absolute;' + previewDivTopPosition, id: this.target.id + '_Preview_Div_TopCenter_Container'\n        });\n        this.previewDivTopCenter = createElement('div', {\n            id: this.target.id + '_Preview_Div_TopCenter',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivTopBottomContainer = createElement('div', {\n            styles: 'top: 110px;position: absolute;' + previewDivTopPosition, id: this.target.id + '_Preview_Div_TopBottom_Container'\n        });\n        this.previewDivTopBottom = createElement('div', {\n            id: this.target.id + '_Preview_Div_TopBottom',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivLeftDiagonalContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_LeftDiagonal_Container'\n        });\n        this.previewDivLeftDiagonal = createElement('div', {\n            id: this.target.id + '_Preview_Div_LeftDiagonal',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        var previewDivBottomLeftPosition;\n        var previewDivBottomCenterPosition;\n        var previewDivBottomRightPosition;\n        if (isRtl) {\n            previewDivBottomLeftPosition = 'left: 104px';\n            previewDivBottomCenterPosition = 'left: 74px';\n            previewDivBottomRightPosition = 'left: 44px';\n        }\n        else {\n            previewDivBottomLeftPosition = 'left: 50px;';\n            previewDivBottomCenterPosition = 'left : 80px;';\n            previewDivBottomRightPosition = 'left : 110px';\n        }\n        this.previewDivBottomLeftContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;' + previewDivBottomLeftPosition,\n            id: this.target.id + '_Preview_Div_BottomLeft_Container'\n        });\n        this.previewDivBottomLeft = createElement('div', {\n            id: this.target.id + '_Preview_Div_BottomLeft',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivBottomcenterContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;' + previewDivBottomCenterPosition,\n            id: this.target.id + '_Preview_Div_BottomCenter_Container'\n        });\n        this.previewDivBottomcenter = createElement('div', {\n            id: this.target.id + '_Preview_Div_BottomCenter',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivBottomRightContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;' + previewDivBottomRightPosition,\n            id: this.target.id + '_Preview_Div_BottomRight_Container'\n        });\n        this.previewDivBottomRight = createElement('div', {\n            id: this.target.id + '_Preview_Div_BottomRight',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivDiagonalRightContainer = createElement('div', {\n            styles: 'top: 145px; position: absolute; left: 110px;', id: this.target.id + '_Preview_Div_RightDiagonal_Container'\n        });\n        this.previewDivDiagonalRight = createElement('div', {\n            id: this.target.id + '_Preview_Div_RightDiagonal',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivTopTopTransParent = createElement('div', {\n            id: this.target.id + '_previewDivTopTopTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-toptop-alignment'\n        });\n        this.previewDivTopCenterTransParent = createElement('div', {\n            id: this.target.id + '_previewDivTopCenterTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-topcenter-alignment'\n        });\n        this.previewDivTopBottomTransParent = createElement('div', {\n            id: this.target.id + '_previewDivTopBottomTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-topbottom-alignment'\n        });\n        this.previewDivLeftDiagonalTransParent = createElement('div', {\n            id: this.target.id + '_previewDivLeftDiagonalTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-diagionalup-alignment'\n        });\n        this.previewDivBottomLeftTransparent = createElement('div', {\n            id: this.target.id + '_previewDivBottomLeftTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-bottomleft-alignment'\n        });\n        this.previewDivBottomcenterTransparent = createElement('div', {\n            id: this.target.id + '_previewDivBottomcenterTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-bottomcenter-alignment'\n        });\n        this.previewDivBottomRightTransparent = createElement('div', {\n            id: this.target.id + '_previewDivBottomRightTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-bottomright-alignment'\n        });\n        this.previewDivDiagonalRightTransparent = createElement('div', {\n            id: this.target.id + '_previewDivDiagonalRightTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-diagionaldown-alignment'\n        });\n        var shadingContainerPosition;\n        if (isRtl) {\n            shadingContainerPosition = 'left:60px;';\n        }\n        else {\n            shadingContainerPosition = 'left:17px;';\n        }\n        this.shadingContiner = createElement('div', {\n            /* tslint:disable:max-line-length */\n            styles: 'display:inline-block;position:absolute;' + shadingContainerPosition + ';width:400px;height:100px;padding:0px;border-style: none;margin-left:10px;',\n            id: this.target.id + '_shading_preview', className: 'e-de-table-shading-preview'\n        });\n        var shadingText = createElement('div', {\n            innerHTML: localeValue.getConstant('Shading'), className: 'e-de-table-border-heading',\n            styles: 'padding-top: 30px;left: 5px;'\n        });\n        var shadings = createElement('div', { styles: 'display:flex;' });\n        var label = createElement('div', {\n            innerHTML: localeValue.getConstant('Fill'), className: 'e-de-table-setting-heading e-de-table-border-fill',\n            styles: 'top: 50px;left: 10px;'\n        });\n        var shadingColorPickerElement = createElement('input', {\n            attrs: { 'type': 'color' },\n            id: this.target.id + '_shading_color', styles: 'position: absolute;top: 75px;left: 40px;width: 30px;'\n        });\n        var shdApplyPosition;\n        if (isRtl) {\n            shdApplyPosition = 'left: 75px;';\n        }\n        else {\n            shdApplyPosition = 'left: 150px;';\n        }\n        var shdApply = createElement('div', {\n            styles: 'position:absolute;top:41px;' + shdApplyPosition + 'width:180px;'\n        });\n        var div = createElement('div', {\n            styles: 'width:100px;padding-bottom: 10px;', innerHTML: localeValue.getConstant('Apply To'),\n            className: 'e-de-table-element-subheading'\n        });\n        var divsion = createElement('div', { styles: 'width:100px;position:absolute;' });\n        var ulelementShading = createElement('select', {\n            innerHTML: '<option>' + localeValue.getConstant('Cell') + '</option>'\n                + '<option>' + localeValue.getConstant('Table') + '</option>',\n            id: this.target.id + '_shading'\n        });\n        divsion.appendChild(ulelementShading);\n        this.noneDiv.appendChild(this.noneDivTransparent);\n        this.boxDiv.appendChild(this.boxDivTransparent);\n        this.allDiv.appendChild(this.allDivTransparent);\n        this.customDiv.appendChild(this.customDivTransparent);\n        noneDivContainer.appendChild(this.noneDiv);\n        noneDivContainer.appendChild(noneDivLabel);\n        boxDivContainer.appendChild(this.boxDiv);\n        boxDivContainer.appendChild(boxDivLabel);\n        allDivContainer.appendChild(this.allDiv);\n        allDivContainer.appendChild(allDivLabel);\n        customDivContainer.appendChild(this.customDiv);\n        customDivContainer.appendChild(customDivLabel);\n        settingsContiner.appendChild(settingText);\n        settingsContiner.appendChild(noneDivContainer);\n        settingsContiner.appendChild(boxDivContainer);\n        settingsContiner.appendChild(allDivContainer);\n        settingsContiner.appendChild(customDivContainer);\n        this.previewDivBottomcenter.appendChild(this.previewDivBottomcenterTransparent);\n        this.previewDivBottomRight.appendChild(this.previewDivBottomRightTransparent);\n        this.previewDivBottomLeft.appendChild(this.previewDivBottomLeftTransparent);\n        this.previewDivTopTop.appendChild(this.previewDivTopTopTransParent);\n        this.previewDivTopCenter.appendChild(this.previewDivTopCenterTransParent);\n        this.previewDivTopBottom.appendChild(this.previewDivTopBottomTransParent);\n        this.previewDivDiagonalRight.appendChild(this.previewDivDiagonalRightTransparent);\n        this.previewDivLeftDiagonal.appendChild(this.previewDivLeftDiagonalTransParent);\n        this.previewDivBottomcenterContainer.appendChild(this.previewDivBottomcenter);\n        this.previewDivBottomLeftContainer.appendChild(this.previewDivBottomLeft);\n        this.previewDivBottomRightContainer.appendChild(this.previewDivBottomRight);\n        this.previewDivDiagonalRightContainer.appendChild(this.previewDivDiagonalRight);\n        this.previewDivLeftDiagonalContainer.appendChild(this.previewDivLeftDiagonal);\n        this.previewDivTopBottomContainer.appendChild(this.previewDivTopBottom);\n        this.previewDivTopCenterContainer.appendChild(this.previewDivTopCenter);\n        this.previewDivTopTopContainer.appendChild(this.previewDivTopTop);\n        previewContiner.appendChild(previewText);\n        previewContiner.appendChild(this.previewDiv);\n        previewContiner.appendChild(this.previewRightDiagonalDiv);\n        previewContiner.appendChild(this.previewHorizontalDiv);\n        previewContiner.appendChild(this.previewLeftDiagonalDiv);\n        previewContiner.appendChild(this.previewVerticalDiv);\n        previewContiner.appendChild(this.previewDivBottomcenterContainer);\n        previewContiner.appendChild(this.previewDivBottomLeftContainer);\n        previewContiner.appendChild(this.previewDivBottomRightContainer);\n        previewContiner.appendChild(this.previewDivDiagonalRightContainer);\n        previewContiner.appendChild(this.previewDivLeftDiagonalContainer);\n        previewContiner.appendChild(this.previewDivTopBottomContainer);\n        previewContiner.appendChild(this.previewDivTopCenterContainer);\n        previewContiner.appendChild(this.previewDivTopTopContainer);\n        shdApply.appendChild(div);\n        shdApply.appendChild(divsion);\n        shadings.appendChild(label);\n        shadings.appendChild(shadingColorPickerElement);\n        shadings.appendChild(shdApply);\n        this.shadingContiner.appendChild(shadingText);\n        this.shadingContiner.appendChild(shadings);\n        styleContainer.appendChild(styleText);\n        styleContainer.appendChild(dropDownList);\n        styleContainer.appendChild(widthText);\n        styleContainer.appendChild(widthNumeric);\n        styleContainer.appendChild(colorText);\n        styleContainer.appendChild(borderColorPickerElement);\n        this.target.appendChild(displayText);\n        this.target.appendChild(settingsContiner);\n        this.target.appendChild(styleContainer);\n        this.target.appendChild(previewContiner);\n        this.target.appendChild(this.shadingContiner);\n        // Handling Setting Container\n        noneDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        boxDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        allDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        customDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        // Handling Preview Div Container\n        this.previewDivBottomcenterContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivBottomLeftContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivBottomRightContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivTopTopContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivTopBottomContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivTopCenterContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivDiagonalRightContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivLeftDiagonalContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        // handling dropdown change\n        this.borderWidth = new NumericTextBox({\n            value: 0, min: 0, max: 6, decimals: 2,\n            width: 150, enablePersistence: false\n        });\n        this.borderWidth.appendTo(widthNumeric);\n        this.borderStyle = new DropDownList({\n            width: '150px', popupHeight: '150px', index: 1,\n            enableRtl: isRtl\n        });\n        this.borderStyle.appendTo(dropDownList);\n        this.ulelementShading = new DropDownList({\n            width: '150px', change: this.applyTableCellPreviewBoxes, index: 1,\n            enableRtl: isRtl\n        });\n        this.ulelementShading.appendTo(ulelementShading);\n        this.borderColorPicker = new ColorPicker({\n            value: '#000000', change: this.applyPreviewTableBorderColor,\n            enableRtl: isRtl, locale: this.owner.owner.locale\n        });\n        this.borderColorPicker.appendTo(borderColorPickerElement);\n        this.shadingColorPicker = new ColorPicker({\n            value: '#000000', change: this.applyPreviewTableBackgroundColor,\n            enableRtl: isRtl, locale: this.owner.owner.locale\n        });\n        this.shadingColorPicker.appendTo(shadingColorPickerElement);\n        if (isRtl) {\n            label.classList.add('e-de-rtl');\n        }\n    };\n    BordersAndShadingDialog.prototype.applyFormat = function () {\n        var selection = this.owner.selection;\n        var editorModule = this.owner.owner.editorModule;\n        editorModule.initComplexHistory('BordersAndShading');\n        editorModule.isBordersAndShadingDialog = true;\n        if (this.applyTo === 0) {\n            editorModule.onCellFormat(this.cellFormat);\n        }\n        else {\n            editorModule.onTableFormat(this.tableFormat);\n        }\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.owner.editorHistory.updateComplexHistory();\n        }\n        editorModule.isBordersAndShadingDialog = false;\n    };\n    BordersAndShadingDialog.prototype.getBorder = function () {\n        var border = new WBorder();\n        border.color = this.borderColorPicker.value;\n        border.lineStyle = this.borderStyle.text;\n        border.lineWidth = this.borderWidth.value;\n        return border;\n    };\n    BordersAndShadingDialog.prototype.checkClassName = function (element) {\n        return element.classList.contains('e-de-table-border-inside-preview-click');\n    };\n    /**\n     * @private\n     */\n    BordersAndShadingDialog.prototype.show = function () {\n        var localeValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localeValue.setLocale(this.owner.owner.locale);\n        if (!this.target) {\n            this.initBordersAndShadingsDialog(localeValue, this.owner.owner.enableRtl);\n        }\n        this.loadBordersShadingsPropertiesDialog();\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.header = localeValue.getConstant('Borders and Shading');\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.closeBordersShadingsDialog;\n        this.owner.dialog.position = { X: 'center', Y: 'center' };\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.buttons = [{\n                click: this.applyBordersShadingsProperties,\n                buttonModel: { content: localeValue.getConstant('Ok'), cssClass: 'e-flat e-table-border-shading-okay', isPrimary: true }\n            },\n            {\n                click: this.closeDialog,\n                buttonModel: { content: localeValue.getConstant('Cancel'), cssClass: 'e-flat e-table-border-shading-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    BordersAndShadingDialog.prototype.updateClassForSettingDivElements = function () {\n        var settingDivs = this.target.getElementsByClassName('e-de-table-border-inside-setting');\n        for (var j = 0; j < settingDivs.length; j++) {\n            if (settingDivs[j].className.indexOf('e-de-table-border-inside-setting-click') !== -1) {\n                var tempClassName = settingDivs[j].className;\n                tempClassName = tempClassName.replace('e-de-table-border-inside-setting-click', '');\n                settingDivs[j].className = tempClassName;\n            }\n        }\n    };\n    BordersAndShadingDialog.prototype.setSettingPreviewDivElement = function (position) {\n        switch (position) {\n            case 'none':\n                this.previewDivTopTop.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivTopCenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivTopBottom.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomLeft.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomcenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.isShowHidePreviewTableElements('none');\n                break;\n            case 'box':\n                this.previewDivTopCenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomcenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivTopTop.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopBottom.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomRight.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomLeft.classList.add('e-de-table-border-inside-preview-click');\n                this.isShowHidePreviewTableElements('box');\n                break;\n            case 'all':\n                this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomcenter.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopTop.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopBottom.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomRight.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomLeft.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopCenter.classList.add('e-de-table-border-inside-preview-click');\n                this.isShowHidePreviewTableElements('all');\n                break;\n        }\n    };\n    BordersAndShadingDialog.prototype.isShowHidePreviewTableElements = function (settingDiv) {\n        switch (settingDiv) {\n            case 'none':\n                this.previewDiv.style.border = 'none';\n                this.previewRightDiagonalDiv.style.display = 'none';\n                this.previewLeftDiagonalDiv.style.display = 'none';\n                this.previewHorizontalDiv.style.display = 'none';\n                this.previewVerticalDiv.style.display = 'none';\n                break;\n            case 'box':\n                this.previewDiv.style.border = '1px solid rgba(0, 0, 0, .54)';\n                this.previewRightDiagonalDiv.style.display = 'none';\n                this.previewLeftDiagonalDiv.style.display = 'none';\n                this.previewHorizontalDiv.style.display = 'none';\n                this.previewVerticalDiv.style.display = 'none';\n                break;\n            case 'all':\n                this.previewDiv.style.border = '1px solid rgba(0, 0, 0, .54)';\n                this.previewRightDiagonalDiv.style.display = 'none';\n                this.previewLeftDiagonalDiv.style.display = 'none';\n                this.previewHorizontalDiv.style.display = 'block';\n                this.previewVerticalDiv.style.display = 'block';\n                break;\n        }\n    };\n    BordersAndShadingDialog.prototype.handlePreviewCheckBoxShowHide = function (tableBorderDialogId, compareClass, element) {\n        if (element.classList.contains(compareClass)) {\n            element.classList.remove(compareClass);\n        }\n        else {\n            element.classList.add(compareClass);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    BordersAndShadingDialog.prototype.showHidePreviewDivElements = function (tableBorderDialogId, compareClass, elementClass, compareElementClass, position) {\n        var setElement = document.getElementById(tableBorderDialogId + elementClass);\n        var compareElement = document.getElementById(tableBorderDialogId + compareElementClass);\n        if (position === 'TopTop') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-top');\n        }\n        else if (position === 'TopCenter') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n        else if (position === 'TopBottom') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-bottom');\n        }\n        else if (position === 'LeftDiagonal') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n        else if (position === 'BottomLeft') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-left');\n        }\n        else if (position === 'BottomCenter') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n        else if (position === 'BottomRight') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-right');\n        }\n        else if (position === 'RightDiagonal') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n    };\n    BordersAndShadingDialog.prototype.setPropertyPreviewDivElement = function (ele, compareElement, compareClass, property) {\n        if (compareElement.classList.contains(compareClass) && property.split('-')[0] === 'border') {\n            /* tslint:disable:no-any */\n            ele.style[property] = '1px solid rgba(0, 0, 0, .54)';\n        }\n        else if (compareElement.classList.contains(compareClass) && property === 'display') {\n            ele.style[property] = 'block';\n        }\n        else {\n            ele.style[property] = 'none';\n            /* tslint:enable:no-any */\n        }\n    };\n    BordersAndShadingDialog.prototype.loadBordersShadingsPropertiesDialog = function () {\n        var tableFormat = this.owner.selection.tableFormat.table.tableFormat;\n        var lineStyle;\n        var borderColor;\n        var fillColor;\n        var borderWidth;\n        if (!isNullOrUndefined(tableFormat) && !isNullOrUndefined(tableFormat.borders)) {\n            this.cloneBorders(tableFormat.borders);\n            if (isNullOrUndefined(tableFormat.borders) || isNullOrUndefined(tableFormat.borders.top)) {\n                lineStyle = 1;\n                borderColor = '#000000';\n                borderWidth = 0;\n                fillColor = '#000000';\n            }\n            else {\n                lineStyle = this.getLineStyle(tableFormat.borders.top.lineStyle);\n                borderColor = tableFormat.borders.top.color;\n                borderWidth = tableFormat.borders.top.getLineWidth();\n                fillColor = tableFormat.shading.backgroundColor;\n            }\n        }\n        this.borderColorPicker.value = borderColor;\n        this.shadingColorPicker.value = fillColor;\n        /* tslint:disable:no-any */\n        var colorPickerEvent = {\n            target: this.borderColorPicker, ctrlKey: false,\n            shiftKey: false, which: 0\n        };\n        var fillColorEvent = {\n            target: this.shadingColorPicker, ctrlKey: false,\n            shiftKey: false, which: 0\n        };\n        /* tslint:enable:no-any */\n        this.applyPreviewTableBackgroundColor(fillColorEvent);\n        this.applyPreviewTableBorderColor(colorPickerEvent);\n        this.ulelementShading.index = 1;\n        this.previewDivLeftDiagonal.style.display = 'none';\n        this.previewDivDiagonalRight.style.display = 'none';\n        this.borderWidth.value = borderWidth;\n        this.borderStyle.index = lineStyle;\n    };\n    // tslint:disable:max-func-body-length\n    BordersAndShadingDialog.prototype.cloneBorders = function (borders) {\n        var topBorder = false;\n        var bottomBorder = false;\n        var leftBorder = false;\n        var rightBorder = false;\n        var horizontalBorder = false;\n        var verticalBorder = false;\n        var diagonalDownBorder = false;\n        var customBorder = false;\n        var diagonalUpBorder = false;\n        if (borders !== null) {\n            if (borders.top && (borders.top.hasNoneStyle || borders.top.lineStyle !== 'None')) {\n                topBorder = true;\n            }\n            if (borders.bottom && (borders.bottom.hasNoneStyle || borders.bottom.lineStyle !== 'None')) {\n                bottomBorder = true;\n            }\n            if (borders.left && (borders.left.hasNoneStyle || borders.left.lineStyle !== 'None')) {\n                leftBorder = true;\n            }\n            if (borders.right && (borders.right.hasNoneStyle || borders.right.lineStyle !== 'None')) {\n                rightBorder = true;\n            }\n            if (borders.horizontal && (borders.horizontal.hasNoneStyle || borders.horizontal.lineStyle !== 'None')) {\n                horizontalBorder = true;\n            }\n            if (borders.vertical && (borders.vertical.hasNoneStyle || borders.vertical.lineStyle !== 'None')) {\n                verticalBorder = true;\n            }\n            if (borders.diagonalDown && (borders.diagonalDown.hasNoneStyle || borders.diagonalDown.lineStyle !== 'None')) {\n                diagonalDownBorder = true;\n            }\n            if (borders.diagonalUp && (borders.diagonalUp.hasNoneStyle || borders.diagonalUp.lineStyle !== 'None')) {\n                diagonalUpBorder = true;\n            }\n            if (!(!topBorder || !bottomBorder || !leftBorder || !rightBorder)) {\n                if (!(!topBorder || !bottomBorder || !leftBorder || !rightBorder || !horizontalBorder\n                    || !verticalBorder || diagonalUpBorder || diagonalDownBorder)) {\n                    if ((topBorder && bottomBorder && leftBorder && rightBorder && horizontalBorder && verticalBorder\n                        && !diagonalUpBorder && !diagonalDownBorder)) {\n                        if (borders.top.hasNoneStyle && borders.bottom.hasNoneStyle && borders.left.hasNoneStyle\n                            && borders.right.hasNoneStyle && borders.horizontal.hasNoneStyle && borders.vertical.hasNoneStyle) {\n                            this.setSettingPreviewDivElement('none');\n                            this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.noneDiv.classList.add('e-de-table-border-inside-setting-click');\n                            this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        }\n                        else {\n                            this.setSettingPreviewDivElement('all');\n                            this.allDiv.classList.add('e-de-table-border-inside-setting-click');\n                            this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.noneDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        }\n                    }\n                }\n                else if ((leftBorder && bottomBorder && topBorder && rightBorder && !horizontalBorder && !verticalBorder)) {\n                    if (borders.top.hasNoneStyle && borders.bottom.hasNoneStyle && borders.left.hasNoneStyle\n                        && borders.right.hasNoneStyle && borders.horizontal.hasNoneStyle && borders.vertical.hasNoneStyle) {\n                        this.setSettingPreviewDivElement('none');\n                        this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.noneDiv.classList.add('e-de-table-border-inside-setting-click');\n                    }\n                    else {\n                        this.setSettingPreviewDivElement('box');\n                        this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.noneDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.boxDiv.classList.add('e-de-table-border-inside-setting-click');\n                        this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                    }\n                }\n                else {\n                    customBorder = true;\n                }\n            }\n            else {\n                customBorder = true;\n            }\n            this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n            this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n            if (customBorder) {\n                this.customDiv.classList.add('e-de-table-border-inside-setting-click');\n                this.noneDiv.classList.remove('e-de-table-border-inside-setting-click');\n                this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                if (topBorder) {\n                    this.previewDivTopTop.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivTopTop.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (bottomBorder) {\n                    this.previewDivTopBottom.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivTopBottom.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (leftBorder) {\n                    this.previewDivBottomLeft.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivBottomLeft.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (rightBorder) {\n                    this.previewDivBottomRight.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivBottomRight.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (verticalBorder) {\n                    this.previewDivBottomcenter.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivBottomcenter.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (horizontalBorder) {\n                    this.previewDivTopCenter.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivTopCenter.classList.remove('e-de-table-border-inside-preview-click');\n                }\n            }\n        }\n    };\n    BordersAndShadingDialog.prototype.getLineStyle = function (lineStyle) {\n        switch (lineStyle) {\n            case 'Single': return 1;\n            case 'Dot': return 2;\n            case 'DashSmallGap': return 3;\n            case 'DashLargeGap': return 4;\n            case 'DashDot': return 5;\n            case 'DashDotDot': return 6;\n            case 'Double': return 7;\n            case 'Triple': return 8;\n            case 'ThinThickSmallGap': return 9;\n            case 'ThickThinSmallGap': return 10;\n            case 'ThinThickThinSmallGap': return 11;\n            case 'ThinThickMediumGap': return 12;\n            case 'ThickThinMediumGap': return 13;\n            case 'ThinThickThinMediumGap': return 14;\n            case 'ThinThickLargeGap': return 15;\n            case 'ThickThinLargeGap': return 16;\n            case 'ThinThickThinLargeGap': return 17;\n            case 'SingleWavy': return 18;\n            case 'DoubleWavy': return 19;\n            case 'DashDotStroked': return 20;\n            case 'Emboss3D': return 21;\n            case 'Engrave3D': return 22;\n            case 'Outset': return 23;\n            case 'Inset': return 24;\n            case 'Thick': return 25;\n        }\n        return 0;\n    };\n    /**\n     * @private\n     */\n    BordersAndShadingDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var k = 0; k < this.target.childNodes.length; k++) {\n                this.target.removeChild(this.target.childNodes[k]);\n                k--;\n            }\n            this.target = undefined;\n        }\n        if (this.cellFormat) {\n            this.cellFormat.destroy();\n            this.cellFormat = undefined;\n        }\n        if (this.tableFormat) {\n            this.tableFormat.destroy();\n            this.tableFormat = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        if (!isNullOrUndefined(this.borderStyle)) {\n            this.borderStyle.destroy();\n        }\n        this.borderStyle = undefined;\n        if (!isNullOrUndefined(this.borderColorPicker)) {\n            this.borderColorPicker.destroy();\n        }\n        this.borderColorPicker = undefined;\n        if (!isNullOrUndefined(this.shadingColorPicker)) {\n            this.shadingColorPicker.destroy();\n        }\n        this.shadingColorPicker = undefined;\n        if (!isNullOrUndefined(this.ulelementShading)) {\n            this.ulelementShading.destroy();\n        }\n        this.ulelementShading = undefined;\n        this.noneDivTransparent = undefined;\n        this.boxDivTransparent = undefined;\n        this.allDivTransparent = undefined;\n        this.customDivTransparent = undefined;\n        this.previewDiv = undefined;\n        this.previewRightDiagonalDiv = undefined;\n        this.previewLeftDiagonalDiv = undefined;\n        this.previewVerticalDiv = undefined;\n        this.previewHorizontalDiv = undefined;\n        this.previewDivTopTopContainer = undefined;\n        this.previewDivTopTop = undefined;\n        this.previewDivTopCenterContainer = undefined;\n        this.previewDivTopCenter = undefined;\n        this.previewDivTopBottomContainer = undefined;\n        this.previewDivTopBottom = undefined;\n        this.previewDivLeftDiagonalContainer = undefined;\n        this.previewDivLeftDiagonal = undefined;\n        this.previewDivBottomLeftContainer = undefined;\n        this.previewDivBottomLeft = undefined;\n        this.previewDivBottomcenterContainer = undefined;\n        this.previewDivBottomcenter = undefined;\n        this.previewDivBottomRightContainer = undefined;\n        this.previewDivBottomRight = undefined;\n        this.previewDivDiagonalRightContainer = undefined;\n        this.previewDivDiagonalRight = undefined;\n        this.previewDivTopTopTransParent = undefined;\n        this.previewDivTopCenterTransParent = undefined;\n        this.previewDivTopBottomTransParent = undefined;\n        this.previewDivLeftDiagonalTransParent = undefined;\n        this.previewDivBottomLeftTransparent = undefined;\n        this.previewDivBottomcenterTransparent = undefined;\n        this.previewDivBottomRightTransparent = undefined;\n        this.previewDivDiagonalRightTransparent = undefined;\n        this.shadingContiner = undefined;\n        this.noneDiv = undefined;\n        this.customDiv = undefined;\n        this.allDiv = undefined;\n        this.boxDiv = undefined;\n    };\n    return BordersAndShadingDialog;\n}());\nexport { BordersAndShadingDialog };\n","import { createElement, isNullOrUndefined, L10n } from '@syncfusion/ej2-base';\nimport { Tab } from '@syncfusion/ej2-navigations';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\nimport { WListFormat } from '../../implementation/format/list-format';\n/**\n * The Bullets and Numbering dialog is used to apply list format for a paragraph style.\n */\n/* tslint:disable:no-any */\nvar BulletsAndNumberingDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function BulletsAndNumberingDialog(layoutViewer) {\n        var _this = this;\n        this.isBullet = false;\n        /**\n         * @private\n         */\n        this.numberListClick = function (args) {\n            _this.isBullet = false;\n            _this.setActiveElement(args);\n            if (args.currentTarget.classList.contains('e-de-list-numbered-none')) {\n                _this.numberFormat = undefined;\n                _this.listLevelPattern = undefined;\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-number-dot')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'Arabic';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-number-brace')) {\n                _this.numberFormat = '%1)';\n                _this.listLevelPattern = 'Arabic';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-up-roman')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'UpRoman';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-up-letter')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'UpLetter';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-low-letter-brace')) {\n                _this.numberFormat = '%1)';\n                _this.listLevelPattern = 'LowLetter';\n            }\n            else if (args.currentTarget.classList.contains('e-de-numbered-low-letter-dot')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'LowLetter';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-low-roman')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'LowRoman';\n            }\n        };\n        /**\n         * @private\n         */\n        this.bulletListClick = function (args) {\n            _this.isBullet = true;\n            _this.setActiveElement(args);\n            if (args.currentTarget.classList.contains('e-bullet-none')) {\n                _this.symbol = undefined;\n                _this.fontFamily = undefined;\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-dot')) {\n                _this.symbol = '\\uf0b7';\n                _this.fontFamily = 'Symbol';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-circle')) {\n                _this.symbol = '\\uf06f' + '\\u0020';\n                _this.fontFamily = 'Symbol';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-square')) {\n                _this.symbol = '\\uf0a7';\n                _this.fontFamily = 'Wingdings';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-flower')) {\n                _this.symbol = '\\uf076';\n                _this.fontFamily = 'Wingdings';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-arrow')) {\n                _this.symbol = '\\uf0d8';\n                _this.fontFamily = 'Wingdings';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-tick')) {\n                _this.symbol = '\\uf0fc';\n                _this.fontFamily = 'Wingdings';\n            }\n        };\n        /**\n         * @private\n         */\n        this.loadNumberingBulletDialog = function () {\n            //Load \n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.closeNumberingBulletDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.isBullet = false;\n            _this.listLevelPattern = undefined;\n            _this.numberFormat = undefined;\n            _this.symbol = undefined;\n            _this.fontFamily = undefined;\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /**\n         * @private\n         */\n        this.onOkButtonClick = function () {\n            if (_this.owner.owner.viewer.lists.length > 0) {\n                _this.listFormat.list.listId = _this.owner.owner.viewer.lists[_this.owner.owner.viewer.lists.length - 1].listId + 1;\n                _this.listFormat.listId = _this.listFormat.list.listId;\n            }\n            else {\n                _this.listFormat.list.listId = 0;\n                _this.listFormat.listId = 0;\n            }\n            if (_this.owner.owner.viewer.abstractLists.length > 0) {\n                /* tslint:disable-next-line:max-line-length */\n                _this.abstractList.abstractListId = _this.owner.owner.viewer.abstractLists[_this.owner.owner.viewer.abstractLists.length - 1].abstractListId + 1;\n            }\n            else {\n                _this.abstractList.abstractListId = 0;\n            }\n            _this.listFormat.list.abstractListId = _this.abstractList.abstractListId;\n            var listLevel = new WListLevel(_this.abstractList);\n            listLevel.listLevelPattern = !isNullOrUndefined(_this.listLevelPattern) ? _this.listLevelPattern : 'Bullet';\n            listLevel.numberFormat = _this.isBullet ? _this.symbol : _this.numberFormat;\n            if (listLevel.listLevelPattern !== 'Bullet') {\n                listLevel.startAt = 1;\n            }\n            listLevel.characterFormat.fontFamily = !isNullOrUndefined(_this.fontFamily) ? _this.fontFamily : 'Verdana';\n            listLevel.paragraphFormat.leftIndent = 36;\n            listLevel.paragraphFormat.firstLineIndent = -18;\n            _this.abstractList.levels.push(listLevel);\n            _this.listFormat.listLevelNumber = 0;\n            _this.listFormat.list.abstractList = _this.abstractList;\n            _this.owner.dialog.hide();\n        };\n        this.owner = layoutViewer;\n    }\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.getModuleName = function () {\n        return 'BulletsAndNumberingDialog';\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.initNumberingBulletDialog = function (locale) {\n        var instance = this;\n        var id = this.owner.owner.containerId;\n        this.target = createElement('div', { id: id + '_insertNumberBulletDialog', className: 'e-de-number-bullet-dlg' });\n        var tabTarget = createElement('div', { id: id + '_tabNumberBulletDialog', className: 'e-de-tab-number-bullet-dlg' });\n        this.target.appendChild(tabTarget);\n        this.createNumberList(id);\n        this.createBulletList(id);\n        //Initialize Tab component\n        var tabObj = new Tab({\n            items: [\n                {\n                    header: { 'text': locale.getConstant('Numbering') },\n                    /* tslint:disable-next-line:max-line-length */\n                    content: ('#' + id + '_Number'),\n                },\n                {\n                    header: { 'text': locale.getConstant('Bullets') },\n                    /* tslint:disable-next-line:max-line-length */\n                    content: ('#' + id + '_Bullet'),\n                },\n            ],\n            heightAdjustMode: 'None',\n            width: 272,\n        });\n        //Render initialized Tab component\n        tabObj.appendTo(tabTarget);\n        tabObj.refresh();\n    };\n    BulletsAndNumberingDialog.prototype.createNumberList = function (id) {\n        var numberListDiv = createElement('div', { className: 'e-de-style-numbered-list', id: id + '_Number' });\n        numberListDiv.style.display = 'none';\n        numberListDiv.style.height = '270px';\n        var ulTag = createElement('ul', {\n            styles: 'display: block; outline: 0px;',\n            id: 'listMenu',\n            className: 'e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail'\n        });\n        numberListDiv.appendChild(ulTag);\n        var numberedNone = this.createNumberNoneListTag(ulTag);\n        var numberedNumberDot = this.createNumberListTag(ulTag, '1.', '2.', '3.', 'e-de-list-numbered-number-dot');\n        var numberedNumberBrace = this.createNumberListTag(ulTag, '1)', '2)', '3)', 'e-de-list-numbered-number-brace');\n        var numberedUpRoman = this.createNumberListTag(ulTag, 'I.', 'II.', 'III.', 'e-de-list-numbered-up-roman');\n        var numberedUpLettter = this.createNumberListTag(ulTag, 'A.', 'B.', 'C.', 'e-de-list-numbered-up-letter');\n        var numberedLowLetterDot = this.createNumberListTag(ulTag, 'a.', 'b.', 'c.', 'e-de-numbered-low-letter-dot');\n        var numberedLowLetterBrace = this.createNumberListTag(ulTag, 'a)', 'b)', 'c)', 'e-de-list-numbered-low-letter-brace');\n        var numberedLowRoman = this.createNumberListTag(ulTag, 'i.', 'ii.', 'iii.', 'e-de-list-numbered-low-roman');\n        numberedNone.addEventListener('click', this.numberListClick);\n        numberedNumberDot.addEventListener('click', this.numberListClick);\n        numberedNumberBrace.addEventListener('click', this.numberListClick);\n        numberedUpRoman.addEventListener('click', this.numberListClick);\n        numberedUpLettter.addEventListener('click', this.numberListClick);\n        numberedLowLetterBrace.addEventListener('click', this.numberListClick);\n        numberedLowLetterDot.addEventListener('click', this.numberListClick);\n        numberedLowRoman.addEventListener('click', this.numberListClick);\n        this.target.appendChild(numberListDiv);\n    };\n    BulletsAndNumberingDialog.prototype.createNumberListTag = function (ulTag, text1, text2, text3, className) {\n        var liTag = createElement('li', {\n            styles: 'display:block',\n            className: 'e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size ' + className\n        });\n        ulTag.appendChild(liTag);\n        /* tslint:disable-next-line:max-line-length */\n        var innerHTML = '<div>' + text1 + '<span class=\"e-de-ui-list-line\"></span></div><div>' + text2 + '<span class=\"e-de-ui-list-line\">';\n        innerHTML += '</span></div><div>' + text3 + '<span class=\"e-de-ui-list-line\"> </span></div >';\n        var liInnerDiv = createElement('div', {\n            className: 'e-de-ui-list-header-presetmenu',\n            id: 'e-de-ui-zlist0', innerHTML: innerHTML\n        });\n        liTag.style.cssFloat = 'left';\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    BulletsAndNumberingDialog.prototype.createNumberNoneListTag = function (ulTag) {\n        var liTag = createElement('li', {\n            styles: 'display:block',\n            /* tslint:disable-next-line:max-line-length */\n            className: 'e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size e-de-list-numbered-none'\n        });\n        ulTag.appendChild(liTag);\n        var innerHTML = '<div class=\"e-de-ui-bullets e-de-bullet-icons\">None</div>';\n        var liInnerDiv = createElement('div', {\n            className: 'e-de-ui-list-header-presetmenu',\n            id: 'e-de-ui-zlist0', innerHTML: innerHTML\n        });\n        liTag.style.cssFloat = 'left';\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    BulletsAndNumberingDialog.prototype.createBulletListTag = function (ulTag, iconCss, className) {\n        var liTag = createElement('li', {\n            styles: 'display:block;',\n            className: 'e-de-ui-wfloating-menuitem e-de-ui-wfloating-bullet-menuitem-md e-de-list-items  e-de-list-item-size ' + className\n        });\n        ulTag.appendChild(liTag);\n        /* tslint:disable-next-line:max-line-length */\n        var liInnerDiv = createElement('div', { className: 'e-de-ui-bullet-list-header-presetmenu e-de-bullet-icon-size', id: 'e-de-ui-zlist0' });\n        var liNextDiv = createElement('div', { className: iconCss });\n        liInnerDiv.appendChild(liNextDiv);\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    BulletsAndNumberingDialog.prototype.createBulletList = function (id) {\n        var bulletListDiv = createElement('div', { className: 'e-de-ui-bullet-list-header-presetmenu', id: id + '_Bullet' });\n        bulletListDiv.style.display = 'none';\n        bulletListDiv.style.height = '270px';\n        var ulTag = createElement('ul', {\n            styles: 'display: block; outline: 0px;', id: 'listMenu',\n            className: 'e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail'\n        });\n        bulletListDiv.appendChild(ulTag);\n        var bulletNone = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-none e-de-bullet-icons', 'e-bullet-none');\n        var bulletDot = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-dot e-de-bullet-icons', 'e-bullet-dot');\n        /* tslint:disable-next-line:max-line-length */\n        var bulletCircle = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-circle e-de-bullet-icons', 'e-bullet-circle');\n        var bulletSquare = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-square e-de-bullet-icons', 'e-bullet-square');\n        /* tslint:disable-next-line:max-line-length */\n        var bulletFlower = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-flower e-de-bullet-icons', 'e-bullet-flower');\n        var bulletArrow = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-arrow e-de-bullet-icons', 'e-bullet-arrow');\n        var bulletTick = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-tick e-de-bullet-icons', 'e-bullet-tick');\n        bulletNone.addEventListener('click', this.bulletListClick);\n        bulletDot.addEventListener('click', this.bulletListClick);\n        bulletCircle.addEventListener('click', this.bulletListClick);\n        bulletSquare.addEventListener('click', this.bulletListClick);\n        bulletFlower.addEventListener('click', this.bulletListClick);\n        bulletArrow.addEventListener('click', this.bulletListClick);\n        bulletTick.addEventListener('click', this.bulletListClick);\n        // bulletListDiv.appendChild(table1);        \n        this.target.appendChild(bulletListDiv);\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.showNumberBulletDialog = function (listFormat, abstractList) {\n        if (!isNullOrUndefined(listFormat)) {\n            this.listFormat = listFormat;\n        }\n        else {\n            this.listFormat = new WListFormat();\n        }\n        if (isNullOrUndefined(this.listFormat.list)) {\n            this.listFormat.list = new WList();\n        }\n        if (!isNullOrUndefined(abstractList)) {\n            this.abstractList = abstractList;\n        }\n        else {\n            this.abstractList = new WAbstractList();\n        }\n        var locale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        locale.setLocale(this.owner.owner.locale);\n        if (!this.target) {\n            this.initNumberingBulletDialog(locale);\n        }\n        this.owner.dialog.header = locale.getConstant('Numbering and Bullets');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadNumberingBulletDialog;\n        this.owner.dialog.close = this.closeNumberingBulletDialog;\n        this.owner.dialog.position = { X: 'center', Y: 'center' };\n        this.owner.dialog.buttons = [{\n                click: this.onOkButtonClick,\n                buttonModel: { content: locale.getConstant('Ok'), cssClass: 'e-flat e-numbering-bullet-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: locale.getConstant('Cancel'), cssClass: 'e-flat e-numbering-bullet-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    BulletsAndNumberingDialog.prototype.setActiveElement = function (args) {\n        var html = args.currentTarget.parentElement;\n        for (var i = 0; i < html.childElementCount; i++) {\n            if (html.childNodes[i].classList.contains('e-de-list-active')) {\n                html.childNodes[i].classList.remove('e-de-list-active');\n            }\n        }\n        args.currentTarget.classList.add('e-de-list-active');\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.unWireEventsAndBindings = function () {\n        //Unwire events\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.destroy = function () {\n        this.owner = undefined;\n        if (this.listFormat) {\n            this.listFormat.destroy();\n            this.listFormat = undefined;\n        }\n        if (this.abstractList) {\n            this.abstractList.destroy();\n            this.abstractList = undefined;\n        }\n        if (this.target && this.target.parentElement) {\n            this.target.parentElement.removeChild(this.target);\n            for (var m = 0; m < this.target.childNodes.length; m++) {\n                this.target.removeChild(this.target.childNodes[m]);\n                m--;\n            }\n            this.target = undefined;\n        }\n    };\n    return BulletsAndNumberingDialog;\n}());\nexport { BulletsAndNumberingDialog };\n/* tslint:enable:no-any */ \n","import { CheckBox } from '@syncfusion/ej2-buttons';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WCellFormat } from '../index';\nimport { isNullOrUndefined, L10n, createElement } from '@syncfusion/ej2-base';\n/**\n * The Cell options dialog is used to modify margins of selected cells.\n */\nvar CellOptionsDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function CellOptionsDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.removeEvents = function () {\n            _this.owner.dialog2.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.changeSameAsTable = function () {\n            if (_this.sameAsTableCheckBox.checked) {\n                _this.leftMarginBox.enabled = false;\n                _this.rightMarginBox.enabled = false;\n                _this.bottomMarginBox.enabled = false;\n                _this.topMarginBox.enabled = false;\n            }\n            else {\n                _this.leftMarginBox.enabled = true;\n                _this.rightMarginBox.enabled = true;\n                _this.bottomMarginBox.enabled = true;\n                _this.topMarginBox.enabled = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyTableCellProperties = function () {\n            var cellFormat = _this.owner.selection.cellFormat;\n            if (!isNullOrUndefined(_this.bottomMarginBox.value || _this.leftMarginBox.value\n                || _this.rightMarginBox.value || _this.topMarginBox.value) &&\n                (cellFormat.bottomMargin !== _this.bottomMarginBox.value || cellFormat.leftMargin !== _this.leftMarginBox.value\n                    || cellFormat.rightMargin !== _this.rightMarginBox.value || cellFormat.topMargin !== _this.topMarginBox.value)) {\n                _this.owner.owner.tablePropertiesDialogModule.isCellOptionsUpdated = true;\n                _this.applyTableOptions(_this.cellFormat);\n                _this.owner.owner.tablePropertiesDialogModule.applyTableSubProperties();\n            }\n            _this.closeCellMarginsDialog();\n        };\n        /**\n         * @private\n         */\n        this.closeCellMarginsDialog = function () {\n            _this.owner.dialog.hide();\n            _this.owner.dialog.element.style.pointerEvents = '';\n        };\n        this.owner = viewer;\n    }\n    Object.defineProperty(CellOptionsDialog.prototype, \"cellFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.cellFormatIn)) {\n                return this.cellFormatIn = new WCellFormat();\n            }\n            return this.cellFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.getModuleName = function () {\n        return 'CellOptionsDialog';\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.initCellMarginsDialog = function (localValue, isRtl) {\n        var instance = this.owner;\n        this.target = createElement('div', {\n            id: this.owner.owner.containerId + '_tableCellMarginsDialog', className: 'e-de-table-cell-margin-dlg'\n        });\n        var innerDiv = createElement('div', { styles: 'width: 475px;position: relative;height: 165px;' });\n        var innerDivLabel = createElement('Label', {\n            className: 'e-de-cell-dia-options-label', id: this.target.id + '_innerDivLabel'\n        });\n        innerDivLabel.innerHTML = localValue.getConstant('Cell margins');\n        innerDiv.appendChild(innerDivLabel);\n        var table = createElement('TABLE', {\n            styles: 'height: 40px;padding-bottom: 0px;', className: 'e-de-cell-margin-top'\n        });\n        var tr = createElement('tr');\n        var td = createElement('td', { className: 'e-de-tbl-btn-seperator' });\n        var sameAsTableCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_sameAsCheckBox'\n        });\n        td.appendChild(sameAsTableCheckBox);\n        tr.appendChild(td);\n        table.appendChild(tr);\n        innerDiv.appendChild(table);\n        CellOptionsDialog.getCellMarginDialogElements(this, innerDiv, localValue);\n        var divBtn = document.createElement('div');\n        this.target.appendChild(divBtn);\n        this.sameAsTableCheckBox = new CheckBox({\n            label: localValue.getConstant('Same as the whole table'),\n            change: this.changeSameAsTable,\n            enableRtl: isRtl\n        });\n        this.sameAsTableCheckBox.appendTo(sameAsTableCheckBox);\n        this.sameAsTableCheckBox.addEventListener('change', this.changeSameAsTable);\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.show = function () {\n        var localizeValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localizeValue.setLocale(this.owner.owner.locale);\n        if (!this.target) {\n            this.initCellMarginsDialog(localizeValue, this.owner.owner.enableRtl);\n        }\n        this.loadCellMarginsDialog();\n        this.owner.dialog.header = localizeValue.getConstant('Cell Options');\n        this.owner.dialog.position = { X: 'center', Y: 'top' };\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = undefined;\n        this.owner.dialog.open = undefined;\n        this.owner.dialog.close = this.removeEvents;\n        this.owner.dialog.buttons = [{\n                click: this.applyTableCellProperties,\n                buttonModel: { content: localizeValue.getConstant('Ok'), cssClass: 'e-flat e-table-cell-margin-okay', isPrimary: true }\n            },\n            {\n                click: this.closeCellMarginsDialog,\n                buttonModel: { content: localizeValue.getConstant('Cancel'), cssClass: 'e-flat e-table-cell-margin-cancel' }\n            }];\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.loadCellMarginsDialog = function () {\n        var cellFormat = this.owner.selection.cellFormat;\n        this.sameAsTable = isNullOrUndefined(cellFormat.leftMargin || cellFormat.topMargin\n            || cellFormat.rightMargin || cellFormat.bottomMargin);\n        if (this.sameAsTable) {\n            var tableFormat = this.owner.selection.tableFormat;\n            this.loadCellProperties(tableFormat, false, true);\n        }\n        else {\n            this.loadCellProperties(cellFormat, true, false);\n        }\n    };\n    CellOptionsDialog.prototype.loadCellProperties = function (format, enableTextBox, enableCheckBox) {\n        this.leftMarginBox.value = format.leftMargin;\n        this.rightMarginBox.value = format.rightMargin;\n        this.topMarginBox.value = format.topMargin;\n        this.bottomMarginBox.value = format.bottomMargin;\n        this.leftMarginBox.enabled = enableTextBox;\n        this.rightMarginBox.enabled = enableTextBox;\n        this.topMarginBox.enabled = enableTextBox;\n        this.bottomMarginBox.enabled = enableTextBox;\n        this.sameAsTableCheckBox.checked = enableCheckBox;\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applySubCellOptions = function (cellFormat) {\n        this.owner.owner.editorHistory.initComplexHistory(this.owner.selection, 'CellMarginsSelection');\n        this.owner.owner.editorModule.initHistory('CellOptions');\n        /* tslint:disable:max-line-length */\n        var startTable = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n        startTable = startTable.combineWidget(this.owner);\n        this.applyCellmarginsValue(this.owner.selection.start.paragraph.associatedCell.ownerRow.combineWidget(this.owner), this.owner.selection.start, this.owner.selection.end, cellFormat);\n        this.owner.owner.editorModule.reLayout(this.owner.selection, false);\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.owner.editorHistory.updateComplexHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applyCellmarginsValue = function (row, start, end, cellFormat) {\n        this.applyCellMarginsInternal(row, cellFormat);\n        if (end.paragraph.associatedCell.ownerRow === row) {\n            return;\n        }\n        var newRow = row.nextWidget;\n        if (!isNullOrUndefined(newRow)) {\n            this.applyCellmarginsValue(newRow, start, end, cellFormat);\n        }\n    };\n    CellOptionsDialog.prototype.applyCellMarginsInternal = function (row, cellFormat) {\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentBaseHistoryInfo)) {\n            var currentFormat = row.childWidgets[0].cellFormat;\n            /* tslint:disable:max-line-length */\n            cellFormat = this.owner.owner.editorHistory.currentBaseHistoryInfo.addModifiedCellOptions(currentFormat, cellFormat, row.ownerTable);\n        }\n        if (!isNullOrUndefined(cellFormat)) {\n            this.applyCellMarginsForCells(row, cellFormat);\n        }\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applyCellMarginsForCells = function (row, cellFormat) {\n        var rowCells = row.childWidgets;\n        this.iterateCells(rowCells, cellFormat);\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.iterateCells = function (cells, cellFormat) {\n        for (var i = 0; i < cells.length; i++) {\n            this.applySubCellMargins(cells[i].cellFormat, cellFormat);\n        }\n        this.owner.owner.tablePropertiesDialogModule.calculateGridValue(cells[0].ownerTable);\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applySubCellMargins = function (sourceFormat, cellFormat) {\n        sourceFormat.leftMargin = cellFormat.leftMargin;\n        sourceFormat.topMargin = cellFormat.topMargin;\n        sourceFormat.rightMargin = cellFormat.rightMargin;\n        sourceFormat.bottomMargin = cellFormat.bottomMargin;\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applyTableOptions = function (cellFormat) {\n        if (!this.sameAsTableCheckBox.checked) {\n            cellFormat.leftMargin = this.leftMarginBox.value;\n            cellFormat.topMargin = this.topMarginBox.value;\n            cellFormat.bottomMargin = this.bottomMarginBox.value;\n            cellFormat.rightMargin = this.rightMarginBox.value;\n        }\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var y = 0; y < this.target.childNodes.length; y++) {\n                this.target.removeChild(this.target.childNodes[y]);\n                y--;\n            }\n            this.target = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        this.owner = undefined;\n        this.sameAsTableCheckBox = undefined;\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.getCellMarginDialogElements = function (dialog, div, locale) {\n        if (!isNullOrUndefined(dialog)) {\n            var table = createElement('TABLE', { className: 'e-de-cell-margin-top' });\n            var tr1 = createElement('tr', { styles: 'height: 50px;' });\n            var td1 = createElement('td');\n            var topLabel = createElement('label', {\n                innerHTML: locale.getConstant('Top'), className: 'e-de-cell-dia-label-common',\n                id: dialog.target.id + '_TopLabel'\n            });\n            var topTextBox = createElement('input', {\n                attrs: { 'type': 'text' }, styles: 'width:100%', id: dialog.target.id + '_Top'\n            });\n            td1.appendChild(topLabel);\n            td1.appendChild(topTextBox);\n            var td2 = createElement('td', { className: 'e-de-tbl-btn-seperator' });\n            var leftLabel = createElement('label', {\n                innerHTML: locale.getConstant('Left'), className: 'e-de-cell-dia-label-common',\n                id: dialog.target.id + '_leftLabel'\n            });\n            var leftTextBox = createElement('input', {\n                attrs: { 'type': 'text' },\n                styles: 'width:100%', id: dialog.target.id + '_left'\n            });\n            td2.appendChild(leftLabel);\n            td2.appendChild(leftTextBox);\n            tr1.appendChild(td1);\n            tr1.appendChild(td2);\n            var tr2 = createElement('tr', { styles: 'height: 50px;' });\n            var td3 = createElement('td', { styles: 'width:40%;' });\n            var bottomLabel = createElement('label', {\n                innerHTML: locale.getConstant('Bottom'),\n                className: 'e-de-cell-dia-label-common', id: dialog.target.id + '_bottomLabel'\n            });\n            var bottomTextBox = createElement('input', {\n                attrs: { 'type': 'text' },\n                styles: 'width:100%', id: dialog.target.id + '_bottom'\n            });\n            td3.appendChild(bottomLabel);\n            td3.appendChild(bottomTextBox);\n            var td4 = createElement('td', { styles: 'width:40%;' });\n            var rightLabel = createElement('label', {\n                innerHTML: locale.getConstant('Right'), id: dialog.target.id + '_rightLabel',\n                className: 'e-de-cell-dia-label-common'\n            });\n            var rightTextBox = createElement('input', {\n                attrs: { 'type': 'text' },\n                styles: 'width:100%', id: dialog.target.id + '_right'\n            });\n            td4.appendChild(rightLabel);\n            td4.appendChild(rightTextBox);\n            tr2.appendChild(td3);\n            tr2.appendChild(td4);\n            table.appendChild(tr1);\n            table.appendChild(tr2);\n            div.appendChild(table);\n            dialog.target.appendChild(div);\n            dialog.topMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150, decimals: 2,\n                enablePersistence: false\n            });\n            dialog.topMarginBox.appendTo(topTextBox);\n            dialog.leftMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150,\n                decimals: 2, enablePersistence: false\n            });\n            dialog.leftMarginBox.appendTo(leftTextBox);\n            dialog.bottomMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150, decimals: 2,\n                enablePersistence: false\n            });\n            dialog.bottomMarginBox.appendTo(bottomTextBox);\n            dialog.rightMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150,\n                decimals: 2, enablePersistence: false\n            });\n            dialog.rightMarginBox.appendTo(rightTextBox);\n        }\n    };\n    return CellOptionsDialog;\n}());\nexport { CellOptionsDialog };\n","import { createElement, isNullOrUndefined, L10n } from '@syncfusion/ej2-base';\nimport { DropDownList, ComboBox } from '@syncfusion/ej2-dropdowns';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { WCharacterFormat } from '../format/character-format';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\n/**\n * The Font dialog is used to modify formatting of selected text.\n */\n/* tslint:disable:no-any */\nvar FontDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function FontDialog(layoutViewer) {\n        var _this = this;\n        this.fontStyleInternal = undefined;\n        this.fontNameList = undefined;\n        this.fontStyleText = undefined;\n        this.fontSizeText = undefined;\n        this.colorPicker = undefined;\n        this.underlineDrop = undefined;\n        this.strikethroughBox = undefined;\n        this.doublestrikethrough = undefined;\n        this.superscript = undefined;\n        this.subscript = undefined;\n        //Character Format Property\n        this.bold = undefined;\n        this.italic = undefined;\n        this.underline = undefined;\n        this.strikethrough = undefined;\n        this.baselineAlignment = undefined;\n        this.fontSize = undefined;\n        this.fontFamily = undefined;\n        this.fontColor = undefined;\n        /**\n         * @private\n         */\n        this.characterFormat = undefined;\n        /**\n         * @private\n         */\n        this.loadFontDialog = function () {\n            _this.owner.updateFocus();\n            var characterFormat;\n            if (_this.characterFormat) {\n                characterFormat = _this.characterFormat;\n            }\n            else {\n                characterFormat = _this.owner.owner.selection.characterFormat;\n            }\n            _this.fontNameList.value = characterFormat.fontFamily;\n            if (!characterFormat.bold && !characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 0;\n            }\n            else if (characterFormat.bold && !characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 1;\n            }\n            else if (!characterFormat.bold && characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 2;\n            }\n            else if (characterFormat.bold && characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 3;\n            }\n            if (!isNullOrUndefined(characterFormat.fontSize)) {\n                for (var i = 0; i <= 15; i++) {\n                    var items = _this.fontSizeText.getItems();\n                    if (characterFormat.fontSize.toString() === items[i].innerHTML) {\n                        _this.fontSizeText.value = characterFormat.fontSize;\n                        _this.fontSizeText.index = i;\n                        break;\n                    }\n                }\n            }\n            if (!isNullOrUndefined(characterFormat.fontColor)) {\n                _this.colorPicker.value = characterFormat.fontColor;\n            }\n            else {\n                _this.colorPicker.value = '#000000';\n            }\n            if (characterFormat.underline === 'None') {\n                _this.underlineDrop.index = 0;\n            }\n            else if (characterFormat.underline === 'Single') {\n                _this.underlineDrop.index = 1;\n            }\n            if (characterFormat.strikethrough === 'SingleStrike') {\n                _this.strikethroughBox.checked = true;\n            }\n            else if (characterFormat.strikethrough === 'DoubleStrike') {\n                _this.doublestrikethrough.checked = true;\n            }\n            else {\n                _this.strikethroughBox.checked = false;\n                _this.doublestrikethrough.checked = false;\n            }\n            if (characterFormat.baselineAlignment === 'Superscript') {\n                _this.superscript.checked = true;\n            }\n            else if (characterFormat.baselineAlignment === 'Subscript') {\n                _this.subscript.checked = true;\n            }\n            else {\n                _this.superscript.checked = false;\n                _this.subscript.checked = false;\n            }\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        /**\n         * @private\n         */\n        this.closeFontDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /**\n         * @private\n         */\n        this.onInsertFontFormat = function () {\n            var format;\n            if (_this.characterFormat) {\n                format = _this.characterFormat;\n            }\n            else {\n                format = new WCharacterFormat(undefined);\n            }\n            if (!isNullOrUndefined(_this.bold)) {\n                format.bold = _this.bold;\n            }\n            if (!isNullOrUndefined(_this.italic)) {\n                format.italic = _this.italic;\n            }\n            if (!isNullOrUndefined(_this.fontSize) && _this.fontSize > 0) {\n                format.fontSize = _this.fontSize;\n            }\n            if (!isNullOrUndefined(_this.fontColor)) {\n                format.fontColor = _this.fontColor;\n            }\n            if (!isNullOrUndefined(_this.baselineAlignment)) {\n                format.baselineAlignment = _this.baselineAlignment;\n            }\n            if (!isNullOrUndefined(_this.strikethrough)) {\n                format.strikethrough = _this.strikethrough;\n            }\n            if (!isNullOrUndefined(_this.underline)) {\n                format.underline = _this.underline;\n            }\n            if (!isNullOrUndefined(_this.fontFamily)) {\n                format.fontFamily = _this.fontFamily;\n            }\n            if (!_this.characterFormat) {\n                _this.onCharacterFormat(_this.owner.selection, format);\n            }\n            else {\n                _this.owner.owner.styleDialogModule.updateCharacterFormat();\n            }\n            _this.owner.dialog.hide();\n        };\n        this.fontSizeUpdate = function (args) {\n            _this.fontSize = args.value;\n        };\n        this.fontStyleUpdate = function (args) {\n            _this.fontStyle = args.value;\n        };\n        this.fontFamilyUpdate = function (args) {\n            _this.fontFamily = args.value;\n        };\n        this.underlineUpdate = function (args) {\n            _this.underline = args.value;\n        };\n        this.fontColorUpdate = function (args) {\n            if (!isNullOrUndefined(args.currentValue)) {\n                _this.fontColor = args.currentValue.hex;\n            }\n        };\n        this.singleStrikeUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.strikethrough = 'SingleStrike';\n            }\n            else {\n                _this.strikethrough = 'None';\n            }\n        };\n        this.doubleStrikeUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.strikethrough = 'DoubleStrike';\n            }\n            else {\n                _this.strikethrough = 'None';\n            }\n        };\n        this.superscriptUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.baselineAlignment = 'Superscript';\n            }\n            else {\n                _this.baselineAlignment = 'Normal';\n            }\n        };\n        this.subscriptUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.baselineAlignment = 'Subscript';\n            }\n            else {\n                _this.baselineAlignment = 'Normal';\n            }\n        };\n        this.owner = layoutViewer;\n    }\n    Object.defineProperty(FontDialog.prototype, \"fontStyle\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.fontStyleInternal;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.fontStyleInternal = value;\n            switch (this.fontStyle) {\n                case 'Bold':\n                    this.bold = true;\n                    this.italic = false;\n                    break;\n                case 'Italic':\n                    this.bold = false;\n                    this.italic = true;\n                    break;\n                case 'BoldItalic':\n                    this.bold = true;\n                    this.italic = true;\n                    break;\n                case 'Regular':\n                    this.bold = false;\n                    this.italic = false;\n                    break;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    FontDialog.prototype.getModuleName = function () {\n        return 'FontDialog';\n    };\n    FontDialog.prototype.createInputElement = function (type, id, className) {\n        var element = createElement('input', {\n            attrs: { type: type },\n            id: id,\n            className: className\n        });\n        return element;\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.initFontDialog = function (locale, isRtl) {\n        var instance = this;\n        var effectLabel;\n        var strikeThroughElement;\n        var superScriptElement;\n        var subScriptElement;\n        var doubleStrikeThroughElement;\n        var id = this.owner.owner.containerId;\n        this.target = createElement('div', { id: id + '_insertFontDialog', className: 'e-de-font-dlg' });\n        var fontDiv = this.getFontDiv(locale, isRtl);\n        this.target.appendChild(fontDiv);\n        var sizeDiv = this.getFontSizeDiv(locale, isRtl);\n        this.target.appendChild(sizeDiv);\n        var colorDiv = createElement('div', { id: id + '_fontColor', styles: 'margin-top:15px;' });\n        this.fontColorDiv = createElement('div', { id: id + '_fontColorDiv', className: 'e-de-font-dlg-display' });\n        var fontColorLabel = createElement('label', {\n            className: 'e-de-font-dlg-header-font-color e-de-font-color-margin',\n            innerHTML: locale.getConstant('Font color'), styles: 'width:63px'\n        });\n        if (isRtl) {\n            fontColorLabel.classList.add('e-de-rtl');\n        }\n        this.fontColorDiv.appendChild(fontColorLabel);\n        var fontColorElement = this.createInputElement('color', this.target.id + '_ColorDiv', 'e-de-font-dlg-color');\n        this.fontColorDiv.appendChild(fontColorElement);\n        colorDiv.appendChild(this.fontColorDiv);\n        this.target.appendChild(colorDiv);\n        var fontEffectsDiv = createElement('div', { id: id + '_fontEffectsDiv' });\n        var fontEffectSubDiv1 = createElement('div', {\n            className: 'e-de-font-color-label e-de-font-dlg-display',\n            id: this.target.id + '_fontEffectsSubDiv1'\n        });\n        effectLabel = createElement('label', {\n            className: 'e-de-font-dlg-header-effects',\n            innerHTML: locale.getConstant('Effects'), styles: 'width:58px'\n        });\n        fontEffectSubDiv1.appendChild(effectLabel);\n        strikeThroughElement = this.createInputElement('checkbox', this.target.id + '_strikeThrough', '');\n        fontEffectSubDiv1.appendChild(strikeThroughElement);\n        superScriptElement = this.createInputElement('checkbox', this.target.id + '_superScript', '');\n        fontEffectSubDiv1.appendChild(superScriptElement);\n        fontEffectsDiv.appendChild(fontEffectSubDiv1);\n        var fontEffectSubDiv2 = createElement('div', { className: 'e-de-font-checkbox', id: id + '_fontEffectsSubDiv2' });\n        subScriptElement = this.createInputElement('checkbox', this.target.id + '_subScript', '');\n        fontEffectSubDiv2.appendChild(subScriptElement);\n        doubleStrikeThroughElement = this.createInputElement('checkbox', this.target.id + '_doubleStrikeThrough', '');\n        fontEffectSubDiv2.appendChild(doubleStrikeThroughElement);\n        fontEffectsDiv.appendChild(fontEffectSubDiv2);\n        this.target.appendChild(fontEffectsDiv);\n        this.colorPicker = new ColorPicker({\n            change: this.fontColorUpdate, value: '#000000', enableRtl: isRtl, locale: this.owner.owner.locale\n        });\n        this.colorPicker.appendTo(fontColorElement);\n        this.strikethroughBox = new CheckBox({\n            change: this.singleStrikeUpdate,\n            cssClass: 'e-de-font-content-label',\n            label: locale.getConstant('Strikethrough'),\n            enableRtl: isRtl\n        });\n        this.strikethroughBox.appendTo(strikeThroughElement);\n        this.doublestrikethrough = new CheckBox({\n            change: this.doubleStrikeUpdate,\n            cssClass: 'e-de-font-content-checkbox-label',\n            label: locale.getConstant('Double strikethrough'),\n            enableRtl: isRtl\n        });\n        this.doublestrikethrough.appendTo(doubleStrikeThroughElement);\n        this.subscript = new CheckBox({\n            label: locale.getConstant('Subscript'),\n            cssClass: 'e-de-font-content-label-width',\n            change: this.subscriptUpdate,\n            enableRtl: isRtl\n        });\n        this.subscript.appendTo(subScriptElement);\n        this.superscript = new CheckBox({\n            label: locale.getConstant('Superscript'),\n            cssClass: 'e-de-font-content-label', change: this.superscriptUpdate,\n            enableRtl: isRtl\n        });\n        this.superscript.appendTo(superScriptElement);\n        if (isRtl) {\n            fontEffectSubDiv2.classList.add('e-de-rtl');\n            this.doublestrikethrough.cssClass = 'e-de-font-content-checkbox-label-rtl';\n        }\n    };\n    FontDialog.prototype.getFontSizeDiv = function (locale, isRtl) {\n        var fontSize;\n        var sizeDiv;\n        var id = this.owner.owner.containerId;\n        sizeDiv = createElement('div', { id: id + '_fontSizeAndUnderlineDiv', className: 'e-de-font-dlg-padding e-de-font-dlg-display' });\n        var sizeSubDiv1 = createElement('div', { id: id + '_fontSizeAndUnderlineSubDiv1' });\n        var sizeLabel = createElement('label', { className: 'e-de-font-dlg-header', innerHTML: locale.getConstant('Size') });\n        var styles = 'font-family:Roboto;font-size:14px;opacity:0.8;';\n        fontSize = createElement('select', { id: this.target.id + '_fontSize', styles: styles });\n        fontSize.innerHTML = '<option>8</option><option>9</option><option>10</option><option>11</option><option>12</option>' +\n            '<option>14</option><option>16</option><option>18</option><option>20</option><option>24</option><option>26</option>' +\n            '<option>28</option><option>36</option><option>48</option><option>72</option><option>96</option>';\n        sizeSubDiv1.appendChild(sizeLabel);\n        sizeSubDiv1.appendChild(fontSize);\n        sizeDiv.appendChild(sizeSubDiv1);\n        var sizeSubDiv2 = createElement('div', {\n            className: 'e-de-font-dlg-cb-right',\n            id: id + '_fontSizeAndUnderlineSubDiv2'\n        });\n        if (isRtl) {\n            sizeSubDiv2.classList.add('e-de-rtl');\n        }\n        var html = locale.getConstant('Underline style');\n        var underlineLabel = createElement('label', { className: 'e-de-font-dlg-header', innerHTML: html });\n        var underlineElement;\n        underlineElement = createElement('select', { id: this.target.id + '_underLine', styles: styles });\n        underlineElement.innerHTML = '<option>' + locale.getConstant('None') + '</option><option>________</option>';\n        sizeSubDiv2.appendChild(underlineLabel);\n        sizeSubDiv2.appendChild(underlineElement);\n        sizeDiv.appendChild(sizeSubDiv2);\n        this.fontSizeText = new ComboBox({ change: this.fontSizeUpdate, popupHeight: '170px', width: '170px', enableRtl: isRtl });\n        this.fontSizeText.showClearButton = false;\n        this.fontSizeText.appendTo(fontSize);\n        this.underlineDrop = new DropDownList({ change: this.underlineUpdate, popupHeight: '100px', width: '170px', enableRtl: isRtl });\n        this.underlineDrop.appendTo(underlineElement);\n        return sizeDiv;\n    };\n    FontDialog.prototype.getFontDiv = function (locale, isRtl) {\n        var id = this.owner.owner.containerId;\n        var fontDiv = createElement('div', { id: id + '_fontDiv', className: 'e-de-font-dlg-display' });\n        var fontSubDiv1 = createElement('div', { id: id + '_fontSubDiv1' });\n        var fontNameLabel = createElement('label', {\n            className: 'e-de-font-dlg-header',\n            innerHTML: locale.getConstant('Font')\n        });\n        var fontNameValues = createElement('select', { id: this.target.id + '_fontName' });\n        fontNameValues.innerHTML = '<option>Arial</option><option>Calibri</option><option>Candara</option><option>Comic Sans MS</option>' +\n            '<option>Consolas</option><option>Constantia</option><option>Corbel</option>' +\n            '<option>Courier New</option><option>Ebrima</option><option>Franklin Gothic</option>' +\n            '<option>Gabriola</option><option>Gadugi</option><option>Georgia</option><option>Impact</option>' +\n            '<option>Javanese Text</option><option>Microsoft Sans Serif</option><option>MS Gothic</option><option>MS UI Gothic</option>' +\n            '<option>Segoe Print</option><option>Times New Roman</option><option>Verdana</option><option>Segoe UI</option>' +\n            '<option>Algerian</option><option>Cambria</option><option>Georgia</option><option>Consolas</option>';\n        fontSubDiv1.appendChild(fontNameLabel);\n        fontSubDiv1.appendChild(fontNameValues);\n        fontDiv.appendChild(fontSubDiv1);\n        var fontSubDiv2;\n        var fontStyleLabel;\n        var fontStyleValues;\n        fontSubDiv2 = createElement('div', { className: 'e-de-font-dlg-cb-right', id: id + '_fontSubDiv2', styles: 'float:right;' });\n        if (isRtl) {\n            fontSubDiv2.classList.add('e-de-rtl');\n        }\n        fontStyleLabel = createElement('label', { className: 'e-de-font-dlg-header', innerHTML: locale.getConstant('Font style') });\n        var fontStyle = 'font-family:Roboto;font-size:14px;opacity:0.8;';\n        fontStyleValues = createElement('select', { id: this.target.id + '_fontStyle', styles: fontStyle });\n        fontStyleValues.innerHTML = '<option>' +\n            locale.getConstant('Regular') + '</option><option>' + locale.getConstant('Bold') + '</option><option>' +\n            locale.getConstant('Italic') + '</option><option>' + locale.getConstant('Bold') + locale.getConstant('Italic') + '</option>';\n        fontSubDiv2.appendChild(fontStyleLabel);\n        fontSubDiv2.appendChild(fontStyleValues);\n        fontDiv.appendChild(fontSubDiv2);\n        this.fontNameList = new ComboBox({ change: this.fontFamilyUpdate, popupHeight: '200px', width: '170px', enableRtl: isRtl });\n        this.fontNameList.showClearButton = false;\n        this.fontNameList.appendTo(fontNameValues);\n        this.fontStyleText = new DropDownList({ change: this.fontStyleUpdate, popupHeight: '170px', width: '170px', enableRtl: isRtl });\n        this.fontStyleText.appendTo(fontStyleValues);\n        return fontDiv;\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.showFontDialog = function (characterFormat) {\n        if (characterFormat) {\n            this.characterFormat = characterFormat;\n        }\n        var locale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        locale.setLocale(this.owner.owner.locale);\n        if (!this.target) {\n            this.initFontDialog(locale, this.owner.owner.enableRtl);\n        }\n        this.owner.dialog.header = locale.getConstant('Font');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadFontDialog;\n        this.owner.dialog.close = this.closeFontDialog;\n        this.owner.dialog.buttons = [{\n                click: this.onInsertFontFormat,\n                buttonModel: { content: locale.getConstant('Ok'), cssClass: 'e-flat e-font-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: locale.getConstant('Cancel'), cssClass: 'e-flat e-font-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * Applies character format\n     * @param  {Selection} selection\n     * @param  {WCharacterFormat} format\n     * @private\n     */\n    FontDialog.prototype.onCharacterFormat = function (selection, format) {\n        this.owner.owner.editorModule.initHistory('CharacterFormat');\n        if (selection.isEmpty) {\n            if (selection.start.offset === selection.getParagraphLength(selection.start.paragraph)) {\n                // tslint:disable-next-line:max-line-length\n                this.owner.owner.editorModule.applyCharFormatValueInternal(selection, selection.start.paragraph.characterFormat, undefined, format);\n                this.owner.owner.editorModule.reLayout(selection);\n            }\n            this.owner.updateFocus();\n            return;\n        }\n        else {\n            //Iterate and update formating.\n            this.owner.owner.editorModule.setOffsetValue(this.owner.selection);\n            this.owner.owner.editorModule.updateSelectionCharacterFormatting('CharacterFormat', format, false);\n        }\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.enableCheckBoxProperty = function (args) {\n        if (this.strikethroughBox.checked && this.doublestrikethrough.checked) {\n            this.strikethroughBox.checked = false;\n            this.doublestrikethrough.checked = false;\n            if (args.event.currentTarget.id === this.target.id + '_doubleStrikeThrough') {\n                this.doublestrikethrough.checked = true;\n            }\n            else {\n                this.strikethroughBox.checked = true;\n            }\n        }\n        if (this.superscript.checked && this.subscript.checked) {\n            this.subscript.checked = false;\n            this.superscript.checked = false;\n            if (args.event.currentTarget.id === this.target.id + '_subScript') {\n                this.subscript.checked = true;\n            }\n            else {\n                this.superscript.checked = true;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.unWireEventsAndBindings = function () {\n        this.fontNameList.value = '';\n        this.fontSizeText.value = '';\n        this.fontStyleText.value = '';\n        this.strikethroughBox.checked = false;\n        this.doublestrikethrough.checked = false;\n        this.superscript.checked = false;\n        this.subscript.checked = false;\n        this.bold = undefined;\n        this.italic = undefined;\n        this.underline = undefined;\n        this.strikethrough = undefined;\n        this.baselineAlignment = undefined;\n        this.fontColor = undefined;\n        this.fontSize = undefined;\n        this.fontFamily = undefined;\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.destroy = function () {\n        this.owner = undefined;\n        if (this.characterFormat) {\n            this.characterFormat.destroy();\n            this.characterFormat = undefined;\n        }\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var m = 0; m < this.target.childNodes.length; m++) {\n                this.target.removeChild(this.target.childNodes[m]);\n                m--;\n            }\n            this.target = undefined;\n        }\n        if (this.fontNameList) {\n            this.fontNameList.destroy();\n        }\n        this.fontNameList = undefined;\n        if (this.fontStyleText) {\n            this.fontStyleText.destroy();\n        }\n        this.fontStyleText = undefined;\n        if (this.fontSizeText) {\n            this.fontSizeText.destroy();\n        }\n        this.fontSizeText = undefined;\n        if (this.colorPicker) {\n            this.colorPicker.destroy();\n        }\n        this.colorPicker = undefined;\n        if (this.underlineDrop) {\n            this.underlineDrop.destroy();\n        }\n        this.underlineDrop = undefined;\n        if (this.strikethroughBox) {\n            this.strikethroughBox.destroy();\n        }\n        this.strikethroughBox = undefined;\n        if (this.doublestrikethrough) {\n            this.doublestrikethrough.destroy();\n        }\n        this.doublestrikethrough = undefined;\n        if (this.superscript) {\n            this.superscript.destroy();\n        }\n        this.superscript = undefined;\n        if (this.subscript) {\n            this.subscript.destroy();\n        }\n        this.subscript = undefined;\n    };\n    return FontDialog;\n}());\nexport { FontDialog };\n/* tslint:enable:no-any */ \n","import { createElement, isNullOrUndefined, L10n } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\n/**\n * The Hyperlink dialog is used to insert or edit hyperlink at selection.\n */\n/* tslint:disable:max-line-length */\nvar HyperlinkDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function HyperlinkDialog(viewer) {\n        var _this = this;\n        this.displayText = '';\n        this.navigationUrl = undefined;\n        this.bookmarkDropdown = undefined;\n        this.bookmarkCheckbox = undefined;\n        this.bookmarks = [];\n        /**\n         * @private\n         */\n        this.onKeyUpOnUrlBox = function (event) {\n            if (event.keyCode === 13) {\n                if (_this.displayTextBox.value !== '' && _this.urlTextBox.value !== '') {\n                    _this.onInsertHyperlink();\n                }\n                return;\n            }\n            var selectedText = _this.owner.selection.text;\n            var urlValue = _this.urlTextBox.value;\n            if (urlValue.substring(0, 4).toLowerCase() === 'www.') {\n                _this.urlTextBox.value = 'http://' + urlValue;\n            }\n            if (_this.displayText === '') {\n                _this.displayTextBox.value = urlValue;\n            }\n            _this.enableOrDisableInsertButton();\n        };\n        /**\n         * @private\n         */\n        this.onKeyUpOnDisplayBox = function () {\n            _this.displayText = _this.displayTextBox.value;\n            _this.enableOrDisableInsertButton();\n        };\n        /**\n         * @private\n         */\n        this.onInsertButtonClick = function () {\n            _this.onInsertHyperlink();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.clearValue();\n        };\n        /**\n         * @private\n         */\n        this.loadHyperlinkDialog = function () {\n            _this.owner.updateFocus();\n            _this.bookmarks = [];\n            for (var i = 0; i < _this.owner.bookmarks.keys.length; i++) {\n                var bookmark = _this.owner.bookmarks.keys[i];\n                if (bookmark.indexOf('_') !== 0) {\n                    _this.bookmarks.push(bookmark);\n                }\n            }\n            var fieldBegin = _this.owner.selection.getHyperlinkField();\n            if (!isNullOrUndefined(fieldBegin)) {\n                if (!isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    var format = undefined;\n                    // tslint:disable-next-line:max-line-length\n                    var fieldObj = _this.owner.selection.getHyperlinkDisplayText(fieldBegin.fieldSeparator.line.paragraph, fieldBegin.fieldSeparator, fieldBegin.fieldEnd, false, format);\n                    _this.displayText = fieldObj.displayText;\n                    _this.displayTextBox.disabled = fieldObj.isNestedField;\n                }\n                _this.displayTextBox.value = _this.displayText;\n                var link = _this.owner.selection.getLinkText(fieldBegin);\n                _this.urlTextBox.value = _this.navigationUrl = link;\n                _this.owner.dialog.header = _this.localObj.getConstant('Edit Hyperlink');\n            }\n            else {\n                _this.displayText = _this.owner.selection.getText(true);\n                if (_this.displayText !== '') {\n                    if (_this.displayText.indexOf(String.fromCharCode(65532)) !== -1 ||\n                        _this.displayText.indexOf('\\r') !== -1 && (_this.displayText.lastIndexOf('\\r') !== -1 &&\n                            _this.displayText.slice(0, -1).indexOf('\\r') !== -1)) {\n                        _this.displayTextBox.value = '<<Selection in document>>';\n                        _this.displayTextBox.disabled = true;\n                    }\n                    else {\n                        _this.displayTextBox.value = _this.displayText;\n                    }\n                }\n            }\n            _this.bookmarkDiv.style.display = 'none';\n            _this.addressText.style.display = 'block';\n            _this.urlTextBox.style.display = 'block';\n            _this.bookmarkCheckbox.checked = false;\n            _this.bookmarkDropdown.dataSource = _this.owner.bookmarks.keys;\n            _this.insertButton = document.getElementsByClassName('e-hyper-insert')[0];\n            _this.enableOrDisableInsertButton();\n            _this.urlTextBox.focus();\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        /**\n         * @private\n         */\n        this.closeHyperlinkDialog = function () {\n            _this.clearValue();\n            _this.owner.updateFocus();\n        };\n        /* tslint:disable:no-any */\n        this.onUseBookmarkChange = function (args) {\n            if (args.checked) {\n                _this.bookmarkDiv.style.display = 'block';\n                _this.bookmarkDropdown.dataSource = _this.bookmarks;\n                _this.addressText.style.display = 'none';\n                _this.urlTextBox.style.display = 'none';\n            }\n            else {\n                _this.bookmarkDiv.style.display = 'none';\n                _this.addressText.style.display = 'block';\n                _this.urlTextBox.style.display = 'block';\n            }\n        };\n        this.onBookmarkchange = function (args) {\n            if (_this.bookmarkDropdown.value !== '') {\n                _this.insertButton.disabled = false;\n            }\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.getModuleName = function () {\n        return 'HyperlinkDialog';\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.initHyperlinkDialog = function (localValue, isRtl) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_hyperlink';\n        this.target = createElement('div', { id: id, className: 'e-de-hyperlink' });\n        var container = createElement('div');\n        var displayText = createElement('div', { className: 'e-de-hyperlink-dlg-title', innerHTML: localValue.getConstant('Text to display') });\n        this.displayTextBox = createElement('input', { id: this.owner.owner.containerId + '_display_text', className: 'e-input e-de-hyperlink-dlg-input' });\n        this.displayTextBox.addEventListener('keyup', instance.onKeyUpOnDisplayBox);\n        container.appendChild(displayText);\n        container.appendChild(this.displayTextBox);\n        this.addressText = createElement('div', { className: 'e-de-hyperlink-dlg-title', innerHTML: localValue.getConstant('Address') });\n        this.urlTextBox = createElement('input', { id: this.owner.owner.containerId + '_url_text', className: 'e-input e-de-hyperlink-dlg-input', attrs: { autofocus: 'true' } });\n        this.urlTextBox.addEventListener('input', instance.onKeyUpOnUrlBox);\n        this.urlTextBox.addEventListener('keyup', instance.onKeyUpOnUrlBox);\n        container.appendChild(this.addressText);\n        container.appendChild(this.urlTextBox);\n        this.bookmarkDiv = createElement('div', { styles: 'display:none;' });\n        var bookmarkText = createElement('div', { className: 'e-de-hyperlink-dlg-title', innerHTML: localValue.getConstant('Bookmark') });\n        var bookmarkTextElement = createElement('div', { className: 'e-de-hyperlink-dlg-bookmark' });\n        // tslint:disable-next-line:max-line-length\n        var bookmarkValue = createElement('input', { id: 'e-de-hyperlink-dlg-bookmark-value' });\n        bookmarkTextElement.appendChild(bookmarkValue);\n        // tslint:disable-next-line:max-line-length\n        this.bookmarkDropdown = new DropDownList({ dataSource: [], change: this.onBookmarkchange, popupHeight: '230px', width: '230px', noRecordsTemplate: localValue.getConstant('No bookmarks found') });\n        this.bookmarkDropdown.appendTo(bookmarkValue);\n        this.bookmarkDiv.appendChild(bookmarkText);\n        this.bookmarkDiv.appendChild(bookmarkTextElement);\n        container.appendChild(this.bookmarkDiv);\n        // tslint:disable-next-line:max-line-length\n        var bookmarkCheckDiv = createElement('div', { className: 'e-de-hyperlink-bookmark-check e-de-hyperlink-dlg-title' });\n        var bookmarkCheck = createElement('input', { attrs: { type: 'checkbox' }, id: this.target.id + '_bookmark', className: this.target.id + '_bookmarkcheck' });\n        bookmarkCheckDiv.appendChild(bookmarkCheck);\n        this.bookmarkCheckbox = new CheckBox({\n            label: localValue.getConstant('Use bookmarks'),\n            enableRtl: isRtl, change: this.onUseBookmarkChange\n        });\n        this.bookmarkCheckbox.appendTo(bookmarkCheck);\n        container.appendChild(bookmarkCheckDiv);\n        this.target.appendChild(container);\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.show = function () {\n        this.localObj = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        this.localObj.setLocale(this.owner.owner.locale);\n        if (!this.target) {\n            this.initHyperlinkDialog(this.localObj, this.owner.owner.enableRtl);\n        }\n        this.owner.dialog.header = this.localObj.getConstant('Insert Hyperlink');\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.buttons = [{\n                click: this.onInsertButtonClick,\n                buttonModel: { content: this.localObj.getConstant('Ok'), cssClass: 'e-flat e-hyper-insert', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: this.localObj.getConstant('Cancel'), cssClass: 'e-flat e-hyper-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.beforeOpen = this.loadHyperlinkDialog;\n        this.owner.dialog.close = this.closeHyperlinkDialog;\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.hide = function () {\n        this.closeHyperlinkDialog();\n    };\n    HyperlinkDialog.prototype.enableOrDisableInsertButton = function () {\n        if (!isNullOrUndefined(this.insertButton)) {\n            // tslint:disable-next-line:max-line-length\n            this.insertButton.disabled = (this.urlTextBox.value === '' || this.displayTextBox.value === '');\n        }\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.onInsertHyperlink = function () {\n        var displayText = this.displayTextBox.value.trim();\n        var address = this.urlTextBox.value.trim();\n        var isBookmark = false;\n        if (!isNullOrUndefined(this.bookmarkDropdown.value) && this.bookmarkDropdown.value !== '') {\n            address = this.bookmarkDropdown.value;\n            isBookmark = true;\n        }\n        if (address === '') {\n            this.owner.dialog.hide();\n            return;\n        }\n        if (displayText === '' && address !== '') {\n            displayText = address;\n        }\n        else {\n            displayText = this.displayTextBox.value;\n        }\n        if (!isNullOrUndefined(this.navigationUrl)) {\n            this.owner.owner.editorModule.editHyperlink(this.owner.selection, address, displayText, isBookmark);\n        }\n        else {\n            var remove = this.owner.selection.text !== displayText && !this.displayTextBox.disabled;\n            this.owner.owner.editorModule.insertHyperlink(address, displayText, remove, isBookmark);\n        }\n        this.owner.dialog.hide();\n        this.navigationUrl = undefined;\n    };\n    /* tslint:enable:no-any */\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.clearValue = function () {\n        this.displayTextBox.value = '';\n        this.urlTextBox.value = '';\n        this.displayText = '';\n        this.displayTextBox.disabled = false;\n        this.bookmarks = [];\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.destroy = function () {\n        if (this.displayTextBox) {\n            this.displayTextBox.innerHTML = '';\n            this.displayTextBox = undefined;\n        }\n        if (this.urlTextBox) {\n            this.urlTextBox.parentElement.removeChild(this.urlTextBox);\n            this.urlTextBox = undefined;\n        }\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            this.target.innerHTML = '';\n            this.target = undefined;\n        }\n    };\n    return HyperlinkDialog;\n}());\nexport { HyperlinkDialog };\n","/**\n * Export dialogs\n */\nexport * from './hyperlink-dialog';\nexport * from './table-dialog';\nexport * from './bookmark-dialog';\nexport * from './table-of-contents-dialog';\nexport * from './page-setup-dialog';\nexport * from './paragraph-dialog';\nexport * from './list-dialog';\nexport * from './style-dialog';\nexport * from './bullets-and-numbering-dialog';\nexport * from './font-dialog';\nexport * from './table-properties-dialog';\nexport * from './borders-and-shading-dialog';\nexport * from './table-options-dialog';\nexport * from './cell-options-dialog';\nexport * from './styles-dialog';\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { createElement, L10n } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n// tslint:disable-next-line:max-line-length\nimport { WCharacterFormat, WParagraphFormat } from '../format/index';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { Tooltip } from '@syncfusion/ej2-popups';\nimport { ListViewModel } from './list-view-model';\n/**\n * The List dialog is used to create or modify lists.\n */\n/* tslint:disable:no-any */\nvar ListDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ListDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.dialog = undefined;\n        this.target = undefined;\n        /**\n         * @private\n         */\n        this.owner = undefined;\n        this.viewModel = undefined;\n        this.startAt = undefined;\n        this.textIndent = undefined;\n        this.alignedAt = undefined;\n        this.listLevelElement = undefined;\n        this.followNumberWith = undefined;\n        this.numberStyle = undefined;\n        this.numberFormat = undefined;\n        this.restartBy = undefined;\n        /**\n         * @private\n         */\n        this.isListCharacterFormat = false;\n        this.onTextIndentChanged = function (args) {\n            _this.viewModel.listLevel.paragraphFormat.leftIndent = args.value;\n        };\n        this.onStartValueChanged = function (args) {\n            _this.viewModel.listLevel.startAt = args.value;\n        };\n        this.onListLevelValueChanged = function (args) {\n            _this.viewModel.levelNumber = parseInt(args.value.slice(args.value.length - 1), 10) - 1;\n            if (isNullOrUndefined(_this.listLevel)) {\n                return;\n            }\n            if (isNullOrUndefined(_this.listLevel.characterFormat)) {\n                _this.listLevel.characterFormat = new WCharacterFormat(_this.viewModel.listLevel);\n            }\n            if (!isNullOrUndefined(_this.listLevel.paragraphFormat)) {\n                _this.listLevel.paragraphFormat = new WParagraphFormat(_this.viewModel.listLevel);\n            }\n            _this.updateDialogValues();\n            _this.updateRestartLevelBox();\n        };\n        this.onNumberFormatChanged = function (args) {\n            _this.viewModel.listLevel.numberFormat = args.target.value;\n        };\n        this.onAlignedAtValueChanged = function (args) {\n            _this.viewModel.listLevel.paragraphFormat.firstLineIndent = args.value;\n        };\n        this.onFollowCharacterValueChanged = function (args) {\n            if (args.value) {\n                _this.viewModel.followCharacter = args.value;\n            }\n        };\n        this.onLevelPatternValueChanged = function (args) {\n            _this.viewModel.listLevelPattern = args.value;\n            var numberFormat = '%' + (_this.levelNumber + 1).toString();\n            // tslint:disable-next-line:max-line-length\n            var numberFormatTextBox = document.getElementById(_this.owner.owner.containerId + '_numberFormat');\n            if (_this.listLevel.listLevelPattern === 'Bullet') {\n                _this.listLevel.numberFormat = '\\uf0b7';\n                numberFormatTextBox.value = _this.listLevel.numberFormat;\n                _this.listLevel.characterFormat.fontFamily = 'Wingdings';\n            }\n            else {\n                if (_this.listLevel.listLevelPattern === 'None') {\n                    _this.listLevel.numberFormat = '';\n                }\n                if (!_this.listLevel.numberFormat.match(numberFormat) && _this.listLevel.listLevelPattern !== 'None') {\n                    _this.listLevel.numberFormat = numberFormat + '.';\n                }\n                numberFormatTextBox.value = _this.listLevel.numberFormat;\n            }\n        };\n        this.loadListDialog = function () {\n            _this.owner.updateFocus();\n            if (isNullOrUndefined(_this.owner.owner)) {\n                return;\n            }\n            _this.viewModel = new ListViewModel();\n            _this.viewModel.dialog = _this;\n            if (_this.owner.selection.paragraphFormat.listLevelNumber > 0) {\n                _this.viewModel.levelNumber = _this.owner.selection.paragraphFormat.listLevelNumber;\n            }\n            _this.viewModel.list = _this.owner.selection.paragraphFormat.getList();\n            if (isNullOrUndefined(_this.listLevel)) {\n                return;\n            }\n            if (isNullOrUndefined(_this.listLevel.characterFormat)) {\n                _this.listLevel.characterFormat = new WCharacterFormat(_this.viewModel.listLevel);\n            }\n            if (isNullOrUndefined(_this.listLevel.paragraphFormat)) {\n                _this.listLevel.paragraphFormat = new WParagraphFormat(_this.viewModel.listLevel);\n            }\n            _this.updateDialogValues();\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        this.showFontDialog = function () {\n            _this.owner.owner.fontDialogModule.showFontDialog(_this.listLevel.characterFormat);\n        };\n        this.onApplyList = function () {\n            if (!isNullOrUndefined(_this.owner)) {\n                _this.owner.selection.paragraphFormat.setList(_this.list);\n            }\n            _this.owner.dialog2.hide();\n            _this.owner.updateFocus();\n        };\n        this.onCancelButtonClick = function () {\n            _this.disposeBindingForListUI();\n            _this.owner.dialog2.hide();\n            _this.owner.updateFocus();\n            _this.isListCharacterFormat = false;\n        };\n        this.closeListDialog = function () {\n            _this.disposeBindingForListUI();\n            _this.owner.updateFocus();\n            _this.isListCharacterFormat = false;\n        };\n        this.owner = viewer;\n        this.viewModel = new ListViewModel();\n    }\n    Object.defineProperty(ListDialog.prototype, \"listLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.viewModel)) {\n                return this.viewModel.listLevel;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListDialog.prototype, \"list\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.viewModel)) {\n                return this.viewModel.list;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListDialog.prototype, \"levelNumber\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.listLevel.ownerBase instanceof WLevelOverride) {\n                return this.listLevel.ownerBase.levelNumber;\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (this.listLevel.ownerBase instanceof WAbstractList && !isNullOrUndefined(this.listLevel.ownerBase.levels)) {\n                return this.listLevel.ownerBase.levels.indexOf(this.listLevel);\n            }\n            else {\n                return -1;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ListDialog.prototype.getModuleName = function () {\n        return 'ListDialog';\n    };\n    /**\n     * @private\n     */\n    ListDialog.prototype.showListDialog = function () {\n        var locale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        locale.setLocale(this.owner.owner.locale);\n        if (!this.target) {\n            this.initListDialog(locale, this.owner.owner.enableRtl);\n        }\n        this.isListCharacterFormat = true;\n        this.owner.dialog2.header = locale.getConstant('Define new Multilevel list');\n        this.owner.dialog2.height = 'auto';\n        this.owner.dialog2.width = 'auto';\n        this.owner.dialog2.content = this.target;\n        var buttonClass;\n        var isRtl = this.owner.owner.enableRtl;\n        if (isRtl) {\n            buttonClass = 'e-flat e-list-dlg-font e-de-dlg-target.e-de-rtl e-font-rtl';\n        }\n        else {\n            buttonClass = 'e-flat e-list-dlg-font e-font';\n        }\n        this.owner.dialog2.buttons = [{\n                click: this.showFontDialog,\n                buttonModel: { content: locale.getConstant('Font'), cssClass: buttonClass }\n            }, {\n                click: this.onApplyList,\n                buttonModel: { content: locale.getConstant('Ok'), cssClass: 'e-flat e-list-dlg', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: locale.getConstant('Cancel'), cssClass: 'e-flat e-list-dlg' }\n            }];\n        this.owner.dialog2.dataBind();\n        this.wireAndBindEvent(locale, isRtl);\n        this.owner.dialog2.beforeOpen = this.loadListDialog;\n        this.owner.dialog2.close = this.closeListDialog;\n        this.owner.dialog2.position = { X: 'center', Y: 'top' };\n        this.owner.dialog2.show();\n    };\n    /**\n     * Shows the table properties dialog\n     * @private\n     */\n    ListDialog.prototype.initListDialog = function (locale, isRtl) {\n        var instance = this;\n        var containerId = this.owner.owner.containerId;\n        var id = containerId + '_insert_list';\n        this.target = createElement('div', { id: id, className: 'e-de-list-dlg' });\n        // tslint:disable-next-line:max-line-length\n        var listLevelDiv = createElement('div', { innerHTML: '<label id=\"' + containerId + '_listLevellabel\" style=\"display:block;\" class=e-de-list-ddl-header-list-level>' + locale.getConstant('List level') + '</label><label id=\"' + containerId + '_modifyLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Choose level to modify') + '</label><select style=\"height:20px;width:43%\" id=\"' + containerId + '_listLevel\"><option>' + locale.getConstant('Level') + ' 1' + '</option><option>' + locale.getConstant('Level') + ' 2' + '</option><option>' + locale.getConstant('Level') + ' 3' + '</option><option>' + locale.getConstant('Level') + ' 4' + '</option><option>' + locale.getConstant('Level') + ' 5' + '</option><option>' + locale.getConstant('Level') + ' 6' + '</option><option>' + locale.getConstant('Level') + ' 7' + '</option><option>' + locale.getConstant('Level') + ' 8' + '</option><option>' + locale.getConstant('Level') + ' 9' + '</option></select>' });\n        this.target.appendChild(listLevelDiv);\n        var div = createElement('div');\n        var divStyle;\n        if (isRtl) {\n            divStyle = '<div style=\"float:right;display:block;width:241px;\">';\n        }\n        else {\n            divStyle = '<div style=\"float:left;display:block;\">';\n        }\n        // tslint:disable-next-line:max-line-length\n        var numberStyleDiv = createElement('div', { innerHTML: divStyle + '<label id=\"' + containerId + '_numberFormatLabel\" style=\"display:block;\" class=e-de-list-ddl-header>' + locale.getConstant('Number format') + '</label><label id=\"' + containerId + '_numberStyleLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Number style for this level') + '</label><select style=\"height:20px;width:100%\" id=\"' + containerId + '_numberStyle\"><option>' + locale.getConstant('Arabic') + '</option><option>' + locale.getConstant('UpRoman') + '</option><option>' + locale.getConstant('LowRoman') + '</option><option>' + locale.getConstant('UpLetter') + '</option><option>' + locale.getConstant('LowLetter') + '</option><option>' + locale.getConstant('Number') + '</option><option>' + locale.getConstant('Leading zero') + '</option><option>' + locale.getConstant('Bullet') + '</option><option>' + locale.getConstant('Ordinal') + '</option><option>' + locale.getConstant('Ordinal Text') + '</option><option>' + locale.getConstant('Special') + '</option><option>' + locale.getConstant('For East') + '</option></select><label id=\"' + containerId + '_startAtLabel\" style=\"display:block;\" class=e-de-list-ddl-subheaderbottom>' + locale.getConstant('Start at') + '</label><input type=\"text\" id=\"' + containerId + '_startAt\">' });\n        div.appendChild(numberStyleDiv);\n        // tslint:disable-next-line:max-line-length\n        this.numberFormatDiv = createElement('div', { className: 'e-de-list-dlg-subdiv', innerHTML: '<div><div><label id=\"' + containerId + '_formatLabel\" style=\"display:inline-block;width:86%\" class=e-de-list-ddl-subheader>' + locale.getConstant('Enter formatting for number') + '</label><button id=\"' + containerId + '_list_info\" class=\"e-control e-btn e-primary e-de-list-format-info\">i</button></div><input style=width:180px; type=\"text\" id=\"' + containerId + '_numberFormat\" class=e-input></div><label id=\"' + containerId + '_restartLabel\" style=\"display:block;\" class=e-de-list-ddl-subheaderbottom>' + locale.getConstant('Restart list after') + '</label><select style=\"height:20px;width:100%\" id=\"' + containerId + '_restartBy\"><option>' + locale.getConstant('No Restart') + '</option></select></div>' });\n        div.appendChild(this.numberFormatDiv);\n        this.target.appendChild(div);\n        var indentsDivLabelStyle;\n        if (isRtl) {\n            indentsDivLabelStyle = 'display:block;position:relative; ';\n        }\n        else {\n            indentsDivLabelStyle = 'display:block; ';\n        }\n        // tslint:disable-next-line:max-line-length\n        var indentsDiv = createElement('div', { innerHTML: divStyle + '<label id=\"' + containerId + '_IndentsLabel\" style=' + indentsDivLabelStyle + 'class=e-de-list-ddl-header>' + locale.getConstant('Position') + '</label><label id=\"' + containerId + '_textIndentLabel\" style=' + indentsDivLabelStyle + 'class=e-de-list-ddl-subheader>' + locale.getConstant('Text indent at') + '</label><input type=\"text\" id=\"' + containerId + '_textIndent\"><label id=\"' + containerId + '_followCharacterLabel\" style=' + indentsDivLabelStyle + 'class=e-de-list-ddl-subheaderbottom>' + locale.getConstant('Follow number with') + '</label><select style=\"height:20px;width:100%\" id=\"' + containerId + '_followCharacter\"><option>' + locale.getConstant('Tab character') + '</option><option>' + locale.getConstant('Space') + '</option><option>' + locale.getConstant('Nothing') + '</option></select></div><div id=\"e-de-list-dlg-div\" class=\"e-de-list-dlg-div\"><label id=\"' + containerId + '_alignedAtLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Aligned at') + '</label><input type=\"text\" id=\"' + containerId + '_alignedAt\"></div>', });\n        this.target.appendChild(indentsDiv);\n    };\n    ListDialog.prototype.wireAndBindEvent = function (locale, isRtl) {\n        var instance = this;\n        var containerId = this.owner.owner.containerId;\n        if (isRtl) {\n            document.getElementById('e-de-list-dlg-div').classList.add('e-de-rtl');\n            this.numberFormatDiv.classList.add('e-de-rtl');\n        }\n        var startAtTextBox = document.getElementById(containerId + '_startAt');\n        var textIndentAtTextBox = document.getElementById(containerId + '_textIndent');\n        var alignedAtTextBox = document.getElementById(containerId + '_alignedAt');\n        this.startAt = new NumericTextBox({\n            format: '#',\n            decimals: 0,\n            min: 0,\n            max: 50,\n            width: '180px',\n            enablePersistence: false,\n        });\n        this.startAt.addEventListener('change', instance.onStartValueChanged);\n        this.startAt.appendTo(startAtTextBox);\n        this.textIndent = new NumericTextBox({\n            format: '#',\n            decimals: 0,\n            min: 0,\n            max: 1584,\n            width: '180px',\n            step: 4,\n            enablePersistence: false\n        });\n        this.textIndent.addEventListener('change', instance.onTextIndentChanged);\n        this.textIndent.appendTo(textIndentAtTextBox);\n        this.alignedAt = new NumericTextBox({\n            format: '#',\n            max: 1584,\n            step: 6,\n            width: '180px',\n            enablePersistence: false\n        });\n        this.alignedAt.addEventListener('change', instance.onAlignedAtValueChanged);\n        this.alignedAt.appendTo(alignedAtTextBox);\n        var listLevel = document.getElementById(containerId + '_listLevel');\n        // tslint:disable-next-line:max-line-length\n        this.listLevelElement = new DropDownList({ popupHeight: '150px', width: '180px', enableRtl: isRtl, change: instance.onListLevelValueChanged });\n        this.listLevelElement.appendTo(listLevel);\n        var followCharacterElement = document.getElementById(containerId + '_followCharacter');\n        // tslint:disable-next-line:max-line-length\n        this.followNumberWith = new DropDownList({ popupHeight: '150px', width: '180px', enableRtl: isRtl, change: instance.onFollowCharacterValueChanged });\n        this.followNumberWith.appendTo(followCharacterElement);\n        var numberStyleEle = document.getElementById(containerId + '_numberStyle');\n        // tslint:disable-next-line:max-line-length\n        this.numberStyle = new DropDownList({ popupHeight: '150px', width: '180px', enableRtl: isRtl, change: instance.onLevelPatternValueChanged });\n        this.numberStyle.appendTo(numberStyleEle);\n        this.numberFormat = document.getElementById(containerId + '_numberFormat');\n        this.numberFormat.addEventListener('change', instance.onNumberFormatChanged);\n        var restartElement = document.getElementById(containerId + '_restartBy');\n        this.restartBy = new DropDownList({ popupHeight: '150px', width: '180px', enableRtl: isRtl });\n        this.restartBy.appendTo(restartElement);\n        var button = document.getElementById(containerId + '_list_info');\n        this.formatInfoToolTip = new Tooltip({ width: 200 });\n        // tslint:disable-next-line:max-line-length\n        this.formatInfoToolTip.content = locale.getConstant('Number format tooltip information');\n        this.formatInfoToolTip.position = 'RightTop';\n        this.formatInfoToolTip.appendTo(button);\n    };\n    ListDialog.prototype.updateRestartLevelBox = function () {\n        var containerId = this.owner.owner.containerId;\n        var listLevel = document.getElementById(containerId + '_listLevel');\n        var restartBy = document.getElementById(containerId + '_restartBy');\n        for (var i = 0; i < restartBy.options.length; i) {\n            restartBy.options.remove(i);\n        }\n        if (listLevel.selectedIndex === 0) {\n            var option = document.createElement('option');\n            option.value = 'No Restart';\n            option.innerHTML = 'No Restart';\n            restartBy.appendChild(option);\n        }\n        else {\n            for (var i = listLevel.selectedIndex; i > 0; i--) {\n                var option_1 = document.createElement('option');\n                option_1.value = 'Level ' + i;\n                option_1.innerHTML = 'Level ' + i;\n                restartBy.appendChild(option_1);\n            }\n            var option = document.createElement('option');\n            option.value = 'No Restart';\n            option.innerHTML = 'No Restart';\n            restartBy.appendChild(option);\n        }\n        restartBy.selectedIndex = 0;\n    };\n    ListDialog.prototype.listPatternConverter = function (listLevelPattern) {\n        switch (listLevelPattern) {\n            case 'Arabic': return 0;\n            case 'UpRoman': return 1;\n            case 'LowRoman': return 2;\n            case 'UpLetter': return 3;\n            case 'LowLetter': return 4;\n            case 'Number': return 5;\n            case 'LeadingZero': return 6;\n            case 'Bullet': return 7;\n            case 'Ordinal': return 8;\n            case 'OrdinalText': return 9;\n            case 'Special': return 10;\n            case 'FarEast': return 11;\n            default: return 12;\n        }\n    };\n    ListDialog.prototype.followCharacterConverter = function (followCharacter) {\n        switch (followCharacter) {\n            case 'Tab':\n                return 0;\n            case 'Space':\n                return 1;\n            default:\n                return 2;\n        }\n    };\n    ListDialog.prototype.updateDialogValues = function () {\n        // tslint:disable-next-line:max-line-length\n        var restartByTextBox = document.getElementById(this.owner.owner.containerId + '_restartBy');\n        this.startAt.value = this.viewModel.listLevel.startAt;\n        this.textIndent.value = this.viewModel.listLevel.paragraphFormat.leftIndent;\n        this.alignedAt.value = this.viewModel.listLevel.paragraphFormat.firstLineIndent;\n        this.followNumberWith.index = this.followCharacterConverter(this.viewModel.followCharacter);\n        this.numberFormat.value = this.viewModel.listLevel.numberFormat;\n        this.numberStyle.index = this.listPatternConverter(this.viewModel.listLevelPattern);\n        this.listLevelElement.index = this.viewModel.levelNumber;\n        this.viewModel.levelNumber = this.viewModel.levelNumber;\n    };\n    ListDialog.prototype.disposeBindingForListUI = function () {\n        this.followNumberWith.index = -1;\n        this.numberFormat.value = ' ';\n        this.numberStyle.index = -1;\n        this.listLevelElement.index = -1;\n        this.restartBy.index = -1;\n        this.viewModel.destroy();\n    };\n    /**\n     * @private\n     */\n    ListDialog.prototype.destroy = function () {\n        if (this.alignedAt) {\n            this.alignedAt.destroy();\n        }\n        this.alignedAt = undefined;\n        this.dialog = undefined;\n        if (this.followNumberWith) {\n            this.followNumberWith.destroy();\n        }\n        this.followNumberWith = undefined;\n        if (this.listLevelElement) {\n            this.listLevelElement.destroy();\n        }\n        this.listLevelElement = undefined;\n        if (this.textIndent) {\n            this.textIndent.destroy();\n        }\n        this.textIndent = undefined;\n        if (this.startAt) {\n            this.startAt.destroy();\n        }\n        this.startAt = undefined;\n        if (this.numberStyle) {\n            this.numberStyle.destroy();\n        }\n        this.numberStyle = undefined;\n        this.numberFormat = undefined;\n        if (this.restartBy) {\n            this.restartBy.destroy();\n        }\n        this.restartBy = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var l = 0; l < this.target.childNodes.length; l++) {\n                this.target.removeChild(this.target.childNodes[l]);\n                l--;\n            }\n            this.target = undefined;\n        }\n        this.owner = undefined;\n        this.viewModel = undefined;\n    };\n    return ListDialog;\n}());\nexport { ListDialog };\n/* tslint:enable:no-any */ \n","import { WCharacterFormat, WParagraphFormat } from '../format/index';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * List view model implementation\n * @private\n */\nvar ListViewModel = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ListViewModel() {\n        this.listIn = undefined;\n        this.levelNumberIn = undefined;\n        /**\n         * @private\n         */\n        this.dialog = undefined;\n        this.levelNumber = 0;\n    }\n    Object.defineProperty(ListViewModel.prototype, \"levelNumber\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.levelNumberIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.levelNumberIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"list\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.listIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (isNullOrUndefined(value)) {\n                this.createList();\n            }\n            else {\n                this.listIn = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"listLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.list) && this.levelNumber >= 0 && this.levelNumber < 9) {\n                if (!isNullOrUndefined(this.dialog.owner.getAbstractListById(this.list.abstractListId))) {\n                    if (this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.length <= this.levelNumber) {\n                        this.addListLevels();\n                    }\n                    return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels[this.levelNumber];\n                }\n                else {\n                    this.dialog.owner.lists.push(this.list);\n                    var abstractList = this.list.abstractList;\n                    if (!this.list.abstractList) {\n                        abstractList = new WAbstractList();\n                        abstractList.abstractListId = this.list.abstractListId;\n                    }\n                    var listLevelAdv = new WListLevel(abstractList);\n                    listLevelAdv.characterFormat = new WCharacterFormat(listLevelAdv);\n                    listLevelAdv.paragraphFormat = new WParagraphFormat(listLevelAdv);\n                    listLevelAdv.paragraphFormat.leftIndent = (1) * 48;\n                    listLevelAdv.paragraphFormat.firstLineIndent = -24;\n                    listLevelAdv.numberFormat = '%' + (1).toString() + '.';\n                    listLevelAdv.listLevelPattern = 'UpRoman';\n                    listLevelAdv.followCharacter = 'Tab';\n                    listLevelAdv.startAt = 1;\n                    listLevelAdv.restartLevel = 1;\n                    this.dialog.owner.abstractLists.push(abstractList);\n                    return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels[0];\n                    // return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.getItem(0);\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"listLevelPattern\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.listLevel)) {\n                return this.listLevel.listLevelPattern;\n            }\n            return 'Arabic';\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (!isNullOrUndefined(this.listLevel)) {\n                this.listLevel.listLevelPattern = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"followCharacter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.listLevel)) {\n                return this.listLevel.followCharacter;\n            }\n            return 'None';\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (!isNullOrUndefined(this.listLevel)) {\n                this.listLevel.followCharacter = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ListViewModel.prototype.createList = function () {\n        this.list = new WList();\n        this.list.listId = this.dialog.owner.lists.length + 1;\n        var abstractList = new WAbstractList();\n        abstractList.abstractListId = this.dialog.owner.abstractLists.length + 1;\n        this.list.abstractListId = abstractList.abstractListId;\n        this.dialog.owner.lists.push(this.list);\n        var listLevel = new WListLevel(abstractList);\n        listLevel.paragraphFormat = new WParagraphFormat(listLevel);\n        listLevel.paragraphFormat.leftIndent = 48;\n        listLevel.paragraphFormat.firstLineIndent = -24;\n        listLevel.characterFormat = new WCharacterFormat(listLevel);\n        listLevel.numberFormat = '%1.';\n        listLevel.startAt = 1;\n        abstractList.levels.push(listLevel);\n        this.dialog.owner.abstractLists.push(abstractList);\n    };\n    ListViewModel.prototype.addListLevels = function () {\n        if (!isNullOrUndefined(this.list) && !isNullOrUndefined(this.list.abstractListId)) {\n            for (var i = this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.length; i < 9; i++) {\n                var listLevelAdv = new WListLevel(this.dialog.owner.getAbstractListById(this.list.abstractListId));\n                listLevelAdv.characterFormat = new WCharacterFormat(listLevelAdv);\n                listLevelAdv.paragraphFormat = new WParagraphFormat(listLevelAdv);\n                listLevelAdv.paragraphFormat.leftIndent = (i + 1) * 48;\n                listLevelAdv.paragraphFormat.firstLineIndent = -24;\n                listLevelAdv.numberFormat = '%' + (i + 1).toString() + '.';\n                listLevelAdv.listLevelPattern = 'Arabic';\n                listLevelAdv.followCharacter = 'Tab';\n                listLevelAdv.startAt = 1;\n                listLevelAdv.restartLevel = i;\n                (this.dialog.owner).getAbstractListById(this.list.abstractListId).levels.push(listLevelAdv);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    ListViewModel.prototype.destroy = function () {\n        this.list = undefined;\n        this.followCharacter = undefined;\n        this.levelNumber = undefined;\n        this.listLevelPattern = undefined;\n    };\n    return ListViewModel;\n}());\nexport { ListViewModel };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { createElement, L10n } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { CheckBox, RadioButton } from '@syncfusion/ej2-buttons';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WSectionFormat } from './../../implementation/format/index';\nimport { Tab } from '@syncfusion/ej2-navigations';\n/**\n * The Page setup dialog is used to modify formatting of selected sections.\n */\nvar PageSetupDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function PageSetupDialog(viewer) {\n        var _this = this;\n        this.isPortrait = true;\n        /**\n         * @private\n         */\n        this.loadPageSetupDialog = function () {\n            _this.owner.updateFocus();\n            var sectionFormat = _this.owner.selection.sectionFormat;\n            _this.topMarginBox.value = sectionFormat.topMargin;\n            _this.leftMarginBox.value = sectionFormat.leftMargin;\n            _this.bottomMarginBox.value = sectionFormat.bottomMargin;\n            _this.rightMarginBox.value = sectionFormat.rightMargin;\n            _this.widthBox.value = sectionFormat.pageWidth;\n            _this.heightBox.value = sectionFormat.pageHeight;\n            _this.checkBox1.checked = sectionFormat.differentOddAndEvenPages;\n            _this.checkBox2.checked = sectionFormat.differentFirstPage;\n            _this.headerBox.value = sectionFormat.headerDistance;\n            _this.footerBox.value = sectionFormat.footerDistance;\n            if (_this.widthBox.value > _this.heightBox.value) {\n                _this.landscape.checked = true;\n            }\n            else {\n                _this.portrait.checked = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.closePageSetupDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /**\n         * @private\n         */\n        this.keyUpInsertPageSettings = function (event) {\n            if (event.keyCode === 13) {\n                _this.applyPageSetupProperties();\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyPageSetupProperties = function () {\n            var sectionFormat = new WSectionFormat();\n            sectionFormat.bottomMargin = _this.bottomMarginBox.value;\n            sectionFormat.topMargin = _this.topMarginBox.value;\n            sectionFormat.leftMargin = _this.leftMarginBox.value;\n            sectionFormat.rightMargin = _this.rightMarginBox.value;\n            sectionFormat.pageWidth = _this.widthBox.value;\n            sectionFormat.pageHeight = _this.heightBox.value;\n            sectionFormat.differentOddAndEvenPages = _this.checkBox1.checked;\n            sectionFormat.differentFirstPage = _this.checkBox2.checked;\n            sectionFormat.headerDistance = _this.headerBox.value;\n            sectionFormat.footerDistance = _this.footerBox.value;\n            _this.owner.owner.editorModule.onApplySectionFormat(undefined, sectionFormat);\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.changeByPaperSize = function (event) {\n            var value = event.value;\n            var sectionFormat = _this.owner.selection.sectionFormat;\n            var width = sectionFormat.pageWidth;\n            var height = sectionFormat.pageHeight;\n            if (_this.owner.selection.sectionFormat.pageWidth > _this.owner.selection.sectionFormat.pageHeight || _this.landscape.checked) {\n                _this.isPortrait = false;\n            }\n            else {\n                _this.isPortrait = true;\n            }\n            if (value === 'letter') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 612;\n                    _this.heightBox.value = 792;\n                }\n                else {\n                    _this.widthBox.value = 792;\n                    _this.heightBox.value = 612;\n                }\n            }\n            else if (value === 'tabloid') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 792;\n                    _this.heightBox.value = 1224;\n                }\n                else {\n                    _this.widthBox.value = 1224;\n                    _this.heightBox.value = 792;\n                }\n            }\n            else if (value === 'legal') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 612;\n                    _this.heightBox.value = 1008;\n                }\n                else {\n                    _this.widthBox.value = 1008;\n                    _this.heightBox.value = 612;\n                }\n            }\n            else if (value === 'statement') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 392;\n                    _this.heightBox.value = 612;\n                }\n                else {\n                    _this.widthBox.value = 612;\n                    _this.heightBox.value = 392;\n                }\n            }\n            else if (value === 'executive') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 522;\n                    _this.heightBox.value = 756;\n                }\n                else {\n                    _this.widthBox.value = 756;\n                    _this.heightBox.value = 522;\n                }\n            }\n            else if (value === 'a3') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 841.9;\n                    _this.heightBox.value = 1190.55;\n                }\n                else {\n                    _this.widthBox.value = 1190.55;\n                    _this.heightBox.value = 841.9;\n                }\n            }\n            else if (value === 'a4') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 595.3;\n                    _this.heightBox.value = 841.9;\n                }\n                else {\n                    _this.widthBox.value = 841.9;\n                    _this.heightBox.value = 595.3;\n                }\n            }\n            else if (value === 'a5') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 419.55;\n                    _this.heightBox.value = 595.3;\n                }\n                else {\n                    _this.widthBox.value = 595.3;\n                    _this.heightBox.value = 419.55;\n                }\n            }\n            else if (value === 'b4') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 728.5;\n                    _this.heightBox.value = 1031.8;\n                }\n                else {\n                    _this.widthBox.value = 1031.8;\n                    _this.heightBox.value = 728.5;\n                }\n            }\n            else if (value === 'b5') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 515.9;\n                    _this.heightBox.value = 728.5;\n                }\n                else {\n                    _this.widthBox.value = 728.5;\n                    _this.heightBox.value = 515.9;\n                }\n            }\n            else if (value === 'customsize') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 515.9;\n                    _this.heightBox.value = 728.5;\n                }\n                else {\n                    _this.widthBox.value = 728.5;\n                    _this.heightBox.value = 515.9;\n                }\n            }\n        };\n        /**\n         * @private\n         */\n        this.onPortrait = function (event) {\n            _this.landscape.checked = false;\n            var width = _this.widthBox.value;\n            var height = _this.heightBox.value;\n            if (width > height) {\n                _this.widthBox.value = height;\n                _this.heightBox.value = width;\n            }\n        };\n        /**\n         * @private\n         */\n        this.onLandscape = function (event) {\n            _this.portrait.checked = false;\n            var width = _this.widthBox.value;\n            var height = _this.heightBox.value;\n            if (width < height) {\n                _this.widthBox.value = height;\n                _this.heightBox.value = width;\n            }\n        };\n        /**\n         * @private\n         */\n        this.unWireEventsAndBindings = function () {\n            _this.paperSize.value = undefined;\n            _this.topMarginBox.value = undefined;\n            _this.bottomMarginBox.value = undefined;\n            _this.leftMarginBox.value = undefined;\n            _this.rightMarginBox.value = undefined;\n            _this.headerBox.value = undefined;\n            _this.footerBox.value = undefined;\n            _this.widthBox.value = undefined;\n            _this.heightBox.value = undefined;\n            _this.checkBox1.checked = false;\n            _this.checkBox2.checked = false;\n            _this.portrait.checked = false;\n            _this.landscape.checked = false;\n        };\n        this.owner = viewer;\n    }\n    PageSetupDialog.prototype.getModuleName = function () {\n        return 'PageSetupDialog';\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initPageSetupDialog = function (locale, isRtl) {\n        var id = this.owner.owner.containerId + '_pagesetup_dialog';\n        this.target = createElement('div', { id: id, className: 'e-de-pagesetup-dlg-container' });\n        var ejtabContainer = createElement('div', { id: this.target.id + '_MarginTabContainer' });\n        this.target.appendChild(ejtabContainer);\n        this.marginTab = createElement('div', {\n            id: this.target.id + '_marginPropertyTab', styles: 'position: relative;width:400px;'\n        });\n        this.paperTab = createElement('div', {\n            id: this.target.id + '_paperSizePropertyTab', styles: 'position: relative;width:400px;'\n        });\n        this.layoutTab = createElement('div', {\n            id: this.target.id + '_CellPropertiesDialogTab', styles: 'position: relative;width:400px;'\n        });\n        // tslint:disable-next-line:max-line-length\n        var ejtab = createElement('div', { id: this.target.id + '_PageSetupDialogTab', className: 'e-de-page-setup-ppty-tab' });\n        var headerContainer = createElement('div', { className: 'e-tab-header' });\n        var marginHeader = createElement('div', {\n            id: this.target.id + '_marginHeader', innerHTML: locale.getConstant('Margin')\n        });\n        var paperHeader = createElement('div', {\n            id: this.target.id + '_paperHeader', innerHTML: locale.getConstant('Paper')\n        });\n        var layoutHeader = createElement('div', {\n            id: this.target.id + '_layoutHeader', innerHTML: locale.getConstant('Layout')\n        });\n        headerContainer.appendChild(marginHeader);\n        headerContainer.appendChild(paperHeader);\n        headerContainer.appendChild(layoutHeader);\n        var contentContainer = createElement('div', { className: 'e-content' });\n        var marginContent = createElement('div', { id: this.target.id + '_marginContent' });\n        var paperContent = createElement('div', { id: this.target.id + '_paperContent' });\n        var layoutContent = createElement('div', { id: this.target.id + '_layoutContent' });\n        marginContent.appendChild(this.marginTab);\n        paperContent.appendChild(this.paperTab);\n        layoutContent.appendChild(this.layoutTab);\n        contentContainer.appendChild(marginContent);\n        contentContainer.appendChild(paperContent);\n        contentContainer.appendChild(layoutContent);\n        ejtab.appendChild(headerContainer);\n        ejtab.appendChild(contentContainer);\n        ejtabContainer.appendChild(ejtab);\n        this.initMarginProperties(this.marginTab, locale, isRtl);\n        this.initPaperSizeProperties(this.paperTab, locale, isRtl);\n        this.initLayoutProperties(this.layoutTab, locale, isRtl);\n        var tabObj = new Tab({ enableRtl: isRtl }, ejtab);\n        this.target.addEventListener('keyup', this.keyUpInsertPageSettings);\n        var marginTabHeader = tabObj.element.getElementsByClassName('e-item e-toolbar-item')[0];\n        var marginTabHeaderItem = marginTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        marginTabHeaderItem.classList.add('e-de-page-setup-dlg-margin-tab-header');\n        if (isRtl) {\n            marginTabHeaderItem.classList.add('e-de-rtl');\n        }\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initMarginProperties = function (element, locale, isRtl) {\n        var marginDiv = createElement('div', {\n            id: 'margin_div',\n            className: 'e-de-page-setup-dlg-sub-container', styles: 'height:135px;'\n        });\n        // tslint:disable-next-line:max-line-length\n        var leftMarginDiv = createElement('div', { id: 'left_margin', className: 'e-de-page-setup-dlg-left-sub-container' });\n        marginDiv.appendChild(leftMarginDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightMarginDiv = createElement('div', { className: 'e-de-page-setup-dlg-right-sub-container' });\n        marginDiv.appendChild(rightMarginDiv);\n        if (isRtl) {\n            leftMarginDiv.classList.add('e-de-rtl');\n            rightMarginDiv.classList.add('e-de-rtl');\n        }\n        var topLabel = createElement('label', {\n            innerHTML: locale.getConstant('Top'), className: 'e-de-page-setup-dlg-sub-header',\n            id: this.target.id + '_TopLabel', styles: 'padding-top:0px;width:190px;'\n        });\n        var topTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_Top'\n        });\n        var bottomBoxLabel = createElement('label', {\n            innerHTML: locale.getConstant('Bottom'),\n            className: 'e-de-page-setup-dlg-sub-title-header', id: this.target.id + '_bottomLabel'\n        });\n        var bottomTextBox = createElement('input', {\n            attrs: { 'type': 'text' },\n            id: this.target.id + '_bottom'\n        });\n        leftMarginDiv.appendChild(topLabel);\n        leftMarginDiv.appendChild(topTextBox);\n        leftMarginDiv.appendChild(bottomBoxLabel);\n        leftMarginDiv.appendChild(bottomTextBox);\n        var leftBoxLabel = createElement('label', {\n            innerHTML: locale.getConstant('Left'), className: 'e-de-page-setup-dlg-sub-header', styles: 'padding-top:0px;width:190px;',\n            id: this.target.id + '_leftLabel'\n        });\n        var leftTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_left'\n        });\n        var rightLabel = createElement('label', {\n            innerHTML: locale.getConstant('Right'),\n            id: this.target.id + '_rightLabel', className: 'e-de-page-setup-dlg-sub-title-header'\n        });\n        var rightTextBox = createElement('input', {\n            attrs: { 'type': 'text' },\n            id: this.target.id + '_right'\n        });\n        rightMarginDiv.appendChild(leftBoxLabel);\n        rightMarginDiv.appendChild(leftTextBox);\n        rightMarginDiv.appendChild(rightLabel);\n        rightMarginDiv.appendChild(rightTextBox);\n        element.appendChild(marginDiv);\n        this.topMarginBox = new NumericTextBox({ value: 71, width: 170, decimals: 2 });\n        this.topMarginBox.appendTo(topTextBox);\n        this.leftMarginBox = new NumericTextBox({ value: 73, width: 170, decimals: 2 });\n        this.leftMarginBox.appendTo(leftTextBox);\n        this.bottomMarginBox = new NumericTextBox({ value: 72, width: 170, decimals: 2 });\n        this.bottomMarginBox.appendTo(bottomTextBox);\n        this.rightMarginBox = new NumericTextBox({ value: 74, width: 170, decimals: 2 });\n        this.rightMarginBox.appendTo(rightTextBox);\n        // tslint:disable-next-line:max-line-length\n        var orientationDiv = createElement('div', { id: 'orientation_div', className: 'e-de-page-setup-dlg-sub-container-port' });\n        // tslint:disable-next-line:max-line-length\n        var orientationLabeldiv = createElement('div', { id: '_orientationLabelDiv', className: 'e-de-page-setup-dlg-sub-label', innerHTML: locale.getConstant('Orientation') });\n        var orientationPropDiv = createElement('div', { id: '_orientationPropDiv', styles: 'display: flex;', className: 'e-de-page-setup-dlg-orientation-prop' });\n        var portraitDivStyles;\n        if (isRtl) {\n            portraitDivStyles = 'padding-left: 30px;';\n        }\n        else {\n            portraitDivStyles = 'padding-right: 30px;';\n        }\n        var portraitDiv = createElement('div', { id: '_portraitDiv', styles: portraitDivStyles });\n        var portrait = createElement('input', {\n            attrs: { 'type': 'radiobutton' }, id: this.target.id + '_portrait'\n        });\n        var landscapeDiv = createElement('div', { id: '_landscapeDiv' });\n        var landscape = createElement('input', {\n            attrs: { 'type': 'radiobutton' }, id: this.target.id + '_landscape'\n        });\n        portraitDiv.appendChild(portrait);\n        landscapeDiv.appendChild(landscape);\n        orientationPropDiv.appendChild(portraitDiv);\n        orientationPropDiv.appendChild(landscapeDiv);\n        orientationDiv.appendChild(orientationLabeldiv);\n        orientationDiv.appendChild(orientationPropDiv);\n        // tslint:disable-next-line:max-line-length\n        this.portrait = new RadioButton({ label: locale.getConstant('Portrait'), checked: true, enableRtl: isRtl, change: this.onPortrait });\n        this.landscape = new RadioButton({ label: locale.getConstant('Landscape'), enableRtl: isRtl, change: this.onLandscape });\n        this.portrait.appendTo(portrait);\n        this.landscape.appendTo(landscape);\n        element.appendChild(orientationDiv);\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initPaperSizeProperties = function (element, locale, isRtl) {\n        var sizeDiv = createElement('div', {\n            id: 'size_div',\n            className: 'e-de-page-setup-dlg-sub-size-container'\n        });\n        // tslint:disable-next-line:max-line-length\n        var leftSizeDiv = createElement('div', { id: 'left_size', className: 'e-de-page-setup-dlg-left-sub-container' });\n        sizeDiv.appendChild(leftSizeDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightSizeDiv = createElement('div', { className: 'e-de-page-setup-dlg-right-sub-container' });\n        sizeDiv.appendChild(rightSizeDiv);\n        if (isRtl) {\n            leftSizeDiv.classList.add('e-de-rtl');\n            rightSizeDiv.classList.add('e-de-rtl');\n        }\n        var widthLabel = createElement('label', {\n            innerHTML: locale.getConstant('Width'), className: 'e-de-page-setup-dlg-sub-header',\n            id: this.target.id + '_widthLabel', styles: 'padding-top:0px;width:190px;'\n        });\n        var widthTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_Width'\n        });\n        leftSizeDiv.appendChild(widthLabel);\n        leftSizeDiv.appendChild(widthTextBox);\n        var heightLabel = createElement('label', {\n            innerHTML: locale.getConstant('Height'), className: 'e-de-page-setup-dlg-sub-header', styles: 'padding-top:0px;width:190px;',\n            id: this.target.id + '_heightLabel'\n        });\n        var heightTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_height'\n        });\n        rightSizeDiv.appendChild(heightLabel);\n        rightSizeDiv.appendChild(heightTextBox);\n        element.appendChild(sizeDiv);\n        this.widthBox = new NumericTextBox({ value: 612, width: 170, decimals: 2 });\n        this.widthBox.appendTo(widthTextBox);\n        this.heightBox = new NumericTextBox({ value: 792, width: 170, decimals: 2 });\n        this.heightBox.appendTo(heightTextBox);\n        // tslint:disable-next-line:max-line-length\n        var paperSizeDiv = createElement('div', { id: '_paperSizeDiv', styles: 'height:37px;', className: 'e-de-page-setup-dlg-sub-container' });\n        var paperSize = createElement('select', {\n            id: this.target.id + '_papersize', styles: 'width:170px;padding-bottom: 20px;',\n            innerHTML: '<option value=\"letter\">' + locale.getConstant('Letter') +\n                '</option><option value=\"tabloid\">' + locale.getConstant('Tabloid') +\n                '</option><option value=\"legal\">' + locale.getConstant('Legal') +\n                '</option><option value=\"statement\">' + locale.getConstant('Statement') +\n                '</option><option value=\"executive\">' + locale.getConstant('Executive') +\n                '</option><option value=\"a3\">' + locale.getConstant('A3') +\n                '</option><option value=\"a4\">' + locale.getConstant('A4') +\n                '</option><option value=\"a5\">' + locale.getConstant('A5') +\n                '</option><option value=\"b4\">' + locale.getConstant('B4') +\n                '</option><option value=\"b5\">' + locale.getConstant('B5') +\n                '</option><option value=\"customsize\">' + locale.getConstant('Custom Size') + '</option>'\n        });\n        paperSizeDiv.appendChild(paperSize);\n        this.paperSize = new DropDownList({ change: this.changeByPaperSize, width: '170px', enableRtl: isRtl });\n        this.paperSize.appendTo(paperSize);\n        element.appendChild(paperSizeDiv);\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initLayoutProperties = function (element, locale, isRtl) {\n        // tslint:disable-next-line:max-line-length\n        var layoutDiv = createElement('div', { id: '_layoutDiv', className: 'e-de-page-setup-dlg-layout-sub-container', });\n        // tslint:disable-next-line:max-line-length\n        var firstPageDiv = createElement('div', { id: '_firstPageDiv', styles: 'height: 27px;', className: 'e-de-page-setup-dlg-first-page-prop' });\n        var checkBox1 = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_oddoreven'\n        });\n        firstPageDiv.appendChild(checkBox1);\n        // tslint:disable-next-line:max-line-length\n        var oddOrEvenDiv = createElement('div', { id: '_oddOrEvenDiv', styles: 'height: 27px;', className: 'e-de-page-setup-dlg-odd-or-even-prop' });\n        var checkBox2 = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_even'\n        });\n        oddOrEvenDiv.appendChild(checkBox2);\n        layoutDiv.appendChild(firstPageDiv);\n        layoutDiv.appendChild(oddOrEvenDiv);\n        this.checkBox1 = new CheckBox({ label: locale.getConstant('Different odd and even'), enableRtl: isRtl });\n        this.checkBox2 = new CheckBox({ label: locale.getConstant('Different first page'), enableRtl: isRtl });\n        this.checkBox1.appendTo(checkBox1);\n        this.checkBox2.appendTo(checkBox2);\n        element.appendChild(layoutDiv);\n        // tslint:disable-next-line:max-line-length\n        var textLabelDiv = createElement('div', { id: '_textLabelDiv', className: 'e-de-page-setup-dlg-sub-label' });\n        var textLabel = createElement('label', {\n            innerHTML: locale.getConstant('From edge'), id: this.target.id + '_textLabel'\n        });\n        textLabelDiv.appendChild(textLabel);\n        element.appendChild(textLabelDiv);\n        // tslint:disable-next-line:max-line-length\n        var propertyDiv = createElement('div', { id: '_headerFooeterPropDiv', className: 'e-de-page-setup-dlg-sub-container', styles: 'height: 65px;' });\n        // tslint:disable-next-line:max-line-length\n        var leftLayoutDiv = createElement('div', { id: '_leftLayoutDiv', className: 'e-de-page-setup-dlg-left-layout-container' });\n        propertyDiv.appendChild(leftLayoutDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightLayoutDiv = createElement('div', { className: 'e-de-page-setup-dlg-right-layout-container' });\n        propertyDiv.appendChild(rightLayoutDiv);\n        if (isRtl) {\n            rightLayoutDiv.classList.add('e-de-rtl');\n            leftLayoutDiv.classList.add('e-de-rtl');\n        }\n        var headerLabel = createElement('label', {\n            innerHTML: locale.getConstant('Header'), className: 'e-de-page-setup-dlg-sub-header',\n            id: this.target.id + '_headerLabel', styles: 'padding-top:0px;width:190px;'\n        });\n        var headerBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_header'\n        });\n        leftLayoutDiv.appendChild(headerLabel);\n        leftLayoutDiv.appendChild(headerBox);\n        var footerLabel = createElement('label', {\n            innerHTML: locale.getConstant('Footer'), className: 'e-de-page-setup-dlg-sub-header', styles: 'padding-top:0px;width:190px;',\n            id: this.target.id + '_footerLabel'\n        });\n        var footerBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_footer'\n        });\n        rightLayoutDiv.appendChild(footerLabel);\n        rightLayoutDiv.appendChild(footerBox);\n        element.appendChild(propertyDiv);\n        this.headerBox = new NumericTextBox({ value: 612, width: 170, decimals: 2 });\n        this.headerBox.appendTo(headerBox);\n        this.footerBox = new NumericTextBox({ value: 792, width: 170, decimals: 2 });\n        this.footerBox.appendTo(footerBox);\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        if (!this.target) {\n            this.initPageSetupDialog(localValue, this.owner.owner.enableRtl);\n        }\n        this.owner.dialog.header = localValue.getConstant('Page Setup');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadPageSetupDialog;\n        this.owner.dialog.close = this.closePageSetupDialog;\n        this.owner.dialog.buttons = [{\n                click: this.applyPageSetupProperties,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-layout-ppty-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-layout-ppty-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.destroy = function () {\n        if (this.topMarginBox) {\n            this.topMarginBox.destroy();\n            this.topMarginBox = undefined;\n        }\n        if (this.leftMarginBox) {\n            this.leftMarginBox.destroy();\n            this.leftMarginBox = undefined;\n        }\n        if (this.bottomMarginBox) {\n            this.bottomMarginBox.destroy();\n            this.bottomMarginBox = undefined;\n        }\n        if (this.rightMarginBox) {\n            this.rightMarginBox.destroy();\n            this.rightMarginBox = undefined;\n        }\n        if (this.headerBox) {\n            this.headerBox.destroy();\n            this.headerBox = undefined;\n        }\n        if (this.footerBox) {\n            this.footerBox.destroy();\n            this.footerBox = undefined;\n        }\n        if (this.widthBox) {\n            this.widthBox.destroy();\n            this.widthBox = undefined;\n        }\n        if (this.heightBox) {\n            this.heightBox.destroy();\n            this.heightBox = undefined;\n        }\n        if (this.paperSize) {\n            this.paperSize.destroy();\n            this.paperSize = undefined;\n        }\n        if (this.checkBox1) {\n            this.checkBox1.destroy();\n            this.checkBox1 = undefined;\n        }\n        if (this.checkBox2) {\n            this.checkBox2.destroy();\n            this.checkBox2 = undefined;\n        }\n        if (this.portrait) {\n            this.portrait.destroy();\n            this.portrait = undefined;\n        }\n        if (this.landscape) {\n            this.landscape.destroy();\n            this.landscape = undefined;\n        }\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var s = 0; s < this.target.childNodes.length; s++) {\n                this.target.removeChild(this.target.childNodes[s]);\n                s--;\n            }\n            this.target = undefined;\n        }\n    };\n    return PageSetupDialog;\n}());\nexport { PageSetupDialog };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { createElement, L10n } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { WParagraphFormat } from '../index';\nimport { RadioButton } from '@syncfusion/ej2-buttons';\n/**\n * The Paragraph dialog is used to modify formatting of selected paragraphs.\n */\nvar ParagraphDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ParagraphDialog(viewer) {\n        var _this = this;\n        //paragraph Format properties\n        this.leftIndent = undefined;\n        this.rightIndent = undefined;\n        this.beforeSpacing = undefined;\n        this.afterSpacing = undefined;\n        this.textAlignment = undefined;\n        this.firstLineIndent = undefined;\n        this.lineSpacingIn = undefined;\n        this.lineSpacingType = undefined;\n        this.paragraphFormat = undefined;\n        this.bidi = undefined;\n        /**\n         * @private\n         */\n        this.keyUpParagraphSettings = function (event) {\n            if (event.keyCode === 13) {\n                _this.applyParagraphFormat();\n            }\n        };\n        this.changeBeforeSpacing = function (event) {\n            _this.beforeSpacing = event.value;\n        };\n        this.changeAfterSpacing = function (event) {\n            _this.afterSpacing = event.value;\n        };\n        this.changeLeftIndent = function (event) {\n            _this.leftIndent = event.value;\n        };\n        this.changeRightIndent = function (event) {\n            _this.rightIndent = event.value;\n        };\n        this.changeLineSpacingValue = function (event) {\n            _this.lineSpacingIn = event.value;\n        };\n        this.changeFirstLineIndent = function (event) {\n            _this.firstLineIndent = event.value;\n        };\n        this.changeByTextAlignment = function (args) {\n            _this.textAlignment = args.value;\n        };\n        this.changeBidirectional = function (event) {\n            if (event.value === 'ltr') {\n                _this.rtlButton.checked = !_this.ltrButton.checked;\n                _this.bidi = false;\n            }\n            else {\n                _this.ltrButton.checked = !_this.rtlButton.checked;\n                _this.bidi = true;\n            }\n            _this.changeAlignmentByBidi();\n        };\n        /**\n         * @private\n         */\n        this.changeByValue = function (event) {\n            var paragraphFormat = _this.owner.selection.paragraphFormat;\n            switch (_this.special.index) {\n                case 0:\n                    if (paragraphFormat.firstLineIndent !== 0) {\n                        _this.byIn.value = 0;\n                    }\n                    break;\n                case 1:\n                    if (paragraphFormat.firstLineIndent === 0 || isNullOrUndefined(paragraphFormat.firstLineIndent)) {\n                        _this.byIn.value = 0.1;\n                    }\n                    else if (paragraphFormat.firstLineIndent < 0) {\n                        _this.byIn.value = -(paragraphFormat.firstLineIndent);\n                    }\n                    break;\n                case 2:\n                    if (paragraphFormat.firstLineIndent === 0 || isNullOrUndefined(paragraphFormat.firstLineIndent)) {\n                        paragraphFormat.firstLineIndent = -0.1;\n                    }\n                    else if (paragraphFormat.firstLineIndent > 0) {\n                        _this.byIn.value = -(paragraphFormat.firstLineIndent);\n                    }\n                    break;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeBySpacing = function (event) {\n            if (isNullOrUndefined(_this.lineSpacing)) {\n                return;\n            }\n            switch (_this.lineSpacing.index) {\n                case 0:\n                    _this.lineSpacingType = 'AtLeast';\n                    _this.atIn.value = 12;\n                    break;\n                case 1:\n                    _this.lineSpacingType = 'Exactly';\n                    _this.atIn.value = 12;\n                    break;\n                case 2:\n                    _this.lineSpacingType = 'Multiple';\n                    _this.atIn.value = 1;\n                    break;\n            }\n        };\n        /* tslint:enable */\n        /**\n         * @private\n         */\n        this.loadParagraphDialog = function () {\n            var selectionFormat;\n            if (_this.paragraphFormat) {\n                selectionFormat = _this.paragraphFormat;\n            }\n            else {\n                selectionFormat = _this.owner.selection.paragraphFormat;\n            }\n            var alignValue = _this.getAlignmentValue(selectionFormat.textAlignment);\n            _this.alignment.index = alignValue;\n            _this.beforeSpacingIn.value = selectionFormat.beforeSpacing;\n            _this.afterSpacingIn.value = selectionFormat.afterSpacing;\n            _this.leftIndentIn.value = selectionFormat.leftIndent;\n            _this.rightIndentIn.value = selectionFormat.rightIndent;\n            _this.byIn.value = selectionFormat.firstLineIndent;\n            var lineSpaceValue = _this.lineSpacing.index;\n            if (selectionFormat.lineSpacingType === 'AtLeast') {\n                lineSpaceValue = 0;\n            }\n            else if (selectionFormat.lineSpacingType === 'Exactly') {\n                lineSpaceValue = 1;\n            }\n            else {\n                lineSpaceValue = 2;\n            }\n            _this.lineSpacing.index = lineSpaceValue;\n            _this.atIn.value = selectionFormat.lineSpacing;\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n            if (selectionFormat.bidi) {\n                _this.rtlButton.checked = true;\n                _this.ltrButton.checked = false;\n            }\n            else {\n                _this.ltrButton.checked = true;\n                _this.rtlButton.checked = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyParagraphFormat = function () {\n            var paraFormat;\n            var isApply;\n            if (_this.paragraphFormat) {\n                paraFormat = _this.paragraphFormat;\n                isApply = false;\n            }\n            else {\n                paraFormat = new WParagraphFormat();\n                isApply = true;\n            }\n            if (!isNullOrUndefined(_this.beforeSpacing)) {\n                paraFormat.beforeSpacing = _this.beforeSpacing;\n            }\n            if (!isNullOrUndefined(_this.afterSpacing)) {\n                paraFormat.afterSpacing = _this.afterSpacing;\n            }\n            if (!isNullOrUndefined(_this.lineSpacingType)) {\n                paraFormat.lineSpacingType = _this.lineSpacingType;\n            }\n            if (!isNullOrUndefined(_this.leftIndent)) {\n                paraFormat.leftIndent = _this.leftIndent;\n            }\n            if (!isNullOrUndefined(_this.rightIndent)) {\n                paraFormat.rightIndent = _this.rightIndent;\n            }\n            if (!isNullOrUndefined(_this.lineSpacingIn)) {\n                paraFormat.lineSpacing = _this.lineSpacingIn;\n            }\n            if (!isNullOrUndefined(_this.firstLineIndent)) {\n                paraFormat.firstLineIndent = _this.firstLineIndent;\n            }\n            if (!isNullOrUndefined(_this.bidi)) {\n                paraFormat.bidi = _this.bidi;\n            }\n            if (!isNullOrUndefined(_this.textAlignment)) {\n                paraFormat.textAlignment = _this.textAlignment;\n            }\n            if (isApply) {\n                _this.onParagraphFormat(paraFormat);\n            }\n            else {\n                _this.owner.owner.styleDialogModule.updateParagraphFormat();\n            }\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.closeParagraphDialog = function () {\n            _this.leftIndent = undefined;\n            _this.afterSpacing = undefined;\n            _this.beforeSpacing = undefined;\n            _this.firstLineIndent = undefined;\n            _this.textAlignment = undefined;\n            _this.rightIndent = undefined;\n            _this.lineSpacingIn = undefined;\n            _this.lineSpacingType = undefined;\n            _this.paragraphFormat = undefined;\n            _this.owner.dialog.hide();\n            _this.owner.updateFocus();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.getModuleName = function () {\n        return 'ParagraphDialog';\n    };\n    /*tslint:disable max-func-body-length*/\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.initParagraphDialog = function (locale) {\n        var instance = this;\n        var ownerId = this.owner.owner.containerId;\n        var id = ownerId + '_paragraph_dialog';\n        this.target = createElement('div', { id: id, className: 'e-de-para-dlg-container' });\n        // tslint:disable-next-line:max-line-length\n        var div = createElement('div', { id: 'property_div', styles: 'width:400px;' });\n        var generalDiv = createElement('div', { id: 'genral_div', className: 'e-de-para-dlg-sub-container' });\n        // tslint:disable-next-line:max-line-length\n        var genLabel = createElement('div', { id: ownerId + '_genLabel', className: 'e-de-para-dlg-heading', innerHTML: locale.getConstant('General') });\n        var alignLabel = createElement('div', { id: ownerId + '_AlignLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Alignment') });\n        var alignment = createElement('select', {\n            id: ownerId + '_Alignment',\n            innerHTML: '<option value=\"Center\">' + locale.getConstant('Center') +\n                '</option><option value=\"Left\">' + locale.getConstant('Left') +\n                '</option><option value=\"Right\">' + locale.getConstant('Right') +\n                '</option><option value=\"Justify\">' + locale.getConstant('Justify') + '</option>'\n        });\n        generalDiv.appendChild(genLabel);\n        generalDiv.appendChild(alignLabel);\n        generalDiv.appendChild(alignment);\n        var dirLabel = createElement('div', {\n            id: ownerId + '_DirLabel',\n            className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Direction')\n        });\n        var dirDiv = createElement('div', { id: ownerId + '_DirDiv', styles: 'display:flex' });\n        var rtlDiv = createElement('div', { id: ownerId + '_DirDiv', className: 'e-de-rtl-btn-div' });\n        var rtlInputELe = createElement('input', { id: ownerId + '_rtlEle' });\n        rtlDiv.appendChild(rtlInputELe);\n        dirDiv.appendChild(rtlDiv);\n        var isRtl = this.owner.owner.enableRtl;\n        if (isRtl) {\n            rtlDiv.classList.add('e-de-rtl');\n        }\n        var ltrDiv = createElement('div', { id: ownerId + '_DirDiv', className: 'e-de-ltr-btn-div' });\n        var ltrInputELe = createElement('input', { id: ownerId + '_ltrEle' });\n        ltrDiv.appendChild(ltrInputELe);\n        dirDiv.appendChild(ltrDiv);\n        generalDiv.appendChild(dirLabel);\n        generalDiv.appendChild(dirDiv);\n        this.rtlButton = new RadioButton({\n            label: locale.getConstant('Right-to-left'), enableRtl: isRtl,\n            value: 'rtl', cssClass: 'e-small', change: this.changeBidirectional\n        });\n        this.rtlButton.appendTo(rtlInputELe);\n        this.ltrButton = new RadioButton({\n            label: locale.getConstant('Left-to-right'), enableRtl: isRtl,\n            value: 'ltr', cssClass: 'e-small', change: this.changeBidirectional\n        });\n        this.ltrButton.appendTo(ltrInputELe);\n        // tslint:disable-next-line:max-line-length\n        var indentionDiv = createElement('div', { id: 'indention_div', styles: 'width: 400px;', className: 'e-de-para-dlg-sub-container e-para-dlg-sub-height' });\n        var leftIndentionDiv = createElement('div', { id: 'left_indention', styles: 'float:left;position:relative;' });\n        indentionDiv.appendChild(leftIndentionDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightIndentionDiv = createElement('div', { className: 'e-de-para-dlg-right-sub-container', styles: 'float:right;position:relative;' });\n        indentionDiv.appendChild(rightIndentionDiv);\n        // tslint:disable-next-line:max-line-length\n        var spacingDiv = createElement('div', { id: 'spacing_div', styles: 'width: 400px;height: 150px;', className: 'e-de-para-dlg-sub-container' });\n        var leftSpacingDiv = createElement('div', { id: 'left_spacing', styles: 'float:left;position:relative;' });\n        spacingDiv.appendChild(leftSpacingDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightSpacingDiv = createElement('div', { className: 'e-de-para-dlg-right-sub-container', styles: 'float:right;position:relative;' });\n        spacingDiv.appendChild(rightSpacingDiv);\n        // tslint:disable-next-line:max-line-length\n        var indentLabel = createElement('div', {\n            id: ownerId + '_indentLabel', className: 'e-de-para-dlg-heading', innerHTML: locale.getConstant('Indentation')\n        });\n        var beforeTextLabel = createElement('div', {\n            id: ownerId + '_bfTextLabel',\n            className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Before text')\n        });\n        // tslint:disable-next-line:max-line-length\n        var leftIndent = createElement('input', { id: ownerId + '_leftIndent', attrs: { 'type': 'text' } });\n        var specialLabel = createElement('div', { id: ownerId + '_specialLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Special') });\n        var special = createElement('select', {\n            id: ownerId + '_special',\n            innerHTML: '<option value=\"None\">' + locale.getConstant('None') +\n                '</option><option value=\"First Line\">' + locale.getConstant('First line') +\n                '</option><option value=\"Hanging\">' + locale.getConstant('Hanging') + '</option> '\n        });\n        leftIndentionDiv.appendChild(indentLabel);\n        leftIndentionDiv.appendChild(beforeTextLabel);\n        leftIndentionDiv.appendChild(leftIndent);\n        leftIndentionDiv.appendChild(specialLabel);\n        leftIndentionDiv.appendChild(special);\n        // tslint:disable-next-line:max-line-length\n        var afterTextLabel = createElement('div', { id: ownerId + '_afTextLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('After text') });\n        var rightIndent = createElement('input', { id: ownerId + '_rightIndent', attrs: { 'type': 'text' } });\n        // tslint:disable-next-line:max-line-length\n        var byLabel = createElement('label', { id: ownerId + '_byLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('By') });\n        var by = createElement('input', { id: ownerId + '_By', attrs: { 'type': 'text' } });\n        rightIndentionDiv.appendChild(afterTextLabel);\n        rightIndentionDiv.appendChild(rightIndent);\n        rightIndentionDiv.appendChild(byLabel);\n        rightIndentionDiv.appendChild(by);\n        // tslint:disable-next-line:max-line-length\n        var spaceLabel = createElement('div', { innerHTML: locale.getConstant('Spacing'), className: 'e-de-para-dlg-heading', id: ownerId + '_spaceLabel' });\n        var beforeLabel = createElement('div', { className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Before'), id: ownerId + '_beforeLabel' });\n        // tslint:disable-next-line:max-line-length\n        var beforeSpacing = createElement('input', { id: ownerId + '_beforeSpacing', attrs: { 'type': 'text' } });\n        var lineSpaceLabel = createElement('div', { id: ownerId + '_lineSpaceLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Line Spacing') });\n        // tslint:disable-next-line:max-line-length\n        var lineSpacing = createElement('select', {\n            id: ownerId + '_lineSpacing', styles: 'width:180px;',\n            innerHTML: '<option value=\"At least\">' + locale.getConstant('At least') +\n                '</option><option value=\"Exactly\">' + locale.getConstant('Exactly') +\n                '</option><option value=\"Multiple\">' + locale.getConstant('Multiple') + '</option>'\n        });\n        leftSpacingDiv.appendChild(spaceLabel);\n        leftSpacingDiv.appendChild(beforeLabel);\n        leftSpacingDiv.appendChild(beforeSpacing);\n        leftSpacingDiv.appendChild(lineSpaceLabel);\n        leftSpacingDiv.appendChild(lineSpacing);\n        // tslint:disable-next-line:max-line-length\n        var afterLabel = createElement('div', { innerHTML: locale.getConstant('After'), className: 'e-de-dlg-sub-header', id: ownerId + '_afterLabel' });\n        var afterSpacing = createElement('input', { id: ownerId + '_afterSpacing', attrs: { 'type': 'text' } });\n        // tslint:disable-next-line:max-line-length\n        var atLabel = createElement('div', { innerHTML: locale.getConstant('At'), id: ownerId + '_atLabel', className: 'e-de-dlg-sub-header' });\n        var lineSpacingAt = createElement('input', { id: ownerId + '_lineSpacingAt', attrs: { 'type': 'text' } });\n        rightSpacingDiv.appendChild(afterLabel);\n        rightSpacingDiv.appendChild(afterSpacing);\n        rightSpacingDiv.appendChild(atLabel);\n        rightSpacingDiv.appendChild(lineSpacingAt);\n        div.appendChild(generalDiv);\n        div.appendChild(indentionDiv);\n        div.appendChild(spacingDiv);\n        this.target.appendChild(div);\n        this.leftIndentIn = new NumericTextBox({\n            format: 'n1', value: 0, min: -1584, max: 1584, width: 180, enablePersistence: false, change: this.changeLeftIndent\n        });\n        this.leftIndentIn.appendTo(leftIndent);\n        this.rightIndentIn = new NumericTextBox({\n            format: 'n1', value: 0, min: -1584, max: 1584, width: 180, enablePersistence: false, change: this.changeRightIndent\n        });\n        this.rightIndentIn.appendTo(rightIndent);\n        this.byIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 0, max: 1584, width: 180, enablePersistence: false, change: this.changeFirstLineIndent\n        });\n        this.byIn.appendTo(by);\n        this.beforeSpacingIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 0, max: 1584, width: 180, step: 6, enablePersistence: false,\n            change: this.changeBeforeSpacing\n        });\n        this.beforeSpacingIn.appendTo(beforeSpacing);\n        this.afterSpacingIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 0, max: 1584, width: 180, step: 6, enablePersistence: false,\n            change: this.changeAfterSpacing\n        });\n        this.afterSpacingIn.appendTo(afterSpacing);\n        this.atIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 1, max: 1584, width: 180, step: 0.5, enablePersistence: false, change: this.changeLineSpacingValue\n        });\n        this.special = new DropDownList({ change: this.changeByValue, width: 180, enableRtl: isRtl });\n        this.special.appendTo(special);\n        this.lineSpacing = new DropDownList({ change: this.changeBySpacing, width: '180px', enableRtl: isRtl });\n        this.lineSpacing.appendTo(lineSpacing);\n        this.alignment = new DropDownList({ width: 180, change: this.changeByTextAlignment, enableRtl: isRtl });\n        this.alignment.appendTo(alignment);\n        this.atIn.appendTo(lineSpacingAt);\n        this.target.addEventListener('keyup', instance.keyUpParagraphSettings);\n    };\n    ParagraphDialog.prototype.changeAlignmentByBidi = function () {\n        if (this.textAlignment === 'Left') {\n            this.textAlignment = 'Right';\n        }\n        else if (this.textAlignment === 'Right') {\n            this.textAlignment = 'Left';\n        }\n        if (!isNullOrUndefined(this.textAlignment)) {\n            this.alignment.index = this.getAlignmentValue(this.textAlignment);\n        }\n        else {\n            if (this.alignment.index === 0) {\n                this.textAlignment = 'Center';\n            }\n            else {\n                this.textAlignment = 'Justify';\n            }\n        }\n    };\n    ParagraphDialog.prototype.getAlignmentValue = function (textAlignment) {\n        var alignValue;\n        if (textAlignment === 'Center') {\n            alignValue = 0;\n        }\n        else if (textAlignment === 'Left') {\n            alignValue = 1;\n        }\n        else if (textAlignment === 'Right') {\n            alignValue = 2;\n        }\n        else {\n            alignValue = 3;\n        }\n        return alignValue;\n    };\n    /**\n     * Applies Paragraph Format\n     * @param  {WParagraphFormat} paragraphFormat\n     * @private\n     */\n    ParagraphDialog.prototype.onParagraphFormat = function (paragraphFormat) {\n        this.owner.layout.isBidiReLayout = true;\n        this.owner.owner.editorModule.initHistory('ParagraphFormat');\n        var selection = this.owner.selection;\n        this.owner.owner.isShiftingEnabled = true;\n        if (this.owner.selection.isEmpty) {\n            this.owner.owner.editorModule.applyParaFormatProperty(selection.start.paragraph, undefined, paragraphFormat, false);\n            this.owner.owner.editor.layoutItemBlock(selection.start.paragraph, false);\n        }\n        else {\n            this.owner.owner.editorModule.updateSelectionParagraphFormatting('ParagraphFormat', paragraphFormat, false);\n        }\n        this.owner.owner.editorModule.reLayout(selection);\n        this.owner.layout.isBidiReLayout = false;\n    };\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.show = function (paragraphFormat) {\n        if (paragraphFormat) {\n            this.paragraphFormat = paragraphFormat;\n        }\n        var local = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        local.setLocale(this.owner.owner.locale);\n        if (!this.target) {\n            this.initParagraphDialog(local);\n        }\n        this.loadParagraphDialog();\n        this.owner.dialog.header = local.getConstant('Paragraph');\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.buttons = [{\n                click: this.applyParagraphFormat,\n                buttonModel: { content: local.getConstant('Ok'), cssClass: 'e-flat e-para-okay', isPrimary: true }\n            },\n            {\n                click: this.closeParagraphDialog,\n                buttonModel: { content: local.getConstant('Cancel'), cssClass: 'e-flat e-para-cancel' }\n            }];\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.destroy = function () {\n        if (this.afterSpacingIn) {\n            this.afterSpacingIn.destroy();\n            this.afterSpacingIn = undefined;\n        }\n        if (this.beforeSpacingIn) {\n            this.beforeSpacingIn.destroy();\n            this.beforeSpacingIn = undefined;\n        }\n        if (this.leftIndentIn) {\n            this.leftIndentIn.destroy();\n            this.leftIndentIn = undefined;\n        }\n        if (this.rightIndentIn) {\n            this.rightIndentIn.destroy();\n            this.rightIndentIn = undefined;\n        }\n        if (this.byIn) {\n            this.byIn.destroy();\n            this.byIn = undefined;\n        }\n        if (this.atIn) {\n            this.atIn.destroy();\n            this.atIn = undefined;\n        }\n        if (this.alignment) {\n            this.alignment.change = undefined;\n            this.alignment.destroy();\n        }\n        this.alignment = undefined;\n        if (this.lineSpacing) {\n            this.lineSpacing.change = undefined;\n            this.lineSpacing.destroy();\n        }\n        this.lineSpacing = undefined;\n        if (this.special) {\n            this.special.change = undefined;\n            this.special.destroy();\n        }\n        this.special = undefined;\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var q = 0; q < this.target.childNodes.length; q++) {\n                this.target.removeChild(this.target.childNodes[q]);\n                q--;\n            }\n            this.target = undefined;\n        }\n    };\n    return ParagraphDialog;\n}());\nexport { ParagraphDialog };\n","import { createElement, isNullOrUndefined, L10n } from '@syncfusion/ej2-base';\nimport { DropDownList, ComboBox } from '@syncfusion/ej2-dropdowns';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { WCharacterStyle, WParagraphStyle } from '../../implementation/format/style';\nimport { BulletsAndNumberingDialog } from './index';\nimport { WAbstractList } from '../list/abstract-list';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\n/**\n * The Style dialog is used to create or modify styles.\n */\nvar StyleDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function StyleDialog(viewer) {\n        var _this = this;\n        this.target = undefined;\n        this.styleType = undefined;\n        this.styleBasedOn = undefined;\n        this.styleParagraph = undefined;\n        this.onlyThisDocument = undefined;\n        this.template = undefined;\n        this.fontFamily = undefined;\n        this.fontSize = undefined;\n        this.characterFormat = undefined;\n        this.paragraphFormat = undefined;\n        /* tslint:disable-next-line:no-any */\n        this.openDialog = function (args) {\n            switch (args.item.id) {\n                case 'style_font':\n                    _this.showFontDialog();\n                    break;\n                case 'style_paragraph':\n                    _this.showParagraphDialog();\n                    break;\n                case 'style_numbering':\n                    _this.showNumberingBulletDialog();\n                    break;\n            }\n        };\n        this.setBoldProperty = function () {\n            _this.characterFormat.bold = !_this.characterFormat.bold;\n            _this.fontButtonClicked(undefined);\n        };\n        this.setItalicProperty = function () {\n            _this.characterFormat.italic = !_this.characterFormat.italic;\n            _this.fontButtonClicked(undefined);\n        };\n        this.setUnderlineProperty = function () {\n            _this.characterFormat.underline = _this.characterFormat.underline === 'None' ? 'Single' : 'None';\n            _this.fontButtonClicked(undefined);\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontButtonClicked = function (args) {\n            if (_this.characterFormat.bold) {\n                if (!_this.bold.classList.contains('e-active')) {\n                    _this.bold.classList.add('e-active');\n                }\n            }\n            else {\n                if (_this.bold.classList.contains('e-active')) {\n                    _this.bold.classList.remove('e-active');\n                }\n            }\n            if (_this.characterFormat.italic) {\n                if (!_this.italic.classList.contains('e-active')) {\n                    _this.italic.classList.add('e-active');\n                }\n            }\n            else {\n                if (_this.italic.classList.contains('e-active')) {\n                    _this.italic.classList.remove('e-active');\n                }\n            }\n            if (_this.characterFormat.underline !== undefined && _this.characterFormat.underline !== 'None') {\n                if (!_this.underline.classList.contains('e-active')) {\n                    _this.underline.classList.add('e-active');\n                    _this.characterFormat.underline = 'Single';\n                }\n            }\n            else {\n                if (_this.underline.classList.contains('e-active')) {\n                    _this.underline.classList.remove('e-active');\n                    _this.characterFormat.underline = 'None';\n                }\n            }\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontSizeUpdate = function (args) {\n            _this.characterFormat.fontSize = args.value;\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontFamilyChanged = function (args) {\n            _this.characterFormat.fontFamily = args.value;\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontColorUpdate = function (args) {\n            _this.characterFormat.fontColor = args.currentValue.rgba;\n        };\n        this.setLeftAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Left') {\n                _this.paragraphFormat.textAlignment = 'Justify';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.setRightAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Right') {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Right';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.setCenterAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Center') {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Center';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.setJustifyAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Justify') {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Justify';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.increaseBeforeAfterSpacing = function () {\n            _this.paragraphFormat.beforeSpacing += 6;\n            _this.paragraphFormat.afterSpacing += 6;\n        };\n        this.decreaseBeforeAfterSpacing = function () {\n            if (_this.paragraphFormat.beforeSpacing >= 6) {\n                _this.paragraphFormat.beforeSpacing -= 6;\n            }\n            else {\n                _this.paragraphFormat.beforeSpacing = 0;\n            }\n            if (_this.paragraphFormat.afterSpacing >= 6) {\n                _this.paragraphFormat.afterSpacing -= 6;\n            }\n            else {\n                _this.paragraphFormat.afterSpacing = 0;\n            }\n        };\n        /**\n         * @private\n         */\n        this.updateNextStyle = function (args) {\n            var typedName = args.srcElement.value;\n            // tslint:disable-next-line:max-line-length\n            if (_this.getTypeValue() === _this.localObj.getConstant('Paragraph') && !isNullOrUndefined(typedName) && typedName !== '' && !_this.isUserNextParaUpdated) {\n                var styles = _this.owner.owner.viewer.styles.getStyleNames(_this.getTypeValue());\n                if (_this.isEdit) {\n                    styles = styles.filter(function (e) { return e !== _this.editStyleName; });\n                }\n                styles.push(typedName);\n                _this.styleParagraph.dataSource = styles;\n                _this.styleParagraph.index = null;\n                _this.styleParagraph.index = styles.indexOf(typedName);\n                _this.styleParagraph.dataBind();\n            }\n        };\n        /**\n         * @private\n         */\n        this.updateOkButton = function () {\n            var styleName = _this.target.getElementsByClassName('e-input e-de-style-dlg-name-input').item(0).value;\n            _this.enableOrDisableOkButton();\n        };\n        /**\n         * @private\n         */\n        /* tslint:disable-next-line:no-any */\n        this.styleTypeChange = function (args) {\n            if (args.isInteracted) {\n                var type = void 0;\n                if (args.value === _this.localObj.getConstant('Character')) {\n                    _this.style = new WCharacterStyle();\n                    type = 'Character';\n                }\n                // tslint:disable-next-line:max-line-length\n                if (args.value === _this.localObj.getConstant('Paragraph') || args.value === _this.localObj.getConstant('Linked(Paragraph and Character)')) {\n                    _this.style = new WParagraphStyle();\n                    type = 'Paragraph';\n                }\n                _this.toggleDisable();\n                _this.updateStyleNames(type);\n            }\n        };\n        /* tslint:disable-next-line:no-any */\n        this.styleBasedOnChange = function (args) {\n            //Based on change\n        };\n        /**\n         * @private\n         */\n        /* tslint:disable-next-line:no-any */\n        this.styleParagraphChange = function (args) {\n            if (args.isInteracted) {\n                _this.isUserNextParaUpdated = true;\n            }\n            //Next change\n        };\n        /**\n         * @private\n         */\n        this.showFontDialog = function () {\n            if (!isNullOrUndefined(_this.owner.owner.fontDialogModule)) {\n                _this.owner.owner.showFontDialog(_this.characterFormat);\n            }\n            _this.updateCharacterFormat();\n        };\n        /**\n         * @private\n         */\n        this.showParagraphDialog = function () {\n            if (!isNullOrUndefined(_this.owner.owner.paragraphDialogModule)) {\n                _this.owner.owner.showParagraphDialog(_this.paragraphFormat);\n            }\n        };\n        /**\n         * @private\n         */\n        this.showNumberingBulletDialog = function () {\n            _this.numberingBulletDialog = new BulletsAndNumberingDialog(_this.owner.owner.viewer);\n            if (_this.style instanceof WParagraphStyle && (!isNullOrUndefined(_this.style.paragraphFormat))) {\n                // tslint:disable-next-line:max-line-length\n                _this.numberingBulletDialog.showNumberBulletDialog(_this.style.paragraphFormat.listFormat, _this.abstractList);\n            }\n        };\n        /**\n         * @private\n         */\n        this.onOkButtonClick = function () {\n            var styleName = _this.styleNameElement.value;\n            if (styleName.length > 0) {\n                var style = _this.owner.owner.viewer.styles.findByName(styleName);\n                var name_1;\n                if (!isNullOrUndefined(style)) {\n                    _this.style.type = _this.getTypeValue();\n                    _this.style.basedOn = _this.owner.owner.viewer.styles.findByName(_this.styleBasedOn.value);\n                    // tslint:disable-next-line:max-line-length\n                    if (_this.styleType.value === _this.localObj.getConstant('Paragraph') || _this.styleType.value === _this.localObj.getConstant('Linked(Paragraph and Character)')) {\n                        _this.style.next = _this.owner.owner.viewer.styles.findByName(_this.styleParagraph.value);\n                        _this.style.characterFormat.mergeFormat(style.characterFormat);\n                        _this.style.paragraphFormat.mergeFormat(style.paragraphFormat);\n                        _this.updateList();\n                        // tslint:disable-next-line:max-line-length\n                        _this.style.link = (_this.styleType.value === _this.localObj.getConstant('Linked(Paragraph and Character)')) ? _this.createLinkStyle(styleName, _this.isEdit) : undefined;\n                    }\n                    //Updating existing style implementation\n                    _this.style.name = style.name;\n                    name_1 = style.name;\n                    style = _this.style;\n                    _this.owner.owner.isShiftingEnabled = true;\n                    _this.owner.owner.editorModule.layoutWholeDocument();\n                    _this.owner.owner.isShiftingEnabled = false;\n                }\n                else {\n                    /* tslint:disable-next-line:no-any */\n                    var basedOn = _this.owner.owner.viewer.styles.findByName(_this.styleBasedOn.value);\n                    // tslint:disable-next-line:max-line-length\n                    if (_this.styleType.value === _this.localObj.getConstant('Paragraph') || _this.styleType.value === _this.localObj.getConstant('Linked(Paragraph and Character)')) {\n                        if (styleName === _this.styleParagraph.value) {\n                            _this.style.next = _this.style;\n                        }\n                        else {\n                            _this.style.next = _this.owner.owner.viewer.styles.findByName(_this.styleParagraph.value);\n                        }\n                        _this.updateList();\n                    }\n                    // tslint:disable-next-line:max-line-length\n                    _this.style.link = (_this.styleType.value === _this.localObj.getConstant('Linked(Paragraph and Character)')) ? _this.createLinkStyle(styleName) : undefined;\n                    _this.style.type = _this.getTypeValue();\n                    _this.style.name = styleName;\n                    _this.style.basedOn = basedOn;\n                    /* tslint:disable-next-line:no-any */\n                    _this.owner.owner.viewer.styles.push(_this.style);\n                    name_1 = styleName;\n                    _this.owner.owner.editorModule.applyStyle(name_1);\n                }\n                _this.owner.owner.viewer.dialog2.hide();\n            }\n            else {\n                throw new Error('Enter valid Style name');\n            }\n            if (_this.style) {\n                //this.style.destroy();\n            }\n        };\n        /* tslint:disable-next-line:no-any */\n        this.loadStyleDialog = function (args) {\n            _this.owner.owner.viewer.updateFocus();\n            _this.isUserNextParaUpdated = false;\n            /* tslint:disable-next-line:max-line-length */\n            _this.styleNameElement = _this.target.getElementsByClassName('e-input e-de-style-dlg-name-input').item(0);\n            _this.styleNameElement.value = null;\n            if (!_this.isEdit) {\n                _this.styleType.index = 0; //Set to paragraph            \n            }\n            var name;\n            if (_this.isEdit) {\n                _this.styleNameElement.value = _this.editStyleName;\n                name = _this.editStyleName;\n            }\n            /* tslint:disable-next-line:max-line-length */\n            _this.okButton = _this.owner.dialog2.element.getElementsByClassName('e-flat e-style-okay').item(0);\n            _this.enableOrDisableOkButton();\n            _this.updateStyleNames(_this.getTypeValue(), name);\n            _this.updateCharacterFormat(_this.style.characterFormat);\n            _this.updateParagraphFormat(_this.style.paragraphFormat);\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            if (!_this.isEdit && _this.style) {\n                _this.style.destroy();\n            }\n            _this.owner.owner.viewer.dialog2.hide();\n        };\n        /**\n         * @private\n         */\n        this.closeStyleDialog = function () {\n            _this.owner.owner.viewer.updateFocus();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    StyleDialog.prototype.getModuleName = function () {\n        return 'StyleDialog';\n    };\n    /**\n     * @private\n     */\n    //tslint:disable: max-func-body-length\n    StyleDialog.prototype.initStyleDialog = function (localValue, isRtl) {\n        var instance = this;\n        this.localObj = localValue;\n        var id = this.owner.owner.containerId + '_style';\n        this.target = createElement('div', { id: id, className: 'e-de-style-dialog' });\n        var container = createElement('div');\n        // tslint:disable-next-line:max-line-length\n        var properties = createElement('div', { className: 'e-de-style-properties', innerHTML: localValue.getConstant('Properties') });\n        container.appendChild(properties);\n        var styleNameTypeDiv = createElement('div', { styles: 'display:flex', className: 'e-de-style-nametype-div' });\n        container.appendChild(styleNameTypeDiv);\n        var nameWholeDiv = createElement('div', { className: 'e-de-style-left-div' });\n        styleNameTypeDiv.appendChild(nameWholeDiv);\n        var name = createElement('div', { className: 'e-de-style-name', innerHTML: localValue.getConstant('Name') + ':' });\n        nameWholeDiv.appendChild(name);\n        // tslint:disable-next-line:max-line-length\n        var nameValue = createElement('input', { id: this.owner.owner.containerId + '_style_name', styles: 'width:210px;', className: 'e-input e-de-style-dlg-name-input' });\n        nameValue.addEventListener('keyup', this.updateOkButton);\n        nameValue.addEventListener('input', this.updateOkButton);\n        nameValue.addEventListener('blur', this.updateNextStyle);\n        nameWholeDiv.appendChild(nameValue);\n        var styleTypeWholeDiv = createElement('div');\n        styleNameTypeDiv.appendChild(styleTypeWholeDiv);\n        // tslint:disable-next-line:max-line-length\n        var styleType = createElement('div', { className: 'e-de-style-styletype', innerHTML: localValue.getConstant('Style type') + ':' });\n        styleTypeWholeDiv.appendChild(styleType);\n        var styleTypeDivElement = createElement('div', { className: 'e-de-style-style-type-div' });\n        var styleTypeValue = createElement('select', { id: 'e-de-style-style-type' });\n        // tslint:disable-next-line:max-line-length\n        styleTypeValue.innerHTML = '<option>' + localValue.getConstant('Paragraph') + '</option><option>' + localValue.getConstant('Character') + '</option><option>' + localValue.getConstant('Linked(Paragraph and Character)') + '</option>'; //<option>Linked(Paragraph and Character)</option><option>Table</option><option>List</option>';\n        styleTypeDivElement.appendChild(styleTypeValue);\n        this.styleType = new DropDownList({ change: this.styleTypeChange, popupHeight: '253px', width: '210px', enableRtl: isRtl });\n        this.styleType.appendTo(styleTypeValue);\n        styleTypeWholeDiv.appendChild(styleTypeDivElement);\n        // tslint:disable-next-line:max-line-length\n        var styleBasedParaDiv = createElement('div', { styles: 'display:flex', className: 'e-de-style-based-para-div' });\n        container.appendChild(styleBasedParaDiv);\n        var styleBasedOnWholeDiv = createElement('div', { className: 'e-de-style-left-div' });\n        styleBasedParaDiv.appendChild(styleBasedOnWholeDiv);\n        // tslint:disable-next-line:max-line-length\n        var styleBasedOn = createElement('div', { className: 'e-de-style-style-based-on', innerHTML: localValue.getConstant('Style based on') + ':' });\n        styleBasedOnWholeDiv.appendChild(styleBasedOn);\n        var styleBasedOnDivElement = createElement('div', { className: 'e-de-style-style-based-on-div' });\n        // tslint:disable-next-line:max-line-length\n        var styleBasedOnValue = createElement('input', { id: 'e-de-style-style-based-on-value' });\n        //styleBasedOnValue.innerHTML = '<option>Normal</option><option>Heading 1</option><option>Heading 2</option><option>Heading 3</option><option>Heading 4</option><option>Heading 5</option><option>Heading 6</option>';\n        styleBasedOnDivElement.appendChild(styleBasedOnValue);\n        // tslint:disable-next-line:max-line-length\n        this.styleBasedOn = new DropDownList({ dataSource: [], select: this.styleBasedOnChange, popupHeight: '253px', width: '210px', enableRtl: isRtl });\n        this.styleBasedOn.appendTo(styleBasedOnValue);\n        styleBasedOnWholeDiv.appendChild(styleBasedOnDivElement);\n        var styleParagraphWholeDiv = createElement('div', { className: 'e-de-style-left-div' });\n        styleBasedParaDiv.appendChild(styleParagraphWholeDiv);\n        if (isRtl) {\n            nameWholeDiv.classList.add('e-de-rtl');\n            styleBasedOnWholeDiv.classList.add('e-de-rtl');\n            styleParagraphWholeDiv.classList.add('e-de-rtl');\n        }\n        // tslint:disable-next-line:max-line-length\n        var styleParagraph = createElement('div', { className: 'e-de-style-style-paragraph', innerHTML: localValue.getConstant('Style for following paragraph') + ':' });\n        styleParagraphWholeDiv.appendChild(styleParagraph);\n        var styleParagraphDivElement = createElement('div', { className: 'e-de-style-style-paragraph-div' });\n        // tslint:disable-next-line:max-line-length\n        var styleParagraphValue = createElement('input', { id: 'e-de-style-style-paragraph-value' });\n        // tslint:disable-next-line:max-line-length\n        //styleParagraphValue.innerHTML = '<option>Normal</option><option>Heading 1</option><option>Heading 2</option><option>Heading 3</option><option>Heading 4</option><option>Heading 5</option><option>Heading 6</option>';\n        styleParagraphDivElement.appendChild(styleParagraphValue);\n        // tslint:disable-next-line:max-line-length\n        this.styleParagraph = new DropDownList({ dataSource: [], select: this.styleParagraphChange, popupHeight: '253px', width: '210px', enableRtl: isRtl });\n        this.styleParagraph.appendTo(styleParagraphValue);\n        styleParagraphWholeDiv.appendChild(styleParagraphDivElement);\n        // tslint:disable-next-line:max-line-length\n        var formatting = createElement('div', { className: 'e-de-style-formatting', innerHTML: localValue.getConstant('Formatting') });\n        container.appendChild(formatting);\n        var optionsDiv = createElement('div', { className: 'e-de-style-options-div' });\n        container.appendChild(optionsDiv);\n        var fontOptionsDiv = createElement('div', { styles: 'display:flex;margin-bottom: 15px;' });\n        optionsDiv.appendChild(fontOptionsDiv);\n        this.createFontOptions(fontOptionsDiv, isRtl);\n        var paragraphOptionsDiv = createElement('div', { styles: 'display:flex', className: 'e-style-paragraph' });\n        optionsDiv.appendChild(paragraphOptionsDiv);\n        this.createParagraphOptions(paragraphOptionsDiv);\n        // let radioOptionsDiv: HTMLElement = createElement('div', { styles: 'display:flex' });\n        // container.appendChild(radioOptionsDiv);\n        // let onlyThisDocumentDiv: HTMLElement = createElement('div', { className: 'e-de-style-radio-button' });\n        // tslint:disable-next-line:max-line-length\n        // let onlyThisDocument: HTMLInputElement = createElement('input', { className: 'e-de-style-only-this-doc', attrs: { type: 'radio' } }) as HTMLInputElement;\n        // onlyThisDocumentDiv.appendChild(onlyThisDocument);\n        // tslint:disable-next-line:max-line-length\n        // this.onlyThisDocument = new RadioButton({ label: 'Only in this document', value: 'only in this document', checked: true, name: 'styles' });\n        // this.onlyThisDocument.appendTo(onlyThisDocument);\n        // radioOptionsDiv.appendChild(onlyThisDocumentDiv);\n        // let templateDiv: HTMLElement = createElement('div', { className: 'e-de-style-radio-button' });\n        // tslint:disable-next-line:max-line-length\n        // let template: HTMLInputElement = createElement('input', { className: 'e-de-style-temp', attrs: { type: 'radio' } }) as HTMLInputElement;\n        // templateDiv.appendChild(template);\n        // this.template = new RadioButton({ label: 'Template', value: 'template', name: 'styles' });\n        // this.template.appendTo(template);\n        // radioOptionsDiv.appendChild(templateDiv);\n        this.createFormatDropdown(container, localValue, isRtl);\n        this.target.appendChild(container);\n    };\n    StyleDialog.prototype.createFormatDropdown = function (parentDiv, localValue, isRtl) {\n        var _this = this;\n        var formatBtn = createElement('button', { id: 'style_format_dropdown', innerHTML: localValue.getConstant('Format') });\n        formatBtn.style.height = '35px';\n        parentDiv.appendChild(formatBtn);\n        var items = [{ text: localValue.getConstant('Font') + '..', id: 'style_font' },\n            { text: localValue.getConstant('Paragraph') + '..', id: 'style_paragraph' },\n            { text: localValue.getConstant('Numbering') + '..', id: 'style_numbering' }];\n        var dropDownbtn = new DropDownButton({\n            items: items, cssClass: 'e-de-style-format-dropdwn', enableRtl: isRtl,\n            beforeItemRender: function (args) {\n                if (_this.styleType.value === localValue.getConstant('Character')) {\n                    if (args.item.text === localValue.getConstant('Paragraph')) {\n                        args.element.classList.add('e-disabled');\n                    }\n                    if (args.item.text === 'Numbering') {\n                        args.element.classList.add('e-disabled');\n                    }\n                }\n                else {\n                    if (args.item.text === localValue.getConstant('Paragraph')) {\n                        args.element.classList.remove('e-disabled');\n                    }\n                    if (args.item.text === 'Numbering') {\n                        args.element.classList.remove('e-disabled');\n                    }\n                }\n            }\n        });\n        dropDownbtn.appendTo(formatBtn);\n        dropDownbtn.addEventListener('select', this.openDialog);\n    };\n    StyleDialog.prototype.createFontOptions = function (parentDiv, isRtl) {\n        var fontFamilyElement = createElement('select', { id: this.target.id + '_fontName' });\n        fontFamilyElement.innerHTML = '<option>Arial</option><option>Calibri</option><option>Candara</option>' +\n            '<option>Comic Sans MS</option><option>Consolas</option><option>Constantia</option><option>Corbel</option>' +\n            '<option>Courier New</option><option>Ebrima</option><option>Franklin Gothic</option>' +\n            '<option>Gabriola</option><option>Gadugi</option><option>Georgia</option><option>Impact</option>' +\n            '<option>Javanese Text</option><option>Microsoft Sans Serif</option><option>MS Gothic</option><option>MS UI Gothic</option>' +\n            '<option>Segoe Print</option><option>Times New Roman</option><option>Verdana</option><option>Segoe UI</option>' +\n            '<option>Algerian</option><option>Cambria</option><option>Georgia</option><option>Consolas</option>';\n        parentDiv.appendChild(fontFamilyElement);\n        this.fontFamily = new ComboBox({\n            width: '123px', popupWidth: '123px',\n            cssClass: 'e-style-font-fmaily-right', enableRtl: isRtl, change: this.fontFamilyChanged\n        });\n        this.fontFamily.showClearButton = false;\n        this.fontFamily.appendTo(fontFamilyElement);\n        var fontSizeElement = createElement('input');\n        parentDiv.appendChild(fontSizeElement);\n        var sizeDataSource = [8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72];\n        this.fontSize = new ComboBox({\n            dataSource: sizeDataSource, width: '73px', cssClass: 'e-style-font-fmaily-right',\n            enableRtl: isRtl, change: this.fontSizeUpdate\n        });\n        this.fontSize.showClearButton = false;\n        this.fontSize.appendTo(fontSizeElement);\n        var fontGroupButton = createElement('div', { className: 'e-de-style-font-group-button' });\n        parentDiv.appendChild(fontGroupButton);\n        // tslint:disable-next-line:max-line-length\n        this.bold = this.createButtonElement(fontGroupButton, 'e-de-bold', 'e-de-style-bold-button-size', this.owner.owner.containerId + '_style_bold');\n        this.bold.addEventListener('click', this.setBoldProperty);\n        // tslint:disable-next-line:max-line-length\n        this.italic = this.createButtonElement(fontGroupButton, 'e-de-italic', 'e-de-style-icon-button-size', this.owner.owner.containerId + '_style_italic');\n        this.italic.addEventListener('click', this.setItalicProperty);\n        // tslint:disable-next-line:max-line-length\n        this.underline = this.createButtonElement(fontGroupButton, 'e-de-underline', 'e-de-style-icon-button-size', this.owner.owner.containerId + '_style_underline');\n        this.underline.addEventListener('click', this.setUnderlineProperty);\n        var fontColorElement = createElement('input', { attrs: { type: 'color' }, className: 'e-de-style-icon-button-size' });\n        parentDiv.appendChild(fontColorElement);\n        // tslint:disable-next-line:max-line-length\n        this.fontColor = new ColorPicker({ cssClass: 'e-de-style-font-color-picker', enableRtl: isRtl, change: this.fontColorUpdate, locale: this.owner.owner.locale });\n        this.fontColor.appendTo(fontColorElement);\n    };\n    StyleDialog.prototype.createParagraphOptions = function (parentDiv) {\n        var _this = this;\n        var alignmentDiv = createElement('div', { className: 'e-de-style-paragraph-group-button' });\n        parentDiv.appendChild(alignmentDiv);\n        this.leftAlign = this.createButtonElement(alignmentDiv, 'e-de-align-left', 'e-de-style-icon-button-size');\n        this.leftAlign.addEventListener('click', this.setLeftAlignment);\n        this.centerAlign = this.createButtonElement(alignmentDiv, 'e-de-align-center', 'e-de-style-icon-button-size');\n        this.centerAlign.addEventListener('click', this.setCenterAlignment);\n        this.rightAlign = this.createButtonElement(alignmentDiv, 'e-de-align-right', 'e-de-style-icon-button-size');\n        this.rightAlign.addEventListener('click', this.setRightAlignment);\n        this.justify = this.createButtonElement(alignmentDiv, 'e-de-justify', 'e-de-style-icon-button-last-size');\n        this.justify.addEventListener('click', this.setJustifyAlignment);\n        var lineSpacingDiv = createElement('div', { className: 'e-de-style-paragraph-group-button' });\n        parentDiv.appendChild(lineSpacingDiv);\n        this.singleLineSpacing = this.createButtonElement(lineSpacingDiv, 'e-de-single-spacing', 'e-de-style-icon-button-first-size');\n        this.singleLineSpacing.addEventListener('click', function () {\n            _this.paragraphFormat.lineSpacing = 1;\n            _this.updateParagraphFormat();\n        });\n        // tslint:disable-next-line:max-line-length\n        this.onePointFiveLineSpacing = this.createButtonElement(lineSpacingDiv, 'e-de-one-point-five-spacing', 'e-de-style-icon-button-size');\n        this.onePointFiveLineSpacing.addEventListener('click', function () {\n            _this.paragraphFormat.lineSpacing = 1.5;\n            _this.updateParagraphFormat();\n        });\n        this.doubleLineSpacing = this.createButtonElement(lineSpacingDiv, 'e-de-double-spacing', 'e-de-style-icon-button-last-size');\n        this.doubleLineSpacing.addEventListener('click', function () {\n            _this.paragraphFormat.lineSpacing = 2;\n            _this.updateParagraphFormat();\n        });\n        var spacingDiv = createElement('div', { className: 'e-de-style-paragraph-group-button' });\n        parentDiv.appendChild(spacingDiv);\n        var beforeSpacing = this.createButtonElement(spacingDiv, 'e-de-before-spacing', 'e-de-style-icon-button-first-size');\n        var afterSpacing = this.createButtonElement(spacingDiv, 'e-de-after-spacing', 'e-de-style-icon-button-last-size');\n        beforeSpacing.addEventListener('click', this.increaseBeforeAfterSpacing);\n        afterSpacing.addEventListener('click', this.decreaseBeforeAfterSpacing);\n        var indentingDiv = createElement('div', { className: 'e-de-style-paragraph-indent-group-button' });\n        parentDiv.appendChild(indentingDiv);\n        var decreaseIndent = this.createButtonElement(indentingDiv, 'e-de-indent', 'e-de-style-icon-button-first-size');\n        decreaseIndent.addEventListener('click', function () {\n            if (_this.paragraphFormat.leftIndent >= 36) {\n                _this.paragraphFormat.leftIndent -= 36;\n            }\n            else {\n                _this.paragraphFormat.leftIndent = 0;\n            }\n        });\n        var increaseindent = this.createButtonElement(indentingDiv, 'e-de-outdent', 'e-de-style-icon-button-size');\n        increaseindent.addEventListener('click', function () {\n            _this.paragraphFormat.leftIndent += 36;\n        });\n    };\n    StyleDialog.prototype.createButtonElement = function (parentDiv, iconCss, className, id) {\n        var buttonElement = createElement('button');\n        if (!isNullOrUndefined(id)) {\n            buttonElement.id = id;\n        }\n        parentDiv.appendChild(buttonElement);\n        var button = new Button({ iconCss: iconCss, cssClass: className });\n        button.appendTo(buttonElement);\n        return buttonElement;\n    };\n    StyleDialog.prototype.toggleDisable = function () {\n        if (this.styleType.value === this.localObj.getConstant('Character')) {\n            this.styleParagraph.enabled = false;\n            // tslint:disable-next-line:max-line-length\n            this.target.getElementsByClassName('e-style-paragraph').item(0).setAttribute('style', 'display:flex;pointer-events:none;opacity:0.5');\n        }\n        else {\n            this.styleParagraph.enabled = true;\n            this.target.getElementsByClassName('e-style-paragraph').item(0).removeAttribute('style');\n            this.target.getElementsByClassName('e-style-paragraph').item(0).setAttribute('style', 'display:flex');\n        }\n        this.styleBasedOn.enabled = true;\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.show = function (styleName, header) {\n        var localObj = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        this.isEdit = (!isNullOrUndefined(styleName) && styleName.length > 0) ? true : false;\n        this.editStyleName = styleName;\n        this.abstractList = new WAbstractList();\n        // tslint:disable-next-line:max-line-length\n        var style = this.owner.owner.viewer.styles.findByName(styleName);\n        this.style = !this.isEdit ? new WParagraphStyle() : style ? style : this.getStyle(styleName);\n        localObj.setLocale(this.owner.owner.locale);\n        if (!this.target) {\n            this.initStyleDialog(localObj, this.owner.owner.enableRtl);\n        }\n        if (isNullOrUndefined(header)) {\n            header = localObj.getConstant('Create New Style');\n        }\n        this.owner.owner.viewer.dialog2.header = header;\n        this.owner.owner.viewer.dialog2.height = 'auto';\n        this.owner.owner.viewer.dialog2.width = 'auto';\n        this.owner.owner.viewer.dialog2.content = this.target;\n        this.owner.owner.viewer.dialog2.buttons = [{\n                click: this.onOkButtonClick,\n                buttonModel: { content: localObj.getConstant('Ok'), cssClass: 'e-flat e-style-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localObj.getConstant('Cancel'), cssClass: 'e-flat e-style-cancel' }\n            }];\n        this.toggleDisable();\n        this.owner.owner.viewer.dialog2.dataBind();\n        this.owner.owner.viewer.dialog2.beforeOpen = this.loadStyleDialog;\n        this.owner.owner.viewer.dialog2.close = this.closeStyleDialog;\n        this.owner.owner.viewer.dialog2.position = { X: 'center', Y: 'center' };\n        this.owner.owner.viewer.dialog2.show();\n    };\n    StyleDialog.prototype.updateList = function () {\n        var listId = this.style.paragraphFormat.listFormat.listId;\n        if (listId > -1) {\n            if (this.owner.owner.viewer.lists.filter(function (a) { return (a.listId === listId); }).length === 0) {\n                this.owner.owner.viewer.lists.push(this.style.paragraphFormat.listFormat.list);\n            }\n            else {\n                this.owner.owner.viewer.lists = this.owner.owner.viewer.lists.filter(function (a) { return (a.listId !== listId); });\n                this.owner.owner.viewer.lists.push(this.style.paragraphFormat.listFormat.list);\n            }\n        }\n        if (this.abstractList.abstractListId !== -1) {\n            this.owner.owner.viewer.abstractLists.push(this.abstractList);\n        }\n    };\n    StyleDialog.prototype.createLinkStyle = function (name, isEdit) {\n        var charStyle;\n        if (isEdit) {\n            charStyle = this.owner.owner.viewer.styles.findByName((name + ' Char'), 'Character');\n        }\n        else {\n            charStyle = new WCharacterStyle();\n        }\n        charStyle.type = 'Character';\n        charStyle.name = name + ' Char';\n        charStyle.characterFormat = this.style.characterFormat.cloneFormat();\n        charStyle.basedOn = this.style.basedOn;\n        if (!isEdit) {\n            this.owner.owner.viewer.styles.push(charStyle);\n        }\n        return this.owner.owner.viewer.styles.findByName(charStyle.name, 'Character');\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.updateCharacterFormat = function (characterFormat) {\n        if (!isNullOrUndefined(characterFormat)) {\n            this.characterFormat = characterFormat;\n        }\n        this.fontFamily.value = this.characterFormat.fontFamily;\n        this.fontSize.value = this.characterFormat.fontSize;\n        this.fontColor.value = this.characterFormat.fontColor;\n        this.fontButtonClicked(undefined);\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.updateParagraphFormat = function (paragraphFOrmat) {\n        if (!isNullOrUndefined(paragraphFOrmat)) {\n            this.paragraphFormat = paragraphFOrmat;\n        }\n        if (this.paragraphFormat.textAlignment === 'Left') {\n            if (!this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.add('e-active');\n            }\n            if (this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.remove('e-active');\n            }\n            if (this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.remove('e-active');\n            }\n            if (this.justify.classList.contains('e-active')) {\n                this.justify.classList.remove('e-active');\n            }\n        }\n        else if (this.paragraphFormat.textAlignment === 'Right') {\n            if (this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.remove('e-active');\n            }\n            if (!this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.add('e-active');\n            }\n            if (this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.remove('e-active');\n            }\n            if (this.justify.classList.contains('e-active')) {\n                this.justify.classList.remove('e-active');\n            }\n        }\n        else if (this.paragraphFormat.textAlignment === 'Center') {\n            if (this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.remove('e-active');\n            }\n            if (this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.remove('e-active');\n            }\n            if (!this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.add('e-active');\n            }\n            if (this.justify.classList.contains('e-active')) {\n                this.justify.classList.remove('e-active');\n            }\n        }\n        else if (this.paragraphFormat.textAlignment === 'Justify') {\n            if (this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.remove('e-active');\n            }\n            if (this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.remove('e-active');\n            }\n            if (this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.remove('e-active');\n            }\n            if (!this.justify.classList.contains('e-active')) {\n                this.justify.classList.add('e-active');\n            }\n        }\n        if (this.paragraphFormat.lineSpacing === 1) {\n            this.singleLineSpacing.classList.add('e-active');\n            this.onePointFiveLineSpacing.classList.remove('e-active');\n            this.doubleLineSpacing.classList.remove('e-active');\n        }\n        else if (this.paragraphFormat.lineSpacing === 1.5) {\n            this.singleLineSpacing.classList.remove('e-active');\n            this.onePointFiveLineSpacing.classList.add('e-active');\n            this.doubleLineSpacing.classList.remove('e-active');\n        }\n        else if (this.paragraphFormat.lineSpacing === 2) {\n            this.singleLineSpacing.classList.remove('e-active');\n            this.onePointFiveLineSpacing.classList.remove('e-active');\n            this.doubleLineSpacing.classList.add('e-active');\n        }\n        else {\n            this.singleLineSpacing.classList.remove('e-active');\n            this.onePointFiveLineSpacing.classList.remove('e-active');\n            this.doubleLineSpacing.classList.remove('e-active');\n        }\n    };\n    StyleDialog.prototype.enableOrDisableOkButton = function () {\n        if (!isNullOrUndefined(this.okButton)) {\n            this.okButton.disabled = (this.styleNameElement.value === '');\n        }\n    };\n    StyleDialog.prototype.getTypeValue = function () {\n        var type;\n        /* tslint:disable-next-line:max-line-length */\n        if (this.styleType.value === this.localObj.getConstant('Linked(Paragraph and Character)') || this.styleType.value === this.localObj.getConstant('Paragraph')) {\n            return 'Paragraph';\n        }\n        else {\n            return 'Character';\n        }\n    };\n    StyleDialog.prototype.updateStyleNames = function (type, name) {\n        var styles = this.owner.owner.viewer.styles.getStyleNames(type);\n        this.styleParagraph.dataSource = styles;\n        this.styleParagraph.index = null;\n        if (name) {\n            this.styleBasedOn.dataSource = styles.filter(function (e) { return e !== name; });\n            this.styleBasedOn.index = null;\n            var style = this.getStyle(name);\n            if (style.basedOn instanceof String || isNullOrUndefined(style.basedOn)) {\n                this.styleBasedOn.enabled = false;\n            }\n            else {\n                /* tslint:disable-next-line:max-line-length */\n                this.styleBasedOn.index = styles.indexOf(style.basedOn.name) > -1 ? styles.indexOf(style.basedOn.name) : 0;\n            }\n            if (style.type === 'Paragraph') {\n                if (!isNullOrUndefined(style.link)) {\n                    this.styleType.index = 2;\n                }\n                else {\n                    this.styleType.index = 0;\n                }\n            }\n            else {\n                this.styleType.index = 1;\n            }\n            if (!isNullOrUndefined(style.next)) {\n                var nxtName = style.next.name;\n                var index = 0;\n                if (styles.indexOf(nxtName) > -1) {\n                    index = styles.indexOf(nxtName);\n                }\n                this.styleParagraph.index = index;\n                this.isUserNextParaUpdated = (nxtName === name) ? false : true;\n            }\n        }\n        else {\n            this.styleBasedOn.dataSource = styles;\n            this.styleBasedOn.index = null;\n            var basedOnIndex = 0;\n            if (this.owner.owner.selectionModule) {\n                var styleName = void 0;\n                if (type === 'Character') {\n                    styleName = this.owner.owner.selection.characterFormat.styleName;\n                }\n                else {\n                    styleName = this.owner.owner.selection.paragraphFormat.styleName;\n                }\n                basedOnIndex = styles.indexOf(styleName);\n            }\n            this.styleBasedOn.index = basedOnIndex;\n            this.styleParagraph.index = 0;\n        }\n        if (this.isEdit) {\n            this.styleType.enabled = false;\n        }\n        else {\n            this.styleType.enabled = true;\n        }\n        this.styleBasedOn.dataBind();\n        this.styleParagraph.dataBind();\n    };\n    StyleDialog.prototype.getStyle = function (styleName) {\n        /* tslint:disable-next-line:max-line-length */\n        if (isNullOrUndefined(this.owner.owner.viewer.styles.findByName(styleName))) {\n            /* tslint:disable-next-line:max-line-length */\n            this.owner.owner.editor.createStyle(this.owner.owner.viewer.preDefinedStyles.get(styleName));\n        }\n        return this.owner.owner.viewer.styles.findByName(styleName);\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.destroy = function () {\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var n = 0; n < this.target.childNodes.length; n++) {\n                this.target.removeChild(this.target.childNodes[n]);\n                n--;\n            }\n            this.target = undefined;\n        }\n        if (this.styleType) {\n            this.styleType.destroy();\n        }\n        this.styleType = undefined;\n        if (this.styleBasedOn) {\n            this.styleBasedOn.destroy();\n        }\n        this.styleBasedOn = undefined;\n        if (this.styleParagraph) {\n            this.styleParagraph.destroy();\n        }\n        this.styleParagraph = undefined;\n        if (this.onlyThisDocument) {\n            this.onlyThisDocument.destroy();\n        }\n        this.onlyThisDocument = undefined;\n        if (this.template) {\n            this.template.destroy();\n        }\n        this.template = undefined;\n        if (this.style) {\n            this.style = undefined;\n        }\n        if (this.abstractList) {\n            this.abstractList = undefined;\n        }\n        if (this.numberingBulletDialog) {\n            this.numberingBulletDialog.destroy();\n        }\n        this.numberingBulletDialog = undefined;\n    };\n    return StyleDialog;\n}());\nexport { StyleDialog };\n","import { ListView } from '@syncfusion/ej2-lists';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { createElement, L10n } from '@syncfusion/ej2-base';\n/**\n * The Styles dialog is used to create or modify styles.\n */\nvar StylesDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function StylesDialog(viewer) {\n        var _this = this;\n        this.updateStyleNames = function (localValue) {\n            var collection = _this.owner.owner.viewer.styles.getStyleNames('Paragraph');\n            var styleNames = ['Normal', 'Heading 1', 'Heading 2', 'Heading 3', 'Heading 4', 'Heading 5', 'Heading 6'];\n            var defaultStyleNames = _this.defaultStyleName(styleNames, localValue);\n            var finalList = collection.concat(defaultStyleNames).filter(function (v, i, a) { return a.indexOf(v) === i; });\n            return finalList;\n        };\n        this.defaultStyleName = function (styleNames, localValue) {\n            var styleName = [];\n            for (var index = 0; index < styleNames.length; index++) {\n                styleName.push(localValue.getConstant(styleNames[index]));\n            }\n            return styleName;\n        };\n        this.modifyStyles = function () {\n            _this.owner.dialog.hide();\n            _this.owner.owner.styleDialogModule.show(_this.styleName, _this.localValue.getConstant('Modify Style'));\n        };\n        /* tslint:disable:no-any */\n        this.selectHandler = function (args) {\n            _this.styleName = args.text;\n        };\n        this.addNewStyles = function () {\n            _this.owner.dialog.hide();\n            _this.owner.owner.styleDialogModule.show();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    StylesDialog.prototype.getModuleName = function () {\n        return 'StylesDialog';\n    };\n    /**\n     * @private\n     */\n    StylesDialog.prototype.initStylesDialog = function (localValue, styles, isRtl) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_styles';\n        this.target = createElement('div', { id: id, className: 'e-de-styles' });\n        var headerValue = localValue.getConstant('Styles');\n        var dlgFields = createElement('div', { innerHTML: headerValue, className: 'e-styles-dlgfields' });\n        this.target.appendChild(dlgFields);\n        var commonDiv = createElement('div', { className: 'e-styles-common' });\n        this.target.appendChild(commonDiv);\n        var searchDiv = createElement('div', { className: 'e-styles-list' });\n        commonDiv.appendChild(searchDiv);\n        if (isRtl) {\n            searchDiv.classList.add('e-de-rtl');\n        }\n        var listviewDiv = createElement('div', { className: 'e-styles-listViewDiv', id: 'styles_listview' });\n        searchDiv.appendChild(listviewDiv);\n        this.listviewInstance = new ListView({\n            dataSource: styles,\n            cssClass: 'e-styles-listview',\n        });\n        this.listviewInstance.appendTo(listviewDiv);\n        this.listviewInstance.addEventListener('select', this.selectHandler);\n        var buttonDiv = createElement('div', { className: 'e-styles-button' });\n        commonDiv.appendChild(buttonDiv);\n        var newButtonDiv = createElement('div', { className: 'e-styles-addbutton' });\n        buttonDiv.appendChild(newButtonDiv);\n        var newButtonElement = createElement('button', { innerHTML: localValue.getConstant('New'), id: 'new' });\n        newButtonDiv.appendChild(newButtonElement);\n        var newbutton = new Button({ cssClass: 'e-button-custom' });\n        newbutton.appendTo(newButtonElement);\n        newButtonElement.addEventListener('click', this.addNewStyles);\n        var modifybuttonDiv = createElement('div', { className: 'e-styles-addbutton' });\n        buttonDiv.appendChild(modifybuttonDiv);\n        var modifyButtonElement = createElement('button', { innerHTML: localValue.getConstant('Modify'), id: 'modify' });\n        modifybuttonDiv.appendChild(modifyButtonElement);\n        var addbutton = new Button({ cssClass: 'e-button-custom' });\n        addbutton.appendTo(modifyButtonElement);\n        modifyButtonElement.addEventListener('click', this.modifyStyles);\n    };\n    /**\n     * @private\n     */\n    StylesDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        var styles = this.updateStyleNames(localValue);\n        this.localValue = localValue;\n        this.initStylesDialog(localValue, styles, this.owner.owner.enableRtl);\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.header = localValue.getConstant('Styles');\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.buttons = [{\n                click: this.hideObjects.bind(this),\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-hyper-insert', isPrimary: true }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    StylesDialog.prototype.hideObjects = function () {\n        this.owner.dialog.hide();\n    };\n    /**\n     * @private\n     */\n    StylesDialog.prototype.destroy = function () {\n        if (this.listviewInstance) {\n            this.listviewInstance.destroy();\n            this.listviewInstance = undefined;\n        }\n    };\n    return StylesDialog;\n}());\nexport { StylesDialog };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { L10n, createElement, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The Table dialog is used to insert table at selection.\n */\nvar TableDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.keyUpInsertTable = function (event) {\n            if (event.keyCode === 13) {\n                if (_this.rowsCountBox.value !== '' && _this.columnsCountBox.value !== '') {\n                    _this.onInsertTableClick();\n                }\n            }\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.onInsertTableClick = function () {\n            var rowCount = _this.rowValueTextBox.value;\n            var columnCount = _this.columnValueTexBox.value;\n            if (!(isNullOrUndefined(rowCount) && isNullOrUndefined(columnCount))) {\n                _this.owner.owner.editor.insertTable(rowCount, columnCount);\n            }\n            _this.owner.dialog.hide();\n        };\n        this.owner = viewer;\n    }\n    TableDialog.prototype.getModuleName = function () {\n        return 'TableDialog';\n    };\n    /**\n     * @private\n     */\n    TableDialog.prototype.initTableDialog = function (localValue) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_Table';\n        this.target = createElement('div', { id: id, className: 'e-de-insert-table' });\n        var parentDiv = createElement('div');\n        var columnContainer = createElement('div', {\n            className: 'e-de-insert-table-dlg-sub-header', innerHTML: localValue.getConstant('Number of columns')\n        });\n        var columnValue = createElement('div', { className: 'e-de-insert-table-dlg-input' });\n        this.columnsCountBox = createElement('input', {\n            attrs: { type: 'text' }, id: this.owner.owner.containerId + '_column'\n        });\n        columnValue.appendChild(this.columnsCountBox);\n        var rowContainer = createElement('div', {\n            className: 'e-de-insert-table-dlg-sub-header', innerHTML: localValue.getConstant('Number of rows')\n        });\n        var rowValue = createElement('div', { className: 'e-de-insert-table-dlg-input' });\n        this.rowsCountBox = createElement('input', {\n            attrs: { type: 'text' }, id: this.owner.owner.containerId + 'row'\n        });\n        rowValue.appendChild(this.rowsCountBox);\n        parentDiv.appendChild(columnContainer);\n        parentDiv.appendChild(columnValue);\n        parentDiv.appendChild(rowContainer);\n        parentDiv.appendChild(rowValue);\n        this.target.appendChild(parentDiv);\n        this.columnsCountBox.addEventListener('keyup', instance.keyUpInsertTable);\n        this.rowsCountBox.addEventListener('keyup', instance.keyUpInsertTable);\n        this.rowValueTextBox = new NumericTextBox({\n            format: '#',\n            value: 2,\n            min: 1,\n            max: 32767,\n            enablePersistence: false\n        });\n        this.rowValueTextBox.appendTo(this.rowsCountBox);\n        this.columnValueTexBox = new NumericTextBox({\n            format: '#',\n            value: 2,\n            min: 1,\n            max: 63,\n            enablePersistence: false\n        });\n        this.columnValueTexBox.appendTo(this.columnsCountBox);\n    };\n    /**\n     * @private\n     */\n    TableDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTableDialog(localValue);\n        }\n        if (this.owner.selection.caret.style.display !== 'none') {\n            this.owner.selection.caret.style.display = 'none';\n        }\n        this.owner.dialog.header = localValue.getConstant('Insert Table');\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.buttons = [{\n                click: this.onInsertTableClick,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-table-ok', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-table-cancel' }\n            }];\n        this.rowValueTextBox.value = 2;\n        this.columnValueTexBox.value = 2;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    TableDialog.prototype.destroy = function () {\n        if (this.columnsCountBox) {\n            if (this.columnsCountBox.parentElement) {\n                this.columnsCountBox.parentElement.removeChild(this.columnsCountBox);\n            }\n            this.columnsCountBox = undefined;\n        }\n        if (this.rowsCountBox) {\n            if (this.rowsCountBox.parentElement) {\n                this.rowsCountBox.parentElement.removeChild(this.rowsCountBox);\n            }\n            this.rowsCountBox = undefined;\n        }\n        if (this.columnValueTexBox) {\n            this.columnValueTexBox.destroy();\n            this.columnValueTexBox = undefined;\n        }\n        if (this.rowValueTextBox) {\n            this.rowValueTextBox.destroy();\n            this.rowValueTextBox = undefined;\n        }\n        this.columnsCountBox = undefined;\n        this.rowsCountBox = undefined;\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var i = 0; i < this.target.childNodes.length; i++) {\n                this.target.removeChild(this.target.childNodes[i]);\n                i--;\n            }\n            this.target = undefined;\n        }\n    };\n    return TableDialog;\n}());\nexport { TableDialog };\n","import { L10n, createElement, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { CheckBox, Button } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { ListView } from '@syncfusion/ej2-lists';\n/**\n * The Table of contents dialog is used to insert or edit table of contents at selection.\n */\nvar TableOfContentsDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableOfContentsDialog(viewer) {\n        var _this = this;\n        this.styleLocaleValue = function (styleLocale, localValue) {\n            var styleName = [];\n            for (var index = 0; index < styleLocale.length; index++) {\n                styleName.push(localValue.getConstant(styleLocale[index]));\n            }\n            return styleName;\n        };\n        /**\n         * @private\n         */\n        this.loadTableofContentDialog = function () {\n            _this.owner.updateFocus();\n            _this.pageNumber.checked = true;\n            _this.rightAlign.disabled = false;\n            _this.rightAlign.checked = true;\n            _this.tabLeader.enabled = true;\n            _this.hyperlink.checked = true;\n            _this.style.checked = true;\n            _this.outline.checked = true;\n            _this.outline.disabled = false;\n            _this.showLevel.enabled = true;\n        };\n        /**\n         * @private\n         */\n        this.closeTableOfContentDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /* tslint:disable:no-any */\n        this.selectHandler = function (args) {\n            _this.textBoxInput.value = args.text;\n            /* tslint:disable:no-any */\n            var value = document.getElementById('toclist');\n            value.setSelectionRange(0, args.text.length);\n            value.focus();\n        };\n        this.showStyleDialog = function () {\n            if (!isNullOrUndefined(_this.owner.owner.styleDialogModule)) {\n                _this.owner.owner.styleDialogModule.show(_this.textBoxInput.value);\n            }\n        };\n        this.changeShowLevelValue = function (event) {\n            var levels = event.value;\n            var values = [];\n            switch (levels) {\n                case 1:\n                    values = ['1', null, null, null, null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 2:\n                    values = ['1', '2', null, null, null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 3:\n                    values = ['1', '2', '3', null, null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 4:\n                    values = ['1', '2', '3', '4', null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 5:\n                    values = ['1', '2', '3', '4', '5', null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 6:\n                    values = ['1', '2', '3', '4', '5', '6', null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 7:\n                    values = ['1', '2', '3', '4', '5', '6', '7', null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 8:\n                    values = ['1', '2', '3', '4', '5', '6', '7', '8', null];\n                    _this.changeByValue(values);\n                    break;\n                case 9:\n                    values = ['1', '2', '3', '4', '5', '6', '7', '8', '9'];\n                    _this.changeByValue(values);\n                    break;\n            }\n        };\n        this.changeByValue = function (headings) {\n            _this.heading1.value = headings[0];\n            _this.heading2.value = headings[1];\n            _this.heading3.value = headings[2];\n            _this.heading4.value = headings[3];\n            _this.heading5.value = headings[4];\n            _this.heading6.value = headings[5];\n            _this.heading7.value = headings[6];\n            _this.heading8.value = headings[7];\n            _this.heading9.value = headings[8];\n        };\n        this.reset = function () {\n            _this.showLevel.enabled = true;\n            _this.showLevel.value = 3;\n            _this.outline.disabled = false;\n            _this.outline.checked = true;\n            var values = ['1', '2', '3', null, null, null, null, null, null];\n            _this.changeByValue(values);\n            _this.normal.value = null;\n        };\n        this.changeStyle = function (args) {\n            var headingValue = args.srcElement.value;\n            var value = _this.getElementValue(args.srcElement);\n            if (headingValue !== value && headingValue !== '') {\n                _this.showLevel.enabled = false;\n            }\n            else {\n                _this.showLevel.enabled = true;\n                _this.checkLevel();\n            }\n        };\n        this.changeHeadingStyle = function (args) {\n            var headingValue = args.srcElement.value;\n            if (headingValue === '') {\n                _this.showLevel.enabled = true;\n            }\n            else {\n                _this.showLevel.enabled = false;\n            }\n            if (_this.normal === args.srcElement) {\n                _this.outline.checked = false;\n                _this.outline.disabled = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changePageNumberValue = function (args) {\n            if (args.checked) {\n                _this.rightAlign.checked = true;\n                _this.rightAlign.disabled = false;\n                _this.tabLeader.enabled = true;\n            }\n            else {\n                _this.rightAlign.disabled = true;\n                _this.tabLeader.enabled = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeRightAlignValue = function (args) {\n            if (args.checked) {\n                _this.tabLeader.enabled = true;\n            }\n            else {\n                _this.tabLeader.enabled = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeStyleValue = function (args) {\n            if (args.checked) {\n                _this.heading1.disabled = false;\n                _this.heading2.disabled = false;\n                _this.heading3.disabled = false;\n                _this.heading4.disabled = false;\n                _this.heading5.disabled = false;\n                _this.heading6.disabled = false;\n                _this.heading7.disabled = false;\n                _this.heading8.disabled = false;\n                _this.heading9.disabled = false;\n                _this.normal.disabled = false;\n            }\n            else {\n                _this.heading1.disabled = true;\n                _this.heading2.disabled = true;\n                _this.heading3.disabled = true;\n                _this.heading4.disabled = true;\n                _this.heading5.disabled = true;\n                _this.heading6.disabled = true;\n                _this.heading7.disabled = true;\n                _this.heading8.disabled = true;\n                _this.heading9.disabled = true;\n                _this.normal.disabled = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyTableOfContentProperties = function () {\n            var tocSettings = {\n                startLevel: 1,\n                endLevel: _this.showLevel.value,\n                includeHyperlink: _this.hyperlink.checked,\n                includePageNumber: _this.pageNumber.checked,\n                rightAlign: _this.rightAlign.checked,\n                tabLeader: _this.tabLeader.value,\n                includeOutlineLevels: _this.outline.checked\n            };\n            _this.applyLevelSetting(tocSettings);\n            _this.owner.owner.editorModule.insertTableOfContents(tocSettings);\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.unWireEventsAndBindings = function () {\n            _this.pageNumber.checked = false;\n            _this.rightAlign.checked = false;\n            _this.tabLeader.value = '';\n            _this.hyperlink.checked = false;\n            _this.style.checked = false;\n            _this.outline.checked = false;\n            _this.normal.value = '';\n        };\n        this.owner = viewer;\n    }\n    TableOfContentsDialog.prototype.getModuleName = function () {\n        return 'TableOfContentsDialog';\n    };\n    /*tslint:disable max-func-body-length*/\n    /**\n     * @private\n     */\n    TableOfContentsDialog.prototype.initTableOfContentDialog = function (locale, isRtl) {\n        var instance = this;\n        var ownerId = this.owner.owner.containerId;\n        var id = ownerId + '_toc_dialog';\n        this.target = createElement('div', { id: id, className: 'e-de-toc-dlg-container' });\n        // tslint:disable-next-line:max-line-length\n        var generalDiv = createElement('div', { id: 'general_div', className: 'e-de-toc-dlg-sub-container' });\n        this.target.appendChild(generalDiv);\n        // tslint:disable-next-line:max-line-length\n        var genLabel = createElement('div', { id: ownerId + '_genLabel', className: 'e-de-toc-dlg-main-heading', styles: 'margin-bottom: 13px;', innerHTML: locale.getConstant('General') });\n        generalDiv.appendChild(genLabel);\n        var leftGeneralDivStyles;\n        var rightBottomGeneralDivStyles;\n        if (isRtl) {\n            leftGeneralDivStyles = 'float:right;';\n            rightBottomGeneralDivStyles = 'float:left;position:relative;';\n        }\n        else {\n            leftGeneralDivStyles = 'float:left;';\n            rightBottomGeneralDivStyles = 'float:right;';\n        }\n        // tslint:disable-next-line:max-line-length\n        var leftGeneralDiv = createElement('div', { id: 'left_general', styles: leftGeneralDivStyles + 'position:relative;' });\n        generalDiv.appendChild(leftGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightGeneralDiv = createElement('div', { styles: 'position:absolute;', className: 'e-de-toc-dlg-right-general-div' });\n        generalDiv.appendChild(rightGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var leftBottomGeneralDiv = createElement('div', { id: 'leftBottom_general', styles: 'float:left;position:absolute;top:210px;' });\n        generalDiv.appendChild(leftBottomGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightBottomGeneralDiv = createElement('div', { className: 'e-de-toc-dlg-right-sub-container', styles: rightBottomGeneralDivStyles });\n        generalDiv.appendChild(rightBottomGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var pageNumberDiv = createElement('div', { id: 'pageNumber_div', className: 'e-de-toc-dlg-sub-container' });\n        var pageNumber = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_pageNumber'\n        });\n        pageNumberDiv.appendChild(pageNumber);\n        // tslint:disable-next-line:max-line-length\n        var rightAlignDiv = createElement('div', { id: 'rightAlign_div', className: 'e-de-toc-dlg-sub-container' });\n        var rightAlign = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_rightAlign'\n        });\n        rightAlignDiv.appendChild(rightAlign);\n        // tslint:disable-next-line:max-line-length\n        this.pageNumber = new CheckBox({ label: locale.getConstant('Show page numbers'), enableRtl: isRtl, checked: true, change: this.changePageNumberValue });\n        // tslint:disable-next-line:max-line-length\n        this.rightAlign = new CheckBox({ label: locale.getConstant('Right align page numbers'), enableRtl: isRtl, checked: true, change: this.changeRightAlignValue });\n        this.pageNumber.appendTo(pageNumber);\n        this.rightAlign.appendTo(rightAlign);\n        var tabDiv = createElement('div', { id: 'tab_div', className: 'e-de-toc-dlg-tab-div' });\n        // tslint:disable-next-line:max-line-length\n        var tabLeaderLabelDiv = createElement('div', { id: 'tabLeaderLabel_div' });\n        // tslint:disable-next-line:max-line-length\n        var tabLeaderLabel = createElement('label', { id: ownerId + '_tabLeaderLabel', className: 'e-de-toc-dlg-heading', innerHTML: locale.getConstant('Tab leader') + ':' });\n        tabLeaderLabelDiv.appendChild(tabLeaderLabel);\n        var tabLeaderDiv = createElement('div', { id: 'tabLeader_div' });\n        var tabLeader = createElement('select', {\n            id: ownerId + '_tabLeader',\n            innerHTML: '<option value=\"None\">' + '(' + locale.getConstant('None').toLocaleLowerCase() + ')' +\n                '</option><option value=\"Dot\" selected>' + '....................' +\n                '</option><option value=\"Hyphen\">' + '-------------------' +\n                '</option><option value=\"Underscore\">' + '____________' + '</option>'\n        });\n        tabLeaderDiv.appendChild(tabLeader);\n        tabDiv.appendChild(tabLeaderLabelDiv);\n        tabDiv.appendChild(tabLeaderDiv);\n        leftGeneralDiv.appendChild(pageNumberDiv);\n        leftGeneralDiv.appendChild(rightAlignDiv);\n        leftGeneralDiv.appendChild(tabDiv);\n        this.tabLeader = new DropDownList({ width: 210, enableRtl: isRtl });\n        this.tabLeader.appendTo(tabLeader);\n        var hyperlink = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_hyperlink'\n        });\n        rightGeneralDiv.appendChild(hyperlink);\n        //tslint:disable-next-line:max-line-length\n        this.hyperlink = new CheckBox({ label: locale.getConstant('Use hyperlinks instead of page numbers'), cssClass: 'e-de-toc-label', enableRtl: isRtl, checked: true });\n        this.hyperlink.appendTo(hyperlink);\n        // tslint:disable-next-line:max-line-length\n        var showDiv = createElement('div', { id: 'show_div', className: 'e-de-toc-dlg-style-label' });\n        // tslint:disable-next-line:max-line-length\n        var showLevelLabelDiv = createElement('div', { id: 'showLevelLabel_div', className: 'e-de-toc-dlg-show-level-div' });\n        // tslint:disable-next-line:max-line-length\n        var showLevelLabel = createElement('label', { id: ownerId + '_showLevelLabel', className: 'e-de-toc-dlg-heading', innerHTML: locale.getConstant('Show levels') + ':' });\n        showLevelLabelDiv.appendChild(showLevelLabel);\n        // tslint:disable-next-line:max-line-length\n        var showLevelDiv = createElement('div', { id: 'showLevel_div', className: 'e-de-toc-dlg-showlevel-div' });\n        // tslint:disable-next-line:max-line-length\n        var showLevel = createElement('input', { id: ownerId + '_showLevel', attrs: { 'type': 'text' } });\n        showLevelDiv.appendChild(showLevel);\n        showDiv.appendChild(showLevelLabelDiv);\n        showDiv.appendChild(showLevelDiv);\n        rightGeneralDiv.appendChild(showDiv);\n        this.showLevel = new NumericTextBox({ format: '#', value: 3, min: 1, max: 9, width: 210, change: this.changeShowLevelValue });\n        this.showLevel.appendTo(showLevel);\n        if (isRtl) {\n            this.hyperlink.cssClass = 'e-de-toc-label-rtl';\n            showLevelLabelDiv.classList.add('e-de-rtl');\n            showLevelDiv.classList.add('e-de-rtl');\n            rightBottomGeneralDiv.classList.add('e-de-rtl');\n        }\n        // tslint:disable-next-line:max-line-length\n        var buildTableDiv = createElement('div', { id: 'buildTable_div', className: 'e-de-toc-dlg-sub-container' });\n        // tslint:disable-next-line:max-line-length\n        var buildTableLabel = createElement('div', { id: ownerId + '_buildTableLabel', className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-build-table', styles: 'margin-bottom: 13px;', innerHTML: locale.getConstant('Build table of contents from') + ':' });\n        leftBottomGeneralDiv.appendChild(buildTableDiv);\n        leftBottomGeneralDiv.appendChild(buildTableLabel);\n        var style = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_style',\n        });\n        leftBottomGeneralDiv.appendChild(style);\n        this.style = new CheckBox({ label: locale.getConstant('Styles'), enableRtl: isRtl, checked: true, change: this.changeStyleValue });\n        this.style.appendTo(style);\n        var table = createElement('TABLE', { styles: 'margin-top:3px;' });\n        var tr1 = createElement('tr');\n        var td1 = createElement('td', { styles: 'width:120px;padding-left:10px;' });\n        var availableLabel = createElement('label', {\n            // tslint:disable-next-line:max-line-length\n            innerHTML: locale.getConstant('Available styles'), className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading', id: this.target.id + '_availableLabel'\n        });\n        td1.appendChild(availableLabel);\n        var td2 = createElement('td');\n        var tocLabel = createElement('label', {\n            innerHTML: locale.getConstant('TOC level') + ':', className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading',\n            id: this.target.id + '_tocLabel'\n        });\n        td2.appendChild(tocLabel);\n        tr1.appendChild(td1);\n        tr1.appendChild(td2);\n        table.appendChild(tr1);\n        // tslint:disable-next-line:max-line-length\n        var tableDiv = createElement('div', { id: 'table_div', className: 'e-de-toc-table-div' });\n        var table1 = createElement('TABLE');\n        var tr2 = createElement('tr');\n        var td3 = createElement('td');\n        var heading1Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 1',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading1Label'\n        });\n        td3.appendChild(heading1Label);\n        var td4 = createElement('td');\n        this.heading1 = createElement('input', { id: '_heading1', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading1.value = '1';\n        this.heading1.addEventListener('keyup', this.changeStyle);\n        td4.appendChild(this.heading1);\n        tr2.appendChild(td3);\n        tr2.appendChild(td4);\n        var tr3 = createElement('tr');\n        var td5 = createElement('td');\n        var heading2Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 2',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading2Label'\n        });\n        td5.appendChild(heading2Label);\n        var td6 = createElement('td');\n        this.heading2 = createElement('input', { id: '_heading2', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading2.value = '2';\n        this.heading2.addEventListener('keyup', this.changeStyle);\n        td6.appendChild(this.heading2);\n        tr3.appendChild(td5);\n        tr3.appendChild(td6);\n        var tr4 = createElement('tr');\n        var td7 = createElement('td');\n        var heading3Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 3',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading3Label'\n        });\n        td7.appendChild(heading3Label);\n        var td8 = createElement('td');\n        this.heading3 = createElement('input', { id: '_heading3', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading3.value = '3';\n        this.heading3.addEventListener('keyup', this.changeStyle);\n        td8.appendChild(this.heading3);\n        tr4.appendChild(td7);\n        tr4.appendChild(td8);\n        var tr5 = createElement('tr');\n        var td9 = createElement('td');\n        var heading4Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 4',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading4Label'\n        });\n        td9.appendChild(heading4Label);\n        var td10 = createElement('td');\n        this.heading4 = createElement('input', { id: '_heading4', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading4.addEventListener('keyup', this.changeStyle);\n        td10.appendChild(this.heading4);\n        tr5.appendChild(td9);\n        tr5.appendChild(td10);\n        var tr6 = createElement('tr');\n        var td11 = createElement('td');\n        var heading5Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 5',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading5Label'\n        });\n        td11.appendChild(heading5Label);\n        var td12 = createElement('td');\n        this.heading5 = createElement('input', { id: '_heading5', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading5.addEventListener('keyup', this.changeStyle);\n        td12.appendChild(this.heading5);\n        tr6.appendChild(td11);\n        tr6.appendChild(td12);\n        var tr7 = createElement('tr');\n        var td13 = createElement('td');\n        var heading6Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 6',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading6Label'\n        });\n        td13.appendChild(heading6Label);\n        var td14 = createElement('td');\n        this.heading6 = createElement('input', { id: '_heading6', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading6.addEventListener('keyup', this.changeStyle);\n        td14.appendChild(this.heading6);\n        tr7.appendChild(td13);\n        tr7.appendChild(td14);\n        var tr8 = createElement('tr');\n        var td15 = createElement('td');\n        var heading7Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 7',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading7Label'\n        });\n        td15.appendChild(heading7Label);\n        var td16 = createElement('td');\n        this.heading7 = createElement('input', { id: '_heading7', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading7.addEventListener('keyup', this.changeStyle);\n        td16.appendChild(this.heading7);\n        tr8.appendChild(td15);\n        tr8.appendChild(td16);\n        var tr9 = createElement('tr');\n        var td17 = createElement('td');\n        var heading8Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 8',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading8Label'\n        });\n        td17.appendChild(heading8Label);\n        var td18 = createElement('td');\n        this.heading8 = createElement('input', { id: '_heading8', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading8.addEventListener('keyup', this.changeStyle);\n        td18.appendChild(this.heading8);\n        tr9.appendChild(td17);\n        tr9.appendChild(td18);\n        var tr10 = createElement('tr');\n        var td19 = createElement('td');\n        var heading9Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 9',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading9Label'\n        });\n        td19.appendChild(heading9Label);\n        var td20 = createElement('td');\n        this.heading9 = createElement('input', { id: '_heading9', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading9.addEventListener('keyup', this.changeStyle);\n        td20.appendChild(this.heading9);\n        tr10.appendChild(td19);\n        tr10.appendChild(td20);\n        var tr12 = createElement('tr');\n        var td23 = createElement('td');\n        var normalLabel = createElement('label', {\n            innerHTML: locale.getConstant('Normal'),\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_normalLabel'\n        });\n        td23.appendChild(normalLabel);\n        var td24 = createElement('td');\n        this.normal = createElement('input', { id: '_normal', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.normal.addEventListener('keyup', this.changeHeadingStyle);\n        td24.appendChild(this.normal);\n        tr12.appendChild(td23);\n        tr12.appendChild(td24);\n        if (isRtl) {\n            this.normal.classList.add('e-de-rtl');\n            this.heading1.classList.add('e-de-rtl');\n            this.heading2.classList.add('e-de-rtl');\n            this.heading3.classList.add('e-de-rtl');\n            this.heading4.classList.add('e-de-rtl');\n            this.heading5.classList.add('e-de-rtl');\n            this.heading6.classList.add('e-de-rtl');\n            this.heading7.classList.add('e-de-rtl');\n            this.heading8.classList.add('e-de-rtl');\n            this.heading9.classList.add('e-de-rtl');\n        }\n        table1.appendChild(tr2);\n        table1.appendChild(tr3);\n        table1.appendChild(tr4);\n        table1.appendChild(tr5);\n        table1.appendChild(tr6);\n        table1.appendChild(tr7);\n        table1.appendChild(tr8);\n        table1.appendChild(tr9);\n        table1.appendChild(tr10);\n        table1.appendChild(tr12);\n        tableDiv.appendChild(table1);\n        var stylesLevelDiv = createElement('div', { className: 'e-de-toc-styles-table-div' });\n        stylesLevelDiv.appendChild(table);\n        stylesLevelDiv.appendChild(tableDiv);\n        leftBottomGeneralDiv.appendChild(stylesLevelDiv);\n        //leftBottomGeneralDiv.appendChild(table); leftBottomGeneralDiv.appendChild(tableDiv);\n        var fieldsDiv = createElement('div', { id: 'fields_div', styles: 'display: flex;' });\n        leftBottomGeneralDiv.appendChild(fieldsDiv);\n        var outDiv = createElement('div', { id: 'out_div' });\n        // tslint:disable-next-line:max-line-length\n        var outlineDiv = createElement('div', { id: 'outline_div', className: 'e-de-toc-dlg-sub-container e-de-toc-dlg-outline-levels' });\n        var outline = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: '_outline'\n        });\n        outlineDiv.appendChild(outline);\n        outDiv.appendChild(outlineDiv);\n        fieldsDiv.appendChild(outDiv);\n        this.outline = new CheckBox({\n            label: locale.getConstant('Outline levels'),\n            enableRtl: isRtl, checked: true, cssClass: 'e-de-outline-rtl'\n        });\n        this.outline.appendTo(outline);\n        var resetButtonDiv = createElement('div', { className: 'e-de-toc-reset-button' });\n        fieldsDiv.appendChild(resetButtonDiv);\n        var resetElement = createElement('button', { innerHTML: locale.getConstant('Reset'), id: 'reset' });\n        resetButtonDiv.appendChild(resetElement);\n        var resetButton = new Button({ cssClass: 'e-btn e-flat' });\n        resetButton.appendTo(resetElement);\n        resetElement.addEventListener('click', this.reset);\n        // tslint:disable-next-line:max-line-length\n        var tocStylesDiv = createElement('div', { id: 'tocStyles_div', className: 'e-de-toc-dlg-sub-container' });\n        // tslint:disable-next-line:max-line-length\n        var tocStylesLabel = createElement('div', {\n            id: ownerId + '_tocStylesLabel', className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-styles',\n            innerHTML: locale.getConstant('Styles') + ':'\n        });\n        rightBottomGeneralDiv.appendChild(tocStylesDiv);\n        rightBottomGeneralDiv.appendChild(tocStylesLabel);\n        var textBoxDiv = createElement('div', { className: 'e-de-toc-dlg-style-input' });\n        rightBottomGeneralDiv.appendChild(textBoxDiv);\n        this.textBoxInput = createElement('input', { className: 'e-input', id: 'toclist' });\n        this.textBoxInput.setAttribute('type', 'text');\n        textBoxDiv.appendChild(this.textBoxInput);\n        var listViewDiv = createElement('div', { className: 'e-de-toc-list-view' });\n        var styleLocale = ['TOC 1', 'TOC 2', 'TOC 3', 'TOC 4', 'TOC 5', 'TOC 6', 'TOC 7', 'TOC 8', 'TOC 9'];\n        var styleValues = this.styleLocaleValue(styleLocale, locale);\n        this.listViewInstance = new ListView({ dataSource: styleValues, cssClass: 'e-toc-list-view' });\n        this.listViewInstance.appendTo(listViewDiv);\n        this.listViewInstance.addEventListener('select', this.selectHandler);\n        rightBottomGeneralDiv.appendChild(listViewDiv);\n        var modifyButtonDiv = createElement('div', { className: 'e-de-toc-modify-button' });\n        rightBottomGeneralDiv.appendChild(modifyButtonDiv);\n        var modifyElement = createElement('button', { innerHTML: locale.getConstant('Modify'), id: 'modify' });\n        modifyButtonDiv.appendChild(modifyElement);\n        var modifyButton = new Button({ cssClass: 'e-btn e-flat' });\n        modifyButton.appendTo(modifyElement);\n        modifyElement.addEventListener('click', this.showStyleDialog);\n        if (isRtl) {\n            resetButtonDiv.classList.add('e-de-rtl');\n            tocStylesLabel.classList.add('e-de-rtl');\n            textBoxDiv.classList.add('e-de-rtl');\n            listViewDiv.classList.add('e-de-rtl');\n            modifyButtonDiv.classList.add('e-de-rtl');\n        }\n    };\n    /**\n     * @private\n     */\n    TableOfContentsDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTableOfContentDialog(localValue, this.owner.owner.enableRtl);\n        }\n        this.owner.dialog.header = localValue.getConstant('Table of Contents');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadTableofContentDialog;\n        this.owner.dialog.close = this.closeTableOfContentDialog;\n        this.owner.dialog.buttons = [{\n                click: this.applyTableOfContentProperties,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-toc-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-toc-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    TableOfContentsDialog.prototype.checkLevel = function () {\n        if (this.heading1.value !== '') {\n            this.showLevel.value = 1;\n        }\n        if (this.heading2.value !== '') {\n            this.showLevel.value = 2;\n        }\n        if (this.heading3.value !== '') {\n            this.showLevel.value = 3;\n        }\n        if (this.heading4.value !== '') {\n            this.showLevel.value = 4;\n        }\n        if (this.heading5.value !== '') {\n            this.showLevel.value = 5;\n        }\n        if (this.heading6.value !== '') {\n            this.showLevel.value = 6;\n        }\n        if (this.heading7.value !== '') {\n            this.showLevel.value = 7;\n        }\n        if (this.heading8.value !== '') {\n            this.showLevel.value = 8;\n        }\n        if (this.heading9.value !== '') {\n            this.showLevel.value = 9;\n        }\n    };\n    TableOfContentsDialog.prototype.getElementValue = function (element) {\n        switch (element) {\n            case this.heading1:\n                return '1';\n            case this.heading2:\n                return '2';\n            case this.heading3:\n                return '3';\n            case this.heading4:\n                return '4';\n            case this.heading5:\n                return '5';\n            case this.heading6:\n                return '6';\n            case this.heading7:\n                return '7';\n            case this.heading8:\n                return '8';\n            case this.heading9:\n                return '9';\n            default:\n                return '1';\n        }\n    };\n    TableOfContentsDialog.prototype.getHeadingLevel = function (index) {\n        switch (index) {\n            case 1:\n                return parseInt(this.heading1.value);\n            case 2:\n                return parseInt(this.heading2.value);\n            case 3:\n                return parseInt(this.heading3.value);\n            case 4:\n                return parseInt(this.heading4.value);\n            case 5:\n                return parseInt(this.heading5.value);\n            case 6:\n                return parseInt(this.heading6.value);\n            case 7:\n                return parseInt(this.heading7.value);\n            case 8:\n                return parseInt(this.heading8.value);\n            case 9:\n                return parseInt(this.heading9.value);\n            default:\n                return 0;\n        }\n    };\n    TableOfContentsDialog.prototype.applyLevelSetting = function (tocSettings) {\n        tocSettings.levelSettings = {};\n        var headingPrefix = 'Heading ';\n        var newStartLevel = 0;\n        var newEndLevel = 0;\n        var isEndLevel = false;\n        for (var i = 1; i <= tocSettings.endLevel; i++) {\n            var outlineLevel = this.getHeadingLevel(i);\n            if (i === outlineLevel) {\n                if (newStartLevel === 0) {\n                    newStartLevel = i;\n                    isEndLevel = false;\n                }\n                if (!isEndLevel) {\n                    newEndLevel = i;\n                }\n            }\n            else {\n                isEndLevel = true;\n                if (outlineLevel !== 0) {\n                    var headingStyle = headingPrefix + i.toString();\n                    tocSettings.levelSettings[headingStyle] = outlineLevel;\n                }\n            }\n        }\n        tocSettings.startLevel = newStartLevel;\n        tocSettings.endLevel = newEndLevel;\n        if (this.normal.value !== '') {\n            tocSettings.levelSettings['Normal'] = +this.normal.value;\n        }\n    };\n    /**\n     * @private\n     */\n    TableOfContentsDialog.prototype.destroy = function () {\n        if (this.pageNumber) {\n            this.pageNumber.destroy();\n            this.pageNumber = undefined;\n        }\n        if (this.rightAlign) {\n            this.rightAlign.destroy();\n            this.rightAlign = undefined;\n        }\n        if (this.tabLeader) {\n            this.tabLeader.destroy();\n            this.tabLeader = undefined;\n        }\n        if (this.showLevel) {\n            this.showLevel.destroy();\n            this.showLevel = undefined;\n        }\n        if (this.hyperlink) {\n            this.hyperlink.destroy();\n            this.hyperlink = undefined;\n        }\n        if (this.style) {\n            this.style.destroy();\n            this.style = undefined;\n        }\n        if (this.outline) {\n            this.outline.destroy();\n            this.outline = undefined;\n        }\n        if (this.listViewInstance) {\n            this.listViewInstance.destroy();\n            this.listViewInstance = undefined;\n        }\n        this.heading1 = undefined;\n        this.heading2 = undefined;\n        this.heading3 = undefined;\n        this.heading4 = undefined;\n        this.heading5 = undefined;\n        this.heading6 = undefined;\n        this.heading7 = undefined;\n        this.heading8 = undefined;\n        this.heading9 = undefined;\n        this.normal = undefined;\n        this.textBoxInput = undefined;\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var count = 0; count < this.target.childNodes.length; count++) {\n                this.target.removeChild(this.target.childNodes[count]);\n                count--;\n            }\n            this.target = undefined;\n        }\n    };\n    return TableOfContentsDialog;\n}());\nexport { TableOfContentsDialog };\n","import { CheckBox } from '@syncfusion/ej2-buttons';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WTableFormat } from '../index';\nimport { isNullOrUndefined, L10n, createElement } from '@syncfusion/ej2-base';\nimport { CellOptionsDialog } from './index';\n/**\n * The Table options dialog is used to modify default cell margins and cell spacing of selected table.\n */\nvar TableOptionsDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableOptionsDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.applyTableCellProperties = function () {\n            var tableFormat = _this.owner.selection.tableFormat;\n            if (!isNullOrUndefined(_this.bottomMarginBox.value || _this.leftMarginBox.value\n                || _this.rightMarginBox.value || _this.topMarginBox.value || _this.cellSpaceTextBox.value)\n                && (tableFormat.bottomMargin !== _this.bottomMarginBox.value\n                    || tableFormat.leftMargin !== _this.leftMarginBox.value\n                    || tableFormat.rightMargin !== _this.rightMarginBox.value\n                    || tableFormat.topMargin !== _this.topMarginBox.value\n                    || tableFormat.cellSpacing !== _this.cellSpaceTextBox.value)) {\n                _this.owner.owner.tablePropertiesDialogModule.isTableOptionsUpdated = true;\n                _this.applyTableOptions(_this.tableFormat);\n                _this.owner.owner.tablePropertiesDialogModule.applyTableSubProperties();\n            }\n            _this.closeCellMarginsDialog();\n        };\n        /**\n         * @private\n         */\n        this.closeCellMarginsDialog = function () {\n            _this.owner.dialog.hide();\n            _this.owner.dialog.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.changeAllowSpaceCheckBox = function () {\n            if (_this.allowSpaceCheckBox.checked) {\n                _this.cellSpaceTextBox.enabled = true;\n            }\n            else {\n                _this.cellSpaceTextBox.enabled = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.removeEvents = function () {\n            _this.owner.dialog2.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        this.owner = viewer;\n    }\n    Object.defineProperty(TableOptionsDialog.prototype, \"tableFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.tableFormatIn)) {\n                return this.tableFormatIn = new WTableFormat();\n            }\n            return this.tableFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.getModuleName = function () {\n        return 'TableOptionsDialog';\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.initTableOptionsDialog = function (localValue, isRtl) {\n        var instance = this.owner;\n        this.target = createElement('div', {\n            id: this.owner.owner.containerId + '_insertCellMarginsDialog', className: 'e-de-table-options-dlg'\n        });\n        var innerDiv = createElement('div', { styles: 'width: 475px;position: relative;height: 180px;' });\n        var innerDivLabel = createElement('Label', {\n            id: this.target.id + '_innerDivLabel', className: 'e-de-cell-dia-options-label',\n            innerHTML: localValue.getConstant('Default cell margins')\n        });\n        innerDiv.appendChild(innerDivLabel);\n        CellOptionsDialog.getCellMarginDialogElements(this, innerDiv, localValue);\n        var div = createElement('div', { styles: 'width: 475px; position: relative;' });\n        var cellSpaceLabel = createElement('Label', {\n            className: 'e-de-cell-dia-options-label',\n            id: this.target.id + '_cellSpaceLabel'\n        });\n        cellSpaceLabel.innerHTML = localValue.getConstant('Default cell spacing');\n        div.appendChild(cellSpaceLabel);\n        var table2 = createElement('TABLE', {\n            styles: 'height: 30px;padding-bottom: 15px;'\n        });\n        var tr3 = createElement('tr');\n        var td5 = createElement('td');\n        var allowSpaceCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_cellcheck'\n        });\n        var td6Padding;\n        if (isRtl) {\n            td6Padding = 'padding-right:15px;';\n        }\n        else {\n            td6Padding = 'padding-left:15px;';\n        }\n        var td6 = createElement('td', { styles: td6Padding, });\n        this.cellspacingTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_cellspacing'\n        });\n        td5.appendChild(allowSpaceCheckBox);\n        td6.appendChild(this.cellspacingTextBox);\n        tr3.appendChild(td5);\n        tr3.appendChild(td6);\n        table2.appendChild(tr3);\n        div.appendChild(table2);\n        var divBtn = document.createElement('div');\n        this.target.appendChild(div);\n        this.target.appendChild(divBtn);\n        this.cellSpaceTextBox = new NumericTextBox({\n            value: 0, min: 0, max: 264.5, width: 150,\n            decimals: 2, enablePersistence: false\n        });\n        this.cellSpaceTextBox.appendTo(this.cellspacingTextBox);\n        this.allowSpaceCheckBox = new CheckBox({\n            label: localValue.getConstant('Allow spacing between cells'),\n            change: this.changeAllowSpaceCheckBox,\n            enableRtl: isRtl,\n            cssClass: 'e-de-tbl-margin-sub-header',\n        });\n        this.allowSpaceCheckBox.appendTo(allowSpaceCheckBox);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.loadCellMarginsDialog = function () {\n        var tableFormat = this.owner.selection.tableFormat;\n        this.cellSpaceTextBox.value = tableFormat.cellSpacing;\n        this.bottomMarginBox.value = tableFormat.bottomMargin;\n        this.topMarginBox.value = tableFormat.topMargin;\n        this.rightMarginBox.value = tableFormat.rightMargin;\n        this.leftMarginBox.value = tableFormat.leftMargin;\n        if (tableFormat.cellSpacing > 0) {\n            this.allowSpaceCheckBox.checked = true;\n            this.cellSpaceTextBox.enabled = true;\n        }\n        else {\n            this.allowSpaceCheckBox.checked = false;\n            this.cellSpaceTextBox.enabled = false;\n        }\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applySubTableOptions = function (tableFormat) {\n        this.owner.owner.editorHistory.initComplexHistory(this.owner.selection, 'TableMarginsSelection');\n        this.applyTableOptionsHistory(tableFormat);\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.owner.editorHistory.updateComplexHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applyTableOptionsHelper = function (tableFormat) {\n        this.applySubTableOptionsHelper(tableFormat);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applyTableOptionsHistory = function (tableFormat) {\n        this.owner.owner.editorModule.initHistory('TableOptions');\n        this.applySubTableOptionsHelper(tableFormat);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applySubTableOptionsHelper = function (tableFormat) {\n        var ownerTable = this.owner.selection.start.currentWidget.paragraph.associatedCell.ownerTable;\n        ownerTable = ownerTable.combineWidget(this.owner);\n        var currentTableFormat = ownerTable.tableFormat;\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentBaseHistoryInfo)) {\n            this.owner.owner.editorHistory.currentBaseHistoryInfo.addModifiedTableOptions(currentTableFormat);\n        }\n        currentTableFormat.cellSpacing = tableFormat.cellSpacing;\n        currentTableFormat.leftMargin = tableFormat.leftMargin;\n        currentTableFormat.topMargin = tableFormat.topMargin;\n        currentTableFormat.rightMargin = tableFormat.rightMargin;\n        currentTableFormat.bottomMargin = tableFormat.bottomMargin;\n        this.owner.owner.tablePropertiesDialogModule.calculateGridValue(ownerTable);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applyTableOptions = function (tableFormat) {\n        tableFormat.leftMargin = this.leftMarginBox.value;\n        tableFormat.topMargin = this.topMarginBox.value;\n        tableFormat.bottomMargin = this.bottomMarginBox.value;\n        tableFormat.rightMargin = this.rightMarginBox.value;\n        if (this.allowSpaceCheckBox.checked) {\n            tableFormat.cellSpacing = this.cellSpaceTextBox.value;\n        }\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.show = function () {\n        var documentLocale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        documentLocale.setLocale(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTableOptionsDialog(documentLocale, this.owner.owner.enableRtl);\n        }\n        this.loadCellMarginsDialog();\n        this.owner.dialog.header = documentLocale.getConstant('Table Options');\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = undefined;\n        this.owner.dialog.position = { X: 'center', Y: 'center' };\n        //  this.owner.dialog.cssClass = 'e-de-table-margin-size';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.open = undefined;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.removeEvents;\n        this.owner.dialog.buttons = [{\n                click: this.applyTableCellProperties,\n                buttonModel: { content: documentLocale.getConstant('Ok'), cssClass: 'e-flat e-table-cell-okay', isPrimary: true }\n            },\n            {\n                click: this.closeCellMarginsDialog,\n                buttonModel: { content: documentLocale.getConstant('Cancel'), cssClass: 'e-flat e-table-cell-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var p = 0; p < this.target.childNodes.length; p++) {\n                this.target.removeChild(this.target.childNodes[p]);\n                p--;\n            }\n            this.target = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        this.owner = undefined;\n        this.cellspacingTextBox = undefined;\n        this.allowSpaceCheckBox = undefined;\n    };\n    return TableOptionsDialog;\n}());\nexport { TableOptionsDialog };\n","import { createElement, isNullOrUndefined, L10n } from '@syncfusion/ej2-base';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WTableFormat, WRowFormat, WCellFormat } from '../format/index';\nimport { CheckBox, RadioButton } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { Tab } from '@syncfusion/ej2-navigations';\nimport { classList } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * The Table properties dialog is used to modify properties of selected table.\n */\nvar TablePropertiesDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TablePropertiesDialog(viewer) {\n        var _this = this;\n        this.hasTableWidth = false;\n        this.hasCellWidth = false;\n        this.bidi = false;\n        /**\n         * @private\n         */\n        this.isTableBordersAndShadingUpdated = false;\n        /**\n         * @private\n         */\n        this.isCellBordersAndShadingUpdated = false;\n        this.tabObj = undefined;\n        this.localValue = undefined;\n        /**\n         * @private\n         */\n        this.isCellOptionsUpdated = false;\n        /**\n         * @private\n         */\n        this.isTableOptionsUpdated = false;\n        this.onBeforeOpen = function () {\n            _this.owner.updateFocus();\n            _this.loadTableProperties();\n        };\n        /**\n         * @private\n         */\n        this.onCloseTablePropertyDialog = function () {\n            _this.unWireEvent.bind(_this);\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.applyTableProperties = function () {\n            var selection = _this.owner.selection;\n            if (!_this.preferCheckBox.checked && !_this.preferCheckBox.indeterminate) {\n                if (isNullOrUndefined(selection.tableFormat.preferredWidth) || selection.tableFormat.preferredWidth !== 0) {\n                    _this.tableFormat.preferredWidth = 0;\n                    _this.tableFormat.preferredWidthType = 'Point';\n                }\n            }\n            if (_this.tableFormat.hasValue('tableAlignment') && _this.tableFormat.tableAlignment !== 'Left') {\n                if (isNullOrUndefined(selection.tableFormat.leftIndent) || selection.tableFormat.leftIndent !== 0) {\n                    _this.tableFormat.leftIndent = 0;\n                }\n            }\n            if (!_this.rowHeightCheckBox.checked && !_this.rowHeightCheckBox.indeterminate) {\n                if (isNullOrUndefined(selection.rowFormat.height) || selection.rowFormat.height !== 0) {\n                    _this.rowFormat.heightType = 'AtLeast';\n                    _this.rowFormat.height = 0;\n                }\n            }\n            if (!_this.preferredCellWidthCheckBox.checked && !_this.preferredCellWidthCheckBox.indeterminate) {\n                if (isNullOrUndefined(selection.cellFormat.preferredWidth) || selection.cellFormat.preferredWidth === 0) {\n                    _this.cellFormat.preferredWidthType = 'Point';\n                    _this.cellFormat.preferredWidth = 0;\n                }\n            }\n            else {\n                if (_this.cellFormat.preferredWidthType === 'Percent') {\n                    if (!_this.tableFormat.hasValue('preferredWidth') && !_this.tableFormat.hasValue('preferredWidthType')\n                        && _this.owner.selection.start.paragraph.associatedCell.ownerTable.tableFormat.preferredWidth === 0) {\n                        // tslint:disable-next-line:max-line-length\n                        var containerWidth = _this.owner.selection.start.paragraph.associatedCell.ownerTable.getOwnerWidth(true);\n                        var tableWidth = _this.owner.selection.start.paragraph.associatedCell.ownerTable.getTableClientWidth(containerWidth);\n                        _this.tableFormat.preferredWidthType = 'Percent';\n                        _this.tableFormat.preferredWidth = tableWidth / HelperMethods.convertPixelToPoint(_this.owner.clientArea.width) * 100;\n                    }\n                }\n            }\n            if (_this.rowHeightValue) {\n                _this.rowFormat.height = _this.rowHeightValue;\n            }\n            _this.owner.owner.editorModule.initComplexHistory('TableProperties');\n            _this.owner.owner.editorModule.onTableFormat(_this.tableFormat);\n            _this.owner.owner.editorModule.onRowFormat(_this.rowFormat);\n            _this.owner.owner.editorModule.onCellFormat(_this.cellFormat);\n            _this.owner.owner.editorHistory.updateComplexHistory();\n            _this.closeTablePropertiesDialog();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.applyTableSubProperties = function () {\n            if (_this.isCellOptionsUpdated) {\n                var cellFormat = _this.owner.owner.cellOptionsDialogModule.cellFormat;\n                _this.owner.owner.cellOptionsDialogModule.applySubCellOptions(cellFormat);\n            }\n            if (_this.isTableOptionsUpdated) {\n                var tableFormat = _this.owner.owner.tableOptionsDialogModule.tableFormat;\n                _this.owner.owner.tableOptionsDialogModule.applySubTableOptions(tableFormat);\n            }\n            _this.isCellOptionsUpdated = false;\n            _this.isTableOptionsUpdated = false;\n        };\n        /**\n         * @private\n         */\n        this.unWireEvent = function () {\n            //Table Format\n            _this.preferCheckBox.change = undefined;\n            _this.tableWidthBox.change = undefined;\n            _this.tableWidthType.change = undefined;\n            _this.leftIndentBox.change = undefined;\n            //Row Format\n            _this.rowHeightCheckBox.change = undefined;\n            _this.rowHeightBox.change = undefined;\n            _this.rowHeightType.change = undefined;\n            _this.repeatHeader.change = undefined;\n            _this.allowRowBreak.change = undefined;\n            //Cell Format\n            _this.preferredCellWidthCheckBox.change = undefined;\n            _this.cellWidthBox.change = undefined;\n            _this.cellWidthType.change = undefined;\n            _this.cellFormat.destroy();\n            _this.rowFormat.destroy();\n            _this.tableFormat.destroy();\n            _this.rowHeightValue = undefined;\n            _this.owner.dialog2.open = _this.owner.selection.hideCaret.bind(_this.owner);\n        };\n        /**\n         * @private\n         */\n        this.closeTablePropertiesDialog = function () {\n            _this.owner.dialog2.hide();\n            _this.owner.updateFocus();\n        };\n        this.changeBidirectional = function (event) {\n            if (event.value === 'ltr') {\n                _this.rtlButton.checked = !_this.ltrButton.checked;\n                _this.tableFormat.bidi = false;\n            }\n            else {\n                _this.ltrButton.checked = !_this.rtlButton.checked;\n                _this.tableFormat.bidi = true;\n            }\n            if (_this.tableFormat.bidi && _this.tableFormat.tableAlignment === 'Left') {\n                _this.tableFormat.tableAlignment = 'Right';\n            }\n            else if (!_this.tableFormat.bidi && _this.tableFormat.tableAlignment === 'Right') {\n                _this.tableFormat.tableAlignment = 'Left';\n            }\n            _this.activeTableAlignment(_this.tableFormat, true);\n        };\n        /**\n         * @private\n         */\n        this.changeTableCheckBox = function () {\n            var enable = (_this.preferCheckBox.checked || _this.preferCheckBox.indeterminate);\n            _this.tableWidthBox.enabled = enable;\n            _this.tableWidthType.enabled = enable;\n            if (enable) {\n                _this.tableFormat.preferredWidthType = (_this.tableWidthType.value === 'Points') ?\n                    'Point' : _this.tableWidthType.value;\n            }\n            else {\n                _this.tableFormat.preferredWidthType = _this.owner.selection.tableFormat.preferredWidthType;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeTableAlignment = function (event) {\n            _this.updateClassForAlignmentProperties(_this.tableTab);\n            var element = event.target;\n            classList(element, ['e-de-table-alignment-active'], ['e-de-table-properties-alignment']);\n            var bidi = _this.tableFormat.bidi || _this.rtlButton.checked;\n            if ((element.classList.contains('e-de-table-left-alignment') && !bidi) ||\n                (element.classList.contains('e-de-table-right-alignment') && bidi)) {\n                _this.leftIndentBox.enabled = true;\n            }\n            else {\n                _this.leftIndentBox.enabled = false;\n            }\n            _this.tableFormat.tableAlignment = _this.getTableAlignment();\n        };\n        /**\n         * @private\n         */\n        this.changeTableRowCheckBox = function () {\n            _this.rowHeightType.enabled = _this.rowHeightCheckBox.checked;\n            _this.rowHeightBox.enabled = _this.rowHeightCheckBox.checked;\n            if (_this.rowHeightType.enabled) {\n                _this.rowFormat.heightType = _this.rowHeightType.value;\n            }\n            else {\n                _this.rowFormat.heightType = _this.owner.selection.rowFormat.heightType;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeTableCellCheckBox = function () {\n            _this.cellWidthType.enabled = _this.preferredCellWidthCheckBox.checked;\n            _this.cellWidthBox.enabled = _this.preferredCellWidthCheckBox.checked;\n        };\n        /**\n         * @private\n         */\n        this.changeCellAlignment = function (event) {\n            _this.updateClassForCellAlignment(_this.cellTab);\n            var element = event.target;\n            classList(element, ['e-de-table-alignment-active'], ['e-de-tablecell-alignment']);\n            _this.cellFormat.verticalAlignment = _this.getCellAlignment();\n        };\n        //#endregion\n        /**\n         * @private\n         */\n        this.showTableOptionsDialog = function () {\n            _this.owner.owner.tableOptionsDialogModule.show();\n            _this.owner.dialog2.element.style.pointerEvents = 'none';\n        };\n        /**\n         * @private\n         */\n        this.showBordersShadingsPropertiesDialog = function () {\n            _this.owner.owner.bordersAndShadingDialogModule.show();\n            _this.owner.dialog2.element.style.pointerEvents = 'none';\n        };\n        /**\n         * @private\n         */\n        this.showCellOptionsDialog = function () {\n            _this.owner.owner.cellOptionsDialogModule.show();\n            _this.owner.dialog2.element.style.pointerEvents = 'none';\n        };\n        this.owner = viewer;\n    }\n    Object.defineProperty(TablePropertiesDialog.prototype, \"cellFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.cellFormatIn)) {\n                return this.cellFormatIn = new WCellFormat();\n            }\n            return this.cellFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.cellFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TablePropertiesDialog.prototype, \"tableFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.tableFormatIn)) {\n                this.tableFormatIn = new WTableFormat();\n                return this.tableFormatIn;\n            }\n            return this.tableFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.tableFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TablePropertiesDialog.prototype, \"rowFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.rowFormatInternal)) {\n                this.rowFormatInternal = new WRowFormat();\n                return this.rowFormatInternal;\n            }\n            return this.rowFormatInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TablePropertiesDialog.prototype.getModuleName = function () {\n        return 'TablePropertiesDialog';\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.initTablePropertyDialog = function (localValue, isRtl) {\n        this.localValue = localValue;\n        var id = this.owner.owner.containerId + '_TablePropertiesDialog';\n        this.target = createElement('div', { id: id, className: 'e-de-table-properties-dlg' });\n        var ejtabContainer = createElement('div', { id: this.target.id + '_TabContainer' });\n        this.target.appendChild(ejtabContainer);\n        this.tableTab = createElement('div', {\n            id: this.target.id + '_TablePropertiesContentDialogTab', className: 'e-de-table-ppty-dlg-tabs'\n        });\n        this.rowTab = createElement('div', {\n            id: this.target.id + '_RowPropertiesDialogTab', className: 'e-de-table-ppty-dlg-tabs'\n        });\n        this.cellTab = createElement('div', {\n            id: this.target.id + '_CellPropertiesDialogTab', className: 'e-de-table-ppty-dlg-tabs'\n        });\n        var separatorLine = createElement('div', { className: 'e-de-table-dialog-separator-line' });\n        // tslint:disable-next-line:max-line-length\n        var ejtab = createElement('div', { id: this.target.id + '_TablePropertiesDialogTab', className: 'e-de-table-ppty-tab' });\n        var headerContainer = createElement('div', { className: 'e-tab-header' });\n        var tableHeader = createElement('div', {\n            id: this.target.id + '_tableHeader', innerHTML: localValue.getConstant('Table')\n        });\n        var rowHeader = createElement('div', {\n            id: this.target.id + '_rowHeader', innerHTML: localValue.getConstant('Row')\n        });\n        var cellHeader = createElement('div', {\n            id: this.target.id + '_cellHeader', innerHTML: localValue.getConstant('Cell')\n        });\n        headerContainer.appendChild(tableHeader);\n        headerContainer.appendChild(rowHeader);\n        headerContainer.appendChild(cellHeader);\n        var contentContainer = createElement('div', { className: 'e-content' });\n        var tableContent = createElement('div', { id: this.target.id + '_tableContent' });\n        var rowContent = createElement('div', { id: this.target.id + '_rowContent' });\n        var cellContent = createElement('div', { id: this.target.id + '_cellContent' });\n        tableContent.appendChild(this.tableTab);\n        rowContent.appendChild(this.rowTab);\n        cellContent.appendChild(this.cellTab);\n        contentContainer.appendChild(tableContent);\n        contentContainer.appendChild(rowContent);\n        contentContainer.appendChild(cellContent);\n        ejtab.appendChild(headerContainer);\n        ejtab.appendChild(contentContainer);\n        ejtabContainer.appendChild(ejtab);\n        this.initTableProperties(this.tableTab, localValue, this.owner.owner.enableRtl);\n        this.initTableRowProperties(this.rowTab, localValue, this.owner.owner.enableRtl);\n        this.initTableCellProperties(this.cellTab, localValue, this.owner.owner.enableRtl);\n        this.tabObj = new Tab({ enableRtl: isRtl }, ejtab);\n        this.target.appendChild(separatorLine);\n        var alignMentButtons = this.tableTab.getElementsByClassName(this.tableTab.id + 'e-de-table-alignment');\n        for (var i = 0; i < alignMentButtons.length; i++) {\n            alignMentButtons[i].addEventListener('click', this.changeTableAlignment);\n        }\n        var cellAlignment = this.cellTab.getElementsByClassName(this.cellTab.id + 'e-de-table-cell-alignment');\n        for (var i = 0; i < cellAlignment.length; i++) {\n            cellAlignment[i].addEventListener('click', this.changeCellAlignment);\n        }\n        var tableTabHeader = this.tabObj.element.getElementsByClassName('e-item e-toolbar-item')[0];\n        var tableTabHeaderItem = tableTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        var rowTabHeader = this.tabObj.element.getElementsByClassName('e-item e-toolbar-item')[1];\n        var rowTabHeaderItem = rowTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        rowTabHeaderItem.classList.add('e-de-table-ppty-dlg-row-header');\n        var cellTabHeader = this.tabObj.element.getElementsByClassName('e-item e-toolbar-item')[2];\n        var cellTabHeaderItem = cellTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        cellTabHeaderItem.classList.add('e-de-table-ppty-dlg-cell-header');\n        if (isRtl) {\n            tableTabHeaderItem.classList.add('e-de-rtl');\n            this.tabObj.element.getElementsByClassName('e-indicator')[0].style.left = '155px';\n        }\n        else {\n            this.tabObj.element.getElementsByClassName('e-indicator')[0].style.right = '155px';\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTablePropertyDialog(localValue, this.owner.owner.enableRtl);\n        }\n        if (this.owner.selection.caret.style.display !== 'none') {\n            this.owner.selection.caret.style.display = 'none';\n        }\n        this.owner.dialog2.header = localValue.getConstant('Table Properties');\n        this.owner.dialog2.position = { X: 'center', Y: 'center' };\n        this.owner.dialog2.width = 'auto';\n        this.owner.dialog2.height = 'auto';\n        this.owner.dialog2.content = this.target;\n        this.owner.dialog2.beforeOpen = this.onBeforeOpen;\n        this.owner.dialog2.close = this.onCloseTablePropertyDialog;\n        this.owner.dialog2.open = this.wireEvent.bind(this);\n        this.owner.dialog2.buttons = [{\n                click: this.applyTableProperties,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-table-ppty-okay', isPrimary: true }\n            },\n            {\n                click: this.closeTablePropertiesDialog,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-table-ppty-cancel' }\n            }];\n        //this.tabObj.select(0);\n        this.owner.dialog2.dataBind();\n        this.owner.dialog2.show();\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.calculateGridValue = function (table) {\n        table.calculateGrid();\n        table.isGridUpdated = false;\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.owner.selection.owner.isLayoutEnabled = true;\n        this.owner.layout.reLayoutTable(table);\n        this.owner.owner.editorModule.reLayout(this.owner.selection);\n        this.owner.owner.editorModule.updateSelectionTextPosition(true);\n        var history = this.owner.owner.editorHistory;\n        if (history && history.currentBaseHistoryInfo) {\n            if (history.currentBaseHistoryInfo.modifiedProperties.length > 0) {\n                history.currentBaseHistoryInfo.updateSelection();\n            }\n            history.updateHistory();\n        }\n        this.owner.owner.editorModule.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.loadTableProperties = function () {\n        this.setTableProperties();\n        this.setTableRowProperties();\n        this.setTableCellProperties();\n        if (!this.owner.owner.bordersAndShadingDialogModule) {\n            this.bordersAndShadingButton.disabled = true;\n        }\n        else {\n            this.bordersAndShadingButton.disabled = false;\n        }\n        // if (!this.owner.owner.tableOptionsDialogModule) {\n        //     this.tableOptionButton.disabled = true;\n        // } else {\n        this.tableOptionButton.disabled = false;\n        // }\n        // if (!this.owner.owner.cellOptionsDialogModule) {\n        //     this.cellOptionButton.disabled = true;\n        // } else {\n        this.cellOptionButton.disabled = false;\n        // }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.wireEvent = function () {\n        this.owner.selection.hideCaret();\n        //Table Format\n        this.preferCheckBox.change = this.changeTableCheckBox.bind(this);\n        this.tableWidthBox.change = this.onTableWidthChange.bind(this);\n        this.tableWidthType.change = this.onTableWidthTypeChange.bind(this);\n        this.leftIndentBox.change = this.onLeftIndentChange.bind(this);\n        //Row Format\n        this.rowHeightCheckBox.change = this.changeTableRowCheckBox.bind(this);\n        this.rowHeightBox.change = this.onRowHeightChange.bind(this);\n        this.rowHeightType.change = this.onRowHeightTypeChange.bind(this);\n        this.allowRowBreak.change = this.onAllowBreakAcrossPage.bind(this);\n        this.repeatHeader.change = this.onRepeatHeader.bind(this);\n        //Cell Format\n        this.preferredCellWidthCheckBox.change = this.changeTableCellCheckBox.bind(this);\n        this.cellWidthBox.change = this.onCellWidthChange.bind(this);\n        this.cellWidthType.change = this.onCellWidthTypeChange.bind(this);\n    };\n    //#region Table Format\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-func-body-length\n    TablePropertiesDialog.prototype.initTableProperties = function (element, localValue, isRtl) {\n        var container = createElement('div', { id: element.id + '_table_TabContainer' });\n        var sizeHeader = createElement('div', {\n            id: container.id + '_sizeLabel', innerHTML: localValue.getConstant('Size'),\n            styles: 'width:100%;margin:0px;padding-top: 20px;padding-bottom: 0px;', className: 'e-de-table-dialog-options-label'\n        });\n        var parentContainer = createElement('div', { styles: 'display: inline-flex;' });\n        var childContainer1 = createElement('div', {\n            styles: 'float: left;',\n            className: 'e-de-table-container-div'\n        });\n        var childContainer2 = createElement('div', {\n            className: 'e-de-table-ppty-dlg-preferred-width-div'\n        });\n        var child1 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-ppty-dlg-measure-div'\n        });\n        var child2 = createElement('div', {\n            styles: 'display: inline;position: absolute;',\n            className: 'e-de-table-ppty-dlg-measure-drop-down-div'\n        });\n        var childContainer3 = createElement('div');\n        var preferCheckBox = createElement('input', {\n            id: element.id + '_Prefer_Width_CheckBox', attrs: { 'type': 'checkbox' }\n        });\n        this.preferredWidth = createElement('input', { id: element.id + 'preferred_Width' });\n        var controlDiv = createElement('div');\n        var tableWidthType = createElement('select', {\n            innerHTML: '<option>' + localValue.getConstant('Points') +\n                '</option><option>' + localValue.getConstant('Percent') + '</option>', id: element.id + '_width_dropdown'\n        });\n        var labeltext = createElement('label', {\n            innerHTML: localValue.getConstant('Measure in'), styles: 'width: 60px;font-size: 11px; font-weight: normal;'\n        });\n        var alignmentHeader = createElement('div', {\n            innerHTML: localValue.getConstant('Alignment'), className: 'e-de-table-dialog-options-label',\n            styles: 'width: 100%;margin: 0px;padding-bottom: 15px'\n        });\n        var alignmentContainer = createElement('div', { styles: 'height:70px;display:inline-flex' });\n        var classDivName = element.id + 'e-de-table-alignment';\n        var leftAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.left = createElement('div', {\n            className: 'e-icons e-de-table-properties-alignment e-de-table-left-alignment ' + classDivName,\n            id: element.id + '_left_alignment', styles: 'width:54px;height:54px;margin:2px'\n        });\n        leftAlignDiv.appendChild(this.left);\n        var centerAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.center = createElement('div', {\n            className: 'e-icons e-de-table-properties-alignment  e-de-table-center-alignment ' + classDivName,\n            id: element.id + '_center_alignment', styles: 'width:54px;height:54px;margin:2px'\n        });\n        centerAlignDiv.appendChild(this.center);\n        this.right = createElement('div', {\n            styles: 'width:54px;height:54px;margin:2px', id: element.id + '_right_alignment',\n            className: 'e-icons e-de-table-properties-alignment  e-de-table-right-alignment ' + classDivName\n        });\n        var rightAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        rightAlignDiv.appendChild(this.right);\n        var leftlabel = createElement('label', {\n            innerHTML: localValue.getConstant('Left'), className: 'e-de-table-dia-align-label'\n        });\n        var centerlabel = createElement('label', {\n            innerHTML: localValue.getConstant('Center'), className: 'e-de-table-dia-align-label'\n        });\n        var rightlabel = createElement('label', {\n            innerHTML: localValue.getConstant('Right'), className: 'e-de-table-dia-align-label'\n        });\n        var leftIndenetContainer = createElement('div', {\n            className: 'e-de-table-ppty-dlg-left-indent-container'\n        });\n        var leftIndentLabelMargin;\n        var leftIndentBoxMargin;\n        if (isRtl) {\n            leftIndentLabelMargin = 'left: 45px;';\n            leftIndentBoxMargin = 'left: 45px;';\n        }\n        else {\n            leftIndentLabelMargin = 'right: 45px;';\n            leftIndentBoxMargin = 'right: 45px;';\n        }\n        this.indentingLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Indent from left'),\n            styles: 'font-weight: normal;font-size: 11px;position:relative;' + leftIndentLabelMargin\n        });\n        var leftIndentBox = createElement('div', {\n            styles: 'margin-top: 15px;position: relative;' + leftIndentBoxMargin\n        });\n        this.leftIndent = createElement('input', { id: element.id + '_left_indent' });\n        var tableDirHeader = createElement('div', {\n            innerHTML: localValue.getConstant('Table direction'), className: 'e-de-table-dialog-options-label',\n            styles: 'width: 100%;margin: 0px;padding-bottom: 15px;padding-top:20px;'\n        });\n        var tableDirContainer = createElement('div', { styles: 'display:flex' });\n        var rtlDiv = createElement('div', { id: element.id + '_TableDirDiv', className: 'e-de-tbl-rtl-btn-div' });\n        var rtlInputELe = createElement('input', { id: element.id + '_rtlEle' });\n        rtlDiv.appendChild(rtlInputELe);\n        tableDirContainer.appendChild(rtlDiv);\n        var ltrDiv = createElement('div', { id: element.id + '_DirDiv', className: 'e-de-tbl-ltr-btn-div' });\n        var ltrInputELe = createElement('input', { id: element.id + '_ltrEle' });\n        ltrDiv.appendChild(ltrInputELe);\n        tableDirContainer.appendChild(ltrDiv);\n        this.rtlButton = new RadioButton({\n            label: localValue.getConstant('Right-to-left'),\n            value: 'rtl', cssClass: 'e-small', change: this.changeBidirectional,\n            enableRtl: isRtl\n        });\n        this.rtlButton.appendTo(rtlInputELe);\n        this.ltrButton = new RadioButton({\n            label: localValue.getConstant('Left-to-right'),\n            value: 'ltr', cssClass: 'e-small', change: this.changeBidirectional,\n            enableRtl: isRtl\n        });\n        this.ltrButton.appendTo(ltrInputELe);\n        var tableOptionContiner = createElement('div', {\n            className: 'e-de-tbl-dlg-border-btn'\n        });\n        if (isRtl) {\n            tableOptionContiner.style.cssFloat = 'left';\n        }\n        this.bordersAndShadingButton = createElement('button', {\n            innerHTML: localValue.getConstant('Borders and Shading'),\n            id: element.id + '_borders_and_shadings', className: 'e-control e-btn e-flat e-de-ok-button'\n        });\n        this.tableOptionButton = createElement('button', {\n            className: 'e-control e-btn e-flat', innerHTML: localValue.getConstant('Options'),\n            id: element.id + '_table_cellmargin'\n        });\n        this.tableOptionButton.addEventListener('click', this.showTableOptionsDialog);\n        this.bordersAndShadingButton.addEventListener('click', this.showBordersShadingsPropertiesDialog);\n        tableOptionContiner.appendChild(this.bordersAndShadingButton);\n        tableOptionContiner.appendChild(this.tableOptionButton);\n        leftIndenetContainer.appendChild(this.indentingLabel);\n        leftIndentBox.appendChild(this.leftIndent);\n        leftIndenetContainer.appendChild(leftIndentBox);\n        alignmentContainer.appendChild(leftAlignDiv);\n        alignmentContainer.appendChild(centerAlignDiv);\n        alignmentContainer.appendChild(rightAlignDiv);\n        leftAlignDiv.appendChild(leftlabel);\n        centerAlignDiv.appendChild(centerlabel);\n        rightAlignDiv.appendChild(rightlabel);\n        alignmentContainer.appendChild(leftIndenetContainer);\n        container.appendChild(sizeHeader);\n        element.appendChild(container);\n        childContainer1.appendChild(preferCheckBox);\n        parentContainer.appendChild(childContainer1);\n        childContainer2.appendChild(this.preferredWidth);\n        parentContainer.appendChild(childContainer2);\n        controlDiv.appendChild(tableWidthType);\n        child1.appendChild(labeltext);\n        child2.appendChild(controlDiv);\n        childContainer3.appendChild(child1);\n        childContainer3.appendChild(child2);\n        parentContainer.appendChild(childContainer3);\n        element.appendChild(parentContainer);\n        element.appendChild(alignmentHeader);\n        element.appendChild(alignmentContainer);\n        element.appendChild(tableDirHeader);\n        element.appendChild(tableDirContainer);\n        element.appendChild(tableOptionContiner);\n        this.tableWidthBox = new NumericTextBox({\n            value: 0, decimals: 2, min: 0, max: 1584, width: 120, enablePersistence: false\n        });\n        this.tableWidthBox.appendTo(this.preferredWidth);\n        this.leftIndentBox = new NumericTextBox({\n            value: 0, decimals: 2, min: -1584, max: 1584, width: 140, enablePersistence: false\n        });\n        this.leftIndentBox.appendTo(this.leftIndent);\n        this.preferCheckBox = new CheckBox({\n            label: localValue.getConstant('Preferred Width'), enableRtl: isRtl\n        });\n        this.preferCheckBox.appendTo(preferCheckBox);\n        this.tableWidthType = new DropDownList({ width: '120px', enableRtl: isRtl });\n        this.tableWidthType.appendTo(tableWidthType);\n        if (isRtl) {\n            rtlDiv.classList.add('e-de-rtl');\n            childContainer2.classList.add('e-de-rtl');\n            child1.classList.add('e-de-rtl');\n            child2.classList.add('e-de-rtl');\n            leftIndenetContainer.classList.add('e-de-rtl');\n            tableOptionContiner.classList.add('e-de-rtl');\n            this.bordersAndShadingButton.classList.add('e-de-rtl');\n            leftAlignDiv.classList.add('e-de-rtl');\n            centerAlignDiv.classList.add('e-de-rtl');\n            rightAlignDiv.classList.add('e-de-rtl');\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onTableWidthChange = function () {\n        this.tableFormat.preferredWidth = this.tableWidthBox.value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onTableWidthTypeChange = function () {\n        var value;\n        var table = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n        var width = HelperMethods.convertPixelToPoint(this.owner.clientArea.width);\n        if (this.tableWidthType.text === 'Percent' && this.owner.selection.tableFormat.preferredWidthType !== 'Percent') {\n            value = this.tableWidthBox.value / width * 100;\n            this.formatNumericTextBox(this.tableWidthBox, 'Percent', value);\n        }\n        else if (this.tableWidthType.text === 'Points' && this.owner.selection.tableFormat.preferredWidthType !== 'Point') {\n            value = width / 100 * this.tableWidthBox.value;\n            this.formatNumericTextBox(this.tableWidthBox, 'Point', value);\n        }\n        else {\n            if (this.tableWidthBox.format === '#\\'\\%\\'') {\n                if (this.tableWidthType.text === 'Points') {\n                    value = width / 100 * this.tableWidthBox.value;\n                }\n                else {\n                    value = this.tableWidthBox.value;\n                }\n            }\n            else {\n                if (this.tableWidthType.text === 'Percent') {\n                    value = this.tableWidthBox.value / width * 100;\n                }\n                else {\n                    value = this.tableWidthBox.value;\n                }\n            }\n            // tslint:disable-next-line:max-line-length\n            this.formatNumericTextBox(this.tableWidthBox, (this.tableWidthType.text === 'Points') ? 'Point' : this.tableWidthType.text, value);\n        }\n        this.tableFormat.preferredWidthType = (this.tableWidthType.text === 'Points') ? 'Point' : this.tableWidthType.text;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onLeftIndentChange = function () {\n        this.tableFormat.leftIndent = this.leftIndentBox.value;\n    };\n    TablePropertiesDialog.prototype.setTableProperties = function () {\n        //instance of Table Property values\n        var tableFormat = this.owner.selection.tableFormat;\n        var tableHasWidth = tableFormat.preferredWidth > 0;\n        var preferredWidth = tableFormat.preferredWidth;\n        if (isNullOrUndefined(tableFormat.preferredWidth)) {\n            this.preferCheckBox.indeterminate = true;\n            var startTable = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n            var table = startTable.combineWidget(this.owner);\n            preferredWidth = table.tableFormat.preferredWidth;\n        }\n        else {\n            this.preferCheckBox.checked = tableHasWidth;\n        }\n        this.tableWidthBox.enabled = tableHasWidth;\n        this.tableWidthType.enabled = tableHasWidth;\n        this.formatNumericTextBox(this.tableWidthBox, tableFormat.preferredWidthType, preferredWidth);\n        if (tableFormat.preferredWidthType === 'Auto' || tableFormat.preferredWidthType === 'Point') {\n            this.tableWidthType.index = 0;\n        }\n        else {\n            this.tableWidthType.index = 1;\n        }\n        this.activeTableAlignment(tableFormat, false);\n        if (tableFormat.bidi) {\n            this.rtlButton.checked = true;\n            this.ltrButton.checked = false;\n        }\n        else {\n            this.ltrButton.checked = true;\n            this.rtlButton.checked = false;\n        }\n    };\n    TablePropertiesDialog.prototype.activeTableAlignment = function (tableFormat, isChanged) {\n        var tableAlignment = isChanged ? this.tableFormat.tableAlignment : undefined;\n        // Consider the TableAlignment based on the Bidirectional property.\n        if (isNullOrUndefined(tableAlignment)) {\n            if (tableFormat.bidi) {\n                if (tableFormat.tableAlignment === 'Left') {\n                    tableAlignment = 'Right';\n                }\n                else if (tableFormat.tableAlignment === 'Right') {\n                    tableAlignment = 'Left';\n                }\n            }\n            else {\n                tableAlignment = tableFormat.tableAlignment;\n            }\n        }\n        if (tableFormat.bidi) {\n            this.leftIndentBox.enabled = tableAlignment === 'Right';\n            this.indentingLabel.innerHTML = this.localValue.getConstant('Indent from right');\n        }\n        else {\n            this.leftIndentBox.enabled = tableAlignment === 'Left';\n            this.indentingLabel.innerHTML = this.localValue.getConstant('Indent from left');\n        }\n        this.leftIndentBox.value = tableFormat.leftIndent;\n        classList(this.left, [], ['e-de-table-alignment-active']);\n        classList(this.right, [], ['e-de-table-alignment-active']);\n        classList(this.center, [], ['e-de-table-alignment-active']);\n        if (tableAlignment === 'Left') {\n            this.left.classList.add('e-de-table-alignment-active');\n        }\n        else if (tableAlignment === 'Center') {\n            this.center.classList.add('e-de-table-alignment-active');\n        }\n        else if (tableAlignment === 'Right') {\n            this.right.classList.add('e-de-table-alignment-active');\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.getTableAlignment = function () {\n        var id = this.tableTab.id;\n        var groupButtons = this.tableTab.getElementsByClassName(id + 'e-de-table-alignment');\n        for (var j = 0; j < groupButtons.length; j++) {\n            var groupButton = groupButtons[j];\n            if (groupButton.classList.contains('e-de-table-alignment-active')) {\n                if (j === 0) {\n                    return this.ltrButton.checked ? 'Left' : 'Right';\n                }\n                else if (j === 1) {\n                    return 'Center';\n                }\n                else {\n                    return this.ltrButton.checked ? 'Right' : 'Left';\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.updateClassForAlignmentProperties = function (element) {\n        var id = element.id;\n        var groupButtons = element.getElementsByClassName(id + 'e-de-table-alignment');\n        for (var j = 0; j < groupButtons.length; j++) {\n            var groupButton = groupButtons[j];\n            if (groupButton.classList.contains('e-de-table-alignment-active')) {\n                classList(groupButton, ['e-de-table-properties-alignment'], ['e-de-table-alignment-active']);\n            }\n        }\n    };\n    //#endregion\n    //#region Row Format\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.initTableRowProperties = function (element, localValue, isRtl) {\n        var rowDiv = createElement('div', { styles: 'width: 100%;' });\n        var sizeLabeldiv = createElement('div', {\n            innerHTML: localValue.getConstant('Size'),\n            styles: 'width: 100%;padding-top: 20px;padding-bottom: 10px;',\n            className: 'e-de-table-dialog-options-label'\n        });\n        var parentDiv = createElement('div', { styles: 'display: inline-flex;width: 100%;' });\n        var childDiv1Float;\n        if (isRtl) {\n            childDiv1Float = 'float: right;';\n        }\n        else {\n            childDiv1Float = 'float: left;';\n        }\n        var childDiv1 = createElement('div', {\n            className: 'e-de-table-header-div', styles: 'margin-top:9px'\n        });\n        var rowHeightCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: element.id + '_height_CheckBox'\n        });\n        var childdiv2 = createElement('div', {\n            className: 'e-de-row-ht-top'\n        });\n        this.rowHeight = createElement('input', {\n            attrs: { 'type': 'text' }, 'id': element.id + '_table_row_height'\n        });\n        var child2Float;\n        if (isRtl) {\n            child2Float = 'float: left;';\n        }\n        else {\n            child2Float = 'float: right;';\n        }\n        var child2 = createElement('div', { className: 'e-de-ht-wdth-type' });\n        var child3 = createElement('div');\n        var child4 = createElement('div');\n        var controlDiv = createElement('div');\n        var rowHeightType = createElement('select', {\n            innerHTML: '<option>' + localValue.getConstant('At least')\n                + '</option><option>' + localValue.getConstant('Exactly') + '</option>',\n            id: element.id + '_height_type'\n        });\n        var labeltext = createElement('label', {\n            innerHTML: localValue.getConstant('Row height is'), styles: 'font-size: 11px;font-weight: normal;width: 75px;'\n        });\n        rowDiv.appendChild(sizeLabeldiv);\n        element.appendChild(rowDiv);\n        childDiv1.appendChild(rowHeightCheckBox);\n        parentDiv.appendChild(childDiv1);\n        childdiv2.appendChild(this.rowHeight);\n        parentDiv.appendChild(childdiv2);\n        controlDiv.appendChild(rowHeightType);\n        child3.appendChild(labeltext);\n        child4.appendChild(controlDiv);\n        child2.appendChild(child3);\n        child2.appendChild(child4);\n        parentDiv.appendChild(child2);\n        element.appendChild(parentDiv);\n        var alignmentDiv = createElement('div', {\n            innerHTML: localValue.getConstant('Options'), styles: 'width: 100%;',\n            className: 'e-de-table-dialog-options-label'\n        });\n        // tslint:disable-next-line:max-line-length\n        var allowRowContainer = createElement('div', { className: 'e-de-table-ppty-options-break' });\n        var repeatHeaderContaniner = createElement('div', { className: 'e-de-table-ppty-options-header-row' });\n        var allowRowBreak = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: element.id + '_allow_row_break'\n        });\n        var repeatHeader = createElement('input', {\n            attrs: { 'type': 'checkbox' }, 'id': element.id + '_repeat_header'\n        });\n        allowRowContainer.appendChild(allowRowBreak);\n        repeatHeaderContaniner.appendChild(repeatHeader);\n        element.appendChild(alignmentDiv);\n        element.appendChild(allowRowContainer);\n        element.appendChild(repeatHeaderContaniner);\n        this.rowHeightBox = new NumericTextBox({\n            value: 0, decimals: 2, min: 0, max: 1584, width: 120, enablePersistence: false\n        });\n        this.rowHeightBox.appendTo(this.rowHeight);\n        this.rowHeightCheckBox = new CheckBox({\n            label: localValue.getConstant('Specify height'),\n            enableRtl: isRtl\n        });\n        this.rowHeightCheckBox.appendTo(rowHeightCheckBox);\n        this.rowHeightType = new DropDownList({ width: '120px', enableRtl: isRtl });\n        this.rowHeightType.appendTo(rowHeightType);\n        this.allowRowBreak = new CheckBox({\n            label: localValue.getConstant('Allow row to break across pages'),\n            enableRtl: isRtl\n        });\n        this.allowRowBreak.appendTo(allowRowBreak);\n        this.repeatHeader = new CheckBox({\n            label: localValue.getConstant('Repeat as header row at the top of each page'),\n            enableRtl: isRtl\n        });\n        this.repeatHeader.appendTo(repeatHeader);\n        if (isRtl) {\n            child3.classList.add('e-de-rtl');\n            child4.classList.add('e-de-rtl');\n            childdiv2.classList.add('e-de-rtl');\n        }\n    };\n    TablePropertiesDialog.prototype.setTableRowProperties = function () {\n        var rowFormat = this.owner.selection.rowFormat;\n        var enableRowHeight = (rowFormat.height > 0 || rowFormat.heightType === 'Exactly');\n        //instance of table row values\n        if (enableRowHeight) {\n            this.rowHeightCheckBox.checked = true;\n        }\n        else {\n            if (rowFormat.heightType === undefined) {\n                this.rowHeightCheckBox.indeterminate = true;\n                enableRowHeight = true;\n            }\n            else {\n                this.rowHeightCheckBox.checked = false;\n            }\n        }\n        this.rowHeightBox.enabled = enableRowHeight;\n        this.rowHeightType.enabled = enableRowHeight;\n        // let enabledHeader: boolean = this.enableRepeatHeader() ? false : true;\n        var enabledHeader = true;\n        if (isNullOrUndefined(this.owner.selection.rowFormat.isHeader)) {\n            this.repeatHeader.indeterminate = true;\n            this.repeatHeader.disabled = true;\n        }\n        else if (this.owner.selection.rowFormat.isHeader) {\n            this.repeatHeader.checked = !enabledHeader;\n            this.repeatHeader.indeterminate = enabledHeader;\n            this.repeatHeader.disabled = enabledHeader;\n        }\n        else {\n            this.repeatHeader.checked = false;\n            this.repeatHeader.indeterminate = false;\n            this.repeatHeader.disabled = enabledHeader;\n        }\n        if (isNullOrUndefined(rowFormat.allowBreakAcrossPages)) {\n            this.allowRowBreak.indeterminate = true;\n        }\n        else {\n            this.allowRowBreak.checked = rowFormat.allowBreakAcrossPages;\n        }\n        this.rowHeightBox.value = rowFormat.height;\n        if (rowFormat.heightType === 'Auto' || rowFormat.heightType === 'AtLeast') {\n            this.rowHeightType.index = 0;\n        }\n        else {\n            this.rowHeightType.index = 1;\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onRowHeightChange = function () {\n        this.rowHeightValue = this.rowHeightBox.value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onRowHeightTypeChange = function () {\n        this.rowFormat.heightType = this.rowHeightType.text;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onAllowBreakAcrossPage = function () {\n        this.rowFormat.allowBreakAcrossPages = this.allowRowBreak.checked;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onRepeatHeader = function () {\n        this.rowFormat.isHeader = this.repeatHeader.checked;\n    };\n    /**\n     * @private\n     */\n    // public enableRepeatHeader(): boolean {\n    //     let isFirstRow: number = 0;\n    //     for (let i: number = 0; i < this.owner.selection.selectionRanges.length; i++) {\n    //         let range: SelectionRange = this.owner.selection.selectionRanges.getRange(i);\n    //         let table: WTable = range.start.paragraph.associatedCell.ownerTable;\n    //         if (table.childNodes.indexOf(range.start.paragraph.associatedCell.ownerRow) === 0 ||\n    //             table.childNodes.indexOf(range.start.paragraph.associatedCell.ownerRow) === 0) {\n    //             isFirstRow++;\n    //         }\n    //     }\n    //     return isFirstRow === this.owner.selection.selectionRanges.length;\n    // }\n    //#endregion\n    //#region Cell Format\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-func-body-length\n    TablePropertiesDialog.prototype.initTableCellProperties = function (element, localValue, isRtl) {\n        var sizeDiv = createElement('div', { styles: 'width: 100%;' });\n        var div = createElement('div', {\n            innerHTML: localValue.getConstant('Size'), className: 'e-de-table-dialog-options-label',\n            styles: 'width: 100%;padding-top: 20px;padding-bottom: 10px;',\n        });\n        var parentdiv = createElement('div', { styles: 'width: 100%;display: inline-flex;' });\n        var childdiv1Float;\n        if (isRtl) {\n            childdiv1Float = 'float: right';\n        }\n        else {\n            childdiv1Float = 'float: left';\n        }\n        var childdiv1 = createElement('div', {\n            className: 'e-de-table-cell-header-div', styles: 'margin-top:9px'\n        });\n        var preferredCellWidthCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: element.id + '_Prefer_Width_CheckBox_cell'\n        });\n        var childdiv2 = createElement('div', {\n            styles: 'padding:0px 20px',\n        });\n        this.preferredCellWidth = createElement('input', {\n            id: element.id + 'tablecell_Width_textBox', attrs: { 'type': 'text' }\n        });\n        var child2Float;\n        if (isRtl) {\n            child2Float = 'float: left;';\n        }\n        else {\n            child2Float = 'float: right;';\n        }\n        var child2 = createElement('div', {\n            className: 'e-de-ht-wdth-type'\n        });\n        var child3 = createElement('div');\n        var child4Float;\n        if (isRtl) {\n            child4Float = 'float: left;';\n        }\n        else {\n            child4Float = 'float: right;';\n        }\n        var child4 = createElement('div');\n        var controlDiv = createElement('div');\n        var cellWidthType = createElement('select', {\n            innerHTML: '<option>' + localValue.getConstant('Points') + '</option><option>' +\n                localValue.getConstant('Percent') + '</option>', 'id': element.id + '_measure_type_cell'\n        });\n        var labeltext = createElement('label', {\n            innerHTML: localValue.getConstant('Measure in'),\n            styles: 'font-size: 11px;font-weight: normal;'\n        });\n        sizeDiv.appendChild(div);\n        element.appendChild(sizeDiv);\n        childdiv1.appendChild(preferredCellWidthCheckBox);\n        parentdiv.appendChild(childdiv1);\n        childdiv2.appendChild(this.preferredCellWidth);\n        parentdiv.appendChild(childdiv2);\n        controlDiv.appendChild(cellWidthType);\n        child3.appendChild(labeltext);\n        child4.appendChild(controlDiv);\n        child2.appendChild(child3);\n        child2.appendChild(child4);\n        parentdiv.appendChild(child2);\n        element.appendChild(parentdiv);\n        var alignmentDiv = createElement('div', {\n            innerHTML: localValue.getConstant('Vertical alignment'),\n            styles: 'width: 100%;margin: 0px;',\n            className: 'e-de-table-dialog-options-label'\n        });\n        var classDivName = element.id + 'e-de-table-cell-alignment';\n        var divAlignment = createElement('div', {\n            styles: 'width: 100%;height: 100px;'\n        });\n        var divStyle = 'width:54px;height:54px;margin:2px;border-style:solid;border-width:1px';\n        var topAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.cellTopAlign = createElement('div', {\n            styles: divStyle, id: element.id + '_cell_top-alignment',\n            className: 'e-icons e-de-tablecell-alignment  e-de-tablecell-top-alignment ' + classDivName\n        });\n        topAlignDiv.appendChild(this.cellTopAlign);\n        var centerAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.cellCenterAlign = createElement('div', {\n            styles: divStyle, id: element.id + '_cell_center-alignment',\n            className: 'e-icons e-de-tablecell-alignment  e-de-tablecell-center-alignment ' + classDivName\n        });\n        centerAlignDiv.appendChild(this.cellCenterAlign);\n        var bottomAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.cellBottomAlign = createElement('div', {\n            styles: divStyle, id: element.id + '_cell_bottom-alignment',\n            className: 'e-icons e-de-tablecell-alignment e-de-tablecell-bottom-alignment  ' + classDivName\n        });\n        bottomAlignDiv.appendChild(this.cellBottomAlign);\n        var topLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Top'), className: 'e-de-table-dia-align-label'\n        });\n        var centerLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Center'), className: 'e-de-table-dia-align-label'\n        });\n        var bottomLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Bottom'), className: 'e-de-table-dia-align-label'\n        });\n        this.cellOptionButton = createElement('button', {\n            innerHTML: localValue.getConstant('Options'), id: element.id + '_table_cellmargin',\n            className: 'e-control e-btn e-flat',\n        });\n        this.cellOptionButton.style.cssFloat = isRtl ? 'left' : 'right';\n        divAlignment.appendChild(topAlignDiv);\n        divAlignment.appendChild(centerAlignDiv);\n        divAlignment.appendChild(bottomAlignDiv);\n        topAlignDiv.appendChild(topLabel);\n        centerAlignDiv.appendChild(centerLabel);\n        bottomAlignDiv.appendChild(bottomLabel);\n        element.appendChild(alignmentDiv);\n        element.appendChild(divAlignment);\n        element.appendChild(this.cellOptionButton);\n        this.cellOptionButton.addEventListener('click', this.showCellOptionsDialog);\n        this.cellWidthBox = new NumericTextBox({\n            value: 0, decimals: 2, min: 0, max: 1584, width: 120, enablePersistence: false\n        });\n        this.cellWidthBox.appendTo(this.preferredCellWidth);\n        this.preferredCellWidthCheckBox = new CheckBox({ label: localValue.getConstant('Preferred Width'), enableRtl: isRtl });\n        this.preferredCellWidthCheckBox.appendTo(preferredCellWidthCheckBox);\n        this.cellWidthType = new DropDownList({ width: '120px', enableRtl: isRtl });\n        this.cellWidthType.appendTo(cellWidthType);\n        if (isRtl) {\n            childdiv2.classList.add('e-de-rtl');\n            child3.classList.add('e-de-rtl');\n            child4.classList.add('e-de-rtl');\n            this.cellOptionButton.classList.add('e-de-rtl');\n            topAlignDiv.classList.add('e-de-rtl');\n            centerAlignDiv.classList.add('e-de-rtl');\n            bottomAlignDiv.classList.add('e-de-rtl');\n        }\n    };\n    TablePropertiesDialog.prototype.setTableCellProperties = function () {\n        var cellFormat = this.owner.selection.cellFormat;\n        //instance of table cell Values\n        this.hasCellWidth = cellFormat.preferredWidth > 0;\n        var preferredWidth = cellFormat.preferredWidth;\n        if (isNullOrUndefined(cellFormat.preferredWidth)) {\n            this.preferredCellWidthCheckBox.indeterminate = true;\n            preferredWidth = this.owner.selection.start.paragraph.associatedCell.cellFormat.preferredWidth;\n        }\n        else {\n            this.preferredCellWidthCheckBox.checked = this.hasCellWidth;\n        }\n        this.cellWidthBox.enabled = this.hasCellWidth;\n        this.cellWidthType.enabled = this.hasCellWidth;\n        if (cellFormat.preferredWidthType === 'Auto' || cellFormat.preferredWidthType === 'Point') {\n            this.cellWidthType.index = 0;\n        }\n        else {\n            this.cellWidthType.index = 1;\n        }\n        this.formatNumericTextBox(this.cellWidthBox, cellFormat.preferredWidthType, preferredWidth);\n        classList(this.cellTopAlign, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n        classList(this.cellCenterAlign, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n        classList(this.cellBottomAlign, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n        if (cellFormat.verticalAlignment === 'Top') {\n            this.cellTopAlign.classList.add('e-de-table-alignment-active');\n        }\n        else if (cellFormat.verticalAlignment === 'Center') {\n            this.cellCenterAlign.classList.add('e-de-table-alignment-active');\n        }\n        else if (cellFormat.verticalAlignment === 'Bottom') {\n            this.cellBottomAlign.classList.add('e-de-table-alignment-active');\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.updateClassForCellAlignment = function (element) {\n        var cellAlignments = element.getElementsByClassName(element.id + 'e-de-table-cell-alignment');\n        for (var j = 0; j < cellAlignments.length; j++) {\n            var cellAlignment = cellAlignments[j];\n            if (cellAlignment.classList.contains('e-de-table-alignment-active')) {\n                classList(cellAlignment, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.formatNumericTextBox = function (textBox, format, value) {\n        if (format === 'Auto' || format === 'Point') {\n            textBox.format = 'n2';\n        }\n        else {\n            textBox.format = '#\\'\\%\\'';\n        }\n        textBox.step = 1;\n        textBox.decimals = 2;\n        textBox.value = value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.getCellAlignment = function () {\n        var id = this.cellTab.id;\n        var groupButtons = this.cellTab.getElementsByClassName(id + 'e-de-table-cell-alignment');\n        for (var j = 0; j < groupButtons.length; j++) {\n            var groupButton = groupButtons[j];\n            if (groupButton.classList.contains('e-de-table-alignment-active')) {\n                if (j === 0) {\n                    return 'Top';\n                }\n                else if (j === 1) {\n                    return 'Center';\n                }\n                else {\n                    return 'Bottom';\n                }\n            }\n        }\n        return this.owner.selection.cellFormat.verticalAlignment;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onCellWidthChange = function () {\n        this.cellFormat.preferredWidth = this.cellWidthBox.value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onCellWidthTypeChange = function () {\n        var value;\n        var table = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n        var containerWidth = table.getOwnerWidth(true);\n        var tableWidth = table.getTableClientWidth(containerWidth);\n        if (this.cellWidthType.text === 'Percent' && this.owner.selection.cellFormat.preferredWidthType !== 'Percent') {\n            value = this.cellWidthBox.value / tableWidth * 100;\n            this.formatNumericTextBox(this.cellWidthBox, 'Percent', value);\n        }\n        else if (this.cellWidthType.text === 'Points' && this.owner.selection.cellFormat.preferredWidthType !== 'Point') {\n            value = tableWidth / 100 * this.cellWidthBox.value;\n            this.formatNumericTextBox(this.cellWidthBox, 'Point', value);\n        }\n        else {\n            if (this.cellWidthBox.format === '#\\'\\%\\'') {\n                if (this.cellWidthType.text === 'Points') {\n                    value = tableWidth / 100 * this.cellWidthBox.value;\n                }\n                else {\n                    value = this.cellWidthBox.value;\n                }\n            }\n            else {\n                if (this.cellWidthType.text === 'Percent') {\n                    value = this.cellWidthBox.value / tableWidth * 100;\n                }\n                else {\n                    value = this.cellWidthBox.value;\n                }\n            }\n            // tslint:disable-next-line:max-line-length\n            this.formatNumericTextBox(this.cellWidthBox, (this.cellWidthType.text === 'Points') ? 'Point' : this.cellWidthType.text, value);\n        }\n        this.cellFormat.preferredWidthType = (this.cellWidthType.text === 'Points') ? 'Point' : this.cellWidthType.text;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var s = 0; s < this.target.childNodes.length; s++) {\n                this.target.removeChild(this.target.childNodes[s]);\n                s--;\n            }\n            this.target = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        this.cellAlignment = undefined;\n        this.tableAlignment = undefined;\n        this.owner = undefined;\n        this.preferCheckBox = undefined;\n        this.tableWidthType = undefined;\n        this.preferredWidth = undefined;\n        this.rowHeightType = undefined;\n        this.rowHeightCheckBox = undefined;\n        this.rowHeight = undefined;\n        this.cellWidthType = undefined;\n        this.preferredCellWidthCheckBox = undefined;\n        this.preferredCellWidth = undefined;\n        this.tableTab = undefined;\n        this.rowTab = undefined;\n        this.cellTab = undefined;\n        this.left = undefined;\n        this.center = undefined;\n        this.right = undefined;\n        this.leftIndent = undefined;\n        this.allowRowBreak = undefined;\n        this.repeatHeader = undefined;\n        this.cellTopAlign = undefined;\n        this.cellCenterAlign = undefined;\n        this.cellBottomAlign = undefined;\n        this.tableFormat.destroy();\n        this.cellFormat.destroy();\n        this.tableFormat = undefined;\n        this.cellFormat = undefined;\n    };\n    return TablePropertiesDialog;\n}());\nexport { TablePropertiesDialog };\n","import { WParagraphFormat } from '../format/paragraph-format';\nimport { WSectionFormat } from '../format/section-format';\nimport { WCharacterFormat } from '../format/character-format';\nimport { WListFormat } from '../format/list-format';\nimport { ModifiedLevel, RowHistoryFormat, TableHistoryInfo } from './history-helper';\nimport { BlockWidget, ParagraphWidget, BodyWidget, TableCellWidget, TableWidget, TableRowWidget, HeaderFooterWidget } from '../viewer/page';\nimport { Dictionary } from '../../base/dictionary';\nimport { TextPosition, ImageFormat } from '../index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ElementBox } from '../viewer/page';\nimport { WTableFormat, WRowFormat, WCellFormat, WParagraphStyle } from '../format/index';\n/**\n * @private\n */\nvar BaseHistoryInfo = /** @class */ (function () {\n    function BaseHistoryInfo(node) {\n        this.ownerIn = node;\n        this.viewer = node.viewer;\n        this.modifiedPropertiesIn = [];\n        this.modifiedNodeLength = [];\n        this.removedNodesIn = [];\n    }\n    Object.defineProperty(BaseHistoryInfo.prototype, \"owner\", {\n        //Properties\n        //gets owner control\n        /**\n         * gets the owner control\n         * @private\n         */\n        get: function () { return this.ownerIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"editorHistory\", {\n        /**\n         * gets or sets action\n         * @private\n         */\n        get: function () {\n            return this.owner.editorHistory;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"action\", {\n        /**\n         * gets or sets action\n         * @private\n         */\n        get: function () { return this.actionIn; },\n        set: function (value) { this.actionIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"modifiedProperties\", {\n        /**\n         * gets modified properties\n         * @returns Object\n         * @private\n         */\n        get: function () { return this.modifiedPropertiesIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"removedNodes\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.removedNodesIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"selectionStart\", {\n        /**\n         * Gets or Sets the selection start\n         * @private\n         */\n        //gets or sets selection start\n        get: function () { return this.selectionStartIn; },\n        set: function (value) { this.selectionStartIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"selectionEnd\", {\n        /**\n         * Gets or Sets the selection end\n         * @private\n         */\n        get: function () { return this.selectionEndIn; },\n        set: function (value) { this.selectionEndIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"insertPosition\", {\n        /**\n         * Gets or sets the insert position\n         * @private\n         */\n        get: function () { return this.insertPositionIn; },\n        set: function (value) { this.insertPositionIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"endPosition\", {\n        /**\n         * Gets or sets end position\n         * @private\n         */\n        get: function () { return this.endPositionIn; },\n        set: function (value) { this.endPositionIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Update the selection\n     * @param selection\n     * @private\n     */\n    BaseHistoryInfo.prototype.updateSelection = function () {\n        var blockInfo = this.owner.editorModule.getParagraphInfo(this.owner.selection.start);\n        this.selectionStart = this.owner.editorModule.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        blockInfo = this.owner.editorModule.getParagraphInfo(this.owner.selection.end);\n        this.selectionEnd = this.owner.editorModule.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n    };\n    BaseHistoryInfo.prototype.setBookmarkInfo = function (bookmark) {\n        this.removedNodes.push({ 'bookmark': bookmark, 'startIndex': bookmark.indexInOwner, 'endIndex': bookmark.reference.indexInOwner });\n    };\n    BaseHistoryInfo.prototype.revertBookmark = function () {\n        var bookmarkInfo = this.removedNodes[0];\n        var bookmark = bookmarkInfo.bookmark;\n        if (this.editorHistory.isUndoing) {\n            this.viewer.bookmarks.add(bookmark.name, bookmark);\n            bookmark.line.children.splice(bookmarkInfo.startIndex, 0, bookmark);\n            bookmark.reference.line.children.splice(bookmarkInfo.endIndex, 0, bookmark.reference);\n            this.editorHistory.recordChanges(this);\n        }\n        else {\n            this.owner.editorModule.deleteBookmarkInternal(bookmark);\n            this.editorHistory.undoStack.push(this);\n        }\n    };\n    /**\n     * Reverts this instance\n     * @private\n     */\n    // tslint:disable: max-func-body-length\n    BaseHistoryInfo.prototype.revert = function () {\n        if (this.action === 'DeleteBookmark') {\n            this.revertBookmark();\n            return;\n        }\n        this.owner.isShiftingEnabled = true;\n        var selectionStartTextPosition = undefined;\n        var selectionEndTextPosition = undefined;\n        var start = this.selectionStart;\n        var end = this.selectionEnd;\n        var isForwardSelection = TextPosition.isForwardSelection(start, end);\n        if (this.modifiedProperties.length > 0 || this.action === 'Selection' || this.action === 'ClearCharacterFormat'\n            || this.action === 'ClearParagraphFormat') {\n            selectionStartTextPosition = this.getTextPosition(start);\n            selectionEndTextPosition = this.getTextPosition(end);\n            this.revertModifiedProperties(selectionStartTextPosition, selectionEndTextPosition);\n        }\n        else {\n            var deletedNodes = this.removedNodes;\n            this.removedNodesIn = [];\n            var isForward = TextPosition.isForwardSelection(this.insertPosition, this.endPosition);\n            var insertTextPosition = this.getTextPosition(isForward ? this.insertPosition : this.endPosition);\n            var endTextPosition = this.getTextPosition(isForward ? this.endPosition : this.insertPosition);\n            if (insertTextPosition.isAtSamePosition(endTextPosition)) {\n                this.owner.selection.selectContent(insertTextPosition, true);\n            }\n            else {\n                this.owner.selection.selectPosition(insertTextPosition, endTextPosition);\n            }\n            if (this.action === 'InsertHyperlink' && this.editorHistory.isRedoing) {\n                var fieldBegin = this.owner.selection.getHyperlinkField();\n                if (!isNullOrUndefined(fieldBegin)) {\n                    var offset = (fieldBegin.line).getOffset(fieldBegin, 0);\n                    insertTextPosition.setPositionParagraph(fieldBegin.line, offset);\n                    this.owner.selection.start.setPositionInternal(insertTextPosition);\n                    offset = fieldBegin.fieldEnd.line.getOffset(fieldBegin.fieldEnd, 1);\n                    endTextPosition.setPositionParagraph(fieldBegin.fieldEnd.line, offset);\n                }\n            }\n            this.editorHistory.currentBaseHistoryInfo = this;\n            this.selectionStart = this.insertPosition;\n            this.insertPosition = undefined;\n            this.selectionEnd = this.endPosition;\n            this.endPosition = undefined;\n            var isRemoveContent = false;\n            if (!insertTextPosition.isAtSamePosition(endTextPosition)) {\n                isRemoveContent = this.action === 'BackSpace' || this.action === 'Delete' || this.action === 'ClearCells'\n                    || this.action === 'DeleteCells';\n                if (!(isRemoveContent) && this.action !== 'MergeCells' && this.action !== 'InsertRowAbove'\n                    && this.action !== 'InsertRowBelow' && this.action !== 'InsertColumnLeft'\n                    && this.action !== 'InsertColumnRight' && this.action !== 'Borders'\n                    && this.action !== 'DeleteTable' && this.action !== 'DeleteColumn' && this.action !== 'DeleteRow') {\n                    this.owner.selection.end.setPositionInternal(endTextPosition);\n                    if (!this.owner.selection.isEmpty) {\n                        if (this.editorHistory.isRedoing) {\n                            this.owner.editorModule.removeSelectedContents(this.owner.selection);\n                        }\n                        else {\n                            this.owner.editorModule.deleteSelectedContents(this.owner.selection, true);\n                        }\n                        if (!isNullOrUndefined(this.editorHistory.currentHistoryInfo) &&\n                            this.editorHistory.currentHistoryInfo.action === 'PageBreak' && this.viewer.blockToShift) {\n                            this.viewer.layout.shiftLayoutedItems();\n                        }\n                    }\n                }\n            }\n            var isRedoAction = this.editorHistory.isRedoing && !isRemoveContent;\n            this.revertModifiedNodes(deletedNodes, isRedoAction, isForwardSelection ? start : end, start === end);\n            if (isRemoveContent) {\n                this.removeContent(insertTextPosition, endTextPosition);\n            }\n            //this.owner.editorModule.reLayout(this.viewer.selection);\n        }\n        var isSelectionChanged = false;\n        if ((this.editorHistory.isUndoing && isNullOrUndefined(this.editorHistory.currentHistoryInfo)) ||\n            ((this.action === 'InsertRowAbove' || this.action === 'Borders' || this.action === 'InsertRowBelow'\n                || this.action === 'InsertColumnLeft'\n                || this.action === 'InsertColumnRight') && (this.editorHistory.isRedoing\n                || this.editorHistory.currentHistoryInfo.action === 'Paste'))) {\n            selectionStartTextPosition = this.getTextPosition(start);\n            selectionEndTextPosition = this.getTextPosition(end);\n            this.owner.selection.selectRange(selectionStartTextPosition, selectionEndTextPosition);\n            isSelectionChanged = true;\n        }\n        // Updates insert position of history info instance.\n        this.insertPosition = start;\n        this.endPosition = end;\n        this.owner.editorModule.reLayout(this.owner.selection, this.owner.selection.isEmpty);\n        if (isSelectionChanged) {\n            this.viewer.scrollToPosition(this.owner.selection.start, this.owner.selection.end);\n        }\n        this.highlightListText();\n    };\n    BaseHistoryInfo.prototype.highlightListText = function () {\n        if (!isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n            // tslint:disable-next-line:max-line-length\n            if (this.action === 'ListCharacterFormat' || (this.editorHistory.currentHistoryInfo.action === 'ListSelect' && this.action === 'ListFormat')) {\n                var selectionStartTextPosition = this.getTextPosition(this.selectionStart);\n                var widget = selectionStartTextPosition.currentWidget;\n                this.viewer.selection.highlightListText(widget);\n            }\n        }\n    };\n    BaseHistoryInfo.prototype.removeContent = function (insertTextPosition, endTextPosition) {\n        //If the base parent of the insert text position and end text position is null \n        //then the paragraphs already removed.\n        //Example scenario: In table editing that is delete cells operation \n        // we will backed up the entire table ad it will be replaced on undo operation.\n        //At that time if the positions are in table \n        //which is already replaced in undo (revert modified nodes method) then the base parent of the paragraph will be null.\n        //So again, selecting the content and deleting is unnecessary\n        // and it will cause improper position updates and null reference exceptions. \n        if ((!isNullOrUndefined(insertTextPosition.paragraph.containerWidget) &&\n            insertTextPosition.paragraph.containerWidget instanceof BodyWidget &&\n            (!isNullOrUndefined(endTextPosition.paragraph.containerWidget)\n                && endTextPosition.paragraph.containerWidget instanceof BodyWidget))\n            || (!isNullOrUndefined(insertTextPosition.paragraph.containerWidget)\n                && !isNullOrUndefined(endTextPosition.paragraph.containerWidget)\n                && insertTextPosition.paragraph.containerWidget instanceof TableCellWidget\n                && endTextPosition.paragraph.containerWidget instanceof TableCellWidget\n                && !isNullOrUndefined(insertTextPosition.paragraph.bodyWidget))) {\n            //Removes if any empty paragraph is added while delete.\n            this.owner.selection.selectRange(insertTextPosition, endTextPosition);\n            var isDelete = (this.action === 'BackSpace') ? true : false;\n            this.owner.editorModule.deleteSelectedContents(this.owner.selection, isDelete);\n        }\n    };\n    BaseHistoryInfo.prototype.revertModifiedProperties = function (start, end) {\n        if (this.action === 'CellFormat' || this.action === 'CellOptions' || this.action === 'TableOptions') {\n            this.owner.isShiftingEnabled = false;\n        }\n        this.owner.selection.selectRange(start, end);\n        if (this.action === 'RowResizing' || this.action === 'CellResizing') {\n            this.revertResizing();\n        }\n        else if (this.action === 'CellOptions' || this.action === 'TableOptions') {\n            this.revertTableDialogProperties(this.action);\n        }\n        else if (this.action !== 'Selection') {\n            this.revertProperties();\n        }\n    };\n    // Redoes the Action\n    BaseHistoryInfo.prototype.redoAction = function () {\n        var editor = this.owner.editorModule;\n        switch (this.action) {\n            case 'BackSpace':\n                editor.singleBackspace(this.owner.selection, true);\n                break;\n            case 'Delete':\n                editor.singleDelete(this.owner.selection, true);\n                break;\n            case 'DeleteTable':\n                editor.deleteTable();\n                break;\n            case 'DeleteColumn':\n                editor.deleteColumn();\n                break;\n            case 'DeleteRow':\n                editor.deleteRow();\n                break;\n            case 'MergeCells':\n                editor.mergeSelectedCellsInTable();\n                break;\n            case 'InsertRowAbove':\n                editor.insertRow(true);\n                break;\n            case 'InsertRowBelow':\n                editor.insertRow(false);\n                break;\n            case 'InsertColumnLeft':\n                editor.insertColumn(true);\n                break;\n            case 'InsertColumnRight':\n                editor.insertColumn(true);\n                break;\n            case 'SectionBreak':\n                editor.insertSection(this.owner.selection, true);\n                break;\n            case 'TableAutoFitToContents':\n                editor.autoFitTable('FitToContents');\n                break;\n            case 'TableAutoFitToWindow':\n                editor.autoFitTable('FitToWindow');\n                break;\n            case 'TableFixedColumnWidth':\n                editor.autoFitTable('FixedColumnWidth');\n                break;\n        }\n    };\n    /**\n     * Revert the modified nodes\n     * @param  {WNode[]} deletedNodes\n     * @param  {boolean} isRedoAction\n     * @param  {string} start\n     * @param  {boolean} isEmptySelection\n     */\n    BaseHistoryInfo.prototype.revertModifiedNodes = function (deletedNodes, isRedoAction, start, isEmptySelection) {\n        if (isRedoAction && (this.action === 'BackSpace' || this.action === 'Delete' || this.action === 'DeleteTable'\n            || this.action === 'DeleteColumn' || this.action === 'DeleteRow' || this.action === 'InsertRowAbove' ||\n            this.action === 'InsertRowBelow' || this.action === 'InsertColumnLeft' || this.action === 'InsertColumnRight'\n            || this.action === 'MergeCells' || this.action === 'SectionBreak' || this.action === 'TableAutoFitToContents' ||\n            this.action === 'TableAutoFitToWindow' || this.action === 'TableFixedColumnWidth')) {\n            this.redoAction();\n            if (this.action === 'SectionBreak') {\n                return;\n            }\n        }\n        if (deletedNodes.length > 0) {\n            if ((this.editorHistory.isUndoing && (this.action === 'DeleteCells' || this.action === 'DeleteColumn'\n                || this.action === 'DeleteRow' || this.action === 'MergeCells'))\n                || (this.action === 'InsertRowAbove' || this.action === 'InsertRowBelow' || this.action === 'InsertColumnLeft'\n                    || this.action === 'ClearCells' || this.action === 'InsertColumnRight' || this.action === 'Borders' ||\n                    this.action === 'TableAutoFitToContents' || this.action === 'TableAutoFitToWindow' ||\n                    this.action === 'TableFixedColumnWidth')) {\n                var insertIndex = this.selectionStart;\n                var block = this.owner.editorModule.getBlock({ index: insertIndex }).node;\n                var lastNode = deletedNodes[deletedNodes.length - 1];\n                if ((block instanceof TableWidget || block.previousRenderedWidget instanceof TableWidget || block.isInsideTable)\n                    && lastNode instanceof TableWidget) {\n                    if (block instanceof ParagraphWidget && !block.isInsideTable) {\n                        block = block.previousRenderedWidget;\n                    }\n                    block = block.combineWidget(this.viewer);\n                    this.owner.editorModule.insertTableInternal(block, lastNode, false);\n                    deletedNodes.splice(deletedNodes.indexOf(lastNode), 1);\n                }\n                else if (lastNode instanceof TableWidget) {\n                    this.owner.editorModule.insertBlock(lastNode);\n                }\n            }\n            else {\n                var initialStart = start;\n                var block = this.owner.editorModule.getBlock({ index: initialStart }).node;\n                // initialStart = blockObj.position;\n                if (deletedNodes.length > 0 && (this.action === 'BackSpace' && isEmptySelection\n                    || (!(block instanceof TableWidget) && !(block instanceof HeaderFooterWidget)))) {\n                    var lastNode = deletedNodes[0];\n                    if (this.action === 'SectionBreak' && lastNode instanceof BodyWidget ||\n                        !isNullOrUndefined(this.editorHistory.currentHistoryInfo) &&\n                            this.editorHistory.currentHistoryInfo.action === 'PageBreak') {\n                        lastNode = deletedNodes[1];\n                    }\n                    if (lastNode instanceof ParagraphWidget && this.owner.selection.start.offset > 0) {\n                        this.owner.editorModule.insertNewParagraphWidget(lastNode, true);\n                        deletedNodes.splice(deletedNodes.indexOf(lastNode), 1);\n                        if (isNullOrUndefined(block)) {\n                            // tslint:disable-next-line:max-line-length\n                            var nextBlock = this.viewer.selection.getNextParagraphBlock(lastNode.getSplitWidgets().pop());\n                            this.owner.selection.getNextRenderedBlock(lastNode);\n                            if (isNullOrUndefined(nextBlock)) {\n                                //Sets the selection as starting of last paragraph.\n                                this.owner.selection.selectParagraph(lastNode, true);\n                            }\n                        }\n                    }\n                    if (lastNode instanceof TableWidget && this.owner.selection.start.offset > 0) {\n                        var firstBlock = deletedNodes[deletedNodes.length - 1];\n                        if (firstBlock instanceof ParagraphWidget) {\n                            this.owner.editorModule.insertNewParagraphWidget(firstBlock, true);\n                            deletedNodes.splice(deletedNodes.indexOf(firstBlock), 1);\n                            if (isNullOrUndefined(block)) {\n                                // tslint:disable-next-line:max-line-length\n                                var nextBlock = this.viewer.selection.getNextParagraphBlock(firstBlock.getSplitWidgets().pop());\n                                if (isNullOrUndefined(nextBlock)) {\n                                    //Sets the selection as starting of last paragraph.\n                                    this.owner.selection.selectParagraph(firstBlock, true);\n                                }\n                            }\n                        }\n                    }\n                }\n                if (deletedNodes.length > 0) {\n                    var firstNode = deletedNodes[deletedNodes.length - 1];\n                    if (block instanceof TableWidget) {\n                        block = block.combineWidget(this.viewer);\n                        if (firstNode instanceof TableWidget) {\n                            this.owner.editorModule.insertTableInternal(block, firstNode, true);\n                            deletedNodes.splice(deletedNodes.indexOf(firstNode), 1);\n                            this.insertPosition = start;\n                            var nextWidget = firstNode.getSplitWidgets().pop();\n                            if (nextWidget.nextRenderedWidget instanceof TableWidget) {\n                                block = nextWidget.nextRenderedWidget;\n                            }\n                            else {\n                                initialStart = start;\n                                block = this.owner.editorModule.getBlock({ index: initialStart }).node;\n                            }\n                        }\n                    }\n                    //Checks if first node is paragraph and current insert position is paragraph end.\n                    // tslint:disable-next-line:max-line-length\n                    if (firstNode instanceof ParagraphWidget && this.owner.selection.start.offset > 0\n                        && this.owner.selection.start.offset === this.owner.selection.getLineLength(this.owner.selection.start.paragraph.lastChild)) {\n                        var editor = this.owner.editorModule;\n                        editor.insertNewParagraphWidget(firstNode, false);\n                        deletedNodes.splice(deletedNodes.indexOf(firstNode), 1);\n                        //Removes the intermediate empty paragraph instance.\n                        if (this.action !== 'Paste') {\n                            editor.removeBlock(this.owner.selection.start.paragraph);\n                        }\n                        // tslint:disable-next-line:max-line-length\n                        var paragraph = this.viewer.selection.getNextParagraphBlock(firstNode.getSplitWidgets().pop());\n                        if (!isNullOrUndefined(paragraph)) {\n                            this.owner.selection.selectParagraph(paragraph, true);\n                        }\n                    }\n                    else if (deletedNodes[0] instanceof TableWidget && deletedNodes.length !== 1) {\n                        var nextNode = deletedNodes[1];\n                        if (nextNode instanceof ParagraphWidget && nextNode.isEmpty()) {\n                            deletedNodes.splice(deletedNodes.indexOf(nextNode), 1);\n                        }\n                    }\n                }\n                if (deletedNodes.length > 0) {\n                    if (block instanceof TableWidget) {\n                        block = block.combineWidget(this.viewer);\n                    }\n                    this.insertRemovedNodes(deletedNodes, block);\n                }\n            }\n        }\n    };\n    BaseHistoryInfo.prototype.insertRemovedNodes = function (deletedNodes, block) {\n        for (var i = deletedNodes.length - 1, index = 0; i > -1; i--) {\n            var node = deletedNodes[i];\n            if (node instanceof ElementBox) {\n                this.owner.editorModule.insertInlineInSelection(this.owner.selection, node);\n            }\n            else if (node instanceof BlockWidget) {\n                if (node instanceof TableRowWidget) {\n                    if (block instanceof TableWidget) {\n                        block.childWidgets.splice(index, 0, node);\n                        this.owner.editorModule.updateNextBlocksIndex(node, true);\n                        if (i === 0 || !(deletedNodes[i - 1] instanceof TableRowWidget)) {\n                            // tslint:disable-next-line:max-line-length\n                            this.viewer.layout.layoutBodyWidgetCollection(block.index, block.containerWidget, block, false);\n                        }\n                    }\n                }\n                else if (block instanceof TableWidget) {\n                    this.owner.editorModule.insertBlockTable(this.owner.selection, node, block);\n                }\n                else {\n                    this.owner.editorModule.insertBlock(node);\n                }\n            }\n            else if (node instanceof BodyWidget) {\n                this.owner.editorModule.insertSection(this.owner.selection, false);\n            }\n        }\n        deletedNodes = [];\n    };\n    BaseHistoryInfo.prototype.revertResizing = function () {\n        this.editorHistory.currentBaseHistoryInfo = this;\n        if (this.action === 'RowResizing') {\n            if (this.modifiedProperties[0] instanceof RowHistoryFormat) {\n                // tslint:disable-next-line:max-line-length\n                this.modifiedProperties[0].revertChanges(this.editorHistory.isRedoing, this.owner);\n            }\n        }\n        else {\n            if (this.modifiedProperties[0] instanceof TableHistoryInfo) {\n                //selected cell resizing the condition checks done based on the selected widgets only. so need to highlight the selection.\n                if (this.owner.selection.selectedWidgets.length === 0) {\n                    this.owner.selection.highlightSelection(true);\n                }\n                var prevTableHistoryInfo = this.modifiedProperties[0];\n                var position = prevTableHistoryInfo.tableHierarchicalIndex;\n                var block = this.owner.editorModule.getBlock({ index: position }).node;\n                if (block instanceof TableWidget) {\n                    var tableResize = this.owner.editorModule.tableResize;\n                    this.owner.editor.setOffsetValue(this.owner.selection);\n                    block = block.combineWidget(this.owner.viewer);\n                    tableResize.currentResizingTable = block;\n                    this.modifiedProperties.splice(0, 1);\n                    if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n                        var tableHistoryInfoCurrent = new TableHistoryInfo(block, this.owner);\n                        this.modifiedProperties.splice(0, 0, tableHistoryInfoCurrent);\n                        this.owner.isLayoutEnabled = false;\n                        tableResize.applyProperties(tableResize.currentResizingTable, prevTableHistoryInfo);\n                        tableResize.currentResizingTable.isGridUpdated = true;\n                        this.owner.isLayoutEnabled = true;\n                        tableResize.updateGridValue(tableResize.currentResizingTable, false);\n                        prevTableHistoryInfo.destroy();\n                        prevTableHistoryInfo = undefined;\n                    }\n                }\n            }\n        }\n    };\n    BaseHistoryInfo.prototype.revertTableDialogProperties = function (action) {\n        this.owner.isShiftingEnabled = false;\n        this.editorHistory.currentBaseHistoryInfo = this;\n        this.currentPropertyIndex = 0;\n        if (action === 'CellOptions') {\n            var selection = this.owner.selection;\n            var cellFormat = this.modifiedProperties[0];\n            this.owner.editorModule.updateCellMargins(selection, cellFormat);\n        }\n        else if (action === 'TableOptions') {\n            this.owner.tableOptionsDialogModule.applyTableOptionsHelper(this.modifiedProperties[0]);\n        }\n        this.currentPropertyIndex = 0;\n        this.owner.isShiftingEnabled = true;\n    };\n    BaseHistoryInfo.prototype.getTextPosition = function (hierarchicalIndex) {\n        var textPosition = new TextPosition(this.owner);\n        var blockInfo = this.owner.editorModule.getParagraph({ index: hierarchicalIndex });\n        var lineInfo = this.owner.editorModule.getLineInfo(blockInfo.paragraph, blockInfo.offset);\n        textPosition.setPositionForLineWidget(lineInfo.line, lineInfo.offset);\n        return textPosition;\n    };\n    /**\n     * Add modified properties for section format\n     * @param  {WSectionFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForSection = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            var modifiedProperties = this.modifiedProperties;\n            var previousFormat = (this.currentPropertyIndex < modifiedProperties.length ?\n                modifiedProperties[this.currentPropertyIndex] : modifiedProperties[modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n            }\n            else {\n                value = previousFormat.getPropertyValue(property);\n                previousFormat.copyFormat(format);\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            if (isNullOrUndefined(property)) {\n                this.modifiedProperties.push(format.cloneFormat());\n            }\n            else {\n                var currentFormat = new WSectionFormat();\n                currentFormat.copyFormat(format);\n                this.modifiedProperties.push(currentFormat);\n            }\n        }\n        return value;\n    };\n    /**\n     * Add the modified properties for character format\n     * @param  {WCharacterFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedProperties = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length           \n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            var skipRemove = false;\n            if (format.ownerBase instanceof ElementBox) {\n                var prevLength = this.modifiedNodeLength[this.currentPropertyIndex];\n                if (format.ownerBase.length < prevLength) {\n                    skipRemove = true;\n                    this.modifiedNodeLength[this.currentPropertyIndex] = format.ownerBase.length;\n                    this.modifiedNodeLength.splice(this.currentPropertyIndex + 1, 0, prevLength - format.ownerBase.length);\n                    //Adds a copy of character format at next position for splitted inline.\n                    var nextFormat = new WCharacterFormat(undefined);\n                    nextFormat.copyFormat(previousFormat);\n                    this.modifiedProperties.splice(this.currentPropertyIndex + 1, 0, nextFormat);\n                }\n            }\n            if (this.action === 'ClearCharacterFormat') {\n                if (this.editorHistory.isUndoing) {\n                    value = previousFormat;\n                    if (!skipRemove) {\n                        this.modifiedProperties.splice(this.currentPropertyIndex, 1);\n                        this.currentPropertyIndex--;\n                    }\n                }\n                else {\n                    this.modifiedProperties.push(format.cloneFormat());\n                }\n            }\n            else {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            if (isNullOrUndefined(property)) {\n                this.modifiedProperties.push(format.cloneFormat());\n            }\n            else {\n                var currentFormat = new WCharacterFormat(undefined);\n                currentFormat.copyFormat(format);\n                this.modifiedProperties.push(currentFormat);\n            }\n            if (format.ownerBase instanceof ElementBox) {\n                this.modifiedNodeLength.push(format.ownerBase.length);\n            }\n            else {\n                this.modifiedNodeLength.push(0);\n            }\n        }\n        return value;\n    };\n    /**\n     * Add the modified properties for paragraph format\n     * @param  {WParagraphFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForParagraphFormat = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (this.action === 'ClearParagraphFormat') {\n                if (this.editorHistory.isUndoing) {\n                    value = previousFormat;\n                    this.modifiedProperties.splice(this.currentPropertyIndex, 1);\n                    this.currentPropertyIndex--;\n                }\n                else {\n                    this.modifiedProperties.push(format.cloneFormat());\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'listFormat') {\n                value = new WParagraphFormat(undefined);\n                value.copyFormat(previousFormat);\n                previousFormat.listFormat = new WListFormat();\n                previousFormat.listFormat.copyFormat(format.listFormat);\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'styleName') {\n                if (!isNullOrUndefined(previousFormat.baseStyle)) {\n                    value = new WParagraphStyle();\n                    value.copyStyle(previousFormat.baseStyle);\n                    this.currentPropertyIndex++;\n                    return value;\n                }\n                else {\n                    return undefined;\n                }\n            }\n            value = previousFormat.getPropertyValue(property);\n            previousFormat.copyFormat(format);\n            this.currentPropertyIndex++;\n        }\n        else {\n            if (isNullOrUndefined(property)) {\n                this.modifiedProperties.push(format.cloneFormat());\n            }\n            else {\n                var currentFormat = new WParagraphFormat(undefined);\n                currentFormat.copyFormat(format);\n                this.modifiedProperties.push(currentFormat);\n            }\n        }\n        return value;\n    };\n    /**\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForContinueNumbering = function (paragraphFormat, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            value = previousFormat;\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = paragraphFormat.cloneFormat();\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = paragraphFormat.cloneFormat();\n            }\n            this.currentPropertyIndex++;\n            return value;\n        }\n        else {\n            var currentFormat = new WParagraphFormat();\n            currentFormat.copyFormat(paragraphFormat);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * @param listFormat\n     * @param value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForRestartNumbering = function (listFormat, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var listId = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            value = listId;\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = listFormat.listId;\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = listFormat.listId;\n            }\n            this.currentPropertyIndex++;\n            return value;\n        }\n        else {\n            this.modifiedProperties.push(listFormat.listId);\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for list format\n     * @param  {WListLevel} listLevel\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForList = function (listLevel) {\n        var value;\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousLevel = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            value = previousLevel;\n            previousLevel = new ModifiedLevel(listLevel, this.owner.editorModule.cloneListLevel(listLevel));\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = previousLevel;\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = previousLevel;\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            this.modifiedProperties.push(new ModifiedLevel(listLevel, this.owner.editorModule.cloneListLevel(listLevel)));\n            value = listLevel;\n        }\n        return value;\n    };\n    /**\n     * Revert the properties\n     * @param  {SelectionRange} selectionRange\n     */\n    BaseHistoryInfo.prototype.revertProperties = function () {\n        this.editorHistory.currentBaseHistoryInfo = this;\n        this.currentPropertyIndex = 0;\n        var property = this.getProperty();\n        this.viewer.owner.editorModule.setOffsetValue(this.viewer.selection);\n        if (this.action === 'ClearCharacterFormat' || this.modifiedProperties[0] instanceof WCharacterFormat) {\n            if (this.action === 'ListCharacterFormat') {\n                this.owner.editorModule.updateListCharacterFormat(this.viewer.selection, property, undefined);\n                return;\n            }\n            this.owner.editorModule.updateSelectionCharacterFormatting(property, undefined, false);\n        }\n        else if (this.action === 'ClearParagraphFormat' || this.modifiedProperties[0] instanceof WParagraphFormat) {\n            if (this.action === 'ContinueNumbering') {\n                // tslint:disable-next-line:max-line-length\n                this.owner.editorModule.revertContinueNumbering(this.owner.selection, this.modifiedProperties[0]);\n                return;\n            }\n            if (this.action === 'StyleName' && this.modifiedProperties[0] instanceof WParagraphFormat) {\n                // tslint:disable-next-line:max-line-length\n                this.owner.editorModule.updateSelectionParagraphFormatting(property, this.modifiedProperties[0].baseStyle, false);\n                return;\n            }\n            this.owner.viewer.layout.isBidiReLayout = true;\n            this.owner.editorModule.updateSelectionParagraphFormatting(property, undefined, false);\n            this.owner.viewer.layout.isBidiReLayout = false;\n        }\n        else if (this.modifiedProperties[0] instanceof WSectionFormat) {\n            this.owner.editorModule.updateSectionFormat(property, undefined);\n        }\n        else if (this.action === 'RestartNumbering') {\n            this.owner.editorModule.restartListAtInternal(this.owner.selection, this.modifiedProperties[0]);\n            return;\n        }\n        else if (this.modifiedProperties[0] instanceof ImageFormat) {\n            this.owner.selection.updateImageSize(this.modifiedProperties[0]);\n        }\n        else if (this.modifiedProperties[0] instanceof ModifiedLevel) {\n            var modified = new Dictionary();\n            for (var i = 0; i < this.modifiedProperties.length; i++) {\n                var modifiedLevel = this.modifiedProperties[i];\n                // modified.modifiedLevels.add(modifiedLevel.ownerListLevel.levelNumber, modifiedLevel);\n                modified.add(i, modifiedLevel);\n            }\n            this.editorHistory.updateListChanges(modified);\n            modified.destroy();\n            modified = undefined;\n        }\n        else if (this.modifiedProperties[0] instanceof WTableFormat) {\n            this.owner.editorModule.updateTableFormat(this.owner.selection, property, undefined);\n        }\n        else if (this.modifiedProperties[0] instanceof WCellFormat) {\n            this.owner.isShiftingEnabled = true;\n            this.owner.editorModule.updateCellFormat(this.owner.selection, property, undefined);\n        }\n        else if (this.modifiedProperties[0] instanceof WRowFormat) {\n            this.owner.editorModule.updateRowFormat(this.owner.selection, property, undefined);\n        }\n        this.currentPropertyIndex = 0;\n        if (this.action === 'ClearCharacterFormat' || this.action === 'ClearParagraphFormat') {\n            this.owner.editorModule.getOffsetValue(this.viewer.selection);\n        }\n    };\n    /**\n     * Add modified properties for cell options dialog\n     * @param  {WCellFormat} format\n     * @param  {WTable} table\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedCellOptions = function (applyFormat, format, table) {\n        var currentFormat;\n        if (isNullOrUndefined(applyFormat.bottomMargin) && isNullOrUndefined(applyFormat.topMargin)\n            && isNullOrUndefined(applyFormat.rightMargin) && isNullOrUndefined(applyFormat.leftMargin)) {\n            currentFormat = this.copyCellOptions(table.tableFormat);\n        }\n        else {\n            currentFormat = this.copyCellOptions(applyFormat);\n        }\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            format = previousFormat;\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = this.copyCellOptions(applyFormat);\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = this.copyCellOptions(applyFormat);\n            }\n            this.currentPropertyIndex++;\n            return format;\n        }\n        else {\n            this.modifiedProperties.push(currentFormat);\n        }\n        return format;\n    };\n    BaseHistoryInfo.prototype.copyCellOptions = function (format) {\n        var cellFormat = new WCellFormat();\n        cellFormat.topMargin = format.topMargin;\n        cellFormat.rightMargin = format.rightMargin;\n        cellFormat.bottomMargin = format.bottomMargin;\n        cellFormat.leftMargin = format.leftMargin;\n        return cellFormat;\n    };\n    /**\n     * Add modified properties for cell options dialog\n     * @param  {WTableFormat} format\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedTableOptions = function (format) {\n        var currentFormat = this.copyTableOptions(format);\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length           \n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties.splice(this.currentPropertyIndex, 1, currentFormat);\n            }\n            else {\n                this.modifiedProperties.splice(this.modifiedProperties.length - 1, 1, currentFormat);\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            this.modifiedProperties.push(currentFormat);\n        }\n    };\n    BaseHistoryInfo.prototype.copyTableOptions = function (format) {\n        var tableFormat = new WTableFormat();\n        tableFormat.topMargin = format.topMargin;\n        tableFormat.rightMargin = format.rightMargin;\n        tableFormat.bottomMargin = format.bottomMargin;\n        tableFormat.leftMargin = format.leftMargin;\n        tableFormat.cellSpacing = format.cellSpacing;\n        return tableFormat;\n    };\n    BaseHistoryInfo.prototype.getProperty = function () {\n        switch (this.action) {\n            case 'Bold':\n                return 'bold';\n            case 'Italic':\n                return 'italic';\n            case 'FontColor':\n                return 'fontColor';\n            case 'FontFamily':\n                return 'fontFamily';\n            case 'FontSize':\n                return 'fontSize';\n            case 'HighlightColor':\n                return 'highlightColor';\n            case 'BaselineAlignment':\n                return 'baselineAlignment';\n            case 'Strikethrough':\n                return 'strikethrough';\n            case 'Underline':\n                return 'underline';\n            case 'AfterSpacing':\n                return 'afterSpacing';\n            case 'BeforeSpacing':\n                return 'beforeSpacing';\n            case 'LeftIndent':\n                return 'leftIndent';\n            case 'RightIndent':\n                return 'rightIndent';\n            case 'FirstLineIndent':\n                return 'firstLineIndent';\n            case 'LineSpacingType':\n                return 'lineSpacingType';\n            case 'LineSpacing':\n                return 'lineSpacing';\n            case 'TextAlignment':\n                return 'textAlignment';\n            case 'ListFormat':\n                return 'listFormat';\n            case 'PageHeight':\n                return 'pageHeight';\n            case 'PageWidth':\n                return 'pageWidth';\n            case 'TableAlignment':\n                return 'tableAlignment';\n            case 'TableLeftIndent':\n                return 'leftIndent';\n            case 'DefaultCellSpacing':\n                return 'cellSpacing';\n            case 'LeftMargin':\n            case 'CellLeftMargin':\n            case 'DefaultCellLeftMargin':\n                return 'leftMargin';\n            case 'RightMargin':\n            case 'CellRightMargin':\n            case 'DefaultCellRightMargin':\n                return 'rightMargin';\n            case 'TopMargin':\n            case 'CellTopMargin':\n            case 'DefaultCellTopMargin':\n                return 'topMargin';\n            case 'BottomMargin':\n            case 'CellBottomMargin':\n            case 'DefaultCellBottomMargin':\n                return 'bottomMargin';\n            case 'CellContentVerticalAlignment':\n                return 'verticalAlignment';\n            case 'RowHeight':\n                return 'height';\n            case 'RowHeightType':\n                return 'heightType';\n            case 'RowHeader':\n                return 'isHeader';\n            case 'AllowBreakAcrossPages':\n                return 'allowBreakAcrossPages';\n            case 'TablePreferredWidth':\n            case 'CellPreferredWidth':\n                return 'preferredWidth';\n            case 'TablePreferredWidthType':\n            case 'CellPreferredWidthType':\n                return 'preferredWidthType';\n            case 'Shading':\n                return 'shading';\n            case 'StyleName':\n                return 'styleName';\n            case 'ParagraphBidi':\n            case 'TableBidi':\n                return 'bidi';\n        }\n        return undefined;\n    };\n    BaseHistoryInfo.prototype.getCharacterPropertyValue = function (property, modifiedProperty) {\n        var value;\n        if (property === 'bold') {\n            value = modifiedProperty.bold;\n        }\n        else if (property === 'italic') {\n            value = modifiedProperty.italic;\n        }\n        else if (property === 'fontColor') {\n            value = modifiedProperty.fontColor;\n        }\n        else if (property === 'fontFamily') {\n            value = modifiedProperty.fontFamily;\n        }\n        else if (property === 'fontSize') {\n            value = modifiedProperty.fontSize;\n        }\n        else if (property === 'highlightColor') {\n            value = modifiedProperty.highlightColor;\n        }\n        else if (property === 'baselineAlignment') {\n            value = modifiedProperty.baselineAlignment;\n        }\n        else if (property === 'strikethrough') {\n            value = modifiedProperty.strikethrough;\n        }\n        else if (property === 'underline') {\n            value = modifiedProperty.underline;\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for table format\n     * @param  {WTableFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedTableProperties = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousTableFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousTableFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'shading') {\n                value = previousTableFormat.shading;\n            }\n            else {\n                value = previousTableFormat.getPropertyValue(property);\n            }\n            previousTableFormat.copyFormat(format);\n            this.currentPropertyIndex++;\n        }\n        else {\n            var currentFormat = new WTableFormat();\n            currentFormat.copyFormat(format);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for row format\n     * @param  {WRowFormat} rowFormat\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedRowProperties = function (rowFormat, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = rowFormat.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = rowFormat.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            value = previousFormat.getPropertyValue(property);\n            previousFormat.copyFormat(rowFormat);\n            this.currentPropertyIndex++;\n        }\n        else {\n            var currentFormat = new WRowFormat();\n            currentFormat.copyFormat(rowFormat);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for cell format\n     * @param  {WCellFormat} cellFormat\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedCellProperties = function (cellFormat, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = cellFormat.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = cellFormat.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'shading') {\n                value = previousFormat.shading;\n            }\n            else {\n                value = previousFormat.getPropertyValue(property);\n            }\n            previousFormat.copyFormat(cellFormat);\n            this.currentPropertyIndex++;\n        }\n        else {\n            var currentFormat = new WCellFormat();\n            currentFormat.copyFormat(cellFormat);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * @private\n     */\n    BaseHistoryInfo.prototype.destroy = function () {\n        this.selectionStart = undefined;\n        this.selectionEnd = undefined;\n        this.insertPosition = undefined;\n        this.endPosition = undefined;\n        if (!isNullOrUndefined(this.modifiedNodeLength)) {\n            this.modifiedNodeLength = [];\n            this.modifiedNodeLength = undefined;\n        }\n        if (!isNullOrUndefined(this.modifiedProperties)) {\n            for (var i = 0; i < this.modifiedProperties.length; i++) {\n                var property = this.modifiedProperties[i];\n                if (property instanceof WCharacterFormat) {\n                    property.destroy();\n                }\n                else if (property instanceof WParagraphFormat) {\n                    property.destroy();\n                }\n                else if (property instanceof WSectionFormat) {\n                    property.destroy();\n                }\n                else if (property instanceof ModifiedLevel) {\n                    property.destroy();\n                }\n                this.modifiedProperties.splice(this.modifiedProperties.indexOf(property), 1);\n                i--;\n            }\n            this.modifiedPropertiesIn = undefined;\n        }\n        if (!isNullOrUndefined(this.removedNodes)) {\n            for (var i = 0; i < this.removedNodes.length; i++) {\n                var node = this.removedNodes[i];\n                if (node instanceof ParagraphWidget) {\n                    node.destroyInternal(this.viewer);\n                }\n                else if (node instanceof ElementBox) {\n                    node.destroy();\n                }\n                this.removedNodes.splice(this.removedNodes.indexOf(node), 1);\n                i--;\n            }\n            this.removedNodesIn = undefined;\n        }\n        this.ownerIn = undefined;\n    };\n    return BaseHistoryInfo;\n}());\nexport { BaseHistoryInfo };\n","import { Dictionary } from '../../base/dictionary';\nimport { TextPosition } from '../selection/selection-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { BaseHistoryInfo, } from './base-history-info';\nimport { ModifiedParagraphFormat, ModifiedLevel, RowHistoryFormat, TableHistoryInfo } from './history-helper';\nimport { HistoryInfo } from './history-info';\nimport { WParagraphFormat } from '../format/paragraph-format';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n *  `EditorHistory` Module class is used to handle history preservation\n */\nvar EditorHistory = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function EditorHistory(node) {\n        //Fields\n        this.undoStackIn = [];\n        this.redoStackIn = [];\n        this.historyInfoStack = [];\n        /**\n         * @private\n         */\n        this.isUndoing = false;\n        /**\n         * @private\n         */\n        this.isRedoing = false;\n        this.owner = node;\n        this.viewer = node.viewer;\n        this.modifiedParaFormats = new Dictionary();\n        this.undoLimitIn = 500;\n        this.redoLimitIn = 500;\n    }\n    Object.defineProperty(EditorHistory.prototype, \"currentHistoryInfo\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.historyInfoStack && this.historyInfoStack.length > 0 ?\n                this.historyInfoStack[this.historyInfoStack.length - 1] : undefined;\n        },\n        set: function (value) {\n            if (value instanceof HistoryInfo) {\n                this.historyInfoStack.push(value);\n            }\n            else {\n                this.historyInfoStack.pop();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"undoStack\", {\n        //Properties\n        /**\n         * gets undo stack\n         * @private\n         */\n        get: function () { return this.undoStackIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"redoStack\", {\n        /**\n         * gets redo stack\n         * @private\n         */\n        get: function () { return this.redoStackIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"undoLimit\", {\n        /**\n         * Gets or Sets the limit of undo operations can be done.\n         */\n        get: function () {\n            return isNullOrUndefined(this.undoLimitIn) ? 0 : this.undoLimitIn;\n        },\n        set: function (value) {\n            if (value < 0) {\n                throw new Error('The limit should be greater than or equal to zero.');\n            }\n            this.undoLimitIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"redoLimit\", {\n        /**\n         * Gets or Sets the limit of redo operations can be done.\n         */\n        get: function () {\n            return isNullOrUndefined(this.redoLimitIn) ? 0 : this.redoLimitIn;\n        },\n        set: function (value) {\n            if (value < 0) {\n                throw new Error('The limit should be greater than or equal to zero.');\n            }\n            this.redoLimitIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    EditorHistory.prototype.getModuleName = function () {\n        return 'EditorHistory';\n    };\n    /**\n     * Determines whether undo operation can be done.\n     * @returns boolean\n     */\n    EditorHistory.prototype.canUndo = function () {\n        return !isNullOrUndefined(this.undoStack) && this.undoStack.length > 0;\n    };\n    /**\n     * Determines whether redo operation can be done.\n     * @returns boolean\n     */\n    EditorHistory.prototype.canRedo = function () {\n        return !isNullOrUndefined(this.redoStack) && this.redoStack.length > 0;\n    };\n    //EditorHistory Initialization    \n    /**\n     * initialize EditorHistory\n     * @param  {Selection} selection\n     * @param  {Action} action\n     * @param  {SelectionRange} selectionRange\n     * @private\n     */\n    EditorHistory.prototype.initializeHistory = function (action) {\n        this.currentBaseHistoryInfo = new BaseHistoryInfo(this.owner);\n        this.currentBaseHistoryInfo.action = action;\n        this.currentBaseHistoryInfo.updateSelection();\n    };\n    /**\n     * Initialize complex history\n     * @param  {Selection} selection\n     * @param  {Action} action\n     * @private\n     */\n    EditorHistory.prototype.initComplexHistory = function (selection, action) {\n        this.currentHistoryInfo = new HistoryInfo(selection.owner, !isNullOrUndefined(this.currentHistoryInfo));\n        this.currentHistoryInfo.action = action;\n        this.currentHistoryInfo.updateSelection();\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.initResizingHistory = function (startingPoint, tableResize) {\n        if (tableResize.resizeNode === 1) {\n            this.initializeHistory('RowResizing');\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                // tslint:disable-next-line:max-line-length\n                this.currentBaseHistoryInfo.modifiedProperties.push(new RowHistoryFormat(startingPoint, tableResize.currentResizingTable.childWidgets[tableResize.resizerPosition].rowFormat));\n            }\n        }\n        else {\n            this.initializeHistory('CellResizing');\n            if (this.currentBaseHistoryInfo) {\n                tableResize.currentResizingTable = tableResize.currentResizingTable.combineWidget(this.viewer);\n                var tableHistoryInfo = new TableHistoryInfo(tableResize.currentResizingTable, this.owner);\n                tableHistoryInfo.startingPoint = startingPoint;\n                this.currentBaseHistoryInfo.modifiedProperties.push(tableHistoryInfo);\n            }\n        }\n    };\n    /**\n     * Update resizing history\n     * @param  {Point} point\n     * @param  {Selection} selection\n     * @private\n     */\n    EditorHistory.prototype.updateResizingHistory = function (point, tableResize) {\n        if (tableResize.resizeNode === 1) {\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                var rowHistoryFormat = this.currentBaseHistoryInfo.modifiedProperties[0];\n                if (rowHistoryFormat.startingPoint.y === point.y) {\n                    this.currentBaseHistoryInfo.modifiedProperties.length = 0;\n                }\n                else {\n                    rowHistoryFormat.displacement = HelperMethods.convertPixelToPoint(point.y - rowHistoryFormat.startingPoint.y);\n                    this.recordChanges(this.currentBaseHistoryInfo);\n                    this.currentBaseHistoryInfo = undefined;\n                }\n            }\n        }\n        else {\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                var cellHistoryFormat = this.currentBaseHistoryInfo.modifiedProperties[0];\n                if (cellHistoryFormat.startingPoint.x === point.x) {\n                    this.currentBaseHistoryInfo.modifiedProperties.length = 0;\n                }\n                else {\n                    cellHistoryFormat.displacement = HelperMethods.convertPixelToPoint(point.x - cellHistoryFormat.startingPoint.x);\n                    cellHistoryFormat.endIndex = tableResize.getCellReSizerPosition(point);\n                    this.owner.editorHistory.recordChanges(this.currentBaseHistoryInfo);\n                    this.currentBaseHistoryInfo = undefined;\n                }\n            }\n        }\n    };\n    /**\n     * Record the changes\n     * @param  {BaseHistoryInfo} baseHistoryInfo\n     * @private\n     */\n    EditorHistory.prototype.recordChanges = function (baseHistoryInfo) {\n        if (!this.owner.enableHistoryMode) {\n            return;\n        }\n        if (this.isUndoing) {\n            if (isNullOrUndefined(this.redoStack)) {\n                this.redoStackIn = [];\n            }\n            if (this.redoStack.length === this.redoLimit && this.redoLimit > 0) {\n                var count = this.undoLimit > 20 ? 10 : 1;\n                this.redoStackIn.splice(0, count);\n            }\n            if (this.redoStack.length < this.redoLimit) {\n                this.redoStack.push(baseHistoryInfo);\n            }\n        }\n        else {\n            if (!this.isRedoing) {\n                this.clearRedoStack();\n            }\n            if (isNullOrUndefined(this.undoStack)) {\n                this.undoStackIn = [];\n            }\n            if (this.undoStack.length === this.undoLimit && this.undoLimit > 0) {\n                var count = this.undoLimit > 20 ? 10 : 1;\n                this.undoStackIn.splice(0, count);\n            }\n            if (this.undoStack.length < this.undoLimit) {\n                this.undoStackIn.push(baseHistoryInfo);\n            }\n        }\n    };\n    /**\n     * update EditorHistory\n     * @private\n     */\n    EditorHistory.prototype.updateHistory = function () {\n        if (this.viewer.owner.enableHistoryMode && !isNullOrUndefined(this.currentBaseHistoryInfo)) {\n            //Updates the current end position\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)\n                && isNullOrUndefined(this.currentBaseHistoryInfo.endPosition)) {\n                this.currentBaseHistoryInfo.endPosition = this.currentBaseHistoryInfo.insertPosition;\n            }\n            if (!isNullOrUndefined(this.currentHistoryInfo)) {\n                this.currentHistoryInfo.addModifiedAction(this.currentBaseHistoryInfo);\n            }\n            else {\n                this.recordChanges(this.currentBaseHistoryInfo);\n            }\n            this.currentBaseHistoryInfo = undefined;\n        }\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.isHandledComplexHistory = function () {\n        var isHandledComplexHistory = false;\n        if (!(this.isUndoing || this.isRedoing)) {\n            isHandledComplexHistory = this.owner.editorModule.insertRemoveBookMarkElements();\n        }\n        if (this.viewer.owner.enableHistoryMode && !isNullOrUndefined(this.currentHistoryInfo)) {\n            this.updateHistory();\n            isHandledComplexHistory = true;\n        }\n        else if (this.owner.editorModule.isHandledComplex) {\n            isHandledComplexHistory = true;\n        }\n        return isHandledComplexHistory;\n    };\n    /**\n     * Update complex history\n     * @private\n     */\n    EditorHistory.prototype.updateComplexHistory = function () {\n        var selection = this.viewer.selection;\n        if (this.currentHistoryInfo.hasAction) {\n            if (this.currentHistoryInfo.action === 'AutoFormatHyperlink') {\n                var startPosition = new TextPosition(selection.owner);\n                this.owner.editorModule.setPositionForCurrentIndex(startPosition, this.currentHistoryInfo.insertPosition);\n                // this.reLayoutParagraph(startPosition.paragraph, 0);\n                if (selection.owner.editorHistory.isUndoing) {\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.start, this.currentHistoryInfo.selectionStart);\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.end, this.currentHistoryInfo.selectionEnd);\n                }\n                else {\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.start, this.currentHistoryInfo.endPosition);\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.end, this.currentHistoryInfo.endPosition);\n                }\n            }\n            if (this.currentHistoryInfo.action === 'InsertHyperlink') {\n                var startPosition = new TextPosition(selection.owner);\n                this.owner.editorModule.setPositionForCurrentIndex(startPosition, this.currentHistoryInfo.insertPosition);\n                var endPosition = new TextPosition(selection.owner);\n                this.owner.editorModule.setPositionForCurrentIndex(endPosition, this.currentHistoryInfo.endPosition);\n                this.viewer.layout.reLayoutParagraph(startPosition.paragraph, 0, 0);\n                if (endPosition.paragraph !== startPosition.paragraph) {\n                    this.viewer.layout.reLayoutParagraph(endPosition.paragraph, 0, 0);\n                }\n            }\n            if (this.currentHistoryInfo.action === 'ReplaceAll') {\n                this.owner.editorModule.layoutWholeDocument();\n            }\n            else if (selection.owner.isShiftingEnabled) {\n                this.viewer.layout.shiftLayoutedItems();\n                if (this.owner.enableHeaderAndFooter) {\n                    this.owner.editorModule.updateHeaderFooterWidget();\n                }\n                this.viewer.removeEmptyPages();\n            }\n        }\n        selection.owner.isShiftingEnabled = false;\n        selection.owner.isLayoutEnabled = true;\n        // // selection.addMultipleSelectionRanges();\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            selection.end.updatePhysicalPosition(true);\n        }\n        selection.upDownSelectionLength = selection.end.location.x;\n        this.viewer.updateScrollBars();\n        selection.fireSelectionChanged(true);\n        this.viewer.updateFocus();\n        this.updateComplexHistoryInternal();\n        this.owner.editorModule.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.updateComplexHistoryInternal = function () {\n        if (!isNullOrUndefined(this.currentHistoryInfo)) {\n            //Updates the current end position\n            if (isNullOrUndefined(this.currentHistoryInfo.endPosition)) {\n                this.currentHistoryInfo.endPosition = this.currentHistoryInfo.insertPosition;\n            }\n            if (this.historyInfoStack.length > 1) {\n                var historyInfo = this.historyInfoStack[this.historyInfoStack.length - 2];\n                historyInfo.addModifiedAction(this.currentHistoryInfo);\n            }\n            else {\n                this.recordChanges(this.currentHistoryInfo);\n            }\n            this.currentHistoryInfo = undefined;\n        }\n    };\n    //List history preservation undo API\n    /**\n     * update list changes for history preservation\n     * @param  {Selection} selection\n     * @param  {WAbstractList} currentAbstractList\n     * @param  {WList} list\n     * @private\n     */\n    EditorHistory.prototype.updateListChangesInHistory = function (currentAbstractList, list) {\n        this.currentBaseHistoryInfo = new BaseHistoryInfo(this.viewer.owner);\n        this.currentBaseHistoryInfo.action = 'List';\n        this.currentBaseHistoryInfo.updateSelection();\n        var collection = new Dictionary();\n        for (var i = 0; i < currentAbstractList.levels.length; i++) {\n            var levels = this.viewer.getAbstractListById(list.abstractListId).levels[i];\n            var value = this.currentBaseHistoryInfo.addModifiedPropertiesForList(levels);\n            var modifiedLevel = new ModifiedLevel(levels, currentAbstractList.levels[i]);\n            if (!isNullOrUndefined(levels)) {\n                this.viewer.owner.editorModule.copyListLevel(levels, currentAbstractList.levels[i]);\n            }\n            collection.add(i, modifiedLevel);\n        }\n        return collection;\n    };\n    /**\n     * Apply list changes\n     * @param  {Selection} selection\n     * @param  {Dictionary<number, ModifiedLevel>} modifiedLevelsInternal\n     * @private\n     */\n    EditorHistory.prototype.applyListChanges = function (selection, modifiedLevelsInternal) {\n        if (isNullOrUndefined(this.modifiedParaFormats)) {\n            this.modifiedParaFormats = new Dictionary();\n        }\n        var collection = [];\n        for (var i = 0; i < this.viewer.listParagraphs.length; i++) {\n            var paragraph = this.viewer.listParagraphs[i];\n            var paraFormat = paragraph.paragraphFormat;\n            var currentList = this.viewer.getListById(paraFormat.listFormat.listId);\n            var listLevel = this.viewer.layout.getListLevel(currentList, paraFormat.listFormat.listLevelNumber);\n            // tslint:disable-next-line:max-line-length\n            if (modifiedLevelsInternal.containsKey(paraFormat.listFormat.listLevelNumber)\n                && modifiedLevelsInternal.get(paraFormat.listFormat.listLevelNumber).ownerListLevel === listLevel) {\n                var modifiedFormat = new WParagraphFormat(null);\n                modifiedFormat.leftIndent = paraFormat.leftIndent;\n                modifiedFormat.firstLineIndent = paraFormat.firstLineIndent;\n                var modified = new ModifiedParagraphFormat(paraFormat, modifiedFormat);\n                collection.push(modified);\n                this.owner.editorModule.copyFromListLevelParagraphFormat(paraFormat, listLevel.paragraphFormat);\n            }\n        }\n        this.modifiedParaFormats.add(this.currentBaseHistoryInfo, collection);\n    };\n    /**\n     * Update list changes\n     * @param  {Dictionary<number, ModifiedLevel>} modifiedCollection\n     * @param  {Selection} selection\n     * @private\n     */\n    EditorHistory.prototype.updateListChanges = function (modifiedCollection) {\n        this.viewer.owner.isLayoutEnabled = false;\n        this.owner.editorModule.updateListParagraphs();\n        for (var i = 0; i < modifiedCollection.keys.length; i++) {\n            var levelNumber = modifiedCollection.keys[0];\n            var modifiedLevel = modifiedCollection.get(levelNumber);\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                // tslint:disable-next-line:max-line-length\n                modifiedLevel = this.currentBaseHistoryInfo.addModifiedPropertiesForList(modifiedLevel.ownerListLevel);\n            }\n            this.owner.editorModule.copyListLevel(modifiedLevel.ownerListLevel, modifiedLevel.modifiedListLevel);\n        }\n        this.revertListChanges();\n        this.viewer.owner.isLayoutEnabled = true;\n        this.viewer.renderedLists.clear();\n        this.viewer.pages = [];\n        this.viewer.layout.layout();\n        var selection = this.viewer.selection;\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            selection.end.updatePhysicalPosition(true);\n        }\n        selection.upDownSelectionLength = selection.end.location.x;\n        selection.fireSelectionChanged(false);\n        this.updateHistory();\n    };\n    /**\n     * Revert list changes\n     * @param  {Selection} selection\n     */\n    EditorHistory.prototype.revertListChanges = function () {\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(this.currentBaseHistoryInfo)\n            && this.viewer.owner.editorHistory.modifiedParaFormats.containsKey(this.currentBaseHistoryInfo)) {\n            // tslint:disable-next-line:max-line-length\n            var collection = this.modifiedParaFormats.get(this.currentBaseHistoryInfo);\n            for (var i = 0; i < collection.length; i++) {\n                var modified = new WParagraphFormat(null);\n                modified.leftIndent = collection[i].ownerFormat.leftIndent;\n                modified.firstLineIndent = collection[i].ownerFormat.firstLineIndent;\n                collection[i].ownerFormat.copyFormat(collection[i].modifiedFormat);\n                collection[i].modifiedFormat.leftIndent = modified.leftIndent;\n                collection[i].modifiedFormat.firstLineIndent = modified.firstLineIndent;\n            }\n        }\n    };\n    /**\n     * Reverts the last editing action.\n     */\n    EditorHistory.prototype.undo = function () {\n        if (this.owner.isReadOnlyMode || !this.canUndo() || !this.owner.enableHistoryMode) {\n            return;\n        }\n        //this.owner.ClearTextSearchResults();\n        var historyInfo = this.undoStack.pop();\n        this.isUndoing = true;\n        historyInfo.revert();\n        this.isUndoing = false;\n        this.owner.selection.checkForCursorVisibility();\n        this.owner.editorModule.isBordersAndShadingDialog = false;\n    };\n    /**\n     * Performs the last reverted action.\n     */\n    EditorHistory.prototype.redo = function () {\n        if (this.owner.isReadOnlyMode || !this.canRedo() || !this.owner.enableHistoryMode) {\n            return;\n        }\n        //this.owner.ClearTextSearchResults();\n        var historyInfo = this.redoStack.pop();\n        if (historyInfo.action === 'BordersAndShading') {\n            this.owner.editorModule.isBordersAndShadingDialog = true;\n        }\n        this.isRedoing = true;\n        historyInfo.revert();\n        this.isRedoing = false;\n        this.owner.selection.checkForCursorVisibility();\n        this.owner.editorModule.isBordersAndShadingDialog = false;\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.destroy = function () {\n        this.clearHistory();\n        this.undoStackIn = undefined;\n        this.redoStackIn = undefined;\n    };\n    EditorHistory.prototype.clearHistory = function () {\n        this.clearUndoStack();\n        this.clearRedoStack();\n    };\n    EditorHistory.prototype.clearUndoStack = function () {\n        if (this.canUndo()) {\n            while (this.undoStack.length > 0) {\n                var historyInfo = this.undoStack.pop();\n                historyInfo.destroy();\n                historyInfo = undefined;\n            }\n        }\n    };\n    EditorHistory.prototype.clearRedoStack = function () {\n        if (this.canRedo()) {\n            while (this.redoStack.length > 0) {\n                var historyInfo = this.redoStack.pop();\n                historyInfo.destroy();\n                historyInfo = undefined;\n            }\n        }\n    };\n    return EditorHistory;\n}());\nexport { EditorHistory };\n","import { WTableHolder } from '../viewer/page';\n/**\n * @private\n */\nvar ModifiedLevel = /** @class */ (function () {\n    function ModifiedLevel(owner, modified) {\n        this.ownerListLevelIn = undefined;\n        this.modifiedListLevelIn = undefined;\n        this.ownerListLevel = owner;\n        this.modifiedListLevel = modified;\n    }\n    Object.defineProperty(ModifiedLevel.prototype, \"ownerListLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.ownerListLevelIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.ownerListLevelIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ModifiedLevel.prototype, \"modifiedListLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.modifiedListLevelIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.modifiedListLevelIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ModifiedLevel.prototype.destroy = function () {\n        this.ownerListLevel = undefined;\n        this.modifiedListLevel = undefined;\n    };\n    return ModifiedLevel;\n}());\nexport { ModifiedLevel };\n/**\n * @private\n */\nvar ModifiedParagraphFormat = /** @class */ (function () {\n    function ModifiedParagraphFormat(ownerFormat, modifiedFormat) {\n        this.ownerFormatIn = undefined;\n        this.modifiedFormatIn = undefined;\n        this.ownerFormat = ownerFormat;\n        this.modifiedFormat = modifiedFormat;\n    }\n    Object.defineProperty(ModifiedParagraphFormat.prototype, \"ownerFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.ownerFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.ownerFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ModifiedParagraphFormat.prototype, \"modifiedFormat\", {\n        /**\n         * hidden\n         */\n        get: function () {\n            return this.modifiedFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.modifiedFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ModifiedParagraphFormat.prototype.destroy = function () {\n        this.ownerFormat = undefined;\n        this.modifiedFormat.destroy();\n        this.modifiedFormat = undefined;\n    };\n    return ModifiedParagraphFormat;\n}());\nexport { ModifiedParagraphFormat };\n/**\n * @private\n */\nvar RowHistoryFormat = /** @class */ (function () {\n    function RowHistoryFormat(startingPoint, rowFormat) {\n        this.startingPoint = startingPoint;\n        this.rowFormat = rowFormat;\n        this.rowHeightType = rowFormat.heightType;\n    }\n    RowHistoryFormat.prototype.revertChanges = function (isRedo, owner) {\n        //backup current format values.\n        var currentRowHeightType = this.rowFormat.heightType;\n        //Restore old values.\n        owner.editorModule.tableResize.updateRowHeight(this.rowFormat.ownerBase, isRedo ? this.displacement : (-this.displacement));\n        owner.viewer.layout.reLayoutTable(this.rowFormat.ownerBase.ownerTable);\n        if (this.rowFormat.heightType !== this.rowHeightType) {\n            this.rowFormat.heightType = this.rowHeightType;\n        }\n        //backup the current format values for redo.\n        this.rowHeightType = currentRowHeightType;\n    };\n    return RowHistoryFormat;\n}());\nexport { RowHistoryFormat };\n/**\n * @private\n */\nvar TableHistoryInfo = /** @class */ (function () {\n    function TableHistoryInfo(table, owner) {\n        this.tableHolder = new WTableHolder();\n        this.tableFormat = new TableFormatHistoryInfo();\n        this.rows = [];\n        this.owner = owner;\n        this.copyProperties(table);\n    }\n    TableHistoryInfo.prototype.copyProperties = function (table) {\n        if (table.tableHolder) {\n            this.tableHolder = table.tableHolder.clone();\n        }\n        if (table.tableFormat) {\n            this.tableFormat.leftIndent = table.tableFormat.leftIndent;\n            this.tableFormat.preferredWidth = table.tableFormat.preferredWidth;\n            this.tableFormat.preferredWidthType = table.tableFormat.preferredWidthType;\n            this.tableFormat.allowAutoFit = table.tableFormat.allowAutoFit;\n        }\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowFormat = new RowFormatHistoryInfo();\n            rowFormat.gridBefore = row.rowFormat.gridBefore;\n            rowFormat.gridBeforeWidth = row.rowFormat.gridBeforeWidth;\n            rowFormat.gridBeforeWidthType = row.rowFormat.gridBeforeWidthType;\n            rowFormat.gridAfter = row.rowFormat.gridAfter;\n            rowFormat.gridAfterWidth = row.rowFormat.gridAfterWidth;\n            rowFormat.gridAfterWidthType = row.rowFormat.gridAfterWidthType;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellFormat = new CellFormatHistoryInfo();\n                cellFormat.columnIndex = cell.columnIndex;\n                cellFormat.columnSpan = cell.cellFormat.columnSpan;\n                cellFormat.preferredWidth = cell.cellFormat.preferredWidth;\n                cellFormat.preferredWidthType = cell.cellFormat.preferredWidthType;\n                rowFormat.cells.push(cellFormat);\n            }\n            this.rows.push(rowFormat);\n        }\n        this.tableHierarchicalIndex = this.owner.editorModule.getHierarchicalIndex(table, '0');\n    };\n    TableHistoryInfo.prototype.destroy = function () {\n        this.tableHierarchicalIndex = undefined;\n        if (this.tableHolder) {\n            this.tableHolder.destroy();\n            this.tableHolder = undefined;\n        }\n        if (this.tableFormat) {\n            this.tableFormat = null;\n        }\n        if (this.rows) {\n            this.rows = [];\n            this.rows = undefined;\n        }\n    };\n    return TableHistoryInfo;\n}());\nexport { TableHistoryInfo };\n/**\n * @private\n */\nvar TableFormatHistoryInfo = /** @class */ (function () {\n    function TableFormatHistoryInfo() {\n        /* tslint:disable:no-empty */\n    }\n    return TableFormatHistoryInfo;\n}());\nexport { TableFormatHistoryInfo };\n/**\n * @private\n */\nvar RowFormatHistoryInfo = /** @class */ (function () {\n    function RowFormatHistoryInfo() {\n        this.cells = [];\n    }\n    return RowFormatHistoryInfo;\n}());\nexport { RowFormatHistoryInfo };\n/**\n * @private\n */\nvar CellFormatHistoryInfo = /** @class */ (function () {\n    function CellFormatHistoryInfo() {\n        /* tslint:disable:no-empty */\n    }\n    return CellFormatHistoryInfo;\n}());\nexport { CellFormatHistoryInfo };\n/**\n * @private\n */\nvar CellHistoryFormat = /** @class */ (function () {\n    function CellHistoryFormat(point) {\n        this.startingPoint = point; // starting point preserved to calculate the displacement on after cell resizing finished.\n    }\n    return CellHistoryFormat;\n}());\nexport { CellHistoryFormat };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { BaseHistoryInfo } from './base-history-info';\n/**\n * EditorHistory preservation class\n */\n/**\n * @private\n */\nvar HistoryInfo = /** @class */ (function (_super) {\n    __extends(HistoryInfo, _super);\n    function HistoryInfo(node, isChild) {\n        var _this = _super.call(this, node) || this;\n        _this.isChildHistoryInfo = false;\n        _this.isChildHistoryInfo = isChild;\n        return _this;\n    }\n    Object.defineProperty(HistoryInfo.prototype, \"hasAction\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return !isNullOrUndefined(this.modifiedActions);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Adds the modified actions\n     * @param  {BaseHistoryInfo} baseHistoryInfo\n     * @private\n     */\n    HistoryInfo.prototype.addModifiedAction = function (baseHistoryInfo) {\n        // For complex actions such as Replace text, Insert/Remove Hyperlink etc.\n        if (!(this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n            if (isNullOrUndefined(this.modifiedActions)) {\n                this.modifiedActions = [];\n            }\n            this.modifiedActions.push(baseHistoryInfo);\n        }\n    };\n    /**\n     * Reverts this instance\n     * @private\n     */\n    HistoryInfo.prototype.revert = function () {\n        this.editorHistory.currentHistoryInfo = this;\n        if (this.action === 'BordersAndShading') {\n            this.owner.editorModule.isBordersAndShadingDialog = true;\n        }\n        if (!isNullOrUndefined(this.modifiedActions)) {\n            if (this.editorHistory.isUndoing) {\n                var i = this.modifiedActions.length;\n                while (i > 0) {\n                    var baseHistoryInfo = this.modifiedActions[i - 1];\n                    baseHistoryInfo.revert();\n                    i = i - 1;\n                }\n            }\n            else {\n                var i = 0;\n                while (i < this.modifiedActions.length) {\n                    var baseHistoryInfo = this.modifiedActions[i];\n                    baseHistoryInfo.revert();\n                    i = i + 1;\n                }\n            }\n        }\n        if (!this.isChildHistoryInfo) {\n            this.editorHistory.updateComplexHistory();\n        }\n        else {\n            this.editorHistory.updateComplexHistoryInternal();\n        }\n    };\n    /**\n     * @private\n     */\n    HistoryInfo.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.modifiedActions)) {\n            while (this.modifiedActions.length > 0) {\n                var baseHistoryInfo = this.modifiedActions[this.modifiedActions.length - 1];\n                baseHistoryInfo.destroy();\n                this.modifiedActions.splice(this.modifiedActions.indexOf(baseHistoryInfo), 1);\n            }\n            this.modifiedActions = undefined;\n        }\n        _super.prototype.destroy.call(this);\n    };\n    return HistoryInfo;\n}(BaseHistoryInfo));\nexport { HistoryInfo };\n","/**\n * EditorHistory implementation\n */\nexport * from './editor-history';\nexport * from './base-history-info';\nexport * from './history-info';\nexport * from './history-helper';\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { FieldElementBox } from '../viewer/page';\n/**\n * @private\n */\nvar HelperMethods = /** @class */ (function () {\n    function HelperMethods() {\n    }\n    /**\n     * Inserts text at specified index in string.\n     * @param {string} spanText\n     * @param {number} index\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.insert = function (spanText, index, text) {\n        if (index >= 0) {\n            return [spanText.slice(0, index) + text + spanText.slice(index)].join('');\n        }\n        else {\n            return text + this;\n        }\n    };\n    /**\n     * Removes text from specified index in string.\n     * @param {string} text\n     * @param {number} index\n     * @param {number} length\n     * @private\n     */\n    HelperMethods.remove = function (text, index, length) {\n        if (index === 0) {\n            return text.substring(index + 1, text.length);\n        }\n        else {\n            return text.substring(0, index) + text.substring(index + 1, text.length);\n        }\n    };\n    /**\n     * Returns the index of word split character in a string.\n     * @param {string} text\n     * @param {string[]} wordSplitCharacter\n     * @private\n     */\n    /* tslint:disable:no-any */\n    HelperMethods.indexOfAny = function (text, wordSplitCharacter) {\n        var index = undefined;\n        for (var j = 0; j < wordSplitCharacter.length; j++) {\n            var temp = text.indexOf(wordSplitCharacter[j]);\n            if (temp !== -1 && isNullOrUndefined(index)) {\n                index = temp;\n            }\n            else if (temp !== -1 && temp < index) {\n                index = temp;\n            }\n        }\n        return isNullOrUndefined(index) ? -1 : index;\n    };\n    /**\n     * Returns the last index of word split character in a string.\n     * @param {string} text\n     * @param {string[]} wordSplitCharacter\n     * @private\n     */\n    HelperMethods.lastIndexOfAny = function (text, wordSplitCharacter) {\n        for (var i = text.length - 1; i >= 0; i--) {\n            for (var j = 0; j <= wordSplitCharacter.length - 1; j++) {\n                if (text[i] === wordSplitCharacter[j]) {\n                    return i;\n                }\n            }\n        }\n        return -1;\n    };\n    /**\n     * Adds css styles to document header.\n     * @param {string} css\n     * @private\n     */\n    HelperMethods.addCssStyle = function (css) {\n        var style = document.createElement('style');\n        if (style.style.cssText) {\n            style.style.cssText = css;\n        }\n        else {\n            style.appendChild(document.createTextNode(css));\n        }\n        document.getElementsByTagName('head')[0].appendChild(style);\n    };\n    /**\n     * Gets highlight color code.\n     * @param {HighlightColor} highlightColor\n     * @private\n     */\n    HelperMethods.getHighlightColorCode = function (highlightColor) {\n        var color = '#ffffff';\n        switch (highlightColor) {\n            case 'Yellow':\n                color = '#ffff00';\n                break;\n            case 'BrightGreen':\n                color = '#00ff00';\n                break;\n            case 'Turquoise':\n                color = '#00ffff';\n                break;\n            case 'Pink':\n                color = '#ff00ff';\n                break;\n            case 'Blue':\n                color = '#0000ff';\n                break;\n            case 'Red':\n                color = '#ff0000';\n                break;\n            case 'DarkBlue':\n                color = '#000080';\n                break;\n            case 'Teal':\n                color = '#008080';\n                break;\n            case 'Green':\n                color = '#008000';\n                break;\n            case 'Violet':\n                color = '#800080';\n                break;\n            case 'DarkRed':\n                color = '#800000';\n                break;\n            case 'DarkYellow':\n                color = '#808000';\n                break;\n            case 'Gray50':\n                color = '#808080';\n                break;\n            case 'Gray25':\n                color = '#c0c0c0';\n                break;\n            case 'Black':\n                color = '#000000';\n                break;\n        }\n        return color;\n    };\n    /**\n     * Converts point to pixel.\n     * @param {number} point\n     * @private\n     */\n    HelperMethods.convertPointToPixel = function (point) {\n        var pixel = HelperMethods.round((point * 96 / 72), 5);\n        return pixel;\n    };\n    /**\n     * Converts pixel to point.\n     * @param {number} pixel\n     * @private\n     */\n    HelperMethods.convertPixelToPoint = function (pixel) {\n        var point = HelperMethods.round((pixel * 72 / 96), 5);\n        return point;\n    };\n    /**\n     * Return true if field linked\n     * @private\n     */\n    HelperMethods.isLinkedFieldCharacter = function (inline) {\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            return !isNullOrUndefined(inline.fieldEnd);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            return !isNullOrUndefined(inline.fieldBegin) && !isNullOrUndefined(inline.fieldEnd);\n        }\n        else {\n            return !isNullOrUndefined(inline.fieldBegin);\n        }\n    };\n    /**\n     * Removes white space in a string.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.removeSpace = function (text) {\n        if (!isNullOrUndefined(text) && text.length !== 0) {\n            for (var i = 0; i < text.length; i++) {\n                if (text.charAt(i) === ' ') {\n                    //replace the space by empty string in string\n                    text = text.replace(' ', '');\n                }\n            }\n        }\n        return text;\n    };\n    /**\n     * Trims white space at start of the string.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.trimStart = function (text) {\n        var i = 0;\n        for (i; i < text.length; i++) {\n            if (text[i] !== ' ') {\n                break;\n            }\n        }\n        return text.substring(i, text.length);\n    };\n    /**\n     * Trims white space at end of the string.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.trimEnd = function (text) {\n        var i = text.length - 1;\n        for (i; i >= 0; i--) {\n            if (text[i] !== ' ') {\n                break;\n            }\n        }\n        return text.substring(0, i + 1);\n    };\n    /**\n     * Checks whether string ends with whitespace.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.endsWith = function (text) {\n        if (!isNullOrUndefined(text) && text.length !== 0) {\n            return text[text.length - 1] === ' ';\n        }\n        return false;\n    };\n    /**\n     * Return specified number of string count\n     * @private\n     */\n    HelperMethods.addSpace = function (length) {\n        var str = '';\n        if (length > 0) {\n            for (var i = 0; i < length; i++) {\n                str += ' ';\n            }\n        }\n        return str;\n    };\n    /**\n     * @private\n     * Write Characterformat\n     * @param {any} characterFormat\n     * @param {boolean} isInline\n     * @param {WCharacterFormat} format\n     */\n    HelperMethods.writeCharacterFormat = function (characterFormat, isInline, format) {\n        characterFormat.bold = isInline ? format.bold : format.getValue('bold');\n        characterFormat.italic = isInline ? format.italic : format.getValue('italic');\n        characterFormat.fontSize = isInline ? format.fontSize : format.getValue('fontSize');\n        characterFormat.fontFamily = isInline ? format.fontFamily : format.getValue('fontFamily');\n        characterFormat.underline = isInline ? format.underline : format.getValue('underline');\n        characterFormat.strikethrough = isInline ? format.strikethrough : format.getValue('strikethrough');\n        characterFormat.baselineAlignment = isInline ? format.baselineAlignment : format.getValue('baselineAlignment');\n        characterFormat.highlightColor = isInline ? format.highlightColor : format.getValue('highlightColor');\n        characterFormat.fontColor = isInline ? format.fontColor : format.getValue('fontColor');\n        characterFormat.styleName = !isNullOrUndefined(format.baseCharStyle) ? format.baseCharStyle.name : undefined;\n        characterFormat.bidi = isInline ? format.bidi : format.getValue('bidi');\n        characterFormat.bdo = isInline ? format.bdo : format.getValue('bdo');\n        characterFormat.boldBidi = isInline ? format.boldBidi : format.getValue('boldBidi');\n        characterFormat.italicBidi = isInline ? format.italicBidi : format.getValue('italicBidi');\n        characterFormat.fontSizeBidi = isInline ? format.fontSizeBidi : format.getValue('fontSizeBidi');\n        characterFormat.fontFamilyBidi = isInline ? format.fontFamilyBidi : format.getValue('fontFamilyBidi');\n    };\n    /* tslint:enable:no-any */\n    /**\n     * Rounds the values with specified decimal digits.\n     * @param {number} value\n     * @param {number} decimalDigits\n     * @private\n     */\n    HelperMethods.round = function (value, decimalDigits) {\n        var temp = value;\n        for (var i = 0; i < decimalDigits; i++) {\n            temp = temp * 10;\n        }\n        temp = Math.round(temp);\n        for (var i = 0; i < decimalDigits; i++) {\n            temp = temp / 10;\n        }\n        return temp;\n    };\n    HelperMethods.ReverseString = function (text) {\n        if (!isNullOrUndefined(text) && text !== '') {\n            // return a new array\n            var splitString = text.split('');\n            // reverse the new created array\n            var reverseString = splitString.reverse();\n            // join all elements of the array into a string\n            text = reverseString.join('');\n        }\n        return text;\n    };\n    /**\n     * @private\n     */\n    HelperMethods.formatClippedString = function (base64ImageString) {\n        var extension = '';\n        var formatClippedString = '';\n        if (this.startsWith(base64ImageString, 'data:image/bmp;base64,')) {\n            extension = '.bmp';\n            formatClippedString = base64ImageString.replace('data:image/bmp;base64,', '');\n        }\n        else if (this.startsWith(base64ImageString, 'data:image/x-emf;base64,')) {\n            extension = '.emf';\n            formatClippedString = base64ImageString.replace('data:image/x-emf;base64,', '');\n        }\n        else if (this.startsWith(base64ImageString, 'data:image/exif;base64,')) {\n            extension = '.exif';\n            formatClippedString = base64ImageString.replace('data:image/exif;base64,', '');\n        }\n        else if (this.startsWith(base64ImageString, 'data:image/gif;base64,')) {\n            extension = '.gif';\n            formatClippedString = base64ImageString.replace('data:image/gif;base64,', '');\n        }\n        else if (this.startsWith(base64ImageString, 'data:image/icon;base64,')) {\n            extension = '.ico';\n            formatClippedString = base64ImageString.replace('data:image/icon;base64,', '');\n        }\n        else if (this.startsWith(base64ImageString, 'data:image/jpeg;base64,')) {\n            extension = '.jpeg';\n            formatClippedString = base64ImageString.replace('data:image/jpeg;base64,', '');\n        }\n        else if (this.startsWith(base64ImageString, 'data:image/jpg;base64,')) {\n            extension = '.jpg';\n            formatClippedString = base64ImageString.replace('data:image/jpg;base64,', '');\n        }\n        else if (this.startsWith(base64ImageString, 'data:image/png;base64,')) {\n            extension = '.png';\n            formatClippedString = base64ImageString.replace('data:image/png;base64,', '');\n        }\n        else if (this.startsWith(base64ImageString, 'data:image/tiff;base64,')) {\n            extension = '.tif';\n            formatClippedString = base64ImageString.replace('data:image/tiff;base64,', '');\n        }\n        else if (this.startsWith(base64ImageString, 'data:image/x-wmf;base64,')) {\n            extension = '.wmf';\n            formatClippedString = base64ImageString.replace('data:image/x-wmf;base64,', '');\n        }\n        else {\n            extension = '.jpeg';\n        }\n        return { 'extension': extension, 'formatClippedString': formatClippedString };\n    };\n    HelperMethods.startsWith = function (sourceString, startString) {\n        return startString.length > 0 && sourceString.substring(0, startString.length) === startString;\n    };\n    /**\n     * @private\n     */\n    HelperMethods.wordBefore = '\\\\b';\n    /**\n     * @private\n     */\n    HelperMethods.wordAfter = '\\\\b';\n    /**\n     * @private\n     */\n    HelperMethods.wordSplitCharacters = [' ', ',', '.', ':', ';', '<', '>', '=',\n        '+', '-', '_', '{', '}', '[', ']', '`', '~', '!', '@', '#', '$', '%', '^', '&',\n        '*', '(', ')', '\"', '?', '/', '|', '\\\\', '”', '　', '،', '؟', '؛', '’', '‘'];\n    return HelperMethods;\n}());\nexport { HelperMethods };\n/**\n * @private\n */\nvar Point = /** @class */ (function () {\n    function Point(xPosition, yPosition) {\n        this.xIn = 0;\n        this.yIn = 0;\n        this.xIn = xPosition;\n        this.yIn = yPosition;\n    }\n    Object.defineProperty(Point.prototype, \"x\", {\n        /**\n         * Gets or sets x value.\n         * @private\n         */\n        get: function () {\n            return this.xIn;\n        },\n        set: function (value) {\n            this.xIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Point.prototype, \"y\", {\n        /**\n         * Gets or sets y value.\n         * @private\n         */\n        get: function () {\n            return this.yIn;\n        },\n        set: function (value) {\n            this.yIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    Point.prototype.copy = function (point) {\n        this.xIn = point.xIn;\n        this.yIn = point.yIn;\n    };\n    /**\n     * Destroys the internal objects maintained.\n     * @returns void\n     */\n    Point.prototype.destroy = function () {\n        this.xIn = undefined;\n        this.yIn = undefined;\n    };\n    return Point;\n}());\nexport { Point };\n","import { TextPosition, ImageFormat } from '../selection/selection-helper';\nimport { ParagraphWidget, LineWidget, ElementBox, TextElementBox, Margin, ImageElementBox, BlockWidget, BlockContainer, BodyWidget, TableWidget, TableCellWidget, TableRowWidget, Widget, ListTextElementBox, BookmarkElementBox, HeaderFooterWidget, FieldTextElementBox, TabElementBox } from '../viewer/page';\nimport { WCharacterFormat } from '../format/character-format';\nimport { HelperMethods } from './editor-helper';\nimport { isNullOrUndefined, Browser, classList } from '@syncfusion/ej2-base';\nimport { WParagraphFormat, WSectionFormat, WListFormat, WTableFormat, WRowFormat, WCellFormat, WBorder, WBorders, WTabStop } from '../index';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\nimport { WLevelOverride } from '../list/level-override';\nimport { FieldElementBox } from '../viewer/page';\nimport { WCharacterStyle } from '../format/style';\nimport { TableResizer } from './table-resizer';\nimport { WParagraphStyle } from '../format/style';\n/**\n * Editor module\n */\nvar Editor = /** @class */ (function () {\n    /**\n     * Initialize the editor module\n     * @param  {LayoutViewer} viewer\n     * @private\n     */\n    function Editor(viewer) {\n        var _this = this;\n        this.nodes = [];\n        this.editHyperlinkInternal = false;\n        this.startParagraph = undefined;\n        this.endParagraph = undefined;\n        /**\n         * @private\n         */\n        this.isHandledComplex = false;\n        /**\n         * @private\n         */\n        this.tableResize = undefined;\n        /**\n         * @private\n         */\n        this.tocStyles = {};\n        this.refListNumber = undefined;\n        this.incrementListNumber = -1;\n        this.removedBookmarkElements = [];\n        /**\n         * @private\n         */\n        this.tocBookmarkId = 0;\n        /**\n         * @private\n         */\n        this.copiedData = undefined;\n        this.pageRefFields = {};\n        /**\n         * @private\n         */\n        this.isInsertingTOC = false;\n        /**\n         * @private\n         */\n        this.isBordersAndShadingDialog = false;\n        /**\n         * @private\n         */\n        this.onTextInputInternal = function (event) {\n            if (Browser.isDevice) {\n                var viewer = _this.viewer;\n                var nbsp = new RegExp(String.fromCharCode(160), 'g');\n                var lineFeed = new RegExp(String.fromCharCode(10), 'g');\n                viewer.prefix = viewer.prefix.replace(nbsp, ' ').replace(lineFeed, ' ');\n                var text = viewer.editableDiv.textContent.replace(nbsp, ' ').replace(lineFeed, ' ');\n                var textBoxText = text.substring(2);\n                if (viewer.isCompositionStart && viewer.isCompositionUpdated) {\n                    viewer.isCompositionUpdated = false;\n                    if (!viewer.owner.isReadOnlyMode && viewer.owner.isDocumentLoaded) {\n                        if (viewer.prefix.substring(2) !== textBoxText) {\n                            if (_this.selection.isEmpty) {\n                                // tslint:disable-next-line:max-line-length\n                                _this.selection.start.setPositionForLineWidget(viewer.selection.start.currentWidget, _this.selection.start.offset - (viewer.prefix.length - 2));\n                                _this.handleTextInput(textBoxText);\n                                viewer.prefix = '@' + String.fromCharCode(160) + textBoxText;\n                            }\n                            else {\n                                _this.handleTextInput(textBoxText);\n                                viewer.prefix = '@' + String.fromCharCode(160) + textBoxText;\n                            }\n                        }\n                    }\n                    return;\n                }\n                else if (viewer.isCompositionStart && viewer.isCompositionEnd && viewer.suffix === '') {\n                    if (viewer.prefix.substring(2) !== textBoxText) {\n                        if (_this.selection.isEmpty && viewer.isCompositionStart) {\n                            viewer.isCompositionStart = false;\n                            // tslint:disable-next-line:max-line-length\n                            _this.selection.start.setPositionForLineWidget(viewer.selection.start.currentWidget, _this.selection.start.offset - viewer.prefix.substring(2).length);\n                            _this.selection.retrieveCurrentFormatProperties();\n                            if (viewer.suffix === '' || textBoxText === '') {\n                                _this.handleTextInput(textBoxText);\n                            }\n                        }\n                        else if (!_this.selection.isEmpty) {\n                            viewer.isCompositionStart = false;\n                            _this.handleTextInput(textBoxText);\n                        }\n                    }\n                    else if (textBoxText === '') {\n                        viewer.isCompositionStart = false;\n                        _this.handleBackKey();\n                    }\n                    else if (viewer.prefix.substring(2) === textBoxText && viewer.suffix === '') {\n                        viewer.isCompositionStart = false;\n                        _this.handleTextInput(' ');\n                    }\n                    viewer.isCompositionEnd = false;\n                    return;\n                }\n                else if (viewer.isCompositionEnd || viewer.isCompositionStart && !viewer.isCompositionUpdated) {\n                    if (textBoxText.length < viewer.prefix.length &&\n                        textBoxText === viewer.prefix.substring(2, viewer.prefix.length - 1) || viewer.editableDiv.innerText.length < 2) {\n                        _this.handleBackKey();\n                        return;\n                    }\n                    else if (viewer.suffix !== '' &&\n                        viewer.editableDiv.innerText[viewer.editableDiv.innerText.length - 1] !== String.fromCharCode(160)) {\n                        viewer.isCompositionStart = false;\n                        //When cursor is placed in between a word and chosen a word from predicted words.\n                        // tslint:disable-next-line:max-line-length\n                        _this.selection.start.setPositionForLineWidget(viewer.selection.start.currentWidget, _this.selection.start.offset - (viewer.prefix.length - 2));\n                        _this.selection.end.setPositionForLineWidget(viewer.selection.end.currentWidget, _this.selection.end.offset + viewer.suffix.length);\n                        //Retrieve the character format properties. Since the selection was changed manually.\n                        _this.selection.retrieveCurrentFormatProperties();\n                        _this.handleTextInput(textBoxText);\n                        return;\n                    }\n                }\n                // tslint:disable-next-line:max-line-length\n                if (text !== '\\r' && text !== '\\b' && text !== '\\u001B' && !viewer.owner.isReadOnlyMode && viewer.isControlPressed === false) {\n                    if (text === '@' || text[0] !== '@' || text === '' || text.length < viewer.prefix.length &&\n                        textBoxText === viewer.prefix.substring(2, viewer.prefix.length - 1)) {\n                        _this.handleBackKey();\n                        if (viewer.editableDiv.innerText.length < 2) {\n                            _this.predictText();\n                        }\n                    }\n                    else if (text.indexOf(viewer.prefix) === 0 && text.length > viewer.prefix.length) {\n                        _this.handleTextInput(text.substring(viewer.prefix.length));\n                    }\n                    else if (text.indexOf(viewer.prefix) === -1 && text[text.length - 1] !== String.fromCharCode(160)\n                        && text[text.length - 1] !== ' ') {\n                        if ((textBoxText.charAt(0).toLowerCase() + textBoxText.slice(1)) === viewer.prefix.substring(2)) {\n                            // tslint:disable-next-line:max-line-length\n                            _this.selection.start.setPositionParagraph(viewer.selection.start.currentWidget, _this.selection.start.offset - (viewer.prefix.length - 2));\n                        }\n                        _this.handleTextInput(textBoxText);\n                    }\n                    else if (text.length !== 2) {\n                        _this.handleTextInput(' ');\n                    }\n                }\n            }\n            else {\n                var text = _this.viewer.editableDiv.innerText;\n                if (text !== String.fromCharCode(160)) {\n                    // tslint:disable-next-line:max-line-length\n                    if (text !== '\\r' && text !== '\\b' && text !== '\\u001B' && !_this.owner.isReadOnlyMode && _this.viewer.isControlPressed === false) {\n                        _this.handleTextInput(text);\n                    }\n                }\n                else {\n                    _this.handleTextInput(' ');\n                }\n                _this.viewer.editableDiv.innerText = '';\n            }\n        };\n        /**\n         * Fired on paste.\n         * @param {ClipboardEvent} event\n         * @private\n         */\n        this.onPaste = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.pasteInternal(event);\n            }\n            event.preventDefault();\n        };\n        this.viewer = viewer;\n        this.tableResize = new TableResizer(this.viewer.owner);\n    }\n    Object.defineProperty(Editor.prototype, \"editorHistory\", {\n        get: function () {\n            return this.viewer.owner.editorHistory;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Editor.prototype, \"selection\", {\n        get: function () {\n            if (this.viewer) {\n                return this.viewer.selection;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Editor.prototype, \"owner\", {\n        get: function () {\n            return this.viewer.owner;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Editor.prototype.getModuleName = function () {\n        return 'Editor';\n    };\n    Editor.prototype.insertField = function (code, result) {\n        var fieldCode = code;\n        if (isNullOrUndefined(result)) {\n            fieldCode = HelperMethods.trimStart(fieldCode);\n            if (fieldCode.substring(0, 10) === 'MERGEFIELD') {\n                fieldCode = fieldCode.substring(10).trim();\n                var index = fieldCode.indexOf('\\\\*');\n                result = '«' + fieldCode.substring(0, index).trim() + '»';\n            }\n        }\n        var paragraph = new ParagraphWidget();\n        var line = new LineWidget(paragraph);\n        var fieldBegin = new FieldElementBox(0);\n        line.children.push(fieldBegin);\n        var fieldCodeSpan = new TextElementBox();\n        fieldCodeSpan.text = code;\n        line.children.push(fieldCodeSpan);\n        var fieldSeparator = new FieldElementBox(2);\n        fieldSeparator.fieldBegin = fieldBegin;\n        fieldBegin.fieldSeparator = fieldSeparator;\n        line.children.push(fieldSeparator);\n        var fieldResultSpan = new TextElementBox();\n        fieldResultSpan.text = result;\n        line.children.push(fieldResultSpan);\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.fieldSeparator = fieldSeparator;\n        fieldEnd.fieldBegin = fieldBegin;\n        fieldBegin.fieldEnd = fieldEnd;\n        fieldSeparator.fieldEnd = fieldEnd;\n        line.children.push(fieldEnd);\n        fieldBegin.line = line;\n        paragraph.childWidgets.push(line);\n        this.viewer.fields.push(fieldBegin);\n        var widgets = [];\n        widgets.push(paragraph);\n        this.pasteContentsInternal(widgets);\n    };\n    /**\n     * To update style for paragraph\n     * @param style - style name\n     * @param clearDirectFormatting - Removes manual formatting (formatting not applied using a style)\n     * from the selected text, to match the formatting of the applied style. Default value is false.\n     */\n    Editor.prototype.applyStyle = function (style, clearDirectFormatting) {\n        clearDirectFormatting = isNullOrUndefined(clearDirectFormatting) ? false : clearDirectFormatting;\n        if (clearDirectFormatting) {\n            this.initComplexHistory('ApplyStyle');\n            this.clearFormatting();\n        }\n        var styleObj = this.viewer.styles.findByName(style);\n        if (styleObj !== undefined) {\n            this.onApplyParagraphFormat('styleName', styleObj, false, true);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()), JSON.parse(this.viewer.preDefinedStyles.get(style)), this.viewer.styles);\n            this.applyStyle(style);\n        }\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo && this.editorHistory.currentHistoryInfo.action === 'ApplyStyle') {\n            this.editorHistory.updateComplexHistory();\n        }\n    };\n    // Public Implementation Starts\n    /**\n     * Moves the selected content in the document editor control to clipboard.\n     */\n    Editor.prototype.cut = function () {\n        if (this.owner.isReadOnlyMode || this.selection.isEmpty) {\n            return;\n        }\n        this.selection.copySelectedContent(true);\n    };\n    /**\n     * Notify content change event\n     * @private\n     */\n    Editor.prototype.fireContentChange = function () {\n        if (this.viewer.owner.isLayoutEnabled && !this.viewer.owner.isShiftingEnabled) {\n            this.viewer.owner.fireContentChange();\n        }\n    };\n    /**\n     * Update physical location for text position\n     * @private\n     */\n    Editor.prototype.updateSelectionTextPosition = function (isSelectionChanged) {\n        this.getOffsetValue(this.selection);\n        this.selection.start.updatePhysicalPosition(true);\n        if (this.selection.isEmpty) {\n            this.selection.end.setPositionInternal(this.selection.start);\n        }\n        else {\n            this.selection.end.updatePhysicalPosition(true);\n        }\n        this.selection.upDownSelectionLength = this.selection.end.location.x;\n        this.selection.fireSelectionChanged(isSelectionChanged);\n    };\n    /**\n     * Predict text\n     * @private\n     */\n    Editor.prototype.predictText = function () {\n        this.viewer.suffix = '';\n        if (this.selection.start.paragraph.isEmpty() || this.selection.start.offset === 0 &&\n            this.selection.start.currentWidget.isFirstLine() || this.selection.end.offset === 0 &&\n            this.selection.end.currentWidget.isFirstLine()) {\n            this.viewer.prefix = '';\n        }\n        else {\n            this.getPrefixAndSuffix();\n        }\n        this.viewer.prefix = '@' + String.fromCharCode(160) + this.viewer.prefix; // &nbsp;\n        this.viewer.editableDiv.innerText = this.viewer.prefix;\n        this.viewer.selection.setEditableDivCaretPosition(this.viewer.prefix.length);\n    };\n    /**\n     * Gets prefix and suffix.\n     * @private\n     */\n    /* tslint:disable:max-func-body-length */\n    Editor.prototype.getPrefixAndSuffix = function () {\n        var viewer = this.viewer;\n        if (this.selection.text !== '') {\n            viewer.prefix = '';\n            return;\n        }\n        else {\n            var startIndex = 0;\n            var inlineInfo = this.selection.start.currentWidget.getInline(this.selection.start.offset, startIndex);\n            var inline = inlineInfo.element;\n            startIndex = inlineInfo.index;\n            if (inline !== undefined) {\n                var boxInfo = this.selection.getElementBoxInternal(inline, startIndex);\n                var box = boxInfo.element;\n                startIndex = boxInfo.index;\n                var spaceIndex = 0;\n                if (!isNullOrUndefined(box)) {\n                    var prefixAdded = false;\n                    if (box instanceof TextElementBox && startIndex > 0 && box.line.isFirstLine()) {\n                        viewer.prefix = '';\n                    }\n                    if (!(inline instanceof TextElementBox)) {\n                        inline = this.selection.getPreviousTextElement(inline);\n                    }\n                    /* tslint:disable:no-conditional-assignment */\n                    while ((spaceIndex = viewer.prefix.lastIndexOf(' ')) < 0 && inline instanceof TextElementBox) {\n                        if (inline.previousNode instanceof TextElementBox && viewer.prefix.indexOf(' ') === -1) {\n                            if (!prefixAdded) {\n                                viewer.prefix = inline.text.substring(0, startIndex);\n                                prefixAdded = true;\n                            }\n                            else {\n                                viewer.prefix = inline.text + viewer.prefix;\n                            }\n                            inline = inline.previousNode;\n                            // If the line has no elements then break the loop to avoid the exception.\n                            if (inline instanceof ListTextElementBox) {\n                                break;\n                            }\n                            if (!(inline instanceof TextElementBox)) {\n                                inline = this.selection.getPreviousTextElement(inline);\n                            }\n                        }\n                        else if (!(inline.previousNode instanceof TextElementBox)) {\n                            if (!prefixAdded) {\n                                viewer.prefix = inline.text.substring(0, startIndex);\n                                prefixAdded = true;\n                            }\n                            else {\n                                viewer.prefix = inline.text + viewer.prefix;\n                            }\n                            break;\n                        }\n                    }\n                    if (!(viewer.prefix.length > 1 && viewer.prefix[viewer.prefix.length - 1] === ' ' &&\n                        viewer.prefix[viewer.prefix.length - 2] === '.')) {\n                        spaceIndex = viewer.prefix.lastIndexOf(' ');\n                    }\n                    else {\n                        spaceIndex = -1;\n                        viewer.prefix = '';\n                    }\n                    viewer.prefix = spaceIndex < 0 ? viewer.prefix : viewer.prefix.substring(spaceIndex);\n                    if (viewer.prefix.indexOf(' ') === 0 && viewer.prefix.length >= 1) {\n                        viewer.prefix = viewer.prefix.substring(1);\n                    }\n                    // suffix text prediction\n                    var endIndex = 0;\n                    var endInlineInfo = this.selection.end.currentWidget.getInline(this.selection.end.offset, endIndex);\n                    var endInline = endInlineInfo.element;\n                    endIndex = endInlineInfo.index;\n                    boxInfo = this.selection.getElementBoxInternal(endInline, endIndex);\n                    box = boxInfo.element;\n                    endIndex = boxInfo.index;\n                    if (box) {\n                        var suffixAdded = false;\n                        if (box instanceof TextElementBox && endIndex < box.length) {\n                            viewer.suffix = '';\n                        }\n                        // boxIndex = renderedElements.get(endInline).indexOf(box);\n                        while ((spaceIndex = viewer.suffix.indexOf(' ')) < 0 && endInline instanceof TextElementBox) {\n                            if (endInline.nextNode instanceof TextElementBox && viewer.suffix.indexOf(' ') === -1) {\n                                if (!suffixAdded) {\n                                    viewer.suffix = box.text.substring(endIndex);\n                                    suffixAdded = true;\n                                }\n                                else {\n                                    viewer.suffix = viewer.suffix + endInline.text;\n                                }\n                                endInline = endInline.nextNode;\n                            }\n                            else if (!(endInline.nextNode instanceof TextElementBox)) {\n                                if (!suffixAdded) {\n                                    viewer.suffix = box.text.substring(endIndex);\n                                    suffixAdded = true;\n                                }\n                                else {\n                                    viewer.suffix = viewer.suffix + endInline.text;\n                                }\n                                break;\n                            }\n                        }\n                        spaceIndex = viewer.suffix.indexOf(' ');\n                        viewer.suffix = spaceIndex < 0 ? viewer.suffix : viewer.suffix.substring(0, spaceIndex);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * key action\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Editor.prototype.onKeyDownInternal = function (event, ctrl, shift, alt) {\n        var key = event.which || event.keyCode;\n        if (ctrl && !shift && !alt) {\n            this.viewer.isControlPressed = true;\n            switch (key) {\n                case 9:\n                    event.preventDefault();\n                    if (this.owner.acceptTab) {\n                        this.selection.handleTabKey(false, false);\n                    }\n                    break;\n                case 13:\n                    event.preventDefault();\n                    this.insertPageBreak();\n                    break;\n                case 48:\n                    event.preventDefault();\n                    this.onApplyParagraphFormat('beforeSpacing', 0, false, false);\n                    break;\n                case 49:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyParagraphFormat('lineSpacing', 1, false, false);\n                    }\n                    break;\n                case 50:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyParagraphFormat('lineSpacing', 2, false, false);\n                    }\n                    break;\n                case 53:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyParagraphFormat('lineSpacing', 1.5, false, false);\n                    }\n                    break;\n                case 66:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleBold();\n                    }\n                    break;\n                case 68:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode && this.owner.fontDialogModule) {\n                        this.owner.fontDialogModule.showFontDialog();\n                    }\n                    break;\n                case 69:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Center');\n                    }\n                    event.preventDefault();\n                    break;\n                case 72:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnly && this.owner.optionsPaneModule) {\n                        this.owner.optionsPaneModule.isReplace = true;\n                        this.owner.optionsPaneModule.showHideOptionsPane(true);\n                    }\n                    break;\n                case 73:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleItalic();\n                    }\n                    break;\n                case 74:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Justify');\n                    }\n                    event.preventDefault();\n                    break;\n                case 75:\n                    event.preventDefault();\n                    if (this.owner.hyperlinkDialogModule && !this.owner.isReadOnlyMode) {\n                        this.owner.hyperlinkDialogModule.show();\n                    }\n                    break;\n                case 76:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Left');\n                    }\n                    event.preventDefault();\n                    break;\n                case 77:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.increaseIndent();\n                    }\n                    event.preventDefault();\n                    break;\n                case 78:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.openBlank();\n                    }\n                    break;\n                case 82:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Right');\n                    }\n                    event.preventDefault();\n                    break;\n                case 85:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.toggleUnderline('Single');\n                    }\n                    break;\n                case 88:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.editor.cut();\n                    }\n                    break;\n                case 89:\n                    if (this.owner.enableEditorHistory) {\n                        this.editorHistory.redo();\n                        event.preventDefault();\n                    }\n                    break;\n                case 90:\n                    if (this.owner.enableEditorHistory) {\n                        this.editorHistory.undo();\n                        event.preventDefault();\n                    }\n                    break;\n                case 219:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'decrement', true);\n                    }\n                    break;\n                case 221:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'increment', true);\n                    }\n                    break;\n                case 187:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleBaselineAlignment('Subscript');\n                    }\n                    break;\n            }\n        }\n        else if (shift && !ctrl && !alt) {\n            switch (key) {\n                case 9:\n                    event.preventDefault();\n                    if (this.owner.acceptTab) {\n                        this.selection.handleTabKey(false, true);\n                    }\n                    break;\n                case 13:\n                    this.handleShiftEnter();\n                    event.preventDefault();\n                    break;\n            }\n        }\n        else if (shift && ctrl && !alt) {\n            switch (key) {\n                case 68:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.toggleUnderline('Double');\n                    }\n                    break;\n                case 77:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.decreaseIndent();\n                    }\n                    event.preventDefault();\n                    break;\n                case 188:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'decrement', true);\n                    }\n                    break;\n                case 190:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'increment', true);\n                    }\n                    break;\n                case 187:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleBaselineAlignment('Superscript');\n                    }\n            }\n        }\n        else if (!shift && ctrl && alt) {\n            switch (key) {\n                case 72:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode && this.owner.isDocumentLoaded) {\n                        this.toggleHighlightColor();\n                    }\n                    break;\n            }\n        }\n        else {\n            switch (key) {\n                case 8:\n                    event.preventDefault();\n                    this.handleBackKey();\n                    break;\n                case 9:\n                    event.preventDefault();\n                    if (this.owner.acceptTab) {\n                        this.selection.handleTabKey(true, false);\n                    }\n                    break;\n                case 13:\n                    event.preventDefault();\n                    this.handleEnterKey();\n                    break;\n                case 46:\n                    this.handleDelete();\n                    event.preventDefault();\n                    break;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.handleShiftEnter = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.handleTextInput('\\v');\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Handles back key.\n     * @private\n     */\n    Editor.prototype.handleBackKey = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.onBackSpace();\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Handles delete\n     * @private\n     */\n    Editor.prototype.handleDelete = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.onDelete();\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Handles enter key.\n     * @private\n     */\n    Editor.prototype.handleEnterKey = function () {\n        if (!this.owner.isReadOnlyMode) {\n            if (Browser.isDevice) {\n                this.viewer.isCompositionStart = false;\n            }\n            this.owner.editorModule.onEnter();\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.handleTextInput = function (text) {\n        var _this = this;\n        if (!this.owner.isReadOnlyMode) {\n            if (this.animationTimer) {\n                clearTimeout(this.animationTimer);\n            }\n            classList(this.selection.caret, [], ['e-de-cursor-animation']);\n            this.owner.editorModule.insertText(text, false);\n            /* tslint:disable:align */\n            this.animationTimer = setTimeout(function () {\n                if (_this.animationTimer) {\n                    clearTimeout(_this.animationTimer);\n                }\n                if (_this.selection && _this.selection.caret) {\n                    classList(_this.selection.caret, ['e-de-cursor-animation'], []);\n                }\n            }, 600);\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Copies to format.\n     * @param  {WCharacterFormat} format\n     * @private\n     */\n    Editor.prototype.copyInsertFormat = function (format, copy) {\n        var insertFormat = new WCharacterFormat();\n        var sFormat = this.selection.characterFormat;\n        if (copy) {\n            insertFormat.copyFormat(format);\n        }\n        if (!isNullOrUndefined(sFormat.bold) && format.bold !== sFormat.bold) {\n            insertFormat.bold = sFormat.bold;\n        }\n        if (!isNullOrUndefined(sFormat.italic) && format.italic !== sFormat.italic) {\n            insertFormat.italic = sFormat.italic;\n        }\n        if (sFormat.fontSize > 0 && format.fontSize !== sFormat.fontSize) {\n            insertFormat.fontSize = sFormat.fontSize;\n        }\n        if (!isNullOrUndefined(sFormat.fontFamily) && format.fontFamily !== sFormat.fontFamily) {\n            insertFormat.fontFamily = sFormat.fontFamily;\n        }\n        if (!isNullOrUndefined(sFormat.highlightColor) && format.highlightColor !== sFormat.highlightColor) {\n            insertFormat.highlightColor = sFormat.highlightColor;\n        }\n        if (!isNullOrUndefined(sFormat.baselineAlignment) && format.baselineAlignment !== sFormat.baselineAlignment) {\n            insertFormat.baselineAlignment = sFormat.baselineAlignment;\n        }\n        if (!isNullOrUndefined(sFormat.fontColor) && format.fontColor !== sFormat.fontColor) {\n            insertFormat.fontColor = sFormat.fontColor;\n        }\n        if (!isNullOrUndefined(sFormat.underline) && format.underline !== sFormat.underline) {\n            insertFormat.underline = sFormat.underline;\n        }\n        if (!isNullOrUndefined(sFormat.strikethrough) && format.strikethrough !== sFormat.strikethrough) {\n            insertFormat.strikethrough = sFormat.strikethrough;\n        }\n        return insertFormat;\n    };\n    /**\n     * Inserts the specified text at cursor position\n     * @param  {string} text\n     * @param  {boolean} isReplace\n     * @private\n     */\n    //tslint:disable: max-func-body-length\n    Editor.prototype.insertText = function (text, isReplace) {\n        var selection = this.viewer.selection;\n        var insertPosition;\n        var isRemoved = true;\n        this.isListTextSelected();\n        this.initHistory('Insert');\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        this.viewer.selection.editPosition = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n        var bidi = selection.start.paragraph.paragraphFormat.getValue('bidi');\n        if (!bidi && this.viewer.layout.isContainsRtl(selection.start.currentWidget)) {\n            this.viewer.layout.reArrangeElementsForRtl(selection.start.currentWidget, bidi);\n        }\n        if ((!selection.isEmpty && !this.viewer.selection.isImageSelected) ||\n            this.viewer.isListTextSelected && selection.contextType === 'List') {\n            selection.isSkipLayouting = true;\n            selection.skipFormatRetrieval = true;\n            isRemoved = this.removeSelectedContents(selection);\n            selection.skipFormatRetrieval = false;\n            selection.isSkipLayouting = false;\n        }\n        else if (selection.isEmpty && !this.viewer.isListTextSelected && !isReplace) {\n            this.viewer.isTextInput = true;\n        }\n        paragraphInfo = this.getParagraphInfo(selection.start);\n        if (isRemoved) {\n            selection.owner.isShiftingEnabled = true;\n            this.updateInsertPosition();\n            insertPosition = selection.start;\n            if (insertPosition.paragraph.isEmpty()) {\n                var span = new TextElementBox();\n                var insertFormat = this.copyInsertFormat(insertPosition.paragraph.characterFormat, true);\n                span.characterFormat.copyFormat(insertFormat);\n                span.text = text;\n                var isBidi = this.viewer.textHelper.getRtlLanguage(text).isRtl;\n                span.characterFormat.bidi = isBidi;\n                span.line = insertPosition.paragraph.childWidgets[0];\n                span.margin = new Margin(0, 0, 0, 0);\n                span.line.children.push(span);\n                if ((insertPosition.paragraph.paragraphFormat.textAlignment === 'Center'\n                    || insertPosition.paragraph.paragraphFormat.textAlignment === 'Right') &&\n                    insertPosition.paragraph.paragraphFormat.listFormat.listId === -1) {\n                    insertPosition.paragraph.x = this.viewer.clientActiveArea.x;\n                }\n                this.viewer.layout.reLayoutParagraph(insertPosition.paragraph, 0, 0);\n            }\n            else {\n                var indexInInline = 0;\n                var inlineObj = insertPosition.currentWidget.getInline(insertPosition.offset, indexInInline, bidi);\n                var inline = inlineObj.element;\n                indexInInline = inlineObj.index;\n                // Todo: compare selection format\n                var insertFormat = this.copyInsertFormat(inline.characterFormat, true);\n                var isBidi = this.viewer.textHelper.getRtlLanguage(text).isRtl;\n                var insertLangId = this.viewer.textHelper.getRtlLanguage(text).id;\n                var inlineLangId = 0;\n                var isRtl = false;\n                if (inline instanceof TextElementBox) {\n                    inlineLangId = this.viewer.textHelper.getRtlLanguage(inline.text).id;\n                    isRtl = this.viewer.textHelper.getRtlLanguage(inline.text).isRtl;\n                }\n                insertFormat.bidi = isBidi;\n                if (insertFormat.isSameFormat(inline.characterFormat) && (!isBidi || (isBidi && insertLangId === inlineLangId))\n                    || (text.trim() === '' && !isBidi && inline.characterFormat.bidi)) {\n                    this.insertTextInline(inline, selection, text, indexInInline);\n                }\n                else {\n                    var tempSpan = new TextElementBox();\n                    tempSpan.text = text;\n                    tempSpan.line = inline.line;\n                    tempSpan.characterFormat.copyFormat(insertFormat);\n                    var insertIndex = inline.indexInOwner;\n                    if (indexInInline === inline.length) {\n                        inline.line.children.splice(insertIndex + 1, 0, tempSpan);\n                        if (inline.line.paragraph.bidi) {\n                            this.viewer.layout.reArrangeElementsForRtl(inline.line, inline.line.paragraph.bidi);\n                        }\n                    }\n                    else if (indexInInline === 0) {\n                        if (isRtl && !isBidi) {\n                            inline.line.children.splice(insertIndex + 1, 0, tempSpan);\n                        }\n                        else {\n                            inline.line.children.splice(insertIndex, 0, tempSpan);\n                        }\n                    }\n                    else {\n                        if (inline instanceof TextElementBox) {\n                            var splittedSpan = new TextElementBox();\n                            splittedSpan.line = inline.line;\n                            splittedSpan.characterFormat.copyFormat(inline.characterFormat);\n                            if (bidi && isRtl && !isBidi) {\n                                splittedSpan.text = inline.text.slice(0, indexInInline);\n                                inline.text = inline.text.substring(indexInInline);\n                            }\n                            else {\n                                splittedSpan.text = inline.text.substring(indexInInline);\n                                inline.text = inline.text.slice(0, indexInInline);\n                            }\n                            inline.line.children.splice(insertIndex + 1, 0, splittedSpan);\n                        }\n                        inline.line.children.splice(insertIndex + 1, 0, tempSpan);\n                    }\n                    this.viewer.layout.reLayoutParagraph(insertPosition.paragraph, inline.line.indexInOwner, 0);\n                }\n            }\n            this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + text.length, true);\n            this.updateEndPosition();\n            if (!isNullOrUndefined(this.editorHistory) && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)\n                && (this.editorHistory.currentHistoryInfo.action === 'ListSelect') &&\n                this.viewer.isListTextSelected) {\n                this.editorHistory.updateHistory();\n                this.editorHistory.updateComplexHistory();\n            }\n            this.reLayout(selection);\n            this.viewer.isTextInput = false;\n        }\n        if (!isReplace && isRemoved && (text === ' ' || text === '\\t' || text === '\\v')) {\n            var isList = false;\n            if (!(text === '\\v')) {\n                isList = this.checkAndConvertList(selection, text === '\\t');\n            }\n            if (!isList) {\n                if (!isNullOrUndefined(selection.getHyperlinkField())) {\n                    return;\n                }\n                //Checks if the previous text is URL, then it is auto formatted to hyperlink.\n                this.checkAndConvertToHyperlink(selection, false);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertIMEText = function (text, isUpdate) {\n        if (this.viewer.lastComposedText === text && isUpdate) {\n            return;\n        }\n        // Clone selection start position\n        var paragraphInfo = this.getParagraphInfo(this.selection.start);\n        var startPosition = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n        // Insert IME text in current selection\n        this.insertText(text, false);\n        this.viewer.lastComposedText = text;\n        // update selection start\n        var start = this.selection.start;\n        this.setPositionForCurrentIndex(start, startPosition);\n        // Update selection end\n        var endPosition = new TextPosition(this.owner);\n        endPosition.setPositionForLineWidget(start.currentWidget, start.offset + text.length);\n        this.selection.selectPosition(isUpdate ? start : endPosition, endPosition);\n    };\n    /**\n     * Insert Section break at cursor position\n     */\n    Editor.prototype.insertSectionBreak = function () {\n        var selection = this.viewer.selection;\n        if (isNullOrUndefined(selection) || this.owner.isReadOnlyMode || selection.start.paragraph.isInHeaderFooter) {\n            return;\n        }\n        this.initHistory('SectionBreak');\n        if (!selection.isEmpty) {\n            selection.selectContent(selection.isForward ? selection.start : selection.end, true);\n        }\n        this.viewer.owner.isShiftingEnabled = true;\n        this.updateInsertPosition();\n        this.insertSection(selection, true);\n        this.updateEndPosition();\n        this.reLayout(selection, true);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertSection = function (selection, selectFirstBlock) {\n        var newSectionFormat = this.selection.start.paragraph.bodyWidget.sectionFormat.cloneFormat();\n        var lastBlock;\n        var firstBlock;\n        if (selection.start.paragraph.isInsideTable) {\n            var table = this.viewer.layout.getParentTable(selection.start.paragraph);\n            table = table.combineWidget(this.viewer);\n            var insertBefore = false;\n            if (selection.start.paragraph.associatedCell.rowIndex === 0) {\n                insertBefore = true;\n            }\n            var newParagraph = new ParagraphWidget();\n            var previousBlock = table.previousRenderedWidget;\n            if (!insertBefore) {\n                lastBlock = this.splitTable(table, selection.start.paragraph.associatedCell.ownerRow);\n                this.viewer.layout.layoutBodyWidgetCollection(lastBlock.index, lastBlock.containerWidget, lastBlock, false);\n                lastBlock = lastBlock.getSplitWidgets().pop();\n            }\n            else {\n                lastBlock = table;\n            }\n            var insertIndex = 0;\n            if ((isNullOrUndefined(previousBlock) || !previousBlock.bodyWidget.equals(lastBlock.bodyWidget)) && insertBefore) {\n                insertIndex = 0;\n                newParagraph.index = 0;\n            }\n            else {\n                insertIndex = lastBlock.indexInOwner + 1;\n                newParagraph.index = lastBlock.index + 1;\n            }\n            lastBlock.containerWidget.childWidgets.splice(insertIndex, 0, newParagraph);\n            newParagraph.containerWidget = lastBlock.containerWidget;\n            this.updateNextBlocksIndex(newParagraph, true);\n            this.viewer.layout.layoutBodyWidgetCollection(newParagraph.index, newParagraph.containerWidget, newParagraph, false);\n            lastBlock = newParagraph;\n        }\n        else {\n            var paragraphInfo = this.getParagraphInfo(selection.start);\n            var selectionStart = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n            //Split Paragraph\n            this.splitParagraphInternal(selection, selection.start.paragraph, selection.start.currentWidget, selection.start.offset);\n            this.setPositionForCurrentIndex(selection.start, selectionStart);\n            lastBlock = selection.start.paragraph.getSplitWidgets().pop();\n        }\n        //Split body widget\n        firstBlock = this.splitBodyWidget(lastBlock.bodyWidget, newSectionFormat, lastBlock).firstChild;\n        if (firstBlock instanceof TableWidget) {\n            firstBlock.updateRowIndex(0);\n        }\n        this.viewer.layout.layoutBodyWidgetCollection(firstBlock.index, firstBlock.containerWidget, firstBlock, false);\n        if (firstBlock instanceof TableWidget) {\n            firstBlock = selection.getFirstParagraphInFirstCell(firstBlock);\n        }\n        if (selectFirstBlock) {\n            selection.selectParagraph(firstBlock, true);\n        }\n        return firstBlock;\n    };\n    Editor.prototype.splitBodyWidget = function (bodyWidget, sectionFormat, startBlock) {\n        var sectionIndex;\n        //Move blocks after the start block to next body widget\n        var newBodyWidget = this.viewer.layout.moveBlocksToNextPage(startBlock);\n        //Update SectionIndex for splitted body widget\n        this.updateSectionIndex(sectionFormat, newBodyWidget, true);\n        // insert New header footer widget in to section index \n        this.insertRemoveHeaderFooter(newBodyWidget.sectionIndex, true);\n        //update header and footer for splitted widget\n        this.viewer.layout.layoutHeaderFooter(newBodyWidget, this.viewer, newBodyWidget.page);\n        //Update Child item index from 0 for new Section\n        this.updateBlockIndex(0, newBodyWidget.firstChild);\n        // Start sinfting from first block\n        this.viewer.updateClientArea(newBodyWidget.sectionFormat, newBodyWidget.page);\n        return newBodyWidget;\n    };\n    Editor.prototype.insertRemoveHeaderFooter = function (sectionIndex, insert) {\n        if (this.viewer.headersFooters[sectionIndex]) {\n            // Need to handle further\n        }\n        else {\n            this.viewer.headersFooters[sectionIndex] = {};\n        }\n    };\n    Editor.prototype.updateBlockIndex = function (blockIndex, block) {\n        var blocks;\n        var sectionIndex = block.bodyWidget.sectionIndex;\n        do {\n            blocks = block.getSplitWidgets();\n            for (var i = 0; i < blocks.length; i++) {\n                blocks[i].index = blockIndex;\n            }\n            blockIndex++;\n            block = blocks.pop().nextRenderedWidget;\n        } while (!isNullOrUndefined(block) && block.bodyWidget.sectionIndex === sectionIndex);\n    };\n    Editor.prototype.updateSectionIndex = function (sectionFormat, startBodyWidget, increaseIndex) {\n        var currentSectionIndex = startBodyWidget.sectionIndex;\n        var blockIndex = 0;\n        var bodyWidget = startBodyWidget;\n        do {\n            if (bodyWidget.index === currentSectionIndex && sectionFormat) {\n                bodyWidget.sectionFormat = sectionFormat;\n            }\n            if (increaseIndex) {\n                bodyWidget.index++;\n            }\n            else {\n                bodyWidget.index--;\n            }\n            bodyWidget = bodyWidget.nextRenderedWidget;\n        } while (bodyWidget);\n    };\n    //Auto convert List\n    Editor.prototype.checkAndConvertList = function (selection, isTab) {\n        var list = selection.paragraphFormat.getList();\n        if (!isNullOrUndefined(list)) {\n            return false;\n        }\n        var convertList = false;\n        var isLeadingZero = false;\n        var indexInInline = 0;\n        var inlineObj = selection.start.currentWidget.getInline(selection.start.offset - 1, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!(inline instanceof TextElementBox)) {\n            return false;\n        }\n        var span = inline;\n        var text = span.text.substring(0, indexInInline);\n        var tabValue = 0;\n        var length = 0;\n        while (!isNullOrUndefined(span.previousNode)) {\n            // tslint:disable-next-line:max-line-length\n            if (span.previousNode instanceof TextElementBox && (span.previousNode.text === '\\t' || span.previousNode.text.trim().length === 0)) {\n                (span.previousNode.text === '\\t') ? tabValue += 36 : length = span.previousNode.text.length * 2.5;\n                span = span.previousNode;\n                continue;\n            }\n            return false;\n        }\n        span = inline;\n        var index = 0;\n        var tabIndex = text.lastIndexOf('\\t');\n        index = (tabIndex >= 0) ? tabIndex + 1 : text.lastIndexOf(' ') + 1;\n        while (span.previousNode instanceof TextElementBox && index === 0) {\n            span = span.previousNode;\n            var previousText = span.text;\n            tabIndex = previousText.lastIndexOf('\\t');\n            index = (tabIndex >= 0) ? tabIndex + 1 : previousText.lastIndexOf(' ') + 1;\n            text = span.text + text;\n            text = text.substring(index);\n        }\n        text = HelperMethods.trimStart(text);\n        var numberFormat = text.substring(1, 2);\n        var listLevelPattern = this.getListLevelPattern(text.substring(0, 1));\n        if (listLevelPattern !== 'None' && this.checkNumberFormat(numberFormat, listLevelPattern === 'Bullet', text)) {\n            convertList = true;\n        }\n        else if (this.checkLeadingZero(text)) {\n            isLeadingZero = true;\n            convertList = true;\n        }\n        if (convertList) {\n            this.initComplexHistory('AutoList');\n            var paragraph = inline.paragraph;\n            // tslint:disable-next-line:max-line-length\n            selection.start.setPositionParagraph(paragraph.childWidgets[0], paragraph.childWidgets[0].getOffset(inline, indexInInline + 1));\n            selection.end.setPositionParagraph(paragraph.childWidgets[0], 0);\n            this.initHistory('Delete');\n            this.deleteSelectedContents(selection, false);\n            this.reLayout(selection, false);\n            var followCharacter = isTab ? 'Tab' : 'Space';\n            numberFormat = !isLeadingZero ? '%1' + numberFormat : '%1' + text.substring(text.length - 1, text.length);\n            var leadingZeroText = text.substring(text.length - 3, text.length - 1);\n            listLevelPattern = !isLeadingZero ? listLevelPattern : this.getListLevelPattern(leadingZeroText);\n            var listLevel = new WListLevel(undefined);\n            listLevel.listLevelPattern = listLevelPattern;\n            if (listLevelPattern === 'Bullet') {\n                if (text === '*') {\n                    listLevel.numberFormat = '\\uf0b7';\n                    listLevel.characterFormat.fontFamily = 'Symbol';\n                }\n                else if (text === '-') {\n                    listLevel.numberFormat = '-';\n                }\n            }\n            else {\n                listLevel.numberFormat = numberFormat;\n            }\n            listLevel.followCharacter = followCharacter;\n            var leftIndent = selection.paragraphFormat.leftIndent;\n            if (tabValue !== 0 || length !== 0) {\n                listLevel.paragraphFormat.leftIndent = leftIndent + 18 + tabValue + length;\n            }\n            else if (indexInInline > 2) {\n                listLevel.paragraphFormat.leftIndent = leftIndent + (indexInInline - 2) * 2.5 + 18;\n            }\n            else if (leftIndent > 0) {\n                listLevel.paragraphFormat.leftIndent = leftIndent + 18;\n            }\n            else {\n                listLevel.paragraphFormat.leftIndent = 36;\n            }\n            listLevel.paragraphFormat.firstLineIndent = -18;\n            if ((!isLeadingZero && text.substring(0, 1) === '0') || leadingZeroText === '00') {\n                listLevel.startAt = 0;\n            }\n            else {\n                listLevel.startAt = 1;\n            }\n            this.autoConvertList(selection, listLevel);\n            if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n                this.editorHistory.updateComplexHistory();\n            }\n            else {\n                this.reLayout(selection);\n            }\n        }\n        return convertList;\n    };\n    Editor.prototype.getListLevelPattern = function (value) {\n        switch (value) {\n            case '0':\n            case '1':\n                return 'Arabic';\n            case 'I':\n                return 'UpRoman';\n            case 'i':\n                return 'LowRoman';\n            case 'A':\n                return 'UpLetter';\n            case 'a':\n                return 'LowLetter';\n            case '*':\n            case '-':\n                return 'Bullet';\n            case '00':\n            case '01':\n                return 'LeadingZero';\n            default:\n                return 'None';\n        }\n    };\n    Editor.prototype.autoConvertList = function (selection, listLevel) {\n        var start = selection.start;\n        if (!selection.isForward) {\n            start = selection.end;\n        }\n        var newList = new WList();\n        if (this.viewer.lists.length > 0) {\n            newList.listId = this.viewer.lists[this.viewer.lists.length - 1].listId + 1;\n        }\n        else {\n            newList.listId = 0;\n        }\n        var newAbstractList = new WAbstractList();\n        var layout = this.viewer;\n        if (layout.abstractLists.length > 0) {\n            newAbstractList.abstractListId = layout.abstractLists[layout.abstractLists.length - 1].abstractListId + 1;\n        }\n        else {\n            newAbstractList.abstractListId = 0;\n        }\n        newList.abstractListId = newAbstractList.abstractListId;\n        newList.abstractList = newAbstractList;\n        layout.abstractLists.push(newAbstractList);\n        newAbstractList.levels.push(listLevel);\n        listLevel.ownerBase = newAbstractList;\n        selection.paragraphFormat.setList(newList);\n        selection.paragraphFormat.listLevelNumber = 0;\n    };\n    Editor.prototype.checkNumberFormat = function (numberFormat, isBullet, text) {\n        if (isBullet) {\n            return numberFormat === '';\n        }\n        else {\n            var index = text.indexOf(numberFormat);\n            return (numberFormat === '.' || numberFormat === ')'\n                || numberFormat === '>' || numberFormat === '-') && text.substring(index, text.length - 1) === '';\n        }\n    };\n    Editor.prototype.checkLeadingZero = function (text) {\n        var j;\n        var isZero = false;\n        for (var i = 0; i <= text.length - 1; i++) {\n            if (text.charAt(i) === '0') {\n                isZero = true;\n                continue;\n            }\n            j = i;\n            break;\n        }\n        var numberFormat = undefined;\n        if (text.charAt(j) === '1') {\n            numberFormat = text.charAt(j + 1);\n        }\n        else {\n            numberFormat = text.charAt(j);\n        }\n        return isZero && this.checkNumberFormat(numberFormat, false, text);\n    };\n    Editor.prototype.getPageFromBlockWidget = function (block) {\n        var page = undefined;\n        if (block.containerWidget instanceof BodyWidget) {\n            page = block.containerWidget.page;\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget) {\n            page = block.containerWidget.page;\n        }\n        else if (block.containerWidget instanceof TableCellWidget) {\n            page = block.containerWidget.bodyWidget.page;\n        }\n        return page;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertTextInline = function (element, selection, text, index) {\n        if (element instanceof TextElementBox) {\n            element.text = HelperMethods.insert(element.text, index, text);\n            var paragraph = element.line.paragraph;\n            var lineIndex = paragraph.childWidgets.indexOf(element.line);\n            var elementIndex = element.line.children.indexOf(element);\n            if (element.line.paragraph.bidi) {\n                this.viewer.layout.reArrangeElementsForRtl(element.line, element.line.paragraph.bidi);\n            }\n            this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex, element.line.paragraph.bidi);\n        }\n        else if (element instanceof ImageElementBox) {\n            this.insertImageText(element, selection, text, index);\n        }\n        else if (element instanceof FieldElementBox) {\n            if (element.fieldType === 0) {\n                this.insertFieldBeginText(element, selection, text, index);\n            }\n            else if (element.fieldType === 2) {\n                this.insertFieldSeparatorText(element, selection, text, index);\n            }\n            else {\n                this.insertFieldEndText(element, selection, text, index);\n            }\n        }\n        else if (element instanceof BookmarkElementBox) {\n            this.insertBookMarkText(element, selection, text, index);\n        }\n    };\n    Editor.prototype.insertFieldBeginText = function (fieldBegin, selection, text, index) {\n        var spanObj = new TextElementBox();\n        spanObj.text = text;\n        var lineIndex = fieldBegin.line.paragraph.childWidgets.indexOf(fieldBegin.line);\n        var spanIndex = fieldBegin.line.children.indexOf(fieldBegin);\n        spanObj.characterFormat.copyFormat(fieldBegin.characterFormat);\n        fieldBegin.line.children.splice(spanIndex, 0, spanObj);\n        spanObj.line = fieldBegin.line;\n        this.viewer.layout.reLayoutParagraph(fieldBegin.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertBookMarkText = function (element, selection, text, index) {\n        var spanObj = new TextElementBox();\n        spanObj.text = text;\n        var lineIndex = element.line.paragraph.childWidgets.indexOf(element.line);\n        var spanIndex = element.line.children.indexOf(element);\n        spanObj.characterFormat.copyFormat(element.characterFormat);\n        element.line.children.splice(spanIndex, 0, spanObj);\n        spanObj.line = element.line;\n        this.viewer.layout.reLayoutParagraph(element.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertFieldSeparatorText = function (fieldSeparator, selection, text, index) {\n        var previousInline = selection.getPreviousTextInline(fieldSeparator);\n        var nextInline = selection.getNextTextInline(fieldSeparator);\n        var span = new TextElementBox();\n        span.text = text;\n        var spanIndex = fieldSeparator.line.children.indexOf(fieldSeparator);\n        if (index === fieldSeparator.length) {\n            spanIndex++;\n        }\n        if (isNullOrUndefined(previousInline) && isNullOrUndefined(nextInline)) {\n            span.characterFormat.copyFormat(fieldSeparator.line.paragraph.characterFormat);\n        }\n        else if (isNullOrUndefined(previousInline)) {\n            span.characterFormat.copyFormat(nextInline.characterFormat);\n        }\n        else {\n            span.characterFormat.copyFormat(previousInline.characterFormat);\n        }\n        fieldSeparator.line.children.splice(spanIndex, 0, span);\n        span.line = fieldSeparator.line;\n        var lineIndex = fieldSeparator.line.paragraph.childWidgets.indexOf(fieldSeparator.line);\n        this.viewer.layout.reLayoutParagraph(fieldSeparator.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertFieldEndText = function (fieldEnd, selection, text, index) {\n        var span = new TextElementBox();\n        span.text = text;\n        var spanIndex = fieldEnd.line.children.indexOf(fieldEnd);\n        span.characterFormat.copyFormat(fieldEnd.characterFormat);\n        fieldEnd.line.children.splice(spanIndex + 1, 0, span);\n        span.line = fieldEnd.line;\n        var lineIndex = fieldEnd.line.paragraph.childWidgets.indexOf(fieldEnd.line);\n        this.viewer.layout.reLayoutParagraph(fieldEnd.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertImageText = function (image, selection, text, index) {\n        var previousInlineObj = selection.getPreviousTextInline(image);\n        var nextInlineObj = selection.getNextTextInline(image);\n        var line = image.line;\n        var element = new TextElementBox();\n        var paragraph = line.paragraph;\n        var lineIndex = paragraph.childWidgets.indexOf(line);\n        element.text = text;\n        var spanIndex = line.children.indexOf(image);\n        if (index === image.length) {\n            spanIndex++;\n        }\n        if (isNullOrUndefined(previousInlineObj) && isNullOrUndefined(nextInlineObj)) {\n            element.characterFormat.copyFormat(paragraph.characterFormat);\n        }\n        else if (isNullOrUndefined(previousInlineObj)) {\n            element.characterFormat.copyFormat(nextInlineObj.characterFormat);\n        }\n        else {\n            element.characterFormat.copyFormat(previousInlineObj.characterFormat);\n        }\n        line.children.splice(spanIndex, 0, element);\n        element.line = line;\n        this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, spanIndex);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.isListTextSelected = function () {\n        if (this.viewer.isListTextSelected) {\n            this.initComplexHistory('ListSelect');\n            // tslint:disable-next-line:max-line-length\n            if (this.viewer.selection.start.paragraph.paragraphFormat.listFormat && this.viewer.selection.start.paragraph.paragraphFormat.listFormat.listId !== -1) {\n                this.onApplyList(undefined);\n            }\n        }\n    };\n    //Auto Format and insert Hyperlink Implementation starts\n    Editor.prototype.checkAndConvertToHyperlink = function (selection, isEnter, paragraph) {\n        var text;\n        var span;\n        if (isEnter) {\n            span = paragraph.lastChild.children[paragraph.lastChild.children.length - 1];\n            text = span.text;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = selection.start.currentWidget.getInline(selection.start.offset - 1, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!(inline instanceof TextElementBox)) {\n                return;\n            }\n            span = inline;\n            text = span.text.substring(0, indexInInline);\n        }\n        var index = 0;\n        var tabCharIndex = text.lastIndexOf('\\t');\n        index = (tabCharIndex >= 0) ? tabCharIndex + 1 : text.lastIndexOf(' ') + 1;\n        while (span.previousNode instanceof TextElementBox && index === 0) {\n            span = span.previousNode;\n            var previousText = span.text;\n            tabCharIndex = previousText.lastIndexOf('\\t');\n            index = (tabCharIndex >= 0) ? tabCharIndex + 1 : previousText.lastIndexOf(' ') + 1;\n            text = span.text + text;\n        }\n        text = text.substring(index);\n        var lowerCaseText = text.toLowerCase();\n        var containsURL = false;\n        if (lowerCaseText.substring(0, 8) === 'file:///'\n            || (lowerCaseText.substring(0, 7) === 'http://' && lowerCaseText.length > 7)\n            || (lowerCaseText.substring(0, 8) === 'https://' && lowerCaseText.length > 8)\n            || (lowerCaseText.substring(0, 4) === 'www.' && lowerCaseText.length > 4)\n            || (lowerCaseText.substring(0, 3) === '\\\\' && lowerCaseText.length > 3)\n            || (lowerCaseText.substring(0, 7) === 'mailto:' && lowerCaseText.length > 7)) {\n            containsURL = true;\n            if (lowerCaseText.substring(0, 4) === 'www.' && lowerCaseText.length > 4) {\n                text = 'http://' + text;\n            }\n        }\n        else {\n            var atIndex = text.indexOf('@');\n            var dotIndex = text.indexOf('.');\n            if (atIndex > 0 && atIndex < dotIndex && dotIndex < text.length - 1) {\n                containsURL = true;\n                text = 'mailto:' + text;\n            }\n        }\n        if (containsURL) {\n            var startPos = new TextPosition(this.viewer.owner);\n            startPos.setPositionParagraph(span.line, span.line.getOffset(span, index));\n            var endPos = new TextPosition(this.viewer.owner);\n            if (isEnter) {\n                endPos.setPositionParagraph(span.line, span.line.getEndOffset());\n            }\n            else {\n                if (selection.end.currentWidget.children.length === 0 && selection.end.offset === 0) {\n                    var prevLine = selection.end.currentWidget.previousLine;\n                    endPos.setPositionParagraph(prevLine, prevLine.getEndOffset());\n                }\n                else {\n                    endPos.setPositionParagraph(selection.end.currentWidget, selection.end.offset - 1);\n                }\n            }\n            this.autoFormatHyperlink(selection, text, startPos, endPos);\n        }\n    };\n    Editor.prototype.autoFormatHyperlink = function (selection, url, startPosition, endPosition) {\n        this.initComplexHistory('AutoFormatHyperlink');\n        var blockInfo = this.getParagraphInfo(startPosition);\n        var start = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n            this.editorHistory.currentHistoryInfo.insertPosition = start;\n        }\n        // Moves the selection to URL text start and end position.\n        selection.start.setPositionInternal(startPosition);\n        selection.end.setPositionInternal(endPosition);\n        // Preserves the character format for hyperlink field.\n        var temp = this.getCharacterFormat(selection);\n        var format = new WCharacterFormat();\n        format.copyFormat(temp);\n        var fieldEnd = this.createHyperlinkElement(url, startPosition, endPosition, format);\n        // Moves the selection to the end of field end position.\n        selection.start.setPositionParagraph(fieldEnd.line, (fieldEnd.line).getOffset(fieldEnd, 1));\n        // Moves to next text position. (To achieve common behavior for space and enter).\n        selection.start.moveNextPosition();\n        selection.end.setPositionInternal(selection.start);\n        blockInfo = this.getParagraphInfo(selection.end);\n        var end = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n            this.editorHistory.currentHistoryInfo.endPosition = end;\n            this.editorHistory.updateComplexHistory();\n            this.reLayout(selection);\n        }\n        else {\n            this.updateComplexWithoutHistory(0, start, end);\n        }\n    };\n    Editor.prototype.appylingHyperlinkFormat = function (selection) {\n        this.initHistory('Underline');\n        this.updateCharacterFormatWithUpdate(selection, 'underline', 'Single', false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.reLayout(selection, false);\n        // Applies font color for field result.\n        this.initHistory('FontColor');\n        this.updateCharacterFormatWithUpdate(selection, 'fontColor', '#0563c1', false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.reLayout(selection, false);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.createHyperlinkElement = function (url, startPosition, endPosition, format) {\n        var selection = this.selection;\n        this.viewer.layout.allowLayout = false;\n        this.appylingHyperlinkFormat(selection);\n        this.viewer.layout.allowLayout = true;\n        // Adds the field end at the URL text end position.\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.characterFormat.copyFormat(format);\n        fieldEnd.line = selection.end.currentWidget;\n        selection.start.setPositionInternal(selection.end);\n        // this.insertElementInCurrentLine(selection, fieldEnd, true);\n        this.initInsertInline(fieldEnd);\n        // Moves the selection to URL text start position.        \n        selection.start.setPositionInternal(startPosition);\n        selection.end.setPositionInternal(selection.start);\n        // Adds field begin, field code and field separator at the URL text start position.\n        var begin = this.insertHyperlinkfield(selection, format, url);\n        var lineIndex = selection.start.paragraph.childWidgets.indexOf(begin.line);\n        var index = begin.line.children.indexOf(begin);\n        fieldEnd.linkFieldCharacter(this.viewer);\n        this.viewer.layout.reLayoutParagraph(selection.start.paragraph, lineIndex, index);\n        return fieldEnd;\n    };\n    Editor.prototype.insertHyperlinkfield = function (selection, format, url, isBookmark) {\n        // Adds field begin, field code and field separator at the URL text start position.\n        var begin = new FieldElementBox(0);\n        begin.characterFormat.copyFormat(format);\n        begin.line = selection.start.currentWidget;\n        this.initInsertInline(begin);\n        var span = new TextElementBox();\n        span.characterFormat.copyFormat(format);\n        if (isBookmark) {\n            span.text = ' HYPERLINK \\\\l \\\"' + url + '\\\" ';\n        }\n        else {\n            span.text = ' HYPERLINK \\\"' + url + '\\\" ';\n        }\n        span.line = selection.start.currentWidget;\n        this.initInsertInline(span);\n        var separator = new FieldElementBox(2);\n        separator.characterFormat.copyFormat(format);\n        separator.line = selection.start.currentWidget;\n        this.initInsertInline(separator);\n        return begin;\n    };\n    Editor.prototype.unLinkFieldCharacter = function (inline) {\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            if (inline.fieldEnd) {\n                if (this.viewer) {\n                    this.viewer.fieldToLayout = inline;\n                    this.viewer.fieldEndParagraph = inline.line.paragraph;\n                }\n                // inline.line.paragraph.addFieldCharacter(inline.fieldEnd);\n                inline.fieldEnd = undefined;\n            }\n        }\n        if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            if (!isNullOrUndefined(inline.fieldEnd)) {\n                if (this.viewer) {\n                    this.viewer.fieldToLayout = inline.fieldBegin;\n                    this.viewer.fieldEndParagraph = inline.line.paragraph;\n                }\n                inline.fieldBegin.fieldSeparator = undefined;\n                inline.fieldEnd.fieldSeparator = undefined;\n            }\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            if (inline.fieldBegin) {\n                if (!isNullOrUndefined(this.viewer)) {\n                    this.viewer.fieldToLayout = inline.fieldBegin;\n                    this.viewer.fieldEndParagraph = inline.line.paragraph;\n                }\n                var fieldIndex = this.viewer.fields.indexOf(inline.fieldBegin);\n                if (fieldIndex !== -1) {\n                    this.viewer.fields.splice(fieldIndex, 1);\n                }\n                inline.fieldBegin = undefined;\n            }\n        }\n    };\n    Editor.prototype.getCharacterFormat = function (selection) {\n        if (selection.start.paragraph.isEmpty()) {\n            return selection.start.paragraph.characterFormat;\n        }\n        else {\n            var info = selection.start.currentWidget.getInline(selection.start.offset, 0);\n            return info.element.characterFormat;\n        }\n    };\n    /**\n     * Insert Hyperlink\n     * @param  {string} url\n     * @param  {string} displayText\n     * @param  {boolean} remove\n     * @private\n     */\n    Editor.prototype.insertHyperlink = function (url, displayText, remove, isBookmark) {\n        var selection = this.viewer.selection;\n        if (selection.start.paragraph.associatedCell !== selection.end.paragraph.associatedCell) {\n            return;\n        }\n        if (remove) {\n            //Empty selection Hyperlink insert\n            this.insertHyperlinkInternal(selection, url, displayText, isBookmark);\n        }\n        else {\n            //Non-Empty Selection- change the selected text to Field       \n            // this.preservedFontCol = this.getFontColor();\n            var startPosition = selection.start;\n            var endPosition = selection.end;\n            if (!selection.isForward) {\n                startPosition = selection.end;\n                endPosition = selection.start;\n            }\n            var fieldStartPosition = new TextPosition(this.viewer.owner);\n            fieldStartPosition.setPositionInternal(startPosition);\n            var temp = this.getCharacterFormat(selection);\n            var format = new WCharacterFormat(undefined);\n            format.copyFormat(temp);\n            this.initComplexHistory('InsertHyperlink');\n            var blockInfo = this.getParagraphInfo(startPosition);\n            var start = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n                // tslint:disable-next-line:max-line-length\n                this.editorHistory.currentHistoryInfo.insertPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            }\n            this.appylingHyperlinkFormat(selection);\n            this.viewer.layout.allowLayout = true;\n            startPosition.setPositionInternal(endPosition);\n            // Adds the field end at the URL text end position.\n            var fieldEnd = new FieldElementBox(1);\n            fieldEnd.characterFormat.copyFormat(format);\n            fieldEnd.line = selection.end.currentWidget;\n            startPosition.setPositionInternal(endPosition);\n            // this.insertElementInCurrentLine(selection, fieldEnd, true);\n            this.initInsertInline(fieldEnd);\n            // Moves the selection to URL text start position.        \n            startPosition.setPositionInternal(fieldStartPosition);\n            endPosition.setPositionInternal(startPosition);\n            // Adds field begin, field code and field separator at the URL text start position.\n            var begin = this.insertHyperlinkfield(selection, format, url, isBookmark);\n            fieldEnd.linkFieldCharacter(this.viewer);\n            var lineIndex = selection.start.paragraph.childWidgets.indexOf(begin.line);\n            var index = begin.line.children.indexOf(begin);\n            this.viewer.layout.reLayoutParagraph(selection.start.paragraph, lineIndex, index);\n            var lineWidget = fieldEnd.line;\n            selection.selects(lineWidget, lineWidget.getOffset(fieldEnd, fieldEnd.length), true);\n            blockInfo = this.getParagraphInfo(endPosition);\n            var end = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n                // tslint:disable-next-line:max-line-length\n                this.editorHistory.currentHistoryInfo.endPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n                this.editorHistory.updateComplexHistory();\n            }\n            else {\n                this.updateComplexWithoutHistory(1, start, end);\n            }\n        }\n    };\n    Editor.prototype.insertHyperlinkInternal = function (selection, url, displayText, isBookmark) {\n        if (isNullOrUndefined(selection.start)) {\n            return;\n        }\n        if (this.editHyperlink(selection, url, displayText)) {\n            return;\n        }\n        this.initHistory('InsertHyperlink');\n        var isRemoved = true;\n        if (!selection.isEmpty) {\n            isRemoved = this.removeSelectedContents(selection);\n        }\n        if (isRemoved) {\n            // Preserves the character format for hyperlink field.\n            var temp = this.getCharacterFormat(selection);\n            var format = new WCharacterFormat();\n            format.copyFormat(temp);\n            this.insertHyperlinkByFormat(selection, url, displayText, format, isBookmark);\n        }\n        //else\n        //    this.Select(Start, true);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.insertHyperlinkByFormat = function (selection, url, displayText, format, isBookmark) {\n        this.updateInsertPosition();\n        selection.owner.isShiftingEnabled = true;\n        var indexInInline = 0;\n        var initial = indexInInline;\n        var element = [];\n        var fieldBegin = new FieldElementBox(0);\n        element.push(fieldBegin);\n        var span = new TextElementBox();\n        if (isBookmark) {\n            span.text = ' HYPERLINK \\\\l \\\"' + url + '\\\" ';\n        }\n        else {\n            span.text = ' HYPERLINK \\\"' + url + '\\\" ';\n        }\n        element.push(span);\n        var fieldSeparator = new FieldElementBox(2);\n        element.push(fieldSeparator);\n        if (!isNullOrUndefined(displayText) && displayText !== '') {\n            span = new TextElementBox();\n            span.characterFormat.underline = 'Single';\n            span.characterFormat.fontColor = '#0563c1';\n            span.text = displayText;\n            element.push(span);\n        }\n        var fieldEnd = new FieldElementBox(1);\n        element.push(fieldEnd);\n        this.insertElement(element);\n        var paragraph = selection.start.paragraph;\n        fieldEnd.linkFieldCharacter(this.viewer);\n        if (this.viewer.fields.indexOf(fieldBegin) === -1) {\n            this.viewer.fields.push(fieldBegin);\n        }\n        var offset = fieldEnd.line.getOffset(fieldEnd, 1);\n        selection.selects(fieldEnd.line, fieldEnd.line.getOffset(fieldEnd, fieldEnd.length), true);\n        this.updateEndPosition();\n        this.reLayout(selection, true);\n    };\n    Editor.prototype.initInsertInline = function (element, insertHyperlink) {\n        this.initHistory('InsertInline');\n        this.insertInlineInSelection(this.viewer.selection, element);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertElementInCurrentLine = function (selection, inline, isReLayout) {\n        if (this.checkIsNotRedoing()) {\n            selection.owner.isShiftingEnabled = true;\n        }\n        if (!selection.isEmpty) {\n            this.removeSelectedContents(selection);\n        }\n        this.updateInsertPosition();\n        this.insertElement([inline]);\n        if (this.checkEndPosition(selection)) {\n            this.updateHistoryPosition(selection.start, false);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * Edit Hyperlink\n     * @param  {Selection} selection\n     * @param  {string} url\n     * @param  {string} displayText\n     * @private\n     */\n    Editor.prototype.editHyperlink = function (selection, url, displayText, isBookmark) {\n        var fieldBegin = selection.getHyperlinkField();\n        if (isNullOrUndefined(fieldBegin)) {\n            return false;\n        }\n        this.initHistory('InsertHyperlink');\n        this.editHyperlinkInternal = isNullOrUndefined(this.editorHistory)\n            || (this.editorHistory && isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo));\n        var fieldResult = '';\n        var isNestedField = false;\n        // Preserves the character format for hyperlink field.\n        var temp = this.getCharacterFormat(selection);\n        var format = new WCharacterFormat();\n        format.copyFormat(temp);\n        var fieldSeparator = undefined;\n        if (!isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            fieldSeparator = fieldBegin.fieldSeparator;\n            // tslint:disable-next-line:max-line-length\n            var fieldObj = selection.getHyperlinkDisplayText(fieldBegin.fieldSeparator.line.paragraph, fieldBegin.fieldSeparator, fieldBegin.fieldEnd, isNestedField, format);\n            fieldResult = fieldObj.displayText;\n            isNestedField = fieldObj.isNestedField;\n            format = fieldObj.format;\n        }\n        var offset = fieldBegin.line.getOffset(fieldBegin, 0);\n        selection.start.setPositionParagraph(fieldBegin.line, offset);\n        offset = fieldBegin.fieldEnd.line.getOffset(fieldBegin.fieldEnd, 1);\n        selection.end.setPositionParagraph(fieldBegin.fieldEnd.line, offset);\n        this.deleteSelectedContents(selection, false);\n        if (!isNestedField && fieldResult !== displayText || isNullOrUndefined(fieldSeparator)) {\n            this.insertHyperlinkByFormat(selection, url, displayText, format, isBookmark);\n        }\n        else {\n            //Modify the new hyperlink url. Inserts field begin, url and field separator.\n            this.updateInsertPosition();\n            var newFieldBegin = new FieldElementBox(0);\n            newFieldBegin.characterFormat.copyFormat(fieldBegin.characterFormat);\n            newFieldBegin.line = selection.start.currentWidget;\n            this.insertInlineInternal(newFieldBegin);\n            var span = new TextElementBox();\n            span.characterFormat.copyFormat(fieldBegin.characterFormat);\n            if (isBookmark) {\n                span.text = ' HYPERLINK \\\\l \\\"' + url + '\\\" ';\n            }\n            else {\n                span.text = ' HYPERLINK \\\"' + url + '\\\" ';\n            }\n            span.line = selection.start.currentWidget;\n            this.insertInlineInternal(span);\n            var nodes = this.editorHistory && this.editorHistory.currentBaseHistoryInfo ?\n                this.editorHistory.currentBaseHistoryInfo.removedNodes : this.nodes;\n            this.insertClonedFieldResult(selection, nodes, fieldSeparator);\n            var fieldEnd = selection.end.currentWidget.getInline(selection.end.offset, 0).element;\n            fieldEnd.linkFieldCharacter(this.viewer);\n            var paragraph = newFieldBegin.line.paragraph;\n            var lineIndex = newFieldBegin.line.paragraph.childWidgets.indexOf(newFieldBegin.line);\n            var elementIndex = newFieldBegin.line.children.indexOf(newFieldBegin);\n            this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n            selection.selects(newFieldBegin.fieldEnd.line, offset, true);\n            this.updateEndPosition();\n            this.reLayout(selection, true);\n        }\n        this.editHyperlinkInternal = false;\n        this.nodes = [];\n        return true;\n    };\n    /* tslint:disable:no-any */\n    Editor.prototype.insertClonedFieldResult = function (selection, nodes, fieldSeparator) {\n        var fieldEnd;\n        var isStarted = false;\n        for (var i = nodes.length - 1; i > -1; i--) {\n            var node = nodes[i];\n            /* tslint:enable:no-any */\n            if (!isStarted) {\n                if (fieldSeparator === node) {\n                    isStarted = true;\n                }\n                else {\n                    if (node instanceof ParagraphWidget && node === fieldSeparator.line.paragraph) {\n                        isStarted = true;\n                        var paragraph = undefined;\n                        if (i === nodes.length - 1) {\n                            paragraph = selection.start.paragraph;\n                            var fieldParagraph = fieldSeparator.line.paragraph;\n                            this.getClonedFieldResultWithSel(fieldParagraph, selection, fieldSeparator);\n                        }\n                        else {\n                            paragraph = this.getClonedFieldResult(fieldSeparator.line.paragraph, fieldSeparator);\n                            this.insertParagraph(paragraph, true);\n                        }\n                        selection.selectParagraph(selection.getNextParagraphBlock(paragraph), true);\n                    }\n                    continue;\n                }\n            }\n            if (node instanceof ElementBox) {\n                this.insertInlineInternal(node.clone());\n            }\n            else if (node instanceof BlockWidget) {\n                this.insertBlock(node.clone());\n            }\n            // else if (node instanceof WSection)\n            //     editor.insertSection((node as WSection)._Clone());\n        }\n    };\n    Editor.prototype.getClonedFieldResultWithSel = function (paragraph, selection, fieldSeparator) {\n        var lineIndex = paragraph.childWidgets.indexOf(fieldSeparator.line);\n        var elementIndex = paragraph.childWidgets[lineIndex].children.indexOf(fieldSeparator);\n        for (var j = lineIndex; j < paragraph.childWidgets.length; j++) {\n            var lineWidget = paragraph.childWidgets[j];\n            if (j !== lineIndex) {\n                elementIndex = 0;\n            }\n            for (var i = elementIndex; i < lineWidget.children.length; i++) {\n                this.insertInlineInternal(lineWidget.children[i].clone());\n            }\n        }\n    };\n    Editor.prototype.getClonedFieldResult = function (curParagraph, fieldSeparator) {\n        var paragraph = new ParagraphWidget();\n        paragraph.characterFormat.copyFormat(curParagraph.characterFormat);\n        paragraph.paragraphFormat.copyFormat(curParagraph.paragraphFormat);\n        var lineIndex = curParagraph.childWidgets.indexOf(fieldSeparator.line);\n        var elementIndex = curParagraph.childWidgets[lineIndex].children.indexOf(fieldSeparator);\n        for (var j = lineIndex; j < curParagraph.childWidgets.length; j++) {\n            var lineWidget = curParagraph.childWidgets[j];\n            if (j !== lineIndex) {\n                elementIndex = 0;\n            }\n            for (var i = elementIndex; i < lineWidget.children.length; i++) {\n                paragraph.childWidgets[0].children.push(lineWidget.children[i]);\n            }\n        }\n        return paragraph;\n    };\n    /**\n     * Removes the hyperlink if selection is within hyperlink.\n     */\n    Editor.prototype.removeHyperlink = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var selection = this.selection;\n        var fieldBegin = selection.getHyperlinkField();\n        if (isNullOrUndefined(fieldBegin)) {\n            return;\n        }\n        var fieldEnd = fieldBegin.fieldEnd;\n        var fieldSeparator = fieldBegin.fieldSeparator;\n        var fieldStartPosition = new TextPosition(selection.owner);\n        // tslint:disable-next-line:max-line-length\n        fieldStartPosition.setPositionParagraph(fieldBegin.line, (fieldBegin.line).getOffset(fieldBegin, 0));\n        var fieldSeparatorPosition = new TextPosition(selection.owner);\n        // tslint:disable-next-line:max-line-length\n        fieldSeparatorPosition.setPositionParagraph(fieldSeparator.line, (fieldSeparator.line).getOffset(fieldSeparator, fieldSeparator.length));\n        this.initComplexHistory('RemoveHyperlink');\n        selection.start.setPositionParagraph(fieldEnd.line, (fieldEnd.line).getOffset(fieldEnd, 0));\n        selection.end.setPositionInternal(selection.start);\n        this.onDelete();\n        selection.start.setPositionInternal(fieldSeparatorPosition);\n        this.initHistory('Underline');\n        this.updateCharacterFormatWithUpdate(selection, 'underline', 'None', false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        // Applies font color for field result.\n        this.initHistory('FontColor');\n        this.updateCharacterFormatWithUpdate(selection, 'fontColor', undefined, false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.reLayout(selection, false);\n        selection.end.setPositionInternal(selection.start);\n        selection.start.setPositionInternal(fieldStartPosition);\n        this.initHistory('Delete');\n        this.deleteSelectedContents(selection, false);\n        this.reLayout(selection, true);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n            this.editorHistory.updateComplexHistory();\n        }\n    };\n    //Paste Implementation starts\n    /**\n     * Paste copied clipboard content on Paste event\n     * @param  {ClipboardEvent} event\n     * @param  {any} pasteWindow?\n     * @private\n     */\n    /* tslint:disable:no-any */\n    Editor.prototype.pasteInternal = function (event, pasteWindow) {\n        if (this.viewer.owner.enableLocalPaste) {\n            this.pasteLocal();\n        }\n        else {\n            if (isNullOrUndefined(pasteWindow)) {\n                pasteWindow = window;\n            }\n            /* tslint:enable:no-any */\n            var textContent = '';\n            var clipbordData = pasteWindow.clipboardData ? pasteWindow.clipboardData : event.clipboardData;\n            textContent = clipbordData.getData('Text');\n            if (textContent !== '') {\n                this.pasteContents(textContent);\n                this.viewer.editableDiv.innerHTML = '';\n            }\n        }\n        this.viewer.updateFocus();\n    };\n    /**\n     * Pastes the data present in local clipboard if any.\n     */\n    Editor.prototype.pasteLocal = function () {\n        /* tslint:disable:no-any */\n        if (this.copiedData && this.owner.enableLocalPaste) {\n            var document_1 = JSON.parse(this.copiedData);\n            this.pasteContents(document_1);\n        }\n    };\n    Editor.prototype.getBlocks = function (pasteContent) {\n        var widgets = [];\n        if (typeof (pasteContent) === 'string') {\n            var startParagraph = this.selection.start.paragraph;\n            if (!this.selection.isForward) {\n                startParagraph = this.selection.end.paragraph;\n            }\n            var arr = [];\n            var txt = pasteContent;\n            txt = txt.replace(/\\r\\n/g, '\\r');\n            arr = txt.split('\\r');\n            for (var i = 0; i < arr.length; i++) {\n                var insertFormat = this.copyInsertFormat(startParagraph.characterFormat, false);\n                var insertParaFormat = this.viewer.selection.copySelectionParagraphFormat();\n                var paragraph = new ParagraphWidget();\n                paragraph.paragraphFormat.copyFormat(insertParaFormat);\n                var line = new LineWidget(paragraph);\n                if (arr[i].length > 0) {\n                    var textElement = new TextElementBox();\n                    textElement.characterFormat.copyFormat(insertFormat);\n                    textElement.text = arr[i];\n                    line.children.push(textElement);\n                    textElement.line = line;\n                }\n                paragraph.childWidgets.push(line);\n                widgets.push(paragraph);\n            }\n        }\n        else {\n            for (var i = 0; i < pasteContent.sections.length; i++) {\n                this.viewer.owner.parser.parseBody(pasteContent.sections[i].blocks, widgets);\n            }\n        }\n        return widgets;\n    };\n    Editor.prototype.pasteContents = function (content) {\n        this.pasteContentsInternal(this.getBlocks(content));\n    };\n    Editor.prototype.pasteContentsInternal = function (widgets) {\n        /* tslint:enable:no-any */\n        var selection = this.viewer.selection;\n        var isRemoved = true;\n        this.initComplexHistory('Paste');\n        if (this.viewer.isListTextSelected) {\n            var paragraph = selection.start.paragraph;\n            if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1) {\n                this.onApplyList(undefined);\n            }\n        }\n        this.initHistory('Paste');\n        if (!selection.isEmpty || this.viewer.isListTextSelected) {\n            isRemoved = this.removeSelectedContentInternal(selection, selection.start, selection.end);\n        }\n        if (isRemoved) {\n            this.pasteContent(widgets);\n        }\n        else if (this.editorHistory) {\n            this.editorHistory.currentBaseHistoryInfo = undefined;\n        }\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n            this.editorHistory.updateHistory();\n            this.editorHistory.updateComplexHistory();\n        }\n        else {\n            this.reLayout(selection, selection.isEmpty);\n        }\n    };\n    /* tslint:disable:no-any */\n    Editor.prototype.pasteContent = function (widgets) {\n        /* tslint:enable:no-any */\n        this.viewer.owner.isShiftingEnabled = true;\n        this.updateInsertPosition();\n        this.viewer.owner.isLayoutEnabled = true;\n        this.viewer.owner.isPastingContent = true;\n        this.pasteCopiedData(widgets);\n        this.updateEndPosition();\n        this.viewer.owner.isPastingContent = false;\n        this.viewer.selection.fireSelectionChanged(true);\n    };\n    Editor.prototype.pasteCopiedData = function (widgets) {\n        for (var j = 0; j < widgets.length; j++) {\n            var widget = widgets[j];\n            if (widget instanceof ParagraphWidget && widget.childWidgets.length === 0) {\n                widget.childWidgets[0] = new LineWidget(widget);\n            }\n            if (j === widgets.length - 1 && widget instanceof ParagraphWidget) {\n                var newParagraph = widget;\n                if (newParagraph.childWidgets.length > 0\n                    && newParagraph.childWidgets[0].children.length > 0) {\n                    this.insertElement(newParagraph.childWidgets[0].children);\n                }\n            }\n            else if (widget instanceof BlockWidget) {\n                var startParagraph = this.selection.start.paragraph;\n                if (widget instanceof TableWidget && startParagraph.isInsideTable) {\n                    var table = widget;\n                    //Handled to resize table based on parent cell width.\n                    var clientWidth = startParagraph.getContainerWidth();\n                    table.fitCellsToClientArea(clientWidth);\n                }\n                if (widget instanceof TableWidget && startParagraph.isEmpty()\n                    && startParagraph.previousWidget instanceof TableWidget) {\n                    this.insertTableRows(widget, startParagraph.previousWidget);\n                }\n                else {\n                    this.insertBlockInternal(widget);\n                }\n            }\n        }\n    };\n    /**\n     * Insert Table on undo\n     * @param  {WTable} table\n     * @param  {WTable} newTable\n     * @param  {boolean} moveRows\n     * @private\n     */\n    Editor.prototype.insertTableInternal = function (table, newTable, moveRows) {\n        //Gets the index of current table.\n        var insertIndex = table.getIndex();\n        if (moveRows) {\n            //Moves the rows to table.\n            for (var i = 0, index = 0; i < table.childWidgets.length; i++, index++) {\n                var row = table.childWidgets[i];\n                newTable.childWidgets.splice(index, 0, row);\n                row.containerWidget = newTable;\n                table.childWidgets.splice(i, 1);\n                i--;\n            }\n        }\n        var owner = table.containerWidget;\n        this.removeBlock(table);\n        //Inserts table in the current table position.        \n        var blockAdvCollection = owner.childWidgets;\n        blockAdvCollection.splice(insertIndex, 0, newTable);\n        newTable.index = table.index;\n        table.containerWidget = undefined;\n        newTable.containerWidget = owner;\n        this.viewer.layout.clearTableWidget(newTable, true, true, true);\n        newTable.buildTableColumns();\n        newTable.isGridUpdated = true;\n        this.updateNextBlocksIndex(newTable, true);\n        this.viewer.layout.linkFieldInTable(newTable);\n        this.viewer.layout.layoutBodyWidgetCollection(newTable.index, owner, newTable, false);\n    };\n    /**\n     * Insert Table on undo\n     * @param  {Selection} selection\n     * @param  {WBlock} block\n     * @param  {WTable} table\n     * @private\n     */\n    Editor.prototype.insertBlockTable = function (selection, block, table) {\n        var offset = selection.start.offset;\n        var lineIndex = selection.start.paragraph.childWidgets.indexOf(selection.start.currentWidget);\n        if (block instanceof ParagraphWidget && offset > 0) {\n            //Moves the inline items before selection start to the inserted paragraph.\n            // tslint:disable-next-line:max-line-length\n            this.moveInlines(selection.start.paragraph, block, 0, 0, selection.start.paragraph.firstChild, offset, selection.start.currentWidget);\n            selection.selectParagraph(selection.start.paragraph, true);\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(this.getHierarchicalIndex(block, offset.toString()), true);\n            }\n        }\n        if (offset > 0 && this.checkInsertPosition(selection)) {\n            this.updateHistoryPosition(selection.start, true);\n        }\n        var index = table.indexInOwner;\n        table.containerWidget.childWidgets.splice(index, 0, block);\n        block.containerWidget = table.containerWidget;\n        block.index = table.index;\n        this.updateNextBlocksIndex(block, true);\n        this.viewer.layout.layoutBodyWidgetCollection(block.index, block.containerWidget, block, false);\n        if (this.checkInsertPosition(selection)) {\n            var paragraph = undefined;\n            if (block instanceof ParagraphWidget) {\n                paragraph = block;\n            }\n            if (block instanceof TableWidget) {\n                paragraph = selection.getFirstParagraphInFirstCell(block);\n            }\n            this.updateHistoryPosition(this.getHierarchicalIndex(paragraph, '0'), true);\n        }\n    };\n    /**\n     * On cut handle selected content remove and relayout\n     * @param  {Selection} selection\n     * @param  {TextPosition} startPosition\n     * @param  {TextPosition} endPosition\n     * @private\n     */\n    Editor.prototype.handleCut = function (selection) {\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        // this.owner.isShiftingEnabled = true;\n        var blockInfo = this.getParagraphInfo(startPosition);\n        selection.editPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        var image = undefined;\n        if (startPosition.paragraph === endPosition.paragraph && startPosition.offset + 1 === endPosition.offset) {\n            //Gets selected image and copy image to clipboard.\n            var index = 0;\n            var currentInline = startPosition.paragraph.getInline(endPosition.offset, index);\n            var inline = currentInline.element;\n            image = inline;\n        }\n        this.initHistory('Cut');\n        selection.owner.isShiftingEnabled = true;\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(selection.editPosition, true);\n            }\n        }\n        this.deleteSelectedContent(endPosition.paragraph, selection, startPosition, endPosition, 3);\n        var textPosition = new TextPosition(selection.owner);\n        this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n        selection.selectContent(textPosition, true);\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            if (this.checkEndPosition(selection)) {\n                this.updateHistoryPosition(selection.end, false);\n            }\n        }\n        this.reLayout(selection);\n    };\n    Editor.prototype.insertInlineInternal = function (element) {\n        var selection = this.selection;\n        var length = element.length;\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        if (selection.start.paragraph.isEmpty()) {\n            var paragraph = selection.start.paragraph;\n            if ((paragraph.paragraphFormat.textAlignment === 'Center' || paragraph.paragraphFormat.textAlignment === 'Right')\n                && paragraph.paragraphFormat.listFormat.listId === -1) {\n                paragraph.x = this.viewer.clientActiveArea.x;\n            }\n            paragraph.childWidgets[0].children.push(element);\n            element.line = paragraph.childWidgets[0];\n            element.linkFieldCharacter(this.viewer);\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = selection.start.currentWidget.getInline(selection.start.offset, indexInInline);\n            var curInline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            this.insertElementInternal(curInline, element, indexInInline, true);\n        }\n        this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + length, true);\n    };\n    Editor.prototype.insertElement = function (element) {\n        var selection = this.selection;\n        var length = 0;\n        var paragraph = undefined;\n        var lineIndex = -1;\n        var lineWidget = undefined;\n        var insertIndex = 0;\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        if (selection.start.paragraph.isEmpty()) {\n            paragraph = selection.start.paragraph;\n            lineWidget = paragraph.childWidgets[0];\n            lineIndex = 0;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = selection.start.currentWidget.getInline(selection.start.offset, indexInInline);\n            var curInline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            paragraph = curInline.line.paragraph;\n            lineIndex = paragraph.childWidgets.indexOf(curInline.line);\n            insertIndex = curInline.indexInOwner;\n            lineWidget = curInline.line;\n            if (indexInInline === curInline.length) { // Add new Element in current \n                insertIndex++;\n            }\n            else if (indexInInline === 0) {\n                if (isNullOrUndefined(curInline.previousNode)) {\n                    insertIndex = 0;\n                }\n            }\n            else {\n                insertIndex++;\n                var prevElement = new TextElementBox();\n                prevElement.characterFormat.copyFormat(curInline.characterFormat);\n                prevElement.text = curInline.text.substring(indexInInline);\n                curInline.text = curInline.text.substr(0, indexInInline);\n                lineWidget.children.splice(insertIndex, 0, prevElement);\n                prevElement.line = curInline.line;\n            }\n        }\n        for (var i = 0; i < element.length; i++) {\n            length += element[i].length;\n            lineWidget.children.splice(insertIndex, 0, element[i]);\n            element[i].line = lineWidget;\n            element[i].linkFieldCharacter(this.viewer);\n            insertIndex++;\n        }\n        this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, 0);\n        this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + length, true);\n    };\n    Editor.prototype.insertElementInternal = function (element, newElement, index, relayout) {\n        var line = element.line;\n        var paragraph = line.paragraph;\n        var lineIndex = line.indexInOwner;\n        var insertIndex = element.indexInOwner;\n        if (index === element.length) { // Add new Element in current \n            insertIndex++;\n            line.children.splice(insertIndex, 0, newElement);\n        }\n        else if (index === 0) {\n            if (isNullOrUndefined(element.previousNode)) {\n                element.line.children.splice(0, 0, newElement);\n                insertIndex = 0;\n            }\n            else {\n                element.line.children.splice(insertIndex, 0, newElement);\n            }\n        }\n        else {\n            insertIndex++;\n            var textElement = new TextElementBox();\n            textElement.characterFormat.copyFormat(element.characterFormat);\n            textElement.text = element.text.substring(index);\n            element.text = element.text.substr(0, index);\n            line.children.splice(insertIndex, 0, textElement);\n            textElement.line = element.line;\n            //Inserts the new inline.\n            line.children.splice(insertIndex, 0, newElement);\n            insertIndex -= 1;\n        }\n        newElement.line = element.line;\n        newElement.linkFieldCharacter(this.viewer);\n        if (relayout) {\n            this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, insertIndex);\n        }\n    };\n    /**\n     * Insert Block on undo\n     * @param  {Selection} selection\n     * @param  {WBlock} block\n     * @private\n     */\n    Editor.prototype.insertBlock = function (block) {\n        var isRemoved = true;\n        var selection = this.selection;\n        if (!selection.isEmpty) {\n            isRemoved = this.removeSelectedContents(selection);\n        }\n        if (!isRemoved) {\n            selection.selectContent(selection.start, false);\n        }\n        this.insertBlockInternal(block);\n        if (this.checkInsertPosition(selection)) {\n            var paragraph = undefined;\n            if (block instanceof ParagraphWidget) {\n                paragraph = block;\n            }\n            else {\n                paragraph = this.selection.getFirstParagraphInFirstCell(block);\n            }\n            // tslint:disable-next-line:max-line-length\n            this.updateHistoryPosition(this.getHierarchicalIndex(paragraph, '0'), true);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * Insert new Block on specific index\n     * @param  {Selection} selection\n     * @param  {BlockWidget} block\n     * @private\n     */\n    Editor.prototype.insertBlockInternal = function (block) {\n        var selection = this.selection;\n        var isRemoved = true;\n        var startPara = this.selection.start.paragraph;\n        if (!selection.start.isAtParagraphStart) {\n            if (block instanceof ParagraphWidget) {\n                this.insertNewParagraphWidget(block, false);\n                return;\n            }\n            this.updateInsertPosition();\n            startPara = startPara.combineWidget(this.viewer);\n            // tslint:disable-next-line:max-line-length\n            this.splitParagraph(startPara, startPara.firstChild, 0, selection.start.currentWidget, selection.start.offset, false);\n            selection.selectParagraph(this.selection.start.paragraph, true);\n        }\n        var bodyWidget = selection.start.paragraph.containerWidget;\n        var blockIndex = selection.start.paragraph.index;\n        var insertIndex = bodyWidget.childWidgets.indexOf(selection.start.paragraph);\n        if (!isNullOrUndefined(bodyWidget)) {\n            bodyWidget.childWidgets.splice(insertIndex, 0, block);\n            block.containerWidget = bodyWidget;\n            block.index = blockIndex;\n            block.height = 0;\n            if (block instanceof TableWidget) {\n                block.isGridUpdated = false;\n                block.buildTableColumns();\n                block.isGridUpdated = true;\n            }\n            this.updateNextBlocksIndex(block, true);\n            this.viewer.layout.layoutBodyWidgetCollection(blockIndex, bodyWidget, block, false);\n        }\n    };\n    /**\n     * Inserts the image with specified size at cursor position in the document editor.\n     * @param {string} imageString  Base64 string, web URL or file URL.\n     * @param {number} width? Image width\n     * @param {number} height? Image height\n     */\n    Editor.prototype.insertImage = function (imageString, width, height) {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        if (isNullOrUndefined(width)) {\n            width = 100;\n        }\n        if (isNullOrUndefined(height)) {\n            height = 100;\n        }\n        this.insertPicture(imageString, width, height);\n    };\n    /**\n     * Inserts a table of specified size at cursor position\n     *  in the document editor.\n     * @param {number} rows Default value of ‘rows’ parameter is 1.\n     * @param {number} columns Default value of ‘columns’ parameter is 1.\n     */\n    Editor.prototype.insertTable = function (rows, columns) {\n        var startPos = this.selection.start;\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        rows = rows || 1;\n        columns = columns || 1;\n        var table = this.createTable(rows, columns);\n        var clientWidth = startPos.paragraph.getContainerWidth();\n        table.splitWidthToTableCells(clientWidth);\n        var prevBlock = startPos.paragraph.previousWidget;\n        if (startPos.currentWidget.isFirstLine() && startPos.offset === 0 && prevBlock instanceof TableWidget) {\n            this.insertTableRows(table, prevBlock);\n            table.destroy();\n            return;\n        }\n        else {\n            this.initHistory('InsertTable');\n            this.viewer.owner.isShiftingEnabled = true;\n            this.insertBlock(table);\n        }\n        var startLine = this.selection.getFirstParagraphInFirstCell(table).childWidgets[0];\n        startPos.setPosition(startLine, true);\n        this.selection.end.setPositionInternal(startPos);\n        var lastParagraph = this.selection.getLastParagraphInLastCell(table);\n        var endOffset = lastParagraph.getLength() + 1;\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            // tslint:disable-next-line:max-line-length\n            this.editorHistory.currentBaseHistoryInfo.endPosition = this.getHierarchicalIndex(lastParagraph, endOffset.toString());\n        }\n        this.reLayout(this.selection);\n    };\n    /**\n     * Inserts the specified number of rows to the table above or below to the row at cursor position.\n     * @param {boolean} above The above parameter is optional and if omitted,\n     * it takes the value as false and inserts below the row at cursor position.\n     * @param {number} count The count parameter is optional and if omitted, it takes the value as 1.\n     */\n    Editor.prototype.insertRow = function (above, count) {\n        var rowPlacement = above ? 'Above' : 'Below';\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        if (startPos.paragraph.isInsideTable) {\n            if (this.checkIsNotRedoing()) {\n                this.initHistory(rowPlacement === 'Above' ? 'InsertRowAbove' : 'InsertRowBelow');\n            }\n            this.viewer.owner.isShiftingEnabled = true;\n            var startCell = this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0];\n            var endCell = this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0];\n            var table = startCell.ownerTable.combineWidget(this.viewer);\n            var row = rowPlacement === 'Below' ? endCell.ownerRow : startCell.ownerRow;\n            if (this.editorHistory) {\n                var clonedTable = this.cloneTableToHistoryInfo(table);\n            }\n            var rowCount = count ? count : this.getRowCountToInsert();\n            var rows = [];\n            var index = row.rowIndex;\n            if (rowPlacement === 'Below') {\n                index++;\n                var isAffectedByRowSpannedCell = isNullOrUndefined(endCell.previousWidget)\n                    || endCell.columnIndex === endCell.previousWidget.columnIndex + 1;\n                var isRowSpanEnd = endCell.cellIndex !== endCell.columnIndex && isAffectedByRowSpannedCell\n                    && row.rowIndex + startCell.cellFormat.rowSpan - 1 === endCell.ownerRow.rowIndex;\n                if (!isRowSpanEnd) {\n                    if (endCell.cellFormat.rowSpan > 1) {\n                        if (!isNullOrUndefined(row.nextWidget) && row.nextWidget instanceof TableRowWidget) {\n                            endCell.cellFormat.rowSpan += rowCount;\n                            row = row.nextWidget;\n                        }\n                    }\n                }\n            }\n            for (var i = 0; i < rowCount; i++) {\n                var cellCountInfo = this.updateRowspan(row, rowPlacement === 'Below' ? endCell : startCell, rowPlacement);\n                var newRow = this.createRowAndColumn(cellCountInfo.count, i);\n                newRow.rowFormat.copyFormat(row.rowFormat);\n                this.updateCellFormatForInsertedRow(newRow, cellCountInfo.cellFormats);\n                rows.push(newRow);\n            }\n            table.insertTableRowsInternal(rows, index);\n            var cell = undefined;\n            var paragraph = undefined;\n            if ((table.childWidgets[index] instanceof TableRowWidget)) {\n                cell = table.childWidgets[index].firstChild;\n                paragraph = this.selection.getFirstParagraph(cell);\n            }\n            else {\n                var widget = undefined;\n                while (!(widget instanceof TableWidget)) {\n                    widget = table.nextRenderedWidget;\n                }\n                paragraph = this.selection.getFirstParagraphInFirstCell(widget);\n            }\n            this.viewer.layout.reLayoutTable(table);\n            this.selection.selectParagraph(paragraph, true);\n        }\n        this.reLayout(this.selection, true);\n    };\n    /**\n     * Fits the table based on AutoFitType.\n     * @param {AutoFitType} - auto fit type\n     */\n    Editor.prototype.autoFitTable = function (fitType) {\n        if (this.viewer.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPosition = this.selection.start;\n        var endPosition = this.selection.end;\n        if (!this.selection.isForward) {\n            startPosition = this.selection.end;\n            endPosition = this.selection.start;\n        }\n        var tableAdv = this.selection.getTable(startPosition, endPosition);\n        tableAdv = tableAdv.getSplitWidgets()[0];\n        var parentTable = this.viewer.layout.getParentTable(tableAdv);\n        if (!isNullOrUndefined(parentTable)) {\n            this.setOffsetValue(this.selection);\n            parentTable = parentTable.combineWidget(this.viewer);\n            // tslint:disable-next-line:max-line-length\n            this.initHistory(fitType === 'FitToContents' ? 'TableAutoFitToContents' : fitType === 'FitToWindow' ? 'TableAutoFitToWindow' : 'TableFixedColumnWidth');\n            if (this.viewer.owner.editorHistoryModule) {\n                this.cloneTableToHistoryInfo(parentTable);\n            }\n            parentTable.updateProperties(true, tableAdv, fitType);\n            this.viewer.owner.isShiftingEnabled = true;\n            //Layouts the table.\n            this.viewer.layout.reLayoutTable(tableAdv);\n            this.reLayout(this.selection, true);\n        }\n    };\n    Editor.prototype.updateCellFormatForInsertedRow = function (newRow, cellFormats) {\n        for (var i = 0; i < newRow.childWidgets.length; i++) {\n            newRow.childWidgets[i].cellFormat.copyFormat(cellFormats[i]);\n            newRow.childWidgets[i].cellFormat.rowSpan = 1;\n        }\n    };\n    Editor.prototype.updateRowspan = function (row, startCell, rowPlacement) {\n        var spannedCells = row.getPreviousRowSpannedCells(true);\n        var count = 0;\n        var cellFormats = [];\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            var isCellIncluded = false;\n            // Need to check with all the row spanned cells. if the start cell contains rowspan greater than 1, \n            // and when inserting below, need to increment rowspan for all row spanned cells by 1 except\n            // if the spanned cells is placed in the same column or cell to be cloned has the same row index of cloned cell row index.\n            // and when inserting above, if cloned cell placed in the same row of start cell or\n            // if the cloned cell has equal column index, need to skip updating rowspan value of cloned cell.\n            // else update row span value for spanned cell except \n            // if the spanned cells is placed in the same column or cell to be cloned has the same row index of cloned cell row index.\n            var isRowSpanned = (isNullOrUndefined(cell.previousWidget)\n                || cell.columnIndex !== cell.previousWidget.columnIndex + 1);\n            for (var j = 0; j < spannedCells.length; j++) {\n                if (isRowSpanned) {\n                    var spannedCell = spannedCells[j];\n                    var clonedRowIndex = spannedCell.ownerRow.rowIndex + spannedCell.cellFormat.rowSpan - 1;\n                    if (cell.columnIndex < spannedCell.columnIndex && cell.cellIndex !== cell.columnIndex) {\n                        isCellIncluded = true;\n                        count++;\n                        cellFormats.push(cell.cellFormat);\n                    }\n                    if (startCell.cellFormat.rowSpan === 1) {\n                        // Need to check whether cell is affected by a row spanned cell. if cell is placed on the row where it is affected \n                        // by row spanned cell, then if we are inserting row below, need to add new cell with spanned cell width\n                        // or if we are inserting above, need to update row span value of the spanned cell.\n                        // if cell is placed inbetween the spanned cell , \n                        // then if we are inserting below, need to update row span value of spanned cell or\n                        // if we are inserting above, need to skip updating row span value except\n                        // if start cell is placed on the same row of spanned cell or if start cell placed in the same column.\n                        if (clonedRowIndex > cell.ownerRow.rowIndex) {\n                            if (rowPlacement === 'Above'\n                                && spannedCell.ownerRow === startCell.ownerRow) {\n                                continue;\n                            }\n                            else {\n                                spannedCell.cellFormat.rowSpan += 1;\n                                spannedCells.splice(j, 1);\n                                j--;\n                            }\n                        }\n                        else if (cell.cellIndex !== cell.columnIndex && isRowSpanned && clonedRowIndex === cell.ownerRow.rowIndex) {\n                            if (rowPlacement === 'Above') {\n                                spannedCell.cellFormat.rowSpan += 1;\n                                spannedCells.splice(j, 1);\n                                j--;\n                            }\n                            else {\n                                count++;\n                                cellFormats.push(spannedCell.cellFormat);\n                                spannedCells.splice(j, 1);\n                                j--;\n                            }\n                        }\n                    }\n                    else {\n                        if (spannedCell !== startCell) {\n                            if (rowPlacement === 'Above'\n                                && (spannedCell.ownerRow === startCell.ownerRow || spannedCell.columnIndex === startCell.columnIndex)) {\n                                continue;\n                            }\n                            else {\n                                if (spannedCell.columnIndex !== startCell.columnIndex\n                                    && spannedCell.ownerRow.rowIndex !== cell.ownerRow.rowIndex\n                                    && (clonedRowIndex > startCell.ownerRow.rowIndex\n                                        || (rowPlacement === 'Above' && clonedRowIndex === startCell.ownerRow.rowIndex))) {\n                                    spannedCell.cellFormat.rowSpan += 1;\n                                    spannedCells.splice(j, 1);\n                                    j--;\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            if (spannedCells.indexOf(cell) === -1 && cell.cellFormat.rowSpan > 1) {\n                isCellIncluded = true;\n            }\n            if (!isCellIncluded) {\n                count++;\n                cellFormats.push(cell.cellFormat);\n            }\n        }\n        return { count: count, cellFormats: cellFormats };\n    };\n    Editor.prototype.insertTableRows = function (table, prevBlock) {\n        this.initHistory('InsertRowBelow');\n        table.containerWidget = prevBlock.containerWidget;\n        prevBlock = prevBlock.combineWidget(this.viewer);\n        if (this.editorHistory) {\n            var clonedTable = this.cloneTableToHistoryInfo(prevBlock);\n        }\n        var row = prevBlock.childWidgets[prevBlock.childWidgets.length - 1];\n        prevBlock.insertTableRowsInternal(table.childWidgets, prevBlock.childWidgets.length);\n        var paragraph = this.selection.getFirstParagraph(row.nextWidget.childWidgets[0]);\n        this.viewer.layout.reLayoutTable(prevBlock);\n        this.selection.selectParagraph(paragraph, true);\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            this.updateHistoryPosition(this.selection.start, true);\n            this.updateHistoryPosition(this.selection.end, false);\n        }\n        this.reLayout(this.selection);\n    };\n    /**\n     * Inserts the specified number of columns to the table left or right to the column at cursor position.\n     * @param {number} left The left parameter is optional and if omitted, it takes the value as false and\n     * inserts to the right of column at cursor position.\n     * @param {number} count The count parameter is optional and if omitted, it takes the value as 1.\n     */\n    Editor.prototype.insertColumn = function (left, count) {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var columnPlacement = left ? 'Left' : 'Right';\n        if (this.selection.start.paragraph.isInsideTable) {\n            if (this.checkIsNotRedoing()) {\n                this.initHistory(columnPlacement === 'Left' ? 'InsertColumnLeft' : 'InsertColumnRight');\n            }\n            this.selection.owner.isShiftingEnabled = true;\n            var startCell = this.getOwnerCell(this.selection.isForward);\n            var endCell = this.getOwnerCell(!this.selection.isForward);\n            var table = startCell.ownerRow.ownerTable.combineWidget(this.viewer);\n            if (this.editorHistory) {\n                //Clones the entire table to preserve in history.\n                var clonedTable = this.cloneTableToHistoryInfo(table);\n            }\n            this.selection.owner.isLayoutEnabled = false;\n            var cellIndex = startCell.columnIndex;\n            if (columnPlacement === 'Right') {\n                cellIndex = endCell.columnIndex + endCell.cellFormat.columnSpan;\n            }\n            var startParagraph = undefined;\n            var newCell = undefined;\n            var columnCount = count ? count : this.getColumnCountToInsert();\n            var rowSpannedCells = [];\n            var rowSpanCellIndex = cellIndex;\n            for (var i = 0; i < columnCount; i++) {\n                for (var j = 0; j < table.childWidgets.length; j++) {\n                    var row = table.childWidgets[j];\n                    newCell = this.createColumn(this.selection.getLastParagraph(startCell));\n                    newCell.index = j;\n                    newCell.rowIndex = row.rowIndex;\n                    newCell.containerWidget = row;\n                    newCell.cellFormat.copyFormat(startCell.cellFormat);\n                    newCell.cellFormat.rowSpan = 1;\n                    if (isNullOrUndefined(startParagraph)) {\n                        startParagraph = this.selection.getFirstParagraph(newCell);\n                    }\n                    if (cellIndex === 0) {\n                        row.childWidgets.splice(cellIndex, 0, newCell);\n                    }\n                    else {\n                        var isCellInserted = false;\n                        for (var j_1 = 0; j_1 < row.childWidgets.length; j_1++) {\n                            var rowCell = row.childWidgets[j_1];\n                            // Add the row spanned cells to colection for adding column before / after row spnned cells.\n                            if (rowCell.cellFormat.rowSpan > 1) {\n                                rowSpannedCells.push(rowCell);\n                            }\n                            if (rowCell.columnIndex + rowCell.cellFormat.columnSpan === cellIndex) {\n                                row.childWidgets.splice(rowCell.cellIndex + 1, 0, newCell);\n                                isCellInserted = true;\n                            }\n                            else if (cellIndex > rowCell.columnIndex && rowCell.columnIndex + rowCell.cellFormat.columnSpan > cellIndex\n                                && cellIndex < rowCell.columnIndex + rowCell.cellFormat.columnSpan) {\n                                row.childWidgets.splice(rowCell.cellIndex, 0, newCell);\n                                isCellInserted = true;\n                            }\n                            if (isCellInserted) {\n                                break;\n                            }\n                        }\n                        // If the cell is not inserted for row, then check for row spanned cells.\n                        if (!isCellInserted) {\n                            if (rowSpannedCells.length > 0) {\n                                for (var k = 0; k < rowSpannedCells.length; k++) {\n                                    var rowSpannedCell = rowSpannedCells[k];\n                                    if (rowSpannedCell.ownerRow !== row\n                                        && row.rowIndex <= rowSpannedCell.ownerRow.rowIndex + rowSpannedCell.cellFormat.rowSpan - 1) {\n                                        if (rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan === cellIndex) {\n                                            if (rowSpannedCell.cellIndex > row.childWidgets.length) {\n                                                row.childWidgets.push(newCell);\n                                            }\n                                            else {\n                                                row.childWidgets.splice(rowSpannedCell.cellIndex, 0, newCell);\n                                            }\n                                            isCellInserted = true;\n                                        }\n                                        else if (cellIndex > rowSpannedCell.columnIndex &&\n                                            rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan > cellIndex\n                                            && cellIndex < rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan) {\n                                            row.childWidgets.splice(rowSpannedCell.columnIndex, 0, newCell);\n                                            isCellInserted = true;\n                                        }\n                                    }\n                                    if (isCellInserted) {\n                                        break;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            table.updateRowIndex(0);\n            var parentTable = this.viewer.layout.getParentTable(table);\n            if (parentTable) {\n                parentTable.fitChildToClientArea();\n            }\n            else {\n                table.fitChildToClientArea();\n            }\n            this.selection.owner.isLayoutEnabled = true;\n            table.isGridUpdated = false;\n            table.buildTableColumns();\n            table.isGridUpdated = true;\n            this.viewer.layout.reLayoutTable(table);\n            this.selection.start.setPosition(startParagraph.firstChild, true);\n            this.selection.end.setPosition(this.selection.getLastParagraph(newCell).firstChild, false);\n            if (this.checkIsNotRedoing() || isNullOrUndefined(this.editorHistory)) {\n                this.reLayout(this.selection);\n            }\n        }\n    };\n    /**\n     * Creates table with specified rows and columns.\n     * @private\n     */\n    Editor.prototype.createTable = function (rows, columns) {\n        var startPara = this.selection.start.paragraph;\n        var table = new TableWidget();\n        table.tableFormat = new WTableFormat(table);\n        table.tableFormat.preferredWidthType = 'Auto';\n        table.tableFormat.initializeTableBorders();\n        var index = 0;\n        while (index < rows) {\n            var tableRow = this.createRowAndColumn(columns, index);\n            tableRow.rowFormat.heightType = 'Auto';\n            tableRow.containerWidget = table;\n            table.childWidgets.push(tableRow);\n            index++;\n        }\n        return table;\n    };\n    Editor.prototype.createRowAndColumn = function (columns, rowIndex) {\n        var startPara = this.selection.start.paragraph;\n        var tableRow = new TableRowWidget();\n        tableRow.rowFormat = new WRowFormat(tableRow);\n        tableRow.index = rowIndex;\n        for (var i = 0; i < columns; i++) {\n            var tableCell = this.createColumn(startPara);\n            tableCell.index = i;\n            tableCell.rowIndex = rowIndex;\n            tableCell.containerWidget = tableRow;\n            tableRow.childWidgets.push(tableCell);\n        }\n        return tableRow;\n    };\n    Editor.prototype.createColumn = function (paragraph) {\n        var tableCell = new TableCellWidget();\n        var para = new ParagraphWidget();\n        para.paragraphFormat.copyFormat(paragraph.paragraphFormat);\n        para.characterFormat.copyFormat(paragraph.characterFormat);\n        para.containerWidget = tableCell;\n        tableCell.childWidgets.push(para);\n        tableCell.cellFormat = new WCellFormat(tableCell);\n        return tableCell;\n    };\n    Editor.prototype.getColumnCountToInsert = function () {\n        var count = 1;\n        var start = this.selection.start;\n        var end = this.selection.end;\n        if (!this.selection.isForward) {\n            start = this.selection.end;\n            end = this.selection.start;\n        }\n        if (start && end && this.selection.getTable(start, end)) {\n            if (start.paragraph.associatedCell === end.paragraph.associatedCell) {\n                return count = 1;\n            }\n            if (start.paragraph.associatedCell.ownerRow === end.paragraph.associatedCell.ownerRow) {\n                return count = count + end.paragraph.associatedCell.cellIndex - start.paragraph.associatedCell.cellIndex;\n            }\n            else {\n                count = 0;\n                // tslint:disable-next-line:max-line-length\n                var selectedCells = start.paragraph.associatedCell.ownerTable.getColumnCellsForSelection(start.paragraph.associatedCell, end.paragraph.associatedCell);\n                for (var i = 0; i < selectedCells.length; i++) {\n                    if (start.paragraph.associatedCell.ownerRow === selectedCells[i].ownerRow) {\n                        count++;\n                    }\n                }\n            }\n        }\n        return count === 0 ? 1 : count;\n    };\n    Editor.prototype.getRowCountToInsert = function () {\n        var count = 1;\n        var start = this.selection.start;\n        var end = this.selection.end;\n        if (!this.selection.isForward) {\n            start = this.selection.end;\n            end = this.selection.start;\n        }\n        if (!isNullOrUndefined(start) && !isNullOrUndefined(end) && !isNullOrUndefined(this.selection.getTable(start, end))) {\n            if (start.paragraph.associatedCell === end.paragraph.associatedCell ||\n                start.paragraph.associatedCell.ownerRow === end.paragraph.associatedCell.ownerRow) {\n                return count = 1;\n            }\n            else {\n                return count = count +\n                    this.getOwnerRow(!this.selection.isForward).rowIndex - this.getOwnerRow(this.selection.isForward).rowIndex;\n            }\n        }\n        return count === 0 ? 1 : count;\n    };\n    Editor.prototype.getOwnerCell = function (isStart) {\n        var cell = undefined;\n        var startCell = isStart ? this.selection.start.paragraph.associatedCell\n            : this.selection.end.paragraph.associatedCell;\n        var endCell = isStart ? this.selection.end.paragraph.associatedCell\n            : this.selection.start.paragraph.associatedCell;\n        cell = startCell;\n        var owner = cell.ownerTable;\n        while (!isNullOrUndefined(owner) && owner.containerWidget instanceof TableCellWidget && owner !== endCell.ownerTable) {\n            cell = owner.containerWidget;\n            owner = cell.ownerTable;\n        }\n        return cell;\n    };\n    Editor.prototype.getOwnerRow = function (isStart) {\n        var row;\n        var startRow = isStart ? this.selection.start.paragraph.associatedCell.ownerRow\n            : this.selection.end.paragraph.associatedCell.ownerRow;\n        var endRow = isStart ? this.selection.end.paragraph.associatedCell.ownerRow\n            : this.selection.start.paragraph.associatedCell.ownerRow;\n        row = startRow;\n        var owner = row.ownerTable;\n        while (!isNullOrUndefined(owner) && owner.containerWidget instanceof TableCellWidget && owner !== endRow.ownerTable) {\n            row = owner.containerWidget.ownerRow;\n            owner = row.ownerTable;\n        }\n        return row;\n    };\n    Editor.prototype.getOwnerTable = function (isStart) {\n        var table = undefined;\n        var startTable = this.selection.start.paragraph.associatedCell.ownerTable;\n        var endTable = this.selection.end.paragraph.associatedCell.ownerTable;\n        table = isStart ? startTable : endTable;\n        while (table.containerWidget instanceof TableCellWidget && table !== (isStart ? endTable : startTable)) {\n            table = table.containerWidget.ownerTable;\n        }\n        return table;\n    };\n    /**\n     * Merge Selected cells\n     * @private\n     */\n    Editor.prototype.mergeSelectedCellsInTable = function () {\n        if (!this.canMergeCells()) {\n            return;\n        }\n        if (this.checkIsNotRedoing()) {\n            this.initHistory('MergeCells');\n        }\n        this.selection.owner.isShiftingEnabled = true;\n        var startPosition = this.selection.start;\n        var endPosition = this.selection.end;\n        if (!this.selection.isForward) {\n            startPosition = this.selection.end;\n            endPosition = this.selection.start;\n        }\n        var startOwnerCell = this.getOwnerCell(this.selection.isForward);\n        var endOwnerCell = this.getOwnerCell(!this.selection.isForward);\n        var containerCell = this.selection.getContainerCellOf(startOwnerCell, endOwnerCell);\n        if (containerCell.ownerTable.contains(endOwnerCell)) {\n            if (!this.selection.containsCell(containerCell, endOwnerCell)) {\n                //Start and End are in different cells.               \n                var table = startOwnerCell.ownerTable.combineWidget(this.viewer);\n                startOwnerCell = this.selection.getSelectedCell(startOwnerCell, containerCell);\n                endOwnerCell = this.selection.getSelectedCell(endOwnerCell, containerCell);\n                //Merges the selected cells.               \n                var mergedCell = this.mergeSelectedCells(table, startOwnerCell, endOwnerCell);\n                var lastParagraph = this.selection.getLastParagraph(mergedCell);\n                endPosition.setPosition(lastParagraph.lastChild, false);\n            }\n        }\n        if (this.checkIsNotRedoing() || isNullOrUndefined(this.editorHistory)) {\n            this.reLayout(this.selection, false);\n        }\n    };\n    Editor.prototype.mergeSelectedCells = function (table, startCell, endCell) {\n        //Clones the entire table to preserve in history.\n        var clonedTable = this.cloneTableToHistoryInfo(table);\n        this.selection.owner.isLayoutEnabled = false;\n        //Merges the selected cells.\n        var start = this.selection.getCellLeft(startCell.ownerRow, startCell);\n        var end = start + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(start, end, endCellLeft, endCellRight);\n        start = cellInfo.start;\n        end = cellInfo.end;\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var rowStartIndex = table.childWidgets.indexOf(startCell.ownerRow);\n        var mergedCell = undefined;\n        for (var i = rowStartIndex; i <= count; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellStart = this.selection.getCellLeft(row, cell);\n                if (HelperMethods.round(start, 2) <= HelperMethods.round(cellStart, 2)\n                    && HelperMethods.round(cellStart, 2) < HelperMethods.round(end, 2)) {\n                    if (isNullOrUndefined(mergedCell)) {\n                        mergedCell = cell;\n                    }\n                    else {\n                        if (i === rowStartIndex) {\n                            mergedCell.cellFormat.preferredWidth += cell.cellFormat.preferredWidth;\n                            mergedCell.cellFormat.columnSpan += cell.cellFormat.columnSpan;\n                            this.mergeBorders(mergedCell, cell);\n                        }\n                        for (var k = 0; k < cell.childWidgets.length; k++) {\n                            var block = cell.childWidgets[k];\n                            if (cell.childWidgets.length === 1 && block instanceof ParagraphWidget\n                                && block.childWidgets.length === 0) {\n                                break;\n                            }\n                            var newBlock = block.clone();\n                            newBlock.containerWidget = mergedCell;\n                            mergedCell.childWidgets.push(newBlock);\n                        }\n                        row.childWidgets.splice(j, 1);\n                        cell.destroy();\n                        j--;\n                    }\n                }\n            }\n            if (row.childWidgets.length === 0) {\n                var rowIndex = table.childWidgets.indexOf(row);\n                row.updateRowBySpannedCells();\n                table.childWidgets.splice(rowIndex, 1);\n                row.destroy();\n                count--;\n                i--;\n            }\n        }\n        if (!isNullOrUndefined(mergedCell) && rowStartIndex < count) {\n            mergedCell.cellFormat.rowSpan = count - rowStartIndex + 1;\n        }\n        this.updateBlockIndexAfterMerge(mergedCell);\n        table.updateRowIndex(0);\n        table.calculateGrid();\n        table.isGridUpdated = false;\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.viewer.layout.reLayoutTable(table);\n        //Layouts the table after merging cells.\n        this.selection.owner.isLayoutEnabled = true;\n        return mergedCell;\n    };\n    Editor.prototype.mergeBorders = function (mergedCell, tableCell) {\n        var mergedCellborders = undefined;\n        var cellBorders = null;\n        if (!isNullOrUndefined(mergedCell.cellFormat.borders)) {\n            mergedCellborders = mergedCell.cellFormat.borders;\n        }\n        if (!isNullOrUndefined(tableCell.cellFormat.borders)) {\n            cellBorders = tableCell.cellFormat.borders;\n        }\n        if (isNullOrUndefined(mergedCellborders) && isNullOrUndefined(cellBorders)) {\n            return;\n        }\n        if (isNullOrUndefined(mergedCellborders)) {\n            mergedCellborders = new WBorders(mergedCell.cellFormat);\n            mergedCellborders.copyFormat(cellBorders);\n        }\n        else if (isNullOrUndefined(cellBorders)) {\n            return;\n        }\n        else {\n            if (mergedCell.ownerRow.rowIndex === tableCell.ownerRow.rowIndex) {\n                mergedCellborders.top = mergedCell.getBorderBasedOnPriority(mergedCellborders.top, cellBorders.bottom);\n                mergedCellborders.bottom = mergedCell.getBorderBasedOnPriority(mergedCellborders.bottom, cellBorders.bottom);\n            }\n        }\n    };\n    Editor.prototype.updateBlockIndexAfterMerge = function (cell) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            cell.childWidgets[i].index = i;\n        }\n    };\n    /**\n     * Determines whether merge cell operation can be done.\n     */\n    Editor.prototype.canMergeCells = function () {\n        if (this.selection.isEmpty || !this.selection.start.paragraph.isInsideTable || !this.selection.end.paragraph.isInsideTable) {\n            return false;\n        }\n        var startPos = this.selection.start;\n        var endPos = this.selection.end;\n        if (!this.selection.isForward) {\n            startPos = this.selection.end;\n            endPos = this.selection.start;\n        }\n        var startCell = this.getOwnerCell(this.selection.isForward);\n        var endCell = this.getOwnerCell(!this.selection.isForward);\n        var containerCell = this.selection.getContainerCellOf(startCell, endCell);\n        if (containerCell.ownerTable.contains(endCell)) {\n            if (!this.selection.containsCell(containerCell, endCell)) {\n                startCell = this.selection.getSelectedCell(startCell, containerCell);\n                endCell = this.selection.getSelectedCell(endCell, containerCell);\n                var rowSpan = 1;\n                if (startCell.ownerRow === endCell.ownerRow) {\n                    var startCellIndex = startCell.ownerRow.childWidgets.indexOf(startCell);\n                    for (var i = startCellIndex; i <= startCell.ownerRow.childWidgets.indexOf(endCell); i++) {\n                        var cell = startCell.ownerRow.childWidgets[i];\n                        var prevCell = cell.previousWidget;\n                        if (i !== startCellIndex) {\n                            if (cell.cellFormat.rowSpan !== rowSpan) {\n                                return false;\n                            }\n                            if (!isNullOrUndefined(prevCell)\n                                && cell.columnIndex !== (prevCell.cellFormat.columnSpan + prevCell.columnIndex)) {\n                                return false;\n                            }\n                        }\n                        rowSpan = cell.cellFormat.rowSpan;\n                    }\n                    return true;\n                }\n                return this.canMergeSelectedCellsInTable(startCell.ownerTable, startCell, endCell);\n            }\n        }\n        return false;\n    };\n    Editor.prototype.canMergeSelectedCellsInTable = function (table, startCell, endCell) {\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var rowStartIndex = table.childWidgets.indexOf(startCell.ownerRow);\n        var startLeft = this.selection.getCellLeft(startCell.ownerRow, startCell);\n        var endLeft = startLeft + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(startLeft, endLeft, endCellLeft, endCellRight);\n        startLeft = cellInfo.start;\n        endLeft = cellInfo.end;\n        var selectionLeft = 0;\n        var selectionRight = 0;\n        var isRowLeftWithinSel = false;\n        var isRowRightWithinSel = false;\n        var rowSpannedCells = [];\n        for (var i = rowStartIndex; i <= count; i++) {\n            var row = table.childWidgets[i];\n            var rowLeft = 0;\n            var rowRight = 0;\n            var isStarted = false;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellStart = this.selection.getCellLeft(row, cell);\n                if (this.checkCellWithInSelection(startLeft, endLeft, cellStart)) {\n                    isRowLeftWithinSel = false;\n                    isRowRightWithinSel = false;\n                    if (cell.cellFormat.rowSpan > 1) {\n                        rowSpannedCells.push(cell);\n                    }\n                    if (!isStarted) {\n                        rowLeft = cellStart;\n                        rowRight = cellStart;\n                        isStarted = true;\n                    }\n                    var prevCell = cell.previousWidget;\n                    if (rowRight !== 0 && HelperMethods.round(rowRight, 0) !== HelperMethods.round(cellStart, 0)) {\n                        rowRight = cellStart;\n                    }\n                    rowRight += HelperMethods.convertPointToPixel(cell.cellFormat.cellWidth);\n                    var isPrevCellWithinSel = this.checkPrevOrNextCellIsWithinSel(startLeft, endLeft, cell, true);\n                    var isNextCellWithinSel = this.checkPrevOrNextCellIsWithinSel(startLeft, endLeft, cell, false);\n                    // When selected cell not having row spanned cells and column index is not having immediate cell index value,\n                    // then returned false.\n                    var isNoRowSpan = rowSpannedCells.length === 0 || rowSpannedCells.length === 1 && rowSpannedCells[0] === cell;\n                    // checks whether current cell is with in selection.\n                    var isCellWithInSel = this.checkCurrentCell(rowSpannedCells, cell, isPrevCellWithinSel, isNextCellWithinSel);\n                    // when last selected row not having equal row span then returned false.\n                    if (i === count && !isNullOrUndefined(prevCell) && cell.cellFormat.rowSpan > prevCell.cellFormat.rowSpan\n                        && !isCellWithInSel) {\n                        return false;\n                    }\n                    if (i !== rowStartIndex) {\n                        for (var m = 0; m < rowSpannedCells.length; m++) {\n                            {\n                                var rowSpan = (rowSpannedCells[m].ownerRow.rowIndex + rowSpannedCells[m].cellFormat.rowSpan) - 1;\n                                if (rowSpan >= row.rowIndex) {\n                                    if (rowSpannedCells[m].columnIndex > cell.columnIndex) {\n                                        isRowRightWithinSel = true;\n                                    }\n                                    else {\n                                        isRowLeftWithinSel = true;\n                                    }\n                                    if (i === count && rowSpannedCells[m] !== cell\n                                        && rowSpan > (cell.ownerRow.rowIndex + cell.cellFormat.rowSpan - 1)) {\n                                        return false;\n                                    }\n                                    if (rowSpan === row.rowIndex && !this.checkPrevOrNextCellIsWithinSel(startLeft, endLeft, cell, false)) {\n                                        rowSpannedCells.splice(rowSpannedCells.indexOf(rowSpannedCells[m]), 1);\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    if (isPrevCellWithinSel && !isNullOrUndefined(prevCell)\n                        && isNoRowSpan\n                        && (cell.columnIndex !== prevCell.columnIndex + 1 && this.checkCellWidth(cell))) {\n                        return false;\n                    }\n                }\n            }\n            if (i === rowStartIndex) {\n                selectionLeft = rowLeft;\n                selectionRight = rowRight;\n            }\n            else {\n                if (rowRight > 0 && rowLeft > 0) {\n                    if (!((isRowLeftWithinSel || Math.round(selectionLeft) === Math.round(rowLeft))\n                        && (isRowRightWithinSel || Math.round(selectionRight) === Math.round(rowRight)))) {\n                        return false;\n                    }\n                }\n                if (i === count) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    Editor.prototype.checkCellWidth = function (cell) {\n        var prevCell = cell.previousWidget;\n        var cellLeft = this.viewer.selection.getCellLeft(cell.ownerRow, cell);\n        var prevCellLeft = this.viewer.selection.getCellLeft(cell.ownerRow, prevCell);\n        var left = prevCellLeft + HelperMethods.convertPointToPixel(prevCell.cellFormat.cellWidth);\n        if (HelperMethods.round(left, 2) !== HelperMethods.round(cellLeft, 2)) {\n            return true;\n        }\n        return false;\n    };\n    ;\n    Editor.prototype.checkCellWithInSelection = function (startLeft, endLeft, cellStart) {\n        if (HelperMethods.round(startLeft, 2) <= HelperMethods.round(cellStart, 2)\n            && HelperMethods.round(cellStart, 2) < HelperMethods.round(endLeft, 2)) {\n            return true;\n        }\n        return false;\n    };\n    ;\n    Editor.prototype.checkPrevOrNextCellIsWithinSel = function (startLeft, endLeft, cell, isPrev) {\n        var prevOrNextCell = isPrev ? cell.previousWidget : cell.nextWidget;\n        var cellStart = 0;\n        if (isNullOrUndefined(prevOrNextCell)) {\n            return false;\n        }\n        cellStart = this.viewer.selection.getCellLeft(prevOrNextCell.ownerRow, prevOrNextCell);\n        return this.checkCellWithInSelection(startLeft, endLeft, cellStart);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.checkCurrentCell = function (rowSpannedCells, cell, isPrevCellWithInSel, isNextCellWithinSel) {\n        var cellOwner = cell.ownerRow;\n        if (rowSpannedCells.length > 0) {\n            for (var i = 0; i < rowSpannedCells.length; i++) {\n                var spannedCellOwner = rowSpannedCells[i].ownerRow;\n                var rowSpan = (spannedCellOwner.rowIndex + rowSpannedCells[i].cellFormat.rowSpan) - 1;\n                if (rowSpannedCells[i] === cell && (rowSpannedCells.length === 1 || this.checkRowSpannedCells(rowSpannedCells, cell))\n                    && !(isNextCellWithinSel || isPrevCellWithInSel)) {\n                    return true;\n                }\n                if (rowSpannedCells[i] !== cell && spannedCellOwner.rowIndex < cellOwner.rowIndex\n                    && rowSpan === (cellOwner.rowIndex + cell.cellFormat.rowSpan - 1)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    Editor.prototype.checkRowSpannedCells = function (rowSpannedCells, cell) {\n        for (var i = 0; i < rowSpannedCells.length; i++) {\n            if (rowSpannedCells[i] !== cell && rowSpannedCells[i].columnIndex === cell.columnIndex) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertNewParagraphWidget = function (newParagraph, insertAfter) {\n        this.updateInsertPosition();\n        this.insertParagraph(newParagraph, insertAfter);\n        if (!insertAfter) {\n            var nextParagraph = void 0;\n            var currentParagraph = newParagraph;\n            do {\n                nextParagraph = this.selection.getNextParagraphBlock(currentParagraph);\n                currentParagraph = nextParagraph;\n            } while (nextParagraph && nextParagraph.equals(newParagraph));\n            if (!isNullOrUndefined(nextParagraph)) {\n                this.selection.selectParagraph(nextParagraph, true);\n            }\n            else {\n                this.selection.selectParagraph(newParagraph, true);\n            }\n        }\n        this.fireContentChange();\n    };\n    Editor.prototype.insertParagraph = function (newParagraph, insertAfter) {\n        var lineWidget = this.selection.start.currentWidget;\n        var offset = this.selection.start.offset;\n        var currentParagraph = this.selection.start.paragraph;\n        currentParagraph = currentParagraph.combineWidget(this.viewer);\n        if (insertAfter) {\n            // tslint:disable-next-line:max-line-length\n            var length_1 = this.selection.getLineLength(currentParagraph.lastChild);\n            var insertIndex_1 = newParagraph.firstChild ? newParagraph.firstChild.children.length : 0;\n            // tslint:disable-next-line:max-line-length\n            this.moveInlines(currentParagraph, newParagraph, insertIndex_1, offset, lineWidget, length_1, currentParagraph.lastChild);\n        }\n        else if (offset > 0) {\n            this.moveInlines(currentParagraph, newParagraph, 0, 0, currentParagraph.firstChild, offset, lineWidget);\n        }\n        var splittedWidget = currentParagraph.getSplitWidgets();\n        currentParagraph = insertAfter ? splittedWidget[splittedWidget.length - 1] : splittedWidget[0];\n        var insertIndex = currentParagraph.containerWidget.childWidgets.indexOf(currentParagraph);\n        if (insertAfter) {\n            insertIndex++;\n        }\n        var bodyWidget = currentParagraph.containerWidget;\n        newParagraph.index = currentParagraph.index;\n        newParagraph.containerWidget = bodyWidget;\n        bodyWidget.childWidgets.splice(insertIndex, 0, newParagraph);\n        this.updateNextBlocksIndex(insertAfter ? currentParagraph : newParagraph, true);\n        newParagraph.height = 0;\n        this.viewer.layout.layoutBodyWidgetCollection(newParagraph.index, bodyWidget, newParagraph, false);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.moveInlines = function (currentParagraph, newParagraph, insertIndex, startOffset, startLine, endOffset, endLine) {\n        if (newParagraph.childWidgets.length === 0) {\n            var line = new LineWidget(newParagraph);\n            newParagraph.childWidgets.push(line);\n        }\n        var isMoved = false;\n        this.viewer.layout.clearListElementBox(currentParagraph);\n        this.viewer.layout.clearListElementBox(newParagraph);\n        for (var j = 0; j < currentParagraph.childWidgets.length; j++) {\n            var lineWidget = currentParagraph.childWidgets[j];\n            if (startLine === lineWidget && endLine === lineWidget) {\n                insertIndex = this.moveContent(lineWidget, startOffset, endOffset, insertIndex, newParagraph);\n                break;\n            }\n            if (endLine === lineWidget) {\n                insertIndex = this.moveContent(lineWidget, 0, endOffset, insertIndex, newParagraph);\n                break;\n            }\n            else if (startLine === lineWidget) {\n                isMoved = true;\n                // tslint:disable-next-line:max-line-length\n                insertIndex = this.moveContent(lineWidget, startOffset, this.viewer.selection.getLineLength(lineWidget), insertIndex, newParagraph);\n            }\n            else if (isMoved) {\n                insertIndex = this.moveContent(lineWidget, 0, this.viewer.selection.getLineLength(lineWidget), insertIndex, newParagraph);\n            }\n        }\n        this.removeEmptyLine(currentParagraph);\n        if (!currentParagraph.isInsideTable) {\n            this.viewer.layout.reLayoutParagraph(currentParagraph, 0, 0);\n        }\n    };\n    /**\n     * @private\n     */\n    //tslint:disable-next-line:max-line-length\n    Editor.prototype.moveContent = function (lineWidget, startOffset, endOffset, insertIndex, paragraph) {\n        var count = 0;\n        var lineIndex = lineWidget.paragraph.childWidgets.indexOf(lineWidget);\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var inline = lineWidget.children[i];\n            if (startOffset >= count + inline.length || inline instanceof ListTextElementBox) {\n                if (!(inline instanceof ListTextElementBox)) {\n                    count += inline.length;\n                }\n                continue;\n            }\n            var startIndex = 0;\n            if (startOffset > count) {\n                startIndex = startOffset - count;\n            }\n            var endIndex = endOffset - count;\n            if (endIndex > inline.length) {\n                endIndex = inline.length;\n            }\n            if (startIndex > 0) {\n                count += startIndex;\n            }\n            if (startIndex === 0 && endIndex === inline.length) {\n                paragraph.firstChild.children.splice(insertIndex, 0, inline);\n                inline.line = paragraph.firstChild;\n                insertIndex++;\n                // if (editAction < 4) {\n                // this.unLinkFieldCharacter(inline);\n                lineWidget.children.splice(i, 1);\n                i--;\n                // }\n            }\n            else if (inline instanceof TextElementBox) {\n                // if (editAction < 4) {\n                var span = new TextElementBox();\n                span.characterFormat.copyFormat(inline.characterFormat);\n                span.text = inline.text.substr(startIndex, endIndex - startIndex);\n                paragraph.firstChild.children.splice(insertIndex, 0, span);\n                span.line = paragraph.firstChild;\n                insertIndex++;\n                inline.text = inline.text.slice(0, startIndex) + inline.text.slice(endIndex);\n            }\n            if (endOffset <= count + endIndex - startIndex) {\n                break;\n            }\n            count += endIndex - startIndex;\n        }\n        return insertIndex;\n    };\n    /**\n     * update complex changes when history is not preserved\n     * @param  {number} action?\n     * @param  {string} start?\n     * @param  {string} end?\n     * @private\n     */\n    Editor.prototype.updateComplexWithoutHistory = function (action, start, end) {\n        var selection = this.viewer.selection;\n        if (action === 0) {\n            var startPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(startPosition, start);\n            this.viewer.layout.reLayoutParagraph(startPosition.paragraph, 0, 0);\n            this.setPositionForCurrentIndex(selection.start, end);\n            this.setPositionForCurrentIndex(selection.end, end);\n        }\n        if (action === 1) {\n            var startPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(startPosition, start);\n            var endPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(endPosition, end);\n            this.viewer.layout.reLayoutParagraph(startPosition.paragraph, 0, 0);\n            if (endPosition.paragraph !== startPosition.paragraph) {\n                this.viewer.layout.reLayoutParagraph(endPosition.paragraph, 0, 0);\n            }\n        }\n        if (selection.owner.isShiftingEnabled) {\n            this.viewer.layout.shiftLayoutedItems();\n            if (this.viewer.owner.enableHeaderAndFooter) {\n                this.updateHeaderFooterWidget();\n            }\n        }\n        selection.owner.isShiftingEnabled = false;\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            selection.end.updatePhysicalPosition(true);\n        }\n        selection.upDownSelectionLength = selection.end.location.x;\n        selection.fireSelectionChanged(true);\n        this.viewer.updateFocus();\n        this.viewer.updateScrollBars();\n        this.fireContentChange();\n        this.isHandledComplex = true;\n    };\n    /**\n     * reLayout\n     * @param selection\n     * @param isSelectionChanged\n     * @private\n     */\n    Editor.prototype.reLayout = function (selection, isSelectionChanged) {\n        if (!this.viewer.isComposingIME && this.editorHistory && this.editorHistory.isHandledComplexHistory()) {\n            if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n                || (this.editorHistory.currentBaseHistoryInfo\n                    && !(this.editorHistory.currentBaseHistoryInfo.action === 'ClearCharacterFormat'\n                        || this.editorHistory.currentBaseHistoryInfo.action === 'ClearParagraphFormat'))) {\n                this.startParagraph = undefined;\n                this.endParagraph = undefined;\n            }\n            this.isHandledComplex = false;\n            return;\n        }\n        if (isNullOrUndefined(this.viewer.blockToShift)) {\n            this.viewer.removeEmptyPages();\n            this.viewer.layout.updateFieldElements();\n            this.viewer.updateScrollBars();\n            if (!selection.owner.isShiftingEnabled) {\n                selection.fireSelectionChanged(true);\n                this.startParagraph = undefined;\n                this.endParagraph = undefined;\n            }\n        }\n        if (isNullOrUndefined(isSelectionChanged)) {\n            isSelectionChanged = selection.isEmpty;\n        }\n        if (selection.owner.isShiftingEnabled) {\n            selection.owner.isShiftingEnabled = false;\n            selection.owner.isLayoutEnabled = true;\n            this.viewer.layout.shiftLayoutedItems();\n            if (this.viewer.owner.enableHeaderAndFooter) {\n                this.updateHeaderFooterWidget();\n            }\n            this.getOffsetValue(selection);\n            selection.upDownSelectionLength = selection.end.location.x;\n            selection.fireSelectionChanged(true);\n            this.viewer.updateFocus();\n            this.startParagraph = undefined;\n            this.endParagraph = undefined;\n            this.viewer.layout.allowLayout = true;\n        }\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo &&\n            ((this.editorHistory.currentBaseHistoryInfo.action !== 'RowResizing'\n                && this.editorHistory.currentBaseHistoryInfo.action !== 'CellResizing')\n                || (this.editorHistory.isUndoing || this.editorHistory.isRedoing))) {\n            if (this.editorHistory.currentBaseHistoryInfo.modifiedProperties.length > 0) {\n                this.editorHistory.currentBaseHistoryInfo.updateSelection();\n            }\n            this.editorHistory.updateHistory();\n        }\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHeaderFooterWidget = function () {\n        this.updateHeaderFooterWidgetToPage(this.selection.start.paragraph.bodyWidget);\n        var headerFooterWidget = this.selection.start.paragraph.bodyWidget;\n        this.shiftPageContent(headerFooterWidget.headerFooterType, headerFooterWidget.sectionFormat);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHeaderFooterWidgetToPage = function (node) {\n        var currentPage = node.page;\n        node = this.viewer.layout.updateHeaderFooterToParent(node);\n        var isEvenPage = (node.headerFooterType === 'EvenHeader' || node.headerFooterType === 'EvenFooter');\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var page = this.viewer.pages[i];\n            if ((i + 1 === 1) && page.bodyWidgets[0].sectionFormat.differentFirstPage &&\n                node.headerFooterType.indexOf('FirstPage') !== -1) {\n                return;\n            }\n            if (page.index === 0 && page.bodyWidgets[0].sectionFormat.differentFirstPage &&\n                node.headerFooterType.indexOf('FirstPage') === -1) {\n                continue;\n            }\n            if (currentPage !== page) {\n                if (page.bodyWidgets[0].sectionFormat.differentOddAndEvenPages) {\n                    if (isEvenPage && (i + 1) % 2 === 0) {\n                        this.updateHeaderFooterWidgetToPageInternal(page, node, node.headerFooterType.indexOf('Header') !== -1);\n                    }\n                    else if ((!isEvenPage && (i + 1) % 2 !== 0)) {\n                        if (page.bodyWidgets[0].sectionFormat.differentFirstPage && (i + 1 !== 1)) {\n                            this.updateHeaderFooterWidgetToPageInternal(page, node, node.headerFooterType.indexOf('Header') !== -1);\n                        }\n                    }\n                }\n                else {\n                    this.updateHeaderFooterWidgetToPageInternal(page, node, node.headerFooterType.indexOf('Header') !== -1);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHeaderFooterWidgetToPageInternal = function (page, widget, isHeader) {\n        if (widget.page !== page) {\n            var hfWidget = widget.clone();\n            hfWidget.page = page;\n            this.viewer.updateHFClientArea(hfWidget.sectionFormat, isHeader);\n            hfWidget = this.viewer.layout.layoutHeaderFooterItems(this.viewer, hfWidget);\n            var headerOrFooter = void 0;\n            if (isHeader) {\n                headerOrFooter = page.headerWidget;\n                page.headerWidget = hfWidget;\n            }\n            else {\n                headerOrFooter = page.footerWidget;\n                page.footerWidget = hfWidget;\n            }\n            this.removeFieldInWidget(headerOrFooter);\n            headerOrFooter.destroy();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeFieldInWidget = function (widget) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            this.removeFieldInBlock(widget.childWidgets[i]);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeFieldInBlock = function (block) {\n        if (block instanceof TableWidget) {\n            this.removeFieldTable(block);\n        }\n        else {\n            this.removeField(block);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeFieldTable = function (table) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.removeFieldInWidget(row.childWidgets[j]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.shiftPageContent = function (type, sectionFormat) {\n        // let type: HeaderFooterType = headerFooter.headerFooterType;\n        var pageIndex;\n        if (type.indexOf('First') !== -1) {\n            pageIndex = 0;\n        }\n        else if (sectionFormat.differentOddAndEvenPages) {\n            var isEven = type.indexOf('Even') !== -1;\n            if (sectionFormat.differentFirstPage) {\n                pageIndex = isEven ? 1 : 2;\n            }\n            else {\n                pageIndex = !isEven ? 0 : 1;\n            }\n        }\n        else {\n            pageIndex = sectionFormat.differentFirstPage ? 1 : 0;\n            if (pageIndex === 1 && this.viewer.pages.length === 1) {\n                pageIndex = 0;\n            }\n        }\n        var section = this.viewer.pages[pageIndex].bodyWidgets[0];\n        do {\n            if (type.indexOf('Header') !== -1) {\n                var widget = section.page.headerWidget;\n                var isNotEmpty = !widget.isEmpty || widget.isEmpty && this.owner.enableHeaderAndFooter;\n                var firstBlock = section.firstChild;\n                var top_1 = HelperMethods.convertPointToPixel(sectionFormat.topMargin);\n                var headerDistance = HelperMethods.convertPointToPixel(sectionFormat.headerDistance);\n                if (isNotEmpty) {\n                    top_1 = Math.max(headerDistance + section.page.headerWidget.height, top_1);\n                }\n                if (firstBlock.y !== top_1) {\n                    this.viewer.updateClientArea(section.sectionFormat, section.page);\n                    firstBlock = firstBlock.combineWidget(this.viewer);\n                    var prevWidget = firstBlock.previousRenderedWidget;\n                    if (prevWidget) {\n                        if (firstBlock.containerWidget.equals(prevWidget.containerWidget)) {\n                            this.viewer.cutFromTop(prevWidget.y + prevWidget.height);\n                            // tslint:disable-next-line:max-line-length\n                            this.viewer.layout.updateContainerWidget(firstBlock, prevWidget.containerWidget, prevWidget.indexInOwner + 1, false);\n                        }\n                    }\n                    this.viewer.blockToShift = firstBlock;\n                }\n            }\n            else {\n                this.checkAndShiftFromBottom(section.page, section.page.footerWidget);\n            }\n            if (this.viewer.blockToShift) {\n                this.viewer.renderedLists.clear();\n                this.viewer.layout.shiftLayoutedItems();\n            }\n            while (section) {\n                var splittedSection = section.getSplitWidgets();\n                section = splittedSection[splittedSection.length - 1].nextRenderedWidget;\n                if (section) {\n                    if (pageIndex === 0) {\n                        break;\n                    }\n                    else {\n                        if (section.page.index + 1 % 2 === 0 && pageIndex === 1 ||\n                            (section.page.index + 1 % 2 !== 0 && pageIndex === 2)) {\n                            break;\n                        }\n                        var nextPage = section.page.nextPage;\n                        if (nextPage.bodyWidgets[0].equals(section)) {\n                            section = nextPage.bodyWidgets[0];\n                            break;\n                        }\n                    }\n                }\n            }\n        } while (section);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.checkAndShiftFromBottom = function (page, footerWidget) {\n        var bodyWidget = page.bodyWidgets[0];\n        var blockToShift;\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var block = bodyWidget.childWidgets[i];\n            if (block.y + block.height > footerWidget.y) {\n                blockToShift = block;\n                break;\n            }\n            if (bodyWidget.childWidgets.length - 1 === i && block.y + block.height < footerWidget.y) {\n                blockToShift = block;\n                break;\n            }\n        }\n        this.viewer.updateClientArea(bodyWidget.sectionFormat, page);\n        this.viewer.cutFromTop(blockToShift.y);\n        this.viewer.blockToShift = blockToShift;\n    };\n    //Paste Implementation ends\n    //Character Format apply implementation starts\n    /**\n     * Change HighlightColor\n     * @param  {HighlightColor} highlightColor\n     * Applies character format for selection.\n     * @param {string} property\n     * @param {Object} value\n     * @param {boolean} update\n     * @private\n     */\n    Editor.prototype.onApplyCharacterFormat = function (property, value, update) {\n        this.viewer.layout.isBidiReLayout = true;\n        var selection = this.viewer.selection;\n        if (selection.owner.isReadOnlyMode || !selection.owner.isDocumentLoaded) {\n            return;\n        }\n        update = isNullOrUndefined(update) ? false : update;\n        var action = (property[0].toUpperCase() + property.slice(1));\n        var paragraph = selection.start.paragraph;\n        var lastLine = paragraph.childWidgets[paragraph.childWidgets.length - 1];\n        if (selection.isEmpty && selection.contextType !== 'List') {\n            selection.skipFormatRetrieval = true;\n            if (selection.end.isAtParagraphEnd) {\n                this.initHistory(action);\n                this.viewer.owner.isShiftingEnabled = true;\n                this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n                this.reLayout(this.viewer.selection);\n                this.viewer.updateFocus();\n            }\n            else {\n                selection.fireSelectionChanged(true);\n            }\n            selection.skipFormatRetrieval = false;\n            return;\n        }\n        this.setOffsetValue(selection);\n        this.initHistory(action);\n        // Todo: Complete Microsoft Word behavior on apply formatting in empty selection\n        // if (selection.isEmpty) {\n        //     this.viewer.owner.isShiftingEnabled = true;\n        //     this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n        //     this.reLayout(this.viewer.selection);\n        //     this.viewer.updateFocus();\n        //     return;\n        // }\n        if (selection.contextType === 'List') {\n            // this.updateCharacterFormatForListText(selection, action, value, update);\n            this.applyCharacterFormatForListText(selection, property, value, update);\n        }\n        else {\n            //Iterate and update format.\n            this.updateSelectionCharacterFormatting(property, value, update);\n        }\n        this.viewer.layout.isBidiReLayout = false;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharacterFormatForListText = function (selection, property, values, update) {\n        var listLevel = this.getListLevel(selection.start.paragraph);\n        if (isNullOrUndefined(listLevel)) {\n            return;\n        }\n        var characterFormat = listLevel.characterFormat;\n        switch (property) {\n            case 'bold':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'bold', !(characterFormat.bold));\n                break;\n            case 'italic':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'italic', !(characterFormat.italic));\n                break;\n            case 'fontColor':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'fontColor', values);\n                break;\n            case 'fontFamily':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'fontFamily', values);\n                break;\n            case 'fontSize':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'fontSize', values);\n                break;\n            case 'highlightColor':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'highlightColor', values);\n                break;\n            case 'baselineAlignment':\n                if (characterFormat.baselineAlignment === values) {\n                    values = 'Normal';\n                }\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'baselineAlignment', values);\n                break;\n            case 'strikethrough':\n                if (characterFormat.strikethrough === values) {\n                    values = 'None';\n                }\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'strikethrough', values);\n                break;\n            case 'underline':\n                if (characterFormat.underline === values) {\n                    values = 'None';\n                }\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'underline', values);\n                break;\n            case 'characterFormat':\n                this.applyListCharacterFormatByValue(selection, characterFormat, undefined, values);\n                break;\n        }\n    };\n    Editor.prototype.applyListCharacterFormatByValue = function (selection, format, property, value) {\n        this.initHistory('ListCharacterFormat');\n        this.applyCharFormatValue(format, property, value, false);\n        this.editorHistory.updateHistory();\n        this.reLayout(selection);\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateListCharacterFormat = function (selection, property, value) {\n        this.updateListTextSelRange(selection, property, value, false);\n    };\n    Editor.prototype.updateListTextSelRange = function (selection, property, value, update) {\n        this.viewer.owner.isShiftingEnabled = true;\n        var startPositionInternal = selection.start;\n        var endPositionInternal = selection.end;\n        if (!selection.isForward) {\n            startPositionInternal = selection.end;\n            endPositionInternal = selection.start;\n        }\n        this.initHistoryPosition(selection, startPositionInternal);\n        var listLevel = this.getListLevel(selection.start.paragraph);\n        this.applyCharFormatValue(listLevel.characterFormat, property, value, update);\n        this.startSelectionReLayouting(startPositionInternal.paragraph, selection, startPositionInternal, endPositionInternal);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getListLevel = function (paragraph) {\n        var currentList = undefined;\n        var listLevelNumber = 0;\n        if (!isNullOrUndefined(paragraph.paragraphFormat) && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n            currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n            listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n        }\n        if (!isNullOrUndefined(currentList) &&\n            !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId))\n            // && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels.getItem(listLevelNumber))) {\n            && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels)) {\n            return this.viewer.layout.getListLevel(currentList, listLevelNumber);\n        }\n        return undefined;\n    };\n    Editor.prototype.updateInsertPosition = function () {\n        var selection = this.viewer.selection;\n        var position = selection.start;\n        if (!selection.isForward) {\n            position = selection.end;\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n            && !isNullOrUndefined(position)) {\n            if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)) {\n                this.updateHistoryPosition(position, true);\n            }\n        }\n    };\n    /**\n     * preserve paragraph and offset value for selection\n     * @private\n     */\n    Editor.prototype.setOffsetValue = function (selection) {\n        var info = this.getParagraphInfo(selection.start);\n        this.startParagraph = info.paragraph;\n        this.startOffset = info.offset;\n        info = this.getParagraphInfo(selection.end);\n        this.endParagraph = info.paragraph;\n        this.endOffset = info.offset;\n    };\n    /**\n     * Toggles the highlight color property of selected contents.\n     * @param {HighlightColor} highlightColor Default value of ‘underline’ parameter is Yellow.\n     */\n    Editor.prototype.toggleHighlightColor = function (highlightColor) {\n        var selection = this.viewer.selection;\n        if (isNullOrUndefined(highlightColor) || highlightColor === 'NoColor') {\n            highlightColor = 'Yellow';\n        }\n        //In Ms Word the highlight color is took from the ribbon. So we Have given yellow as constant.\n        if (selection.characterFormat.highlightColor === highlightColor) {\n            highlightColor = 'NoColor';\n        }\n        this.selection.characterFormat.highlightColor = highlightColor;\n    };\n    /**\n     * Toggles the subscript formatting of selected contents.\n     */\n    Editor.prototype.toggleSubscript = function () {\n        if (!this.owner.isReadOnlyMode) {\n            var value = this.selection.characterFormat.baselineAlignment === 'Subscript' ? 'Normal' : 'Subscript';\n            this.selection.characterFormat.baselineAlignment = value;\n        }\n    };\n    /**\n     * Toggles the superscript formatting of selected contents.\n     */\n    Editor.prototype.toggleSuperscript = function () {\n        if (!this.owner.isReadOnlyMode) {\n            var value = this.selection.characterFormat.baselineAlignment === 'Superscript' ? 'Normal' : 'Superscript';\n            this.selection.characterFormat.baselineAlignment = value;\n        }\n    };\n    /**\n     * Toggles the text alignment property of selected contents.\n     * @param {TextAlignment} textAlignment Default value of ‘textAlignment parameter is TextAlignment.Left.\n     */\n    /**\n     * Increases the left indent of selected paragraphs to a factor of 36 points.\n     */\n    Editor.prototype.increaseIndent = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.onApplyParagraphFormat('leftIndent', this.viewer.defaultTabWidth, true, false);\n        }\n    };\n    /**\n     * Decreases the left indent of selected paragraphs to a factor of 36 points.\n     */\n    Editor.prototype.decreaseIndent = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.onApplyParagraphFormat('leftIndent', -this.viewer.defaultTabWidth, true, false);\n        }\n    };\n    /**\n     * Clears the list format for selected paragraphs.\n     */\n    Editor.prototype.clearList = function () {\n        this.selection.owner.editorModule.onApplyList(undefined);\n    };\n    /**\n     * Applies the bullet list to selected paragraphs.\n     * @param {string} bullet Bullet character\n     * @param {string} fontFamily Bullet font family\n     */\n    Editor.prototype.applyBullet = function (bullet, fontFamily) {\n        if (!this.owner.isReadOnlyMode) {\n            this.applyBulletOrNumbering(bullet, 'Bullet', fontFamily);\n        }\n    };\n    /**\n     * Applies the numbering list to selected paragraphs.\n     * @param numberFormat  “%n” representations in ‘numberFormat’ parameter will be replaced by respective list level’s value.\n     * `“%1)” will be displayed as “1)” `\n     * @param listLevelPattern  Default value of ‘listLevelPattern’ parameter is ListLevelPattern.Arabic\n     */\n    Editor.prototype.applyNumbering = function (numberFormat, listLevelPattern) {\n        if (!this.owner.isReadOnlyMode) {\n            this.applyBulletOrNumbering(numberFormat, listLevelPattern, 'Verdana');\n        }\n    };\n    /**\n     * Toggles the baseline alignment property of selected contents.\n     * @param  {Selection} selection\n     * @param  {BaselineAlignment} baseAlignment\n     */\n    Editor.prototype.toggleBaselineAlignment = function (baseAlignment) {\n        this.updateProperty(2, baseAlignment);\n    };\n    /**\n     * Clears the formatting.\n     */\n    Editor.prototype.clearFormatting = function () {\n        var selection = this.viewer.selection;\n        this.initComplexHistory('ClearFormat');\n        // let startIndex: string = selection.start.getHierarchicalIndexInternal();\n        // let endIndex: string = selection.end.getHierarchicalIndexInternal();\n        if (selection.isEmpty) {\n            selection.start.moveToParagraphStartInternal(selection, false);\n            selection.end.moveToParagraphEndInternal(selection, false);\n        }\n        this.setOffsetValue(selection);\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ClearCharacterFormat');\n        }\n        this.updateSelectionCharacterFormatting('ClearCharacterFormat', undefined, false);\n        this.getOffsetValue(selection);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.setOffsetValue(selection);\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ClearParagraphFormat');\n        }\n        this.updateParagraphFormatInternal('ClearParagraphFormat', undefined, false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.getOffsetValue(selection);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n            this.editorHistory.updateComplexHistory();\n        }\n        this.startParagraph = undefined;\n        this.endParagraph = undefined;\n        // else {\n        //     this.checkAndUpdatedSelection(startIndex, endIndex);\n        // }\n    };\n    /**\n     * Toggles the specified property. If property is assigned already. Then property will be changed\n     * @param  {Selection} selection\n     * @param  {number} type\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.updateProperty = function (type, value) {\n        var selection = this.selection;\n        if (selection.owner.isReadOnlyMode || !selection.owner.isDocumentLoaded) {\n            return;\n        }\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        var indexInInline = 0;\n        var inlineObj = startPosition.currentWidget.getInline(startPosition.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        var paragraph = startPosition.paragraph;\n        if (!isNullOrUndefined(inline) && inline.length === indexInInline && !this.selection.isEmpty) {\n            inline = inline.nextNode;\n        }\n        if (type === 1) {\n            var currentUnderline = 'None';\n            if (!isNullOrUndefined(inline)) {\n                currentUnderline = inline.characterFormat.underline;\n            }\n            else if (!isNullOrUndefined(paragraph)) {\n                currentUnderline = paragraph.characterFormat.underline;\n            }\n            this.selection.characterFormat.underline = value === currentUnderline ? 'None' : value;\n        }\n        else {\n            var script = 'Normal';\n            if (!isNullOrUndefined(inline)) {\n                script = inline.characterFormat.baselineAlignment;\n            }\n            else if (!isNullOrUndefined(paragraph)) {\n                script = paragraph.characterFormat.baselineAlignment;\n            }\n            if (script === value) {\n                value = 'Normal';\n            }\n            this.selection.characterFormat.baselineAlignment = value;\n        }\n    };\n    Editor.prototype.getCompleteStyles = function () {\n        var completeStylesString = '{\"styles\":[';\n        for (var _i = 0, _a = this.viewer.preDefinedStyles.keys; _i < _a.length; _i++) {\n            var name_1 = _a[_i];\n            completeStylesString += (this.viewer.preDefinedStyles.get(name_1) + ',');\n        }\n        return completeStylesString.slice(0, -1) + ']}';\n    };\n    /**\n     * Initialize default styles\n     * @private\n     */\n    Editor.prototype.intializeDefaultStyles = function () {\n        var existingStyles = this.owner.getStyleNames('Paragraph');\n        var defaultStyleNames = ['Normal', 'Heading 1', 'Heading 2', 'Heading 3', 'Heading 4', 'Heading 5', 'Heading 6'];\n        var styleNames = defaultStyleNames.filter(function (val) {\n            return existingStyles.indexOf(val) === -1;\n        });\n        for (var _i = 0, styleNames_1 = styleNames; _i < styleNames_1.length; _i++) {\n            var name_2 = styleNames_1[_i];\n            this.createStyle(this.viewer.preDefinedStyles.get(name_2));\n        }\n    };\n    /**\n     * Creates a new instance of Style.\n     */\n    Editor.prototype.createStyle = function (styleString) {\n        this.createStyleIn(styleString);\n    };\n    /**\n     * Create a Style.\n     * @private\n     */\n    Editor.prototype.createStyleIn = function (styleString) {\n        /* tslint:disable:no-any */\n        var style = JSON.parse(styleString);\n        var styleObj = this.viewer.styles.findByName(style.name);\n        if (styleObj !== undefined) {\n            //Create a new style with new name and add it to collection.\n            style.name = this.getUniqueStyleName(style.name);\n        }\n        this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()), style, this.viewer.styles);\n        return this.viewer.styles.findByName(style.name);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getUniqueStyleName = function (name) {\n        var uniqueName = this.getUniqueName(name);\n        var style = this.viewer.styles.findByName(uniqueName);\n        while (!isNullOrUndefined(style)) {\n            uniqueName = this.getUniqueStyleName(style.name);\n            style = this.viewer.styles.findByName(uniqueName);\n        }\n        return uniqueName;\n    };\n    Editor.prototype.getUniqueName = function (name) {\n        var matchArray = name.match(/\\d+$/);\n        var returnName;\n        if (!isNullOrUndefined(matchArray) && matchArray.length > 0) {\n            return name.replace(matchArray[0], (parseInt(matchArray[0], 10) + 1).toString());\n        }\n        else {\n            return name + '_1';\n        }\n    };\n    /**\n     * Update Character format for selection\n     * @private\n     */\n    Editor.prototype.updateSelectionCharacterFormatting = function (property, values, update) {\n        if (isNullOrUndefined(property)) {\n            property = 'CharacterFormat';\n        }\n        switch (property) {\n            case 'bold':\n                this.updateCharacterFormat('bold', values);\n                break;\n            case 'italic':\n                this.updateCharacterFormat('italic', values);\n                break;\n            case 'fontColor':\n                this.updateCharacterFormat('fontColor', values);\n                break;\n            case 'fontFamily':\n                this.updateCharacterFormat('fontFamily', values);\n                break;\n            case 'fontSize':\n                this.viewer.layout.isBidiReLayout = false;\n                this.updateCharacterFormatWithUpdate(this.viewer.selection, 'fontSize', values, update);\n                break;\n            case 'highlightColor':\n                this.updateCharacterFormat('highlightColor', values);\n                break;\n            case 'baselineAlignment':\n                this.updateCharacterFormat('baselineAlignment', values);\n                break;\n            case 'strikethrough':\n                this.updateCharacterFormat('strikethrough', values);\n                break;\n            case 'underline':\n                this.updateCharacterFormat('underline', values);\n                break;\n            case 'styleName':\n                this.updateCharacterFormatWithUpdate(this.viewer.selection, 'styleName', values, true);\n                break;\n            case 'CharacterFormat':\n                this.updateCharacterFormat(undefined, values);\n                break;\n            case 'ClearCharacterFormat':\n                this.updateCharacterFormat(undefined, values);\n                break;\n        }\n        this.reLayout(this.viewer.selection);\n    };\n    /**\n     * Update character format for selection range\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @returns void\n     * @private\n     */\n    Editor.prototype.updateCharacterFormat = function (property, value) {\n        this.updateCharacterFormatWithUpdate(this.viewer.selection, property, value, false);\n    };\n    Editor.prototype.updateCharacterFormatWithUpdate = function (selection, property, value, update) {\n        this.viewer.owner.isShiftingEnabled = true;\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        this.applyCharFormatSelectedContent(startPosition.paragraph, selection, startPosition, endPosition, property, value, update);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatSelectedContent = function (paragraph, selection, start, end, property, value, update) {\n        //Selection start in cell.\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || selection.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            var cell = void 0;\n            start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(start, true);\n            }\n            cell = start.paragraph.associatedCell;\n            this.applyCharFormatCell(cell, selection, start, end, property, value, update);\n            var table = cell.ownerTable;\n            // tslint:disable-next-line:max-line-length\n            this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        }\n        else {\n            this.applyCharFormat(paragraph, selection, start, end, property, value, update);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForSelectedPara = function (paragraph, selection, property, value, update) {\n        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n            var line = paragraph.childWidgets[i];\n            for (var j = 0; j < line.children.length; j++) {\n                var element = line.children[j];\n                this.applyCharFormatValue(element.characterFormat, property, value, update);\n            }\n        }\n        this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n    };\n    Editor.prototype.splittedLastParagraph = function (paragraph) {\n        var splittedWidets = paragraph.getSplitWidgets();\n        return splittedWidets[splittedWidets.length - 1];\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.getNextParagraphForCharacterFormatting = function (block, start, end, property, value, update) {\n        var widgetCollection = block.getSplitWidgets();\n        block = widgetCollection[widgetCollection.length - 1];\n        block = this.viewer.selection.getNextRenderedBlock(block);\n        if (!isNullOrUndefined(block)) { //Goto the next block.\n            if (block instanceof ParagraphWidget) {\n                this.applyCharFormat(block, this.viewer.selection, start, end, property, value, update);\n            }\n            else {\n                this.applyCharFormatForTable(0, block, this.viewer.selection, start, end, property, value, update);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormat = function (paragraph, selection, start, end, property, value, update) {\n        paragraph = paragraph.combineWidget(this.viewer);\n        var startOffset = 0;\n        var length = selection.getParagraphLength(paragraph);\n        var startLineWidget = paragraph.childWidgets.indexOf(start.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(start.currentWidget) : 0;\n        var endOffset = end.offset;\n        var endLineWidget = paragraph.childWidgets.indexOf(end.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(end.currentWidget) : paragraph.childWidgets.length - 1;\n        if (!isNullOrUndefined(selection)) {\n            if (paragraph === start.paragraph) {\n                startOffset = start.offset;\n            }\n        }\n        if (!paragraph.equals(end.paragraph)) {\n            this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n            endOffset = length;\n        }\n        else {\n            var lastLine = paragraph.childWidgets[paragraph.childWidgets.length - 1];\n            if (selection.isParagraphLastLine(lastLine) && end.currentWidget === lastLine\n                && ((endOffset === selection.getLineLength(lastLine) + 1) || (selection.isEmpty && selection.end.isAtParagraphEnd))) {\n                this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n            }\n        }\n        // let count: number = 0;\n        for (var i = startLineWidget; i <= endLineWidget; i++) {\n            var line = paragraph.childWidgets[i];\n            if (i !== startLineWidget) {\n                startOffset = selection.getStartLineOffset(line);\n            }\n            if (line === end.currentWidget) {\n                endOffset = end.offset;\n            }\n            else {\n                endOffset = selection.getLineLength(line);\n            }\n            var count = 0;\n            for (var j = 0; j < line.children.length; j++) {\n                var inlineObj = line.children[j];\n                if (inlineObj instanceof ListTextElementBox) {\n                    continue;\n                }\n                if (startOffset >= count + inlineObj.length) {\n                    count += inlineObj.length;\n                    continue;\n                }\n                var startIndex = 0;\n                if (startOffset > count) {\n                    startIndex = startOffset - count;\n                }\n                var endIndex = endOffset - count;\n                var inlineLength = inlineObj.length;\n                if (endIndex > inlineLength) {\n                    endIndex = inlineLength;\n                }\n                j += this.applyCharFormatInline(inlineObj, selection, startIndex, endIndex, property, value, update);\n                if (endOffset <= count + inlineLength) {\n                    break;\n                }\n                count += inlineLength;\n            }\n        }\n        var endParagraph = end.paragraph;\n        this.viewer.layout.reLayoutParagraph(paragraph, startLineWidget, 0);\n        if (paragraph.equals(endParagraph)) {\n            return;\n        }\n        this.getNextParagraphForCharacterFormatting(paragraph, start, end, property, value, update);\n    };\n    /**\n     * Toggles the bold property of selected contents.\n     */\n    Editor.prototype.toggleBold = function () {\n        if (this.viewer.owner.isReadOnlyMode) {\n            return;\n        }\n        var value = this.getCurrentSelectionValue('bold');\n        this.selection.characterFormat.bold = value;\n    };\n    /**\n     * Toggles the bold property of selected contents.\n     */\n    Editor.prototype.toggleItalic = function () {\n        if (this.viewer.owner.isReadOnlyMode) {\n            return;\n        }\n        var value = this.getCurrentSelectionValue('italic');\n        this.selection.characterFormat.italic = value;\n    };\n    Editor.prototype.getCurrentSelectionValue = function (property) {\n        var value = false;\n        if ((property === 'bold' || property === 'italic')) {\n            var index = 0;\n            var start = this.selection.start;\n            if (!this.selection.isForward) {\n                start = this.selection.end;\n            }\n            var lineWidget = start.currentWidget;\n            var inlineObj = lineWidget.getInline(start.offset, index);\n            var inline = inlineObj.element;\n            // inline.ownerBase\n            index = inlineObj.index;\n            var characterFormat = lineWidget.paragraph.characterFormat;\n            if (!isNullOrUndefined(inline)) {\n                if (!this.selection.isEmpty && index === inline.length) {\n                    characterFormat = isNullOrUndefined(inline.nextNode) ? lineWidget.paragraph.characterFormat\n                        : inline.nextNode.characterFormat;\n                }\n                else {\n                    characterFormat = inline.characterFormat;\n                }\n            }\n            if (property === 'bold') {\n                value = !(characterFormat.bold);\n            }\n            if (property === 'italic') {\n                value = !(characterFormat.italic);\n            }\n        }\n        return value;\n    };\n    /**\n     * Toggles the underline property of selected contents.\n     * @param underline Default value of ‘underline’ parameter is Single.\n     */\n    Editor.prototype.toggleUnderline = function (underline) {\n        if (!this.owner.isReadOnlyMode) {\n            this.updateProperty(1, underline);\n        }\n    };\n    /**\n     * Toggles the strike through property of selected contents.\n     * @param {Strikethrough} strikethrough Default value of strikethrough parameter is SingleStrike.\n     */\n    Editor.prototype.toggleStrikethrough = function (strikethrough) {\n        if (!this.owner.isReadOnlyMode) {\n            var value = void 0;\n            if (isNullOrUndefined(strikethrough)) {\n                value = this.selection.characterFormat.strikethrough === 'SingleStrike' ? 'None' : 'SingleStrike';\n            }\n            else {\n                value = strikethrough;\n            }\n            this.selection.characterFormat.strikethrough = value;\n        }\n    };\n    Editor.prototype.updateFontSize = function (format, value) {\n        if (typeof (value) === 'number' && !(value < 0 && format.fontSize === 1)) {\n            return format.fontSize + value;\n        }\n        var fontsizeCollection = [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 26, 28, 36, 48, 72];\n        if (typeof (value) === 'string' && value === 'increment') {\n            if (format.fontSize < 8) {\n                return format.fontSize + 1;\n            }\n            else if (format.fontSize >= 72 && format.fontSize < 80) {\n                return 80;\n            }\n            else if (format.fontSize >= 80) {\n                return format.fontSize + 10;\n            }\n            else {\n                for (var i = 0; i < fontsizeCollection.length; i++) {\n                    if (format.fontSize < fontsizeCollection[i]) {\n                        return fontsizeCollection[i];\n                    }\n                }\n            }\n        }\n        else if (typeof (value) === 'string' && value === 'decrement' && format.fontSize > 1) {\n            if (format.fontSize <= 8) {\n                return format.fontSize - 1;\n            }\n            else if (format.fontSize > 72 && format.fontSize <= 80) {\n                return 72;\n            }\n            else if (format.fontSize > 80) {\n                return format.fontSize - 10;\n            }\n            else {\n                for (var i = 0; i < fontsizeCollection.length; i++) {\n                    if (format.fontSize <= fontsizeCollection[i]) {\n                        return fontsizeCollection[i - 1];\n                    }\n                }\n            }\n        }\n        return format.fontSize;\n    };\n    // Inline\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatInline = function (inline, selection, startIndex, endIndex, property, value, update) {\n        if (startIndex === 0 && endIndex === inline.length) {\n            this.applyCharFormatValue(inline.characterFormat, property, value, update);\n            return 0;\n        }\n        else if (inline instanceof TextElementBox) {\n            return this.formatInline(inline, selection, startIndex, endIndex, property, value, update);\n        }\n        return 0;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.formatInline = function (inline, selection, startIndex, endIndex, property, value, update) {\n        var x = 0;\n        var node = inline;\n        var index = inline.line.children.indexOf(node);\n        var paragraph = inline.paragraph;\n        var lineIndex = paragraph.childWidgets.indexOf(inline.line);\n        var textElement;\n        if (startIndex > 0) {\n            textElement = new TextElementBox();\n            textElement.characterFormat.copyFormat(inline.characterFormat);\n            textElement.line = inline.line;\n            textElement.text = inline.text.substr(startIndex, endIndex - startIndex);\n            this.applyCharFormatValue(textElement.characterFormat, property, value, update);\n            index++;\n            node.line.children.splice(index, 0, textElement);\n            x++;\n            // this.addToLinkedFields(span);                      \n        }\n        if (endIndex < node.length) {\n            textElement = new TextElementBox();\n            textElement.characterFormat.copyFormat(inline.characterFormat);\n            textElement.text = node.text.substring(endIndex);\n            textElement.line = inline.line;\n            index++;\n            node.line.children.splice(index, 0, textElement);\n            x++;\n            // this.addToLinkedFields(span);                       \n        }\n        if (startIndex === 0) {\n            inline.text = inline.text.substr(0, endIndex);\n            this.applyCharFormatValue(inline.characterFormat, property, value, update);\n        }\n        else {\n            inline.text = inline.text.substr(0, startIndex);\n        }\n        return x;\n    };\n    // Cell\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatCell = function (cell, selection, start, end, property, value, update) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = selection.getContainerCellOf(cell, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = selection.getSelectedCell(cell, containerCell);\n                var endCell = selection.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (selection.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (selection.isCellSelected(containerCell, start, end)) {\n                        value = this.getCharacterFormatValueOfCell(cell, selection, value, property);\n                        this.applyCharFormatForSelectedCell(containerCell, selection, property, value, update);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.applyCharFormat(start.paragraph, selection, start, end, property, value, update);\n                        }\n                        else {\n                            this.applyCharFormatRow(startCell.ownerRow, selection, start, end, property, value, update);\n                        }\n                    }\n                }\n                else { //Format other selected cells in current table.\n                    this.applyCharFormatForTableCell(containerCell.ownerTable, selection, containerCell, endCell, property, value, update);\n                }\n            }\n            else {\n                this.applyCharFormatRow(containerCell.ownerRow, selection, start, end, property, value, update);\n            }\n        }\n        else {\n            var tableCell = selection.getContainerCell(cell);\n            this.applyCharFormatRow(tableCell.ownerRow, selection, start, end, property, value, update);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForSelectedCell = function (cell, selection, property, value, update) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            if (block instanceof ParagraphWidget) {\n                this.applyCharFormatForSelectedPara(block, selection, property, value, update);\n            }\n            else {\n                this.applyCharFormatForSelTable(block, selection, property, value, update);\n            }\n        }\n    };\n    // Row\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatRow = function (row, selection, start, end, property, value, update) {\n        value = this.getCharacterFormatValueOfCell(row.childWidgets[0], selection, value, property);\n        this.applyCharFormatForTable(row.rowIndex, row.ownerTable, selection, start, end, property, value, update);\n    };\n    // Table\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForTable = function (index, table, selection, start, end, property, value, update) {\n        table = table.combineWidget(this.viewer);\n        for (var i = index; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.applyCharFormatForSelectedCell(row.childWidgets[j], selection, property, value, update);\n            }\n            if (end.paragraph.isInsideTable && selection.containsRow(row, end.paragraph.associatedCell)) {\n                this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n                return;\n            }\n        }\n        this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        this.getNextParagraphForCharacterFormatting(table, start, end, property, value, update);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForSelTable = function (tableWidget, selection, property, value, update) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var row = tableWidget.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.applyCharFormatForSelectedCell(row.childWidgets[j], selection, property, value, update);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForTableCell = function (table, selection, startCell, endCell, property, value, update) {\n        var startCellLeft = selection.getCellLeft(startCell.ownerRow, startCell);\n        var startCellRight = startCellLeft + startCell.cellFormat.cellWidth;\n        var endCellLeft = selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(startCellLeft, startCellRight, endCellLeft, endCellRight);\n        startCellLeft = cellInfo.start;\n        startCellRight = cellInfo.end;\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var isStarted = false;\n        for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var left = selection.getCellLeft(row, row.childWidgets[j]);\n                if (HelperMethods.round(startCellLeft, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(startCellRight, 2)) {\n                    if (!isStarted) {\n                        value = this.getCharacterFormatValueOfCell(row.childWidgets[j], selection, value, property);\n                        isStarted = true;\n                    }\n                    this.applyCharFormatForSelectedCell(row.childWidgets[j], selection, property, value, update);\n                }\n            }\n        }\n    };\n    Editor.prototype.updateSelectedCellsInTable = function (start, end, endCellLeft, endCellRight) {\n        var selection = this.viewer.selection;\n        if (start > endCellLeft) {\n            start = endCellLeft;\n        }\n        if (end < endCellRight) {\n            end = endCellRight;\n        }\n        if (start > selection.upDownSelectionLength) {\n            start = selection.upDownSelectionLength;\n        }\n        if (end < selection.upDownSelectionLength) {\n            end = selection.upDownSelectionLength;\n        }\n        return { start: start, end: end };\n    };\n    Editor.prototype.getCharacterFormatValueOfCell = function (cell, selection, value, property) {\n        if (typeof (value) === 'boolean' || (value === undefined && (property === 'bold' || property === 'italic'))) {\n            var firstParagraph = selection.getFirstParagraph(cell);\n            var format = firstParagraph.characterFormat;\n            if (firstParagraph.childWidgets.length > 0 && firstParagraph.childWidgets[0].children.length > 0) {\n                format = firstParagraph.childWidgets[0].children[0].characterFormat;\n            }\n            value = !format.getPropertyValue(property);\n        }\n        return value;\n    };\n    /**\n     * Apply Character format for selection\n     * @private\n     */\n    Editor.prototype.applyCharFormatValueInternal = function (selection, format, property, value) {\n        this.applyCharFormatValue(format, property, value, false);\n    };\n    Editor.prototype.copyInlineCharacterFormat = function (sourceFormat, destFormat) {\n        destFormat.uniqueCharacterFormat = sourceFormat.uniqueCharacterFormat;\n        destFormat.baseCharStyle = sourceFormat.baseCharStyle;\n    };\n    Editor.prototype.applyCharFormatValue = function (format, property, value, update) {\n        if (update && property === 'fontSize') {\n            value = this.updateFontSize(format, value);\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedProperties(format, property, value);\n        }\n        if (value instanceof WCharacterFormat) {\n            if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n                this.copyInlineCharacterFormat(value, format);\n            }\n            else {\n                format.copyFormat(value);\n            }\n            return;\n        }\n        if (isNullOrUndefined(value)) {\n            format.clearFormat();\n            return;\n        }\n        if (property === 'bold') {\n            format.bold = value;\n        }\n        else if (property === 'italic') {\n            format.italic = value;\n        }\n        else if (property === 'fontColor') {\n            format.fontColor = value;\n        }\n        else if (property === 'fontFamily') {\n            format.fontFamily = value;\n        }\n        else if (property === 'fontSize') {\n            format.fontSize = value;\n        }\n        else if (property === 'highlightColor') {\n            format.highlightColor = value;\n        }\n        else if (property === 'baselineAlignment') {\n            format.baselineAlignment = value;\n        }\n        else if (property === 'strikethrough') {\n            format.strikethrough = value;\n        }\n        else if (property === 'underline') {\n            format.underline = value;\n        }\n        else if (property === 'styleName') {\n            format.baseCharStyle = value;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onImageFormat = function (elementBox, width, height) {\n        var modifiedFormat = new ImageFormat(elementBox);\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ImageResizing');\n            this.editorHistory.currentBaseHistoryInfo.modifiedProperties.push(modifiedFormat);\n        }\n        this.setOffsetValue(this.selection);\n        elementBox.width = width;\n        elementBox.height = height;\n        // tslint:disable-next-line:max-line-length\n        this.viewer.layout.reLayoutParagraph(elementBox.line.paragraph, elementBox.line.indexInOwner, 0);\n        this.reLayout(this.selection, false);\n        if (this.viewer.owner.imageResizerModule) {\n            this.viewer.owner.imageResizerModule.positionImageResizer(elementBox);\n        }\n    };\n    /**\n     * Toggles the text alignment of selected paragraphs.\n     * @param  {TextAlignment} textAlignment\n     */\n    Editor.prototype.toggleTextAlignment = function (textAlignment) {\n        if (this.viewer.owner.isReadOnlyMode || !this.viewer.owner.isDocumentLoaded) {\n            return;\n        }\n        // Toggle performed based on current selection format similar to MS word behavior.\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(this.viewer.selection.paragraphFormat.textAlignment) && this.viewer.selection.paragraphFormat.textAlignment === textAlignment) {\n            if (textAlignment === 'Left') {\n                this.onApplyParagraphFormat('textAlignment', 'Justify', false, true);\n            }\n            else {\n                this.onApplyParagraphFormat('textAlignment', 'Left', false, true);\n            }\n        }\n        else {\n            this.onApplyParagraphFormat('textAlignment', textAlignment, false, true);\n        }\n    };\n    /**\n     * Applies paragraph format for the selection ranges.\n     * @param {string} property\n     * @param {Object} value\n     * @param {boolean} update\n     * @param {boolean} isSelectionChanged\n     * @private\n     */\n    Editor.prototype.onApplyParagraphFormat = function (property, value, update, isSelectionChanged) {\n        var action = property === 'bidi' ? 'ParagraphBidi' : (property[0].toUpperCase() + property.slice(1));\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        this.initHistory(action);\n        if (this.viewer.owner.isReadOnlyMode || !this.viewer.owner.isDocumentLoaded) {\n            return;\n        }\n        if (property === 'leftIndent') {\n            if (selection.paragraphFormat.listId !== -1 && update) {\n                this.updateListLevel(value > 0);\n                return;\n            }\n        }\n        if (selection.isEmpty) {\n            this.setOffsetValue(selection);\n            this.viewer.layout.isBidiReLayout = true;\n            if (update && property === 'leftIndent') {\n                value = this.getIndentIncrementValue(selection.start.paragraph, value);\n            }\n            var para = selection.start.paragraph.combineWidget(this.viewer);\n            this.applyParaFormatProperty(para, property, value, update);\n            this.layoutItemBlock(para, false);\n            this.viewer.layout.isBidiReLayout = false;\n        }\n        else {\n            //Iterate and update formatting's.      \n            if (action !== 'ParagraphBidi') {\n                this.setOffsetValue(selection);\n            }\n            this.updateSelectionParagraphFormatting(property, value, update);\n        }\n        this.reLayout(selection);\n    };\n    /**\n     * Update the list level\n     * @param  {boolean} increaseLevel\n     * @private\n     */\n    Editor.prototype.updateListLevel = function (increaseLevel) {\n        // Increment or Decrement list level for Multilevel lists.\n        var viewer = this.viewer;\n        var listFormat = this.viewer.selection.start.paragraph.paragraphFormat.listFormat;\n        var paragraphFormat = this.viewer.selection.start.paragraph.paragraphFormat;\n        var list = viewer.getListById(paragraphFormat.listFormat.listId);\n        var listLevel = viewer.layout.getListLevel(list, paragraphFormat.listFormat.listLevelNumber);\n        var levelNumber;\n        if (increaseLevel) {\n            levelNumber = paragraphFormat.listFormat.listLevelNumber + 1;\n        }\n        else {\n            levelNumber = paragraphFormat.listFormat.listLevelNumber - 1;\n        }\n        var nextListLevel = viewer.layout.getListLevel(list, levelNumber);\n        if (!isNullOrUndefined(nextListLevel)) {\n            this.onApplyListInternal(list, levelNumber);\n            viewer.selection.start.updatePhysicalPosition(true);\n            viewer.selection.end.updatePhysicalPosition(true);\n            viewer.selection.updateCaretPosition();\n        }\n    };\n    /**\n     * Applies list\n     * @param  {WList} list\n     * @param  {number} listLevelNumber\n     * @private\n     */\n    Editor.prototype.onApplyListInternal = function (list, listLevelNumber) {\n        var selection = this.viewer.selection;\n        var listFormat = new WListFormat();\n        if (!isNullOrUndefined(list) && listLevelNumber >= 0 && listLevelNumber < 9) {\n            listFormat.listId = list.listId;\n            listFormat.listLevelNumber = listLevelNumber;\n        }\n        this.onApplyParagraphFormat('listFormat', listFormat, false, false);\n    };\n    /**\n     * Apply paragraph format to selection range\n     * @private\n     */\n    Editor.prototype.updateSelectionParagraphFormatting = function (property, value, update) {\n        var selection = this.viewer.selection;\n        if (property === 'leftIndent' && update) {\n            if (!isNullOrUndefined(selection.start) && selection.start.isExistBefore(selection.end)) {\n                value = this.getIndentIncrementValue(selection.start.paragraph, value);\n            }\n            else {\n                value = this.getIndentIncrementValue(selection.end.paragraph, value);\n            }\n        }\n        this.updateParagraphFormatInternal(property, value, update);\n    };\n    Editor.prototype.getIndentIncrementValue = function (currentParagraph, incrementFactor) {\n        var currentParagraphIndent = currentParagraph.paragraphFormat.leftIndent;\n        if (currentParagraphIndent < 0) {\n            // In MS Word, if the current paragraph left indent is lesser that or equal to 0\n            // then performing decrement indent will set left indent to 0. \n            if (incrementFactor < 0 || currentParagraphIndent + incrementFactor >= 0) {\n                return -currentParagraphIndent;\n            }\n            else {\n                var incrementValue = -this.getIndentIncrementValueInternal(-currentParagraphIndent, -incrementFactor);\n                return incrementValue % incrementFactor === 0 ? incrementValue : incrementValue + incrementFactor;\n            }\n        }\n        else {\n            return this.getIndentIncrementValueInternal(currentParagraphIndent, incrementFactor);\n        }\n    };\n    Editor.prototype.getIndentIncrementValueInternal = function (position, incrementFactor) {\n        var tabValue = Math.abs(incrementFactor);\n        if (position === 0 || tabValue === 0) {\n            return incrementFactor > 0 ? tabValue : 0;\n        }\n        else {\n            var diff = ((Math.round(position) * 100) % (Math.round(tabValue) * 100)) / 100;\n            var cnt = (Math.round(position) - diff) / Math.round(tabValue);\n            var fPosition = cnt * tabValue;\n            if (incrementFactor > 0) {\n                fPosition += tabValue;\n            }\n            return (fPosition - position) === 0 ? incrementFactor : fPosition - position;\n        }\n    };\n    Editor.prototype.updateParagraphFormatInternal = function (property, value, update) {\n        if (isNullOrUndefined(property)) {\n            property = 'ParagraphFormat';\n        }\n        switch (property) {\n            case 'afterSpacing':\n                this.updateParagraphFormat('afterSpacing', value, false);\n                break;\n            case 'beforeSpacing':\n                this.updateParagraphFormat('beforeSpacing', value, false);\n                break;\n            case 'rightIndent':\n                this.updateParagraphFormat('rightIndent', value, false);\n                break;\n            case 'leftIndent':\n                this.updateParagraphFormat('leftIndent', value, update);\n                break;\n            case 'firstLineIndent':\n                this.updateParagraphFormat('firstLineIndent', value, false);\n                break;\n            case 'lineSpacing':\n                this.updateParagraphFormat('lineSpacing', value, false);\n                break;\n            case 'lineSpacingType':\n                this.updateParagraphFormat('lineSpacingType', value, false);\n                break;\n            case 'textAlignment':\n                this.updateParagraphFormat('textAlignment', value, false);\n                break;\n            case 'listFormat':\n                this.updateParagraphFormat('listFormat', value, false);\n                break;\n            case 'ParagraphFormat':\n                this.updateParagraphFormat(undefined, value, false);\n                break;\n            case 'styleName':\n                this.updateParagraphFormat('styleName', value, false);\n                break;\n            case 'ClearParagraphFormat':\n                // this.initializeHistory('ClearParagraphFormat', selectionRange);\n                this.updateParagraphFormat(undefined, value, false);\n                break;\n            case 'bidi':\n                this.viewer.layout.isBidiReLayout = true;\n                this.updateParagraphFormat('bidi', value, false);\n                this.viewer.layout.isBidiReLayout = false;\n                break;\n        }\n    };\n    /**\n     * Update paragraph format on undo\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @param  {boolean} update\n     * @private\n     */\n    Editor.prototype.updateParagraphFormat = function (property, value, update) {\n        var selection = this.viewer.selection;\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        // this.updateInsertPosition(selection, startPosition);\n        this.applyParaFormatSelectedContent(startPosition, endPosition, property, value, update);\n        // this.startSelectionReLayouting(startPosition.paragraph, selection, startPosition, endPosition);\n    };\n    Editor.prototype.applyParaFormatSelectedContent = function (start, end, property, value, update) {\n        var selection = this.viewer.selection;\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || selection.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            var cell = void 0;\n            start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(start, true);\n            }\n            cell = start.paragraph.associatedCell;\n            this.applyParaFormatInCell(cell, start, end, property, value, update);\n            var table = cell.ownerTable;\n            this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(value) && !this.selection.isEmpty && property === 'styleName' && this.applyCharacterStyle(start.paragraph, start, end, property, value, update)) {\n                return;\n            }\n            else {\n                this.applyParaFormat(start.paragraph, start, end, property, value, update);\n            }\n        }\n    };\n    /**\n     * Apply Paragraph format\n     * @private\n     */\n    Editor.prototype.applyParaFormatProperty = function (paragraph, property, value, update) {\n        var format = paragraph.paragraphFormat;\n        if (update && property === 'leftIndent') {\n            value = format.leftIndent + value;\n        }\n        if (property === 'listFormat' && value instanceof WListFormat) {\n            var listFormat = value;\n            if (!listFormat.hasValue('listLevelNumber')) {\n                listFormat.listLevelNumber = format.listFormat.listLevelNumber;\n            }\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForParagraphFormat(format, property, value);\n        }\n        if (value instanceof WParagraphFormat) {\n            if (isNullOrUndefined(property)) {\n                if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n                    this.copyParagraphFormat(value, format);\n                }\n                else {\n                    format.copyFormat(value);\n                }\n            }\n            else if (property === 'listFormat') {\n                format.listFormat = value.listFormat;\n                // this.handleListFormat(format, value as WParagraphFormat);\n            }\n        }\n        if (isNullOrUndefined(value)) {\n            format.clearFormat();\n            this.viewer.layout.reLayoutParagraph(format.ownerBase, 0, 0);\n            return;\n        }\n        if (property === 'afterSpacing') {\n            format.afterSpacing = value;\n        }\n        else if (property === 'beforeSpacing') {\n            format.beforeSpacing = value;\n        }\n        else if (property === 'leftIndent') {\n            format.leftIndent = value;\n        }\n        else if (property === 'lineSpacingType') {\n            format.lineSpacingType = value;\n        }\n        else if (property === 'lineSpacing') {\n            format.lineSpacing = value;\n        }\n        else if (property === 'rightIndent') {\n            format.rightIndent = value;\n        }\n        else if (property === 'firstLineIndent') {\n            format.firstLineIndent = value;\n        }\n        else if (property === 'textAlignment') {\n            format.textAlignment = value;\n            this.viewer.layout.allowLayout = false;\n        }\n        else if (property === 'styleName') {\n            if (typeof (value) === 'string') {\n                value = this.viewer.styles.findByName(value);\n            }\n            format.ApplyStyle(value);\n        }\n        else if (property === 'listFormat') {\n            if (value instanceof WParagraphFormat) {\n                this.copyFromListLevelParagraphFormat(format, value);\n                value = value.listFormat;\n            }\n            format.listFormat.copyFormat(value);\n            this.viewer.layout.clearListElementBox(format.ownerBase);\n            this.onListFormatChange(format.ownerBase, value, format);\n            this.layoutItemBlock(format.ownerBase, false);\n            return;\n        }\n        else if (property === 'bidi') {\n            format.bidi = value;\n        }\n    };\n    Editor.prototype.copyParagraphFormat = function (sourceFormat, destFormat) {\n        destFormat.uniqueParagraphFormat = sourceFormat.uniqueParagraphFormat;\n        destFormat.listFormat = sourceFormat.listFormat;\n        destFormat.baseStyle = sourceFormat.baseStyle;\n    };\n    Editor.prototype.onListFormatChange = function (paragraph, listFormat, paraFormat) {\n        if (listFormat instanceof WListFormat) {\n            var currentFormat = listFormat;\n            // currentFormat.setOwnerBase(paraFormat);\n            this.updateListParagraphFormat(paragraph, listFormat);\n        }\n    };\n    Editor.prototype.updateListParagraphFormat = function (paragraph, listFormat) {\n        var list = this.viewer.getListById(listFormat.listId);\n        var listlevel = undefined;\n        if (!isNullOrUndefined(list)) {\n            listlevel = this.viewer.layout.getListLevel(list, listFormat.listLevelNumber);\n        }\n        var isUpdateIndent = !this.editorHistory || (this.editorHistory && !this.editorHistory.isUndoing);\n        if (isUpdateIndent) {\n            if (paragraph instanceof ParagraphWidget && !isNullOrUndefined(listlevel)\n                && !isNullOrUndefined(listlevel.paragraphFormat) && !isNullOrUndefined(paragraph.containerWidget)) {\n                this.copyFromListLevelParagraphFormat(paragraph.paragraphFormat, listlevel.paragraphFormat);\n            }\n            else if (isNullOrUndefined(list)) {\n                paragraph.paragraphFormat.leftIndent = undefined;\n                paragraph.paragraphFormat.firstLineIndent = undefined;\n            }\n        }\n    };\n    /**\n     * Copies list level paragraph format\n     * @param  {WParagraphFormat} oldFormat\n     * @param  {WParagraphFormat} newFormat\n     * @private\n     */\n    Editor.prototype.copyFromListLevelParagraphFormat = function (oldFormat, newFormat) {\n        if (!isNullOrUndefined(newFormat.leftIndent)) {\n            oldFormat.leftIndent = newFormat.leftIndent;\n        }\n        if (!isNullOrUndefined(newFormat.firstLineIndent)) {\n            oldFormat.firstLineIndent = newFormat.firstLineIndent;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyContinueNumbering = function (selection) {\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ContinueNumbering');\n        }\n        this.applyContinueNumberingInternal(selection);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyContinueNumberingInternal = function (selection) {\n        var paragraph = selection.start.paragraph;\n        var numberingInfo = this.getContinueNumberingInfo(paragraph);\n        var paraFormat = this.getParagraphFormat(paragraph, numberingInfo.listLevelNumber, numberingInfo.listPattern);\n        this.changeListId(numberingInfo.currentList, paragraph, paraFormat, numberingInfo.listLevelNumber, numberingInfo.listPattern);\n        this.reLayout(selection, false);\n        this.viewer.updateFocus();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getContinueNumberingInfo = function (paragraph) {\n        var currentList = undefined;\n        var listLevelNumber = 0;\n        var listPattern = 'None';\n        if (!isNullOrUndefined(paragraph.paragraphFormat)\n            && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n            currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n            listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n        }\n        var viewer = this.viewer;\n        if (listLevelNumber !== 0 && !isNullOrUndefined(currentList) &&\n            !isNullOrUndefined(viewer.getAbstractListById(currentList.abstractListId))\n            && !isNullOrUndefined(viewer.getAbstractListById(currentList.abstractListId).levels[listLevelNumber])) {\n            var listLevel = this.viewer.layout.getListLevel(currentList, listLevelNumber);\n            if (!isNullOrUndefined(listLevel)) {\n                listPattern = listLevel.listLevelPattern;\n            }\n        }\n        return {\n            currentList: currentList,\n            listLevelNumber: listLevelNumber,\n            listPattern: listPattern\n        };\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.revertContinueNumbering = function (selection, format) {\n        var paragraph = selection.start.paragraph;\n        var numberingInfo = this.getContinueNumberingInfo(paragraph);\n        this.changeListId(numberingInfo.currentList, paragraph, format, numberingInfo.listLevelNumber, numberingInfo.listPattern);\n        this.reLayout(selection, false);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.updateHistory();\n        }\n    };\n    Editor.prototype.changeListId = function (list, block, format, levelNum, listType) {\n        if (isNullOrUndefined(block)) {\n            return;\n        }\n        if (block instanceof ParagraphWidget) {\n            if (list.listId === block.paragraphFormat.listFormat.listId\n                && levelNum === block.paragraphFormat.listFormat.listLevelNumber) {\n                if (this.editorHistory) {\n                    var baseHistoryInfo = this.editorHistory.currentBaseHistoryInfo;\n                    if (!isNullOrUndefined(baseHistoryInfo)) {\n                        format = baseHistoryInfo.addModifiedPropertiesForContinueNumbering(block.paragraphFormat, format);\n                    }\n                }\n                block.paragraphFormat.copyFormat(format);\n                this.viewer.layout.reLayoutParagraph(block, 0, 0);\n            }\n        }\n        return this.changeListId(list, block.nextRenderedWidget, format, levelNum, listType);\n    };\n    Editor.prototype.getParagraphFormat = function (paragraph, levelNumber, listType) {\n        if (!isNullOrUndefined(paragraph.previousRenderedWidget)) {\n            if (paragraph.previousRenderedWidget instanceof ParagraphWidget) {\n                if (!isNullOrUndefined(paragraph.previousRenderedWidget.paragraphFormat.listFormat)\n                    && paragraph.previousRenderedWidget.paragraphFormat.listFormat.listId !== -1) {\n                    var listLevel = this.getListLevel(paragraph.previousRenderedWidget);\n                    if (levelNumber === 0) {\n                        return paragraph.previousRenderedWidget.paragraphFormat;\n                    }\n                    else if (listType === listLevel.listLevelPattern\n                        || this.checkNumberArabic(listType, listLevel.listLevelPattern)) {\n                        return paragraph.previousRenderedWidget.paragraphFormat;\n                    }\n                    else {\n                        return this.getParagraphFormat(paragraph.previousRenderedWidget, levelNumber, listType);\n                    }\n                }\n                else {\n                    return this.getParagraphFormat(paragraph.previousRenderedWidget, levelNumber, listType);\n                }\n            }\n        }\n        return undefined;\n    };\n    Editor.prototype.checkNumberArabic = function (listType, levelPattern) {\n        if ((listType === 'Number' && levelPattern === 'Arabic')\n            || (levelPattern === 'Number' && listType === 'Arabic')) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyRestartNumbering = function (selection) {\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('RestartNumbering');\n        }\n        this.restartListAt(selection);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.restartListAt = function (selection) {\n        var currentListLevel = this.getListLevel(selection.start.paragraph);\n        var list = new WList();\n        list.listId = this.viewer.lists[(this.viewer.lists.length - 1)].listId + 1;\n        var abstractList = new WAbstractList();\n        abstractList.abstractListId = this.viewer.abstractLists[(this.viewer.abstractLists.length - 1)].abstractListId + 1;\n        list.abstractListId = abstractList.abstractListId;\n        list.abstractList = abstractList;\n        this.viewer.abstractLists.push(abstractList);\n        this.createListLevels(abstractList, currentListLevel, list);\n        this.viewer.lists.push(list);\n        this.restartListAtInternal(selection, list.listId);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.restartListAtInternal = function (selection, listId) {\n        var numberingInfo = this.getContinueNumberingInfo(selection.start.paragraph);\n        this.changeRestartNumbering(numberingInfo.currentList, selection.start.paragraph, listId);\n        this.reLayout(selection, false);\n        this.incrementListNumber = -1;\n        this.refListNumber = undefined;\n        this.viewer.updateFocus();\n    };\n    Editor.prototype.changeRestartNumbering = function (list, block, listId) {\n        if (isNullOrUndefined(block)) {\n            return;\n        }\n        if (block instanceof ParagraphWidget) {\n            if (list.listId === block.paragraphFormat.listFormat.listId) {\n                if (this.editorHistory) {\n                    var baseHistoryInfo = this.editorHistory.currentBaseHistoryInfo;\n                    if (!isNullOrUndefined(baseHistoryInfo)) {\n                        listId = baseHistoryInfo.addModifiedPropertiesForRestartNumbering(block.paragraphFormat.listFormat, listId);\n                    }\n                }\n                block.paragraphFormat.listFormat.listId = listId;\n                if (this.refListNumber !== block.paragraphFormat.listFormat.listLevelNumber) {\n                    this.incrementListNumber += 1;\n                    this.refListNumber = block.paragraphFormat.listFormat.listLevelNumber;\n                }\n                block.paragraphFormat.listFormat.listLevelNumber = this.incrementListNumber;\n                this.viewer.layout.reLayoutParagraph(block, 0, 0);\n            }\n        }\n        return this.changeRestartNumbering(list, block.nextRenderedWidget, listId);\n    };\n    Editor.prototype.createListLevels = function (abstractList, currentListLevel, list) {\n        var levelPattern = currentListLevel.listLevelPattern;\n        var levelPatterns = [];\n        var currentAbstractList = currentListLevel.ownerBase;\n        for (var i = 0; i < 3; i++) {\n            var listLevel = currentAbstractList.levels[i];\n            if (!isNullOrUndefined(listLevel)) {\n                levelPatterns.push(listLevel.listLevelPattern);\n            }\n        }\n        var indexOfLevelPattern = levelPatterns.indexOf(levelPattern) === -1 ? 0 : levelPatterns.indexOf(levelPattern);\n        var numberFormat = currentListLevel.numberFormat.charAt(currentListLevel.numberFormat.length - 1);\n        for (var i = 0; i < currentAbstractList.levels.length; i++) {\n            var listLevel = new WListLevel(abstractList);\n            if (i === 0) {\n                listLevel.listLevelPattern = levelPattern;\n            }\n            else {\n                if (indexOfLevelPattern === 0 || indexOfLevelPattern < levelPatterns.length - 1) {\n                    indexOfLevelPattern++;\n                }\n                else {\n                    indexOfLevelPattern = 0;\n                }\n                listLevel.listLevelPattern = levelPatterns[indexOfLevelPattern];\n            }\n            listLevel.numberFormat = '%' + (i + 1) + numberFormat;\n            listLevel.startAt = 1;\n            listLevel.characterFormat.copyFormat(currentListLevel.characterFormat);\n            listLevel.paragraphFormat.copyFormat(currentListLevel.paragraphFormat);\n            listLevel.restartLevel = i;\n            abstractList.levels.push(listLevel);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormat = function (paragraph, start, end, property, value, update) {\n        this.setOffsetValue(this.selection);\n        paragraph = paragraph.combineWidget(this.viewer);\n        //Apply Paragraph Format for spitted paragraph\n        this.applyParaFormatProperty(paragraph, property, value, update);\n        this.layoutItemBlock(paragraph, false);\n        this.getOffsetValue(this.selection);\n        if (paragraph.equals(end.paragraph)) {\n            return;\n        }\n        this.getNextParagraphForFormatting(paragraph, start, end, property, value, update);\n    };\n    /* tslint:disable-next-line:max-line-length */\n    Editor.prototype.applyCharacterStyle = function (paragraph, start, end, property, value, update) {\n        var paragraphWidget = paragraph.getSplitWidgets();\n        if ((end.paragraph === paragraph || paragraphWidget.indexOf(end.paragraph) !== -1)) {\n            if (((value.type === 'Paragraph') && ((value.link) instanceof WCharacterStyle)) || (value.type === 'Character')) {\n                var obj = (value.type === 'Character') ? value : value.link;\n                this.updateSelectionCharacterFormatting(property, obj, update);\n                return true;\n            }\n        }\n        return false;\n    };\n    // Cell\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormatInCell = function (cell, start, end, property, value, update) {\n        var selection = this.viewer.selection;\n        if (end.paragraph.isInsideTable) {\n            var cellContainer = selection.getContainerCellOf(cell, end.paragraph.associatedCell);\n            if (cellContainer.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = selection.getSelectedCell(cell, cellContainer);\n                var endCell = selection.getSelectedCell(end.paragraph.associatedCell, cellContainer);\n                if (selection.containsCell(cellContainer, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (selection.isCellSelected(cellContainer, start, end)) {\n                        value = this.getParaFormatValueInCell(cellContainer, property, value);\n                        this.applyParaFormatCellInternal(cellContainer, property, value, update);\n                    }\n                    else {\n                        if (startCell === cellContainer) {\n                            this.applyParaFormat(start.paragraph, start, end, property, value, update);\n                        }\n                        else {\n                            this.applyParagraphFormatRow(startCell.ownerRow, start, end, property, value, update);\n                        }\n                    }\n                }\n                else {\n                    //Format other selected cells in current table.\n                    this.applyParaFormatTableCell(cellContainer.ownerTable, cellContainer, endCell, property, value, update);\n                }\n            }\n            else {\n                this.applyParagraphFormatRow(cellContainer.ownerRow, start, end, property, value, update);\n            }\n        }\n        else {\n            var wCell = selection.getContainerCell(cell);\n            this.applyParagraphFormatRow(wCell.ownerRow, start, end, property, value, update);\n        }\n    };\n    Editor.prototype.applyParaFormatCellInternal = function (cell, property, value, update) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            if (block instanceof ParagraphWidget) {\n                this.applyParaFormatProperty(block, property, value, update);\n            }\n            else {\n                this.applyParagraphFormatTableInternal(block, property, value, update);\n            }\n        }\n    };\n    Editor.prototype.getParaFormatValueInCell = function (cell, property, value) {\n        if (typeof value === 'boolean') {\n            var firstPara = this.viewer.selection.getFirstParagraph(cell);\n            value = !firstPara.paragraphFormat.getPropertyValue(property);\n        }\n        return value;\n    };\n    // Row\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParagraphFormatRow = function (wRow, start, end, property, value, update) {\n        value = this.getParaFormatValueInCell(wRow.childWidgets[0], property, value);\n        for (var i = wRow.rowIndex; i < wRow.ownerTable.childWidgets.length; i++) {\n            var row = wRow.ownerTable.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.applyParaFormatCellInternal(row.childWidgets[j], property, value, update);\n            }\n            if (end.paragraph.isInsideTable && this.viewer.selection.containsRow(row, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        this.getNextParagraphForFormatting(wRow.ownerTable, start, end, property, value, update);\n    };\n    // Table\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormatTableCell = function (table, startCell, endCell, property, value, update) {\n        var selection = this.viewer.selection;\n        var startValue = selection.getCellLeft(startCell.ownerRow, startCell);\n        var endValue = startValue + startCell.cellFormat.cellWidth;\n        var endCellLeft = selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(startValue, endValue, endCellLeft, endCellRight);\n        startValue = cellInfo.start;\n        endValue = cellInfo.end;\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var isStarted = false;\n        for (var m = table.childWidgets.indexOf(startCell.ownerRow); m <= count; m++) {\n            var row = table.childWidgets[m];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var left = selection.getCellLeft(row, row.childWidgets[j]);\n                if (Math.round(startValue) <= Math.round(left) && Math.round(left) < Math.round(endValue)) {\n                    if (!isStarted) {\n                        value = this.getParaFormatValueInCell(row.childWidgets[j], property, value);\n                        isStarted = true;\n                    }\n                    this.applyParaFormatCellInternal(row.childWidgets[j], property, value, update);\n                }\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormatTable = function (table, start, end, property, value, update) {\n        table = table.combineWidget(this.viewer);\n        var selection = this.viewer.selection;\n        for (var m = 0; m < table.childWidgets.length; m++) {\n            var tableRow = table.childWidgets[m];\n            for (var k = 0; k < tableRow.childWidgets.length; k++) {\n                this.applyParaFormatCellInternal(tableRow.childWidgets[k], property, value, update);\n            }\n            if (end.paragraph.isInsideTable && selection.containsRow(tableRow, end.paragraph.associatedCell)) {\n                this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n                return;\n            }\n        }\n        this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        this.getNextParagraphForFormatting(table, start, end, property, value, update);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.getNextParagraphForFormatting = function (block, start, end, property, value, update) {\n        var widgetCollection = block.getSplitWidgets();\n        block = widgetCollection[widgetCollection.length - 1];\n        block = this.viewer.selection.getNextRenderedBlock(block);\n        if (!isNullOrUndefined(block)) { //Goto the next block.\n            if (block instanceof ParagraphWidget) {\n                this.applyParaFormat(block, start, end, property, value, update);\n            }\n            else {\n                this.applyParaFormatTable(block, start, end, property, value, update);\n            }\n        }\n    };\n    Editor.prototype.applyParagraphFormatTableInternal = function (table, property, value, update) {\n        for (var x = 0; x < table.childWidgets.length; x++) {\n            var row = table.childWidgets[x];\n            for (var y = 0; y < row.childWidgets.length; y++) {\n                this.applyParaFormatCellInternal(row.childWidgets[y], property, value, update);\n            }\n        }\n    };\n    //Paragraph Format apply implementation Ends\n    // Apply Selection Section Format Option Implementation Starts\n    /**\n     * Apply section format selection changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplySectionFormat = function (property, value) {\n        if (!isNullOrUndefined(property)) {\n            var action = (property[0].toUpperCase() + property.slice(1));\n            this.initHistory(action);\n        }\n        else {\n            this.initHistory('SectionFormat');\n        }\n        this.updateSectionFormat(property, value);\n    };\n    /**\n     * Update section format\n     * @param  {string} property\n     * @param  {Object} value\n     * @returns TextPosition\n     * @private\n     */\n    Editor.prototype.updateSectionFormat = function (property, value) {\n        var selection = this.viewer.selection;\n        selection.owner.isShiftingEnabled = true;\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        var startPageIndex;\n        var endPageIndex;\n        this.viewer.clearContent();\n        var startSectionIndex = startPosition.paragraph.containerWidget.index;\n        var endSectionIndex = endPosition.paragraph.containerWidget.index;\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            if (this.viewer.pages[i].bodyWidgets[0].index === startSectionIndex) {\n                startPageIndex = i;\n                break;\n            }\n        }\n        for (var i = startPageIndex; i < this.viewer.pages.length; i++) {\n            var bodyWidget = this.viewer.pages[i].bodyWidgets[0];\n            endPageIndex = i;\n            if ((bodyWidget.index === startSectionIndex)) {\n                continue;\n            }\n            else if ((bodyWidget.index >= startSectionIndex) && bodyWidget.index <= endSectionIndex) {\n                continue;\n            }\n            else {\n                endPageIndex = i - 1;\n                break;\n            }\n        }\n        // let startPageIndex: number = this.viewer.pages.indexOf((selection.start.paragraph.containerWidget as BodyWidget).page);\n        // let endPageIndex: number = this.viewer.pages.indexOf((selection.end.paragraph.containerWidget as BodyWidget).page);\n        var update = true;\n        var index = 0;\n        for (var i = startPageIndex; i <= endPageIndex; i++) {\n            if (index !== this.viewer.pages[i].bodyWidgets[0].index && !update) {\n                update = true;\n            }\n            this.applyPropertyValueForSection(this.viewer.pages[i].bodyWidgets[0].sectionFormat, property, value, update);\n            index = this.viewer.pages[i].bodyWidgets[0].index;\n            update = false;\n        }\n        this.layoutWholeDocument();\n        this.fireContentChange();\n    };\n    //Apply Selection Table Format option implementation starts\n    /**\n     * Apply table format property changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplyTableFormat = function (property, value) {\n        var action = this.getTableFormatAction(property);\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        var table = selection.start.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        if (selection.isEmpty) {\n            this.initHistory(action);\n            this.applyTablePropertyValue(selection, property, value, table);\n        }\n        else {\n            this.updateSelectionTableFormat(this.selection, action, value);\n        }\n        table.calculateGrid();\n        this.selection.owner.isLayoutEnabled = true;\n        this.viewer.layout.reLayoutTable(table);\n        this.reLayout(selection, false);\n    };\n    Editor.prototype.getTableFormatAction = function (property) {\n        switch (property) {\n            case 'tableAlignment':\n                return 'TableAlignment';\n            case 'leftIndent':\n                return 'TableLeftIndent';\n            case 'leftMargin':\n                return 'DefaultCellLeftMargin';\n            case 'rightMargin':\n                return 'DefaultCellRightMargin';\n            case 'bottomMargin':\n                return 'DefaultCellBottomMargin';\n            case 'topMargin':\n                return 'DefaultCellTopMargin';\n            case 'preferredWidth':\n                return 'TablePreferredWidth';\n            case 'preferredWidthType':\n                return 'TablePreferredWidthType';\n            case 'shading':\n                return 'Shading';\n            case 'bidi':\n                return 'TableBidi';\n            default:\n                return 'DefaultCellSpacing';\n        }\n    };\n    // Apply Selection Row Format Option Implementation Starts\n    /**\n     * Apply table row format property changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplyTableRowFormat = function (property, value) {\n        var action = this.getRowAction(property);\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            this.initHistory(action);\n            var table = selection.start.paragraph.associatedCell.ownerRow.ownerTable;\n            this.applyRowPropertyValue(selection, property, value, selection.start.paragraph.associatedCell.ownerRow);\n        }\n        else {\n            this.updateSelectionTableFormat(this.selection, action, value);\n        }\n        this.reLayout(selection, false);\n    };\n    Editor.prototype.getRowAction = function (property) {\n        switch (property) {\n            case 'height':\n                return 'RowHeight';\n            case 'heightType':\n                return 'RowHeightType';\n            case 'isHeader':\n                return 'RowHeader';\n            default:\n                return 'AllowBreakAcrossPages';\n        }\n    };\n    /**\n     * Apply table cell property changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplyTableCellFormat = function (property, value) {\n        var action = this.getTableCellAction(property);\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        var table = selection.start.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        if (selection.isEmpty) {\n            this.initHistory(action);\n            this.applyCellPropertyValue(selection, property, value, selection.start.paragraph.associatedCell.cellFormat);\n            table.calculateGrid();\n            this.selection.owner.isLayoutEnabled = true;\n            this.viewer.layout.reLayoutTable(table);\n        }\n        else {\n            this.updateSelectionTableFormat(this.selection, action, value);\n        }\n        this.reLayout(selection, false);\n    };\n    Editor.prototype.getTableCellAction = function (property) {\n        switch (property) {\n            case 'verticalAlignment':\n                return 'CellContentVerticalAlignment';\n            case 'leftMargin':\n                return 'CellLeftMargin';\n            case 'rightMargin':\n                return 'CellRightMargin';\n            case 'bottomMargin':\n                return 'CellBottomMargin';\n            case 'topMargin':\n                return 'CellTopMargin';\n            case 'preferredWidth':\n                return 'CellPreferredWidth';\n            case 'shading':\n                return 'Shading';\n            default:\n                return 'CellPreferredWidthType';\n        }\n    };\n    Editor.prototype.applyPropertyValueForSection = function (sectionFormat, property, value, update) {\n        var selection = this.viewer.selection;\n        if (update && this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(sectionFormat, property, value);\n        }\n        if (isNullOrUndefined(value)) {\n            return;\n        }\n        if (value instanceof WSectionFormat) {\n            if (isNullOrUndefined(property)) {\n                sectionFormat.copyFormat(value, this.editorHistory);\n            }\n            return;\n        }\n        if (property === 'pageHeight') {\n            sectionFormat.pageHeight = value;\n        }\n        else if (property === 'pageWidth') {\n            sectionFormat.pageWidth = value;\n        }\n        else if (property === 'leftMargin') {\n            sectionFormat.leftMargin = value;\n        }\n        else if (property === 'rightMargin') {\n            sectionFormat.rightMargin = value;\n        }\n        else if (property === 'topMargin') {\n            sectionFormat.topMargin = value;\n        }\n        else if (property === 'bottomMargin') {\n            sectionFormat.bottomMargin = value;\n        }\n        else if (property === 'differentFirstPage') {\n            sectionFormat.differentFirstPage = value;\n        }\n        else if (property === 'differentOddAndEvenPages') {\n            sectionFormat.differentOddAndEvenPages = value;\n        }\n        else if (property === 'headerDistance') {\n            sectionFormat.headerDistance = value;\n        }\n        else if (property === 'footerDistance') {\n            sectionFormat.footerDistance = value;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.layoutWholeDocument = function () {\n        var startPosition = this.viewer.selection.start;\n        var endPosition = this.viewer.selection.end;\n        if (startPosition.isExistAfter(endPosition)) {\n            startPosition = this.viewer.selection.end;\n            endPosition = this.viewer.selection.start;\n        }\n        var startInfo = this.getParagraphInfo(startPosition);\n        var endInfo = this.getParagraphInfo(startPosition);\n        var startIndex = this.getHierarchicalIndex(startInfo.paragraph, startInfo.offset.toString());\n        var endIndex = this.getHierarchicalIndex(endInfo.paragraph, endInfo.offset.toString());\n        this.viewer.renderedLists.clear();\n        // this.viewer.owner.isLayoutEnabled = true;\n        var sections = this.combineSection();\n        this.viewer.clearContent();\n        this.viewer.layout.layoutItems(sections);\n        this.viewer.owner.isShiftingEnabled = false;\n        this.setPositionForCurrentIndex(startPosition, startIndex);\n        this.setPositionForCurrentIndex(endPosition, endIndex);\n        this.viewer.selection.selectPosition(startPosition, endPosition);\n        this.reLayout(this.viewer.selection);\n    };\n    Editor.prototype.combineSection = function () {\n        var sections = [];\n        var nextSection = this.viewer.pages[0].bodyWidgets[0];\n        do {\n            nextSection = this.combineSectionChild(nextSection, sections);\n        } while (nextSection);\n        return sections;\n    };\n    Editor.prototype.combineSectionChild = function (bodyWidget, sections) {\n        var previousBodyWidget = bodyWidget;\n        var temp = new BodyWidget();\n        temp.sectionFormat = bodyWidget.sectionFormat;\n        temp.index = previousBodyWidget.index;\n        do {\n            previousBodyWidget = bodyWidget;\n            if (bodyWidget.lastChild) {\n                bodyWidget.lastChild.combineWidget(this.viewer);\n            }\n            bodyWidget = bodyWidget.nextRenderedWidget;\n            for (var j = 0; j < previousBodyWidget.childWidgets.length; j++) {\n                var block = previousBodyWidget.childWidgets[j];\n                if (block instanceof TableWidget) {\n                    this.viewer.layout.clearTableWidget(block, true, true, true);\n                }\n                else {\n                    block.x = 0;\n                    block.y = 0;\n                    block.width = 0;\n                    block.height = 0;\n                }\n                temp.childWidgets.push(block);\n                previousBodyWidget.childWidgets.splice(j, 1);\n                j--;\n                block.containerWidget = temp;\n            }\n            previousBodyWidget.page.destroy();\n            // this.viewer.pages.splice(previousBodyWidget.page.index, 1);\n        } while (bodyWidget && previousBodyWidget.equals(bodyWidget));\n        sections.push(temp);\n        return bodyWidget;\n    };\n    Editor.prototype.updateSelectionTableFormat = function (selection, action, value) {\n        switch (action) {\n            case 'TableAlignment':\n                this.editorHistory.initializeHistory('TableAlignment');\n                this.updateTableFormat(selection, 'tableAlignment', value);\n                break;\n            case 'TableLeftIndent':\n                this.editorHistory.initializeHistory('TableLeftIndent');\n                this.updateTableFormat(selection, 'leftIndent', value);\n                break;\n            case 'DefaultCellSpacing':\n                this.editorHistory.initializeHistory('DefaultCellSpacing');\n                this.updateTableFormat(selection, 'cellSpacing', value);\n                break;\n            case 'DefaultCellLeftMargin':\n                this.editorHistory.initializeHistory('DefaultCellLeftMargin');\n                this.updateTableFormat(selection, 'leftMargin', value);\n                break;\n            case 'DefaultCellRightMargin':\n                this.editorHistory.initializeHistory('DefaultCellRightMargin');\n                this.updateTableFormat(selection, 'rightMargin', value);\n                break;\n            case 'DefaultCellTopMargin':\n                this.editorHistory.initializeHistory('DefaultCellTopMargin');\n                this.updateTableFormat(selection, 'topMargin', value);\n                break;\n            case 'TablePreferredWidth':\n                this.editorHistory.initializeHistory('TablePreferredWidth');\n                this.updateTableFormat(selection, 'preferredWidth', value);\n                break;\n            case 'TablePreferredWidthType':\n                this.editorHistory.initializeHistory('TablePreferredWidthType');\n                this.updateTableFormat(selection, 'preferredWidthType', value);\n                break;\n            case 'DefaultCellBottomMargin':\n                this.editorHistory.initializeHistory('DefaultCellBottomMargin');\n                this.updateTableFormat(selection, 'bottomMargin', value);\n                break;\n            case 'CellContentVerticalAlignment':\n                this.editorHistory.initializeHistory('CellContentVerticalAlignment');\n                this.updateCellFormat(selection, 'verticalAlignment', value);\n                break;\n            case 'CellLeftMargin':\n                this.editorHistory.initializeHistory('CellLeftMargin');\n                this.updateCellFormat(selection, 'leftMargin', value);\n                break;\n            case 'CellRightMargin':\n                this.editorHistory.initializeHistory('CellRightMargin');\n                this.updateCellFormat(selection, 'rightMargin', value);\n                break;\n            case 'CellTopMargin':\n                this.editorHistory.initializeHistory('CellTopMargin');\n                this.updateCellFormat(selection, 'topMargin', value);\n                break;\n            case 'CellBottomMargin':\n                this.editorHistory.initializeHistory('CellBottomMargin');\n                this.updateCellFormat(selection, 'bottomMargin', value);\n                break;\n            case 'CellPreferredWidth':\n                this.editorHistory.initializeHistory('CellPreferredWidth');\n                this.updateCellFormat(selection, 'preferredWidth', value);\n                break;\n            case 'CellPreferredWidthType':\n                this.editorHistory.initializeHistory('CellPreferredWidthType');\n                this.updateCellFormat(selection, 'preferredWidthType', value);\n                break;\n            case 'Shading':\n                this.editorHistory.initializeHistory('Shading');\n                this.updateCellFormat(selection, 'shading', value);\n                break;\n            case 'RowHeight':\n                this.editorHistory.initializeHistory('RowHeight');\n                this.updateRowFormat(selection, 'height', value);\n                break;\n            case 'RowHeightType':\n                this.editorHistory.initializeHistory('RowHeightType');\n                this.updateRowFormat(selection, 'heightType', value);\n                break;\n            case 'RowHeader':\n                this.editorHistory.initializeHistory('RowHeader');\n                this.updateRowFormat(selection, 'isHeader', value);\n                break;\n            case 'AllowBreakAcrossPages':\n                this.editorHistory.initializeHistory('AllowBreakAcrossPages');\n                this.updateRowFormat(selection, 'allowBreakAcrossPages', value);\n                break;\n            case 'TableBidi':\n                this.editorHistory.initializeHistory(action);\n                this.updateTableFormat(selection, 'bidi', value);\n                break;\n        }\n    };\n    // Update Table Properties\n    /**\n     * Update Table Format on undo\n     * @param  {Selection} selection\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {object} value\n     * @private\n     */\n    Editor.prototype.updateTableFormat = function (selection, property, value) {\n        var tableStartPosition = selection.start;\n        var tableEndPosition = selection.end;\n        if (!selection.isForward) {\n            tableStartPosition = selection.end;\n            tableEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, tableStartPosition);\n        // tslint:disable-next-line:max-line-length\n        this.applyTablePropertyValue(selection, property, value, tableStartPosition.paragraph.associatedCell.ownerTable);\n        if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n            this.viewer.layout.reLayoutTable(tableStartPosition.paragraph.associatedCell.ownerTable);\n        }\n    };\n    /**\n     * update cell format on undo\n     * @param  {Selection} selection\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.updateCellFormat = function (selection, property, value) {\n        selection.owner.isShiftingEnabled = true;\n        var newStartPosition = selection.start;\n        var newEndPosition = selection.end;\n        if (!selection.isForward) {\n            newStartPosition = selection.end;\n            newEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, newStartPosition);\n        this.updateFormatForCell(selection, property, value);\n    };\n    /**\n     * update row format on undo\n     * @param  {Selection} selection\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.updateRowFormat = function (selection, property, value) {\n        var rowStartPosition = selection.start;\n        var rowEndPosition = selection.end;\n        if (!selection.isForward) {\n            rowStartPosition = selection.end;\n            rowEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, rowStartPosition);\n        // tslint:disable-next-line:max-line-length\n        this.applyRowFormat(rowStartPosition.paragraph.associatedCell.ownerRow, rowStartPosition, rowEndPosition, property, value);\n    };\n    Editor.prototype.initHistoryPosition = function (selection, position) {\n        if (this.viewer.owner.editorHistoryModule && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            if (!isNullOrUndefined(position)) {\n                if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)) {\n                    this.editorHistory.currentBaseHistoryInfo.insertPosition = position.getHierarchicalIndexInternal();\n                }\n            }\n            else if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)) {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = selection.start.getHierarchicalIndexInternal();\n            }\n        }\n    };\n    Editor.prototype.startSelectionReLayouting = function (paragraph, selection, start, end) {\n        selection.owner.isLayoutEnabled = true;\n        if (start.paragraph.isInsideTable) {\n            var table = start.paragraph.associatedCell.ownerTable;\n            while (table.isInsideTable) {\n                table = table.associatedCell.ownerTable;\n            }\n            this.reLayoutSelectionOfTable(table, selection, start, end);\n        }\n        else {\n            this.reLayoutSelection(paragraph, selection, start, end);\n        }\n    };\n    Editor.prototype.reLayoutSelectionOfTable = function (table, selection, start, end) {\n        var isEnded = false;\n        this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        // If the selection ends in the current table, need to stop relayouting.\n        if (!isNullOrUndefined(end.paragraph.associatedCell) && table.contains(end.paragraph.associatedCell)) {\n            return true;\n        }\n        var block = selection.getNextRenderedBlock(table);\n        // Relayout the next block.\n        if (!isNullOrUndefined(block)) {\n            isEnded = this.reLayoutSelectionOfBlock(block, selection, start, end);\n        }\n        return isEnded;\n    };\n    Editor.prototype.reLayoutSelection = function (paragraph, selection, start, end) {\n        if (start.paragraph === paragraph) {\n            var startOffset = start.offset;\n            var length_2 = selection.getParagraphLength(paragraph);\n            var indexInInline = 0;\n            var index = 0;\n            var inlineObj = paragraph.getInline(start.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!isNullOrUndefined(inline)) {\n                if (indexInInline === inline.length && !isNullOrUndefined(inline.nextNode)) {\n                    inline = inline.nextNode;\n                }\n                index = inline.line.children.indexOf(inline);\n            }\n            var lineIndex = 0;\n            if (start.currentWidget.paragraph === paragraph) {\n                lineIndex = paragraph.childWidgets.indexOf(start.currentWidget);\n                index = start.currentWidget.children.indexOf(inline);\n            }\n            // If selection start inline is at new inline, need to relayout from the previous inline.\n            if (inline instanceof TextElementBox && !inline.line && index > 0) {\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, index - 1);\n            }\n            else {\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, index);\n            }\n        }\n        else {\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n        }\n        // If the selection ends at the current paragraph, need to stop relayouting.\n        if (end.paragraph === paragraph) {\n            return true;\n        }\n        // _Relayout the next block.\n        var block = selection.getNextRenderedBlock(paragraph);\n        if (!isNullOrUndefined(block)) {\n            return this.reLayoutSelectionOfBlock(block, selection, start, end);\n        }\n        return false;\n    };\n    //Relayouting Start    \n    Editor.prototype.reLayoutSelectionOfBlock = function (block, selection, start, end) {\n        if (block instanceof ParagraphWidget) {\n            return this.reLayoutSelection(block, selection, start, end);\n        }\n        else {\n            return undefined;\n            // return this.reLayoutSelectionOfTable(block as TableWidget, selection, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.layoutItemBlock = function (block, shiftNextWidget) {\n        var section = undefined;\n        if (block.containerWidget instanceof BlockContainer) {\n            section = block.containerWidget;\n            var index = section.childWidgets.indexOf(block);\n            if (!isNullOrUndefined(this.viewer.owner)\n                && this.viewer.owner.isLayoutEnabled) {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.layout.layoutBodyWidgetCollection(block.index, section, block, false);\n            }\n        }\n        else if (block.containerWidget instanceof TableCellWidget) {\n            var cell = block.containerWidget;\n            cell = this.viewer.selection.getContainerCell(cell);\n            if (!isNullOrUndefined(this.viewer.owner)\n                && this.viewer.owner.isLayoutEnabled) {\n                this.viewer.layout.reLayoutTable(block);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeSelectedContents = function (selection) {\n        return this.removeSelectedContentInternal(selection, selection.start, selection.end);\n    };\n    Editor.prototype.removeSelectedContentInternal = function (selection, startPosition, endPosition) {\n        var startPos = startPosition;\n        var endPos = endPosition;\n        if (!startPosition.isExistBefore(endPosition)) {\n            startPos = endPosition;\n            endPos = startPosition;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (startPos.paragraph === endPos.paragraph && startPos.paragraph.childWidgets.indexOf(startPos.currentWidget) === startPos.paragraph.childWidgets.length - 1 &&\n            startPos.offset === selection.getParagraphLength(startPos.paragraph) && startPos.offset + 1 === endPos.offset) {\n            selection.owner.isShiftingEnabled = true;\n            selection.selectContent(startPos, true);\n            return true;\n        }\n        var paragraphInfo = this.getParagraphInfo(startPos);\n        selection.editPosition = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n        var isRemoved = this.removeSelectedContent(endPos.paragraph, selection, startPos, endPos);\n        var textPosition = new TextPosition(selection.owner);\n        this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n        selection.selectContent(textPosition, true);\n        return isRemoved;\n    };\n    Editor.prototype.removeSelectedContent = function (paragraph, selection, start, end) {\n        //If end is not table end and start is outside the table, then skip removing the contents and move caret to start position.\n        if (end.paragraph.isInsideTable\n            && end.paragraph !== selection.getLastParagraphInLastCell(end.paragraph.associatedCell.ownerTable)\n            && (!start.paragraph.isInsideTable || start.paragraph.associatedCell.ownerTable !== end.paragraph.associatedCell.ownerTable)) {\n            return false;\n        }\n        selection.owner.isShiftingEnabled = true;\n        this.deleteSelectedContent(paragraph, selection, start, end, 2);\n        return true;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteSelectedContent = function (paragraph, selection, start, end, editAction) {\n        var indexInInline = 0;\n        var inlineObj = start.currentWidget.getInline(start.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        // if (!isNullOrUndefined(inline)) {\n        //     inline = selection.getNextRenderedInline(inline, indexInInline);\n        // }\n        // if (inline instanceof WFieldBegin && !isNullOrUndefined((inline as WFieldBegin).fieldEnd)) {\n        // tslint:disable-next-line:max-line-length\n        //     let fieldEndOffset: number = ((inline as WFieldBegin).fieldEnd.owner as WParagraph).getOffset((inline as WFieldBegin).fieldEnd, 1);\n        //     let fieldEndIndex: string = WordDocument.getHierarchicalIndexOf((inline as WFieldBegin).fieldEnd.owner as WParagraph, fieldEndOffset.toString());\n        //     let selectionEndIndex: string = end.getHierarchicalIndexInternal();\n        //     if (!TextPosition.isForwardSelection(fieldEndIndex, selectionEndIndex)) {\n        //         //If selection end is after field begin, moves selection start to field separator.\n        //         start.moveToInline((inline as WFieldBegin).fieldSeparator, 1);\n        //         selection.editPosition = start.getHierarchicalIndexInternal();\n        //         if (!isNullOrUndefined(selection.currentBaseHistoryInfo)) {\n        //             selection.currentBaseHistoryInfo.insertPosition = selection.editPosition;\n        //         }\n        //     }\n        // }\n        indexInInline = 0;\n        inlineObj = end.currentWidget.getInline(end.offset, indexInInline);\n        inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        // if (!isNullOrUndefined(inline)) {\n        //     inline = selection.getNextRenderedInline(inline, indexInInline);\n        // }\n        // if (inline instanceof WFieldEnd && !isNullOrUndefined((inline as WFieldEnd).fieldBegin)) {\n        // tslint:disable-next-line:max-line-length\n        //     let fieldBeginOffset: number = ((inline as WFieldEnd).fieldBegin.owner as WParagraph).getOffset((inline as WFieldEnd).fieldBegin, 0);\n        //     let fieldBeginIndex: string = WordDocument.getHierarchicalIndexOf((inline as WFieldEnd).fieldBegin.owner as WParagraph, fieldBeginOffset.toString());\n        //     let selectionStartIndex: string = start.getHierarchicalIndexInternal();\n        //     if (!TextPosition.isForwardSelection(selectionStartIndex, fieldBeginIndex)) {\n        //         //If field begin is before selection start, move selection end to inline item before field end.\n        //         let prevInline: WInline = selection.getPreviousTextInline(inline);\n        //         if (isNullOrUndefined(prevInline)) {\n        //             end.moveBackward();\n        //         } else {\n        //             end.moveToInline(prevInline, prevInline.length);\n        //         }\n        //     }\n        // }\n        if (end.paragraph !== paragraph) {\n            this.deleteSelectedContent(end.paragraph, selection, start, end, editAction);\n            return;\n        }\n        //  Selection start in cell.\n        if (end.paragraph.isInsideTable && (!start.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || selection.isCellSelected(end.paragraph.associatedCell, start, end))) {\n            end.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            this.deleteTableCell(end.paragraph.associatedCell, selection, start, end, editAction);\n        }\n        else {\n            this.deletePara(paragraph, start, end, editAction);\n        }\n    };\n    /**\n     * Merge the selected cells.\n     */\n    Editor.prototype.mergeCells = function () {\n        if (this.owner.isReadOnlyMode || !this.owner.isDocumentLoaded) {\n            return;\n        }\n        if (!isNullOrUndefined(this.viewer) && !this.selection.isEmpty) {\n            this.mergeSelectedCellsInTable();\n        }\n    };\n    /**\n     * Deletes the entire table at selection.\n     */\n    Editor.prototype.deleteTable = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        if (startPos.paragraph.isInsideTable) {\n            var table = this.getOwnerTable(this.selection.isForward).combineWidget(this.viewer);\n            this.selection.owner.isShiftingEnabled = true;\n            if (this.checkIsNotRedoing()) {\n                this.initHistory('DeleteTable');\n                //Sets the insert position in history info as current table.    \n                this.updateHistoryPosition(startPos, true);\n            }\n            var paragraph = this.getParagraphForSelection(table);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.editorHistory.currentBaseHistoryInfo.removedNodes.push(table.clone());\n            }\n            this.removeBlock(table);\n            this.selection.selectParagraph(paragraph, true);\n            if (this.checkIsNotRedoing() || isNullOrUndefined(this.editorHistory)) {\n                this.reLayout(this.selection);\n            }\n        }\n    };\n    /**\n     * Deletes the selected column(s).\n     */\n    Editor.prototype.deleteColumn = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        if (startPos.paragraph.isInsideTable) {\n            this.selection.owner.isShiftingEnabled = true;\n            if (this.checkIsNotRedoing()) {\n                this.initHistory('DeleteColumn');\n            }\n            var startCell = this.getOwnerCell(this.selection.isForward);\n            var endCell = this.getOwnerCell(!this.selection.isForward);\n            var table = startCell.ownerTable.combineWidget(this.viewer);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.cloneTableToHistoryInfo(table);\n            }\n            var paragraph = undefined;\n            if (endCell.nextWidget) {\n                var nextCell = endCell.nextWidget;\n                paragraph = this.selection.getFirstParagraph(nextCell);\n            }\n            else if (startCell.previousWidget) {\n                var previousCell = startCell.previousWidget;\n                paragraph = this.selection.getFirstParagraph(previousCell);\n            }\n            if (isNullOrUndefined(paragraph)) {\n                paragraph = this.getParagraphForSelection(table);\n            }\n            //retrieve the cell collection based on start and end cell to remove. \n            var deleteCells = table.getColumnCellsForSelection(startCell, endCell);\n            for (var i = 0; i < table.childWidgets.length; i++) {\n                var row = table.childWidgets[i];\n                if (row.childWidgets.length === 1) {\n                    if (deleteCells.indexOf(row.childWidgets[0]) >= 0) {\n                        table.childWidgets.splice(table.childWidgets.indexOf(row), 1);\n                        row.destroy();\n                        i--;\n                    }\n                }\n                else {\n                    for (var j = 0; j < row.childWidgets.length; j++) {\n                        var tableCell = row.childWidgets[j];\n                        if (deleteCells.indexOf(tableCell) >= 0) {\n                            row.childWidgets.splice(j, 1);\n                            tableCell.destroy();\n                            j--;\n                        }\n                    }\n                    if (row.childWidgets.length === 0) {\n                        table.childWidgets.splice(table.childWidgets.indexOf(row), 1);\n                        row.destroy();\n                        i--;\n                    }\n                }\n            }\n            if (table.childWidgets.length === 0) {\n                // Before disposing table reset the paragrph.\n                paragraph = this.getParagraphForSelection(table);\n                this.removeBlock(table);\n                if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                    this.editorHistory.currentBaseHistoryInfo.action = 'DeleteTable';\n                }\n                table.destroy();\n            }\n            else {\n                table.isGridUpdated = false;\n                table.buildTableColumns();\n                table.isGridUpdated = true;\n                this.viewer.layout.reLayoutTable(table);\n            }\n            this.selection.selectParagraph(paragraph, true);\n            if (isNullOrUndefined(this.editorHistory) || this.checkIsNotRedoing()) {\n                this.reLayout(this.selection, true);\n            }\n        }\n    };\n    /**\n     * Deletes the selected row(s).\n     */\n    Editor.prototype.deleteRow = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = !this.selection.isForward ? this.selection.end : this.selection.start;\n        var endPos = !this.selection.isForward ? this.selection.start : this.selection.end;\n        if (startPos.paragraph.isInsideTable) {\n            var startCell = this.getOwnerCell(this.selection.isForward);\n            var endCell = this.getOwnerCell(!this.selection.isForward);\n            if (this.checkIsNotRedoing()) {\n                this.initHistory('DeleteRow');\n            }\n            this.selection.owner.isShiftingEnabled = true;\n            var table = startCell.ownerTable.combineWidget(this.viewer);\n            var row = this.getOwnerRow(true);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.cloneTableToHistoryInfo(table);\n            }\n            var paragraph = undefined;\n            if (row.nextWidget) {\n                var nextCell = row.nextWidget.childWidgets[0];\n                paragraph = this.selection.getFirstParagraph(nextCell);\n            }\n            if (isNullOrUndefined(paragraph)) {\n                paragraph = this.getParagraphForSelection(table);\n            }\n            if (!this.selection.isEmpty) {\n                //tslint:disable-next-line:max-line-length\n                var containerCell = this.selection.getContainerCellOf(startCell, endCell);\n                if (containerCell.ownerTable.contains(endCell)) {\n                    startCell = this.selection.getSelectedCell(startCell, containerCell);\n                    endCell = this.selection.getSelectedCell(endCell, containerCell);\n                    if (this.selection.containsCell(containerCell, endCell)) {\n                        row = startCell.ownerRow;\n                        this.removeRow(row);\n                    }\n                    else {\n                        row = startCell.ownerRow;\n                        var endRow = endCell.ownerRow;\n                        //Update the selection paragraph.\n                        paragraph = undefined;\n                        if (endRow.nextWidget) {\n                            var nextCell = endRow.nextWidget.childWidgets[0];\n                            paragraph = this.selection.getFirstParagraph(nextCell);\n                        }\n                        if (isNullOrUndefined(paragraph)) {\n                            paragraph = this.getParagraphForSelection(table);\n                        }\n                        for (var i = 0; i < table.childWidgets.length; i++) {\n                            var tableRow = table.childWidgets[i];\n                            if (tableRow.rowIndex >= row.rowIndex && tableRow.rowIndex <= endRow.rowIndex) {\n                                table.childWidgets.splice(i, 1);\n                                tableRow.destroy();\n                                i--;\n                            }\n                        }\n                        if (table.childWidgets.length === 0) {\n                            this.removeBlock(table);\n                            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                                this.editorHistory.currentBaseHistoryInfo.action = 'DeleteTable';\n                            }\n                            table.destroy();\n                        }\n                        else {\n                            this.updateTable(table);\n                        }\n                    }\n                }\n            }\n            else {\n                this.removeRow(row);\n            }\n            this.selection.selectParagraph(paragraph, true);\n            if (isNullOrUndefined(this.editorHistory) || this.checkIsNotRedoing()) {\n                this.reLayout(this.selection, true);\n            }\n        }\n    };\n    Editor.prototype.removeRow = function (row) {\n        var table = row.ownerTable;\n        if (table.childWidgets.length === 1) {\n            this.removeBlock(table);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.editorHistory.currentBaseHistoryInfo.action = 'Delete';\n            }\n            table.destroy();\n        }\n        else {\n            table.childWidgets.splice(table.childWidgets.indexOf(row), 1);\n            row.destroy();\n            this.updateTable(table);\n        }\n    };\n    Editor.prototype.updateTable = function (table) {\n        table.updateRowIndex(0);\n        table.isGridUpdated = false;\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.viewer.layout.reLayoutTable(table);\n    };\n    Editor.prototype.getParagraphForSelection = function (table) {\n        var paragraph = undefined;\n        var nextWidget = table.nextWidget ? table.nextWidget : table.nextRenderedWidget;\n        var previousWidget = table.previousWidget ? table.previousWidget : table.previousRenderedWidget;\n        if (nextWidget) {\n            paragraph = nextWidget instanceof ParagraphWidget ? nextWidget\n                : this.selection.getFirstParagraphInFirstCell(nextWidget);\n        }\n        else if (previousWidget) {\n            paragraph = previousWidget instanceof ParagraphWidget ? previousWidget\n                : this.selection.getLastParagraphInLastCell(previousWidget);\n        }\n        return paragraph;\n    };\n    Editor.prototype.deletePara = function (paragraph, start, end, editAction) {\n        paragraph = paragraph.combineWidget(this.viewer);\n        var selection = this.viewer.selection;\n        var paragraphStart = selection.getStartOffset(paragraph);\n        var endParagraphStartOffset = selection.getStartOffset(end.paragraph);\n        var startOffset = paragraphStart;\n        var endOffset = 0;\n        var isCombineNextParagraph = false;\n        var lastLinelength = this.selection.getLineLength(paragraph.lastChild);\n        var currentParagraph = paragraph;\n        var section = paragraph.bodyWidget instanceof BodyWidget ? paragraph.bodyWidget : undefined;\n        var startLine = undefined;\n        var endLineWidget = undefined;\n        if (paragraph === start.paragraph) {\n            startOffset = start.offset;\n            startLine = start.currentWidget;\n            if (end.paragraph.isInsideTable) {\n                isCombineNextParagraph = this.isEndInAdjacentTable(paragraph, end.paragraph);\n            }\n        }\n        else {\n            startLine = paragraph.firstChild;\n        }\n        if (paragraph !== start.paragraph && selection.isSkipLayouting) {\n            selection.isSkipLayouting = false;\n        }\n        if (paragraph === end.paragraph) {\n            endLineWidget = end.currentWidget;\n            endOffset = end.offset;\n        }\n        else {\n            endLineWidget = paragraph.lastChild;\n            endOffset = this.viewer.selection.getLineLength(paragraph.lastChild);\n        }\n        var block = paragraph.previousRenderedWidget;\n        if (startOffset > paragraphStart && start.currentWidget === paragraph.lastChild &&\n            startOffset === lastLinelength && (paragraph === end.paragraph && end.offset === startOffset + 1 ||\n            paragraph.nextRenderedWidget === end.paragraph && end.offset === endParagraphStartOffset) ||\n            (this.editorHistory && this.editorHistory.isUndoing && this.editorHistory.currentHistoryInfo &&\n                this.editorHistory.currentHistoryInfo.action === 'PageBreak' && block && block.isPageBreak()\n                && (startOffset === 0 && !start.currentWidget.isFirstLine || startOffset > 0))) {\n            isCombineNextParagraph = true;\n        }\n        if (end.paragraph === paragraph && end.currentWidget !== paragraph.lastChild ||\n            (end.currentWidget === paragraph.lastChild && end.offset <= selection.getLineLength(paragraph.lastChild))) {\n            var isStartParagraph = start.paragraph === paragraph;\n            if (end.currentWidget.isFirstLine() && end.offset > paragraphStart || !end.currentWidget.isFirstLine()) {\n                //If selection end with this paragraph and selection doesnot include paragraph mark.               \n                this.removeInlines(paragraph, startLine, startOffset, endLineWidget, endOffset, editAction);\n                //Removes the splitted paragraph.\n            }\n            if (!isNullOrUndefined(block) && !isStartParagraph) {\n                var nextSection = block.bodyWidget instanceof BodyWidget ? block.bodyWidget : undefined;\n                if (nextSection && !section.equals(nextSection) && section.index !== nextSection.index) {\n                    this.deleteSection(selection, nextSection, section, editAction);\n                }\n                this.deleteBlock(block, selection, start, end, editAction);\n            }\n        }\n        else if (start.paragraph === paragraph && (start.currentWidget !== paragraph.firstChild ||\n            (start.currentWidget === paragraph.firstChild && startOffset > paragraphStart))) {\n            // If selection start is after paragraph start\n            //And selection does not end with this paragraph Or selection include paragraph mark.\n            if (editAction === 4) {\n                return;\n            }\n            else {\n                currentParagraph = this.splitParagraph(paragraph, paragraph.firstChild, 0, startLine, startOffset, true);\n                this.insertParagraphPaste(paragraph, currentParagraph, start, end, isCombineNextParagraph, editAction);\n                this.addRemovedNodes(paragraph);\n                return;\n            }\n        }\n        else {\n            var newParagraph = undefined;\n            var previousBlock = paragraph.previousWidget;\n            var prevParagraph = (previousBlock instanceof ParagraphWidget) ? previousBlock : undefined;\n            var nextWidget = paragraph.nextRenderedWidget;\n            if (editAction < 4) {\n                //Checks whether this is last paragraph of owner text body and previousBlock is not paragraph.\n                newParagraph = this.checkAndInsertBlock(paragraph, start, end, editAction, prevParagraph);\n                this.removeBlock(paragraph);\n                if (this.viewer.blockToShift === paragraph) {\n                    this.viewer.blockToShift = undefined;\n                }\n                this.addRemovedNodes(paragraph);\n                if (!isNullOrUndefined(newParagraph)) {\n                    selection.editPosition = this.getHierarchicalIndex(newParagraph, '0');\n                    var offset = selection.getParagraphLength(newParagraph) + 1;\n                    if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                        //tslint:disable-next-line:max-line-length\n                        this.editorHistory.currentBaseHistoryInfo.endPosition = this.getHierarchicalIndex(newParagraph, offset.toString());\n                    }\n                }\n                else if (paragraph === start.paragraph && isNullOrUndefined(nextWidget) && !isNullOrUndefined(prevParagraph)) {\n                    var offset = this.selection.getParagraphLength(prevParagraph);\n                    // if (isNullOrUndefined(block)) {\n                    selection.editPosition = this.getHierarchicalIndex(prevParagraph, offset.toString());\n                    if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                        this.updateHistoryPosition(selection.editPosition, true);\n                        this.editorHistory.currentBaseHistoryInfo.endPosition = selection.editPosition;\n                    }\n                    // } else {\n                    //     let offset: number = selection.getParagraphLength(paragraph) + 1;\n                    //     if (block instanceof ParagraphWidget) {\n                    //         prevParagraph = block as ParagraphWidget;\n                    //     }\n                    //     // if (block instanceof WTable) {\n                    //     //     prevParagraph = (block as WTable).getFirstParagraphInFirstCell();\n                    //     // }\n                    //     selection.editPosition = prevLineWidget.getHierarchicalIndex('0');\n                    // }\n                }\n            }\n            if (start.paragraph !== paragraph && !isNullOrUndefined(block)) {\n                var nextSection = block.bodyWidget instanceof BodyWidget ? block.bodyWidget : undefined;\n                // if (section !== nextSection) {\n                //     this.deleteSection(selection, section, nextSection, editAction);\n                // }\n                this.deleteBlock(block, selection, start, end, editAction);\n            }\n        }\n        this.insertParagraphPaste(paragraph, currentParagraph, start, end, isCombineNextParagraph, editAction);\n    };\n    Editor.prototype.deleteSection = function (selection, section, nextSection, editAction) {\n        if (editAction < 4) {\n            this.combineSectionInternal(selection, section, nextSection);\n        }\n        //Copies the section properties, if this is last paragraph of section.\n        if (editAction > 2) {\n            section.sectionFormat.copyFormat(nextSection.sectionFormat);\n        }\n    };\n    Editor.prototype.combineSectionInternal = function (selection, section, nextSection) {\n        // if (section.sectionFormat.isEqualFormat(nextSection.sectionFormat)) {\n        // } else {\n        var bodyWidget = section.getSplitWidgets()[0];\n        var currentSection = [];\n        this.combineSectionChild(bodyWidget, currentSection);\n        bodyWidget = currentSection[0];\n        var lastBlockIndex = bodyWidget.lastChild.index;\n        this.updateBlockIndex(lastBlockIndex + 1, nextSection.firstChild);\n        var insertIndex = 0;\n        var containerWidget = nextSection;\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var block = bodyWidget.childWidgets.splice(i, 1)[0];\n            containerWidget.childWidgets.splice(insertIndex, 0, block);\n            block.containerWidget = containerWidget;\n            this.viewer.layout.layoutBodyWidgetCollection(block.index, block.bodyWidget, block, false);\n            block = block.getSplitWidgets().pop();\n            containerWidget = block.containerWidget;\n            insertIndex = block.indexInOwner + 1;\n            i--;\n        }\n        this.updateSectionIndex(undefined, nextSection, false);\n        this.addRemovedNodes(bodyWidget);\n        // this.insert\n        // }\n    };\n    //tslint:disable:max-line-length\n    /**\n     * @private\n     */\n    Editor.prototype.checkAndInsertBlock = function (block, start, end, editAction, previousParagraph) {\n        if (block instanceof ParagraphWidget && block === start.paragraph || block instanceof TableWidget) {\n            var newParagraph = void 0; //Adds an empty paragraph, to ensure minimal content.\n            if (isNullOrUndefined(block.nextWidget) && (isNullOrUndefined(previousParagraph) || previousParagraph.nextRenderedWidget instanceof TableWidget)) {\n                newParagraph = new ParagraphWidget();\n                if (editAction === 1 && block instanceof ParagraphWidget) {\n                    newParagraph.characterFormat.copyFormat(block.characterFormat);\n                    newParagraph.paragraphFormat.copyFormat(block.paragraphFormat);\n                }\n                newParagraph.index = block.index + 1;\n                newParagraph.containerWidget = block.containerWidget;\n                this.viewer.layout.layoutBodyWidgetCollection(newParagraph.index, newParagraph.bodyWidget, newParagraph, false);\n                if (block.containerWidget instanceof Widget) {\n                    block.containerWidget.childWidgets.push(newParagraph);\n                }\n            }\n            return newParagraph;\n        }\n        return undefined;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.splitParagraph = function (paragraphAdv, startLine, startOffset, endLine, endOffset, removeBlock) {\n        var paragraph = new ParagraphWidget();\n        paragraph.paragraphFormat = new WParagraphFormat(paragraph);\n        paragraph.characterFormat = new WCharacterFormat(paragraph);\n        paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n        paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n        var lineWidget = new LineWidget(paragraph);\n        paragraph.childWidgets.push(lineWidget);\n        var blockIndex = paragraphAdv.index;\n        var insertIndex = paragraphAdv.indexInOwner;\n        this.moveInlines(paragraphAdv, paragraph, 0, startOffset, startLine, endOffset, endLine);\n        //Inserts new paragraph in the current text position.\n        paragraphAdv.containerWidget.childWidgets.splice(insertIndex, 0, paragraph);\n        paragraph.index = blockIndex;\n        paragraph.containerWidget = paragraphAdv.containerWidget;\n        this.updateNextBlocksIndex(paragraph, true);\n        if (removeBlock) {\n            this.removeBlock(paragraphAdv);\n        }\n        // tslint:disable-next-line:max-line-length\n        this.viewer.layout.layoutBodyWidgetCollection(blockIndex, paragraph.containerWidget, paragraph, false);\n        return paragraph;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeBlock = function (block) {\n        var index;\n        var blockCollection;\n        var containerWidget;\n        this.removeFieldInBlock(block);\n        if (block.isInsideTable) {\n            containerWidget = block.associatedCell;\n            index = block.associatedCell.childWidgets.indexOf(block);\n            blockCollection = block.associatedCell.childWidgets;\n            this.updateNextBlocksIndex(block, false);\n            block.associatedCell.childWidgets.splice(index, 1);\n            block.containerWidget = undefined;\n            this.viewer.layout.layoutBodyWidgetCollection(block.index, containerWidget, block, false);\n        }\n        else {\n            containerWidget = block.containerWidget;\n            index = containerWidget.childWidgets.indexOf(block);\n            blockCollection = containerWidget.childWidgets;\n            this.updateNextBlocksIndex(block, false);\n            containerWidget.childWidgets.splice(index, 1);\n            block.containerWidget = undefined;\n            containerWidget.height -= block.height;\n            this.viewer.layout.layoutBodyWidgetCollection(block.index, containerWidget, block, false);\n        }\n    };\n    Editor.prototype.removeField = function (block) {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            var field = this.viewer.fields[i];\n            if (field.line.paragraph === block) {\n                this.viewer.fields.splice(i, 1);\n                i--;\n            }\n        }\n    };\n    Editor.prototype.addRemovedNodes = function (node) {\n        if (node instanceof FieldElementBox && node.fieldType === 0) {\n            if (this.viewer.fields.indexOf(node) !== -1) {\n                this.viewer.fields.splice(this.viewer.fields.indexOf(node), 1);\n            }\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.currentBaseHistoryInfo.removedNodes.push(node);\n        }\n        else if (this.editHyperlinkInternal) {\n            this.nodes.push(node);\n        }\n    };\n    Editor.prototype.deleteBlock = function (block, selection, start, end, editAction) {\n        if (block instanceof ParagraphWidget) {\n            this.deletePara(block, start, end, editAction);\n        }\n        else {\n            this.deleteTableBlock(block, selection, start, end, editAction);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteTableCell = function (cellAdv, selection, start, end, editAction) {\n        var deletePreviousBlock = !(start.paragraph.isInsideTable && cellAdv.ownerTable.contains(start.paragraph.associatedCell));\n        var previousBlock = cellAdv.ownerTable.previousRenderedWidget;\n        if (start.paragraph.isInsideTable) {\n            var containerCell = selection.getContainerCellOf(cellAdv, start.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(start.paragraph.associatedCell)) {\n                var startCell = selection.getSelectedCell(cellAdv, containerCell);\n                var endCell = selection.getSelectedCell(start.paragraph.associatedCell, containerCell);\n                if (selection.containsCell(containerCell, start.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (selection.isCellSelected(containerCell, start, end)) {\n                        //Container cell is completely selected.\n                        this.updateEditPosition(containerCell, selection);\n                        if (editAction === 1) {\n                            //Specifically handled for backspace. Delete selected cell in current table.\n                            this.deleteCellsInTable(cellAdv.ownerRow.ownerTable, selection, start, end, editAction);\n                        }\n                        else {\n                            //Delete contents within table cell or Copy contents within table cell to clipboard.\n                            var isCellCleared = this.deleteCell(containerCell, selection, editAction, true);\n                            if (!isCellCleared && editAction !== 2 && this.editorHistory) {\n                                this.editorHistory.currentBaseHistoryInfo = undefined;\n                            }\n                            else if (isCellCleared) {\n                                this.viewer.layout.reLayoutTable(containerCell.ownerRow.ownerTable);\n                            }\n                        }\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.deletePara(end.paragraph, start, end, editAction);\n                        }\n                        else {\n                            this.deleteContainer(startCell, selection, start, end, editAction);\n                        }\n                    }\n                }\n                else {\n                    if (editAction === 2) {\n                        //Delete contents within table cell.\n                        this.deleteCell(cellAdv, selection, 2, false);\n                    }\n                    else {\n                        //Delete other selected cells in current table.\n                        this.deleteCellsInTable(containerCell.ownerTable, selection, start, end, editAction);\n                    }\n                }\n            }\n            else {\n                //Selection end is different table.\n                this.deleteContainer(containerCell, selection, start, end, editAction);\n            }\n        }\n        else {\n            //Selection end is outside table.\n            var cell = selection.getContainerCell(cellAdv);\n            this.deleteContainer(cell, selection, start, end, editAction);\n        }\n        if (deletePreviousBlock) {\n            var sectionAdv = previousBlock.bodyWidget instanceof BodyWidget ? previousBlock.bodyWidget : undefined;\n            // this.deleteContent(cellAdv.ownerTable, selection, editAction);\n            if (!isNullOrUndefined(previousBlock)) {\n                // let nextSection: WSection = blockAdv.section instanceof WSection ? blockAdv.section as WSection : undefined;\n                // if (sectionAdv !== nextSection) {\n                //     this.deleteSection(selection, sectionAdv, nextSection, editAction);\n                // }\n                //Goto the next block.\n                this.deleteBlock(previousBlock, selection, start, end, editAction);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteCellsInTable = function (table, selection, start, end, editAction) {\n        var clonedTable = undefined;\n        var isDeleteCells = false;\n        var action = 'Delete';\n        var startCell = start.paragraph.associatedCell;\n        var endCell = end.paragraph.associatedCell;\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            action = this.editorHistory.currentBaseHistoryInfo.action;\n            //tslint:disable-next-line:max-line-length\n            isDeleteCells = this.editorHistory.currentBaseHistoryInfo.action === 'BackSpace' || this.editorHistory.currentBaseHistoryInfo.action === 'DeleteCells'\n                || this.editorHistory.currentBaseHistoryInfo.action === 'InsertTable' || (isNullOrUndefined(startCell.ownerRow.previousWidget)\n                && isNullOrUndefined(endCell.ownerRow.nextWidget) && this.editorHistory.currentBaseHistoryInfo.action === 'Cut');\n            this.editorHistory.currentBaseHistoryInfo.action = isDeleteCells ? 'DeleteCells' : 'ClearCells';\n            clonedTable = this.cloneTableToHistoryInfo(table);\n            selection.owner.isLayoutEnabled = false;\n        }\n        var startColumnIndex = startCell.columnIndex;\n        var endColumnIndex = endCell.columnIndex + endCell.cellFormat.columnSpan - 1;\n        var startRowIndex = startCell.rowIndex;\n        var endRowIndex = endCell.rowIndex;\n        var cells = [];\n        var isStarted = false;\n        var isCellCleared = false;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.index >= startRowIndex && row.index <= endRowIndex) {\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    var cell = row.childWidgets[j];\n                    if (cell.columnIndex >= startColumnIndex && cell.columnIndex <= endColumnIndex) {\n                        if (!isStarted) {\n                            this.updateEditPosition(cell, selection);\n                            isStarted = true;\n                        }\n                        if (isDeleteCells) {\n                            //Specific for Backspace and Cut if selection includes all rows.\n                            var cell_1 = row.childWidgets[j];\n                            this.updateNextBlocksIndex(cell_1, false);\n                            row.childWidgets.splice(j, 1);\n                            j--;\n                        }\n                        else if (editAction < 4) {\n                            isCellCleared = this.deleteCell(cell, selection, editAction, false);\n                        }\n                    }\n                }\n                if (row.childWidgets.length === 0) {\n                    this.updateNextBlocksIndex(table.childWidgets[i], false);\n                    table.childWidgets.splice(i, 1);\n                    i--;\n                    endRowIndex--;\n                }\n            }\n        }\n        //Layouts the table after delete cells.\n        selection.owner.isLayoutEnabled = true;\n        if (table.childWidgets.length === 0) {\n            selection.editPosition = this.getHierarchicalIndex(table, '0');\n            this.setActionInternal(selection, action);\n            this.removeBlock(table);\n        }\n        else {\n            // Before lay outing need to update table grid.\n            table.isGridUpdated = false;\n            table.buildTableColumns();\n            table.isGridUpdated = true;\n            this.viewer.layout.reLayoutTable(table);\n        }\n    };\n    Editor.prototype.deleteCell = function (cell, selection, editAction, copyChildToClipboard) {\n        //Checks whether this is last paragraph of owner textbody.\n        var block = cell.childWidgets[0];\n        if (cell.childWidgets.length === 1 && block instanceof ParagraphWidget && block.isEmpty()) {\n            return false;\n        }\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            block = cell.childWidgets[i];\n            if (editAction < 4) {\n                //Checks whether this is last paragraph of owner textbody.\n                if (block instanceof ParagraphWidget && cell.childWidgets.length === 1) {\n                    //Preserves empty paragraph, to ensure minimal content.\n                    var paragraph = block;\n                    //Removes all the inlines in the paragraph.\n                    for (var j = 0; j < paragraph.childWidgets.length; j++) {\n                        var inline = paragraph.childWidgets[j];\n                        for (var k = 0; k < inline.children.length; k++) {\n                            var element = inline.children[k];\n                            this.unLinkFieldCharacter(element);\n                            inline.children.splice(k, 1);\n                            // this.layoutInlineCollection(true, paragraph.inlines.indexOf(inline), paragraph.inlines, inline);\n                            k--;\n                            if (this.checkClearCells(selection)) {\n                                this.addRemovedNodes(element);\n                            }\n                        }\n                        if (paragraph.childWidgets.length > 1) {\n                            paragraph.childWidgets.splice(j, 1);\n                            j--;\n                        }\n                    }\n                    if (this.checkClearCells(selection)) {\n                        //Add Index for line Widget\n                        selection.editPosition = this.getHierarchicalIndex(paragraph, '0');\n                        this.updateHistoryPosition(selection.editPosition, true);\n                    }\n                    break;\n                }\n                this.removeBlock(block);\n                i--;\n                if (this.checkClearCells(selection)) {\n                    this.addRemovedNodes(block);\n                }\n            }\n        }\n        return true;\n    };\n    Editor.prototype.deleteContainer = function (cell, selection, start, end, editAction) {\n        var ownerTable = cell.ownerTable;\n        if (selection.containsRow(ownerTable.lastChild, end.paragraph.associatedCell)) {\n            this.deleteContent(ownerTable, selection, editAction);\n        }\n        else {\n            for (var i = 0; i < ownerTable.childWidgets.length; i++) {\n                var row = ownerTable.childWidgets[i];\n                if (editAction < 4) {\n                    this.updateNextBlocksIndex(row, false);\n                    ownerTable.childWidgets.splice(i, 1);\n                    this.addRemovedNodes(row);\n                    i--;\n                }\n                if (end.paragraph.isInsideTable && selection.containsRow(row, end.paragraph.associatedCell)) {\n                    this.viewer.layout.reLayoutTable(ownerTable);\n                    return;\n                }\n            }\n        }\n    };\n    Editor.prototype.deleteTableBlock = function (table, selection, start, end, editAction) {\n        table = table.combineWidget(this.viewer);\n        if (start.paragraph.isInsideTable && table.contains(start.paragraph.associatedCell)) {\n            var block = table.previousRenderedWidget;\n            // tslint:disable-next-line:max-line-length\n            var previousBlock = this.checkAndInsertBlock(table, start, end, editAction, block instanceof ParagraphWidget ? block : undefined);\n            if (selection.containsRow(table.firstChild, start.paragraph.associatedCell)) {\n                this.deleteContent(table, selection, editAction);\n            }\n            else {\n                var newTable = this.splitTable(table, start.paragraph.associatedCell.ownerRow);\n                this.deleteContent(table, selection, editAction);\n                this.viewer.layout.layoutBodyWidgetCollection(newTable.index, newTable.containerWidget, newTable, false);\n            }\n            if (!isNullOrUndefined(previousBlock)) {\n                selection.editPosition = this.getHierarchicalIndex(previousBlock, '0');\n                if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                    this.editorHistory.currentBaseHistoryInfo.endPosition = selection.editPosition;\n                }\n            }\n        }\n        else {\n            var blockAdv = table.previousRenderedWidget;\n            var sectionAdv = table.bodyWidget instanceof BodyWidget ? table.bodyWidget : undefined;\n            this.deleteContent(table, selection, editAction);\n            if (!isNullOrUndefined(blockAdv)) {\n                // let nextSection: WSection = blockAdv.section instanceof WSection ? blockAdv.section as WSection : undefined;\n                // if (sectionAdv !== nextSection) {\n                //     this.deleteSection(selection, sectionAdv, nextSection, editAction);\n                // }\n                //Goto the next block.\n                this.deleteBlock(blockAdv, selection, start, end, editAction);\n            }\n        }\n    };\n    Editor.prototype.splitTable = function (table, splitEndRow) {\n        var newTable = new TableWidget();\n        newTable.tableFormat.copyFormat(table.tableFormat);\n        newTable.index = table.index;\n        //Moves the rows to new table.\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row === splitEndRow) {\n                break;\n            }\n            newTable.childWidgets.push(row);\n            row.containerWidget = newTable;\n            table.childWidgets.splice(i, 1);\n            i--;\n        }\n        //Inserts new table in the current text position.\n        var insertIndex = table.getIndex();\n        table.containerWidget.childWidgets.splice(insertIndex, 0, newTable);\n        newTable.containerWidget = table.containerWidget;\n        this.updateNextBlocksIndex(newTable, true);\n        return newTable;\n    };\n    Editor.prototype.updateEditPosition = function (cell, selection) {\n        var firstParagraph = selection.getFirstParagraphInCell(cell);\n        selection.editPosition = this.getHierarchicalIndex(firstParagraph, '0');\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteContent = function (table, selection, editAction) {\n        if (editAction < 4) {\n            this.removeBlock(table);\n            this.addRemovedNodes(table);\n        }\n    };\n    Editor.prototype.setActionInternal = function (selection, action) {\n        if (this.viewer.owner.enableHistoryMode && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.currentBaseHistoryInfo.action = action;\n        }\n    };\n    Editor.prototype.checkClearCells = function (selection) {\n        // tslint:disable-next-line:max-line-length\n        return this.editorHistory && this.editorHistory.currentBaseHistoryInfo && this.editorHistory.currentBaseHistoryInfo.action !== 'ClearCells';\n    };\n    Editor.prototype.isEndInAdjacentTable = function (paragraph, endParagraph) {\n        var start = this.getHierarchicalIndex(paragraph, '');\n        var end = this.getHierarchicalIndex(endParagraph, '');\n        var selectionStart = start.split(';');\n        var selectionEnd = end.split(';');\n        return selectionStart.length < selectionEnd.length;\n    };\n    Editor.prototype.cloneTableToHistoryInfo = function (table) {\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            //Clones the entire table to preserve in history.\n            var clonedTable = table.clone();\n            //Preserves the cloned table in history info, for future undo operation.\n            this.editorHistory.currentBaseHistoryInfo.removedNodes.push(clonedTable);\n            //Sets the insert position in history info as current table.\n            if (this.viewer.selection.start.paragraph.isInsideTable &&\n                this.viewer.selection.start.paragraph.associatedCell.ownerTable === table) {\n                this.updateHistoryPosition(this.getHierarchicalIndex(table, '0'), true);\n            }\n            return clonedTable;\n        }\n        return undefined;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.insertParagraphPaste = function (paragraph, currentParagraph, start, end, isCombineNextParagraph, editAction) {\n        if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing) && this.editorHistory.currentBaseHistoryInfo.action === 'Paste') {\n            var nextParagraph = this.selection.getNextParagraphBlock(currentParagraph);\n            if (nextParagraph) {\n                if (start.offset > 0 && nextParagraph === end.paragraph && paragraph === start.paragraph\n                    && this.editorHistory.currentBaseHistoryInfo.action === 'Paste') {\n                    //Combines the current paragraph with end paragraph specific for undo/redo paste action.\n                    var insertIndex = 0;\n                    this.removeBlock(currentParagraph);\n                    this.viewer.layout.clearListElementBox(nextParagraph);\n                    this.viewer.layout.clearListElementBox(currentParagraph);\n                    for (var i = 0; i < currentParagraph.childWidgets.length; i++) {\n                        var line = currentParagraph.childWidgets[i];\n                        nextParagraph.childWidgets.splice(insertIndex, 0, line);\n                        currentParagraph.childWidgets.splice(i, 1);\n                        i--;\n                        insertIndex++;\n                        line.paragraph = nextParagraph;\n                    }\n                    this.viewer.layout.reLayoutParagraph(nextParagraph, 0, 0);\n                    isCombineNextParagraph = false;\n                    var offset = this.selection.editPosition.substring(this.selection.editPosition.lastIndexOf(';') + 1);\n                    this.selection.editPosition = this.getHierarchicalIndex(nextParagraph, offset);\n                }\n            }\n        }\n        if (isCombineNextParagraph) {\n            this.deleteParagraphMark(currentParagraph, this.selection, editAction);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.removeInlines = function (paragraph, startLine, startOffset, endLine, endOffset, editAction) {\n        var isRemoved = false;\n        this.viewer.layout.clearListElementBox(paragraph);\n        var startIndex = paragraph.childWidgets.indexOf(startLine);\n        for (var i = paragraph.childWidgets.length - 1; i >= 0; i--) {\n            var lineWidget = paragraph.childWidgets[i];\n            if (startLine === lineWidget && endLine === lineWidget) {\n                this.removeContent(lineWidget, startOffset, endOffset);\n                isRemoved = true;\n                break;\n            }\n            if (endLine === lineWidget) {\n                isRemoved = true;\n                this.removeContent(lineWidget, 0, endOffset);\n            }\n            else if (startLine === lineWidget) {\n                this.removeContent(lineWidget, startOffset, this.viewer.selection.getLineLength(lineWidget));\n                break;\n            }\n            else if (isRemoved) {\n                this.removeContent(lineWidget, 0, this.viewer.selection.getLineLength(lineWidget));\n            }\n        }\n        if (isRemoved) {\n            this.removeEmptyLine(paragraph);\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeContent = function (lineWidget, startOffset, endOffset) {\n        var count = this.selection.getLineLength(lineWidget);\n        for (var i = lineWidget.children.length - 1; i >= 0; i--) {\n            var inline = lineWidget.children[i];\n            if (endOffset <= count - inline.length) {\n                count -= inline.length;\n                continue;\n            }\n            var endIndex = inline.length;\n            if (count > endOffset && (count - endIndex < endOffset)) {\n                endIndex = endOffset - (count - inline.length);\n            }\n            var startIndex = 0;\n            if (count - inline.length < startOffset) {\n                startIndex = startOffset - (count - inline.length);\n            }\n            if (count > endOffset) {\n                count -= (inline.length - endIndex);\n            }\n            if (startIndex === 0 && endIndex === inline.length) {\n                if (!(this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing))) {\n                    if (inline instanceof BookmarkElementBox) {\n                        this.removedBookmarkElements.push(inline);\n                    }\n                }\n                // if (editAction < 4) {\n                this.unLinkFieldCharacter(inline);\n                this.addRemovedNodes(lineWidget.children[i]);\n                lineWidget.children.splice(i, 1);\n                // }\n            }\n            else if (inline instanceof TextElementBox) {\n                // if (editAction < 4) {\n                var span = new TextElementBox();\n                span.characterFormat.copyFormat(inline.characterFormat);\n                span.text = inline.text.substr(startIndex, endIndex - startIndex);\n                this.addRemovedNodes(span);\n                inline.text = inline.text.slice(0, startIndex) + inline.text.slice(endIndex);\n            }\n            if (startOffset >= count - (endIndex - startIndex)) {\n                break;\n            }\n            count -= (endIndex - startIndex);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeEmptyLine = function (paragraph) {\n        if (paragraph.childWidgets.length > 1) {\n            for (var i = 0; i < paragraph.childWidgets.length; i++) {\n                var lineWidget = paragraph.childWidgets[i];\n                if (lineWidget.children.length === 0 && paragraph.childWidgets.length > 1) {\n                    paragraph.childWidgets.splice(i, 1);\n                    i--;\n                }\n            }\n        }\n    };\n    //#endregion\n    /**\n     * clone the list level\n     * @param  {WListLevel} source\n     * @private\n     */\n    Editor.prototype.cloneListLevel = function (source) {\n        var listLevel = new WListLevel(undefined);\n        this.copyListLevel(listLevel, source);\n        return listLevel;\n    };\n    /**\n     * Copies the list level\n     * @param  {WListLevel} destination\n     * @param  {WListLevel} listLevel\n     * @private\n     */\n    Editor.prototype.copyListLevel = function (destination, listLevel) {\n        if (!isNullOrUndefined(listLevel.paragraphFormat)) {\n            destination.paragraphFormat = new WParagraphFormat(destination);\n            destination.paragraphFormat.copyFormat(listLevel.paragraphFormat);\n        }\n        if (!isNullOrUndefined(listLevel.characterFormat)) {\n            destination.characterFormat = new WCharacterFormat(destination);\n            destination.characterFormat.copyFormat(listLevel.characterFormat);\n        }\n        if (!isNullOrUndefined(listLevel.followCharacter)) {\n            destination.followCharacter = listLevel.followCharacter;\n        }\n        if (!isNullOrUndefined(listLevel.listLevelPattern)) {\n            destination.listLevelPattern = listLevel.listLevelPattern;\n        }\n        if (!isNullOrUndefined(listLevel.numberFormat)) {\n            destination.numberFormat = listLevel.numberFormat;\n        }\n        if (!isNullOrUndefined(listLevel.restartLevel)) {\n            destination.restartLevel = listLevel.restartLevel;\n        }\n        if (!isNullOrUndefined(listLevel.startAt)) {\n            destination.startAt = listLevel.startAt;\n        }\n    };\n    /**\n     * Clone level override\n     * @param  {WLevelOverride} source\n     * @private\n     */\n    Editor.prototype.cloneLevelOverride = function (source) {\n        var levelOverride = new WLevelOverride();\n        if (!isNullOrUndefined(source.startAt)) {\n            levelOverride.startAt = source.startAt;\n        }\n        if (!isNullOrUndefined(source.overrideListLevel)) {\n            levelOverride.overrideListLevel = source.overrideListLevel;\n        }\n        if (!isNullOrUndefined(source.levelNumber)) {\n            levelOverride.levelNumber = source.levelNumber;\n        }\n        return levelOverride;\n    };\n    /**\n     * Update List Paragraph\n     * @private\n     */\n    Editor.prototype.updateListParagraphs = function () {\n        this.viewer.listParagraphs = [];\n        for (var j = 0; j < this.viewer.pages.length; j++) {\n            var bodyWidget = this.viewer.pages[j].bodyWidgets[0];\n            for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n                this.updateListParagraphsInBlock(bodyWidget.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateListParagraphsInBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            if (!isNullOrUndefined(block.paragraphFormat)\n                && !isNullOrUndefined(block.paragraphFormat.listFormat)\n                && !isNullOrUndefined(block.paragraphFormat.listFormat.listId)) {\n                if (isNullOrUndefined(this.viewer.listParagraphs)) {\n                    this.viewer.listParagraphs = [];\n                }\n                this.viewer.listParagraphs.push(block);\n            }\n        }\n        else if (block instanceof TableWidget) {\n            for (var i = 0; i < block.childWidgets.length; i++) {\n                for (var j = 0; j < block.childWidgets[i].childWidgets.length; j++) {\n                    var cell = block.childWidgets[i].childWidgets[j];\n                    for (var k = 0; k < cell.childWidgets.length; k++) {\n                        this.updateListParagraphsInBlock(cell.childWidgets[k]);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Applies list format\n     * @param  {WList} list\n     * @private\n     */\n    Editor.prototype.onApplyList = function (list) {\n        var selection = this.viewer.selection;\n        this.setOffsetValue(this.viewer.selection);\n        this.initHistory('ListFormat');\n        var format = new WListFormat();\n        if (!isNullOrUndefined(list)) {\n            format.listId = list.listId;\n        }\n        this.viewer.owner.isShiftingEnabled = true;\n        if (selection.isEmpty) {\n            this.applyParaFormatProperty(selection.start.paragraph, 'listFormat', format, false);\n            this.layoutItemBlock(selection.start.paragraph, false);\n        }\n        else {\n            this.updateSelectionParagraphFormatting('listFormat', format, false);\n        }\n        this.reLayout(selection);\n    };\n    /**\n     * Applies bullets or numbering list\n     * @param  {string} format\n     * @param  {ListLevelPattern} listLevelPattern\n     * @param  {string} fontFamily\n     * @private\n     */\n    Editor.prototype.applyBulletOrNumbering = function (format, listLevelPattern, fontFamily) {\n        var selection = this.viewer.selection;\n        var list = selection.paragraphFormat.getList();\n        var isUpdate = false;\n        var start = selection.start;\n        if (!selection.isForward) {\n            start = selection.end;\n        }\n        var currentParagraph = start.paragraph;\n        if (isNullOrUndefined(list)) {\n            while (!isNullOrUndefined(currentParagraph.previousWidget) && currentParagraph.previousWidget instanceof ParagraphWidget\n                && currentParagraph.previousWidget.isEmpty() && currentParagraph.previousWidget.paragraphFormat.listFormat.listId === -1) {\n                currentParagraph = currentParagraph.previousWidget;\n            }\n            if (currentParagraph.previousWidget && currentParagraph.previousWidget instanceof ParagraphWidget\n                && currentParagraph.previousWidget.paragraphFormat.listFormat.listId !== -1) {\n                currentParagraph = currentParagraph.previousWidget;\n                list = this.viewer.getListById(currentParagraph.paragraphFormat.listFormat.listId);\n                isUpdate = true;\n            }\n        }\n        var startListLevel = undefined;\n        if (!isNullOrUndefined(list)) {\n            var tempList = this.viewer.getListById(currentParagraph.paragraphFormat.listFormat.listId);\n            startListLevel = this.viewer.layout.getListLevel(tempList, currentParagraph.paragraphFormat.listFormat.listLevelNumber);\n        }\n        if (isNullOrUndefined(list) || (!isNullOrUndefined(list) && ((startListLevel.listLevelPattern !== listLevelPattern) ||\n            startListLevel.numberFormat !== format || (startListLevel.characterFormat.fontFamily !== fontFamily\n            && startListLevel.listLevelPattern === 'Bullet')))) {\n            isUpdate = false;\n            list = new WList();\n            if (this.viewer.lists.length > 0) {\n                list.listId = this.viewer.lists[this.viewer.lists.length - 1].listId + 1;\n            }\n            else {\n                list.listId = 0;\n            }\n            var abstractList = new WAbstractList();\n            if (this.viewer.abstractLists.length > 0) {\n                abstractList.abstractListId = this.viewer.abstractLists[this.viewer.abstractLists.length - 1].abstractListId + 1;\n            }\n            else {\n                abstractList.abstractListId = 0;\n            }\n            list.abstractListId = abstractList.abstractListId;\n            list.abstractList = abstractList;\n            this.viewer.abstractLists.push(abstractList);\n            if (format === 'bullet' || format === 'multiLevel' || format === 'numbering') {\n                this.addListLevels(abstractList, format, selection);\n            }\n            else {\n                var listLevel = new WListLevel(abstractList);\n                listLevel.listLevelPattern = listLevelPattern;\n                listLevel.numberFormat = format;\n                if (listLevelPattern !== 'Bullet') {\n                    listLevel.startAt = 1;\n                }\n                else {\n                    listLevel.characterFormat.fontFamily = fontFamily;\n                }\n                listLevel.paragraphFormat.leftIndent = 36;\n                listLevel.paragraphFormat.firstLineIndent = -18;\n                abstractList.levels.push(listLevel);\n                selection.paragraphFormat.listLevelNumber = 0;\n            }\n            selection.paragraphFormat.setList(list);\n        }\n        else if (!isNullOrUndefined(list) && isUpdate) {\n            selection.paragraphFormat.setList(list);\n        }\n        else {\n            selection.paragraphFormat.setList(undefined);\n        }\n    };\n    Editor.prototype.addListLevels = function (abstractListAdv, listName, selection) {\n        var bulletCharacters = ['\\uf076', '\\uf0d8', '\\uf0a7', '\\uf0b7', '\\uf0a8'];\n        for (var i = abstractListAdv.levels.length; i < 9; i++) {\n            var listLevel = new WListLevel(abstractListAdv);\n            if (listName.match('bullet')) {\n                listLevel.listLevelPattern = 'Bullet';\n                listLevel.numberFormat = bulletCharacters[i < 5 ? i % 5 : i % 5 + 1];\n                listLevel.characterFormat.fontFamily = i < 3 || i === 5 ? 'Wingdings' : 'Symbol';\n            }\n            else {\n                if (listName.match('multiLevel')) {\n                    for (var j = 0; j < i + 1; j++) {\n                        listLevel.numberFormat += '%' + (j + 1).toString() + '.';\n                    }\n                    listLevel.listLevelPattern = 'Number';\n                }\n                else {\n                    listLevel.numberFormat = '%' + (i + 1).toString() + ')';\n                    listLevel.listLevelPattern = i % 3 === 0 ? 'Number'\n                        : i % 3 === 1 ? 'LowLetter' : 'LowRoman';\n                }\n                listLevel.startAt = 1;\n                listLevel.restartLevel = i;\n            }\n            if (i === 0) {\n                listLevel.paragraphFormat.leftIndent = 36;\n            }\n            else {\n                listLevel.paragraphFormat.leftIndent = 36 * i;\n            }\n            listLevel.paragraphFormat.firstLineIndent = -18;\n            abstractListAdv.levels.push(listLevel);\n            selection.paragraphFormat.listLevelNumber = i;\n        }\n    };\n    /**\n     * Insert page break at cursor position\n     */\n    Editor.prototype.insertPageBreak = function () {\n        if (!this.owner.isReadOnlyMode) {\n            if (this.viewer.selection.start.paragraph.isInsideTable ||\n                this.viewer.selection.start.paragraph.isInHeaderFooter) {\n                return;\n            }\n            this.initComplexHistory('PageBreak');\n            this.onEnter(true);\n            if (this.editorHistory && this.editorHistory.currentHistoryInfo != null) {\n                this.editorHistory.updateComplexHistory();\n            }\n            this.selection.checkForCursorVisibility();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onEnter = function (isInsertPageBreak) {\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            //ToDo: Need to handle the CTRL + Enter (Page Break) and SHIFT + Enter (Line Break) behavior.\n            var hyperlinkField = selection.getHyperlinkField();\n            var isSelectionOnHyperlink = !isNullOrUndefined(hyperlinkField);\n            if (isSelectionOnHyperlink) {\n                selection.fireRequestNavigate(hyperlinkField);\n                return;\n            }\n            var paragraph = selection.start.paragraph;\n            if (paragraph.isEmpty() && paragraph.paragraphFormat.listFormat.listId !== -1) {\n                // tslint:disable-next-line:max-line-length\n                this.onApplyListInternal(this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId), paragraph.paragraphFormat.listFormat.listLevelNumber - 1);\n                return;\n            }\n        }\n        this.initHistory('Enter');\n        var isRemoved = true;\n        if (!selection.isEmpty) {\n            // this.initHistoryWithSelection(selection, 'Enter');\n            isRemoved = this.removeSelectedContents(selection);\n        }\n        if (isRemoved) {\n            selection.owner.isShiftingEnabled = true;\n            this.updateInsertPosition();\n            var blockInfo = this.getParagraphInfo(selection.start);\n            var initialStart = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            this.splitParagraphInternal(selection, selection.start.paragraph, selection.start.currentWidget, selection.start.offset);\n            this.setPositionForCurrentIndex(selection.start, initialStart);\n            if (isInsertPageBreak) {\n                var currentParagraph = selection.start.paragraph;\n                var breakParagraph = new ParagraphWidget();\n                breakParagraph.characterFormat.copyFormat(currentParagraph.characterFormat);\n                breakParagraph.paragraphFormat.copyFormat(currentParagraph.paragraphFormat);\n                var pageBreak = new TextElementBox();\n                pageBreak.text = '\\f';\n                var line = new LineWidget(breakParagraph);\n                line.children.push(pageBreak);\n                pageBreak.line = line;\n                breakParagraph.childWidgets.push(line);\n                this.insertParagraph(breakParagraph, true);\n                selection.selectParagraph(breakParagraph, true);\n            }\n            var nextNode = selection.start.paragraph.nextWidget;\n            if (isNullOrUndefined(nextNode)) {\n                nextNode = selection.getNextRenderedBlock(selection.start.paragraph);\n            }\n            selection.selectParagraph(nextNode, true);\n            this.updateEndPosition();\n            if (isInsertPageBreak && this.editorHistory) {\n                this.owner.editorHistory.updateHistory();\n            }\n            // if (!isNullOrUndefined(selection.currentHistoryInfo)) {\n            //     this.updateComplexHistory();\n            // } else {\n            this.reLayout(selection);\n            // }\n            var paragraph = selection.start.paragraph.previousWidget;\n            if (!isNullOrUndefined(paragraph) && !paragraph.isEmpty() &&\n                // tslint:disable-next-line:max-line-length\n                paragraph.lastChild.children[paragraph.lastChild.children.length - 1] instanceof TextElementBox) {\n                this.checkAndConvertToHyperlink(selection, true, paragraph);\n            }\n        }\n    };\n    Editor.prototype.splitParagraphInternal = function (selection, paragraphAdv, currentLine, offset) {\n        var insertIndex = 0;\n        var blockIndex = paragraphAdv.index;\n        var paragraph = new ParagraphWidget();\n        var lineWidget = new LineWidget(paragraph);\n        paragraph.childWidgets.push(lineWidget);\n        //Copies the format to new paragraph.\n        paragraph.paragraphFormat.ownerBase = paragraph;\n        if (currentLine === paragraphAdv.lastChild && offset === selection.getLineLength(currentLine)) {\n            // tslint:disable-next-line:max-line-length\n            if (paragraphAdv.paragraphFormat.baseStyle\n                && paragraphAdv.paragraphFormat.baseStyle.name !== 'Normal' && paragraphAdv.paragraphFormat.baseStyle.next instanceof WParagraphStyle) {\n                if (paragraphAdv.paragraphFormat.baseStyle.name === paragraphAdv.paragraphFormat.baseStyle.next.name) {\n                    paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n                    paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n                }\n                else {\n                    paragraph.paragraphFormat.baseStyle = paragraphAdv.paragraphFormat.baseStyle.next;\n                }\n                this.selection.skipFormatRetrieval = false;\n            }\n            else {\n                paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n                paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n            }\n            //ToDo in future: Need to skip copying formattings to new paragraph, if the style for following paragraph is same style.\n            insertIndex++;\n            blockIndex++;\n        }\n        else {\n            paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n            paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n            if (offset > 0 || !currentLine.isFirstLine()) {\n                paragraphAdv = paragraphAdv.combineWidget(this.viewer);\n                this.moveInlines(paragraphAdv, paragraph, 0, 0, paragraphAdv.firstChild, offset, currentLine);\n            }\n            paragraphAdv = paragraphAdv.getSplitWidgets()[0];\n        }\n        insertIndex += paragraphAdv.getIndex();\n        var container = paragraphAdv.containerWidget;\n        var childNodes = container.childWidgets;\n        childNodes.splice(insertIndex, 0, paragraph);\n        paragraph.containerWidget = container;\n        paragraph.index = blockIndex;\n        this.updateNextBlocksIndex(paragraph, true);\n        // tslint:disable-next-line:max-line-length\n        this.viewer.layout.layoutBodyWidgetCollection(blockIndex, container, paragraph, false);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateNextBlocksIndex = function (block, increaseIndex) {\n        var nextIndex = block.containerWidget.childWidgets.indexOf(block) + 1;\n        if (block.containerWidget instanceof BodyWidget) {\n            var currentSectionIndex = block.containerWidget.index;\n            for (var j = this.viewer.pages.indexOf(block.containerWidget.page); j < this.viewer.pages.length; j++) {\n                var page = this.viewer.pages[j];\n                if (page.bodyWidgets[0].index === currentSectionIndex) {\n                    for (var k = nextIndex; k < page.bodyWidgets[0].childWidgets.length; k++) {\n                        var childWidget = page.bodyWidgets[0].childWidgets[k];\n                        this.updateIndex(childWidget, increaseIndex);\n                    }\n                    nextIndex = 0;\n                }\n                else {\n                    return;\n                }\n            }\n        }\n        else if (block.containerWidget instanceof TableCellWidget) {\n            var cells = block.containerWidget.getSplitWidgets();\n            var currentCellIndex = cells.indexOf(block.containerWidget);\n            for (var x = currentCellIndex; x < cells.length; x++) {\n                var blocks = cells[x].childWidgets;\n                for (var y = nextIndex; y < blocks.length; y++) {\n                    this.updateIndex(blocks[y], increaseIndex);\n                }\n                currentCellIndex = 0;\n                nextIndex = 0;\n            }\n        }\n        else if (block.containerWidget instanceof TableRowWidget) {\n            for (var i = nextIndex; i < block.containerWidget.childWidgets.length; i++) {\n                var cell = block.containerWidget.childWidgets[i];\n                if (cell.rowIndex === block.containerWidget.index) {\n                    this.updateIndex(cell, increaseIndex);\n                }\n            }\n        }\n        else if (block.containerWidget instanceof TableWidget) {\n            for (var i = nextIndex; i < block.containerWidget.childWidgets.length; i++) {\n                var row = block.containerWidget.childWidgets[i];\n                this.updateIndex(row, increaseIndex);\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    row.childWidgets[j].rowIndex = row.index;\n                }\n            }\n            //update Row index of all the cell\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget) {\n            for (var i = nextIndex; i < block.containerWidget.childWidgets.length; i++) {\n                var nextBlock = block.containerWidget.childWidgets[i];\n                this.updateIndex(nextBlock, increaseIndex);\n            }\n        }\n    };\n    Editor.prototype.updateIndex = function (widget, increment) {\n        if (increment) {\n            widget.index++;\n        }\n        else {\n            widget.index--;\n        }\n    };\n    Editor.prototype.updateEndPosition = function () {\n        var selection = this.viewer.selection;\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.updateHistoryPosition(selection.start, false);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onBackSpace = function () {\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            this.singleBackspace(selection, false);\n        }\n        else {\n            this.initHistory('BackSpace');\n            var skipBackSpace = this.deleteSelectedContents(selection, true);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                if (skipBackSpace) {\n                    this.editorHistory.currentBaseHistoryInfo = undefined;\n                }\n                else {\n                    if (this.checkEndPosition(selection)) {\n                        this.updateHistoryPosition(selection.end, false);\n                    }\n                    this.reLayout(selection);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertRemoveBookMarkElements = function () {\n        var isHandledComplexHistory = false;\n        for (var i = 0; i < this.removedBookmarkElements.length; i++) {\n            var bookMark = this.removedBookmarkElements[i];\n            if (bookMark.bookmarkType === 0) {\n                var bookMarkStart = bookMark;\n                if (bookMarkStart && bookMarkStart.reference && this.removedBookmarkElements.indexOf(bookMarkStart.reference) !== -1) {\n                    var endIndex = this.removedBookmarkElements.indexOf(bookMarkStart.reference);\n                    var startIndex = this.removedBookmarkElements.indexOf(bookMarkStart);\n                    this.removedBookmarkElements.splice(endIndex, 1);\n                    this.removedBookmarkElements.splice(startIndex, 1);\n                }\n                else {\n                    this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action);\n                    this.editorHistory.updateHistory();\n                    this.initInsertInline(bookMarkStart.clone());\n                    this.editorHistory.updateComplexHistory();\n                    isHandledComplexHistory = true;\n                }\n            }\n            else {\n                var bookMarkEnd = bookMark;\n                if (bookMarkEnd && bookMarkEnd.reference && this.removedBookmarkElements.indexOf(bookMarkEnd.reference) !== -1) {\n                    var endIndex = this.removedBookmarkElements.indexOf(bookMarkEnd.reference);\n                    var startIndex = this.removedBookmarkElements.indexOf(bookMarkEnd);\n                    this.removedBookmarkElements.splice(endIndex, 1);\n                    this.removedBookmarkElements.splice(startIndex, 1);\n                }\n                else {\n                    this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action);\n                    this.editorHistory.updateHistory();\n                    this.initInsertInline(bookMarkEnd.clone());\n                    this.editorHistory.updateComplexHistory();\n                    isHandledComplexHistory = true;\n                }\n            }\n        }\n        this.removedBookmarkElements = [];\n        return isHandledComplexHistory;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteSelectedContents = function (selection, isBackSpace) {\n        var skipBackSpace = this.deleteSelectedContentInternal(selection, isBackSpace, selection.start, selection.end);\n        var textPosition = new TextPosition(selection.owner);\n        var blockInfo = this.getParagraph({ index: selection.editPosition });\n        var lineInfo = this.getLineInfo(blockInfo.paragraph, blockInfo.offset);\n        textPosition.setPositionForLineWidget(lineInfo.line, lineInfo.offset);\n        selection.selectContent(textPosition, true);\n        return skipBackSpace;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.singleBackspace = function (selection, isRedoing) {\n        var history = this.editorHistory;\n        // If backspace is pressed after auto format to hyperlink is done, need to undo auto format.\n        if (history && !isRedoing && !history.canRedo() && history.canUndo()) {\n            var historyInfo = history.undoStack[history.undoStack.length - 1];\n            var startBlockInfo = this.getParagraphInfo(selection.start);\n            var endBlockInfo = this.getParagraphInfo(selection.end);\n            // tslint:disable-next-line:max-line-length\n            if (historyInfo.action === 'AutoFormatHyperlink' && historyInfo.insertPosition === this.getHierarchicalIndex(startBlockInfo.paragraph, startBlockInfo.offset.toString()) &&\n                historyInfo.endPosition === this.getHierarchicalIndex(endBlockInfo.paragraph, endBlockInfo.offset.toString())) {\n                history.undo();\n                return;\n            }\n        }\n        var paragraph = selection.start.paragraph;\n        var currentLineWidget = selection.start.currentWidget;\n        var offset = selection.start.offset;\n        var indexInInline = 0;\n        var inlineObj = currentLineWidget.getInline(offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        var previousInline = inline;\n        if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            if (HelperMethods.isLinkedFieldCharacter(inline)) {\n                var begin = inline.fieldBegin;\n                var end = inline.fieldEnd;\n                selection.start.setPositionParagraph(begin.line, begin.line.getOffset(begin, 0));\n                selection.end.setPositionParagraph(end.line, end.line.getOffset(end, 0) + 1);\n                selection.fireSelectionChanged(true);\n                return;\n            }\n        }\n        if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            var prevInline = selection.getPreviousValidElement(inline);\n            if (prevInline instanceof FieldElementBox) {\n                inline = prevInline.fieldBegin;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 0);\n                selection.end.setPositionParagraph(inline.line, offset); //Selects the entire field.\n                selection.fireSelectionChanged(true);\n                return;\n            }\n            else if (prevInline !== inline) {\n                inline = prevInline; //Updates the offset to delete next content.\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, inline.length);\n            }\n        }\n        if (inline && (inline instanceof BookmarkElementBox && inline.bookmarkType === 1\n            || inline.previousNode instanceof BookmarkElementBox)) {\n            if (inline instanceof BookmarkElementBox) {\n                inline = inline.previousNode;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, inline.length);\n            }\n            if (inline.length === 1 && inline.nextNode instanceof BookmarkElementBox && inline.previousNode instanceof BookmarkElementBox) {\n                var begin = inline.previousNode;\n                var end = inline.nextNode;\n                selection.start.setPositionParagraph(begin.line, begin.line.getOffset(begin, 0));\n                selection.end.setPositionParagraph(end.line, end.line.getOffset(end, 0) + 1);\n                this.initHistory('BackSpace');\n                this.deleteSelectedContents(selection, true);\n                if (this.checkEndPosition(selection)) {\n                    this.updateHistoryPosition(selection.end, false);\n                }\n                this.reLayout(selection);\n                return;\n            }\n        }\n        if (!isRedoing) {\n            this.initHistory('BackSpace');\n        }\n        if (offset === selection.getStartOffset(paragraph) && selection.start.currentWidget.isFirstLine()) {\n            if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1) {\n                this.onApplyList(undefined);\n                return;\n            }\n            if (paragraph.paragraphFormat.firstLineIndent !== 0) {\n                this.onApplyParagraphFormat('firstLineIndent', 0, false, false);\n                return;\n            }\n            if (paragraph.paragraphFormat.leftIndent !== 0) {\n                this.onApplyParagraphFormat('leftIndent', 0, false, false);\n                return;\n            }\n            if (paragraph.paragraphFormat.textAlignment !== 'Left') {\n                this.onApplyParagraphFormat('textAlignment', 'Left', false, true);\n                return;\n            }\n            if (paragraph.previousRenderedWidget instanceof ParagraphWidget) {\n                selection.owner.isShiftingEnabled = true;\n                var previousParagraph = paragraph.previousRenderedWidget;\n                // if (isNullOrUndefined(previousParagraph)) {\n                //     previousParagraph = this.viewer.selection.getPreviousBlock(paragraph) as ParagraphWidget;\n                // }\n                if (previousParagraph.isEmpty()) {\n                    this.removeBlock(previousParagraph);\n                    this.addRemovedNodes(previousParagraph);\n                }\n                else {\n                    this.removeBlock(paragraph);\n                    var endOffset = this.viewer.selection.getLineLength(previousParagraph.lastChild);\n                    var previousIndex = previousParagraph.childWidgets.length - 1;\n                    var lineWidget = void 0;\n                    if (!paragraph.isEmpty()) {\n                        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n                            lineWidget = paragraph.childWidgets[i];\n                            previousParagraph.childWidgets.push(lineWidget);\n                            paragraph.childWidgets.splice(i, 1);\n                            i--;\n                            lineWidget.paragraph = previousParagraph;\n                        }\n                    }\n                    this.viewer.layout.reLayoutParagraph(previousParagraph, previousIndex, 0);\n                    selection.selects(previousParagraph.childWidgets[previousIndex], endOffset, true);\n                    this.addRemovedNodes(paragraph);\n                }\n                this.setPositionForHistory();\n                // if (!isRedoing) {\n                this.reLayout(selection);\n                // }\n            }\n            else {\n                if (this.editorHistory) {\n                    this.editorHistory.currentBaseHistoryInfo = undefined;\n                }\n            }\n        }\n        else {\n            if (!isRedoing) {\n                selection.owner.isShiftingEnabled = true;\n            }\n            var paragraphInfo = this.getParagraphInfo(selection.start);\n            var lineWidget = selection.start.currentWidget;\n            var removeOffset = offset - 1;\n            if (removeOffset < 0) {\n                lineWidget = lineWidget.previousLine;\n                removeOffset = this.viewer.selection.getLineLength(lineWidget) + removeOffset;\n            }\n            this.removeAtOffset(lineWidget, selection, removeOffset);\n            this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset - 1, false);\n            this.setPositionForHistory();\n            if (!isRedoing) {\n                this.reLayout(selection);\n            }\n            else {\n                this.fireContentChange();\n            }\n        }\n    };\n    Editor.prototype.setPositionForHistory = function (editPosition) {\n        var selection = this.viewer.selection;\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            if (isNullOrUndefined(editPosition)) {\n                this.updateHistoryPosition(selection.start, true);\n                this.editorHistory.currentBaseHistoryInfo.endPosition = this.editorHistory.currentBaseHistoryInfo.insertPosition;\n            }\n            else {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = editPosition;\n                this.editorHistory.currentBaseHistoryInfo.endPosition = editPosition;\n            }\n        }\n    };\n    Editor.prototype.removeAtOffset = function (lineWidget, selection, offset) {\n        var count = 0;\n        var lineIndex = lineWidget.paragraph.childWidgets.indexOf(lineWidget);\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var inline = lineWidget.children[i];\n            if (inline instanceof ListTextElementBox) {\n                continue;\n            }\n            if (offset < count + inline.length) {\n                var indexInInline = offset - count;\n                if (offset === count && inline.length === 1) {\n                    this.unLinkFieldCharacter(inline);\n                    lineWidget.children.splice(i, 1);\n                    this.viewer.layout.reLayoutParagraph(lineWidget.paragraph, lineIndex, i);\n                    this.addRemovedNodes(inline);\n                }\n                else {\n                    var span = new TextElementBox();\n                    span.characterFormat.copyFormat(inline.characterFormat);\n                    span.text = inline.text.substr(indexInInline, 1);\n                    inline.text = HelperMethods.remove(inline.text, indexInInline, 1);\n                    this.viewer.layout.reLayoutParagraph(lineWidget.paragraph, lineIndex, i);\n                    this.addRemovedNodes(span);\n                }\n                break;\n            }\n            count += inline.length;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onDelete = function () {\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            this.singleDelete(selection, false);\n        }\n        else {\n            // this.initComplexHistory('MultiSelection');\n            // for (let i: number = 0; i < selection.selectionRanges.length; i++) {\n            // let selectionRange: SelectionRange = selection.selectionRanges.getRange(i);\n            this.initHistory('Delete');\n            this.deleteSelectedContentInternal(selection, false, selection.start, selection.end);\n            var textPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n            selection.selectContent(textPosition, true);\n            // if (this.viewer.owner.enableEditorHistory) {\n            this.reLayout(selection);\n            // }\n            // this.updateSelectionRangeOffSet(selection.start, selection.end);\n            // }\n            // let textPosition: TextPosition = new TextPosition(selection.owner, this.viewer);\n            // this.setPositionForCurrentIndex(textPosition,selection.editPosition);\n            // selection.selectContent(textPosition, true);\n            // if (!isNullOrUndefined(selection.currentHistoryInfo)) {\n            //     this.updateComplexHistory();\n            // } else {\n            //     this.updateComplexWithoutHistory();\n            // }\n        }\n    };\n    /**\n     * Remove single character on right of cursor position\n     * @param  {Selection} selection\n     * @param  {boolean} isRedoing\n     * @private\n     */\n    Editor.prototype.singleDelete = function (selection, isRedoing) {\n        // tslint:disable-next-line:max-line-length\n        var paragraph = selection.start.paragraph;\n        var offset = selection.start.offset;\n        var indexInInline = 0;\n        var inlineObj = paragraph.getInline(selection.start.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1 &&\n            this.viewer.isListTextSelected && selection.contextType === 'List') {\n            this.onApplyList(undefined);\n            return;\n        }\n        if (!isNullOrUndefined(inline) && indexInInline === inline.length && !isNullOrUndefined(inline.nextNode)) {\n            inline = inline.nextNode;\n            indexInInline = 0;\n        }\n        if (!isNullOrUndefined(inline)) {\n            var nextRenderedInline = undefined;\n            var nextInline = selection.getNextValidElement(inline);\n            if (nextInline instanceof ElementBox) {\n                nextRenderedInline = nextInline;\n            }\n            if (!isNullOrUndefined(nextRenderedInline) && nextRenderedInline instanceof FieldElementBox\n                && nextRenderedInline.fieldType === 0) { //Selects the entire field.\n                inline = nextRenderedInline.fieldEnd;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 1);\n                selection.end.setPositionParagraph(inline.line, offset);\n                selection.fireSelectionChanged(true);\n                return;\n            }\n            else if (inline !== nextRenderedInline) { //Updates the offset to delete next content.               \n                inline = nextRenderedInline;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 0);\n                if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    offset++;\n                }\n            }\n        }\n        if (inline && (inline instanceof BookmarkElementBox && inline.bookmarkType === 0\n            || inline.nextNode instanceof BookmarkElementBox)) {\n            if (inline instanceof BookmarkElementBox) {\n                inline = inline.nextNode;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 0);\n            }\n            if (inline.length === 1 && inline.nextNode instanceof BookmarkElementBox\n                && inline.previousNode instanceof BookmarkElementBox) {\n                var bookMarkBegin = inline.previousNode;\n                var bookMarkEnd = inline.nextNode;\n                selection.start.setPositionParagraph(bookMarkBegin.line, bookMarkBegin.line.getOffset(bookMarkBegin, 0));\n                selection.end.setPositionParagraph(bookMarkEnd.line, bookMarkEnd.line.getOffset(bookMarkEnd, 0) + 1);\n                this.initHistory('Delete');\n                this.deleteSelectedContentInternal(selection, false, selection.start, selection.end);\n                var textPosition = new TextPosition(selection.owner);\n                this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n                selection.selectContent(textPosition, true);\n                this.reLayout(selection);\n                return;\n            }\n        }\n        if (selection.start.currentWidget.isLastLine() && offset === this.viewer.selection.getLineLength(selection.start.currentWidget)) {\n            if (paragraph.isInsideTable && isNullOrUndefined(paragraph.nextWidget)) {\n                return;\n            }\n            var previousParagraph = undefined;\n            var newParagraph = undefined;\n            var nextParagraph = selection.getNextParagraphBlock(paragraph);\n            if (isNullOrUndefined(nextParagraph)) {\n                if (offset > 0) {\n                    return;\n                }\n                else {\n                    if (paragraph.previousWidget instanceof ParagraphWidget) {\n                        previousParagraph = paragraph.previousWidget;\n                    }\n                    if (paragraph.previousWidget instanceof TableWidget) {\n                        return;\n                    }\n                    if (isNullOrUndefined(previousParagraph)) {\n                        return;\n                        //Adds an empty paragraph, to ensure minimal content.\n                    }\n                }\n            }\n            if (!isRedoing) {\n                this.initHistory('Delete');\n            }\n            var blockInfo = this.getParagraphInfo(selection.start);\n            selection.editPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            if (this.checkInsertPosition(selection)) {\n                this.setPositionForHistory(selection.editPosition);\n            }\n            selection.owner.isShiftingEnabled = true;\n            if (paragraph.isEmpty()) {\n                this.removeBlock(paragraph);\n                this.addRemovedNodes(paragraph);\n                if (isNullOrUndefined(nextParagraph)) {\n                    if (isNullOrUndefined(previousParagraph)) {\n                        // selection.selectParagraph(newParagraph, true, true);\n                        var paraEndOffset = selection.getParagraphLength(newParagraph) + 1;\n                        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                            this.updateHistoryPosition(selection.start, true);\n                            //tslint:disable-next-line:max-line-length\n                            this.editorHistory.currentBaseHistoryInfo.endPosition = this.getHierarchicalIndex(newParagraph, paraEndOffset.toString());\n                        }\n                    }\n                    else {\n                        selection.selectParagraph(previousParagraph, false);\n                        this.setPositionForHistory();\n                    }\n                }\n                else {\n                    selection.selectParagraph(nextParagraph, true);\n                }\n            }\n            else {\n                paragraph = paragraph.combineWidget(this.viewer);\n                // tslint:disable-next-line:max-line-length\n                var currentParagraph = this.splitParagraph(paragraph, paragraph.firstChild, 0, selection.start.currentWidget, selection.start.offset, true);\n                this.deleteParagraphMark(currentParagraph, selection, 0);\n                this.addRemovedNodes(paragraph);\n                this.setPositionForCurrentIndex(selection.start, selection.editPosition);\n                selection.selectContent(selection.start, true);\n            }\n            // if (!isRedoing) {\n            this.reLayout(selection);\n            // }\n        }\n        else {\n            this.singleDeleteInternal(selection, isRedoing, paragraph);\n        }\n    };\n    Editor.prototype.singleDeleteInternal = function (selection, isRedoing, paragraph) {\n        if (!isRedoing) {\n            selection.owner.isShiftingEnabled = true;\n            this.initHistory('Delete');\n        }\n        if (this.checkInsertPosition(selection)) {\n            this.updateHistoryPosition(selection.start, true);\n            this.editorHistory.currentBaseHistoryInfo.endPosition = this.editorHistory.currentBaseHistoryInfo.insertPosition;\n        }\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        var lineWidget = selection.start.currentWidget;\n        var removeOffset = selection.start.offset;\n        var lineLength = selection.getLineLength(selection.start.currentWidget);\n        if (removeOffset >= lineLength) {\n            lineWidget = lineWidget.nextLine;\n            removeOffset = removeOffset - lineLength;\n        }\n        this.removeAtOffset(lineWidget, selection, removeOffset);\n        this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset, false);\n        if (!isRedoing) {\n            this.reLayout(selection);\n        }\n        else {\n            this.fireContentChange();\n        }\n    };\n    Editor.prototype.deleteParagraphMark = function (paragraph, selection, editAction) {\n        if (isNullOrUndefined(paragraph.containerWidget)) {\n            return;\n        }\n        paragraph = paragraph.combineWidget(this.viewer);\n        var nextParagraph = selection.getNextParagraphBlock(paragraph);\n        if (paragraph.isInsideTable && isNullOrUndefined(paragraph.nextWidget) || isNullOrUndefined(nextParagraph)) {\n            return;\n        }\n        //BodyWidget\n        var section = paragraph.containerWidget instanceof BodyWidget ? paragraph.containerWidget : undefined;\n        var table = undefined;\n        if (selection.getNextRenderedBlock(paragraph) instanceof TableWidget) {\n            table = selection.getNextRenderedBlock(paragraph);\n        }\n        else {\n            table = undefined;\n        }\n        if (nextParagraph.isInsideTable && !isNullOrUndefined(table) && table.contains(nextParagraph.associatedCell)) {\n            if (editAction < 4) {\n                // let nextSection: BodyWidget = table.containerWidget instanceof BodyWidget ? table.containerWidget : undefined;\n                // if (section !== nextSection) {\n                //     this.combineSection(section, selection, nextSection);\n                // }\n                var offset = 0;\n                this.removeBlock(paragraph);\n                this.viewer.layout.clearListElementBox(nextParagraph);\n                this.viewer.layout.clearListElementBox(paragraph);\n                for (var i = paragraph.childWidgets.length - 1; i >= 0; i--) {\n                    var line = paragraph.childWidgets[i];\n                    for (var j = line.children.length - 1; j >= 0; j--) {\n                        var element = line.children[j];\n                        offset += element.length;\n                        nextParagraph.firstChild.children.unshift(element);\n                        element.line = nextParagraph.firstChild;\n                        // this.layoutInlineCollection(false, 0, nextParagraph.inlines, inline);\n                    }\n                }\n                this.viewer.layout.reLayoutParagraph(nextParagraph, 0, 0);\n                if (offset > 0) {\n                    selection.editPosition = this.getHierarchicalIndex(nextParagraph, offset.toString());\n                }\n            }\n        }\n        else {\n            if (editAction < 4) {\n                // let nextSection: WSection = nextParagraph.section instanceof WSection ? nextParagraph.section as WSection : undefined;\n                // if (section !== nextSection) {\n                //     this.combineSection(section, selection, nextSection);\n                // }\n                var prevLength = paragraph.childWidgets.length - 1;\n                var nextPara = nextParagraph.getSplitWidgets();\n                nextParagraph = nextParagraph.combineWidget(this.viewer);\n                this.viewer.layout.clearListElementBox(nextParagraph);\n                this.viewer.layout.clearListElementBox(paragraph);\n                this.updateEditPositionOnMerge(paragraph, nextParagraph);\n                for (var i = 0; i < nextParagraph.childWidgets.length; i++) {\n                    var inline = nextParagraph.childWidgets[i];\n                    nextParagraph.childWidgets.splice(i, 1);\n                    paragraph.childWidgets.push(inline);\n                    inline.paragraph = paragraph;\n                    i--;\n                }\n                if (nextParagraph.childWidgets.length === 0) {\n                    nextParagraph.childWidgets.push(new LineWidget(nextParagraph));\n                }\n                this.removeBlock(nextParagraph);\n                this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n                this.addRemovedNodes(nextParagraph);\n            }\n        }\n    };\n    Editor.prototype.updateEditPositionOnMerge = function (currentParagraph, nextParagraph) {\n        if (this.viewer.selection.editPosition === this.getHierarchicalIndex(nextParagraph, '0') &&\n            nextParagraph.nextRenderedWidget === undefined) {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.selection.editPosition = this.getHierarchicalIndex(currentParagraph, this.viewer.selection.getLineLength(currentParagraph.lastChild).toString());\n        }\n    };\n    Editor.prototype.checkEndPosition = function (selection) {\n        return (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n            && isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.endPosition));\n    };\n    Editor.prototype.checkInsertPosition = function (selection) {\n        return (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n            && isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition));\n    };\n    Editor.prototype.checkIsNotRedoing = function () {\n        return this.viewer.owner.enableHistoryMode && !this.editorHistory.isRedoing;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteSelectedContentInternal = function (selection, isBackSpace, startPosition, endPosition) {\n        var startPos = startPosition;\n        var endPos = endPosition;\n        if (!startPosition.isExistBefore(endPosition)) {\n            startPos = endPosition;\n            endPos = startPosition;\n        }\n        var blockInfo = this.getParagraphInfo(startPos);\n        selection.editPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        var skipBackSpace = false;\n        if (isBackSpace && startPos.isInSameParagraph(endPos)) {\n            //Handled specifically to skip removal of contents, if selection is only paragraph mark and next rendered block is table.\n            if (startPos.offset < endPos.offset && startPos.offset === selection.getParagraphLength(endPos.paragraph)) {\n                var nextBlock = selection.getNextRenderedBlock(startPos.paragraph);\n                skipBackSpace = nextBlock instanceof TableWidget;\n            }\n            //Handled specifically to remove paragraph completely (Delete behavior), if the selected paragraph is empty.\n            if (endPos.offset === 1 && endPos.offset > selection.getParagraphLength(endPos.paragraph)\n                && !(endPos.paragraph.isInsideTable && isNullOrUndefined(endPos.paragraph.nextWidget))) {\n                isBackSpace = false;\n            }\n        }\n        if (!skipBackSpace) {\n            selection.owner.isShiftingEnabled = true;\n            if (this.checkInsertPosition(selection)) {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = selection.editPosition;\n            }\n            var editAction = (isBackSpace ? 1 : 0);\n            this.deleteSelectedContent(endPos.paragraph, selection, startPos, endPos, editAction);\n        }\n        return skipBackSpace;\n    };\n    /**\n     * Init EditorHistory\n     * @private\n     */\n    Editor.prototype.initHistory = function (action) {\n        if (this.viewer.owner.enableHistoryMode) {\n            this.editorHistory.initializeHistory(action);\n        }\n    };\n    /**\n     * Init Complex EditorHistory\n     * @private\n     */\n    Editor.prototype.initComplexHistory = function (action) {\n        if (this.viewer.owner.enableHistoryMode) {\n            this.editorHistory.initComplexHistory(this.viewer.selection, action);\n        }\n    };\n    //Insert Picture implementation starts\n    /**\n     * Insert image\n     * @param  {string} base64String\n     * @param  {number} width\n     * @param  {number} height\n     * @private\n     */\n    Editor.prototype.insertPicture = function (base64String, width, height) {\n        var imageElementBox = new ImageElementBox(true);\n        imageElementBox.imageString = base64String;\n        imageElementBox.width = width;\n        imageElementBox.height = height;\n        this.insertPictureInternal(imageElementBox);\n    };\n    Editor.prototype.insertPictureInternal = function (imageElementBox) {\n        var selection = this.viewer.selection;\n        this.initHistory('InsertInline');\n        this.fitImageToPage(selection, imageElementBox);\n        this.insertInlineInSelection(selection, imageElementBox);\n        this.reLayout(selection);\n    };\n    Editor.prototype.fitImageToPage = function (selection, imageElementBox) {\n        var section = selection.start.paragraph.bodyWidget;\n        var pageWidth = section.sectionFormat.pageWidth - section.sectionFormat.leftMargin - section.sectionFormat.rightMargin;\n        var pageHeight = section.sectionFormat.pageHeight - section.sectionFormat.topMargin - section.sectionFormat.topMargin;\n        //Resizes image to page size.\n        if (imageElementBox.width > pageWidth) {\n            imageElementBox.height = imageElementBox.height * pageWidth / imageElementBox.width;\n            imageElementBox.width = pageWidth;\n        }\n        if (imageElementBox.height > pageHeight) {\n            imageElementBox.width = imageElementBox.width * pageHeight / imageElementBox.height;\n            imageElementBox.height = pageHeight;\n        }\n    };\n    //Insert Picture implementation ends\n    /**\n     * @private\n     */\n    Editor.prototype.insertInlineInSelection = function (selection, elementBox) {\n        if (this.checkIsNotRedoing()) {\n            selection.owner.isShiftingEnabled = true;\n        }\n        if (!selection.isEmpty) {\n            this.removeSelectedContents(selection);\n        }\n        this.updateInsertPosition();\n        this.insertInlineInternal(elementBox);\n        if (this.checkEndPosition(selection)) {\n            this.updateHistoryPosition(selection.start, false);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onPortrait = function () {\n        var sectionFormat = new WSectionFormat();\n        var width = this.viewer.selection.sectionFormat.pageWidth;\n        var height = this.viewer.selection.sectionFormat.pageHeight;\n        if (width > height) {\n            sectionFormat.pageWidth = height;\n            sectionFormat.pageHeight = width;\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onLandscape = function () {\n        var sectionFormat = new WSectionFormat();\n        var width = this.viewer.selection.sectionFormat.pageWidth;\n        var height = this.viewer.selection.sectionFormat.pageHeight;\n        if (width < height) {\n            sectionFormat.pageWidth = height;\n            sectionFormat.pageHeight = width;\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    Editor.prototype.copyValues = function () {\n        var format = new WSectionFormat();\n        format.bottomMargin = this.viewer.selection.sectionFormat.bottomMargin;\n        format.topMargin = this.viewer.selection.sectionFormat.topMargin;\n        format.leftMargin = this.viewer.selection.sectionFormat.leftMargin;\n        format.rightMargin = this.viewer.selection.sectionFormat.rightMargin;\n        format.pageHeight = this.viewer.selection.sectionFormat.pageHeight;\n        format.pageWidth = this.viewer.selection.sectionFormat.pageWidth;\n        format.footerDistance = this.viewer.selection.sectionFormat.footerDistance;\n        format.headerDistance = this.viewer.selection.sectionFormat.headerDistance;\n        return format;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.changeMarginValue = function (property) {\n        var sectionFormat = this.copyValues();\n        if (property === 'lastCustomSetting' || property === 'normal') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 72;\n            sectionFormat.rightMargin = 72;\n        }\n        else if (property === 'narrow') {\n            sectionFormat.topMargin = 36;\n            sectionFormat.bottomMargin = 36;\n            sectionFormat.leftMargin = 36;\n            sectionFormat.rightMargin = 36;\n        }\n        else if (property === 'moderate') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 54;\n            sectionFormat.rightMargin = 54;\n        }\n        else if (property === 'wide') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 144;\n            sectionFormat.rightMargin = 144;\n        }\n        else if (property === 'mirrored') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 90;\n            sectionFormat.rightMargin = 72;\n        }\n        else if (property === 'office2003Default') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 90;\n            sectionFormat.rightMargin = 90;\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onPaperSize = function (property) {\n        var sectionFormat = this.copyValues();\n        var width = this.viewer.selection.sectionFormat.pageWidth;\n        var height = this.viewer.selection.sectionFormat.pageHeight;\n        if (property === 'letter') {\n            if (width < height) {\n                sectionFormat.pageWidth = 611.9;\n                sectionFormat.pageHeight = 791.9;\n            }\n            else {\n                sectionFormat.pageWidth = 791.9;\n                sectionFormat.pageHeight = 611.9;\n            }\n        }\n        else if (property === 'tabloid') {\n            if (width < height) {\n                sectionFormat.pageWidth = 791.9;\n                sectionFormat.pageHeight = 1223.9;\n            }\n            else {\n                sectionFormat.pageWidth = 1223.9;\n                sectionFormat.pageHeight = 791.9;\n            }\n        }\n        else if (property === 'legal') {\n            if (width < height) {\n                sectionFormat.pageWidth = 611.9;\n                sectionFormat.pageHeight = 1007.9;\n            }\n            else {\n                sectionFormat.pageWidth = 1007.9;\n                sectionFormat.pageHeight = 611.9;\n            }\n        }\n        else if (property === 'statement') {\n            if (width < height) {\n                sectionFormat.pageWidth = 396;\n                sectionFormat.pageHeight = 611.9;\n            }\n            else {\n                sectionFormat.pageWidth = 611.9;\n                sectionFormat.pageHeight = 396;\n            }\n        }\n        else if (property === 'executive') {\n            if (width < height) {\n                sectionFormat.pageWidth = 521.9;\n                sectionFormat.pageHeight = 755.9;\n            }\n            else {\n                sectionFormat.pageWidth = 755.9;\n                sectionFormat.pageHeight = 521.9;\n            }\n        }\n        else if (property === 'a3') {\n            if (width < height) {\n                sectionFormat.pageWidth = 841.8;\n                sectionFormat.pageHeight = 1190.4;\n            }\n            else {\n                sectionFormat.pageWidth = 1190.4;\n                sectionFormat.pageHeight = 841.8;\n            }\n        }\n        else if (property === 'a4') {\n            if (width < height) {\n                sectionFormat.pageWidth = 595.2;\n                sectionFormat.pageHeight = 841.8;\n            }\n            else {\n                sectionFormat.pageWidth = 841.8;\n                sectionFormat.pageHeight = 595.2;\n            }\n        }\n        else if (property === 'a5') {\n            if (width < height) {\n                sectionFormat.pageWidth = 419.5;\n                sectionFormat.pageHeight = 595.2;\n            }\n            else {\n                sectionFormat.pageWidth = 595.2;\n                sectionFormat.pageHeight = 419.5;\n            }\n        }\n        else if (property === 'b4') {\n            if (width < height) {\n                sectionFormat.pageWidth = 728.4;\n                sectionFormat.pageHeight = 1031.7;\n            }\n            else {\n                sectionFormat.pageWidth = 1031.7;\n                sectionFormat.pageHeight = 728.4;\n            }\n        }\n        else if (property === 'b5') {\n            if (width < height) {\n                sectionFormat.pageWidth = 515.8;\n                sectionFormat.pageHeight = 728.4;\n            }\n            else {\n                sectionFormat.pageWidth = 728.4;\n                sectionFormat.pageHeight = 515.8;\n            }\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    //Update List Items\n    /**\n     * @private\n     */\n    Editor.prototype.updateListItemsTillEnd = function (blockAdv, updateNextBlockList) {\n        var block = updateNextBlockList ? this.viewer.selection.getNextRenderedBlock(blockAdv) : blockAdv;\n        while (!isNullOrUndefined(block) && !this.viewer.isTextInput) {\n            //Updates the list value of the rendered paragraph. \n            this.updateRenderedListItems(block);\n            block = block.getSplitWidgets().pop().nextRenderedWidget;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateWholeListItems = function (block) {\n        this.viewer.renderedLists.clear();\n        var sectionIndex = block.bodyWidget.index;\n        var currentBlock;\n        for (var j = 0; j < this.viewer.pages.length; j++) {\n            var page = this.viewer.pages[j];\n            if (page.bodyWidgets[0].index === sectionIndex) {\n                currentBlock = page.bodyWidgets[0].firstChild;\n                break;\n            }\n        }\n        var isListUpdated = false;\n        do {\n            isListUpdated = this.updateListItems(currentBlock, block);\n            if (isListUpdated) {\n                break;\n            }\n            currentBlock = currentBlock.getSplitWidgets().pop().nextRenderedWidget;\n        } while (currentBlock);\n    };\n    Editor.prototype.updateListItems = function (blockAdv, block) {\n        var isListUpdated = false;\n        if (blockAdv instanceof ParagraphWidget) {\n            isListUpdated = this.updateListItemsForPara(blockAdv, block);\n        }\n        else {\n            isListUpdated = this.updateListItemsForTable(blockAdv, block);\n        }\n        return isListUpdated;\n    };\n    Editor.prototype.updateListItemsForTable = function (table, block) {\n        if (block instanceof TableWidget && table.equals(block)) {\n            return true;\n        }\n        var row = table.firstChild;\n        do {\n            var isListUpdated = this.updateListItemsForRow(row, block);\n            if (isListUpdated) {\n                return true;\n            }\n            row = row.getSplitWidgets().pop().nextRenderedWidget;\n        } while (row);\n        return false;\n    };\n    Editor.prototype.updateListItemsForRow = function (row, block) {\n        if (block.isInsideTable && row.childWidgets.indexOf(this.viewer.selection.getContainerCell(block.associatedCell)) !== -1) {\n            //Returns as list updated, inorder to start list numbering from first list paragraph of this row.\n            return true;\n        }\n        var cell = row.firstChild;\n        do {\n            this.updateListItemsForCell(cell, block);\n            cell = cell.nextRenderedWidget;\n        } while (cell);\n        return false;\n    };\n    Editor.prototype.updateListItemsForCell = function (cell, block) {\n        if (cell.childWidgets.length === 0) {\n            return;\n        }\n        var currentBlock = cell.firstChild;\n        do {\n            this.updateListItems(currentBlock, block);\n            currentBlock = currentBlock.getSplitWidgets().pop().nextRenderedWidget;\n        } while (currentBlock);\n    };\n    // public abstract updateListParagraphs(): void;\n    /**\n     * @private\n     */\n    Editor.prototype.updateRenderedListItems = function (block) {\n        if (block instanceof ParagraphWidget) {\n            this.updateRenderedListItemsForPara(block);\n        }\n        else {\n            this.updateRenderedListItemsForTable(block);\n        }\n    };\n    Editor.prototype.updateRenderedListItemsForTable = function (table) {\n        var row = table.firstChild;\n        do {\n            this.updateRenderedListItemsForRow(row);\n            row = row.getSplitWidgets().pop().nextRenderedWidget;\n        } while (row);\n    };\n    Editor.prototype.updateRenderedListItemsForRow = function (row) {\n        var cell = row.firstChild;\n        do {\n            this.updateRenderedListItemsForCell(cell);\n            cell = cell.nextRenderedWidget;\n        } while (cell);\n    };\n    Editor.prototype.updateRenderedListItemsForCell = function (cell) {\n        if (cell.childWidgets.length === 0) {\n            return;\n        }\n        var currentBlock = cell.firstChild;\n        do {\n            this.updateRenderedListItems(currentBlock);\n            currentBlock = currentBlock.getSplitWidgets().pop().nextRenderedWidget;\n        } while (currentBlock);\n    };\n    Editor.prototype.updateListItemsForPara = function (paragraph, block) {\n        if (paragraph.equals(block)) {\n            return true;\n        }\n        else {\n            var currentList = undefined;\n            var listLevelNumber = 0;\n            if (!isNullOrUndefined(paragraph.paragraphFormat) && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n                currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n                listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n            }\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(currentList) && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId))\n                // tslint:disable-next-line:max-line-length\n                && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels[listLevelNumber])) {\n                var currentListLevel = this.viewer.layout.getListLevel(currentList, listLevelNumber);\n                //Updates the list numbering from document start for reLayouting.\n                if (currentListLevel.listLevelPattern !== 'Bullet') {\n                    this.viewer.layout.getListNumber(paragraph.paragraphFormat.listFormat);\n                }\n            }\n        }\n        return false;\n    };\n    Editor.prototype.updateRenderedListItemsForPara = function (paragraph) {\n        if (!isNullOrUndefined(this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId))) {\n            var currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n            var listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n            if (!isNullOrUndefined(currentList) && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId))\n                // tslint:disable-next-line:max-line-length\n                && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels[paragraph.paragraphFormat.listFormat.listLevelNumber])) {\n                var currentListLevel = this.viewer.layout.getListLevel(currentList, listLevelNumber);\n                //Updates the list numbering from document start for reLayouting.\n                if (currentListLevel.listLevelPattern !== 'Bullet') {\n                    var element = undefined;\n                    if (paragraph.childWidgets.length > 0) {\n                        var lineWidget = paragraph.childWidgets[0];\n                        if (lineWidget.children.length > 0) {\n                            element = lineWidget.children[0];\n                        }\n                    }\n                    if (!isNullOrUndefined(element)) {\n                        element.text = this.viewer.layout.getListNumber(paragraph.paragraphFormat.listFormat);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Get logical offset of paragraph.\n     * @private\n     */\n    Editor.prototype.getParagraphInfo = function (position) {\n        return this.getParagraphInfoInternal(position.currentWidget, position.offset);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getParagraphInfoInternal = function (line, lineOffset) {\n        var paragraph = line.paragraph;\n        var offset = this.selection.getParagraphLength(paragraph, line) + lineOffset;\n        var previous = paragraph.previousSplitWidget;\n        while (previous instanceof ParagraphWidget) {\n            paragraph = previous;\n            offset += this.viewer.selection.getParagraphLength(paragraph);\n            previous = paragraph.previousSplitWidget;\n        }\n        return { 'paragraph': paragraph, 'offset': offset };\n    };\n    /**\n     * Get offset value to update in selection\n     * @private\n     */\n    Editor.prototype.getOffsetValue = function (selection) {\n        if (this.startParagraph) {\n            var lineInfo = this.getLineInfo(this.startParagraph, this.startOffset);\n            selection.start.setPositionFromLine(lineInfo.line, lineInfo.offset);\n        }\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            if (this.endParagraph) {\n                var lineInfo = this.getLineInfo(this.endParagraph, this.endOffset);\n                selection.end.setPositionFromLine(lineInfo.line, lineInfo.offset);\n            }\n            selection.end.updatePhysicalPosition(true);\n        }\n    };\n    /**\n     * Get offset value to update in selection\n     * @private\n     */\n    Editor.prototype.getLineInfo = function (paragraph, offset) {\n        var position = undefined;\n        var element = undefined;\n        var length = this.selection.getParagraphLength(paragraph);\n        var next = paragraph.nextSplitWidget;\n        if (offset > length + 1 && isNullOrUndefined(next)) {\n            offset = length;\n        }\n        while (offset > length && next instanceof ParagraphWidget) {\n            offset -= length;\n            paragraph = next;\n            length = this.selection.getParagraphLength(paragraph);\n            next = paragraph.nextSplitWidget;\n        }\n        return this.selection.getLineInfo(paragraph, offset);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.setPositionParagraph = function (paragraph, offset, skipSelectionChange) {\n        var selection = this.viewer.selection;\n        var lineInfo = this.getLineInfo(paragraph, offset);\n        selection.start.setPositionFromLine(lineInfo.line, lineInfo.offset);\n        selection.end.setPositionInternal(selection.start);\n        if (!skipSelectionChange) {\n            selection.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.setPositionForCurrentIndex = function (textPosition, editPosition) {\n        var blockInfo = this.getParagraph({ index: editPosition });\n        var lineInfo = this.getLineInfo(blockInfo.paragraph, blockInfo.offset);\n        textPosition.setPositionForLineWidget(lineInfo.line, lineInfo.offset);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertPageNumber = function (numberFormat) {\n        if (isNullOrUndefined(numberFormat)) {\n            numberFormat = '';\n        }\n        else {\n            numberFormat = ' \\\\*' + numberFormat;\n        }\n        var fieldCode = 'PAGE ' + numberFormat + ' \\\\* MERGEFORMAT';\n        this.createFields(fieldCode);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertPageCount = function (numberFormat) {\n        if (isNullOrUndefined(numberFormat)) {\n            numberFormat = '';\n        }\n        else {\n            numberFormat = ' \\*' + numberFormat;\n        }\n        var fieldCode = 'NUMPAGES ' + numberFormat + ' \\* MERGEFORMAT';\n        this.createFields(fieldCode);\n    };\n    Editor.prototype.createFields = function (fieldCode) {\n        var paragraph = new ParagraphWidget();\n        var line = new LineWidget(paragraph);\n        var fieldBegin = new FieldElementBox(0);\n        line.children.push(fieldBegin);\n        var fieldtext = new FieldTextElementBox();\n        fieldtext.fieldBegin = fieldBegin;\n        fieldtext.text = '1';\n        var text = new TextElementBox();\n        text.text = fieldCode;\n        line.children.push(text);\n        var fieldSeparator = new FieldElementBox(2);\n        fieldSeparator.fieldBegin = fieldBegin;\n        fieldBegin.fieldSeparator = fieldSeparator;\n        line.children.push(fieldSeparator);\n        line.children.push(fieldtext);\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.fieldBegin = fieldBegin;\n        fieldEnd.fieldSeparator = fieldSeparator;\n        fieldSeparator.fieldEnd = fieldEnd;\n        fieldBegin.fieldEnd = fieldEnd;\n        line.children.push(fieldEnd);\n        fieldBegin.line = line;\n        paragraph.childWidgets.push(line);\n        var widgets = [];\n        widgets.push(paragraph);\n        this.viewer.fields.push(fieldBegin);\n        this.pasteContentsInternal(widgets);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertBookmark = function (name) {\n        var bookmark = new BookmarkElementBox(0);\n        bookmark.name = name;\n        var bookmarkEnd = new BookmarkElementBox(1);\n        bookmarkEnd.name = name;\n        bookmark.reference = bookmarkEnd;\n        bookmarkEnd.reference = bookmark;\n        this.viewer.bookmarks.add(name, bookmark);\n        this.initComplexHistory('InsertBookmark');\n        this.insertElements([bookmarkEnd], [bookmark]);\n        if (this.editorHistory) {\n            this.editorHistory.updateComplexHistoryInternal();\n        }\n        this.selection.start.setPositionForSelection(bookmark.line, bookmark, 1, this.selection.start.location);\n        this.selection.end.setPositionForSelection(bookmarkEnd.line, bookmarkEnd, 0, this.selection.end.location);\n        this.selection.fireSelectionChanged(true);\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteBookmark = function (bookmarkName) {\n        var bookmarks = this.viewer.bookmarks;\n        var bookmark = bookmarks.get(bookmarkName);\n        if (bookmark instanceof BookmarkElementBox) {\n            var bookmarkEnd = bookmark.reference;\n            this.initHistory('DeleteBookmark');\n            if (this.editorHistory) {\n                this.editorHistory.currentBaseHistoryInfo.setBookmarkInfo(bookmark);\n                this.editorHistory.updateHistory();\n            }\n            this.deleteBookmarkInternal(bookmark);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteBookmarkInternal = function (bookmark) {\n        this.viewer.bookmarks.remove(bookmark.name);\n        bookmark.line.children.splice(bookmark.indexInOwner, 1);\n        bookmark.reference.line.children.splice(bookmark.reference.indexInOwner, 1);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getSelectionInfo = function () {\n        var start = this.selection.start;\n        var end = this.selection.end;\n        var isEmpty = this.selection.isEmpty;\n        if (!this.selection.isForward) {\n            start = this.selection.end;\n            end = this.selection.start;\n        }\n        var startElementInfo = start.currentWidget.getInline(start.offset, 0);\n        var endElementInfo = end.currentWidget.getInline(end.offset, 0);\n        // tslint:disable-next-line:max-line-length\n        return { 'start': start.clone(), 'end': end.clone(), 'startElementInfo': startElementInfo, 'endElementInfo': endElementInfo, 'isEmpty': isEmpty };\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertElements = function (endElements, startElements) {\n        var info = this.getSelectionInfo();\n        if (!isNullOrUndefined(startElements)) {\n            this.insertElementsInternal(info.start, startElements);\n        }\n        if (!isNullOrUndefined(endElements)) {\n            this.insertElementsInternal(info.end, endElements);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertElementsInternal = function (position, elements) {\n        this.selection.selectPosition(position, position);\n        this.initHistory('InsertElements');\n        this.updateInsertPosition();\n        var indexInInline = 0;\n        var paragraphInfo = this.getParagraphInfo(this.selection.start);\n        if (this.selection.start.paragraph.isEmpty()) {\n            var paragraph = this.selection.start.paragraph;\n            paragraph.childWidgets[0].children.push(elements[0]);\n            elements[0].line = paragraph.childWidgets[0];\n            elements[0].linkFieldCharacter(this.viewer);\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n            this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + length, true);\n            position.setPositionForSelection(elements[0].line, elements[0], elements[0].length, this.selection.start.location);\n            this.selection.selectPosition(position, position);\n        }\n        else {\n            var inlineObj = this.selection.start.currentWidget.getInline(this.viewer.selection.start.offset, indexInInline);\n            var curInline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            var firstElement = elements[0];\n            this.insertElementInternal(curInline, firstElement, indexInInline, true);\n            var index = firstElement.indexInOwner;\n            var lastElement = firstElement;\n            for (var i = 1; i < elements.length; i++) {\n                lastElement = elements[i];\n                firstElement.line.children.splice(index + i, 0, lastElement);\n            }\n            position.setPositionForSelection(lastElement.line, lastElement, lastElement.length, this.selection.start.location);\n            this.selection.selectPosition(position, position);\n        }\n        if (this.editorHistory) {\n            if (this.checkEndPosition()) {\n                this.updateHistoryPosition(this.selection.start, false);\n            }\n            this.editorHistory.updateHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getHierarchicalIndex = function (block, offset) {\n        var index;\n        if (block) {\n            if (block instanceof HeaderFooterWidget) {\n                var hfString = block.headerFooterType.indexOf('Header') !== -1 ? 'H' : 'F';\n                var pageIndex = block.page.index.toString();\n                var headerFooterIndex = this.viewer.getHeaderFooter(block.headerFooterType).toString();\n                var sectionIndex = block.page.sectionIndex;\n                index = sectionIndex + ';' + hfString + ';' + pageIndex + ';' + offset;\n            }\n            else {\n                index = block.index + ';' + offset;\n            }\n            if (block.containerWidget) {\n                if (block instanceof TableCellWidget && block.rowIndex !== block.containerWidget.index) {\n                    index = block.rowIndex + ';' + index;\n                    block = block.containerWidget;\n                }\n                return this.getHierarchicalIndex(block.containerWidget, index);\n            }\n        }\n        return index;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBlock = function (position) {\n        var bodyWidget = this.getBodyWidget(position);\n        return this.getBlockInternal(bodyWidget, position);\n    };\n    /**\n     * Return Block relative to position\n     * @private\n     */\n    Editor.prototype.getBlockInternal = function (widget, position) {\n        if (position.index === '' || isNullOrUndefined(position)) {\n            return undefined;\n        }\n        var index = position.index.indexOf(';');\n        var value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        var node = widget;\n        // if (node instanceof WSection && value === 'HF') {\n        //     //Gets the block in Header footers.\n        //     let blockObj: BlockInfo = this.getBlock((node as WSection).headerFooters, position);\n        // tslint:disable-next-line:max-line-length\n        //     return { 'node': (!isNullOrUndefined(blockObj)) ? blockObj.node : undefined, 'position': (!isNullOrUndefined(blockObj)) ? blockObj.position : undefined };\n        // }\n        index = parseInt(value, 10);\n        var childWidget = this.getBlockByIndex(widget, index);\n        if (childWidget) {\n            var child = childWidget;\n            if (position.index.indexOf(';') >= 0) {\n                if (child instanceof ParagraphWidget) {\n                    if (position.index.indexOf(';') >= 0) {\n                        position.index = '0';\n                    }\n                    return { 'node': child, 'position': position };\n                }\n                if (child instanceof Widget) {\n                    var blockObj = this.getBlockInternal(child, position);\n                    // tslint:disable-next-line:max-line-length\n                    return { 'node': (!isNullOrUndefined(blockObj)) ? blockObj.node : undefined, 'position': (!isNullOrUndefined(blockObj)) ? blockObj.position : undefined };\n                }\n            }\n            else {\n                return { 'node': child, 'position': position };\n            }\n        }\n        else {\n            return { 'node': node, 'position': position };\n        }\n        return { 'node': node, 'position': position };\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getParagraph = function (position) {\n        var paragraph = this.getParagraphInternal(this.getBodyWidget(position), position);\n        return { paragraph: paragraph, offset: parseInt(position.index, 10) };\n    };\n    /**\n     * Get paragraph relative to position\n     * @private\n     */\n    Editor.prototype.getParagraphInternal = function (container, position) {\n        if (isNullOrUndefined(position.index)) {\n            return undefined;\n        }\n        // let ins: Widget = container;\n        var index = position.index.indexOf(';');\n        var value = '0';\n        if (index >= 0) {\n            value = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n        }\n        // if (container instanceof BodyWidget && value === 'HF') {\n        //     return this.getParagraph(container.headerFooters, position);\n        // }\n        index = parseInt(value, 10);\n        if (container instanceof TableRowWidget && index >= container.childWidgets.length) {\n            position.index = '0;0';\n            index = container.childWidgets.length - 1;\n        }\n        var childWidget = this.getBlockByIndex(container, index);\n        if (childWidget) {\n            var child = childWidget;\n            if (child instanceof ParagraphWidget) {\n                if (position.index.indexOf(';') > 0) {\n                    position.index = '0';\n                }\n                return child;\n            }\n            if (child instanceof Widget) {\n                if (position.index.indexOf(';') > 0) {\n                    return this.getParagraphInternal(child, position);\n                }\n                else {\n                    //If table is shifted to previous text position then return the first paragraph within table.\n                    if (child instanceof TableWidget) {\n                        return this.viewer.selection.getFirstParagraphInFirstCell(child);\n                    }\n                    return undefined;\n                }\n            }\n        }\n        else if (container) {\n            var nextWidget = container.getSplitWidgets().pop().nextRenderedWidget;\n            if (nextWidget instanceof Widget) {\n                position.index = '0';\n                if (nextWidget instanceof TableWidget) {\n                    return this.viewer.selection.getFirstParagraphInFirstCell(nextWidget);\n                }\n                return nextWidget;\n            }\n        }\n        return undefined;\n    };\n    Editor.prototype.getBodyWidget = function (position) {\n        var index = position.index.indexOf(';');\n        var value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        var sectionIndex = parseInt(value, 10);\n        index = parseInt(value, 10);\n        index = position.index.indexOf(';');\n        value = position.index.substring(0, index);\n        // position = position.substring(index).replace(';', '');\n        if (value === 'H' || value === 'F') {\n            return this.getHeaderFooterWidget(position);\n        }\n        index = parseInt(value, 10);\n        return this.getBodyWidgetInternal(sectionIndex, index);\n    };\n    Editor.prototype.getHeaderFooterWidget = function (position) {\n        //HEADER OR FOOTER WIDGET\n        var index = position.index.indexOf(';');\n        var value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        var isHeader = value === 'H';\n        index = position.index.indexOf(';');\n        value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        index = parseInt(value, 10);\n        var page = this.viewer.pages[index];\n        if (isHeader) {\n            return page.headerWidget;\n        }\n        else {\n            return page.footerWidget;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBodyWidgetInternal = function (sectionIndex, blockIndex) {\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var bodyWidget = this.viewer.pages[i].bodyWidgets[0];\n            if (bodyWidget.index === sectionIndex) {\n                if (bodyWidget.firstChild.index <= blockIndex && bodyWidget.lastChild.index >= blockIndex) {\n                    return bodyWidget;\n                }\n            }\n            if (bodyWidget.index > sectionIndex) {\n                break;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBlockByIndex = function (container, blockIndex) {\n        var childWidget;\n        if (container) {\n            for (var j = 0; j < container.childWidgets.length; j++) {\n                if (container.childWidgets[j].index === blockIndex) {\n                    childWidget = container.childWidgets[j];\n                    break;\n                }\n            }\n            if (!childWidget && !(container instanceof HeaderFooterWidget)) {\n                return this.getBlockByIndex(container.nextSplitWidget, blockIndex);\n            }\n        }\n        return childWidget;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHistoryPosition = function (position, isInsertPosition) {\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            var hierarchicalIndex = void 0;\n            if (position instanceof TextPosition) {\n                var blockInfo = this.getParagraphInfo(position);\n                hierarchicalIndex = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            }\n            else {\n                hierarchicalIndex = position;\n            }\n            if (isInsertPosition) {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = hierarchicalIndex;\n            }\n            else {\n                this.editorHistory.currentBaseHistoryInfo.endPosition = hierarchicalIndex;\n            }\n        }\n    };\n    /**\n     * Applies the borders based on given settings.\n     * @param {BorderSettings} settings\n     */\n    Editor.prototype.applyBorders = function (settings) {\n        this.initHistory('Borders');\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        var table = startPos.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        if (this.editorHistory) {\n            var clonedTable = this.cloneTableToHistoryInfo(table);\n        }\n        var startCell = startPos.paragraph.associatedCell;\n        var endCell = endPos.paragraph.associatedCell;\n        var cells;\n        var border = this.getBorder(settings.borderColor, settings.lineWidth, settings.borderStyle);\n        if (this.selection.isEmpty) {\n            //Apply borders for current selected cell initially.                    \n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'LeftBorder') {\n                endCell.cellFormat.borders.left.copyFormat(border);\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'TopBorder') {\n                endCell.cellFormat.borders.top.copyFormat(border);\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'RightBorder') {\n                endCell.cellFormat.borders.right.copyFormat(border);\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'BottomBorder') {\n                endCell.cellFormat.borders.bottom.copyFormat(border);\n            }\n            if (settings.type === 'AllBorders' || settings.type === 'InsideBorders'\n                || settings.type === 'InsideVerticalBorder') {\n                endCell.cellFormat.borders.vertical.copyFormat(border);\n            }\n            if (settings.type === 'AllBorders' || settings.type === 'InsideBorders'\n                || settings.type === 'InsideHorizontalBorder') {\n                endCell.cellFormat.borders.horizontal.copyFormat(border);\n            }\n            if (settings.type === 'NoBorder') {\n                this.clearAllBorderValues(endCell.cellFormat.borders);\n            }\n        }\n        else {\n            if (settings.type === 'OutsideBorders' || settings.type === 'TopBorder') {\n                var selectedCell = this.getTopBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.top.copyFormat(border);\n                }\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'LeftBorder') {\n                var selectedCell = this.getLeftBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.left.copyFormat(border);\n                }\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'RightBorder') {\n                var selectedCell = this.getRightBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.right.copyFormat(border);\n                }\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'BottomBorder') {\n                var selectedCell = this.getBottomBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.bottom.copyFormat(border);\n                }\n            }\n        }\n        //Apply Only borders property to selected cells      \n        if (settings.type === 'BottomBorder' || settings.type === 'AllBorders' || settings.type === 'OutsideBorders'\n            || settings.type === 'NoBorder') {\n            cells = this.getAdjacentCellToApplyBottomBorder();\n            for (var i = 0; i < cells.length; i++) {\n                var cell = cells[i];\n                if (settings.type === 'NoBorder') {\n                    cell.cellFormat.borders.top.copyFormat(this.clearBorder());\n                }\n                else {\n                    cell.cellFormat.borders.top.copyFormat(border);\n                }\n            }\n        }\n        if (settings.type === 'AllBorders' || settings.type === 'OutsideBorders' || settings.type === 'RightBorder'\n            || settings.type === 'NoBorder') {\n            cells = this.getAdjacentCellToApplyRightBorder();\n            for (var i = 0; i < cells.length; i++) {\n                var cell = cells[i];\n                if (settings.type === 'NoBorder') {\n                    cell.cellFormat.borders.left.copyFormat(this.clearBorder());\n                }\n                else {\n                    cell.cellFormat.borders.left.copyFormat(border);\n                }\n            }\n        }\n        if (settings.type === 'AllBorders' || settings.type === 'NoBorder') {\n            this.applyAllBorders(border, settings.type);\n        }\n        if (settings.type === 'InsideBorders' || settings.type === 'InsideVerticalBorder'\n            || settings.type === 'InsideHorizontalBorder' || settings.type === 'NoBorder') {\n            this.applyInsideBorders(border, settings.type, table);\n        }\n        this.updateGridForTableDialog(table, false);\n        this.reLayout(this.selection, false);\n        this.editorHistory.updateHistory();\n    };\n    Editor.prototype.applyAllBorders = function (border, borderType) {\n        var cells = this.selection.getSelectedCells();\n        for (var i = 0; i < cells.length; i++) {\n            if (borderType === 'NoBorder') {\n                cells[i].cellFormat.borders.left.copyFormat(this.clearBorder());\n                cells[i].cellFormat.borders.right.copyFormat(this.clearBorder());\n                cells[i].cellFormat.borders.top.copyFormat(this.clearBorder());\n                cells[i].cellFormat.borders.bottom.copyFormat(this.clearBorder());\n            }\n            else {\n                cells[i].cellFormat.borders.left.copyFormat(border);\n                cells[i].cellFormat.borders.right.copyFormat(border);\n                cells[i].cellFormat.borders.top.copyFormat(border);\n                cells[i].cellFormat.borders.bottom.copyFormat(border);\n            }\n        }\n    };\n    Editor.prototype.applyInsideBorders = function (border, borderType, table) {\n        var cells = this.selection.getSelectedCells();\n        for (var i = 0; i < cells.length; i++) {\n            var cell = cells[i];\n            var isLastSelectedRow = cell.ownerRow === cells[cells.length - 1].ownerRow;\n            var isLastRightCell = (cell.columnIndex + cell.cellFormat.columnSpan - 1) === cells[cells.length - 1].columnIndex;\n            if (borderType === 'NoBorder') {\n                cell.cellFormat.borders.right.copyFormat(this.clearBorder());\n                cell.cellFormat.borders.bottom.copyFormat(this.clearBorder());\n            }\n            else {\n                if (!isLastRightCell && borderType !== 'InsideHorizontalBorder') {\n                    cell.cellFormat.borders.right.copyFormat(border);\n                }\n                if (!isLastSelectedRow && borderType !== 'InsideVerticalBorder') {\n                    cell.cellFormat.borders.bottom.copyFormat(border);\n                }\n            }\n            if (!isLastSelectedRow && borderType !== 'InsideVerticalBorder') {\n                // Apply adjacent bottom borders.\n                var nextRowIndex = cell.ownerRow.rowIndex + cell.cellFormat.rowSpan;\n                var nextRow = table.childWidgets[nextRowIndex];\n                if (nextRow) {\n                    var selectedCells = this.getAdjacentBottomBorderOnEmptyCells(nextRow, cell, true);\n                    for (var j = 0; j < selectedCells.length; j++) {\n                        if (borderType === 'NoBorder') {\n                            selectedCells[j].cellFormat.borders.top.copyFormat(this.clearBorder());\n                        }\n                        else {\n                            selectedCells[j].cellFormat.borders.top.copyFormat(border);\n                        }\n                    }\n                }\n            }\n            if (!isLastRightCell && borderType !== 'InsideHorizontalBorder') {\n                // Apply adjacent right borders.\n                var rightBorderCells = this.getSelectedCellsNextWidgets(cell, table);\n                for (var k = 0; k < rightBorderCells.length; k++) {\n                    if (borderType === 'NoBorder') {\n                        rightBorderCells[k].cellFormat.borders.left.copyFormat(this.clearBorder());\n                    }\n                    else {\n                        rightBorderCells[k].cellFormat.borders.left.copyFormat(border);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getTopBorderCellsOnSelection = function () {\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var startCell = startPos.paragraph.associatedCell;\n        var topBorderCells = [];\n        var cells = this.selection.getSelectedCells();\n        for (var i = 0; i < cells.length; i++) {\n            if (cells[i].ownerRow === startCell.ownerRow) {\n                topBorderCells.push(cells[i]);\n            }\n        }\n        return topBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getLeftBorderCellsOnSelection = function () {\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var startCell = startPos.paragraph.associatedCell;\n        var cells = this.selection.getSelectedCells();\n        var leftBorderCells = [];\n        for (var i = 0; i < cells.length; i++) {\n            if (cells[i].columnIndex === startCell.columnIndex) {\n                leftBorderCells.push(cells[i]);\n            }\n        }\n        return leftBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getRightBorderCellsOnSelection = function () {\n        var cells = this.selection.getSelectedCells();\n        var rightBorderCells = [];\n        for (var i = 0; i < cells.length; i++) {\n            if ((cells[i].columnIndex + cells[i].cellFormat.columnSpan - 1) === cells[cells.length - 1].columnIndex) {\n                rightBorderCells.push(cells[i]);\n            }\n        }\n        return rightBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBottomBorderCellsOnSelection = function () {\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        var endCell = endPos.paragraph.associatedCell;\n        var cells = this.selection.getSelectedCells();\n        var bottomBorderCells = [];\n        for (var i = 0; i < cells.length; i++) {\n            if (cells[i].ownerRow === endCell.ownerRow) {\n                bottomBorderCells.push(cells[i]);\n            }\n        }\n        return bottomBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.clearAllBorderValues = function (borders) {\n        var border = this.clearBorder();\n        borders.bottom.copyFormat(border);\n        borders.left.copyFormat(border);\n        borders.right.copyFormat(border);\n        borders.top.copyFormat(border);\n        borders.vertical.copyFormat(border);\n        borders.horizontal.copyFormat(border);\n    };\n    Editor.prototype.clearBorder = function () {\n        var border = new WBorder();\n        border.lineStyle = 'Cleared';\n        return border;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getAdjacentCellToApplyBottomBorder = function () {\n        var cells = [];\n        var startPos = this.selection.start;\n        var endPos = this.selection.end;\n        if (!this.selection.isForward) {\n            startPos = this.selection.end;\n            endPos = this.selection.start;\n        }\n        var table = startPos.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        var startCell = startPos.paragraph.associatedCell;\n        var endCell = endPos.paragraph.associatedCell;\n        var nextRowIndex = endCell.ownerRow.rowIndex + endCell.cellFormat.rowSpan;\n        var nextRow = table.childWidgets[nextRowIndex];\n        if (nextRow) {\n            if (endCell.cellFormat.columnSpan > 1) {\n                for (var i = endCell.columnIndex; i < endCell.columnIndex + endCell.cellFormat.columnSpan; i++) {\n                    cells.push(nextRow.childWidgets[i]);\n                }\n            }\n            else {\n                cells = this.getAdjacentBottomBorderOnEmptyCells(nextRow, endCell);\n                if (!this.selection.isEmpty) {\n                    for (var i = 0; i < nextRow.childWidgets.length; i++) {\n                        var nextCellColIndex = nextRow.childWidgets[i].columnIndex;\n                        if (nextCellColIndex >= startCell.columnIndex && nextCellColIndex <= endCell.columnIndex) {\n                            cells.push(nextRow.childWidgets[i]);\n                        }\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    Editor.prototype.getAdjacentBottomBorderOnEmptyCells = function (nextRow, cell, isSingleCell) {\n        var cells = [];\n        if (cell.cellFormat.columnSpan > 1) {\n            for (var i = cell.columnIndex; i < cell.columnIndex + cell.cellFormat.columnSpan; i++) {\n                cells.push(nextRow.childWidgets[i]);\n            }\n        }\n        else {\n            if (this.selection.isEmpty || isSingleCell) {\n                for (var i = 0; i < nextRow.childWidgets.length; i++) {\n                    if (nextRow.childWidgets[i].columnIndex === cell.columnIndex) {\n                        cells.push(nextRow.childWidgets[i]);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getAdjacentCellToApplyRightBorder = function () {\n        var cells = [];\n        var startPosIn = this.selection.start;\n        var endPosIn = this.selection.end;\n        if (!this.selection.isForward) {\n            startPosIn = this.selection.end;\n            endPosIn = this.selection.start;\n        }\n        var table = startPosIn.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        var startCell = startPosIn.paragraph.associatedCell;\n        var endCell = endPosIn.paragraph.associatedCell;\n        if (this.selection.isEmpty) {\n            var selectedCell = startPosIn.paragraph.associatedCell;\n            cells = this.getSelectedCellsNextWidgets(selectedCell, table);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            var selectedCells = this.getRightBorderCellsOnSelection();\n            for (var i = 0; i < selectedCells.length; i++) {\n                var cell = selectedCells[i];\n                cells = cells.concat(this.getSelectedCellsNextWidgets(cell, table));\n            }\n        }\n        return cells;\n    };\n    Editor.prototype.getSelectedCellsNextWidgets = function (selectedCell, table) {\n        var cells = [];\n        if (selectedCell.nextWidget) {\n            cells.push(selectedCell.nextWidget);\n        }\n        if (selectedCell.cellFormat.rowSpan > 1) {\n            var nextRowIndex = selectedCell.ownerRow.rowIndex + selectedCell.cellFormat.rowSpan;\n            for (var i = selectedCell.ownerRow.rowIndex + 1; i < nextRowIndex; i++) {\n                var nextRow = table.childWidgets[i];\n                if (nextRow) {\n                    for (var j = 0; j < nextRow.childWidgets.length; j++) {\n                        if (nextRow.childWidgets[j].columnIndex ===\n                            selectedCell.nextWidget.columnIndex) {\n                            cells.push(nextRow.childWidgets[j]);\n                        }\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBorder = function (borderColor, lineWidth, borderStyle) {\n        var border = new WBorder();\n        border.color = borderColor || '#000000';\n        border.lineWidth = lineWidth || 1;\n        border.lineStyle = borderStyle || 'Single';\n        return border;\n    };\n    /**\n     * Applies borders\n     * @param  {WBorders} sourceBorders\n     * @param  {WBorders} applyBorders\n     * @private\n     */\n    Editor.prototype.applyBordersInternal = function (sourceBorders, applyBorders) {\n        if (!isNullOrUndefined(sourceBorders) && !isNullOrUndefined(sourceBorders)) {\n            if (!isNullOrUndefined(sourceBorders.top)) {\n                this.applyBorder(sourceBorders.top, applyBorders.top);\n            }\n            if (!isNullOrUndefined(sourceBorders.bottom)) {\n                this.applyBorder(sourceBorders.bottom, applyBorders.bottom);\n            }\n            if (!isNullOrUndefined(sourceBorders.left)) {\n                this.applyBorder(sourceBorders.left, applyBorders.left);\n            }\n            if (!isNullOrUndefined(sourceBorders.right)) {\n                this.applyBorder(sourceBorders.right, applyBorders.right);\n            }\n            if (!isNullOrUndefined(sourceBorders.horizontal)) {\n                this.applyBorder(sourceBorders.horizontal, applyBorders.horizontal);\n            }\n            if (!isNullOrUndefined(sourceBorders.vertical)) {\n                this.applyBorder(sourceBorders.vertical, applyBorders.vertical);\n            }\n            if (!isNullOrUndefined(sourceBorders.diagonalUp)) {\n                this.applyBorder(sourceBorders.diagonalUp, applyBorders.diagonalUp);\n            }\n            if (!isNullOrUndefined(sourceBorders.diagonalDown)) {\n                this.applyBorder(sourceBorders.diagonalDown, applyBorders.diagonalDown);\n            }\n        }\n    };\n    /**\n     * Apply shading to table\n     * @param  {WShading} sourceShading\n     * @param  {WShading} applyShading\n     * @private\n     */\n    Editor.prototype.applyShading = function (sourceShading, applyShading) {\n        if (!isNullOrUndefined(applyShading) && !isNullOrUndefined(sourceShading)) {\n            if (!isNullOrUndefined(applyShading.backgroundColor)\n                && sourceShading.backgroundColor !== applyShading.backgroundColor) {\n                sourceShading.backgroundColor = applyShading.backgroundColor;\n            }\n            if (!isNullOrUndefined(applyShading.foregroundColor)\n                && sourceShading.foregroundColor !== applyShading.foregroundColor) {\n                sourceShading.foregroundColor = applyShading.foregroundColor;\n            }\n            if (!isNullOrUndefined(applyShading.textureStyle)\n                && sourceShading.textureStyle !== applyShading.textureStyle) {\n                sourceShading.textureStyle = applyShading.textureStyle;\n            }\n        }\n    };\n    Editor.prototype.applyBorder = function (sourceBorder, applyBorder) {\n        if (!isNullOrUndefined(sourceBorder) && !isNullOrUndefined(applyBorder)) {\n            if (!isNullOrUndefined(applyBorder.color)\n                && sourceBorder.color !== applyBorder.color) {\n                sourceBorder.color = applyBorder.color;\n            }\n            if (!isNullOrUndefined(applyBorder.lineStyle)\n                && sourceBorder.lineStyle !== applyBorder.lineStyle) {\n                sourceBorder.lineStyle = applyBorder.lineStyle;\n            }\n            if (!isNullOrUndefined(applyBorder.lineWidth)\n                && sourceBorder.lineWidth !== applyBorder.lineWidth) {\n                sourceBorder.lineWidth = applyBorder.lineWidth;\n            }\n            if (!isNullOrUndefined(applyBorder.shadow)\n                && sourceBorder.shadow !== applyBorder.shadow) {\n                sourceBorder.shadow = applyBorder.shadow;\n            }\n            if (!isNullOrUndefined(applyBorder.space)\n                && sourceBorder.space !== applyBorder.space) {\n                sourceBorder.space = applyBorder.space;\n            }\n        }\n    };\n    /**\n     * Apply Table Format changes\n     * @param  {Selection} selection\n     * @param  {WTableFormat} format\n     * @private\n     */\n    Editor.prototype.onTableFormat = function (format) {\n        if (!isNullOrUndefined(this.selection.tableFormat)) {\n            this.viewer.owner.isShiftingEnabled = true;\n            this.editorHistory.initializeHistory('TableFormat');\n            var table = this.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            this.applyTableFormat(table, undefined, format);\n            this.reLayout(this.selection, false);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyTableFormat = function (table, property, value) {\n        this.applyTablePropertyValue(this.viewer.selection, undefined, value, table);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyTablePropertyValue = function (selection, property, value, table) {\n        var sourceFormat = table.tableFormat;\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedTableProperties(sourceFormat, property, value);\n        }\n        if (value instanceof WTableFormat) {\n            if (isNullOrUndefined(property)) {\n                this.handleTableFormat(sourceFormat, value);\n            }\n            return;\n        }\n        if (property === 'preferredWidth') {\n            sourceFormat.preferredWidth = value;\n        }\n        else if (property === 'leftIndent') {\n            sourceFormat.leftIndent = value;\n        }\n        else if (property === 'tableAlignment') {\n            sourceFormat.tableAlignment = value;\n        }\n        else if (property === 'cellSpacing') {\n            sourceFormat.cellSpacing = value;\n        }\n        else if (property === 'leftMargin') {\n            sourceFormat.leftMargin = value;\n        }\n        else if (property === 'rightMargin') {\n            sourceFormat.rightMargin = value;\n        }\n        else if (property === 'topMargin') {\n            sourceFormat.topMargin = value;\n        }\n        else if (property === 'bottomMargin') {\n            sourceFormat.bottomMargin = value;\n        }\n        else if (property === 'preferredWidthType') {\n            sourceFormat.preferredWidthType = value;\n        }\n        else if (property === 'bidi') {\n            sourceFormat.bidi = value;\n        }\n        if (property === 'shading') {\n            sourceFormat.shading = value;\n        }\n        else if (property === 'borders') {\n            sourceFormat.borders = value;\n        }\n        // if (!isNullOrUndefined(table)) {\n        //     this.layoutItemBlock(table, true);\n        // }\n    };\n    Editor.prototype.handleTableFormat = function (tableFormat, applyFormat) {\n        if (this.isBordersAndShadingDialog || this.editorHistory.isUndoing\n            || this.editorHistory.isRedoing) {\n            if (!isNullOrUndefined(tableFormat.borders)) {\n                this.applyBordersInternal(tableFormat.borders, applyFormat.borders);\n            }\n            if (!isNullOrUndefined(tableFormat.shading)) {\n                this.applyShading(tableFormat.shading, applyFormat.shading);\n            }\n        }\n        if (!this.isBordersAndShadingDialog) {\n            if (applyFormat.hasValue('bidi') && applyFormat.bidi !== tableFormat.bidi) {\n                tableFormat.bidi = applyFormat.bidi;\n            }\n            if (applyFormat.hasValue('preferredWidth') && applyFormat.preferredWidth !== tableFormat.preferredWidth) {\n                tableFormat.preferredWidth = applyFormat.preferredWidth;\n            }\n            if (applyFormat.hasValue('preferredWidthType') && applyFormat.preferredWidthType !== tableFormat.preferredWidthType) {\n                tableFormat.preferredWidthType = applyFormat.preferredWidthType;\n            }\n            if (applyFormat.hasValue('tableAlignment') && applyFormat.tableAlignment !== tableFormat.tableAlignment) {\n                tableFormat.tableAlignment = applyFormat.tableAlignment;\n            }\n            if (applyFormat.hasValue('leftIndent') && applyFormat.leftIndent !== tableFormat.leftIndent) {\n                tableFormat.leftIndent = applyFormat.leftIndent;\n            }\n        }\n        this.updateGridForTableDialog(tableFormat.ownerBase, false);\n    };\n    Editor.prototype.updateGridForTableDialog = function (table, shiftNextItem) {\n        if (table.tableHolder) {\n            table.updateRowIndex(0);\n            table.calculateGrid();\n            table.isGridUpdated = false;\n        }\n        this.viewer.layout.reLayoutTable(table);\n    };\n    /**\n     * Applies Row Format Changes\n     * @param  {Selection} selection\n     * @param  {WRowFormat} format\n     * @param  {WRow} row\n     * @private\n     */\n    Editor.prototype.onRowFormat = function (format) {\n        if (isNullOrUndefined(this.selection) || isNullOrUndefined(format)) {\n            return;\n        }\n        this.editorHistory.initializeHistory('RowFormat');\n        this.viewer.owner.isShiftingEnabled = true;\n        var rowStartPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var rowEndPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        var table = rowStartPos.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n        this.applyRowFormat(rowStartPos.paragraph.associatedCell.ownerRow, rowStartPos, rowEndPos, undefined, format);\n        this.reLayout(this.selection, false);\n    };\n    Editor.prototype.applyRowFormat = function (row, start, end, property, value) {\n        this.applyRowPropertyValue(this.viewer.selection, property, value, row);\n        if (end.paragraph.associatedCell.ownerRow === row) {\n            return;\n        }\n        var newRow = row.nextWidget;\n        if (!isNullOrUndefined(newRow)) {\n            this.applyRowFormat(newRow, start, end, property, value);\n        }\n    };\n    Editor.prototype.applyRowPropertyValue = function (selection, property, value, row) {\n        var applyFormat = row.rowFormat;\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedRowProperties(applyFormat, property, value);\n        }\n        if (value instanceof WRowFormat) {\n            if (isNullOrUndefined(property)) {\n                this.handleRowFormat(value, applyFormat);\n            }\n            return;\n        }\n        if (property === 'heightType') {\n            applyFormat.heightType = value;\n        }\n        else if (property === 'height') {\n            applyFormat.height = value;\n        }\n        else if (property === 'isHeader') {\n            applyFormat.isHeader = value;\n        }\n        else if (property === 'allowBreakAcrossPages') {\n            applyFormat.allowBreakAcrossPages = value;\n        }\n        if (!isNullOrUndefined(row.ownerTable)) {\n            this.layoutItemBlock(row.ownerTable, true);\n        }\n    };\n    Editor.prototype.handleRowFormat = function (format, applyFormat) {\n        if (format.hasValue('allowBreakAcrossPages') && format.allowBreakAcrossPages !== applyFormat.allowBreakAcrossPages) {\n            applyFormat.allowBreakAcrossPages = format.allowBreakAcrossPages;\n        }\n        if (format.hasValue('isHeader') && format.isHeader !== applyFormat.isHeader) {\n            applyFormat.isHeader = format.isHeader;\n        }\n        if (format.hasValue('heightType') && format.heightType !== applyFormat.heightType) {\n            applyFormat.heightType = format.heightType;\n        }\n        if (format.hasValue('height') && format.height !== applyFormat.height) {\n            applyFormat.height = format.height;\n        }\n        this.updateGridForTableDialog(applyFormat.ownerBase.ownerTable, true);\n    };\n    /**\n     * Applies Cell Format changes\n     * @param  {Selection} selection\n     * @param  {WCellFormat} format\n     * @param  {WCell} cell\n     * @private\n     */\n    Editor.prototype.onCellFormat = function (format) {\n        if (isNullOrUndefined(this.selection) || isNullOrUndefined(format)) {\n            return;\n        }\n        this.editorHistory.initializeHistory('CellFormat');\n        this.updateFormatForCell(this.selection, undefined, format);\n        this.reLayout(this.selection, false);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateCellMargins = function (selection, value) {\n        var cellStartPosition = selection.start;\n        var cellEndPosition = selection.end;\n        if (!selection.isForward) {\n            cellStartPosition = selection.end;\n            cellEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, cellStartPosition);\n        // tslint:disable-next-line:max-line-length\n        this.viewer.owner.cellOptionsDialogModule.applyCellmarginsValue(cellStartPosition.paragraph.associatedCell.ownerRow, cellStartPosition, cellEndPosition, value);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateFormatForCell = function (selection, property, value) {\n        var start = selection.start;\n        var end = selection.end;\n        if (!selection.isForward) {\n            start = selection.end;\n            end = selection.start;\n        }\n        var startCell = start.paragraph.associatedCell;\n        var endCell = end.paragraph.associatedCell;\n        var cells;\n        var table = startCell.ownerTable.combineWidget(this.viewer);\n        var appliedFormat;\n        for (var k = startCell.columnIndex; k <= endCell.columnIndex; k++) {\n            cells = this.getSelectedCellInColumn(startCell.ownerTable, startCell.ownerRow.rowIndex, k, endCell.ownerRow.rowIndex);\n            for (var i = 0; i < cells.length; i++) {\n                appliedFormat = this.applyCellPropertyValue(this.viewer.selection, property, value, cells[i].cellFormat);\n            }\n        }\n        this.updateGridForTableDialog(table, false);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getSelectedCellInColumn = function (table, rowStartIndex, columnIndex, rowEndIndex) {\n        var cells = [];\n        for (var i = rowStartIndex; i <= rowEndIndex; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                if (row.childWidgets[j].columnIndex === columnIndex) {\n                    cells.push(row.childWidgets[j]);\n                }\n            }\n        }\n        return cells;\n    };\n    Editor.prototype.getColumnCells = function (table, columnIndex, isLeftSideCollection) {\n        var cells = [];\n        for (var k = 0; k < table.childWidgets.length; k++) {\n            var row = table.childWidgets[k];\n            for (var i = 0; i < row.childWidgets.length; i++) {\n                var cell = row.childWidgets[i];\n                if (isLeftSideCollection) {\n                    if (cell.columnIndex + cell.cellFormat.columnSpan === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n                else {\n                    if (cell.columnIndex === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getTableWidth = function (table) {\n        if (table.tableFormat.preferredWidth !== 0 || table.tableFormat.preferredWidthType === 'Percent') {\n            if (table.tableFormat.preferredWidthType === 'Auto' || table.tableFormat.preferredWidthType === 'Point') {\n                return table.tableFormat.preferredWidth;\n            }\n            else {\n                if (table.tableFormat.preferredWidth === 0) {\n                    return 0;\n                }\n                else {\n                    return HelperMethods.convertPixelToPoint(this.viewer.clientArea.width) / 100 * table.tableFormat.preferredWidth;\n                }\n            }\n        }\n        return HelperMethods.convertPixelToPoint(this.viewer.layout.getTableWidth(table));\n    };\n    Editor.prototype.applyCellPropertyValue = function (selection, property, value, applyFormat) {\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedCellProperties(applyFormat, property, value);\n        }\n        if (value instanceof WCellFormat) {\n            if (isNullOrUndefined(property)) {\n                this.handleCellFormat(value, applyFormat);\n            }\n            return value;\n        }\n        if (property === 'leftMargin') {\n            applyFormat.leftMargin = value;\n        }\n        else if (property === 'topMargin') {\n            applyFormat.topMargin = value;\n        }\n        else if (property === 'rightMargin') {\n            applyFormat.rightMargin = value;\n        }\n        else if (property === 'bottomMargin') {\n            applyFormat.bottomMargin = value;\n        }\n        else if (property === 'preferredWidth') {\n            applyFormat.preferredWidth = value;\n            applyFormat.cellWidth = value;\n        }\n        else if (property === 'cellWidth') {\n            applyFormat.cellWidth = value;\n        }\n        else if (property === 'columnSpan') {\n            applyFormat.columnSpan = value;\n        }\n        else if (property === 'rowSpan') {\n            applyFormat.rowSpan = value;\n        }\n        else if (property === 'preferredWidthType') {\n            applyFormat.preferredWidthType = value;\n        }\n        else if (property === 'verticalAlignment') {\n            applyFormat.verticalAlignment = value;\n        }\n        if (property === 'shading') {\n            applyFormat.shading = value;\n        }\n        else if (property === 'borders') {\n            applyFormat.borders = value;\n        }\n        return undefined;\n    };\n    Editor.prototype.handleCellFormat = function (cellFormat, applyFormat) {\n        if (!isNullOrUndefined(cellFormat) && !isNullOrUndefined(applyFormat)) {\n            if (this.isBordersAndShadingDialog) {\n                if (!isNullOrUndefined(cellFormat.borders)) {\n                    this.applyBordersInternal(applyFormat.borders, cellFormat.borders);\n                }\n                if (!isNullOrUndefined(cellFormat.shading)) {\n                    this.applyShading(applyFormat.shading, cellFormat.shading);\n                }\n                // this.layoutRow((applyFormat.ownerBase as TableCellWidget).ownerRow, this.viewer, false);\n            }\n            else {\n                if (cellFormat.hasValue('preferredWidth') && applyFormat.preferredWidth !== cellFormat.preferredWidth) {\n                    applyFormat.preferredWidth = cellFormat.preferredWidth;\n                }\n                if (cellFormat.hasValue('preferredWidthType') && applyFormat.preferredWidthType !== cellFormat.preferredWidthType) {\n                    applyFormat.preferredWidthType = cellFormat.preferredWidthType;\n                }\n                if (cellFormat.hasValue('verticalAlignment') && applyFormat.verticalAlignment !== cellFormat.verticalAlignment) {\n                    applyFormat.verticalAlignment = cellFormat.verticalAlignment;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.destroy = function () {\n        this.viewer = undefined;\n        this.nodes = [];\n    };\n    Editor.prototype.isTocField = function (element) {\n        if (element instanceof FieldElementBox) {\n            var nextElement = element.nextNode;\n            if (element instanceof FieldElementBox && element.fieldType === 0 && nextElement instanceof TextElementBox\n                && nextElement.text.trim().toLowerCase().indexOf('toc') === 0) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Updates the table of contents.\n     * @private\n     */\n    Editor.prototype.updateToc = function (tocField) {\n        if (isNullOrUndefined(tocField)) {\n            tocField = this.selection.getTocFieldInternal();\n        }\n        if (!this.isTocField(tocField)) {\n            return;\n        }\n        // Decode field code to get parameters\n        var code = this.selection.getFieldCode(tocField);\n        if (code.toLocaleLowerCase().indexOf('toc') !== -1) {\n            this.insertTableOfContents(this.validateTocSettings(this.getTocSettings(code, tocField)));\n        }\n    };\n    Editor.prototype.getTocSettings = function (code, tocField) {\n        var tocSettings = {};\n        tocSettings.includePageNumber = true;\n        tocSettings.rightAlign = true;\n        // Decode field code to get parameters\n        if (code.toLowerCase() === 'toc \\\\mergeformat') {\n            tocSettings.startLevel = 1;\n            tocSettings.endLevel = 3;\n        }\n        else {\n            var swtiches = code.split('\\\\');\n            for (var i = 0; i < swtiches.length; i++) {\n                var swtch = swtiches[i];\n                if (swtch.length === 0) {\n                    continue;\n                }\n                switch (swtch[0]) {\n                    case 'o':\n                        if (!isNullOrUndefined(swtch.match(/\\d+/g))) {\n                            var levels = swtch.match(/\\d+/g).map(Number);\n                            tocSettings.startLevel = levels[0];\n                            tocSettings.endLevel = levels[1];\n                        }\n                        else {\n                            tocSettings.startLevel = 1;\n                            tocSettings.endLevel = 9;\n                        }\n                        break;\n                    case 'h':\n                        tocSettings.includeHyperlink = true;\n                        break;\n                    case 'n':\n                        tocSettings.includePageNumber = false;\n                        break;\n                    case 'p':\n                        tocSettings.rightAlign = false;\n                        break;\n                    case 'u':\n                        tocSettings.includeOutlineLevels = true;\n                        break;\n                    case 't':\n                        this.decodeTSwitch(tocSettings, swtch);\n                        break;\n                }\n            }\n        }\n        //assigns tab leader.\n        var tabs = tocField.paragraph.paragraphFormat.getUpdatedTabs();\n        if (tabs.length > 0) {\n            tocSettings.tabLeader = tabs[tabs.length - 1].tabLeader;\n        }\n        if (tocSettings.rightAlign && isNullOrUndefined(tocSettings.tabLeader)) {\n            tocSettings.tabLeader = 'Dot';\n        }\n        return tocSettings;\n    };\n    Editor.prototype.decodeTSwitch = function (tocSettings, tSwitch) {\n        tocSettings.levelSettings = {};\n        tSwitch = tSwitch.replace('t', '');\n        tSwitch = tSwitch.replace('\"', '');\n        tSwitch = tSwitch.replace('\"', '');\n        tSwitch = tSwitch.trim();\n        var levels = tSwitch.split(',');\n        for (var index = 0; index < levels.length; index++) {\n            tocSettings.levelSettings[levels[index]] = parseInt(levels[index + 1], 10);\n            index++;\n        }\n    };\n    /**\n     * Inserts, modifies or updates the table of contents based on given settings.\n     * @param {TableOfContentsSettings} tableOfContentsSettings\n     */\n    Editor.prototype.insertTableOfContents = function (tableOfContentsSettings) {\n        this.isInsertingTOC = true;\n        this.initComplexHistory('TOC');\n        if (isNullOrUndefined(tableOfContentsSettings)) {\n            //Initializes with default value.\n            tableOfContentsSettings = {};\n            tableOfContentsSettings.startLevel = 1;\n            tableOfContentsSettings.endLevel = 3;\n            tableOfContentsSettings.includeHyperlink = true;\n            tableOfContentsSettings.includeOutlineLevels = true;\n            tableOfContentsSettings.includePageNumber = true;\n            tableOfContentsSettings.rightAlign = true;\n            tableOfContentsSettings.tabLeader = 'Dot';\n        }\n        var tocField = undefined;\n        var code = undefined;\n        if (this.selection.contextType === 'TableOfContents') {\n            tocField = this.selection.getTocFieldInternal();\n        }\n        if (tocField instanceof FieldElementBox) {\n            this.selection.start.setPositionForSelection(tocField.line, tocField, 0, this.selection.start.location);\n            this.selection.end.setPositionForSelection(tocField.fieldEnd.line, tocField.fieldEnd, 2, this.selection.end.location);\n            this.onDelete();\n        }\n        // Build TOC field code based on parameter\n        code = this.constructTocFieldCode(tableOfContentsSettings);\n        var isStartParagraph = this.selection.start.isAtParagraphStart;\n        var blockInfo = this.getParagraphInfo(this.selection.start);\n        var initialStart = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        // Build TOC fields\n        // tslint:disable-next-line:max-line-length\n        var widgets = this.buildToc(this.validateTocSettings(tableOfContentsSettings), code, true, isStartParagraph);\n        if (widgets.length > 0) {\n            var tocLastPara = new ParagraphWidget();\n            var tocLastLine = new LineWidget(tocLastPara);\n            tocLastPara.childWidgets.push(tocLastLine);\n            var index = 0;\n            if (!isStartParagraph) {\n                index = 1;\n            }\n            var line = widgets[index].childWidgets[0];\n            var fieldBegin = line.children[0];\n            this.appendEndField(fieldBegin, tocLastLine);\n            widgets.push(tocLastPara);\n            this.appendEmptyPara(widgets);\n        }\n        this.setPositionForCurrentIndex(this.selection.start, initialStart);\n        this.selection.end.setPositionInternal(this.selection.start);\n        this.pasteContentsInternal(widgets);\n        this.isInsertingTOC = false;\n        this.updatePageRef();\n        if (this.editorHistory) {\n            this.editorHistory.updateComplexHistoryInternal();\n        }\n    };\n    Editor.prototype.appendEmptyPara = function (widgets) {\n        var emptyPara = new ParagraphWidget();\n        var emptyLine = new LineWidget(emptyPara);\n        emptyPara.childWidgets.push(emptyLine);\n        widgets.push(emptyPara);\n    };\n    Editor.prototype.constructTocFieldCode = function (tocSettings) {\n        var tocFieldCode = 'TOC';\n        //appends styles level\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(tocSettings.startLevel) && tocSettings.startLevel !== 0 && !isNullOrUndefined(tocSettings.endLevel) && tocSettings.endLevel !== 0) {\n            tocFieldCode = tocFieldCode + ' \\\\o \"' + tocSettings.startLevel + '-' + tocSettings.endLevel + '\"';\n        }\n        if (tocSettings.includePageNumber && !tocSettings.rightAlign) {\n            tocFieldCode = tocFieldCode + ' \\\\p \" \"';\n        }\n        if (!tocSettings.includePageNumber) {\n            tocFieldCode = tocFieldCode + ' \\\\n';\n        }\n        if (tocSettings.includeHyperlink) {\n            tocFieldCode = tocFieldCode + ' \\\\h \\\\z';\n        }\n        if (tocSettings.includeOutlineLevels) {\n            tocFieldCode = tocFieldCode + ' \\\\u';\n        }\n        var tSwitch = this.constructTSwitch(tocSettings);\n        if (tSwitch.length > 6) {\n            tocFieldCode = tocFieldCode + tSwitch;\n        }\n        return tocFieldCode;\n    };\n    Editor.prototype.constructTSwitch = function (tocSettings) {\n        var tSwitch = '';\n        var prefix = ' \\\\t ';\n        if (!isNullOrUndefined(tocSettings.levelSettings)) {\n            for (var _i = 0, _a = Object.keys(tocSettings.levelSettings); _i < _a.length; _i++) {\n                var key = _a[_i];\n                tSwitch = tSwitch + key + ',' + tocSettings.levelSettings[key].toString() + ',';\n            }\n        }\n        tSwitch = tSwitch.slice(0, -1);\n        tSwitch = prefix + '\"' + tSwitch + '\"';\n        return tSwitch;\n    };\n    /**\n     * Appends the end filed to the given line.\n     */\n    Editor.prototype.appendEndField = function (fieldBegin, lineWidget) {\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.fieldSeparator = fieldBegin.fieldSeparator;\n        fieldBegin.fieldSeparator.fieldEnd = fieldEnd;\n        fieldEnd.fieldBegin = fieldBegin;\n        fieldEnd.fieldBegin.fieldEnd = fieldEnd;\n        fieldEnd.line = lineWidget;\n        lineWidget.children.push(fieldEnd);\n    };\n    Editor.prototype.validateTocSettings = function (tocSettings) {\n        if (isNullOrUndefined(tocSettings.startLevel) || tocSettings.startLevel < 1) {\n            tocSettings.startLevel = 1;\n        }\n        if (isNullOrUndefined(tocSettings.endLevel) || tocSettings.endLevel < tocSettings.endLevel) {\n            tocSettings.endLevel = tocSettings.startLevel > 3 ? tocSettings.startLevel : 3;\n        }\n        if (isNullOrUndefined(tocSettings.includeHyperlink)) {\n            tocSettings.includeHyperlink = false;\n        }\n        if (isNullOrUndefined(tocSettings.includePageNumber)) {\n            tocSettings.includePageNumber = false;\n        }\n        if (isNullOrUndefined(tocSettings.rightAlign)) {\n            tocSettings.rightAlign = false;\n        }\n        if (isNullOrUndefined(tocSettings.levelSettings)) {\n            tocSettings.levelSettings = {};\n        }\n        return tocSettings;\n    };\n    /**\n     * Builds the TOC\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.buildToc = function (tocSettings, fieldCode, isFirstPara, isStartParagraph) {\n        var tocDomBody = this.viewer.pages[0].bodyWidgets[0];\n        var widgets = [];\n        this.createHeadingLevels(tocSettings);\n        if (tocSettings.includeOutlineLevels) {\n            this.createOutlineLevels(tocSettings);\n        }\n        var widget = tocDomBody.childWidgets[0];\n        while (widget !== undefined) {\n            // tslint:disable-next-line:max-line-length\n            if (widget instanceof ParagraphWidget && (this.isHeadingStyle(widget) || (tocSettings.includeOutlineLevels && this.isOutlineLevelStyle(widget)))) {\n                var bookmarkName = this.insertTocBookmark(widget);\n                // tslint:disable-next-line:max-line-length\n                this.createTOCWidgets(widget, widgets, fieldCode, bookmarkName, tocSettings, isFirstPara, isStartParagraph);\n                isFirstPara = false;\n            }\n            widget = this.selection.getNextParagraphBlock(widget);\n        }\n        this.tocStyles = {};\n        return widgets;\n    };\n    Editor.prototype.createOutlineLevels = function (settings) {\n        for (var i = settings.startLevel; i <= settings.endLevel; i++) {\n            var levelStyle = 'Level' + i.toString();\n            if (isNullOrUndefined(this.tocStyles[levelStyle])) {\n                this.tocStyles[levelStyle] = i;\n            }\n        }\n    };\n    /**\n     * Creates TOC heading styles\n     * @param start - lower heading level\n     * @param end - higher heading level\n     */\n    Editor.prototype.createHeadingLevels = function (settings) {\n        var normalStyle = 'Normal';\n        for (var i = settings.startLevel; i <= settings.endLevel; i++) {\n            var headingStyle = 'Heading ' + i.toString();\n            if (isNullOrUndefined(this.tocStyles[headingStyle])) {\n                this.tocStyles[headingStyle] = i;\n            }\n        }\n        if (!isNullOrUndefined(settings.levelSettings)) {\n            for (var _i = 0, _a = Object.keys(settings.levelSettings); _i < _a.length; _i++) {\n                var key = _a[_i];\n                this.tocStyles[key] = settings.levelSettings[key];\n            }\n        }\n    };\n    /**\n     * Checks the current style is heading style.\n     */\n    Editor.prototype.isHeadingStyle = function (para) {\n        var style = para.paragraphFormat.baseStyle;\n        if (style !== undefined) {\n            return isNullOrUndefined(this.tocStyles[style.name]) ? false : true;\n        }\n        return false;\n    };\n    Editor.prototype.isOutlineLevelStyle = function (para) {\n        var styleName = para.paragraphFormat.outlineLevel;\n        return isNullOrUndefined(this.tocStyles[styleName]) ? false : true;\n    };\n    /**\n     * Creates TOC field element.\n     */\n    Editor.prototype.createTocFieldElement = function (lineWidget, fieldCode) {\n        //begin\n        var fieldBegin = new FieldElementBox(0);\n        fieldBegin.hasFieldEnd = true;\n        fieldBegin.line = lineWidget;\n        lineWidget.children.push(fieldBegin);\n        //format toc\n        var textElement = new TextElementBox();\n        textElement.text = fieldCode;\n        textElement.line = lineWidget;\n        lineWidget.children.push(textElement);\n        //field separator\n        var fieldSeparator = new FieldElementBox(2);\n        fieldSeparator.fieldBegin = fieldBegin;\n        fieldSeparator.fieldBegin.fieldSeparator = fieldSeparator;\n        fieldSeparator.line = lineWidget;\n        lineWidget.children.push(fieldSeparator);\n        return fieldBegin;\n    };\n    /**\n     * Updates TOC para\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.createTOCWidgets = function (widget, widgets, fieldCode, bookmarkName, tocSettings, isFirstPara, isStartParagraph) {\n        var fieldBegin = undefined;\n        var tocPara = undefined;\n        var tocLine = undefined;\n        // tslint:disable-next-line:max-line-length\n        if (widgets.length === 1 && widgets[0].childWidgets[0].children.length === 3 && !isNullOrUndefined(isFirstPara) && !isFirstPara) {\n            tocLine = widgets[0].childWidgets[0];\n        }\n        else {\n            tocPara = new ParagraphWidget();\n            var styleName = undefined;\n            //Adds toc syles into paragraph\n            var headingStyleName = widget.paragraphFormat.baseStyle.name;\n            if (tocSettings.includeOutlineLevels && isNullOrUndefined(this.tocStyles[headingStyleName])) {\n                styleName = widget.paragraphFormat.outlineLevel;\n            }\n            else {\n                styleName = headingStyleName;\n            }\n            var tocStyleName = 'Toc' + this.tocStyles[styleName];\n            var paraStyle = this.viewer.styles.findByName(tocStyleName, 'Paragraph');\n            if (isNullOrUndefined(paraStyle)) {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()), JSON.parse(this.viewer.preDefinedStyles.get(tocStyleName)), this.viewer.styles);\n                paraStyle = this.viewer.styles.findByName(tocStyleName, 'Paragraph');\n            }\n            tocPara.paragraphFormat.ApplyStyle(paraStyle);\n            //Creates right tab for page number.\n            if (tocSettings.rightAlign && tocSettings.includePageNumber) {\n                var tabStop = new WTabStop();\n                tabStop.position = HelperMethods.convertPixelToPoint(this.viewer.clientArea.width);\n                tabStop.tabLeader = tocSettings.tabLeader;\n                tabStop.deletePosition = 0;\n                tabStop.tabJustification = 'Right';\n                tocPara.paragraphFormat.tabs.push(tabStop);\n            }\n            tocLine = new LineWidget(tocPara);\n            tocPara.childWidgets.push(tocLine);\n        }\n        //creates toc field element if it is insert\n        if ((isFirstPara !== undefined) && isFirstPara) {\n            if (!isNullOrUndefined(isStartParagraph) && !isStartParagraph) {\n                this.appendEmptyPara(widgets);\n            }\n            this.createTocFieldElement(tocLine, fieldCode);\n        }\n        var text = '';\n        for (var lineIndex = 0; lineIndex < widget.childWidgets.length; lineIndex++) {\n            var lineWidget = widget.childWidgets[lineIndex];\n            for (var elementIndex = 0; elementIndex < lineWidget.children.length; elementIndex++) {\n                var element = lineWidget.children[elementIndex];\n                if (element instanceof TextElementBox || element instanceof ListTextElementBox) {\n                    var temp = element.text;\n                    var tabChar = '\\t';\n                    if (temp.indexOf(tabChar) !== -1) {\n                        temp = temp.replace(new RegExp(tabChar, 'g'), ' ');\n                    }\n                    text = text + temp;\n                }\n            }\n        }\n        if (text !== '') {\n            // inserts hyperlink\n            if (tocSettings.includeHyperlink && (bookmarkName !== undefined)) {\n                fieldBegin = this.insertTocHyperlink(tocLine, bookmarkName, text);\n            }\n            else {\n                var span = new TextElementBox();\n                span.text = text;\n                span.line = tocLine;\n                tocLine.children.push(span);\n            }\n            //inserts page number\n            if (tocSettings.includePageNumber && (bookmarkName !== undefined)) {\n                if (tocSettings.rightAlign) {\n                    var tabText = new TabElementBox();\n                    tabText.text = '\\t';\n                    tabText.line = tocLine;\n                    tocLine.children.push(tabText);\n                }\n                var pageField = this.insertTocPageNumber(bookmarkName, tocLine, tocSettings.rightAlign, widget);\n                this.appendEndField(pageField, tocLine);\n            }\n            if (tocSettings.includeHyperlink && fieldBegin !== undefined) {\n                this.appendEndField(fieldBegin, tocLine);\n            }\n        }\n        if (!isNullOrUndefined(tocPara) && (text !== '' || isFirstPara)) {\n            widgets.push(tocPara);\n        }\n    };\n    /**\n     * Inserts toc hyperlink.\n     */\n    Editor.prototype.insertTocHyperlink = function (lineWidget, bookmarkName, text) {\n        var fieldCode = ' HYPERLINK \\\\l \\\"' + bookmarkName + '\\\" ';\n        var fieldBegin = this.createTocFieldElement(lineWidget, fieldCode);\n        //text element.\n        var span = new TextElementBox();\n        span.text = text;\n        span.line = lineWidget;\n        lineWidget.children.push(span);\n        return fieldBegin;\n    };\n    /**\n     * Inserts toc page number.\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.insertTocPageNumber = function (bookMarkname, lineWidget, isRightAlign, widget) {\n        var fieldCode = ' PAGEREF' + bookMarkname + ' \\\\h ';\n        var fieldBegin = this.createTocFieldElement(lineWidget, fieldCode);\n        var text = (this.viewer.pages.indexOf(widget.bodyWidget.page) + 1).toString();\n        //text element.\n        var span = new FieldTextElementBox();\n        span.fieldBegin = fieldBegin;\n        if (!isRightAlign) {\n            text = ' ' + text;\n        }\n        span.text = text;\n        span.line = lineWidget;\n        lineWidget.children.push(span);\n        this.pageRefFields[bookMarkname] = span;\n        return fieldBegin;\n    };\n    Editor.prototype.updatePageRef = function () {\n        for (var _i = 0, _a = Object.keys(this.pageRefFields); _i < _a.length; _i++) {\n            var key = _a[_i];\n            var bookmark = this.viewer.bookmarks.get(key);\n            var pageRef = (bookmark.paragraph.bodyWidget.page.index + 1).toString();\n            var span = this.pageRefFields[key];\n            if (pageRef !== span.text) {\n                span.text = pageRef;\n                var paragraph = span.paragraph;\n                var lineIndex = paragraph.childWidgets.indexOf(span.line);\n                var elementIndex = span.line.children.indexOf(span);\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n            }\n        }\n    };\n    /**\n     * Inserts toc bookmark.\n     */\n    Editor.prototype.insertTocBookmark = function (widget) {\n        var bookmarkName = undefined;\n        var lineLength = widget.childWidgets.length;\n        if (lineLength > 0) {\n            var startLine = widget.childWidgets[0];\n            var endLine = widget.childWidgets[lineLength - 1];\n            if ((startLine !== undefined) && (endLine !== undefined)) {\n                var startElement = startLine.children[0];\n                //Returns the bookmark if already present for paragraph.\n                // tslint:disable-next-line:max-line-length\n                if (!isNullOrUndefined(startElement) && startElement instanceof BookmarkElementBox && startElement.bookmarkType === 0 && (startElement.name.toLowerCase().match('^_toc'))) {\n                    return startElement.name;\n                }\n                var endElement = endLine.children[endLine.children.length - 1];\n                if ((startElement !== undefined) && (endElement !== undefined)) {\n                    this.selection.start.setPositionForSelection(startLine, startElement, 0, this.selection.start.location);\n                    this.selection.end.setPositionForSelection(endLine, endElement, endElement.length, this.selection.end.location);\n                    bookmarkName = this.generateBookmarkName();\n                    this.insertBookmark(bookmarkName);\n                }\n            }\n        }\n        return bookmarkName;\n    };\n    /**\n     * Generates bookmark id.\n     */\n    Editor.prototype.generateBookmarkName = function () {\n        this.tocBookmarkId++;\n        var count = 10 - this.tocBookmarkId.toString().length;\n        var formatString = '';\n        while (count - 1 > 0) {\n            formatString = '0' + formatString;\n            count--;\n        }\n        var bookmarkName = '_Toc' + formatString + this.tocBookmarkId;\n        return bookmarkName;\n    };\n    /**\n     * Change cell content alignment\n     * @private\n     */\n    Editor.prototype.onCellContentAlignment = function (verticalAlignment, textAlignment) {\n        this.owner.isShiftingEnabled = true;\n        var selection = this.owner.selection;\n        if (selection.isEmpty && selection.start.paragraph.isInsideTable) {\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.initComplexHistory(selection, 'MultiSelection');\n            }\n            //Selecting the table cell to update the all the paragraph format.\n            selection.selectTableCell();\n            this.initHistory('CellContentVerticalAlignment');\n            var cellFormat = selection.start.paragraph.associatedCell.cellFormat;\n            this.applyCellPropertyValue(selection, 'verticalAlignment', verticalAlignment, cellFormat);\n            this.reLayout(selection, false);\n            this.initHistory('TextAlignment');\n            this.updateParagraphFormat('textAlignment', textAlignment, false);\n            this.reLayout(this.owner.selection, false);\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.updateComplexHistory();\n            }\n        }\n        else {\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.initComplexHistory(selection, 'MultiSelection');\n            }\n            if (!isNullOrUndefined(selection.getTable(selection.start, selection.end))) {\n                //Table cell vertical alignment.\n                this.updateSelectionTableFormat(selection, 'CellContentVerticalAlignment', verticalAlignment);\n                this.reLayout(this.owner.selection, false);\n                this.initHistory('TextAlignment');\n                //Paragraph text alignment.\n                this.updateSelectionParagraphFormatting('textAlignment', textAlignment, false);\n                this.reLayout(selection, false);\n            }\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.updateComplexHistory();\n            }\n        }\n    };\n    return Editor;\n}());\nexport { Editor };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { PageLayoutViewer } from '../index';\nimport { Dictionary } from '../../base/dictionary';\nimport { ImageFormat } from '../selection/selection-helper';\nimport { Point, HelperMethods } from './editor-helper';\nimport { BaseHistoryInfo } from '../editor-history/base-history-info';\n/**\n * Image resizer implementation.\n */\nvar ImageResizer = /** @class */ (function () {\n    /**\n     * Constructor for image resizer module.\n     * @param {DocumentEditor} node\n     * @param {LayoutViewer} viewer\n     * @private\n     */\n    function ImageResizer(node, viewer) {\n        /**\n         * @private\n         */\n        this.resizeContainerDiv = undefined;\n        /**\n         * @private\n         */\n        this.topLeftRect = undefined;\n        /**\n         * @private\n         */\n        this.topMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.topRightRect = undefined;\n        /**\n         * @private\n         */\n        this.bottomLeftRect = undefined;\n        /**\n         * @private\n         */\n        this.bottomMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.bottomRightRect = undefined;\n        /**\n         * @private\n         */\n        this.leftMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.rightMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.topLeftRectParent = undefined;\n        /**\n         * @private\n         */\n        this.topMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.topRightRectParent = undefined;\n        /**\n         * @private\n         */\n        this.bottomLeftRectParent = undefined;\n        /**\n         * @private\n         */\n        this.bottomMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.bottomRightRectParent = undefined;\n        /**\n         * @private\n         */\n        this.leftMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.rightMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.resizeMarkSizeIn = 7;\n        /**\n         * @private\n         */\n        this.selectedImageWidget = undefined;\n        /**\n         * @private\n         */\n        this.baseHistoryInfo = undefined;\n        /**\n         * @private\n         */\n        this.isImageResizing = false;\n        /**\n         * @private\n         */\n        this.isImageResizerVisible = false;\n        /**\n         * @private\n         */\n        this.isImageMoveToNextPage = false;\n        /**\n         * @private\n         */\n        this.selectedResizeElement = undefined;\n        /**\n         * @private\n         */\n        this.topValue = undefined;\n        /**\n         * @private\n         */\n        this.leftValue = undefined;\n        this.owner = node;\n        this.selectedImageWidget = new Dictionary();\n        this.viewer = viewer;\n        this.imageResizerPoints = new ImageResizingPoints();\n        if (isNullOrUndefined(this.imageResizerDiv) && this.viewer && this.viewer.pageContainer) {\n            this.initializeImageResizer();\n        }\n    }\n    Object.defineProperty(ImageResizer.prototype, \"currentImageElementBox\", {\n        /**\n         * Gets or Sets the current image element box.\n         * @private\n         */\n        get: function () {\n            return this.currentImageElementBoxIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.currentImageElementBoxIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageResizer.prototype, \"resizeMarkSize\", {\n        /**\n         * Gets or Sets the resize mark size.\n         * @private\n         */\n        get: function () {\n            return this.resizeMarkSizeIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.resizeMarkSizeIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Gets module name.\n     */\n    ImageResizer.prototype.getModuleName = function () {\n        return 'ImageResizer';\n    };\n    //Image Resizing Methods\n    /**\n     * Sets image resizer position.\n     * @param {number} x - Specifies for image resizer left value.\n     * @param {number} y - Specifies for image resizer top value.\n     * @param {number} width - Specifies for image resizer width value.\n     * @param {number} height - Specifies for image resizer height value.\n     * @private\n     */\n    ImageResizer.prototype.setImageResizerPositions = function (x, y, width, height) {\n        this.imageResizerDivElement.style.top = y.toString() + 'px';\n        this.imageResizerDivElement.style.left = x.toString() + 'px';\n        this.imageResizerDivElement.style.borderWidth = '0px';\n        this.imageResizerDivElement.style.height = height + 'px';\n        this.imageResizerDivElement.style.width = width + 'px';\n        this.imageResizerDivElement.style.backgroundColor = 'transparent';\n        this.imageResizerDivElement.style.overflow = 'hidden';\n        this.imageResizerDivElement.style.position = 'absolute';\n    };\n    /**\n     * Creates image resizer DOM element.\n     * @private\n     */\n    ImageResizer.prototype.initializeImageResizer = function () {\n        this.imageResizerDivElement = document.createElement('div');\n        this.imageResizerDivElement.style.zIndex = '1';\n        this.imageResizerDivElement.style.display = 'none';\n        this.viewer.pageContainer.appendChild(this.imageResizerDivElement);\n    };\n    /**\n     * Position an image resizer\n     * @param {ImageElementBox} elementBox - Specifies the image position.\n     * @private\n     */\n    ImageResizer.prototype.positionImageResizer = function (elementBox) {\n        this.selectedImageWidget.clear();\n        // Initializes the image resizer on demand, i.e at the time of selecting an image for the first time.\n        var resizeDiv;\n        if (!isNullOrUndefined(this.viewer.currentPage)) {\n            resizeDiv = this.imageResizerDivElement;\n        }\n        if (!isNullOrUndefined(resizeDiv) && !resizeDiv.contains(this.imageResizerDiv)) {\n            this.imageResizerDiv = this.initResizeMarks(resizeDiv, this);\n        }\n        this.imageResizerDiv.style.width = (elementBox.width) + 'px';\n        this.imageResizerDiv.style.height = (elementBox.height) + 'px';\n        this.currentImageElementBox = elementBox;\n        var lineWidget = elementBox.line;\n        var top = this.viewer.selection.getTop(lineWidget) + elementBox.margin.top;\n        var left = this.viewer.selection.getLeftInternal(lineWidget, elementBox, 0);\n        var page = this.viewer.selection.getPage(lineWidget.paragraph);\n        this.currentPage = page;\n        var x = 0;\n        var y = 0;\n        if (!isNullOrUndefined(resizeDiv)) {\n            this.imageResizerDivElement.style.display = 'block';\n            resizeDiv.style.width = page.boundingRectangle.width + 'px';\n            resizeDiv.style.height = page.boundingRectangle.height + 'px';\n            resizeDiv.style.left = page.boundingRectangle.x + 'px';\n            resizeDiv.style.top = page.boundingRectangle.y + 'px';\n            resizeDiv.style.borderWidth = '0px';\n            resizeDiv.style.backgroundColor = 'transparent';\n            resizeDiv.style.overflow = 'hidden';\n            resizeDiv.style.position = 'absolute';\n        }\n        var horizontalWidth = 0;\n        var pageWidth = this.viewer.getPageWidth(page);\n        var pagelayout = this.viewer;\n        // tslint:disable-next-line:max-line-length\n        horizontalWidth = parseFloat(this.imageResizerDivElement.style.width);\n        x = (this.viewer.visibleBounds.width - horizontalWidth * this.viewer.zoomFactor) / 2;\n        if (x < 30) {\n            x = 30;\n        }\n        if (pageWidth < horizontalWidth) {\n            x += (horizontalWidth - pageWidth) * this.viewer.zoomFactor / 2;\n        }\n        // tslint:disable-next-line:max-line-length           \n        y = page.boundingRectangle.y * this.viewer.zoomFactor + (this.viewer.pages.indexOf(page) + 1) * 20 * (1 - this.viewer.zoomFactor);\n        var currentPageDiv = this.imageResizerDivElement;\n        var currentPageDivWidth = parseFloat(currentPageDiv.style.width);\n        var currentPageDivHeight = parseFloat(currentPageDiv.style.height);\n        var imageResizerDivWidth = parseFloat(this.imageResizerDiv.style.width);\n        var imageResizerDivHeight = parseFloat(this.imageResizerDiv.style.height);\n        var margin = (this.resizeMarkSize - 1) / 2;\n        var width = imageResizerDivWidth + 2 * margin;\n        var height = imageResizerDivHeight + 2 * margin;\n        if (width > (currentPageDivWidth - left) * this.viewer.zoomFactor + margin) {\n            width = (currentPageDivWidth - left) * this.viewer.zoomFactor;\n        }\n        if (height > (currentPageDivHeight - top) * this.viewer.zoomFactor + margin) {\n            height = (currentPageDivHeight - top) * this.viewer.zoomFactor;\n        }\n        // if (width < imageResizerDivHeight + margin || height < imageResizerDivHeight + margin) {\n        // }\n        // tslint:disable-next-line:max-line-length\n        this.imageResizerDivElement.style.width = parseInt(this.imageResizerDivElement.style.width.replace('px', ''), 10) * this.viewer.zoomFactor + 'px';\n        this.imageResizerDivElement.style.height = parseInt(this.imageResizerDivElement.style.height.replace('px', ''), 10) * this.viewer.zoomFactor + 'px';\n        height = this.viewer.render.getScaledValue(elementBox.height);\n        width = this.viewer.render.getScaledValue(elementBox.width);\n        left = this.viewer.render.getScaledValue(left);\n        top = this.viewer.render.getScaledValue(top);\n        this.setImageResizerPosition(left, top, width, height, this);\n        if (!this.selectedImageWidget.containsKey(lineWidget)) {\n            var selectedImageInfo = new SelectedImageInfo(elementBox.height, elementBox.width);\n            this.selectedImageWidget.add(lineWidget, selectedImageInfo);\n        }\n    };\n    /**\n     * Shows the image resizer.\n     * @private\n     */\n    ImageResizer.prototype.showImageResizer = function () {\n        if (!isNullOrUndefined(this.imageResizerDivElement)) {\n            this.imageResizerDivElement.style.display = '';\n        }\n        if (!isNullOrUndefined(this.resizeContainerDiv)) {\n            this.resizeContainerDiv.style.display = '';\n        }\n        if (!isNullOrUndefined(this.bottomLeftRect)) {\n            this.bottomLeftRect.style.display = '';\n            this.bottomLeftRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.bottomRightRect)) {\n            this.bottomRightRect.style.display = '';\n            this.bottomRightRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.bottomMiddleRect)) {\n            this.bottomMiddleRect.style.display = '';\n            this.bottomMiddleRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.rightMiddleRect)) {\n            this.rightMiddleRect.style.display = '';\n            this.rightMiddleRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.topRightRect)) {\n            this.topRightRect.style.display = '';\n            this.topRightRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.topLeftRect)) {\n            this.topLeftRect.style.display = '';\n            this.topLeftRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.leftMiddleRect)) {\n            this.leftMiddleRect.style.display = '';\n            this.leftMiddleRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.topMiddleRect)) {\n            this.topMiddleRect.style.display = '';\n            this.topMiddleRectParent.style.display = '';\n        }\n        this.isImageResizerVisible = true;\n    };\n    /**\n     * Hides the image resizer.\n     * @private\n     */\n    ImageResizer.prototype.hideImageResizer = function () {\n        if (!isNullOrUndefined(this.imageResizerDivElement)) {\n            this.imageResizerDivElement.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.resizeContainerDiv)) {\n            this.resizeContainerDiv.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.bottomLeftRect)) {\n            this.bottomLeftRect.style.display = 'none';\n            this.bottomLeftRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.bottomRightRect)) {\n            this.bottomRightRect.style.display = 'none';\n            this.bottomRightRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.bottomMiddleRect)) {\n            this.bottomMiddleRect.style.display = 'none';\n            this.bottomMiddleRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.rightMiddleRect)) {\n            this.rightMiddleRect.style.display = 'none';\n            this.rightMiddleRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.topRightRect)) {\n            this.topRightRect.style.display = 'none';\n            this.topRightRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.topLeftRect)) {\n            this.topLeftRect.style.display = 'none';\n            this.topLeftRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.leftMiddleRect)) {\n            this.leftMiddleRect.style.display = 'none';\n            this.leftMiddleRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.topMiddleRect)) {\n            this.topMiddleRect.style.display = 'none';\n            this.topMiddleRectParent.style.display = 'none';\n        }\n        this.isImageResizerVisible = false;\n        this.currentPage = undefined;\n    };\n    /**\n     * Initialize the resize marks.\n     * @param {HTMLElement} resizeDiv - Specifies to appending resizer container div element.\n     * @param {ImageResizer} imageResizer - Specifies to creating div element of each position.\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    ImageResizer.prototype.initResizeMarks = function (resizeDiv, imageResizer) {\n        this.initResizeContainerDiv(imageResizer);\n        resizeDiv.appendChild(imageResizer.resizeContainerDiv);\n        imageResizer.topRightRectParent = document.createElement('div');\n        imageResizer.topRightRectParent.style.cursor = 'ne-resize';\n        imageResizer.topRightRectParent.id = this.viewer.owner.containerId + '_TopRightRectParent';\n        this.applyProperties(imageResizer.topRightRectParent);\n        imageResizer.topRightRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topRightRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topRightRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.topRightRectParent);\n        imageResizer.topRightRect = document.createElement('div');\n        imageResizer.topRightRect.id = this.viewer.owner.containerId + '_TopRightRect';\n        imageResizer.topRightRect.style.cursor = 'ne-resize';\n        this.applyProperties(imageResizer.topRightRect);\n        resizeDiv.appendChild(imageResizer.topRightRect);\n        imageResizer.topLeftRectParent = document.createElement('div');\n        imageResizer.topLeftRectParent.style.cursor = 'nw-resize';\n        imageResizer.topLeftRectParent.id = this.viewer.owner.containerId + '_TopLeftRectParent';\n        this.applyProperties(imageResizer.topLeftRectParent);\n        imageResizer.topLeftRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topLeftRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topLeftRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.topLeftRectParent);\n        imageResizer.topLeftRect = document.createElement('div');\n        imageResizer.topLeftRect.id = this.viewer.owner.containerId + '_TopLeftRect';\n        imageResizer.topLeftRect.style.cursor = 'nw-resize';\n        this.applyProperties(imageResizer.topLeftRect);\n        resizeDiv.appendChild(imageResizer.topLeftRect);\n        imageResizer.topMiddleRectParent = document.createElement('div');\n        imageResizer.topMiddleRectParent.style.cursor = 'n-resize';\n        imageResizer.topMiddleRectParent.id = this.viewer.owner.containerId + '_TopMiddleRectParent';\n        this.applyProperties(imageResizer.topMiddleRectParent);\n        imageResizer.topMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.topMiddleRectParent);\n        imageResizer.topMiddleRect = document.createElement('div');\n        imageResizer.topMiddleRect.id = this.viewer.owner.containerId + '_TopMiddleRect';\n        imageResizer.topMiddleRect.style.cursor = 'n-resize';\n        this.applyProperties(imageResizer.topMiddleRect);\n        resizeDiv.appendChild(imageResizer.topMiddleRect);\n        imageResizer.bottomRightRectParent = document.createElement('div');\n        imageResizer.bottomRightRectParent.style.cursor = 'se-resize';\n        imageResizer.bottomRightRectParent.id = this.viewer.owner.containerId + '_BottomRightRectParent';\n        this.applyProperties(imageResizer.bottomRightRectParent);\n        imageResizer.bottomRightRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomRightRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomRightRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.bottomRightRectParent);\n        imageResizer.bottomRightRect = document.createElement('div');\n        imageResizer.bottomRightRect.id = this.viewer.owner.containerId + '_BottomRightRect';\n        imageResizer.bottomRightRect.style.cursor = 'se-resize';\n        this.applyProperties(imageResizer.bottomRightRect);\n        resizeDiv.appendChild(imageResizer.bottomRightRect);\n        imageResizer.bottomLeftRectParent = document.createElement('div');\n        imageResizer.bottomLeftRectParent.style.cursor = 'sw-resize';\n        imageResizer.bottomLeftRectParent.id = this.viewer.owner.containerId + '_BottomLeftRectParent';\n        this.applyProperties(imageResizer.bottomLeftRectParent);\n        imageResizer.bottomLeftRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomLeftRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomLeftRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.bottomLeftRectParent);\n        imageResizer.bottomLeftRect = document.createElement('div');\n        imageResizer.bottomLeftRect.id = this.viewer.owner.containerId + '_BottomLeftRect';\n        imageResizer.bottomLeftRect.style.cursor = 'sw-resize';\n        this.applyProperties(imageResizer.bottomLeftRect);\n        resizeDiv.appendChild(imageResizer.bottomLeftRect);\n        imageResizer.bottomMiddleRectParent = document.createElement('div');\n        imageResizer.bottomMiddleRectParent.style.cursor = 's-resize';\n        imageResizer.bottomMiddleRectParent.id = this.viewer.owner.containerId + '_BottomMiddleRectParent';\n        this.applyProperties(imageResizer.bottomMiddleRectParent);\n        imageResizer.bottomMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.bottomMiddleRectParent);\n        imageResizer.bottomMiddleRect = document.createElement('div');\n        imageResizer.bottomMiddleRect.id = this.viewer.owner.containerId + '_BottomMiddleRect';\n        imageResizer.bottomMiddleRect.style.cursor = 's-resize';\n        this.applyProperties(imageResizer.bottomMiddleRect);\n        resizeDiv.appendChild(imageResizer.bottomMiddleRect);\n        imageResizer.rightMiddleRectParent = document.createElement('div');\n        imageResizer.rightMiddleRectParent.style.cursor = 'e-resize';\n        imageResizer.rightMiddleRectParent.id = this.viewer.owner.containerId + '_RightMiddleRectParent';\n        this.applyProperties(imageResizer.rightMiddleRectParent);\n        imageResizer.rightMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.rightMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.rightMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.rightMiddleRectParent);\n        imageResizer.rightMiddleRect = document.createElement('div');\n        imageResizer.rightMiddleRect.id = this.viewer.owner.containerId + '_RightMiddleRect';\n        imageResizer.rightMiddleRect.style.cursor = 'e-resize';\n        this.applyProperties(imageResizer.rightMiddleRect);\n        resizeDiv.appendChild(imageResizer.rightMiddleRect);\n        imageResizer.leftMiddleRectParent = document.createElement('div');\n        imageResizer.leftMiddleRectParent.style.cursor = 'w-resize';\n        imageResizer.leftMiddleRectParent.id = this.viewer.owner.containerId + '_LeftMiddleRectParent';\n        this.applyProperties(imageResizer.leftMiddleRectParent);\n        imageResizer.leftMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.leftMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.leftMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.leftMiddleRectParent);\n        imageResizer.leftMiddleRect = document.createElement('div');\n        imageResizer.leftMiddleRect.id = this.viewer.owner.containerId + '_LeftMiddleRect';\n        imageResizer.leftMiddleRect.style.cursor = 'w-resize';\n        this.applyProperties(imageResizer.leftMiddleRect);\n        resizeDiv.appendChild(imageResizer.leftMiddleRect);\n        return imageResizer.resizeContainerDiv;\n    };\n    /**\n     * Sets the image resizer position.\n     * @param {number} left - Specifies for image resizer left value.\n     * @param {number} top - Specifies for image resizer top value.\n     * @param {number} width - Specifies for image resizer width value.\n     * @param {number} height - Specifies for image resizer height value.\n     * @param {ImageResizer} imageResizer - Specifies for image resizer.\n     * @private\n     */\n    ImageResizer.prototype.setImageResizerPosition = function (left, top, width, height, imageResizer) {\n        //Positions Updating For Image Resize Div\n        imageResizer.resizeContainerDiv.style.width = width + 'px';\n        imageResizer.resizeContainerDiv.style.height = height + 'px';\n        imageResizer.resizeContainerDiv.style.left = left - 1 + 'px';\n        imageResizer.resizeContainerDiv.style.top = top + 'px';\n        //Positions Updating For Image Resizing Points\n        imageResizer.topRightRect.style.left = ((left + width) - 5) + 'px';\n        imageResizer.topRightRect.style.top = (top - 4) + 'px';\n        imageResizer.topLeftRect.style.left = (left - 5) + 'px';\n        imageResizer.topLeftRect.style.top = (top - 4) + 'px';\n        imageResizer.topMiddleRect.style.left = ((parseFloat(imageResizer.topLeftRect.style.left) + (width / 2)) - 4) + 'px';\n        imageResizer.topMiddleRect.style.top = (top - 4) + 'px';\n        imageResizer.bottomRightRect.style.left = imageResizer.topRightRect.style.left;\n        imageResizer.bottomRightRect.style.top = (parseFloat(imageResizer.topRightRect.style.top) + height) + 'px';\n        imageResizer.bottomLeftRect.style.left = imageResizer.topLeftRect.style.left;\n        imageResizer.bottomLeftRect.style.top = (parseFloat(imageResizer.topLeftRect.style.top) + height) + 'px';\n        imageResizer.bottomMiddleRect.style.left = imageResizer.topMiddleRect.style.left;\n        imageResizer.bottomMiddleRect.style.top = (parseFloat(imageResizer.topMiddleRect.style.top) + height) + 'px';\n        imageResizer.rightMiddleRect.style.left = ((left + width) - 4) + 'px';\n        imageResizer.rightMiddleRect.style.top = (parseFloat(imageResizer.topRightRect.style.top) + (height / 2)) + 'px';\n        imageResizer.leftMiddleRect.style.left = imageResizer.topLeftRect.style.left;\n        imageResizer.leftMiddleRect.style.top = (parseFloat(imageResizer.topLeftRect.style.top) + (height / 2)) + 'px';\n        imageResizer.topRightRectParent.style.left = !this.viewer.isTouchInput ? ((left + width) - 8) + 'px' : ((left + width) - 15) + 'px';\n        imageResizer.topRightRectParent.style.top = !this.viewer.isTouchInput ? (top - 7) + 'px' : (top - 15) + 'px';\n        imageResizer.topLeftRectParent.style.left = !this.viewer.isTouchInput ? (left - 8) + 'px' : (left - 15) + 'px';\n        imageResizer.topLeftRectParent.style.top = !this.viewer.isTouchInput ? (top - 7) + 'px' : (top - 15) + 'px';\n        imageResizer.topMiddleRectParent.style.left = ((parseFloat(imageResizer.topLeftRectParent.style.left) + (width / 2)) - 4) + 'px';\n        imageResizer.topMiddleRectParent.style.top = !this.viewer.isTouchInput ? (top - 7) + 'px' : (top - 15) + 'px';\n        imageResizer.bottomRightRectParent.style.left = imageResizer.topRightRectParent.style.left;\n        imageResizer.bottomRightRectParent.style.top = (parseFloat(imageResizer.topRightRectParent.style.top) + height) + 'px';\n        imageResizer.bottomLeftRectParent.style.left = imageResizer.topLeftRectParent.style.left;\n        imageResizer.bottomLeftRectParent.style.top = (parseFloat(imageResizer.topLeftRectParent.style.top) + height) + 'px';\n        imageResizer.bottomMiddleRectParent.style.left = imageResizer.topMiddleRectParent.style.left;\n        imageResizer.bottomMiddleRectParent.style.top = (parseFloat(imageResizer.topMiddleRectParent.style.top) + height) + 'px';\n        // tslint:disable-next-line:max-line-length \n        imageResizer.rightMiddleRectParent.style.left = !this.viewer.isTouchInput ? ((left + width) - 7) + 'px' : ((left + width) - 15) + 'px';\n        imageResizer.rightMiddleRectParent.style.top = (parseFloat(imageResizer.topRightRectParent.style.top) + (height / 2)) + 'px';\n        imageResizer.leftMiddleRectParent.style.left = imageResizer.topLeftRectParent.style.left;\n        imageResizer.leftMiddleRectParent.style.top = (parseFloat(imageResizer.topLeftRectParent.style.top) + (height / 2)) + 'px';\n        this.setImageResizingPoints(imageResizer);\n        if (this.viewer.isTouchInput) {\n            this.applyPropertiesForTouch();\n        }\n        else {\n            this.applyPropertiesForMouse();\n        }\n    };\n    /**\n     * Sets the image resizing points.\n     * @param {ImageResizer} imageResizer - Specifies for position of each resizing elements.\n     * @private\n     */\n    ImageResizer.prototype.setImageResizingPoints = function (imageResizer) {\n        this.imageResizerPoints.resizeContainerDiv.x = parseFloat(imageResizer.resizeContainerDiv.style.left);\n        this.imageResizerPoints.resizeContainerDiv.y = parseFloat(imageResizer.resizeContainerDiv.style.top);\n        this.imageResizerPoints.bottomLeftRectParent.x = parseFloat(imageResizer.bottomLeftRectParent.style.left);\n        this.imageResizerPoints.bottomLeftRectParent.y = parseFloat(imageResizer.bottomLeftRectParent.style.top);\n        this.imageResizerPoints.bottomRightRectParent.x = parseFloat(imageResizer.bottomRightRectParent.style.left);\n        this.imageResizerPoints.bottomRightRectParent.y = parseFloat(imageResizer.bottomRightRectParent.style.top);\n        this.imageResizerPoints.bottomMiddleRectParent.x = parseFloat(imageResizer.bottomMiddleRectParent.style.left);\n        this.imageResizerPoints.bottomMiddleRectParent.y = parseFloat(imageResizer.bottomMiddleRectParent.style.top);\n        this.imageResizerPoints.topLeftRectParent.x = parseFloat(imageResizer.topLeftRectParent.style.left);\n        this.imageResizerPoints.topLeftRectParent.y = parseFloat(imageResizer.topLeftRectParent.style.top);\n        this.imageResizerPoints.topRightRectParent.x = parseFloat(imageResizer.topRightRectParent.style.left);\n        this.imageResizerPoints.topRightRectParent.y = parseFloat(imageResizer.topRightRectParent.style.top);\n        this.imageResizerPoints.topMiddleRectParent.x = parseFloat(imageResizer.topMiddleRectParent.style.left);\n        this.imageResizerPoints.topMiddleRectParent.y = parseFloat(imageResizer.topMiddleRectParent.style.top);\n        this.imageResizerPoints.leftMiddleRectParent.x = parseFloat(imageResizer.leftMiddleRectParent.style.left);\n        this.imageResizerPoints.leftMiddleRectParent.y = parseFloat(imageResizer.leftMiddleRectParent.style.top);\n        this.imageResizerPoints.rightMiddleRectParent.x = parseFloat(imageResizer.rightMiddleRectParent.style.left);\n        this.imageResizerPoints.rightMiddleRectParent.y = parseFloat(imageResizer.rightMiddleRectParent.style.top);\n    };\n    /**\n     * Initialize the resize container div element.\n     * @param {ImageResizer} imageResizer - Specifies for creating resize container div element.\n     * @private\n     */\n    ImageResizer.prototype.initResizeContainerDiv = function (imageResizer) {\n        imageResizer.resizeContainerDiv = document.createElement('div');\n        imageResizer.resizeContainerDiv.id = this.viewer.owner.containerId + '_ResizeDivElement';\n        imageResizer.resizeContainerDiv.style.position = 'absolute';\n        imageResizer.resizeContainerDiv.style.border = '1px solid #bfbfbf';\n        imageResizer.resizeContainerDiv.style.zIndex = '30';\n        imageResizer.resizeContainerDiv.style.backgroundColor = 'transparent';\n        imageResizer.resizeContainerDiv.style.display = 'block';\n    };\n    /**\n     * Apply the properties of each resize rectangle element.\n     * @param {HTMLDivElement} resizeRectElement - Specifies for applying properties to resize rectangle element.\n     * @private\n     */\n    ImageResizer.prototype.applyProperties = function (resizeRectElement) {\n        resizeRectElement.style.position = 'absolute';\n        resizeRectElement.style.width = '8px';\n        resizeRectElement.style.height = '8px';\n        resizeRectElement.style.fontSize = '0px';\n        resizeRectElement.style.zIndex = ' 551';\n        resizeRectElement.style.backgroundColor = '#ffffff';\n        resizeRectElement.style.border = '1px solid #bfbfbf';\n        resizeRectElement.style.boxShadow = '0 1px 2px 0 #bfbfbf 0.35';\n        resizeRectElement.style.color = '#000000';\n    };\n    /**\n     * Handles an image resizing.\n     * @param {number} x  - Specifies for left value while resizing.\n     * @param {number} y - Specifies for top value while resizing.\n     */\n    ImageResizer.prototype.handleImageResizing = function (touchPoint, prevX, prevY) {\n        prevX = prevX / this.viewer.zoomFactor;\n        prevY = prevY / this.viewer.zoomFactor;\n        this.leftValue = isNullOrUndefined(this.leftValue) ? prevX : this.leftValue;\n        this.topValue = isNullOrUndefined(this.topValue) ? prevY : this.topValue;\n        var points;\n        var id = this.selectedResizeElement.id.split('_');\n        var currentElementId = id[id.length - 1];\n        switch (currentElementId) {\n            case 'TopRightRectParent':\n                points = this.topRightResizing(touchPoint);\n                prevX = points.left;\n                prevY = points.top;\n                break;\n            case 'TopLeftRectParent':\n                points = this.topLeftResizing(touchPoint);\n                prevX = -points.left;\n                prevY = -points.top;\n                break;\n            case 'TopMiddleRectParent':\n                prevX = 0;\n                prevY = this.topMiddleResizing(touchPoint);\n                break;\n            case 'BottomRightRectParent':\n                points = this.bottomRightResizing(touchPoint);\n                prevX = points.left;\n                prevY = points.top;\n                break;\n            case 'BottomLeftRectParent':\n                points = this.bottomLeftResizing(touchPoint);\n                prevX = -points.left;\n                prevY = -points.top;\n                break;\n            case 'BottomMiddleRectParent':\n                prevY = touchPoint.y - prevY;\n                prevX = 0;\n                break;\n            case 'RightMiddleRectParent':\n                prevX = touchPoint.x - prevX;\n                prevY = 0;\n                break;\n            case 'LeftMiddleRectParent':\n                prevX = this.leftMiddleResizing(touchPoint);\n                prevY = 0;\n                break;\n            default:\n                break;\n        }\n        if (prevX !== 0 || prevY !== 0) {\n            var widget = this.currentImageElementBox.line.paragraph;\n            var image = this.currentImageElementBox;\n            if (!isNullOrUndefined(widget) && widget.isInsideTable) {\n                var cellWidget = widget.containerWidget;\n                if (!isNullOrUndefined(cellWidget)) {\n                    var rowWidget = cellWidget.containerWidget;\n                    var imageHeight = HelperMethods.convertPointToPixel(image.height);\n                    var widgetHeight = rowWidget.height - imageHeight;\n                    if (prevY > 0 && rowWidget.y + widgetHeight + imageHeight + prevY > this.viewer.clientArea.bottom) {\n                        this.isImageMoveToNextPage = true;\n                    }\n                }\n            }\n            // tslint:disable-next-line:max-line-length \n            if (this.owner.enableHistoryMode) {\n                this.initHistoryForImageResizer(this.currentImageElementBox);\n            }\n            if (!isNullOrUndefined(this.currentImageElementBox)) {\n                // tslint:disable-next-line:max-line-length   \n                var width = this.currentImageElementBox.width + prevX > 10 ? this.currentImageElementBox.width + prevX : 10;\n                // tslint:disable-next-line:max-line-length \n                var height = this.currentImageElementBox.height + prevY > 10 ? this.currentImageElementBox.height + prevY : 10;\n                if (currentElementId === 'BottomRightRectParent'\n                    || currentElementId === 'TopRightRectParent'\n                    || currentElementId === 'BottomLeftRectParent'\n                    || currentElementId === 'TopLeftRectParent') {\n                    height = this.currentImageElementBox.height / this.currentImageElementBox.width * width;\n                    width = this.currentImageElementBox.width / this.currentImageElementBox.height * height;\n                }\n                this.currentImageElementBox.width = width;\n                this.currentImageElementBox.height = height;\n                var owner = this.currentImageElementBox.line.paragraph;\n                this.positionImageResizer(this.currentImageElementBox);\n            }\n            this.isImageResizing = true;\n        }\n    };\n    /**\n     * Handles image resizing on mouse.\n     * @param {MouseEvent} event - Specifies for image resizing using mouse event.\n     * @private\n     */\n    ImageResizer.prototype.handleImageResizingOnMouse = function (event) {\n        if (!isNullOrUndefined(this.selectedResizeElement)) {\n            var prevX = parseFloat(this.selectedResizeElement.style.left);\n            var prevY = parseFloat(this.selectedResizeElement.style.top);\n            var cursorPoint = new Point(event.offsetX, event.offsetY);\n            var touchPoint = this.viewer.findFocusedPage(cursorPoint, true);\n            this.handleImageResizing(touchPoint, prevX, prevY);\n        }\n    };\n    ImageResizer.prototype.topMiddleResizing = function (touchPoint) {\n        var prevY;\n        if (this.topValue >= touchPoint.y) {\n            prevY = this.topValue / touchPoint.y;\n            this.topValue = touchPoint.y;\n            if (this.viewer instanceof PageLayoutViewer) {\n                if (this.topValue <= this.viewer.pageGap) {\n                    prevY = 1;\n                }\n            }\n        }\n        else {\n            prevY = -(touchPoint.y / this.topValue);\n            this.topValue = touchPoint.y;\n            if (this.topValue === 0) {\n                prevY = -1;\n            }\n        }\n        return prevY;\n    };\n    ImageResizer.prototype.leftMiddleResizing = function (touchPoint) {\n        var prevX;\n        if (this.leftValue >= touchPoint.x) {\n            prevX = this.leftValue / touchPoint.x;\n            this.leftValue = touchPoint.x;\n            if (this.leftValue === 0) {\n                prevX = 1;\n                this.leftValue = parseFloat(this.selectedResizeElement.style.left);\n            }\n        }\n        else {\n            prevX = -(touchPoint.x / this.leftValue);\n            this.leftValue = touchPoint.x;\n        }\n        return prevX;\n    };\n    ImageResizer.prototype.topRightResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue <= touchPoint.x && this.topValue >= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.topLeftResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue >= touchPoint.x && this.topValue >= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.bottomRightResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue <= touchPoint.x && this.topValue <= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.bottomLeftResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue >= touchPoint.x && this.topValue <= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.getOuterResizingPoint = function (touchPoint) {\n        var prevX;\n        var prevY;\n        prevX = touchPoint.x - this.leftValue;\n        this.leftValue = touchPoint.x;\n        prevY = touchPoint.y - this.topValue;\n        this.topValue = touchPoint.y;\n        return { left: prevX, top: prevY };\n    };\n    ImageResizer.prototype.getInnerResizingPoint = function (touchPoint) {\n        var prevX;\n        var prevY;\n        prevX = -(this.leftValue - touchPoint.x);\n        this.leftValue = touchPoint.x;\n        prevY = -(this.topValue - touchPoint.y);\n        this.topValue = touchPoint.y;\n        return { left: prevX, top: prevY };\n    };\n    /**\n     * Handles image resizing on touch.\n     * @param {TouchEvent} touchEvent - Specifies for image resizing using touch event.\n     * @private\n     */\n    ImageResizer.prototype.handleImageResizingOnTouch = function (touchEvent) {\n        if (!isNullOrUndefined(this.selectedResizeElement)) {\n            var prevX = parseFloat(this.selectedResizeElement.style.left) + 24;\n            var prevY = parseFloat(this.selectedResizeElement.style.top) + 24;\n            var touch = touchEvent.touches;\n            var cursorPoint = new Point(touch[0].clientX, touch[0].clientY);\n            var touchPoint = this.viewer.findFocusedPage(cursorPoint, true);\n            if (isNullOrUndefined(this.currentImageElementBox) || isNullOrUndefined(this.currentImageElementBox)) {\n                return;\n            }\n            this.handleImageResizing(touchPoint, prevX, prevY);\n        }\n    };\n    /**\n     * Gets the image point of mouse.\n     * @param {Point} touchPoint - Specifies for resizer cursor position.\n     * @private\n     */\n    ImageResizer.prototype.getImagePoint = function (touchPoint) {\n        var x = this.viewer.render.getScaledValue(touchPoint.x, 1);\n        var y = this.viewer.render.getScaledValue(touchPoint.y, 2);\n        touchPoint = new Point(x, y);\n        var imageResizingPoints = this.imageResizerPoints;\n        var resizePosition = '';\n        var selectedElement = undefined;\n        var bottomMiddle = imageResizingPoints.bottomMiddleRectParent;\n        var bottomRight = imageResizingPoints.bottomRightRectParent;\n        var bottomLeft = imageResizingPoints.bottomLeftRectParent;\n        var topMiddle = imageResizingPoints.topMiddleRectParent;\n        var topRight = imageResizingPoints.topRightRectParent;\n        var topLeft = imageResizingPoints.topLeftRectParent;\n        var rightMiddle = imageResizingPoints.rightMiddleRectParent;\n        var leftMiddle = imageResizingPoints.leftMiddleRectParent;\n        if (!isNullOrUndefined(this.bottomMiddleRectParent) && this.bottomMiddleRectParent.style.display !== 'none') {\n            // tslint:disable-next-line:max-line-length   \n            if ((touchPoint.x > bottomMiddle.x && touchPoint.x <= bottomMiddle.x + 15) && (touchPoint.y > bottomMiddle.y && touchPoint.y <= bottomMiddle.y + 15)) {\n                selectedElement = this.bottomMiddleRectParent;\n                resizePosition = 's-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > bottomRight.x && touchPoint.x <= bottomRight.x + 15) && (touchPoint.y > bottomRight.y && touchPoint.y <= bottomRight.y + 15)) {\n                selectedElement = this.bottomRightRectParent;\n                resizePosition = 'se-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > bottomLeft.x && touchPoint.x <= bottomLeft.x + 15) && (touchPoint.y > bottomLeft.y && touchPoint.y <= bottomLeft.y + 15)) {\n                selectedElement = this.bottomLeftRectParent;\n                resizePosition = 'sw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > topMiddle.x && touchPoint.x <= topMiddle.x + 15) && (touchPoint.y > topMiddle.y && touchPoint.y <= topMiddle.y + 15)) {\n                selectedElement = this.topMiddleRectParent;\n                resizePosition = 'n-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > topRight.x && touchPoint.x <= topRight.x + 15) && (touchPoint.y > topRight.y && touchPoint.y <= topRight.y + 15)) {\n                selectedElement = this.topRightRectParent;\n                resizePosition = 'ne-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > topLeft.x && touchPoint.x <= topLeft.x + 15) && (touchPoint.y > topLeft.y && touchPoint.y <= topLeft.y + 15)) {\n                selectedElement = this.topLeftRectParent;\n                resizePosition = 'nw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > leftMiddle.x && touchPoint.x <= leftMiddle.x + 15) && (touchPoint.y > leftMiddle.y && touchPoint.y <= leftMiddle.y + 15)) {\n                selectedElement = this.leftMiddleRectParent;\n                resizePosition = 'w-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > rightMiddle.x && touchPoint.x <= rightMiddle.x + 15) && (touchPoint.y > rightMiddle.y && touchPoint.y <= rightMiddle.y + 15)) {\n                selectedElement = this.rightMiddleRectParent;\n                resizePosition = 'e-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if (!isNullOrUndefined(this.resizeContainerDiv) && (touchPoint.x > parseFloat(this.resizeContainerDiv.style.left)\n                && touchPoint.x <= (parseFloat(this.resizeContainerDiv.style.left) + parseFloat(this.resizeContainerDiv.style.width)))\n                && (touchPoint.y > parseFloat(this.resizeContainerDiv.style.top)\n                    // tslint:disable-next-line:max-line-length \n                    && touchPoint.y <= (parseFloat(this.resizeContainerDiv.style.top) + parseFloat(this.resizeContainerDiv.style.height)))) {\n                resizePosition = 'move';\n            }\n        }\n        return { 'selectedElement': selectedElement, 'resizePosition': resizePosition };\n    };\n    ImageResizer.prototype.applyPropertiesForMouse = function () {\n        if (!isNullOrUndefined(this.bottomLeftRectParent)) {\n            this.bottomMiddleRectParent.style.width = '14px';\n            this.bottomMiddleRectParent.style.height = '14px';\n            this.bottomRightRectParent.style.width = '14px';\n            this.bottomRightRectParent.style.height = '14px';\n            this.bottomLeftRectParent.style.width = '14px';\n            this.bottomLeftRectParent.style.height = '14px';\n            this.topMiddleRectParent.style.width = '14px';\n            this.topMiddleRectParent.style.height = '14px';\n            this.topRightRectParent.style.width = '14px';\n            this.topRightRectParent.style.height = '14px';\n            this.topLeftRectParent.style.width = '14px';\n            this.topLeftRectParent.style.height = '14px';\n            this.leftMiddleRectParent.style.width = '14px';\n            this.leftMiddleRectParent.style.height = '14px';\n            this.rightMiddleRectParent.style.width = '14px';\n            this.rightMiddleRectParent.style.height = '14px';\n        }\n    };\n    /**\n     * Gets the image point of touch.\n     * @param {Point} touchPoints - Specifies for resizer cursor position.\n     * @private\n     */\n    ImageResizer.prototype.getImagePointOnTouch = function (touchPoints) {\n        var x = this.viewer.render.getScaledValue(touchPoints.x, 1);\n        var y = this.viewer.render.getScaledValue(touchPoints.y, 2);\n        touchPoints = new Point(x, y);\n        var imageResizingPointsOnTouch = this.imageResizerPoints;\n        var resizePosition = '';\n        var selectedElements = undefined;\n        var bottomMiddle = imageResizingPointsOnTouch.bottomMiddleRectParent;\n        var bottomRight = imageResizingPointsOnTouch.bottomRightRectParent;\n        var bottomLeft = imageResizingPointsOnTouch.bottomLeftRectParent;\n        var topMiddle = imageResizingPointsOnTouch.topMiddleRectParent;\n        var topRight = imageResizingPointsOnTouch.topRightRectParent;\n        var topLeft = imageResizingPointsOnTouch.topLeftRectParent;\n        var rightMiddle = imageResizingPointsOnTouch.rightMiddleRectParent;\n        var leftMiddle = imageResizingPointsOnTouch.leftMiddleRectParent;\n        if (!isNullOrUndefined(this.bottomMiddleRectParent) && this.bottomMiddleRectParent.style.display !== 'none') {\n            // tslint:disable-next-line:max-line-length   \n            if ((touchPoints.x > bottomMiddle.x && touchPoints.x <= bottomMiddle.x + 25) && (touchPoints.y > bottomMiddle.y && touchPoints.y <= bottomMiddle.y + 25)) {\n                selectedElements = this.bottomMiddleRectParent;\n                resizePosition = 's-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > bottomRight.x && touchPoints.x <= bottomRight.x + 25) && (touchPoints.y > bottomRight.y && touchPoints.y <= bottomRight.y + 25)) {\n                selectedElements = this.bottomRightRectParent;\n                resizePosition = 'se-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > bottomLeft.x && touchPoints.x <= bottomLeft.x + 25) && (touchPoints.y > bottomLeft.y && touchPoints.y <= bottomLeft.y + 25)) {\n                selectedElements = this.bottomLeftRectParent;\n                resizePosition = 'sw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > topMiddle.x && touchPoints.x <= topMiddle.x + 25) && (touchPoints.y > topMiddle.y && touchPoints.y <= topMiddle.y + 25)) {\n                selectedElements = this.topMiddleRectParent;\n                resizePosition = 'n-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > topRight.x && touchPoints.x <= topRight.x + 25) && (touchPoints.y > topRight.y && touchPoints.y <= topRight.y + 25)) {\n                selectedElements = this.topRightRectParent;\n                resizePosition = 'ne-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > topLeft.x && touchPoints.x <= topLeft.x + 25) && (touchPoints.y > topLeft.y && touchPoints.y <= topLeft.y + 25)) {\n                selectedElements = this.topLeftRectParent;\n                resizePosition = 'nw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > leftMiddle.x && touchPoints.x <= leftMiddle.x + 25) && (touchPoints.y > leftMiddle.y && touchPoints.y <= leftMiddle.y + 25)) {\n                selectedElements = this.leftMiddleRectParent;\n                resizePosition = 'w-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > rightMiddle.x && touchPoints.x <= rightMiddle.x + 25) && (touchPoints.y > rightMiddle.y && touchPoints.y <= rightMiddle.y + 25)) {\n                selectedElements = this.rightMiddleRectParent;\n                resizePosition = 'e-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if (!isNullOrUndefined(this.resizeContainerDiv) && (touchPoints.x > parseFloat(this.resizeContainerDiv.style.left)\n                && touchPoints.x <= (parseFloat(this.resizeContainerDiv.style.left) + parseFloat(this.resizeContainerDiv.style.width)))\n                && (touchPoints.y > parseFloat(this.resizeContainerDiv.style.top)\n                    // tslint:disable-next-line:max-line-length \n                    && touchPoints.y <= (parseFloat(this.resizeContainerDiv.style.top) + parseFloat(this.resizeContainerDiv.style.height)))) {\n                resizePosition = 'move';\n            }\n        }\n        return { 'selectedElement': selectedElements, 'resizePosition': resizePosition };\n    };\n    ImageResizer.prototype.applyPropertiesForTouch = function () {\n        if (!isNullOrUndefined(this.bottomLeftRectParent)) {\n            this.bottomMiddleRectParent.style.width = '30px';\n            this.bottomMiddleRectParent.style.height = '30px';\n            this.bottomRightRectParent.style.width = '30px';\n            this.bottomRightRectParent.style.height = '30px';\n            this.bottomLeftRectParent.style.width = '30px';\n            this.bottomLeftRectParent.style.height = '30px';\n            this.topMiddleRectParent.style.width = '30px';\n            this.topMiddleRectParent.style.height = '30px';\n            this.topRightRectParent.style.width = '30px';\n            this.topRightRectParent.style.height = '30px';\n            this.topLeftRectParent.style.width = '30px';\n            this.topLeftRectParent.style.height = '30px';\n            this.leftMiddleRectParent.style.width = '30px';\n            this.leftMiddleRectParent.style.height = '30px';\n            this.rightMiddleRectParent.style.width = '30px';\n            this.rightMiddleRectParent.style.height = '30px';\n        }\n    };\n    /**\n     * @private\n     */\n    ImageResizer.prototype.mouseUpInternal = function () {\n        this.currentImageElementBox.width = parseFloat(this.imageResizerDiv.style.width) / this.viewer.zoomFactor;\n        this.currentImageElementBox.height = parseFloat(this.imageResizerDiv.style.height) / this.viewer.zoomFactor;\n        this.owner.isShiftingEnabled = true;\n        this.owner.editorModule.setOffsetValue(this.owner.selection);\n        this.viewer.layout.reLayoutParagraph(this.currentImageElementBox.line.paragraph, 0, 0);\n        this.owner.editorModule.reLayout(this.owner.selection, true);\n        this.viewer.updateScrollBars();\n    };\n    /**\n     * Initialize history for image resizer.\n     * @param {ImageResizer} imageResizer - Specifies for image resizer.\n     * @param {WImage} imageContainer - Specifies for an image.\n     * @private\n     */\n    ImageResizer.prototype.initHistoryForImageResizer = function (imageContainer) {\n        if (!isNullOrUndefined(this.owner) && isNullOrUndefined(this.baseHistoryInfo)) {\n            this.baseHistoryInfo = new BaseHistoryInfo(this.owner);\n            this.baseHistoryInfo.action = 'ImageResizing';\n            this.baseHistoryInfo.updateSelection();\n            this.baseHistoryInfo.modifiedProperties.push(new ImageFormat(imageContainer));\n        }\n    };\n    /**\n     * Updates histroy for image resizer.\n     * @private\n     */\n    ImageResizer.prototype.updateHistoryForImageResizer = function () {\n        if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.baseHistoryInfo)) {\n            var imageFormat = this.baseHistoryInfo.modifiedProperties[0];\n            if (this.currentImageElementBox.width === imageFormat.width\n                && this.currentImageElementBox.height === imageFormat.height) {\n                this.baseHistoryInfo.modifiedProperties.pop();\n            }\n            else {\n                //Records the image size modifications\n                this.owner.editorHistory.recordChanges(this.baseHistoryInfo);\n            }\n            //Fires the content changed event for the image size modifications\n            this.baseHistoryInfo = undefined;\n        }\n    };\n    /**\n     * Updates image resize container when applying zooming\n     * @private\n     */\n    ImageResizer.prototype.updateImageResizerPosition = function () {\n        if (!isNullOrUndefined(this.currentImageElementBox)) {\n            var elementBox = this.currentImageElementBox;\n            var lineWidget = elementBox.line;\n            var top_1 = this.viewer.selection.getTop(lineWidget) + elementBox.margin.top;\n            var left = this.viewer.selection.getLeftInternal(lineWidget, elementBox, 0);\n            var topValue = top_1 * this.viewer.zoomFactor;\n            var leftValue = left * this.viewer.zoomFactor;\n            var height = this.viewer.render.getScaledValue(elementBox.height, 2);\n            var width = this.viewer.render.getScaledValue(elementBox.width, 1);\n            this.setImageResizerPosition(leftValue, topValue, width, height, this);\n        }\n    };\n    /**\n     * Dispose the internal objects which are maintained.\n     * @private\n     */\n    ImageResizer.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.resizeContainerDiv)) {\n            this.resizeContainerDiv.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.topLeftRect)) {\n            this.topLeftRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.topMiddleRect)) {\n            this.topMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.topRightRect)) {\n            this.topRightRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.bottomLeftRect)) {\n            this.bottomLeftRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.bottomMiddleRect)) {\n            this.bottomMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.bottomRightRect)) {\n            this.bottomRightRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.leftMiddleRect)) {\n            this.leftMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.rightMiddleRect)) {\n            this.rightMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.imageResizerDiv)) {\n            this.imageResizerDiv.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.selectedImageWidget)) {\n            this.selectedImageWidget.destroy();\n        }\n        if (!isNullOrUndefined(this.imageResizerDivElement)) {\n            this.imageResizerDivElement.innerHTML = '';\n        }\n        this.imageResizerDivElement = undefined;\n        this.resizeContainerDiv = undefined;\n        this.topLeftRect = undefined;\n        this.topMiddleRect = undefined;\n        this.topRightRect = undefined;\n        this.bottomLeftRect = undefined;\n        this.bottomMiddleRect = undefined;\n        this.bottomRightRect = undefined;\n        this.leftMiddleRect = undefined;\n        this.rightMiddleRect = undefined;\n        this.imageResizerDiv = undefined;\n        this.selectedImageWidget = undefined;\n        this.isImageResizing = false;\n        this.isImageResizerVisible = false;\n        this.currentImageElementBoxIn = undefined;\n        //this.baseHistoryInfo = undefined;\n        this.resizeMarkSizeIn = undefined;\n        this.viewer = undefined;\n        this.owner = undefined;\n    };\n    return ImageResizer;\n}());\nexport { ImageResizer };\n/**\n * @private\n */\nvar ImageResizingPoints = /** @class */ (function () {\n    /**\n     * Constructor for image resizing points class.\n     */\n    function ImageResizingPoints() {\n        /**\n         * @private\n         */ this.resizeContainerDiv = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.topLeftRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.topMiddleRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.topRightRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.bottomLeftRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.bottomMiddleRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.bottomRightRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.leftMiddleRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.rightMiddleRectParent = new Point(0, 0);\n        var text = 'DocumentEditor';\n    }\n    return ImageResizingPoints;\n}());\nexport { ImageResizingPoints };\n/**\n * @private\n */\nvar SelectedImageInfo = /** @class */ (function () {\n    /**\n     * Constructor for selected image info class.\n     * @param {number} height - Specifies for height value.\n     * @param {number} width - Specifies for width value.\n     */\n    function SelectedImageInfo(height, width) {\n        this.heightIn = 0;\n        this.widthIn = 0;\n        this.heightIn = height;\n        this.widthIn = width;\n    }\n    Object.defineProperty(SelectedImageInfo.prototype, \"height\", {\n        /**\n         * Gets or Sets the height value.\n         * @private\n         */\n        get: function () {\n            return this.heightIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.heightIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectedImageInfo.prototype, \"width\", {\n        /**\n         * Gets or Sets the width value.\n         * @private\n         */\n        get: function () {\n            return this.widthIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.widthIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SelectedImageInfo;\n}());\nexport { SelectedImageInfo };\n","/**\n * Editor Export\n */\nexport * from './editor';\nexport * from './image-resizer';\nexport * from './table-resizer';\nexport * from './editor-helper';\n","import { TableWidget } from '../index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Point, HelperMethods } from './editor-helper';\n/**\n * @private\n */\nvar TableResizer = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableResizer(node) {\n        this.resizeNode = 0;\n        this.resizerPosition = -1;\n        this.currentResizingTable = undefined;\n        this.owner = node;\n        this.startingPoint = new Point(0, 0);\n    }\n    Object.defineProperty(TableResizer.prototype, \"viewer\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Gets module name.\n     */\n    TableResizer.prototype.getModuleName = function () {\n        return 'TableResizer';\n    };\n    /**\n     * @private\n     */\n    TableResizer.prototype.updateResizingHistory = function (touchPoint) {\n        if (this.owner.editorHistory) {\n            this.owner.editorHistory.updateResizingHistory(touchPoint, this);\n        }\n        this.viewer.isRowOrCellResizing = false;\n        this.resizerPosition = -1;\n    };\n    TableResizer.prototype.handleResize = function (point) {\n        this.owner.viewer.isRowOrCellResizing = true;\n        this.startingPoint.x = point.x;\n        this.startingPoint.y = point.y;\n        //Initialize resizing history.\n        this.owner.editorHistory.initResizingHistory(point, this);\n    };\n    //Table Resizing implementation starts\n    /**\n     * @private\n     */\n    TableResizer.prototype.isInRowResizerArea = function (touchPoint) {\n        var position = this.getRowReSizerPosition(undefined, touchPoint);\n        if (position === -1) {\n            return false;\n        }\n        else {\n            this.resizeNode = 1;\n            this.resizerPosition = position;\n            return true;\n        }\n    };\n    TableResizer.prototype.isInCellResizerArea = function (touchPoint) {\n        var position = this.getCellReSizerPosition(touchPoint);\n        if (position === -1) {\n            return false;\n        }\n        else {\n            this.resizeNode = 0;\n            this.resizerPosition = position;\n            return true;\n        }\n    };\n    /**\n     * Gets cell resizer position.\n     * @param {Point} point\n     * @private\n     */\n    TableResizer.prototype.getCellReSizerPosition = function (touchPoint) {\n        var position = -1;\n        var resizerBoundaryWidth = 2;\n        var tableWidget = this.getTableWidget(touchPoint);\n        var cellWidget = this.getTableCellWidget(touchPoint);\n        var cellSpacing = isNullOrUndefined(tableWidget) ? 0 : tableWidget.tableFormat.cellSpacing;\n        if (tableWidget && cellSpacing > 0) {\n            this.currentResizingTable = tableWidget;\n            // tslint:disable-next-line:max-line-length\n            if (this.viewer.isInsideRect(tableWidget.x - HelperMethods.convertPointToPixel(tableWidget.leftBorderWidth) - 0.25, tableWidget.y, HelperMethods.convertPointToPixel(tableWidget.leftBorderWidth) + 0.5, tableWidget.height, touchPoint)) {\n                return position = 0;\n            }\n            var startingPointX = tableWidget.x;\n            for (var i = 0; i < tableWidget.tableHolder.columns.length; i++) {\n                var preferredWidth = HelperMethods.convertPointToPixel(tableWidget.tableHolder.columns[i].preferredWidth);\n                // tslint:disable-next-line:max-line-length\n                if ((this.viewer.isInsideRect(startingPointX - 1, tableWidget.y, tableWidget.leftBorderWidth + resizerBoundaryWidth, tableWidget.height, touchPoint))) {\n                    return position = i > 0 ? i : 0;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (i > 0 && (this.viewer.isInsideRect(startingPointX + preferredWidth - resizerBoundaryWidth / 2, tableWidget.y, resizerBoundaryWidth, tableWidget.height, touchPoint))) {\n                    return position = (i + 1);\n                }\n                startingPointX = startingPointX + preferredWidth;\n            }\n        }\n        else {\n            if (!isNullOrUndefined(cellWidget)) {\n                this.currentResizingTable = cellWidget.ownerTable;\n                // tslint:disable-next-line:max-line-length\n                if (this.viewer.isInsideRect(cellWidget.x - cellWidget.margin.left - resizerBoundaryWidth / 2, cellWidget.y - cellWidget.margin.top, resizerBoundaryWidth, cellWidget.height, touchPoint)) {\n                    return position = cellWidget.columnIndex;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (isNullOrUndefined(cellWidget.nextRenderedWidget)\n                    && this.viewer.isInsideRect(cellWidget.x + cellWidget.margin.right + cellWidget.width - resizerBoundaryWidth / 2, cellWidget.y - cellWidget.margin.top, resizerBoundaryWidth, cellWidget.height, touchPoint)) {\n                    return position = (cellWidget.columnIndex + cellWidget.cellFormat.columnSpan);\n                }\n                else if (cellWidget.childWidgets.length > 0) {\n                    return this.getCellReSizerPositionInternal(cellWidget, touchPoint); // Gets the nested table resizer position.\n                }\n            }\n        }\n        return position;\n    };\n    /**\n     * Gets cell resizer position.\n     * @param {TableCellWidget} cellWidget\n     * @param {Point} touchPoint\n     */\n    TableResizer.prototype.getCellReSizerPositionInternal = function (cellWidget, touchPoint) {\n        var position = -1;\n        var childTableWidget = this.getTableWidgetFromWidget(touchPoint, cellWidget);\n        var childCellWidget = undefined;\n        if (!isNullOrUndefined(childTableWidget) && childTableWidget.tableFormat.cellSpacing > 0) {\n            this.currentResizingTable = childTableWidget;\n            // tslint:disable-next-line:max-line-length\n            if (this.viewer.isInsideRect(childTableWidget.x - childTableWidget.leftBorderWidth - 0.25, childTableWidget.y, childTableWidget.leftBorderWidth + 0.5, childTableWidget.height, touchPoint)) {\n                return position = 0;\n            }\n            var startingPointX = childTableWidget.x;\n            for (var i = 0; i < childTableWidget.tableHolder.columns.length; i++) {\n                // tslint:disable-next-line:max-line-length\n                var preferredWidth = HelperMethods.convertPointToPixel(childTableWidget.tableHolder.columns[i].preferredWidth);\n                // tslint:disable-next-line:max-line-length\n                if ((this.viewer.isInsideRect(startingPointX - 1, childTableWidget.y, childTableWidget.leftBorderWidth + 2, childTableWidget.height, touchPoint))) {\n                    return position = i > 0 ? i : 0;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (i > 0 && (this.viewer.isInsideRect(startingPointX + preferredWidth - 1, childTableWidget.y, 2, childTableWidget.height, touchPoint))) {\n                    return position = (i + 1);\n                }\n                startingPointX = startingPointX + preferredWidth;\n            }\n        }\n        else {\n            if (!isNullOrUndefined(childTableWidget)) {\n                childCellWidget = childTableWidget.getTableCellWidget(touchPoint);\n            }\n            if (!isNullOrUndefined(childCellWidget)) {\n                this.currentResizingTable = childCellWidget.ownerTable;\n                // tslint:disable-next-line:max-line-length\n                if (this.viewer.isInsideRect(childCellWidget.x - childCellWidget.margin.left - 1, childCellWidget.y - childCellWidget.margin.top, 2, childCellWidget.height, touchPoint)) {\n                    return position = childCellWidget.columnIndex;\n                }\n                else if (isNullOrUndefined(childCellWidget.nextRenderedWidget)\n                    // tslint:disable-next-line:max-line-length\n                    && this.viewer.isInsideRect(childCellWidget.x + childCellWidget.margin.right + childCellWidget.width - 1, childCellWidget.y - childCellWidget.margin.top, 2, childCellWidget.height, touchPoint)) {\n                    return position = (childCellWidget.columnIndex + childCellWidget.cellFormat.columnSpan);\n                }\n                else if (childCellWidget.childWidgets.length > 0) {\n                    return this.getCellReSizerPositionInternal(childCellWidget, touchPoint);\n                }\n            }\n        }\n        return position;\n    };\n    TableResizer.prototype.getRowReSizerPosition = function (widget, touchPoint) {\n        var tableWidget = undefined;\n        var cellWidget = undefined;\n        if (isNullOrUndefined(widget)) {\n            tableWidget = this.getTableWidget(touchPoint);\n            cellWidget = this.getTableCellWidget(touchPoint);\n        }\n        else {\n            tableWidget = this.getTableWidgetFromWidget(touchPoint, widget);\n        }\n        var cellSpacing = isNullOrUndefined(tableWidget) ? 0 : tableWidget.tableFormat.cellSpacing;\n        if (tableWidget && cellSpacing > 0) {\n            this.currentResizingTable = tableWidget;\n            // tslint:disable-next-line:max-line-length\n            if (this.owner.viewer.isInsideRect(tableWidget.x, tableWidget.y + tableWidget.height - cellSpacing, this.getActualWidth(tableWidget.lastChild), (isNullOrUndefined(tableWidget.nextSplitWidget) ? tableWidget.bottomBorderWidth + cellSpacing : 0), touchPoint)) {\n                return tableWidget.lastChild.rowIndex;\n            }\n            for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n                //Need to consider for splitted widgets\n                var rowWidget = tableWidget.childWidgets[i];\n                if (tableWidget.childWidgets.indexOf(rowWidget) > -1\n                    // tslint:disable-next-line:max-line-length\n                    && (this.owner.viewer.isInsideRect(rowWidget.x, rowWidget.y + rowWidget.height + cellSpacing / 2, this.getActualWidth(rowWidget), cellSpacing / 2, touchPoint))) {\n                    return rowWidget.rowIndex;\n                }\n            }\n        }\n        else {\n            if (tableWidget && cellWidget) {\n                cellWidget = this.getTableCellWidget(touchPoint);\n            }\n            if (cellWidget) {\n                var rowWidget = cellWidget.containerWidget;\n                var height = 0;\n                if (rowWidget.rowIndex === rowWidget.ownerTable.childWidgets.length - 1) {\n                    height = rowWidget.bottomBorderWidth + 2;\n                }\n                else {\n                    height = rowWidget.nextRenderedWidget.topBorderWidth + 2;\n                }\n                // tslint:disable-next-line:max-line-length\n                if (this.owner.viewer.isInsideRect(rowWidget.x, rowWidget.y + rowWidget.height - height, rowWidget.width, height * 2, touchPoint)) {\n                    this.currentResizingTable = rowWidget.ownerTable;\n                    return rowWidget.rowIndex;\n                }\n                else {\n                    if (cellWidget.childWidgets.length > 0) {\n                        return this.getRowReSizerPosition(cellWidget, touchPoint);\n                    }\n                }\n            }\n        }\n        return -1;\n    };\n    /**\n     * To handle Table Row and cell resize\n     * @param touchPoint\n     * @private\n     */\n    TableResizer.prototype.handleResizing = function (touchPoint) {\n        var dragValue = 0;\n        if (this.resizeNode === 0) {\n            dragValue = touchPoint.x - this.startingPoint.x;\n            this.resizeTableCellColumn(dragValue);\n        }\n        else {\n            dragValue = touchPoint.y - this.startingPoint.y;\n            this.resizeTableRow(dragValue);\n        }\n    };\n    TableResizer.prototype.resizeTableRow = function (dragValue) {\n        var table = this.currentResizingTable;\n        if (isNullOrUndefined(table) || dragValue === 0) {\n            return;\n        }\n        var selection = this.owner.selection;\n        if (table.isInsideTable) {\n            this.owner.isLayoutEnabled = false; //Layouting is disabled to skip the child table layouting. \n        }\n        if (this.resizerPosition > -1) {\n            var row = table.childWidgets[this.resizerPosition];\n            this.updateRowHeight(row, dragValue);\n            selection.selectPosition(selection.start, selection.end);\n        }\n        if (table.isInsideTable) {\n            var parentTable = this.owner.viewer.layout.getParentTable(table);\n            this.owner.isLayoutEnabled = true; //layouting is enabled to layout the parent table of the nested table.\n            table = parentTable;\n        }\n        this.startingPoint.y += HelperMethods.convertPointToPixel(dragValue);\n        this.owner.viewer.layout.reLayoutTable(table);\n        this.owner.editorModule.reLayout(this.owner.selection);\n    };\n    /**\n     * Gets the table widget from given cursor point\n     * @param cursorPoint\n     */\n    TableResizer.prototype.getTableWidget = function (cursorPoint) {\n        var widget = undefined;\n        var currentPage = this.owner.viewer.currentPage;\n        if (!isNullOrUndefined(currentPage)) {\n            for (var i = 0; i < currentPage.bodyWidgets.length; i++) {\n                var bodyWidget = currentPage.bodyWidgets[i];\n                widget = this.getTableWidgetFromWidget(cursorPoint, bodyWidget);\n                if (!isNullOrUndefined(widget)) {\n                    break;\n                }\n            }\n        }\n        return widget;\n    };\n    TableResizer.prototype.getTableWidgetFromWidget = function (point, widget) {\n        for (var j = 0; j < widget.childWidgets.length; j++) {\n            if (widget.childWidgets[j] instanceof TableWidget) {\n                var childWidget = widget.childWidgets[j];\n                if (childWidget.y <= point.y && (childWidget.y + childWidget.height) >= point.y) {\n                    return childWidget;\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Return the table cell widget from the given cursor point\n     * @param cursorPoint\n     * @private\n     */\n    TableResizer.prototype.getTableCellWidget = function (cursorPoint) {\n        var widget = undefined;\n        var currentPage = this.owner.viewer.currentPage;\n        if (!isNullOrUndefined(currentPage)) {\n            for (var i = 0; i < currentPage.bodyWidgets.length; i++) {\n                var bodyWidget = currentPage.bodyWidgets[i];\n                widget = bodyWidget.getTableCellWidget(cursorPoint);\n                if (!isNullOrUndefined(widget)) {\n                    break;\n                }\n            }\n        }\n        return widget;\n    };\n    TableResizer.prototype.updateRowHeight = function (row, dragValue) {\n        var rowFormat = row.rowFormat;\n        if (rowFormat.heightType === 'Auto') {\n            rowFormat.heightType = 'AtLeast';\n            var row_1 = rowFormat.ownerBase;\n            var currentHeight = this.owner.viewer.layout.getRowHeight(row_1, [row_1]);\n            //the minimum height of the Row in MS word is 2.7 points which is equal to 3.6 pixel.\n            if (currentHeight + dragValue >= 2.7 && rowFormat.height !== currentHeight + dragValue) {\n                rowFormat.height = currentHeight + dragValue;\n            }\n        }\n        else {\n            //the minimum height of the Row in MS word is 2.7 points which is equal to 3.6 pixel.\n            if (rowFormat.height + dragValue >= 2.7 && rowFormat.height !== rowFormat.height + dragValue) {\n                rowFormat.height = rowFormat.height + dragValue;\n            }\n        }\n    };\n    //Resize Table cell\n    TableResizer.prototype.resizeTableCellColumn = function (dragValue) {\n        var table = this.currentResizingTable;\n        if (isNullOrUndefined(table) || dragValue === 0 || isNullOrUndefined(table.childWidgets)) {\n            return;\n        }\n        var selectionFlag = true;\n        var selection = this.owner.selection;\n        this.owner.editor.setOffsetValue(selection);\n        table = table.combineWidget(this.viewer);\n        this.owner.isLayoutEnabled = false;\n        // table.PreserveGrid = true;\n        this.setPreferredWidth(table);\n        var containerWidth = table.getOwnerWidth(true);\n        var newIndent = table.leftIndent;\n        var tableAlignment = table.tableFormat.tableAlignment;\n        if (!selection.isEmpty) {\n            selectionFlag = this.resizeColumnWithSelection(selection, table, dragValue);\n        }\n        if (!selectionFlag) {\n            this.owner.isLayoutEnabled = true;\n            return;\n        }\n        if (this.resizerPosition === 0) {\n            // Todo: need to handle the resizing of first column and table indent.\n            var columnIndex = this.resizerPosition;\n            var rightColumn = table.tableHolder.columns[columnIndex];\n            var width = rightColumn.preferredWidth;\n            if (dragValue > 0) {\n                var prevDragValue = dragValue;\n                do {\n                    var newWidth = HelperMethods.round(rightColumn.preferredWidth - dragValue, 1);\n                    if (newWidth >= rightColumn.minWidth) {\n                        rightColumn.preferredWidth = newWidth;\n                        newIndent = table.leftIndent + dragValue;\n                        newIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        break;\n                    }\n                    else {\n                        prevDragValue = dragValue;\n                        dragValue += newWidth - rightColumn.minWidth;\n                    }\n                } while (dragValue !== prevDragValue);\n            }\n            else {\n                var prevDragValue = dragValue;\n                do {\n                    var newWidth = HelperMethods.round(rightColumn.preferredWidth - dragValue, 1);\n                    if (newWidth <= 2112) {\n                        rightColumn.preferredWidth = newWidth;\n                        newIndent = table.leftIndent + dragValue;\n                        newIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        break;\n                    }\n                    else {\n                        prevDragValue = dragValue;\n                        dragValue -= newWidth - 2112;\n                    }\n                } while (dragValue !== prevDragValue);\n            }\n            var dragOffset = dragValue;\n            // tslint:disable-next-line:max-line-length\n            if (tableAlignment !== 'Left' && (table.tableHolder.getTotalWidth(0) > containerWidth) && table.tableFormat.preferredWidthType === 'Auto') {\n                if (table.tableHolder.isFitColumns(containerWidth, table.tableHolder.tableWidth, table.tableFormat.preferredWidthType === 'Auto')) {\n                    // tslint:disable-next-line:max-line-length\n                    table.tableHolder.fitColumns(containerWidth, table.tableHolder.tableWidth, table.tableFormat.preferredWidthType === 'Auto');\n                }\n                else {\n                    rightColumn.preferredWidth = width;\n                }\n                dragOffset = 0;\n            }\n            if (tableAlignment === 'Center'\n                && (table.tableHolder.getTotalWidth(0) < containerWidth || table.tableFormat.preferredWidthType !== 'Auto')) {\n                dragOffset = dragOffset / 2;\n            }\n            table.tableFormat.leftIndent = tableAlignment === 'Left' ? newIndent : 0;\n            table.tableHolder.tableWidth = table.tableHolder.getTotalWidth(0);\n            this.updateCellPreferredWidths(table);\n            this.updateGridValue(table, true, dragOffset);\n        }\n        else if (table !== null && this.resizerPosition === table.tableHolder.columns.length) {\n            // Todo: need to handle the resizing of last column and table width.\n            this.resizeColumnAtLastColumnIndex(table, dragValue, containerWidth);\n        }\n        else {\n            if (this.resizerPosition === -1) {\n                this.owner.isLayoutEnabled = true;\n                return;\n            }\n            this.resizeCellAtMiddle(table, dragValue);\n        }\n        // table.PreserveGrid = false;\n        this.owner.isLayoutEnabled = true;\n        selection.selectPosition(selection.start, selection.end);\n    };\n    /**\n     * Resize Selected Cells\n     */\n    TableResizer.prototype.resizeColumnWithSelection = function (selection, table, dragValue) {\n        var newIndent = table.leftIndent;\n        var cellwidget = this.getTableCellWidget(this.startingPoint);\n        if (cellwidget && (selection.selectedWidgets.containsKey(cellwidget) || (cellwidget.previousWidget\n            && selection.selectedWidgets.containsKey((cellwidget.previousWidget))))) {\n            var selectedCells = selection.getSelectedCells();\n            if (this.resizerPosition === 0) {\n                this.resizeColumnAtStart(table, dragValue, selectedCells);\n            }\n            else if (table !== null && this.resizerPosition === table.tableHolder.columns.length) {\n                var leftColumnCollection = this.getColumnCells(table, this.resizerPosition, true);\n                for (var i = 0; i < leftColumnCollection.length; i++) {\n                    var cell = leftColumnCollection[i];\n                    if (selectedCells.indexOf(cell) !== -1) {\n                        this.increaseOrDecreaseWidth(cell, dragValue, true);\n                    }\n                }\n                //Updates the grid after value for all the rows.\n                this.updateRowsGridAfterWidth(table);\n                table.updateWidth(dragValue);\n                table.tableFormat.allowAutoFit = false;\n                this.updateGridValue(table, true, dragValue);\n            }\n            else {\n                if (this.resizerPosition === -1) {\n                    return false;\n                }\n                var columnIndex = this.resizerPosition;\n                var leftColumnCollection = this.getColumnCells(table, columnIndex, true);\n                var rightColumnCollection = this.getColumnCells(table, columnIndex, false);\n                var isColumnResizing = this.isColumnSelected(table, columnIndex);\n                if (leftColumnCollection.length > 0 && !isColumnResizing) {\n                    for (var i = 0; i < leftColumnCollection.length; i++) {\n                        if (selectedCells.indexOf(leftColumnCollection[i]) === -1) {\n                            leftColumnCollection.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n                if (rightColumnCollection.length > 0 && !isColumnResizing) {\n                    for (var i = 0; i < rightColumnCollection.length; i++) {\n                        if (selectedCells.indexOf(rightColumnCollection[i]) === -1) {\n                            rightColumnCollection.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n                //Getting the adjacent cell collections for left side selected cells in the right column collection.\n                if (leftColumnCollection.length === 0 && rightColumnCollection.length > 0) {\n                    for (var i = 0; i < rightColumnCollection.length; i++) {\n                        var cell = rightColumnCollection[i];\n                        if (cell.previousWidget) {\n                            leftColumnCollection.push(cell.previousWidget);\n                        }\n                    }\n                }\n                else if (rightColumnCollection.length === 0 && leftColumnCollection.length > 0) {\n                    for (var i = 0; i < leftColumnCollection.length; i++) {\n                        var cell = leftColumnCollection[i];\n                        if (cell.nextWidget) {\n                            rightColumnCollection.push(cell.nextWidget);\n                        }\n                    }\n                }\n                this.changeWidthOfCells(table, leftColumnCollection, rightColumnCollection, dragValue, true);\n                if (table.tableFormat.allowAutoFit) {\n                    table.updateWidth(dragValue);\n                }\n                table.tableFormat.allowAutoFit = false;\n                this.updateGridValue(table, true, dragValue);\n            }\n            selection.selectPosition(selection.start, selection.end);\n        }\n        return false;\n    };\n    /**\n     * Resize selected cells at resizer position 0\n     */\n    TableResizer.prototype.resizeColumnAtStart = function (table, dragValue, selectedCells) {\n        var newIndent = table.leftIndent;\n        var rightColumnCollection = this.getColumnCells(table, this.resizerPosition, false);\n        var offset = 0;\n        var selectedRow = selectedCells[0].ownerRow;\n        var rowFormat = selectedRow.rowFormat;\n        if (rowFormat.beforeWidth > 0) {\n            var newGridBefore = rowFormat.beforeWidth + dragValue;\n            if (newGridBefore > 0) {\n                this.updateGridBefore(selectedRow, dragValue);\n            }\n            else {\n                var leastGridBefore = this.getLeastGridBefore(table, selectedRow);\n                if (newGridBefore < leastGridBefore && offset !== newGridBefore) {\n                    newIndent = table.leftIndent + newGridBefore;\n                    table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                    for (var i = 0; i < table.childWidgets.length; i++) {\n                        var tableRow = table.childWidgets[i];\n                        if (selectedRow !== tableRow) {\n                            this.updateGridBefore(tableRow, -newGridBefore);\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            if (dragValue < 0) {\n                newIndent = table.leftIndent + dragValue;\n                table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                this.updateWidthForCells(table, selectedCells, dragValue);\n            }\n            else {\n                var leastGridBefore = this.getLeastGridBefore(table, selectedRow);\n                var currentTableIndent = table.tableFormat.leftIndent;\n                if (currentTableIndent === 0) {\n                    for (var i = 0; i < table.childWidgets.length; i++) {\n                        var tableRow = table.childWidgets[i];\n                        if (selectedCells.indexOf(tableRow.childWidgets[0]) !== -1) {\n                            this.updateGridBefore(tableRow, dragValue);\n                            this.increaseOrDecreaseWidth(tableRow.childWidgets[0], dragValue, false);\n                        }\n                    }\n                }\n                else {\n                    var difference = leastGridBefore - dragValue;\n                    if (difference > 0) {\n                        newIndent = table.leftIndent + dragValue;\n                        table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        this.updateWidthForCells(table, selectedCells, dragValue);\n                    }\n                    else {\n                        newIndent = table.leftIndent + leastGridBefore;\n                        table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        for (var i = 0; i < table.childWidgets.length; i++) {\n                            var tableRow = table.childWidgets[i];\n                            if (selectedCells.indexOf(tableRow.childWidgets[0]) !== -1) {\n                                this.increaseOrDecreaseWidth(tableRow.childWidgets[0], dragValue, false);\n                                this.updateGridBefore(tableRow, dragValue - leastGridBefore);\n                            }\n                            else {\n                                this.updateGridBefore(tableRow, -leastGridBefore);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        table.tableFormat.allowAutoFit = false;\n        this.updateGridValue(table, true, dragValue);\n    };\n    TableResizer.prototype.updateWidthForCells = function (table, selectedCells, dragValue) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var tableRow = table.childWidgets[i];\n            if (selectedCells.indexOf(tableRow.childWidgets[0]) !== -1) {\n                this.increaseOrDecreaseWidth(tableRow.childWidgets[0], dragValue, false);\n            }\n            else {\n                this.updateGridBefore(tableRow, -dragValue);\n            }\n        }\n    };\n    /**\n     * Resize selected cells at last column\n     */\n    TableResizer.prototype.resizeColumnAtLastColumnIndex = function (table, dragValue, containerWidth) {\n        var tableAlignment = table.tableFormat.tableAlignment;\n        var preferredWidth = table.tableFormat.preferredWidth;\n        var hasTableWidth = preferredWidth;\n        var columnIndex = this.resizerPosition;\n        var leftColumn = table.tableHolder.columns[columnIndex - 1];\n        var prevDragValue = 0;\n        while (dragValue !== prevDragValue) {\n            var newWidth = HelperMethods.round(leftColumn.preferredWidth + dragValue, 1);\n            if (newWidth >= leftColumn.minWidth) {\n                leftColumn.preferredWidth = newWidth;\n                prevDragValue = dragValue;\n            }\n            else {\n                prevDragValue = dragValue;\n                dragValue -= newWidth - leftColumn.minWidth;\n            }\n        }\n        this.updateCellPreferredWidths(table);\n        if (hasTableWidth || table.tableHolder.getTotalWidth(0) > containerWidth) {\n            if (table.tableFormat.allowAutoFit) {\n                table.updateWidth(dragValue);\n            }\n            table.tableFormat.allowAutoFit = false;\n            table.tableHolder.tableWidth = table.tableHolder.getTotalWidth(0);\n        }\n        var dragOffset = dragValue;\n        if (tableAlignment === 'Right') {\n            dragOffset = 0;\n        }\n        else if (tableAlignment === 'Center') {\n            dragOffset = dragOffset / 2;\n        }\n        this.updateGridValue(table, true, dragOffset);\n    };\n    /**\n     *  Resize selected cells at middle column\n     */\n    TableResizer.prototype.resizeCellAtMiddle = function (table, dragValue) {\n        var columnIndex = this.resizerPosition;\n        var leftColumn = table.tableHolder.columns[columnIndex - 1];\n        var rightColumn = table.tableHolder.columns[columnIndex];\n        if (dragValue > 0) {\n            var isContinue = true;\n            while (isContinue) {\n                var newWidth = HelperMethods.round(rightColumn.preferredWidth - dragValue, 1);\n                if (newWidth >= rightColumn.minWidth) {\n                    rightColumn.preferredWidth = newWidth;\n                    leftColumn.preferredWidth = leftColumn.preferredWidth + dragValue;\n                    isContinue = false;\n                }\n                else {\n                    dragValue += newWidth - rightColumn.minWidth;\n                }\n            }\n        }\n        else {\n            var isContinue = true;\n            while (isContinue) {\n                var newWidth = HelperMethods.round(leftColumn.preferredWidth + dragValue, 1);\n                if (newWidth >= leftColumn.minWidth) {\n                    leftColumn.preferredWidth = newWidth;\n                    rightColumn.preferredWidth = rightColumn.preferredWidth - dragValue;\n                    isContinue = false;\n                }\n                else {\n                    dragValue -= newWidth - leftColumn.minWidth;\n                }\n            }\n        }\n        // Update the cell widths based on the columns preferred width\n        this.updateCellPreferredWidths(table);\n        if (table.tableFormat.allowAutoFit) {\n            table.updateWidth(dragValue);\n        }\n        table.tableFormat.allowAutoFit = false;\n        table.tableHolder.tableWidth = table.tableHolder.getTotalWidth(0);\n        this.updateGridValue(table, false, dragValue);\n    };\n    TableResizer.prototype.updateGridValue = function (table, isUpdate, dragValue) {\n        if (isUpdate) {\n            table.calculateGrid();\n            table.isGridUpdated = false;\n        }\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.viewer.owner.isLayoutEnabled = true;\n        if (table.isInsideTable) {\n            var parentTable = this.viewer.layout.getParentTable(table);\n            this.viewer.layout.reLayoutTable(parentTable); // Need to optmize this.\n        }\n        else {\n            this.viewer.layout.reLayoutTable(table);\n        }\n        this.owner.editor.getOffsetValue(this.viewer.selection);\n        this.owner.editorModule.reLayout(this.owner.selection);\n        if (dragValue) {\n            this.startingPoint.x += HelperMethods.convertPointToPixel(dragValue);\n            this.resizerPosition = this.getCellReSizerPosition(this.startingPoint);\n        }\n    };\n    TableResizer.prototype.getColumnCells = function (table, columnIndex, isLeftSideCollection) {\n        var cells = [];\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                if (isLeftSideCollection) {\n                    if (cell.columnIndex + cell.cellFormat.columnSpan === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n                else {\n                    if (cell.columnIndex === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    TableResizer.prototype.updateGridBefore = function (row, offset) {\n        if (row.rowFormat.beforeWidth + offset !== row.rowFormat.beforeWidth) {\n            row.rowFormat.beforeWidth = row.rowFormat.beforeWidth + offset;\n            row.rowFormat.gridBeforeWidth = row.rowFormat.beforeWidth;\n        }\n    };\n    TableResizer.prototype.getLeastGridBefore = function (table, ignoreRow) {\n        var gridBefore = 0;\n        var flag = 0;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row !== ignoreRow) {\n                if (flag === 0) {\n                    gridBefore = row.rowFormat.beforeWidth;\n                    flag++;\n                }\n                if (row.rowFormat.beforeWidth <= gridBefore) {\n                    gridBefore = row.rowFormat.beforeWidth;\n                }\n            }\n        }\n        return gridBefore;\n    };\n    TableResizer.prototype.increaseOrDecreaseWidth = function (cell, dragValue, isIncrease) {\n        var preferredWidth = cell.cellFormat.preferredWidth;\n        if (cell.cellFormat.preferredWidthType === 'Auto') {\n            preferredWidth = cell.cellFormat.cellWidth;\n            cell.cellFormat.preferredWidthType = 'Point';\n        }\n        var minimumWidth = cell.ownerColumn.minWidth;\n        if (cell.cellFormat.preferredWidthType === 'Percent') {\n            minimumWidth = cell.convertPointToPercent(minimumWidth);\n        }\n        // Margins properties usedd for internal purpose.\n        if (isIncrease) {\n            cell.cellFormat.preferredWidth = preferredWidth + dragValue > minimumWidth ? preferredWidth + dragValue : minimumWidth;\n        }\n        else {\n            cell.cellFormat.preferredWidth = preferredWidth - dragValue > minimumWidth ? preferredWidth - dragValue : minimumWidth;\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    TableResizer.prototype.changeWidthOfCells = function (table, leftColumnCollection, rightColumnCollection, dragValue, isSelection) {\n        if (leftColumnCollection.length > 0) {\n            var flag = false;\n            for (var i = 0; i < leftColumnCollection.length; i++) {\n                var cell = leftColumnCollection[i];\n                this.increaseOrDecreaseWidth(cell, dragValue, true);\n                if (cell.cellIndex === cell.ownerRow.childWidgets.length - 1) {\n                    flag = true;\n                }\n            }\n            if (flag) {\n                this.updateRowsGridAfterWidth(table);\n            }\n        }\n        if (rightColumnCollection.length > 0) {\n            var diff = 0;\n            for (var i = 0; i < rightColumnCollection.length; i++) {\n                var cell = rightColumnCollection[i];\n                if (cell.cellIndex === 0) {\n                    var newGridBefore = cell.ownerRow.rowFormat.beforeWidth + dragValue;\n                    if (newGridBefore >= 0) {\n                        this.updateGridBefore(cell.ownerRow, dragValue);\n                    }\n                    else {\n                        if (diff !== newGridBefore) {\n                            diff = newGridBefore;\n                        }\n                        cell.ownerRow.rowFormat.gridBeforeWidth = 0;\n                        cell.ownerRow.rowFormat.gridBeforeWidthType = 'Auto';\n                    }\n                }\n                this.increaseOrDecreaseWidth(cell, dragValue, false);\n            }\n            if (diff !== 0) {\n                var newIndent = table.leftIndent + diff;\n                table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                for (var j = 0; j < table.childWidgets.length; j++) {\n                    var row = table.childWidgets[j];\n                    if (rightColumnCollection.indexOf(row.childWidgets[0]) === -1) {\n                        this.updateGridBefore(row, diff > 0 ? diff : -diff);\n                    }\n                }\n            }\n        }\n    };\n    TableResizer.prototype.updateRowsGridAfterWidth = function (table) {\n        var maxRowWidth = this.getMaxRowWidth(table, true);\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var currentRowWidth = this.getRowWidth(row, true);\n            if (maxRowWidth >= currentRowWidth && row.rowFormat.afterWidth !== maxRowWidth - currentRowWidth) {\n                var value = maxRowWidth - currentRowWidth;\n                row.rowFormat.gridAfterWidth = value;\n                row.rowFormat.afterWidth = value;\n            }\n        }\n    };\n    TableResizer.prototype.getRowWidth = function (row, toUpdateGridAfter) {\n        var rowWidth = 0;\n        if (toUpdateGridAfter) {\n            rowWidth = rowWidth + row.rowFormat.beforeWidth;\n        }\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            rowWidth += cell.cellFormat.cellWidth;\n        }\n        return rowWidth;\n    };\n    TableResizer.prototype.getMaxRowWidth = function (table, toUpdateGridAfter) {\n        var width = 0;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowWidth = 0;\n            if (toUpdateGridAfter) {\n                rowWidth = rowWidth + row.rowFormat.beforeWidth;\n            }\n            for (var i_1 = 0; i_1 < row.childWidgets.length; i_1++) {\n                var cell = row.childWidgets[i_1];\n                rowWidth += cell.cellFormat.cellWidth;\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    TableResizer.prototype.isColumnSelected = function (table, columnIndex) {\n        var selection = this.owner.selection;\n        var selectedCells = selection.getSelectedCells();\n        var leftColumnCells = this.getColumnCells(table, columnIndex, true);\n        var rightColumnCells = this.getColumnCells(table, columnIndex, false);\n        var isColumnSelected = false;\n        for (var i = 0; i < leftColumnCells.length; i++) {\n            var columnCell = leftColumnCells[i];\n            isColumnSelected = selectedCells.indexOf(columnCell) !== -1 ? true : false;\n        }\n        if (!isColumnSelected) {\n            for (var i = 0; i < rightColumnCells.length; i++) {\n                var columnCell = rightColumnCells[i];\n                isColumnSelected = selectedCells.indexOf(columnCell) !== -1 ? true : false;\n            }\n        }\n        return isColumnSelected;\n    };\n    TableResizer.prototype.applyProperties = function (table, tableHistoryInfo) {\n        if (isNullOrUndefined(tableHistoryInfo)) {\n            return;\n        }\n        table = table;\n        // PreserveGrid = true;\n        if (tableHistoryInfo.tableHolder) {\n            table.tableHolder = tableHistoryInfo.tableHolder.clone();\n        }\n        if (tableHistoryInfo.tableFormat !== null) {\n            table.tableFormat.leftIndent = tableHistoryInfo.tableFormat.leftIndent;\n            table.tableFormat.preferredWidth = tableHistoryInfo.tableFormat.preferredWidth;\n            table.tableFormat.preferredWidthType = tableHistoryInfo.tableFormat.preferredWidthType;\n            table.tableFormat.allowAutoFit = tableHistoryInfo.tableFormat.allowAutoFit;\n        }\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowFormat = tableHistoryInfo.rows[i];\n            row.rowFormat.gridBefore = rowFormat.gridBefore;\n            row.rowFormat.gridBeforeWidth = rowFormat.gridBeforeWidth;\n            row.rowFormat.gridBeforeWidthType = rowFormat.gridBeforeWidthType;\n            row.rowFormat.gridAfter = rowFormat.gridAfter;\n            row.rowFormat.gridAfterWidth = rowFormat.gridAfterWidth;\n            row.rowFormat.gridAfterWidthType = rowFormat.gridAfterWidthType;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellFormat = rowFormat.cells[j];\n                cell.columnIndex = cellFormat.columnIndex;\n                cell.cellFormat.columnSpan = cellFormat.columnSpan;\n                cell.cellFormat.preferredWidth = cellFormat.preferredWidth;\n                cell.cellFormat.preferredWidthType = cellFormat.preferredWidthType;\n            }\n        }\n        var containerWidth = table.getOwnerWidth(true);\n        var tableWidth = table.getTableClientWidth(containerWidth);\n        //Sets the width to cells\n        table.setWidthToCells(tableWidth, table.tableFormat.preferredWidthType === 'Auto');\n        // PreserveGrid = false;\n    };\n    /**\n     * Return table row width\n     */\n    TableResizer.prototype.getActualWidth = function (row) {\n        var width = 0;\n        if (row.childWidgets.length > 0) {\n            for (var i = 0; i < row.childWidgets.length; i++) {\n                width += row.childWidgets[i].cellFormat.cellWidth;\n            }\n        }\n        return width;\n    };\n    TableResizer.prototype.setPreferredWidth = function (table) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var rw = table.childWidgets[i];\n            var rowFormat = rw.rowFormat;\n            if (rowFormat.gridBefore > 0) {\n                rowFormat.gridBeforeWidth = rowFormat.beforeWidth;\n                rowFormat.gridBeforeWidthType = 'Point';\n            }\n            for (var j = 0; j < rw.childWidgets.length; j++) {\n                var cell = rw.childWidgets[j];\n                cell.cellFormat.preferredWidth = cell.cellFormat.cellWidth;\n                cell.cellFormat.preferredWidthType = 'Point';\n            }\n            if (rowFormat.gridAfter > 0) {\n                rowFormat.gridAfterWidth = rowFormat.afterWidth;\n                rowFormat.gridAfterWidthType = 'Point';\n            }\n        }\n    };\n    TableResizer.prototype.updateCellPreferredWidths = function (table) {\n        var tableWidth = table.tableHolder.tableWidth;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.rowFormat.gridBefore > 0) {\n                var width = table.tableHolder.getCellWidth(0, row.rowFormat.gridBefore, tableWidth);\n                this.updateGridBeforeWidth(width, row);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                cell.updateWidth(table.tableHolder.getCellWidth(cell.columnIndex, cell.cellFormat.columnSpan, tableWidth));\n            }\n            if (row.rowFormat.gridAfter > 0) {\n                // tslint:disable-next-line:max-line-length\n                this.updateGridAfterWidth(table.tableHolder.getCellWidth(row.childWidgets.length, row.rowFormat.gridAfter, tableWidth), row);\n            }\n        }\n    };\n    /**\n     * Update grid before width value\n     */\n    TableResizer.prototype.updateGridBeforeWidth = function (width, row) {\n        var rowFormat = row.rowFormat;\n        if (width !== rowFormat.beforeWidth) {\n            rowFormat.beforeWidth = width;\n            if (rowFormat.gridBeforeWidthType === 'Auto') {\n                rowFormat.gridBeforeWidthType = 'Point';\n            }\n            if (rowFormat.gridBeforeWidthType === 'Point') {\n                rowFormat.gridBeforeWidth = rowFormat.beforeWidth;\n            }\n            else {\n                // The value is calculated from the pixel values hence, its converted to percent using method. \n                var ownerWidth = row.ownerTable.getTableClientWidth(row.ownerTable.getOwnerWidth(true));\n                var value = row.ownerTable.convertPointToPercent(rowFormat.beforeWidth, ownerWidth);\n                rowFormat.gridBeforeWidth = value;\n            }\n        }\n    };\n    /**\n     * Update grid after width value\n     */\n    TableResizer.prototype.updateGridAfterWidth = function (width, row) {\n        var rowFormat = row.rowFormat;\n        if (width !== rowFormat.afterWidth) {\n            rowFormat.afterWidth = width;\n        }\n        if (rowFormat.gridAfterWidthType === 'Auto') {\n            rowFormat.gridAfterWidthType = 'Point';\n        }\n        if (rowFormat.gridAfterWidthType === 'Point') {\n            rowFormat.gridAfterWidth = rowFormat.afterWidth;\n        }\n        else {\n            // The value is calculated from the pixel values hence, its converted to percent using method. \n            var ownerWidth = row.ownerTable.getTableClientWidth(row.ownerTable.getOwnerWidth(true));\n            var value = row.ownerTable.convertPointToPercent(rowFormat.afterWidth, ownerWidth);\n            rowFormat.gridAfterWidth = value;\n        }\n    };\n    return TableResizer;\n}());\nexport { TableResizer };\n","import { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WBorder = /** @class */ (function () {\n    function WBorder(node) {\n        this.uniqueBorderFormat = undefined;\n        this.ownerBase = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WBorder.prototype, \"color\", {\n        get: function () {\n            return this.getPropertyValue('color');\n        },\n        set: function (value) {\n            this.setPropertyValue('color', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"lineStyle\", {\n        get: function () {\n            return this.getPropertyValue('lineStyle');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineStyle', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"lineWidth\", {\n        get: function () {\n            return this.getPropertyValue('lineWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"shadow\", {\n        get: function () {\n            return this.getPropertyValue('shadow');\n        },\n        set: function (value) {\n            this.setPropertyValue('shadow', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"space\", {\n        get: function () {\n            return this.getPropertyValue('space');\n        },\n        set: function (value) {\n            this.setPropertyValue('space', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"hasNoneStyle\", {\n        get: function () {\n            return this.getPropertyValue('hasNoneStyle');\n        },\n        set: function (value) {\n            this.setPropertyValue('hasNoneStyle', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WBorder.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WBorder.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueBorderFormat) && this.uniqueBorderFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueBorderFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WBorder.getPropertyDefaultValue(property);\n    };\n    WBorder.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WBorder.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueBorderFormat)) {\n            this.initializeUniqueBorder(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueBorderFormat.uniqueFormatType, property);\n            if (this.uniqueBorderFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueBorderFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueBorderFormat = WBorder.uniqueBorderFormats.updateUniqueFormat(this.uniqueBorderFormat, property, value);\n        }\n    };\n    WBorder.prototype.initializeUniqueBorder = function (property, propValue) {\n        var uniqueBorderFormatTemp = new Dictionary();\n        this.addUniqueBorderFormat('color', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('lineStyle', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('lineWidth', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('shadow', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('space', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('hasNoneStyle', property, propValue, uniqueBorderFormatTemp);\n        this.uniqueBorderFormat = WBorder.uniqueBorderFormats.addUniqueFormat(uniqueBorderFormatTemp, WBorder.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WBorder.prototype.addUniqueBorderFormat = function (property, modifiedProperty, propValue, uniqueBorderFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WBorder.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueBorderFormatTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueBorderFormatTemp.add(propertyType, WBorder.getPropertyDefaultValue(property));\n        }\n    };\n    WBorder.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'color':\n                value = '#000000';\n                break;\n            case 'lineStyle':\n                value = 'None';\n                break;\n            case 'lineWidth':\n                value = 0;\n                break;\n            case 'shadow':\n                value = false;\n                break;\n            case 'space':\n                value = 0;\n                break;\n            case 'hasNoneStyle':\n                value = false;\n                break;\n        }\n        return value;\n    };\n    WBorder.prototype.getLineWidth = function () {\n        /* tslint:disable */\n        switch (this.lineStyle) {\n            case 'None':\n            case 'Cleared':\n                return 0;\n            case 'Triple':\n            case 'Double':\n            case 'ThinThickSmallGap':\n            case 'ThickThinSmallGap':\n            case 'ThinThickThinSmallGap':\n            case 'ThinThickMediumGap':\n            case 'ThickThinMediumGap':\n            case 'ThinThickThinMediumGap':\n            case 'ThinThickLargeGap':\n            case 'ThickThinLargeGap':\n            case 'ThinThickThinLargeGap':\n            case 'Emboss3D':\n            case 'Engrave3D':\n                {\n                    var lineArray = this.getBorderLineWidthArray(this.lineStyle, this.lineWidth);\n                    var width = 0;\n                    for (var i = 0; i < lineArray.length; i++) {\n                        width += lineArray[i];\n                    }\n                    return width;\n                }\n            case 'Single':\n            case 'DashLargeGap':\n            case 'DashSmallGap':\n            case 'Dot':\n            case 'DashDot':\n            case 'DashDotDot':\n            case 'Thick':\n                return this.lineWidth;\n            case 'SingleWavy':\n                return (this.lineWidth === 1.5 ? 3 : 2.5); //Double wave border only draw with the fixed width\n            case 'DoubleWavy':\n                return (6.75); //Double wave border only draw with the fixed width\n            case 'DashDotStroked':\n            case 'Outset':\n                return this.lineWidth;\n        }\n        return this.lineWidth;\n        /* tslint:enable */\n    };\n    WBorder.prototype.getBorderLineWidthArray = function (lineStyle, lineWidth) {\n        var borderLineArray = [lineWidth];\n        switch (lineStyle) {\n            case 'Double':\n                borderLineArray = [1, 1, 1];\n                break;\n            case 'ThinThickSmallGap':\n                borderLineArray = [1, -0.75, -0.75];\n                break;\n            case 'ThickThinSmallGap':\n                borderLineArray = [-0.75, -0.75, 1];\n                break;\n            case 'ThinThickMediumGap':\n                borderLineArray = [1, 0.5, 0.5];\n                break;\n            case 'ThickThinMediumGap':\n                borderLineArray = [0.5, 0.5, 1];\n                break;\n            case 'ThinThickLargeGap':\n                borderLineArray = [-1.5, 1, -0.75];\n                break;\n            case 'ThickThinLargeGap':\n                borderLineArray = [-0.75, 1, -1.5];\n                break;\n            case 'Triple':\n                borderLineArray = [1, 1, 1, 1, 1];\n                break;\n            case 'ThinThickThinSmallGap':\n                borderLineArray = [-0.75, -0.75, 1, -0.75, -0.75];\n                break;\n            case 'ThinThickThinMediumGap':\n                borderLineArray = [0.5, 0.5, 1, 0.5, 0.5];\n                break;\n            case 'ThinThickThinLargeGap':\n                borderLineArray = [-0.75, 1, -1.5, 1, -0.75];\n                break;\n            case 'Emboss3D':\n            case 'Engrave3D':\n                borderLineArray = [0.25, 0, 1, 0, 0.25];\n                break;\n        }\n        if (borderLineArray.length === 1) {\n            return [lineWidth];\n        }\n        for (var i = 0; i < borderLineArray.length; i++) {\n            if (borderLineArray[i] >= 0) {\n                borderLineArray[i] = borderLineArray[i] * lineWidth;\n            }\n            else {\n                borderLineArray[i] = Math.abs(borderLineArray[i]);\n            }\n        }\n        return borderLineArray;\n    };\n    WBorder.prototype.getBorderWeight = function () {\n        var weight = 0;\n        var numberOfLines = this.getNumberOfLines();\n        var borderNumber = this.getBorderNumber();\n        switch (this.lineStyle) {\n            case 'Single':\n            case 'DashSmallGap':\n            case 'DashDot':\n            case 'DashDotDot':\n            case 'Double':\n            case 'Triple':\n            case 'ThinThickSmallGap':\n            case 'ThickThinSmallGap':\n            case 'ThinThickThinSmallGap':\n            case 'ThinThickMediumGap':\n            case 'ThickThinMediumGap':\n            case 'ThinThickThinMediumGap':\n            case 'ThinThickLargeGap':\n            case 'ThickThinLargeGap':\n            case 'ThinThickThinLargeGap':\n            case 'SingleWavy':\n            case 'DoubleWavy':\n            case 'DashDotStroked':\n            case 'Emboss3D':\n            case 'Engrave3D':\n            case 'Outset':\n            case 'Inset':\n            case 'Thick':\n                weight = numberOfLines * borderNumber;\n                break;\n            case 'Dot':\n            case 'DashLargeGap':\n                weight = 1;\n                break;\n        }\n        return weight;\n    };\n    WBorder.prototype.getBorderNumber = function () {\n        var borderNumber = 0;\n        switch (this.lineStyle) {\n            case 'Single':\n                borderNumber = 1;\n                break;\n            case 'Thick':\n                borderNumber = 2;\n                break;\n            case 'Double':\n                borderNumber = 3;\n                break;\n            case 'Dot':\n                borderNumber = 4;\n                break;\n            case 'DashLargeGap': //dashed.\n                borderNumber = 5;\n                break;\n            case 'DashDot':\n                borderNumber = 6;\n                break;\n            case 'DashDotDot':\n                borderNumber = 7;\n                break;\n            case 'Triple':\n                borderNumber = 8;\n                break;\n            case 'ThinThickSmallGap':\n                borderNumber = 9;\n                break;\n            case 'ThickThinSmallGap':\n                borderNumber = 10;\n                break;\n            case 'ThinThickThinSmallGap':\n                borderNumber = 11;\n                break;\n            case 'ThinThickMediumGap':\n                borderNumber = 12;\n                break;\n            case 'ThickThinMediumGap':\n                borderNumber = 13;\n                break;\n            case 'ThinThickThinMediumGap':\n                borderNumber = 14;\n                break;\n            case 'ThinThickLargeGap':\n                borderNumber = 15;\n                break;\n            case 'ThickThinLargeGap':\n                borderNumber = 16;\n                break;\n            case 'ThinThickThinLargeGap':\n                borderNumber = 17;\n                break;\n            case 'SingleWavy': //wave.\n                borderNumber = 18;\n                break;\n            case 'DoubleWavy':\n                borderNumber = 19;\n                break;\n            case 'DashSmallGap':\n                borderNumber = 20;\n                break;\n            case 'DashDotStroked':\n                borderNumber = 21;\n                break;\n            case 'Emboss3D':\n                borderNumber = 22;\n                break;\n            case 'Engrave3D':\n                borderNumber = 23;\n                break;\n            case 'Outset':\n                borderNumber = 24;\n                break;\n            case 'Inset':\n                borderNumber = 25;\n                break;\n        }\n        return borderNumber;\n    };\n    WBorder.prototype.getNumberOfLines = function () {\n        //ToDo: Need to analyze more on this.\n        var value = 0;\n        switch (this.lineStyle) {\n            case 'Single':\n            case 'Dot':\n            case 'DashSmallGap':\n            case 'DashLargeGap':\n            case 'DashDot':\n            case 'DashDotDot':\n                value = 1;\n                break;\n            case 'Double':\n                value = 3;\n                break;\n            case 'Triple':\n                value = 5;\n                break;\n            case 'ThinThickSmallGap':\n                value = 3;\n                break;\n            case 'ThickThinSmallGap':\n                value = 3;\n                break;\n            case 'ThinThickThinSmallGap':\n                value = 5;\n                break;\n            case 'ThinThickMediumGap':\n                value = 3;\n                break;\n            case 'ThickThinMediumGap':\n                value = 3;\n                break;\n            case 'ThinThickThinMediumGap':\n                value = 5;\n                break;\n            case 'ThinThickLargeGap':\n                value = 3;\n                break;\n            case 'ThickThinLargeGap':\n                value = 3;\n                break;\n            case 'ThinThickThinLargeGap':\n                value = 5;\n                break;\n            case 'SingleWavy':\n                value = 1;\n                break;\n            case 'DoubleWavy':\n                value = 2;\n                break;\n            case 'DashDotStroked':\n                value = 1;\n                break;\n            case 'Emboss3D':\n            case 'Engrave3D':\n                value = 3;\n                break;\n            case 'Outset':\n            case 'Inset':\n            case 'Thick':\n                value = 1;\n                break;\n        }\n        return value;\n    };\n    WBorder.prototype.getPrecedence = function () {\n        var value = 0;\n        switch (this.lineStyle) {\n            case 'Single':\n                value = 1;\n                break;\n            case 'Thick':\n                value = 2;\n                break;\n            case 'Double':\n                value = 3;\n                break;\n            case 'Dot':\n                value = 4;\n                break;\n            case 'DashLargeGap': //dashed.\n                value = 5;\n                break;\n            case 'DashDot':\n                value = 6;\n                break;\n            case 'DashDotDot':\n                value = 7;\n                break;\n            case 'Triple':\n                value = 8;\n                break;\n            case 'ThinThickSmallGap':\n                value = 9;\n                break;\n            case 'ThickThinSmallGap':\n                value = 10;\n                break;\n            case 'ThinThickThinSmallGap':\n                value = 11;\n                break;\n            case 'ThinThickMediumGap':\n                value = 12;\n                break;\n            case 'ThickThinMediumGap':\n                value = 13;\n                break;\n            case 'ThinThickThinMediumGap':\n                value = 14;\n                break;\n            case 'ThinThickLargeGap':\n                value = 15;\n                break;\n            case 'ThickThinLargeGap':\n                value = 16;\n                break;\n            case 'ThinThickThinLargeGap':\n                value = 17;\n                break;\n            case 'SingleWavy': //wave.\n                value = 18;\n                break;\n            case 'DoubleWavy':\n                value = 19;\n                break;\n            case 'DashSmallGap':\n                value = 20;\n                break;\n            case 'DashDotStroked':\n                value = 21;\n                break;\n            case 'Emboss3D':\n                value = 22;\n                break;\n            case 'Engrave3D':\n                value = 23;\n                break;\n            case 'Outset':\n                value = 24;\n                break;\n            case 'Inset':\n                value = 25;\n                break;\n        }\n        return value;\n    };\n    WBorder.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueBorderFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueBorderFormat.uniqueFormatType, property);\n            return this.uniqueBorderFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WBorder.prototype.cloneFormat = function () {\n        var border = new WBorder(undefined);\n        border.color = this.color;\n        border.lineStyle = this.lineStyle;\n        border.lineWidth = this.lineWidth;\n        border.shadow = this.shadow;\n        border.space = this.space;\n        return border;\n    };\n    WBorder.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.uniqueBorderFormat)) {\n            WBorder.uniqueBorderFormats.remove(this.uniqueBorderFormat);\n        }\n        this.uniqueBorderFormat = undefined;\n    };\n    WBorder.prototype.copyFormat = function (border) {\n        if (!isNullOrUndefined(border) && !isNullOrUndefined(border.uniqueBorderFormat)) {\n            this.color = border.color;\n            this.lineStyle = border.lineStyle;\n            this.lineWidth = border.lineWidth;\n            this.shadow = border.shadow;\n            this.space = border.space;\n        }\n    };\n    WBorder.clear = function () {\n        this.uniqueBorderFormats.clear();\n    };\n    WBorder.uniqueBorderFormats = new WUniqueFormats();\n    WBorder.uniqueFormatType = 1;\n    return WBorder;\n}());\nexport { WBorder };\n","import { WBorder } from './border';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WBorders = /** @class */ (function () {\n    function WBorders(node) {\n        this.leftIn = new WBorder(this);\n        this.rightIn = new WBorder(this);\n        this.topIn = new WBorder(this);\n        this.bottomIn = new WBorder(this);\n        this.horizontalIn = new WBorder(this);\n        this.verticalIn = new WBorder(this);\n        this.diagonalUpIn = new WBorder(this);\n        this.diagonalDownIn = new WBorder(this);\n        this.lineWidthIn = 0;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WBorders.prototype, \"left\", {\n        get: function () {\n            return this.leftIn;\n        },\n        set: function (value) {\n            this.leftIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"right\", {\n        get: function () {\n            return this.rightIn;\n        },\n        set: function (value) {\n            this.rightIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"top\", {\n        get: function () {\n            return this.topIn;\n        },\n        set: function (value) {\n            this.topIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"bottom\", {\n        get: function () {\n            return this.bottomIn;\n        },\n        set: function (value) {\n            this.bottomIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"horizontal\", {\n        get: function () {\n            return this.horizontalIn;\n        },\n        set: function (value) {\n            this.horizontalIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"vertical\", {\n        get: function () {\n            return this.verticalIn;\n        },\n        set: function (value) {\n            this.verticalIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"diagonalUp\", {\n        get: function () {\n            return this.diagonalUpIn;\n        },\n        set: function (value) {\n            this.diagonalUpIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"diagonalDown\", {\n        get: function () {\n            return this.diagonalDownIn;\n        },\n        set: function (value) {\n            this.diagonalDownIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WBorders.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.left)) {\n            this.left.destroy();\n        }\n        if (!isNullOrUndefined(this.top)) {\n            this.top.destroy();\n        }\n        if (!isNullOrUndefined(this.bottom)) {\n            this.bottom.destroy();\n        }\n        if (!isNullOrUndefined(this.right)) {\n            this.right.destroy();\n        }\n        if (!isNullOrUndefined(this.horizontal)) {\n            this.horizontal.destroy();\n        }\n        if (!isNullOrUndefined(this.vertical)) {\n            this.vertical.destroy();\n        }\n        if (!isNullOrUndefined(this.diagonalDown)) {\n            this.diagonalDown.destroy();\n        }\n        if (!isNullOrUndefined(this.diagonalUp)) {\n            this.diagonalUp.destroy();\n        }\n        this.topIn = undefined;\n        this.bottomIn = undefined;\n        this.leftIn = undefined;\n        this.rightIn = undefined;\n        this.horizontalIn = undefined;\n        this.verticalIn = undefined;\n        this.diagonalDownIn = undefined;\n        this.diagonalUpIn = undefined;\n        this.lineWidthIn = undefined;\n        this.valueIn = undefined;\n    };\n    WBorders.prototype.cloneFormat = function () {\n        var borders = new WBorders(undefined);\n        borders.top = isNullOrUndefined(this.top) ? undefined : this.top.cloneFormat();\n        borders.bottom = isNullOrUndefined(this.bottom) ? undefined : this.bottom.cloneFormat();\n        borders.left = isNullOrUndefined(this.left) ? undefined : this.left.cloneFormat();\n        borders.right = isNullOrUndefined(this.right) ? undefined : this.right.cloneFormat();\n        borders.horizontal = isNullOrUndefined(this.horizontal) ? undefined : this.horizontal.cloneFormat();\n        borders.vertical = isNullOrUndefined(this.vertical) ? undefined : this.vertical.cloneFormat();\n        borders.diagonalUp = isNullOrUndefined(this.diagonalUp) ? undefined : this.diagonalUp.cloneFormat();\n        borders.diagonalDown = isNullOrUndefined(this.diagonalDown) ? undefined : this.diagonalDown.cloneFormat();\n        return borders;\n    };\n    WBorders.prototype.copyFormat = function (borders) {\n        if (!isNullOrUndefined(borders.left) && borders.left instanceof WBorder) {\n            this.left = new WBorder(this);\n            this.left.copyFormat(borders.left);\n        }\n        if (!isNullOrUndefined(borders.right) && borders.right instanceof WBorder) {\n            this.right = new WBorder(this);\n            this.right.copyFormat(borders.right);\n        }\n        if (!isNullOrUndefined(borders.top) && borders.top instanceof WBorder) {\n            this.top = new WBorder(this);\n            this.top.copyFormat(borders.top);\n        }\n        if (!isNullOrUndefined(borders.bottom) && borders.bottom instanceof WBorder) {\n            this.bottom = new WBorder(this);\n            this.bottom.copyFormat(borders.bottom);\n        }\n        if (!isNullOrUndefined(borders.horizontal) && borders.horizontal instanceof WBorder) {\n            this.horizontal = new WBorder(this);\n            this.horizontal.copyFormat(borders.horizontal);\n        }\n        if (!isNullOrUndefined(borders.vertical) && borders.vertical instanceof WBorder) {\n            this.vertical = new WBorder(this);\n            this.vertical.copyFormat(borders.vertical);\n        }\n        if (!isNullOrUndefined(borders.diagonalDown) && borders.diagonalDown instanceof WBorder) {\n            this.diagonalDown = new WBorder(this);\n            this.diagonalDown.copyFormat(borders.diagonalDown);\n        }\n        if (!isNullOrUndefined(borders.diagonalUp) && borders.diagonalUp instanceof WBorder) {\n            this.diagonalUp = new WBorder(this);\n            this.diagonalUp.copyFormat(borders.diagonalUp);\n        }\n    };\n    return WBorders;\n}());\nexport { WBorders };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WBorders } from './borders';\nimport { WShading } from './shading';\n/**\n * @private\n */\nvar WCellFormat = /** @class */ (function () {\n    function WCellFormat(node) {\n        this.uniqueCellFormat = undefined;\n        this.borders = new WBorders(this);\n        this.shading = new WShading(this);\n        this.ownerBase = node;\n        this.borders = new WBorders(this);\n        this.shading = new WShading(this);\n    }\n    Object.defineProperty(WCellFormat.prototype, \"leftMargin\", {\n        get: function () {\n            return this.getPropertyValue('leftMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"rightMargin\", {\n        get: function () {\n            return this.getPropertyValue('rightMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"topMargin\", {\n        get: function () {\n            return this.getPropertyValue('topMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('topMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"bottomMargin\", {\n        get: function () {\n            return this.getPropertyValue('bottomMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('bottomMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"cellWidth\", {\n        get: function () {\n            return this.getPropertyValue('cellWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('cellWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"columnSpan\", {\n        get: function () {\n            return this.getPropertyValue('columnSpan');\n        },\n        set: function (value) {\n            this.setPropertyValue('columnSpan', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"rowSpan\", {\n        get: function () {\n            return this.getPropertyValue('rowSpan');\n        },\n        set: function (value) {\n            this.setPropertyValue('rowSpan', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"preferredWidth\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"verticalAlignment\", {\n        get: function () {\n            return this.getPropertyValue('verticalAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('verticalAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"preferredWidthType\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WCellFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WCellFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueCellFormat) && this.uniqueCellFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueCellFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WCellFormat.getPropertyDefaultValue(property);\n    };\n    WCellFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WCellFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueCellFormat)) {\n            this.initializeUniqueCellFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCellFormat.uniqueFormatType, property);\n            if (this.uniqueCellFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueCellFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueCellFormat = WCellFormat.uniqueCellFormats.updateUniqueFormat(this.uniqueCellFormat, property, value);\n        }\n    };\n    WCellFormat.prototype.initializeUniqueCellFormat = function (property, propValue) {\n        var uniqueCellFormatTemp = new Dictionary();\n        this.addUniqueCellFormat('leftMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('topMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('bottomMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('rightMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('cellWidth', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('columnSpan', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('rowSpan', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('preferredWidth', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('verticalAlignment', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('preferredWidthType', property, propValue, uniqueCellFormatTemp);\n        this.uniqueCellFormat = WCellFormat.uniqueCellFormats.addUniqueFormat(uniqueCellFormatTemp, WCellFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WCellFormat.prototype.addUniqueCellFormat = function (property, modifiedProperty, propValue, uniqueCellFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WCellFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueCellFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WCellFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'leftMargin':\n                value = undefined;\n                break;\n            case 'topMargin':\n                value = undefined;\n                break;\n            case 'bottomMargin':\n                value = undefined;\n                break;\n            case 'rightMargin':\n                value = undefined;\n                break;\n            case 'cellWidth':\n                value = 0;\n                break;\n            case 'columnSpan':\n                value = 1;\n                break;\n            case 'rowSpan':\n                value = 1;\n                break;\n            case 'preferredWidth':\n                value = 0;\n                break;\n            case 'verticalAlignment':\n                value = 'Top';\n                break;\n            case 'preferredWidthType':\n                value = 'Point';\n                break;\n        }\n        return value;\n    };\n    WCellFormat.prototype.containsMargins = function () {\n        return (!isNullOrUndefined(this.leftMargin)\n            || !isNullOrUndefined(this.rightMargin)\n            || !isNullOrUndefined(this.bottomMargin)\n            || !isNullOrUndefined(this.topMargin));\n    };\n    WCellFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.borders)) {\n            this.borders.destroy();\n        }\n        if (!isNullOrUndefined(this.shading)) {\n            this.shading.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueCellFormat)) {\n            WCellFormat.uniqueCellFormats.remove(this.uniqueCellFormat);\n        }\n        this.uniqueCellFormat = undefined;\n        this.borders = undefined;\n        this.shading = undefined;\n    };\n    WCellFormat.prototype.cloneFormat = function () {\n        var format = new WCellFormat(undefined);\n        format.verticalAlignment = this.verticalAlignment;\n        format.leftMargin = this.leftMargin;\n        format.rightMargin = this.rightMargin;\n        format.topMargin = this.topMargin;\n        format.bottomMargin = this.bottomMargin;\n        format.preferredWidth = this.preferredWidth;\n        format.preferredWidthType = this.preferredWidthType;\n        format.cellWidth = this.cellWidth;\n        format.borders = isNullOrUndefined(this.borders) ? undefined : this.borders.cloneFormat();\n        format.shading = isNullOrUndefined(this.shading) ? undefined : this.shading.cloneFormat();\n        return format;\n    };\n    WCellFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueCellFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCellFormat.uniqueFormatType, property);\n            return this.uniqueCellFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WCellFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueCellFormat)) {\n                this.cellWidth = format.cellWidth;\n                this.leftMargin = format.leftMargin;\n                this.topMargin = format.topMargin;\n                this.rightMargin = format.rightMargin;\n                this.bottomMargin = format.bottomMargin;\n                this.preferredWidth = format.preferredWidth;\n                this.columnSpan = format.columnSpan;\n                this.rowSpan = format.rowSpan;\n                this.preferredWidthType = format.preferredWidthType;\n                this.verticalAlignment = format.verticalAlignment;\n            }\n            if (!isNullOrUndefined(format.shading)) {\n                this.shading = new WShading(this);\n                this.shading.copyFormat(format.shading);\n            }\n            if (!isNullOrUndefined(format.borders)) {\n                this.borders = new WBorders(this);\n                this.borders.copyFormat(format.borders);\n            }\n        }\n    };\n    WCellFormat.clear = function () {\n        this.uniqueCellFormats.clear();\n    };\n    WCellFormat.uniqueCellFormats = new WUniqueFormats();\n    WCellFormat.uniqueFormatType = 4;\n    return WCellFormat;\n}());\nexport { WCellFormat };\n","import { ParagraphWidget } from '../viewer/page';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WParagraphStyle } from './style';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WCharacterFormat = /** @class */ (function () {\n    function WCharacterFormat(node) {\n        this.uniqueCharacterFormat = undefined;\n        this.ownerBase = undefined;\n        this.baseCharStyle = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WCharacterFormat.prototype, \"bold\", {\n        get: function () {\n            return this.getPropertyValue('bold');\n        },\n        set: function (value) {\n            this.setPropertyValue('bold', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"italic\", {\n        get: function () {\n            return this.getPropertyValue('italic');\n        },\n        set: function (value) {\n            this.setPropertyValue('italic', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontSize\", {\n        get: function () {\n            return this.getPropertyValue('fontSize');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontSize', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontFamily\", {\n        get: function () {\n            return this.getPropertyValue('fontFamily');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontFamily', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"underline\", {\n        get: function () {\n            return this.getPropertyValue('underline');\n        },\n        set: function (value) {\n            this.setPropertyValue('underline', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"strikethrough\", {\n        get: function () {\n            return this.getPropertyValue('strikethrough');\n        },\n        set: function (value) {\n            this.setPropertyValue('strikethrough', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"baselineAlignment\", {\n        get: function () {\n            return this.getPropertyValue('baselineAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('baselineAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"highlightColor\", {\n        get: function () {\n            return this.getPropertyValue('highlightColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('highlightColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontColor\", {\n        get: function () {\n            return this.getPropertyValue('fontColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"bidi\", {\n        get: function () {\n            return this.getPropertyValue('bidi');\n        },\n        set: function (value) {\n            this.setPropertyValue('bidi', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"bdo\", {\n        get: function () {\n            return this.getPropertyValue('bdo');\n        },\n        set: function (value) {\n            this.setPropertyValue('bdo', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"boldBidi\", {\n        get: function () {\n            return this.getPropertyValue('boldBidi');\n        },\n        set: function (value) {\n            this.setPropertyValue('boldBidi', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"italicBidi\", {\n        get: function () {\n            return this.getPropertyValue('italicBidi');\n        },\n        set: function (value) {\n            this.setPropertyValue('italicBidi', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontSizeBidi\", {\n        get: function () {\n            return this.getPropertyValue('fontSizeBidi');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontSizeBidi', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontFamilyBidi\", {\n        get: function () {\n            return this.getPropertyValue('fontFamilyBidi');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontFamilyBidi', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WCharacterFormat.prototype.getPropertyValue = function (property) {\n        if (!this.hasValue(property)) {\n            var charStyleValue = this.checkCharacterStyle(property);\n            if (!isNullOrUndefined(charStyleValue)) {\n                return charStyleValue;\n            }\n            else {\n                var baseStyleValue = this.checkBaseStyle(property);\n                if (!isNullOrUndefined(baseStyleValue)) {\n                    return baseStyleValue;\n                }\n            }\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueCharacterFormat) && this.uniqueCharacterFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueCharacterFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return this.getDefaultValue(property);\n    };\n    WCharacterFormat.prototype.getDefaultValue = function (property) {\n        var propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n        var docCharacterFormat = this.documentCharacterFormat();\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(docCharacterFormat) && !isNullOrUndefined(docCharacterFormat.uniqueCharacterFormat) && docCharacterFormat.uniqueCharacterFormat.propertiesHash.containsKey(propertyType)) {\n            return docCharacterFormat.uniqueCharacterFormat.propertiesHash.get(propertyType);\n        }\n        else {\n            return WCharacterFormat.getPropertyDefaultValue(property);\n        }\n    };\n    WCharacterFormat.prototype.documentCharacterFormat = function () {\n        var docCharacterFormat;\n        if (!isNullOrUndefined(this.ownerBase)) {\n            if (!isNullOrUndefined(this.ownerBase.paragraph)) {\n                docCharacterFormat = this.ownerBase.paragraph.bodyWidget.page.viewer.characterFormat;\n            }\n            else {\n                if (!isNullOrUndefined(this.ownerBase.bodyWidget)) {\n                    docCharacterFormat = this.ownerBase.bodyWidget.page.viewer.characterFormat;\n                }\n            }\n        }\n        return docCharacterFormat;\n    };\n    WCharacterFormat.prototype.checkBaseStyle = function (property) {\n        /* tslint:disable-next-line:no-any */\n        var baseStyle;\n        if (!isNullOrUndefined(this.ownerBase)) {\n            if (!isNullOrUndefined(this.ownerBase.paragraph)) {\n                baseStyle = this.ownerBase.paragraph.paragraphFormat.baseStyle;\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                if ((this.ownerBase instanceof ParagraphWidget) && !isNullOrUndefined(this.ownerBase.paragraphFormat)) {\n                    baseStyle = this.ownerBase.paragraphFormat.baseStyle;\n                }\n                else {\n                    if (!isNullOrUndefined(this.ownerBase instanceof WParagraphStyle)) {\n                        baseStyle = this.ownerBase.basedOn;\n                    }\n                }\n            }\n        }\n        while (!isNullOrUndefined(baseStyle)) {\n            if (baseStyle.characterFormat.hasValue(property)) {\n                break;\n            }\n            else {\n                baseStyle = baseStyle.basedOn;\n            }\n        }\n        if (!isNullOrUndefined(baseStyle)) {\n            var propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n            return baseStyle.characterFormat.uniqueCharacterFormat.propertiesHash.get(propertyType);\n        }\n        return undefined;\n    };\n    WCharacterFormat.prototype.checkCharacterStyle = function (property) {\n        /* tslint:disable-next-line:no-any */\n        var baseStyle = this.baseCharStyle;\n        if (!isNullOrUndefined(baseStyle)) {\n            while (!isNullOrUndefined(baseStyle) && baseStyle.name !== 'Default Paragraph Font') {\n                var hasKey = baseStyle.characterFormat.hasValue(property);\n                if (hasKey) {\n                    var returnPropertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n                    return baseStyle.characterFormat.uniqueCharacterFormat.propertiesHash.get(returnPropertyType);\n                }\n                else {\n                    baseStyle = baseStyle.basedOn;\n                }\n            }\n        }\n        return undefined;\n    };\n    WCharacterFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WCharacterFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueCharacterFormat)) {\n            this.initializeUniqueCharacterFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType, property);\n            if (this.uniqueCharacterFormat.propertiesHash.containsKey(propertyType) &&\n                // tslint:disable-next-line:max-line-length\n                this.uniqueCharacterFormat.propertiesHash.get(propertyType) === value) { //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueCharacterFormat = WCharacterFormat.uniqueCharacterFormats.updateUniqueFormat(this.uniqueCharacterFormat, property, value);\n        }\n    };\n    WCharacterFormat.prototype.initializeUniqueCharacterFormat = function (property, propValue) {\n        var uniqueCharFormatTemp = new Dictionary();\n        this.addUniqueCharacterFormat('fontColor', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('fontFamily', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('fontSize', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('bold', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('italic', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('underline', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('strikethrough', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('baselineAlignment', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('highlightColor', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('styleName', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('bidi', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('bdo', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('fontFamilyBidi', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('fontSizeBidi', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('boldBidi', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('italicBidi', property, propValue, uniqueCharFormatTemp);\n        // tslint:disable-next-line:max-line-length\n        this.uniqueCharacterFormat = WCharacterFormat.uniqueCharacterFormats.addUniqueFormat(uniqueCharFormatTemp, WCharacterFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WCharacterFormat.prototype.addUniqueCharacterFormat = function (property, modifiedProperty, propValue, uniqueCharFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueCharFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WCharacterFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'bold':\n                value = false;\n                break;\n            case 'italic':\n                value = false;\n                break;\n            case 'fontSize':\n                value = 11;\n                break;\n            case 'underline':\n                value = 'None';\n                break;\n            case 'strikethrough':\n                value = 'None';\n                break;\n            case 'baselineAlignment':\n                value = 'Normal';\n                break;\n            case 'highlightColor':\n                value = 'NoColor';\n                break;\n            case 'fontColor':\n                value = '#000000';\n                break;\n            case 'fontFamily':\n                value = 'Calibri';\n                break;\n            case 'styleName':\n                value = 'Default Paragraph Font';\n                break;\n            case 'bidi':\n                value = false;\n                break;\n            case 'bdo':\n                value = 'None';\n                break;\n            case 'boldBidi':\n                value = false;\n                break;\n            case 'italicBidi':\n                value = false;\n                break;\n            case 'fontSizeBidi':\n                value = 11;\n                break;\n            case 'fontFamilyBidi':\n                value = 'Calibri';\n                break;\n        }\n        return value;\n    };\n    WCharacterFormat.prototype.isEqualFormat = function (format) {\n        return (this.fontSize === format.fontSize\n            && this.fontFamily === format.fontFamily\n            && this.bold === format.bold\n            && this.italic === format.italic\n            && this.baselineAlignment === format.baselineAlignment\n            && this.underline === format.underline\n            && this.fontColor === format.fontColor\n            && this.strikethrough === format.strikethrough\n            && this.highlightColor === format.highlightColor && this.bidi === format.bidi\n            && this.bdo === format.bdo);\n    };\n    WCharacterFormat.prototype.isSameFormat = function (format) {\n        return this.baseCharStyle === format.baseCharStyle &&\n            this.uniqueCharacterFormat === format.uniqueCharacterFormat;\n    };\n    WCharacterFormat.prototype.cloneFormat = function () {\n        var format = new WCharacterFormat(undefined);\n        format.uniqueCharacterFormat = this.uniqueCharacterFormat;\n        format.baseCharStyle = this.baseCharStyle;\n        return format;\n    };\n    WCharacterFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueCharacterFormat) && !isNullOrUndefined(this.uniqueCharacterFormat.propertiesHash)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType, property);\n            return this.uniqueCharacterFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WCharacterFormat.prototype.clearFormat = function () {\n        if (!isNullOrUndefined(this.uniqueCharacterFormat) && this.uniqueCharacterFormat.referenceCount === 0) {\n            WCharacterFormat.uniqueCharacterFormats.remove(this.uniqueCharacterFormat);\n        }\n        this.uniqueCharacterFormat = undefined;\n        this.baseCharStyle = undefined;\n    };\n    WCharacterFormat.prototype.destroy = function () {\n        this.clearFormat();\n    };\n    WCharacterFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueCharacterFormat) && format.uniqueCharacterFormat.propertiesHash) {\n                this.updateUniqueCharacterFormat(format);\n            }\n            if (!isNullOrUndefined(format.baseCharStyle)) {\n                this.baseCharStyle = format.baseCharStyle;\n            }\n        }\n    };\n    WCharacterFormat.prototype.updateUniqueCharacterFormat = function (format) {\n        var hash = undefined;\n        if (this.uniqueCharacterFormat) {\n            hash = this.uniqueCharacterFormat.mergeProperties(format.uniqueCharacterFormat);\n            if (this.uniqueCharacterFormat.referenceCount === 0) {\n                WCharacterFormat.uniqueCharacterFormats.remove(this.uniqueCharacterFormat);\n                this.uniqueCharacterFormat = undefined;\n            }\n        }\n        this.uniqueCharacterFormat = new WUniqueFormat(WCharacterFormat.uniqueFormatType);\n        if (isNullOrUndefined(hash)) {\n            hash = this.uniqueCharacterFormat.mergeProperties(format.uniqueCharacterFormat);\n        }\n        this.uniqueCharacterFormat = WCharacterFormat.uniqueCharacterFormats.addUniqueFormat(hash, WCharacterFormat.uniqueFormatType);\n    };\n    WCharacterFormat.clear = function () {\n        this.uniqueCharacterFormats.clear();\n    };\n    WCharacterFormat.prototype.ApplyStyle = function (baseCharStyle) {\n        this.baseCharStyle = baseCharStyle;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WCharacterFormat.prototype.getValue = function (property) {\n        return this.hasValue(property) ? this.getPropertyValue(property) : undefined;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WCharacterFormat.prototype.mergeFormat = function (format) {\n        if (isNullOrUndefined(this.getValue('bold'))) {\n            this.bold = format.getValue('bold');\n        }\n        if (isNullOrUndefined(this.getValue('italic'))) {\n            this.italic = format.getValue('italic');\n        }\n        if (isNullOrUndefined(this.getValue('fontSize'))) {\n            this.fontSize = format.getValue('fontSize');\n        }\n        if (isNullOrUndefined(this.getValue('fontFamily'))) {\n            this.fontFamily = format.getValue('fontFamily');\n        }\n        if (isNullOrUndefined(this.getValue('underline'))) {\n            this.underline = format.getValue('underline');\n        }\n        if (isNullOrUndefined(this.getValue('strikethrough'))) {\n            this.strikethrough = format.getValue('strikethrough');\n        }\n        if (isNullOrUndefined(this.getValue('baselineAlignment'))) {\n            this.baselineAlignment = format.getValue('baselineAlignment');\n        }\n        if (isNullOrUndefined(this.getValue('highlightColor'))) {\n            this.highlightColor = format.getValue('highlightColor');\n        }\n        if (isNullOrUndefined(this.getValue('fontColor'))) {\n            this.fontColor = format.getValue('fontColor');\n        }\n        if (isNullOrUndefined(this.getValue('bidi'))) {\n            this.bidi = format.getValue('bidi');\n        }\n        if (isNullOrUndefined(this.getValue('bdo'))) {\n            this.bdo = format.getValue('bdo');\n        }\n    };\n    WCharacterFormat.uniqueCharacterFormats = new WUniqueFormats();\n    WCharacterFormat.uniqueFormatType = 2;\n    return WCharacterFormat;\n}());\nexport { WCharacterFormat };\n","/**\n * Formats Modules\n */\nexport * from './section-format';\nexport * from './style';\nexport * from './character-format';\nexport * from './list-format';\nexport * from './paragraph-format';\nexport * from './table-format';\nexport * from './row-format';\nexport * from './cell-format';\nexport * from './border';\nexport * from './borders';\nexport * from './shading';\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WParagraphStyle } from './style';\nimport { WList } from '../list/list';\n/**\n * @private\n */\nvar WListFormat = /** @class */ (function () {\n    function WListFormat(node) {\n        this.uniqueListFormat = undefined;\n        this.ownerBase = undefined;\n        this.baseStyle = undefined;\n        this.list = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WListFormat.prototype, \"listId\", {\n        get: function () {\n            return this.getPropertyValue('listId');\n        },\n        set: function (listId) {\n            this.setPropertyValue('listId', listId);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListFormat.prototype, \"listLevelNumber\", {\n        get: function () {\n            return this.getPropertyValue('listLevelNumber');\n        },\n        set: function (value) {\n            this.setPropertyValue('listLevelNumber', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListFormat.prototype, \"listLevel\", {\n        get: function () {\n            var list = undefined;\n            if (!isNullOrUndefined(this.list)) {\n                list = this.list;\n            }\n            else {\n                /* tslint:disable-next-line:no-any */\n                var baseListStyle = this.baseStyle;\n                while (!isNullOrUndefined(baseListStyle)) {\n                    if (baseListStyle.paragraphFormat.listFormat.list) {\n                        list = baseListStyle.paragraphFormat.listFormat.list;\n                        break;\n                    }\n                    else {\n                        baseListStyle = baseListStyle.basedOn;\n                    }\n                }\n            }\n            if (!isNullOrUndefined(list)) {\n                return list.getListLevel(this.listLevelNumber);\n            }\n            else {\n                return undefined;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WListFormat.prototype.getPropertyValue = function (property) {\n        if (!this.hasValue(property)) {\n            if (this.baseStyle instanceof WParagraphStyle) {\n                /* tslint:disable-next-line:no-any */\n                var baseStyle = this.baseStyle;\n                while (!isNullOrUndefined(baseStyle)) {\n                    if (baseStyle.paragraphFormat.listFormat.hasValue(property)) {\n                        break;\n                    }\n                    else {\n                        baseStyle = baseStyle.basedOn;\n                    }\n                }\n                if (!isNullOrUndefined(baseStyle)) {\n                    var propertyType = WUniqueFormat.getPropertyType(WListFormat.uniqueFormatType, property);\n                    return baseStyle.paragraphFormat.listFormat.uniqueListFormat.propertiesHash.get(propertyType);\n                }\n            }\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(WListFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueListFormat) && this.uniqueListFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueListFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WListFormat.getPropertyDefaultValue(property);\n    };\n    WListFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WListFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueListFormat)) {\n            this.initializeUniqueListFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueListFormat.uniqueFormatType, property);\n            if (this.uniqueListFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueListFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueListFormat = WListFormat.uniqueListFormats.updateUniqueFormat(this.uniqueListFormat, property, value);\n        }\n    };\n    WListFormat.prototype.initializeUniqueListFormat = function (property, propValue) {\n        var uniqueListFormatTemp = new Dictionary();\n        this.addUniqueListFormat('listId', property, propValue, uniqueListFormatTemp);\n        this.addUniqueListFormat('listLevelNumber', property, propValue, uniqueListFormatTemp);\n        this.uniqueListFormat = WListFormat.uniqueListFormats.addUniqueFormat(uniqueListFormatTemp, WListFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WListFormat.prototype.addUniqueListFormat = function (property, modifiedProperty, propValue, uniqueListFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WListFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueListFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WListFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'listId':\n                value = -1;\n                break;\n            case 'listLevelNumber':\n                value = 0;\n                break;\n        }\n        return value;\n    };\n    WListFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueListFormat)) {\n                this.listId = format.listId;\n                this.listLevelNumber = format.listLevelNumber;\n            }\n            if (!isNullOrUndefined(format.baseStyle)) {\n                this.baseStyle = format.baseStyle;\n            }\n            if (!isNullOrUndefined(format.list)) {\n                this.list = format.list;\n            }\n        }\n    };\n    WListFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueListFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueListFormat.uniqueFormatType, property);\n            return this.uniqueListFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WListFormat.prototype.clearFormat = function () {\n        if (!isNullOrUndefined(this.uniqueListFormat) && this.uniqueListFormat.referenceCount === 0) {\n            WListFormat.uniqueListFormats.remove(this.uniqueListFormat);\n        }\n        this.uniqueListFormat = undefined;\n        this.list = undefined;\n    };\n    WListFormat.prototype.destroy = function () {\n        this.clearFormat();\n    };\n    WListFormat.clear = function () {\n        this.uniqueListFormats.clear();\n    };\n    WListFormat.prototype.ApplyStyle = function (baseStyle) {\n        this.baseStyle = baseStyle;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WListFormat.prototype.getValue = function (property) {\n        return this.hasValue(property) ? this.getPropertyValue(property) : undefined;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WListFormat.prototype.mergeFormat = function (format) {\n        if (isNullOrUndefined(this.getValue('listId'))) {\n            this.listId = format.getValue('listId');\n        }\n        if (isNullOrUndefined(this.getValue('listLevelNumber'))) {\n            this.listLevelNumber = format.getValue('listLevelNumber');\n        }\n        if (!isNullOrUndefined(format.list)) {\n            if (isNullOrUndefined(this.list)) {\n                this.list = new WList();\n            }\n            this.list.mergeList(format.list);\n        }\n    };\n    WListFormat.uniqueListFormats = new WUniqueFormats();\n    WListFormat.uniqueFormatType = 7;\n    return WListFormat;\n}());\nexport { WListFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WListFormat } from './list-format';\nimport { ParagraphWidget, BodyWidget } from '../viewer/page';\nimport { WParagraphStyle } from './style';\n/**\n * @private\n */\nvar WTabStop = /** @class */ (function () {\n    function WTabStop() {\n    }\n    Object.defineProperty(WTabStop.prototype, \"position\", {\n        get: function () {\n            return this.positionIn;\n        },\n        set: function (value) {\n            this.positionIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTabStop.prototype, \"deletePosition\", {\n        get: function () {\n            return this.deletePositionIn;\n        },\n        set: function (value) {\n            this.deletePositionIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTabStop.prototype, \"tabJustification\", {\n        get: function () {\n            return this.justification;\n        },\n        set: function (value) {\n            this.justification = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTabStop.prototype, \"tabLeader\", {\n        get: function () {\n            return this.leader;\n        },\n        set: function (value) {\n            this.leader = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WTabStop.prototype.destroy = function () {\n        this.position = undefined;\n        this.deletePosition = undefined;\n        this.tabJustification = undefined;\n        this.leader = undefined;\n    };\n    return WTabStop;\n}());\nexport { WTabStop };\n/**\n * @private\n */\nvar WParagraphFormat = /** @class */ (function () {\n    function WParagraphFormat(node) {\n        this.uniqueParagraphFormat = undefined;\n        this.ownerBase = undefined;\n        this.baseStyle = undefined;\n        this.tabs = undefined;\n        this.ownerBase = node;\n        this.listFormat = new WListFormat(this);\n        this.tabs = [];\n    }\n    WParagraphFormat.prototype.getUpdatedTabs = function () {\n        var inTabs = [];\n        if (!isNullOrUndefined(this.baseStyle)) {\n            /* tslint:disable-next-line:no-any */\n            var baseStyle = this.baseStyle;\n            var tabStops = new Dictionary();\n            while (!isNullOrUndefined(baseStyle)) {\n                for (var _i = 0, _a = baseStyle.paragraphFormat.tabs; _i < _a.length; _i++) {\n                    var tab = _a[_i];\n                    if (!tabStops.containsKey(tab.position)) {\n                        tabStops.add(tab.position, tab);\n                    }\n                }\n                baseStyle = baseStyle.basedOn;\n            }\n            for (var _b = 0, _c = tabStops.keys; _b < _c.length; _b++) {\n                var key = _c[_b];\n                if (!this.hasTabStop(key)) {\n                    inTabs.push(tabStops.get(key));\n                }\n            }\n            inTabs = inTabs.concat(this.tabs.filter(function (a) { return (a.position !== 0 && a.deletePosition === 0); }));\n            inTabs = inTabs.sort(function (a, b) { return a.position - b.position; });\n        }\n        return inTabs;\n    };\n    WParagraphFormat.prototype.hasTabStop = function (position) {\n        for (var i = 0; i < this.tabs.length; i++) {\n            if (this.tabs[i].position === position) {\n                return true;\n            }\n        }\n        return false;\n    };\n    Object.defineProperty(WParagraphFormat.prototype, \"leftIndent\", {\n        get: function () {\n            return this.getPropertyValue('leftIndent');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"rightIndent\", {\n        get: function () {\n            return this.getPropertyValue('rightIndent');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"firstLineIndent\", {\n        get: function () {\n            return this.getPropertyValue('firstLineIndent');\n        },\n        set: function (value) {\n            this.setPropertyValue('firstLineIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"beforeSpacing\", {\n        get: function () {\n            return this.getPropertyValue('beforeSpacing');\n        },\n        set: function (value) {\n            this.setPropertyValue('beforeSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"afterSpacing\", {\n        get: function () {\n            return this.getPropertyValue('afterSpacing');\n        },\n        set: function (value) {\n            this.setPropertyValue('afterSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"lineSpacing\", {\n        get: function () {\n            return this.getPropertyValue('lineSpacing');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"lineSpacingType\", {\n        get: function () {\n            return this.getPropertyValue('lineSpacingType');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineSpacingType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"textAlignment\", {\n        get: function () {\n            return this.getPropertyValue('textAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('textAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"outlineLevel\", {\n        get: function () {\n            return this.getPropertyValue('outlineLevel');\n        },\n        set: function (value) {\n            this.setPropertyValue('outlineLevel', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"bidi\", {\n        get: function () {\n            return this.getPropertyValue('bidi');\n        },\n        set: function (value) {\n            if (this.bidi !== value) {\n                if (this.textAlignment === 'Left') {\n                    this.textAlignment = 'Right';\n                }\n                else if (this.textAlignment === 'Right') {\n                    this.textAlignment = 'Left';\n                }\n            }\n            this.setPropertyValue('bidi', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WParagraphFormat.prototype.getListFormatParagraphFormat = function (property) {\n        if (this.listFormat.listId > -1 && this.listFormat.listLevelNumber > -1) {\n            var level = this.listFormat.listLevel;\n            var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(level) && !isNullOrUndefined(level.paragraphFormat.uniqueParagraphFormat) && level.paragraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(propertyType)) {\n                return level.paragraphFormat.uniqueParagraphFormat.propertiesHash.get(propertyType);\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    WParagraphFormat.prototype.getPropertyValue = function (property) {\n        if (!this.hasValue(property)) {\n            var ifListFormat = this.getListFormatParagraphFormat(property);\n            if (!isNullOrUndefined(ifListFormat)) {\n                return ifListFormat;\n            }\n            else {\n                if (this.baseStyle instanceof WParagraphStyle) {\n                    /* tslint:disable-next-line:no-any */\n                    var baseStyle = this.baseStyle;\n                    while (!isNullOrUndefined(baseStyle)) {\n                        if (baseStyle.paragraphFormat.hasValue(property)) {\n                            break;\n                        }\n                        else {\n                            baseStyle = baseStyle.basedOn;\n                        }\n                    }\n                    if (!isNullOrUndefined(baseStyle)) {\n                        var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n                        return baseStyle.paragraphFormat.uniqueParagraphFormat.propertiesHash.get(propertyType);\n                    }\n                }\n            }\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueParagraphFormat) && this.uniqueParagraphFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueParagraphFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return this.getDefaultValue(property);\n    };\n    WParagraphFormat.prototype.getDefaultValue = function (property) {\n        var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n        var docParagraphFormat = this.documentParagraphFormat();\n        var isInsideBodyWidget = true;\n        if (this.ownerBase && this.ownerBase instanceof ParagraphWidget) {\n            isInsideBodyWidget = this.ownerBase.containerWidget instanceof BodyWidget;\n        }\n        if (isInsideBodyWidget && !isNullOrUndefined(docParagraphFormat) && !isNullOrUndefined(docParagraphFormat.uniqueParagraphFormat) &&\n            docParagraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(propertyType)) {\n            return docParagraphFormat.uniqueParagraphFormat.propertiesHash.get(propertyType);\n        }\n        else {\n            return WParagraphFormat.getPropertyDefaultValue(property);\n        }\n    };\n    WParagraphFormat.prototype.documentParagraphFormat = function () {\n        var docParagraphFormat;\n        if (!isNullOrUndefined(this.ownerBase)) {\n            if (!isNullOrUndefined(this.ownerBase.bodyWidget)) {\n                docParagraphFormat = this.ownerBase.bodyWidget.page.viewer.paragraphFormat;\n            }\n        }\n        return docParagraphFormat;\n    };\n    WParagraphFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WParagraphFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueParagraphFormat)) {\n            this.initializeUniqueParagraphFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType, property);\n            if (this.uniqueParagraphFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueParagraphFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueParagraphFormat = WParagraphFormat.uniqueParagraphFormats.updateUniqueFormat(this.uniqueParagraphFormat, property, value);\n        }\n    };\n    WParagraphFormat.prototype.initializeUniqueParagraphFormat = function (property, propValue) {\n        var uniqueParaFormatTemp = new Dictionary();\n        this.addUniqueParaFormat('leftIndent', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('rightIndent', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('firstLineIndent', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('textAlignment', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('beforeSpacing', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('afterSpacing', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('lineSpacing', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('lineSpacingType', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('outlineLevel', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('bidi', property, propValue, uniqueParaFormatTemp);\n        // tslint:disable-next-line:max-line-length\n        this.uniqueParagraphFormat = WParagraphFormat.uniqueParagraphFormats.addUniqueFormat(uniqueParaFormatTemp, WParagraphFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WParagraphFormat.prototype.addUniqueParaFormat = function (property, modifiedProperty, propValue, uniqueParaFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueParaFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WParagraphFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'leftIndent':\n                value = 0;\n                break;\n            case 'rightIndent':\n                value = 0;\n                break;\n            case 'firstLineIndent':\n                value = 0;\n                break;\n            case 'textAlignment':\n                value = 'Left';\n                break;\n            case 'beforeSpacing':\n                value = 0;\n                break;\n            case 'afterSpacing':\n                value = 0;\n                break;\n            case 'lineSpacing':\n                value = 1;\n                break;\n            case 'lineSpacingType':\n                value = 'Multiple';\n                break;\n            case 'styleName':\n                value = 'Normal';\n                break;\n            case 'outlineLevel':\n                value = 'BodyText';\n                break;\n            case 'bidi':\n                value = false;\n                break;\n        }\n        return value;\n    };\n    WParagraphFormat.prototype.clearFormat = function () {\n        if (!isNullOrUndefined(this.listFormat)) {\n            this.listFormat.clearFormat();\n        }\n        if (!isNullOrUndefined(this.uniqueParagraphFormat) && this.uniqueParagraphFormat.referenceCount === 0) {\n            WParagraphFormat.uniqueParagraphFormats.remove(this.uniqueParagraphFormat);\n        }\n        this.uniqueParagraphFormat = undefined;\n        this.baseStyle = undefined;\n    };\n    WParagraphFormat.prototype.destroy = function () {\n        this.clearFormat();\n        if (!isNullOrUndefined(this.listFormat)) {\n            this.listFormat.destroy();\n        }\n        this.listFormat = undefined;\n        if (this.tabs !== undefined) {\n            for (var i = 0; i < this.tabs.length; i++) {\n                this.tabs[i].destroy();\n            }\n            this.tabs = undefined;\n        }\n    };\n    WParagraphFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueParagraphFormat)) {\n                this.updateUniqueParagraphFormat(format);\n            }\n            if (!isNullOrUndefined(format.listFormat)) {\n                this.listFormat.copyFormat(format.listFormat);\n            }\n            if (!isNullOrUndefined(format.baseStyle)) {\n                this.baseStyle = format.baseStyle;\n            }\n            if (!isNullOrUndefined(format.tabs)) {\n                for (var i = 0; i < format.tabs.length; i++) {\n                    this.tabs[i] = format.tabs[i];\n                }\n            }\n        }\n    };\n    WParagraphFormat.prototype.updateUniqueParagraphFormat = function (format) {\n        var hash = undefined;\n        if (this.uniqueParagraphFormat) {\n            hash = this.uniqueParagraphFormat.mergeProperties(format.uniqueParagraphFormat);\n            if (this.uniqueParagraphFormat.referenceCount === 0) {\n                WParagraphFormat.uniqueParagraphFormats.remove(this.uniqueParagraphFormat);\n                this.uniqueParagraphFormat = undefined;\n            }\n        }\n        this.uniqueParagraphFormat = new WUniqueFormat(WParagraphFormat.uniqueFormatType);\n        if (isNullOrUndefined(hash)) {\n            hash = this.uniqueParagraphFormat.mergeProperties(format.uniqueParagraphFormat);\n        }\n        this.uniqueParagraphFormat = WParagraphFormat.uniqueParagraphFormats.addUniqueFormat(hash, WParagraphFormat.uniqueFormatType);\n    };\n    WParagraphFormat.prototype.cloneFormat = function () {\n        var format = new WParagraphFormat(undefined);\n        format.uniqueParagraphFormat = this.uniqueParagraphFormat;\n        format.baseStyle = this.baseStyle;\n        if (isNullOrUndefined(this.listFormat)) {\n            format.listFormat = undefined;\n        }\n        else {\n            format.listFormat = new WListFormat();\n            format.listFormat.listId = this.listFormat.listId;\n            format.listFormat.listLevelNumber = this.listFormat.listLevelNumber;\n        }\n        return format;\n    };\n    WParagraphFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueParagraphFormat) && !isNullOrUndefined(this.uniqueParagraphFormat.propertiesHash)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType, property);\n            return this.uniqueParagraphFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WParagraphFormat.clear = function () {\n        this.uniqueParagraphFormats.clear();\n    };\n    WParagraphFormat.prototype.ApplyStyle = function (baseStyle) {\n        this.baseStyle = baseStyle;\n        this.listFormat.ApplyStyle(this.baseStyle);\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WParagraphFormat.prototype.getValue = function (property) {\n        return this.hasValue(property) ? this.getPropertyValue(property) : undefined;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WParagraphFormat.prototype.mergeFormat = function (format) {\n        if (isNullOrUndefined(this.getValue('leftIndent'))) {\n            this.leftIndent = format.getValue('leftIndent');\n        }\n        if (isNullOrUndefined(this.getValue('rightIndent'))) {\n            this.rightIndent = format.getValue('rightIndent');\n        }\n        if (isNullOrUndefined(this.getValue('firstLineIndent'))) {\n            this.firstLineIndent = format.getValue('firstLineIndent');\n        }\n        if (isNullOrUndefined(this.getValue('beforeSpacing'))) {\n            this.beforeSpacing = format.getValue('beforeSpacing');\n        }\n        if (isNullOrUndefined(this.getValue('afterSpacing'))) {\n            this.afterSpacing = format.getValue('afterSpacing');\n        }\n        if (isNullOrUndefined(this.getValue('lineSpacing'))) {\n            this.lineSpacing = format.getValue('lineSpacing');\n        }\n        if (isNullOrUndefined(this.getValue('lineSpacingType'))) {\n            this.lineSpacingType = format.getValue('lineSpacingType');\n        }\n        if (isNullOrUndefined(this.getValue('textAlignment'))) {\n            this.textAlignment = format.getValue('textAlignment');\n        }\n        if (isNullOrUndefined(this.getValue('outlineLevel'))) {\n            this.outlineLevel = format.getValue('outlineLevel');\n        }\n        if (isNullOrUndefined(this.getValue('bidi'))) {\n            this.bidi = format.getValue('bidi');\n        }\n        if (isNullOrUndefined(this.listFormat)) {\n            this.listFormat.mergeFormat(format.listFormat);\n        }\n    };\n    WParagraphFormat.uniqueParagraphFormats = new WUniqueFormats();\n    WParagraphFormat.uniqueFormatType = 3;\n    return WParagraphFormat;\n}());\nexport { WParagraphFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WBorders } from './borders';\n/**\n * @private\n */\nvar WRowFormat = /** @class */ (function () {\n    function WRowFormat(node) {\n        this.uniqueRowFormat = undefined;\n        /**\n         * @private\n         */\n        this.borders = new WBorders(this);\n        /**\n         * @private\n         */\n        this.ownerBase = undefined;\n        /**\n         * @private\n         */\n        this.beforeWidth = 0;\n        /**\n         * @private\n         */\n        this.afterWidth = 0;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WRowFormat.prototype, \"gridBefore\", {\n        get: function () {\n            return this.getPropertyValue('gridBefore');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridBefore', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridBeforeWidth\", {\n        get: function () {\n            return this.getPropertyValue('gridBeforeWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridBeforeWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridBeforeWidthType\", {\n        get: function () {\n            return this.getPropertyValue('gridBeforeWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridBeforeWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridAfter\", {\n        get: function () {\n            return this.getPropertyValue('gridAfter');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridAfter', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridAfterWidth\", {\n        get: function () {\n            return this.getPropertyValue('gridAfterWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridAfterWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridAfterWidthType\", {\n        get: function () {\n            return this.getPropertyValue('gridAfterWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridAfterWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"allowBreakAcrossPages\", {\n        get: function () {\n            return this.getPropertyValue('allowBreakAcrossPages');\n        },\n        set: function (value) {\n            this.setPropertyValue('allowBreakAcrossPages', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"isHeader\", {\n        get: function () {\n            return this.getPropertyValue('isHeader');\n        },\n        set: function (value) {\n            this.setPropertyValue('isHeader', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"height\", {\n        get: function () {\n            return this.getPropertyValue('height');\n        },\n        set: function (value) {\n            if (value === 0 && (this.heightType === 'AtLeast' || this.heightType === 'Exactly')) {\n                value = 1;\n            }\n            else if (this.heightType === 'Auto') {\n                value = 0;\n            }\n            this.setPropertyValue('height', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"heightType\", {\n        get: function () {\n            return this.getPropertyValue('heightType');\n        },\n        set: function (value) {\n            if (value === 'AtLeast' || value === 'Exactly') {\n                this.height = 1;\n            }\n            else {\n                this.height = 0;\n            }\n            this.setPropertyValue('heightType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WRowFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WRowFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueRowFormat) && this.uniqueRowFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueRowFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WRowFormat.getPropertyDefaultValue(property);\n    };\n    WRowFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WRowFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueRowFormat)) {\n            this.initializeUniqueRowFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueRowFormat.uniqueFormatType, property);\n            if (this.uniqueRowFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueRowFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueRowFormat = WRowFormat.uniqueRowFormats.updateUniqueFormat(this.uniqueRowFormat, property, value);\n        }\n    };\n    WRowFormat.prototype.initializeUniqueRowFormat = function (property, propValue) {\n        var uniqueRowFormatTemp = new Dictionary();\n        this.addUniqueRowFormat('allowBreakAcrossPages', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('isHeader', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('height', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('heightType', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBefore', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBeforeWidth', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBeforeWidthType', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridAfter', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridAfterWidth', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridgridAfterWidth', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBeforeWidthType', property, propValue, uniqueRowFormatTemp);\n        this.uniqueRowFormat = WRowFormat.uniqueRowFormats.addUniqueFormat(uniqueRowFormatTemp, WRowFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WRowFormat.prototype.addUniqueRowFormat = function (property, modifiedProperty, propValue, uniqueRowFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WRowFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueRowFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WRowFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'allowBreakAcrossPages':\n                value = true;\n                break;\n            case 'isHeader':\n                value = false;\n                break;\n            case 'height':\n                value = 0;\n                break;\n            case 'heightType':\n                value = 'Auto';\n                break;\n            case 'gridBefore':\n                value = 0;\n                break;\n            case 'gridBeforeWidth':\n                value = 0;\n                break;\n            case 'gridBeforeWidthType':\n                value = 'Point';\n                break;\n            case 'gridAfter':\n                value = 0;\n                break;\n            case 'gridAfterWidth':\n                value = 0;\n                break;\n            case 'gridAfterWidthType':\n                value = 'Point';\n                break;\n        }\n        return value;\n    };\n    WRowFormat.prototype.cloneFormat = function () {\n        var format = new WRowFormat();\n        format.allowBreakAcrossPages = this.allowBreakAcrossPages;\n        format.heightType = this.heightType;\n        format.height = this.height;\n        format.isHeader = this.isHeader;\n        format.gridBefore = this.gridBefore;\n        format.gridBeforeWidth = this.gridBeforeWidth;\n        format.gridBeforeWidthType = this.gridBeforeWidthType;\n        format.gridAfter = this.gridAfter;\n        format.gridAfterWidth = this.gridAfterWidth;\n        format.gridAfterWidthType = this.gridAfterWidthType;\n        return format;\n    };\n    WRowFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueRowFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueRowFormat.uniqueFormatType, property);\n            return this.uniqueRowFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WRowFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueRowFormat)) {\n                this.allowBreakAcrossPages = format.allowBreakAcrossPages;\n                this.isHeader = format.isHeader;\n                this.heightType = format.heightType;\n                this.height = format.height;\n                this.gridBefore = format.gridBefore;\n                this.gridBeforeWidth = format.gridBeforeWidth;\n                this.gridBeforeWidthType = format.gridBeforeWidthType;\n                this.gridAfter = format.gridAfter;\n                this.gridAfterWidth = format.gridAfterWidth;\n                this.gridAfterWidthType = format.gridAfterWidthType;\n            }\n            if (!isNullOrUndefined(format.borders)) {\n                this.borders = new WBorders(this);\n                this.borders.ownerBase = format;\n                this.borders.copyFormat(format.borders);\n            }\n        }\n    };\n    WRowFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.borders)) {\n            this.borders.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueRowFormat)) {\n            WRowFormat.uniqueRowFormats.remove(this.uniqueRowFormat);\n        }\n        this.beforeWidth = undefined;\n        this.afterWidth = undefined;\n        this.borders = undefined;\n        this.uniqueRowFormat = undefined;\n    };\n    WRowFormat.clear = function () {\n        this.uniqueRowFormats.clear();\n    };\n    WRowFormat.uniqueRowFormats = new WUniqueFormats();\n    WRowFormat.uniqueFormatType = 6;\n    return WRowFormat;\n}());\nexport { WRowFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\n/**\n * @private\n */\nvar WSectionFormat = /** @class */ (function () {\n    function WSectionFormat(node) {\n        this.uniqueSectionFormat = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WSectionFormat.prototype, \"headerDistance\", {\n        get: function () {\n            return this.getPropertyValue('headerDistance');\n        },\n        set: function (value) {\n            this.setPropertyValue('headerDistance', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"footerDistance\", {\n        get: function () {\n            return this.getPropertyValue('footerDistance');\n        },\n        set: function (value) {\n            this.setPropertyValue('footerDistance', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"differentFirstPage\", {\n        get: function () {\n            return this.getPropertyValue('differentFirstPage');\n        },\n        set: function (value) {\n            this.setPropertyValue('differentFirstPage', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"differentOddAndEvenPages\", {\n        get: function () {\n            return this.getPropertyValue('differentOddAndEvenPages');\n        },\n        set: function (value) {\n            this.setPropertyValue('differentOddAndEvenPages', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"pageHeight\", {\n        get: function () {\n            return this.getPropertyValue('pageHeight');\n        },\n        set: function (value) {\n            this.setPropertyValue('pageHeight', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"rightMargin\", {\n        get: function () {\n            return this.getPropertyValue('rightMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"pageWidth\", {\n        get: function () {\n            return this.getPropertyValue('pageWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('pageWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"leftMargin\", {\n        get: function () {\n            return this.getPropertyValue('leftMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"bottomMargin\", {\n        get: function () {\n            return this.getPropertyValue('bottomMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('bottomMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"topMargin\", {\n        get: function () {\n            return this.getPropertyValue('topMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('topMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"bidi\", {\n        get: function () {\n            return this.getPropertyValue('bidi');\n        },\n        set: function (value) {\n            this.setPropertyValue('bidi', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WSectionFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.uniqueSectionFormat)) {\n            WSectionFormat.uniqueSectionFormats.remove(this.uniqueSectionFormat);\n        }\n        this.uniqueSectionFormat = undefined;\n    };\n    WSectionFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueSectionFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueSectionFormat.uniqueFormatType, property);\n            return this.uniqueSectionFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WSectionFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'headerDistance':\n                value = 36;\n                break;\n            case 'footerDistance':\n                value = 36;\n                break;\n            case 'differentFirstPage':\n                value = false;\n                break;\n            case 'differentOddAndEvenPages':\n                value = false;\n                break;\n            case 'pageWidth':\n                value = 612;\n                break;\n            case 'pageHeight':\n                value = 792;\n                break;\n            case 'leftMargin':\n                value = 72;\n                break;\n            case 'topMargin':\n                value = 72;\n                break;\n            case 'rightMargin':\n                value = 72;\n                break;\n            case 'bottomMargin':\n                value = 72;\n                break;\n            case 'bidi':\n                value = false;\n                break;\n        }\n        return value;\n    };\n    WSectionFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WSectionFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueSectionFormat) && this.uniqueSectionFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueSectionFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WSectionFormat.getPropertyDefaultValue(property);\n    };\n    WSectionFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WSectionFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueSectionFormat)) {\n            this.initializeUniqueSectionFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueSectionFormat.uniqueFormatType, property);\n            if (this.uniqueSectionFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueSectionFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueSectionFormat = WSectionFormat.uniqueSectionFormats.updateUniqueFormat(this.uniqueSectionFormat, property, value);\n        }\n    };\n    WSectionFormat.prototype.initializeUniqueSectionFormat = function (property, propValue) {\n        var uniqueSectionFormatTemp = new Dictionary();\n        this.addUniqueSectionFormat('headerDistance', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('footerDistance', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('differentFirstPage', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('differentOddAndEvenPages', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('pageWidth', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('pageHeight', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('leftMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('topMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('rightMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('bottomMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('bidi', property, propValue, uniqueSectionFormatTemp);\n        // tslint:disable-next-line:max-line-length\n        this.uniqueSectionFormat = WSectionFormat.uniqueSectionFormats.addUniqueFormat(uniqueSectionFormatTemp, WSectionFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WSectionFormat.prototype.addUniqueSectionFormat = function (property, modifiedProperty, propValue, uniqueSectionFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WSectionFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueSectionFormatTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueSectionFormatTemp.add(propertyType, WSectionFormat.getPropertyDefaultValue(property));\n        }\n    };\n    WSectionFormat.prototype.copyFormat = function (format, history) {\n        if (history && (history.isUndoing || history.isRedoing)) {\n            this.uniqueSectionFormat = format.uniqueSectionFormat;\n        }\n        else {\n            if (!isNullOrUndefined(format)) {\n                if (!isNullOrUndefined(format.uniqueSectionFormat) && format.uniqueSectionFormat.propertiesHash) {\n                    this.updateUniqueSectionFormat(format);\n                }\n            }\n        }\n    };\n    WSectionFormat.prototype.updateUniqueSectionFormat = function (format) {\n        var hash = undefined;\n        if (this.uniqueSectionFormat) {\n            hash = this.uniqueSectionFormat.mergeProperties(format.uniqueSectionFormat);\n            if (this.uniqueSectionFormat.referenceCount === 0) {\n                WSectionFormat.uniqueSectionFormats.remove(this.uniqueSectionFormat);\n                this.uniqueSectionFormat = undefined;\n            }\n        }\n        this.uniqueSectionFormat = new WUniqueFormat(WSectionFormat.uniqueFormatType);\n        if (isNullOrUndefined(hash)) {\n            hash = this.uniqueSectionFormat.mergeProperties(format.uniqueSectionFormat);\n        }\n        this.uniqueSectionFormat = WSectionFormat.uniqueSectionFormats.addUniqueFormat(hash, WSectionFormat.uniqueFormatType);\n    };\n    WSectionFormat.prototype.cloneFormat = function () {\n        var format = new WSectionFormat();\n        format.uniqueSectionFormat = this.uniqueSectionFormat;\n        return format;\n    };\n    WSectionFormat.clear = function () {\n        this.uniqueSectionFormats.clear();\n    };\n    WSectionFormat.uniqueSectionFormats = new WUniqueFormats();\n    WSectionFormat.uniqueFormatType = 10;\n    return WSectionFormat;\n}());\nexport { WSectionFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { Dictionary } from '../../base/dictionary';\n/**\n * @private\n */\nvar WShading = /** @class */ (function () {\n    function WShading(node) {\n        this.uniqueShadingFormat = undefined;\n        this.ownerBase = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WShading.prototype, \"backgroundColor\", {\n        get: function () {\n            return this.getPropertyValue('backgroundColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('backgroundColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WShading.prototype, \"foregroundColor\", {\n        get: function () {\n            return this.getPropertyValue('foregroundColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('foregroundColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WShading.prototype, \"textureStyle\", {\n        get: function () {\n            return this.getPropertyValue('textureStyle');\n        },\n        set: function (value) {\n            this.setPropertyValue('textureStyle', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WShading.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WShading.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueShadingFormat) && this.uniqueShadingFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueShadingFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WShading.getPropertyDefaultValue(property);\n    };\n    WShading.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WShading.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueShadingFormat)) {\n            this.initializeUniqueShading(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueShadingFormat.uniqueFormatType, property);\n            if (this.uniqueShadingFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueShadingFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueShadingFormat = WShading.uniqueShadingFormats.updateUniqueFormat(this.uniqueShadingFormat, property, value);\n        }\n    };\n    WShading.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'backgroundColor':\n                value = '#ffffff';\n                break;\n            case 'foregroundColor':\n                value = 'empty';\n                break;\n            case 'textureStyle':\n                value = 'TextureNone';\n                break;\n        }\n        return value;\n    };\n    WShading.prototype.initializeUniqueShading = function (property, propValue) {\n        var uniqueShadingTemp = new Dictionary();\n        this.addUniqueShading('backgroundColor', property, propValue, uniqueShadingTemp);\n        this.addUniqueShading('foregroundColor', property, propValue, uniqueShadingTemp);\n        this.addUniqueShading('textureStyle', property, propValue, uniqueShadingTemp);\n        // tslint:disable-next-line:max-line-length        \n        this.uniqueShadingFormat = WShading.uniqueShadingFormats.addUniqueFormat(uniqueShadingTemp, WShading.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WShading.prototype.addUniqueShading = function (property, modifiedProperty, propValue, uniqueShadingTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WShading.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueShadingTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueShadingTemp.add(propertyType, WShading.getPropertyDefaultValue(property));\n        }\n    };\n    WShading.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.uniqueShadingFormat)) {\n            WShading.uniqueShadingFormats.remove(this.uniqueShadingFormat);\n        }\n        this.uniqueShadingFormat = undefined;\n    };\n    WShading.prototype.cloneFormat = function () {\n        var shading = new WShading(undefined);\n        shading.backgroundColor = this.backgroundColor;\n        shading.foregroundColor = this.foregroundColor;\n        shading.textureStyle = this.textureStyle;\n        return shading;\n    };\n    WShading.prototype.copyFormat = function (shading) {\n        if (!isNullOrUndefined(shading) && !isNullOrUndefined(shading.uniqueShadingFormat)) {\n            this.backgroundColor = shading.backgroundColor;\n            this.foregroundColor = shading.foregroundColor;\n            this.textureStyle = shading.textureStyle;\n        }\n    };\n    WShading.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueShadingFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueShadingFormat.uniqueFormatType, property);\n            return this.uniqueShadingFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WShading.clear = function () {\n        this.uniqueShadingFormats.clear();\n    };\n    WShading.uniqueShadingFormats = new WUniqueFormats();\n    WShading.uniqueFormatType = 5;\n    return WShading;\n}());\nexport { WShading };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { WParagraphFormat } from './paragraph-format';\nimport { WCharacterFormat } from './character-format';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WStyle = /** @class */ (function () {\n    function WStyle() {\n    }\n    return WStyle;\n}());\nexport { WStyle };\n/**\n * @private\n */\nvar WParagraphStyle = /** @class */ (function (_super) {\n    __extends(WParagraphStyle, _super);\n    function WParagraphStyle(node) {\n        var _this = _super.call(this) || this;\n        _this.ownerBase = node;\n        _this.paragraphFormat = new WParagraphFormat(_this);\n        _this.characterFormat = new WCharacterFormat(_this);\n        return _this;\n    }\n    WParagraphStyle.prototype.destroy = function () {\n        this.characterFormat.destroy();\n        this.paragraphFormat.destroy();\n    };\n    WParagraphStyle.prototype.copyStyle = function (paraStyle) {\n        this.name = paraStyle.name;\n        this.ownerBase = paraStyle.ownerBase;\n        this.type = paraStyle.type;\n        this.next = paraStyle.next;\n        this.basedOn = paraStyle.basedOn;\n        this.link = paraStyle.link;\n        this.characterFormat.copyFormat(paraStyle.characterFormat);\n        this.paragraphFormat.copyFormat(paraStyle.paragraphFormat);\n    };\n    return WParagraphStyle;\n}(WStyle));\nexport { WParagraphStyle };\n/**\n * @private\n */\nvar WCharacterStyle = /** @class */ (function (_super) {\n    __extends(WCharacterStyle, _super);\n    function WCharacterStyle(node) {\n        var _this = _super.call(this) || this;\n        _this.ownerBase = node;\n        _this.characterFormat = new WCharacterFormat(_this);\n        return _this;\n    }\n    WCharacterStyle.prototype.destroy = function () {\n        this.characterFormat.destroy();\n    };\n    WCharacterStyle.prototype.copyStyle = function (charStyle) {\n        this.name = charStyle.name;\n        this.ownerBase = charStyle.ownerBase;\n        this.type = charStyle.type;\n        this.next = charStyle.next;\n        this.basedOn = charStyle.basedOn;\n        this.characterFormat.copyFormat(charStyle.characterFormat);\n    };\n    return WCharacterStyle;\n}(WStyle));\nexport { WCharacterStyle };\n/**\n * @private\n */\nvar WStyles = /** @class */ (function () {\n    function WStyles() {\n        this.collection = [];\n        /* tslint:enable:no-any */\n    }\n    Object.defineProperty(WStyles.prototype, \"length\", {\n        get: function () {\n            return this.collection.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WStyles.prototype.remove = function (item) {\n        this.collection = this.collection.filter(function (a) { return (a.name !== item.name); });\n    };\n    WStyles.prototype.push = function (item) {\n        if (item != null && item !== undefined) {\n            this.collection.push(item);\n        }\n        return 1;\n    };\n    WStyles.prototype.getItem = function (index) {\n        if (this.collection.length > index) {\n            return this.collection[index];\n        }\n        return null;\n    };\n    WStyles.prototype.indexOf = function (item) {\n        return this.collection.indexOf(item);\n    };\n    WStyles.prototype.contains = function (item) {\n        var index = this.collection.indexOf(item);\n        return index > -1 && index < this.collection.length;\n    };\n    WStyles.prototype.clear = function () {\n        while (this.collection.length > 0) {\n            this.collection.pop();\n        }\n    };\n    WStyles.prototype.findByName = function (name, type) {\n        var returnStyle;\n        for (var _i = 0, _a = this.collection; _i < _a.length; _i++) {\n            var value = _a[_i];\n            if (value.name === name) {\n                returnStyle = value;\n                if (!isNullOrUndefined(type) && value.type === type) {\n                    returnStyle = value;\n                }\n            }\n        }\n        return returnStyle;\n    };\n    WStyles.prototype.getStyleNames = function (type) {\n        return this.collection.filter(function (a) { return (a.type === type); }).map(function (a) { return a.name; });\n    };\n    /* tslint:disable:no-any */\n    WStyles.prototype.getStyles = function (type) {\n        var styles = this.collection.filter(function (a) { return (a.type === type); }).map(function (a) { return a; });\n        var styleObjects = [];\n        for (var _i = 0, styles_1 = styles; _i < styles_1.length; _i++) {\n            var style = styles_1[_i];\n            var returnStyle = {};\n            var returnStyleObject = {};\n            returnStyleObject.characterFormat = {};\n            HelperMethods.writeCharacterFormat(returnStyleObject.characterFormat, true, style.characterFormat);\n            returnStyle.name = style.name;\n            returnStyle.style = JSON.stringify(returnStyleObject);\n            styleObjects.push(returnStyle);\n        }\n        return styleObjects;\n    };\n    return WStyles;\n}());\nexport { WStyles };\n","import { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WBorders } from './borders';\nimport { WShading } from './shading';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WTableFormat = /** @class */ (function () {\n    function WTableFormat(owner) {\n        this.uniqueTableFormat = undefined;\n        this.borders = new WBorders(this);\n        this.shading = new WShading(this);\n        this.ownerBase = undefined;\n        this.ownerBase = owner;\n        this.assignTableMarginValue(5.4, 0, 5.4, 0);\n    }\n    Object.defineProperty(WTableFormat.prototype, \"allowAutoFit\", {\n        get: function () {\n            return this.getPropertyValue('allowAutoFit');\n        },\n        set: function (value) {\n            this.setPropertyValue('allowAutoFit', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"cellSpacing\", {\n        get: function () {\n            return this.getPropertyValue('cellSpacing');\n        },\n        set: function (value) {\n            if (value < 0 || value > 264.6) {\n                throw new RangeError('The measurement must be between 0 px and 264.6 px.');\n            }\n            this.setPropertyValue('cellSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"leftMargin\", {\n        get: function () {\n            return this.getPropertyValue('leftMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"topMargin\", {\n        get: function () {\n            return this.getPropertyValue('topMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('topMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"rightMargin\", {\n        get: function () {\n            return this.getPropertyValue('rightMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"bottomMargin\", {\n        get: function () {\n            return this.getPropertyValue('bottomMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('bottomMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"leftIndent\", {\n        get: function () {\n            return this.getPropertyValue('leftIndent');\n        },\n        set: function (value) {\n            if (value < -1440 || value > 1440) {\n                throw new RangeError('The measurement must be between -1440 px and 1440 px.');\n            }\n            this.setPropertyValue('leftIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"tableAlignment\", {\n        get: function () {\n            return this.getPropertyValue('tableAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('tableAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"preferredWidth\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"preferredWidthType\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"bidi\", {\n        get: function () {\n            return this.getPropertyValue('bidi');\n        },\n        set: function (value) {\n            this.setPropertyValue('bidi', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WTableFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WTableFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueTableFormat) && this.uniqueTableFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueTableFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WTableFormat.getPropertyDefaultValue(property);\n    };\n    WTableFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WTableFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueTableFormat)) {\n            this.initializeUniqueTableFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueTableFormat.uniqueFormatType, property);\n            if (this.uniqueTableFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueTableFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueTableFormat = WTableFormat.uniqueTableFormats.updateUniqueFormat(this.uniqueTableFormat, property, value);\n        }\n    };\n    WTableFormat.prototype.initializeUniqueTableFormat = function (property, propValue) {\n        var uniqueTableFormatTemp = new Dictionary();\n        this.addUniqueTableFormat('allowAutoFit', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('cellSpacing', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('leftMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('topMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('bottomMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('rightMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('leftIndent', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('tableAlignment', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('preferredWidth', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('preferredWidthType', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('bidi', property, propValue, uniqueTableFormatTemp);\n        this.uniqueTableFormat = WTableFormat.uniqueTableFormats.addUniqueFormat(uniqueTableFormatTemp, WTableFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WTableFormat.prototype.addUniqueTableFormat = function (property, modifiedProperty, propValue, uniqueTableFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WTableFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueTableFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WTableFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'allowAutoFit':\n                value = false;\n                break;\n            case 'cellSpacing':\n                value = 0;\n                break;\n            case 'leftMargin':\n                value = 5.4;\n                break;\n            case 'topMargin':\n                value = 0;\n                break;\n            case 'bottomMargin':\n                value = 0;\n                break;\n            case 'rightMargin':\n                value = 5.4;\n                break;\n            case 'leftIndent':\n                value = 0;\n                break;\n            case 'tableAlignment':\n                value = 'Left';\n                break;\n            case 'preferredWidth':\n                value = 0;\n                break;\n            case 'preferredWidthType':\n                value = 'Point';\n                break;\n            case 'bidi':\n                value = false;\n                break;\n        }\n        return value;\n    };\n    WTableFormat.prototype.assignTableMarginValue = function (left, top, right, bottom) {\n        this.leftMargin = left;\n        this.topMargin = top;\n        this.rightMargin = right;\n        this.bottomMargin = bottom;\n    };\n    WTableFormat.prototype.initializeTableBorders = function () {\n        this.borders.left.lineStyle = 'Single';\n        this.borders.left.lineWidth = 0.5;\n        this.borders.right.lineStyle = 'Single';\n        this.borders.right.lineWidth = 0.5;\n        this.borders.top.lineStyle = 'Single';\n        this.borders.top.lineWidth = 0.5;\n        this.borders.bottom.lineStyle = 'Single';\n        this.borders.bottom.lineWidth = 0.5;\n        this.borders.horizontal.lineStyle = 'Single';\n        this.borders.horizontal.lineWidth = 0.5;\n        this.borders.vertical.lineStyle = 'Single';\n        this.borders.vertical.lineWidth = 0.5;\n    };\n    WTableFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.borders)) {\n            this.borders.destroy();\n        }\n        if (!isNullOrUndefined(this.shading)) {\n            this.shading.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueTableFormat)) {\n            WTableFormat.uniqueTableFormats.remove(this.uniqueTableFormat);\n        }\n        this.uniqueTableFormat = undefined;\n        this.borders = undefined;\n        this.shading = undefined;\n    };\n    WTableFormat.prototype.cloneFormat = function () {\n        var tableFormat = new WTableFormat(undefined);\n        tableFormat.leftIndent = this.leftIndent;\n        tableFormat.tableAlignment = this.tableAlignment;\n        tableFormat.cellSpacing = this.cellSpacing;\n        tableFormat.leftMargin = this.leftMargin;\n        tableFormat.rightMargin = this.rightMargin;\n        tableFormat.topMargin = this.topMargin;\n        tableFormat.bottomMargin = this.bottomMargin;\n        tableFormat.preferredWidth = this.preferredWidth;\n        tableFormat.preferredWidthType = this.preferredWidthType;\n        tableFormat.borders = isNullOrUndefined(this.borders) ? undefined : this.borders.cloneFormat();\n        tableFormat.shading = isNullOrUndefined(this.shading) ? undefined : this.shading.cloneFormat();\n        tableFormat.bidi = this.bidi;\n        tableFormat.allowAutoFit = this.allowAutoFit;\n        return tableFormat;\n    };\n    WTableFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueTableFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueTableFormat.uniqueFormatType, property);\n            return this.uniqueTableFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WTableFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueTableFormat)) {\n                this.cellSpacing = format.cellSpacing;\n                this.leftMargin = format.leftMargin;\n                this.topMargin = format.topMargin;\n                this.rightMargin = format.rightMargin;\n                this.bottomMargin = format.bottomMargin;\n                this.leftIndent = format.leftIndent;\n                this.tableAlignment = format.tableAlignment;\n                this.preferredWidth = format.preferredWidth;\n                this.preferredWidthType = format.preferredWidthType;\n                this.bidi = format.bidi;\n                this.allowAutoFit = format.allowAutoFit;\n            }\n            if (!isNullOrUndefined(format.borders)) {\n                this.borders = new WBorders(this);\n                this.borders.copyFormat(format.borders);\n            }\n            if (!isNullOrUndefined(format.shading)) {\n                this.shading = new WShading(this);\n                this.shading.copyFormat(format.shading);\n            }\n        }\n    };\n    WTableFormat.clear = function () {\n        this.uniqueTableFormats.clear();\n    };\n    WTableFormat.uniqueTableFormats = new WUniqueFormats();\n    WTableFormat.uniqueFormatType = 8;\n    return WTableFormat;\n}());\nexport { WTableFormat };\n","/**\n * Document Editor implementation\n */\nexport * from './print';\nexport * from './context-menu';\nexport * from './format/index';\nexport * from './list/index';\nexport * from './viewer/index';\nexport * from './selection/index';\nexport * from './search/index';\nexport * from './editor/index';\nexport * from './editor-history/index';\nexport * from './writer/index';\nexport * from './dialogs/index';\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WAbstractList = /** @class */ (function () {\n    function WAbstractList() {\n        this.abstractListIdIn = -1;\n        this.levels = [];\n    }\n    Object.defineProperty(WAbstractList.prototype, \"abstractListId\", {\n        get: function () {\n            return this.abstractListIdIn;\n        },\n        set: function (abstractListId) {\n            this.abstractListIdIn = abstractListId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WAbstractList.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.levels)) {\n            for (var i = 0; i < this.levels.length; i++) {\n                var listLevel = this.levels[i];\n                listLevel.destroy();\n                this.levels.splice(this.levels.indexOf(listLevel), 1);\n                i--;\n            }\n            this.levels = [];\n        }\n        this.levels = undefined;\n    };\n    return WAbstractList;\n}());\nexport { WAbstractList };\n","/**\n * List implementation\n */\nexport * from './list';\nexport * from './abstract-list';\nexport * from './list-level';\nexport * from './level-override';\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WLevelOverride = /** @class */ (function () {\n    function WLevelOverride() {\n    }\n    WLevelOverride.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.overrideListLevel)) {\n            this.overrideListLevel.destroy();\n        }\n        this.levelNumber = undefined;\n        this.startAt = undefined;\n        this.overrideListLevel = undefined;\n    };\n    return WLevelOverride;\n}());\nexport { WLevelOverride };\n","import { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WCharacterFormat } from '../format/character-format';\nimport { WParagraphFormat } from '../format/paragraph-format';\nimport { WAbstractList } from './abstract-list';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WListLevel = /** @class */ (function () {\n    function WListLevel(node) {\n        this.uniqueListLevel = undefined;\n        this.paragraphFormat = undefined;\n        this.characterFormat = undefined;\n        if (node instanceof WAbstractList) {\n            this.ownerBase = node;\n        }\n        else {\n            this.ownerBase = node;\n        }\n        this.characterFormat = new WCharacterFormat(undefined);\n        this.paragraphFormat = new WParagraphFormat(undefined);\n    }\n    Object.defineProperty(WListLevel.prototype, \"listLevelPattern\", {\n        get: function () {\n            return this.getPropertyValue('listLevelPattern');\n        },\n        set: function (listLevelPattern) {\n            this.setPropertyValue('listLevelPattern', listLevelPattern);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"followCharacter\", {\n        get: function () {\n            return this.getPropertyValue('followCharacter');\n        },\n        set: function (followCharacter) {\n            this.setPropertyValue('followCharacter', followCharacter);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"startAt\", {\n        get: function () {\n            return this.getPropertyValue('startAt');\n        },\n        set: function (startAt) {\n            this.setPropertyValue('startAt', startAt);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"numberFormat\", {\n        get: function () {\n            return this.getPropertyValue('numberFormat');\n        },\n        set: function (numberFormat) {\n            this.setPropertyValue('numberFormat', numberFormat);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"restartLevel\", {\n        get: function () {\n            return this.getPropertyValue('restartLevel');\n        },\n        set: function (restartLevel) {\n            this.setPropertyValue('restartLevel', restartLevel);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WListLevel.prototype.getPropertyValue = function (property) {\n        var propertyType = WUniqueFormat.getPropertyType(WListLevel.uniqueFormatType, property);\n        if (!isNullOrUndefined(this.uniqueListLevel) && this.uniqueListLevel.propertiesHash.containsKey(propertyType)) {\n            return this.uniqueListLevel.propertiesHash.get(propertyType);\n        }\n        return WListLevel.getPropertyDefaultValue(property);\n    };\n    WListLevel.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WListLevel.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueListLevel)) {\n            this.initializeUniqueWListLevel(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueListLevel.uniqueFormatType, property);\n            if (this.uniqueListLevel.propertiesHash.containsKey(propertyType) &&\n                // tslint:disable-next-line:max-line-length\n                this.uniqueListLevel.propertiesHash.get(propertyType) === value) { //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueListLevel = WListLevel.uniqueListLevels.updateUniqueFormat(this.uniqueListLevel, property, value);\n        }\n    };\n    WListLevel.prototype.initializeUniqueWListLevel = function (property, propValue) {\n        var uniqueListLevelTemp = new Dictionary();\n        this.addUniqueWListLevel('listLevelPattern', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('startAt', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('followCharacter', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('numberFormat', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('restartLevel', property, propValue, uniqueListLevelTemp);\n        // tslint:disable-next-line:max-line-length    \n        this.uniqueListLevel = WListLevel.uniqueListLevels.addUniqueFormat(uniqueListLevelTemp, WListLevel.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WListLevel.prototype.addUniqueWListLevel = function (property, modifiedProperty, propValue, uniqueCharFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WListLevel.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueCharFormatTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueCharFormatTemp.add(propertyType, WListLevel.getPropertyDefaultValue(property));\n        }\n    };\n    WListLevel.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'listLevelPattern':\n                value = 'Arabic';\n                break;\n            case 'startAt':\n                value = 0;\n                break;\n            case 'followCharacter':\n                value = 'Tab';\n                break;\n            case 'numberFormat':\n                value = '';\n                break;\n            case 'restartLevel':\n                value = 0;\n                break;\n        }\n        return value;\n    };\n    WListLevel.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.characterFormat)) {\n            this.characterFormat.destroy();\n        }\n        if (!isNullOrUndefined(this.paragraphFormat)) {\n            this.paragraphFormat.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueListLevel)) {\n            WListLevel.uniqueListLevels.remove(this.uniqueListLevel);\n        }\n        this.uniqueListLevel = undefined;\n        this.characterFormat = undefined;\n        this.paragraphFormat = undefined;\n    };\n    WListLevel.clear = function () {\n        this.uniqueListLevels.clear();\n    };\n    WListLevel.dotBullet = '\\uf0b7';\n    WListLevel.squareBullet = '\\uf0a7'; //Symbol font \\u25aa.\n    WListLevel.arrowBullet = '\\u27a4';\n    WListLevel.circleBullet = '\\uf06f' + '\\u0020';\n    WListLevel.uniqueListLevels = new WUniqueFormats();\n    WListLevel.uniqueFormatType = 9;\n    return WListLevel;\n}());\nexport { WListLevel };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WLevelOverride } from './level-override';\n/**\n * @private\n */\nvar WList = /** @class */ (function () {\n    function WList() {\n        this.listId = -1;\n        this.sourceListId = -1;\n        this.abstractListId = -1;\n        this.abstractList = undefined;\n        this.levelOverrides = [];\n    }\n    WList.prototype.getListLevel = function (levelNumber) {\n        var listLevel = undefined;\n        var levelOverride = this.getLevelOverride(levelNumber);\n        if (!isNullOrUndefined(levelOverride) && !isNullOrUndefined(levelOverride.overrideListLevel)) {\n            listLevel = levelOverride.overrideListLevel;\n        }\n        else {\n            listLevel = this.abstractList.levels[levelNumber];\n        }\n        return listLevel;\n    };\n    WList.prototype.getLevelOverride = function (levelNumber) {\n        for (var i = 0; i < this.levelOverrides.length; i++) {\n            if (this.levelOverrides[i] instanceof WLevelOverride) {\n                var levelOverride = this.levelOverrides[i];\n                if (levelOverride.levelNumber === levelNumber) {\n                    return levelOverride;\n                }\n            }\n        }\n        return undefined;\n    };\n    WList.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.levelOverrides)) {\n            this.levelOverrides = [];\n        }\n        this.abstractListId = undefined;\n        this.listId = undefined;\n        this.sourceListId = undefined;\n        this.levelOverrides = undefined;\n    };\n    WList.prototype.mergeList = function (list) {\n        if (!isNullOrUndefined(this.abstractListId) && this.abstractListId !== -1) {\n            this.abstractListId = list.abstractListId;\n        }\n        if (!isNullOrUndefined(this.listId) && this.listId !== -1) {\n            this.listId = list.listId;\n        }\n        if (!isNullOrUndefined(this.sourceListId) && this.sourceListId !== -1) {\n            this.sourceListId = list.sourceListId;\n        }\n        if (!isNullOrUndefined(this.levelOverrides) && this.levelOverrides.length !== 0) {\n            this.levelOverrides = list.levelOverrides;\n        }\n    };\n    return WList;\n}());\nexport { WList };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Print class\n */\nvar Print = /** @class */ (function () {\n    function Print() {\n    }\n    /**\n     * Gets module name.\n     */\n    Print.prototype.getModuleName = function () {\n        return 'Print';\n    };\n    /**\n     * Prints the current viewer\n     * @param viewer\n     * @param printWindow\n     * @private\n     */\n    Print.prototype.print = function (viewer, printWindow) {\n        this.printWindow(viewer, navigator.userAgent, printWindow);\n    };\n    /**\n     * Opens print window and displays current page to print.\n     * @private\n     */\n    Print.prototype.printWindow = function (viewer, browserUserAgent, printWindow) {\n        var height = this.getPageHeight(viewer.pages);\n        var width = this.getPageWidth(viewer.pages);\n        var printElement = document.createElement('div');\n        printElement.style.width = '100%';\n        printElement.style.height = '100%';\n        printElement.style.overflow = 'scroll';\n        // Rendering canvas to print\n        this.generatePrintContent(viewer, printElement);\n        if (isNullOrUndefined(printWindow)) {\n            printWindow = window.open('', 'print', 'height=452,width=1024,tabbar=no');\n        }\n        if ((browserUserAgent.indexOf('Chrome') !== -1) || (browserUserAgent.indexOf('Firefox')) !== -1) {\n            // Chrome and Firefox\n            printWindow.document.write('<!DOCTYPE html>');\n            // tslint:disable-next-line:max-line-length\n            printWindow.document.write('<html moznomarginboxes mozdisallowselectionprint><head><style>html, body { height: 100 %; } img { height: 100 %; width: 100 %; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:' + width.toString() + 'px ' + height.toString() + 'px; }@media print{ body { margin: 0cm; }</style></head> <body><center>');\n        }\n        else {\n            // Internet Explorer and Edge\n            // tslint:disable-next-line:max-line-length\n            printWindow.document.write('<html><head><style>@page{margin:0;size:' + width.toString() + 'px ' + height.toString() + 'px;}</style></head><body><center>');\n        }\n        // tslint:disable-next-line:max-line-length\n        printWindow.document.write(printElement.innerHTML + '</center><script> (function() { window.ready = true; })(); </script></body></html>');\n        printElement = undefined;\n        printWindow.document.close();\n        printWindow.focus();\n        var interval = setInterval(function () {\n            if (printWindow.ready) {\n                printWindow.print();\n                printWindow.close();\n                clearInterval(interval);\n            }\n        }, 500);\n    };\n    /**\n     * Generates print content.\n     * @private\n     */\n    Print.prototype.generatePrintContent = function (viewer, element) {\n        // Rendering canvas to print\n        var htmlString = '';\n        for (var i = 0; i < viewer.pages.length; i++) {\n            var page = viewer.pages[i];\n            var pageHeight = page.boundingRectangle.height;\n            var pageWidth = page.boundingRectangle.width;\n            viewer.render.isPrinting = true;\n            viewer.render.renderWidgets(page, 0, 0, 0, 0);\n            var canvasURL = viewer.render.pageCanvas.toDataURL();\n            viewer.render.isPrinting = false;\n            // tslint:disable-next-line:max-line-length\n            htmlString += '<div><img src=' + canvasURL + ' style=\"margin:0px;display:block;width: ' + pageWidth.toString() + 'px; height:' + pageHeight.toString() + 'px; \"/></div><br/>';\n        }\n        element.innerHTML = htmlString;\n    };\n    /**\n     * Gets page width.\n     * @param pages\n     * @private\n     */\n    Print.prototype.getPageWidth = function (pages) {\n        var width = 0;\n        for (var i = 0; i < pages.length; i++) {\n            if (width < pages[i].boundingRectangle.width) {\n                width = pages[i].boundingRectangle.width;\n            }\n        }\n        return width;\n    };\n    /**\n     *  Gets page height.\n     * @private\n     */\n    Print.prototype.getPageHeight = function (pages) {\n        var height = 0;\n        for (var i = 0; i < pages.length; i++) {\n            if (height < pages[i].boundingRectangle.height) {\n                height = pages[i].boundingRectangle.height;\n            }\n        }\n        return height;\n    };\n    /**\n     * @private\n     */\n    Print.prototype.destroy = function () {\n        return;\n    };\n    return Print;\n}());\nexport { Print };\n","/**\n * Search Export\n */\nexport * from './search';\nexport * from './options-pane';\nexport * from './text-search';\nexport * from './text-search-result';\nexport * from './text-search-results';\n","import { createElement, isNullOrUndefined, L10n } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { Tab } from '@syncfusion/ej2-navigations';\n/**\n * Options Pane class.\n */\nvar OptionsPane = /** @class */ (function () {\n    /**\n     * Constructor for Options pane module\n     * @param {LayoutViewer} layoutViewer\n     * @private\n     */\n    function OptionsPane(layoutViewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.isOptionsPaneShow = false;\n        this.findOption = 'None';\n        this.matchCase = undefined;\n        this.wholeWord = undefined;\n        // private regular: CheckBox = undefined;\n        this.searchText = 'Navigation';\n        this.resultsText = 'Results';\n        this.messageDivText = 'No matches';\n        this.replaceButtonText = 'Replace';\n        this.replaceAllButtonText = 'Replace All';\n        this.focusedIndex = -1;\n        this.focusedElement = [];\n        this.isOptionsPane = true;\n        this.replacePaneText = 'Replace';\n        this.findPaneText = 'Find';\n        this.matchDivReplaceText = 'No matches';\n        /**\n         * @private\n         */\n        this.tabInstance = undefined;\n        /**\n         * @private\n         */\n        this.isReplace = false;\n        /**\n         * Gets selected tab item which tab is selected.\n         * @param {SelectEventArgs} args - Specifies which tab will be opened.\n         * @private\n         */\n        this.selectedTabItem = function (args) {\n            var contentParent = _this.findTab.getElementsByClassName('e-content').item(0);\n            if (args.previousIndex !== args.selectedIndex) {\n                var previousTab = contentParent.children[args.previousIndex];\n                var nextTab = contentParent.children[args.selectedIndex];\n                var element = previousTab.firstElementChild;\n                element.parentElement.removeChild(element);\n                nextTab.appendChild(element);\n            }\n            var selectedElement = contentParent.children[args.selectedIndex];\n            if (!isNullOrUndefined(selectedElement)) {\n                if (args.selectedIndex === 0) {\n                    _this.isOptionsPane = true;\n                    _this.onFindPane();\n                }\n                else {\n                    _this.isOptionsPane = false;\n                    _this.onReplacePane();\n                }\n            }\n        };\n        this.searchOptionChange = function () {\n            _this.clearSearchResultItems();\n            _this.viewer.owner.searchModule.clearSearchHighlight();\n            var inputText = _this.searchInput.value;\n            if (inputText === '') {\n                return;\n            }\n            var pattern = _this.viewer.owner.searchModule.textSearch.stringToRegex(inputText, _this.findOption);\n            var endSelection = _this.viewer.selection.end;\n            var selectionIndex = endSelection.getHierarchicalIndexInternal();\n            _this.results = _this.viewer.owner.searchModule.textSearch.findAll(pattern, _this.findOption, selectionIndex);\n            if (_this.results != null && _this.results.length > 0) {\n                _this.navigateSearchResult();\n            }\n            else {\n                _this.viewer.renderVisiblePages();\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'block';\n                _this.resultsListBlock.style.display = 'none';\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n            }\n        };\n        /**\n         * Apply find option based on whole words value.\n         * @param {ChangeEventArgs} args - Specifies the search options value.\n         * @private\n         */\n        this.wholeWordsChange = function (args) {\n            if (_this.matchInput.checked && _this.wholeInput.checked) {\n                _this.findOption = 'CaseSensitiveWholeWord';\n            }\n            else if (_this.matchInput.checked && !(_this.wholeInput.checked)) {\n                _this.findOption = 'CaseSensitive';\n            }\n            else if (!(_this.matchInput.checked) && _this.wholeInput.checked) {\n                _this.findOption = 'WholeWord';\n            }\n            else {\n                _this.findOption = 'None';\n            }\n            _this.searchOptionChange();\n        };\n        /**\n         * Apply find option based on match value.\n         * @param {ChangeEventArgs} args - Specifies the search options value.\n         * @private\n         */\n        this.matchChange = function (args) {\n            if (_this.matchInput.checked && _this.wholeInput.checked) {\n                _this.findOption = 'CaseSensitiveWholeWord';\n            }\n            else if (!(_this.matchInput.checked) && _this.wholeInput.checked) {\n                _this.findOption = 'WholeWord';\n            }\n            else if (_this.matchInput.checked && !(_this.wholeInput.checked)) {\n                _this.findOption = 'CaseSensitive';\n            }\n            else {\n                _this.findOption = 'None';\n            }\n            _this.searchOptionChange();\n        };\n        /**\n         * Apply find options based on regular value.\n         * @param {ChangeEventArgs} args - Specifies the search options value.\n         * @private\n         */\n        // public regularChange = (args: ChangeEventArgs): void => {\n        //     if (args.checked) {\n        //         this.matchCase.element.parentElement.parentElement.classList.add('e-checkbox-disabled');\n        //         this.wholeWord.element.parentElement.parentElement.classList.add('e-checkbox-disabled');\n        //         this.matchCase.checked = false;\n        //         this.wholeWord.checked = false;\n        //         this.findOption = 'None';\n        //         this.onKeyDownInternal();\n        //     } else {\n        //         this.matchCase.element.parentElement.parentElement.classList.remove('e-checkbox-disabled');\n        //         this.wholeWord.element.parentElement.parentElement.classList.remove('e-checkbox-disabled');\n        //     }\n        // }\n        // tslint:enable:no-any \n        /**\n         * Binding events from the element when optins pane creation.\n         * @private\n         */\n        this.onWireEvents = function () {\n            _this.searchIcon.addEventListener('click', _this.searchIconClickInternal);\n            _this.navigateToNextResult.addEventListener('click', _this.navigateNextResultButtonClick);\n            _this.navigateToPreviousResult.addEventListener('click', _this.navigatePreviousResultButtonClick);\n            _this.searchInput.addEventListener('keydown', _this.onKeyDown);\n            _this.searchInput.addEventListener('keyup', _this.onEnableDisableReplaceButton);\n            _this.resultsListBlock.addEventListener('click', _this.resultListBlockClick);\n            _this.closeButton.addEventListener('click', _this.close);\n            _this.replaceButton.addEventListener('click', _this.onReplaceButtonClick);\n            _this.replaceAllButton.addEventListener('click', _this.onReplaceAllButtonClick);\n        };\n        /**\n         * Enable find pane only.\n         * @private\n         */\n        this.onFindPane = function () {\n            _this.replaceDiv.style.display = 'none';\n            _this.occurrenceDiv.style.display = 'none';\n            if (!isNullOrUndefined(_this.results) && _this.results.length === 0) {\n                _this.resultsListBlock.innerHTML = '';\n                _this.resultsListBlock.style.display = 'none';\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n            }\n            var height = _this.isOptionsPane ? 215 : 292;\n            var resultsContainerHeight = _this.viewer.owner.getDocumentEditorElement().offsetHeight - height;\n            _this.resultsListBlock.style.height = resultsContainerHeight + 'px';\n            _this.replaceTabContentDiv.style.display = 'none';\n            _this.findDiv.style.display = 'block';\n            _this.messageDiv.style.display = 'block';\n            _this.focusedElement = [];\n            // tslint:disable-next-line:max-line-length\n            _this.focusedElement.push(_this.closeButton, _this.findTabButtonHeader, _this.replaceTabButtonHeader, _this.searchInput, _this.searchIcon, _this.navigateToPreviousResult, _this.navigateToNextResult, _this.matchInput, _this.wholeInput);\n            _this.focusedIndex = 3;\n            _this.searchInput.select();\n            _this.getMessageDivHeight();\n        };\n        this.onEnableDisableReplaceButton = function () {\n            if (_this.searchInput.value.length !== 0) {\n                _this.replaceButton.disabled = false;\n                _this.replaceAllButton.disabled = false;\n            }\n            else {\n                _this.replaceButton.disabled = true;\n                _this.replaceAllButton.disabled = true;\n            }\n        };\n        /**\n         * Enable replace pane only.\n         * @private\n         */\n        this.onReplacePane = function () {\n            _this.findDiv.style.display = 'block';\n            _this.replaceDiv.style.display = 'block';\n            _this.replaceTabContentDiv.style.display = 'block';\n            var height = _this.isOptionsPane ? 215 : 292;\n            var resultsContainerHeight = _this.viewer.owner.getDocumentEditorElement().offsetHeight - height;\n            _this.resultsListBlock.style.height = resultsContainerHeight + 'px';\n            _this.isOptionsPane = false;\n            if (_this.searchInput.value.length !== 0) {\n                _this.replaceButton.disabled = false;\n                _this.replaceAllButton.disabled = false;\n            }\n            else {\n                _this.replaceButton.disabled = true;\n                _this.replaceAllButton.disabled = true;\n            }\n            _this.focusedElement = [];\n            // tslint:disable-next-line:max-line-length\n            _this.focusedElement.push(_this.closeButton, _this.findTabButtonHeader, _this.replaceTabButtonHeader, _this.searchInput, _this.searchIcon, _this.navigateToPreviousResult, _this.navigateToNextResult, _this.matchInput, _this.wholeInput, _this.replaceWith, _this.replaceButton, _this.replaceAllButton);\n            _this.focusedIndex = 9;\n            if (_this.searchInput.value === '') {\n                _this.searchInput.select();\n            }\n            else {\n                _this.replaceWith.select();\n            }\n            _this.getMessageDivHeight();\n        };\n        /**\n         * Fires on key down on options pane.\n         * @param {KeyboardEvent} event - Specifies the focus of current element.\n         * @private\n         */\n        this.onKeyDownOnOptionPane = function (event) {\n            // if (event.keyCode === 70) {\n            //     event.preventDefault();\n            //     return;\n            // }\n            if (event.keyCode === 9) {\n                event.preventDefault();\n                var focusIndex = undefined;\n                if (event.shiftKey) {\n                    focusIndex = (_this.focusedIndex === 0 || isNullOrUndefined(_this.focusedIndex)) ?\n                        _this.focusedElement.length - 1 : _this.focusedIndex - 1;\n                }\n                else {\n                    focusIndex = (_this.focusedElement.length - 1 === _this.focusedIndex || isNullOrUndefined(_this.focusedIndex)) ?\n                        0 : _this.focusedIndex + 1;\n                }\n                var element = _this.focusedElement[focusIndex];\n                element.focus();\n                if (element instanceof HTMLInputElement) {\n                    element.select();\n                }\n                _this.focusedIndex = focusIndex;\n                if (element instanceof HTMLLIElement) {\n                    _this.scrollToPosition(element);\n                }\n            }\n            else if (event.keyCode === 13) {\n                // tslint:disable-next-line:max-line-length\n                if (event.target !== _this.searchInput && event.target !== _this.closeButton) {\n                    event.preventDefault();\n                    var index = _this.focusedElement.indexOf(event.target);\n                    if (index !== -1) {\n                        var list = _this.focusedElement[index];\n                        list.click();\n                        list.focus();\n                        _this.focusedIndex = index;\n                    }\n                }\n            }\n            else if (event.keyCode === 40 || event.keyCode === 38) {\n                if (_this.resultsListBlock.style.display !== 'none') {\n                    var index = void 0;\n                    var element = void 0;\n                    if (event.keyCode === 40) {\n                        if (_this.focusedIndex > 7) {\n                            if (_this.focusedIndex + 1 < _this.focusedElement.length) {\n                                element = _this.focusedElement[_this.focusedIndex + 1];\n                                element.focus();\n                                _this.focusedIndex = _this.focusedIndex + 1;\n                            }\n                        }\n                        else {\n                            index = (_this.focusedElement.length - _this.resultsListBlock.children.length) + _this.results.currentIndex + 1;\n                            if (index < _this.focusedElement.length) {\n                                element = _this.focusedElement[index];\n                                element.focus();\n                                _this.focusedIndex = index;\n                            }\n                        }\n                    }\n                    else {\n                        if (_this.focusedIndex > 8) {\n                            index = _this.focusedIndex - 1;\n                            element = _this.focusedElement[index];\n                            element.focus();\n                            _this.focusedIndex = index;\n                        }\n                    }\n                }\n            }\n        };\n        /**\n         * Fires on replace.\n         * @private\n         */\n        this.onReplaceButtonClick = function () {\n            var optionsPane = _this.optionsPane;\n            var findText = _this.searchInput.value;\n            var replaceText = _this.replaceWith.value;\n            var results = _this.viewer.owner.searchModule.textSearchResults;\n            if (findText !== '' && !isNullOrUndefined(findText)) {\n                if (_this.viewer.owner.selection != null) {\n                    var selectionText = _this.viewer.owner.selection.text;\n                    if (!_this.viewer.owner.selection.isEmpty) {\n                        if (_this.viewer.owner.selection.isForward) {\n                            _this.viewer.owner.selection.selectContent(_this.viewer.owner.selection.start, true);\n                        }\n                        else {\n                            _this.viewer.owner.selection.selectContent(_this.viewer.owner.selection.end, true);\n                        }\n                    }\n                    if (!isNullOrUndefined(results) && !isNullOrUndefined(results.currentSearchResult)) {\n                        var result = results.currentSearchResult;\n                        _this.viewer.owner.searchModule.navigate(result);\n                        if (result.text === selectionText) {\n                            var replace = isNullOrUndefined(replaceText) ? '' : replaceText;\n                            _this.viewer.owner.searchModule.replace(replace, result, results);\n                            var pattern = _this.viewer.owner.searchModule.textSearch.stringToRegex(findText, _this.findOption);\n                            var endSelection = _this.viewer.selection.end;\n                            var index = endSelection.getHierarchicalIndexInternal();\n                            // tslint:disable-next-line:max-line-length\n                            _this.viewer.owner.searchModule.textSearchResults = _this.viewer.owner.searchModule.textSearch.findAll(pattern, _this.findOption, index);\n                            _this.results = _this.viewer.owner.searchModule.textSearchResults;\n                            if (!isNullOrUndefined(_this.results) && !isNullOrUndefined(_this.results.currentSearchResult)) {\n                                _this.viewer.owner.searchModule.navigate(_this.results.currentSearchResult);\n                            }\n                            else {\n                                _this.messageDiv.style.display = 'block';\n                                _this.messageDiv.innerHTML = _this.localeValue.getConstant(_this.matchDivReplaceText);\n                            }\n                            _this.viewer.owner.findResultsList = [];\n                            if (!isNullOrUndefined(_this.results) && _this.results.innerList.length > 0) {\n                                _this.navigateSearchResult();\n                            }\n                            else {\n                                _this.resultsListBlock.innerHTML = '';\n                            }\n                        }\n                    }\n                    else {\n                        _this.messageDiv.style.display = 'block';\n                        _this.messageDiv.innerHTML = _this.localeValue.getConstant(_this.matchDivReplaceText);\n                    }\n                }\n            }\n        };\n        /**\n         * Fires on replace all.\n         * @private\n         */\n        this.onReplaceAllButtonClick = function () {\n            _this.replaceAll();\n            _this.resultsListBlock.style.display = 'none';\n            _this.messageDiv.innerHTML = '';\n        };\n        /**\n         * Fires on search icon.\n         * @private\n         */\n        this.searchIconClickInternal = function () {\n            // tslint:disable:no-any \n            var inputElement = document.getElementById(_this.viewer.owner.containerId + '_option_search_text_box');\n            // tslint:enable:no-any\n            var text = inputElement.value;\n            if (text === '') {\n                return;\n            }\n            if (_this.searchIcon.classList.contains('e-de-op-search-close-icon')) {\n                _this.searchIcon.classList.add('e-de-op-search-icon');\n                _this.searchIcon.classList.remove('e-de-op-search-close-icon');\n                inputElement.value = '';\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'block';\n                _this.resultsListBlock.style.display = 'none';\n                _this.matchDiv.style.display = 'none';\n                _this.occurrenceDiv.style.display = 'none';\n                _this.onEnableDisableReplaceButton();\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n                _this.clearSearchResultItems();\n                _this.viewer.owner.searchModule.clearSearchHighlight();\n                _this.viewer.renderVisiblePages();\n                return;\n            }\n            if (_this.searchIcon.classList.contains('e-de-op-search-icon') && text.length >= 1) {\n                _this.searchIcon.classList.add('e-de-op-search-close-icon');\n                _this.searchIcon.classList.remove('e-de-op-search-icon');\n                _this.onEnableDisableReplaceButton();\n            }\n            _this.clearSearchResultItems();\n            _this.viewer.owner.searchModule.clearSearchHighlight();\n            var patterns = _this.viewer.owner.searchModule.textSearch.stringToRegex(text, _this.findOption);\n            var endSelection = _this.viewer.selection.end;\n            var index = endSelection.getHierarchicalIndexInternal();\n            _this.results = _this.viewer.owner.searchModule.textSearch.findAll(patterns, _this.findOption, index);\n            if (_this.results != null && _this.results.length > 0) {\n                _this.navigateSearchResult();\n                _this.getMessageDivHeight();\n                var height = _this.isOptionsPane ? 215 : 292;\n                var resultsContainerHeight = _this.viewer.owner.getDocumentEditorElement().offsetHeight - height;\n                _this.resultsListBlock.style.height = resultsContainerHeight + 'px';\n            }\n            else {\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'block';\n                _this.resultsListBlock.style.display = 'none';\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n            }\n        };\n        /**\n         * Fires on getting next results.\n         * @private\n         */\n        this.navigateNextResultButtonClick = function () {\n            if (document.getElementById(_this.viewer.owner.containerId + '_list_box_container') != null &&\n                document.getElementById(_this.viewer.owner.containerId + '_list_box_container').style.display !== 'none') {\n                if (_this.results.currentIndex < _this.results.length - 1) {\n                    _this.results.currentIndex = _this.results.currentIndex + 1;\n                    var currentelement = _this.results.innerList[_this.results.currentIndex];\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.currentIndex + 1) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    for (var i = 0; i < _this.resultsListBlock.children.length; i++) {\n                        var list = _this.resultsListBlock.children[i];\n                        if (list.classList.contains('e-de-search-result-hglt')) {\n                            list.classList.remove('e-de-search-result-hglt');\n                            list.children[0].classList.remove('e-de-op-search-word-text');\n                            list.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var listElement = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (listElement.classList.contains('e-de-search-result-item')) {\n                        listElement.classList.remove('e-de-search-result-item');\n                        listElement.classList.add('e-de-search-result-hglt');\n                        listElement.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(listElement);\n                    }\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                else {\n                    var currentelement = _this.results.innerList[0];\n                    _this.results.currentIndex = 0;\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.currentIndex + 1) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    for (var j = 0; j < _this.resultsListBlock.children.length; j++) {\n                        var lists = _this.resultsListBlock.children[j];\n                        if (lists.classList.contains('e-de-search-result-hglt')) {\n                            lists.classList.remove('e-de-search-result-hglt');\n                            lists.children[0].classList.remove('e-de-op-search-word-text');\n                            lists.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var listElementsDiv = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (listElementsDiv.classList.contains('e-de-search-result-item')) {\n                        listElementsDiv.classList.remove('e-de-search-result-item');\n                        listElementsDiv.classList.add('e-de-search-result-hglt');\n                        listElementsDiv.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(listElementsDiv);\n                    }\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                _this.focusedIndex = _this.focusedElement.indexOf(_this.navigateToNextResult);\n            }\n        };\n        /**\n         * Fires on getting previous results.\n         * @private\n         */\n        this.navigatePreviousResultButtonClick = function () {\n            if (document.getElementById(_this.viewer.owner.containerId + '_list_box_container') != null &&\n                document.getElementById(_this.viewer.owner.containerId + '_list_box_container').style.display !== 'none') {\n                if (_this.results.currentIndex === 0) {\n                    _this.results.currentIndex = _this.results.length - 1;\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.length) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    for (var index = 0; index < _this.resultsListBlock.children.length; index++) {\n                        var list = _this.resultsListBlock.children[index];\n                        if (list.classList.contains('e-de-search-result-hglt')) {\n                            list.classList.remove('e-de-search-result-hglt');\n                            list.children[0].classList.remove('e-de-op-search-word-text');\n                            list.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var liElement = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (liElement.classList.contains('e-de-search-result-item')) {\n                        liElement.classList.remove('e-de-search-result-item');\n                        liElement.classList.add('e-de-search-result-hglt');\n                        liElement.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(liElement);\n                    }\n                    var currentelement = _this.results.innerList[_this.results.currentIndex];\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.currentIndex) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    _this.results.currentIndex = _this.results.currentIndex - 1;\n                    for (var j = 0; j < _this.resultsListBlock.children.length; j++) {\n                        var list = _this.resultsListBlock.children[j];\n                        if (list.classList.contains('e-de-search-result-hglt')) {\n                            list.classList.remove('e-de-search-result-hglt');\n                            list.children[0].classList.remove('e-de-op-search-word-text');\n                            list.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var listElements = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (listElements.classList.contains('e-de-search-result-item')) {\n                        listElements.classList.remove('e-de-search-result-item');\n                        listElements.classList.add('e-de-search-result-hglt');\n                        listElements.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(listElements);\n                    }\n                    var currentelement = _this.results.innerList[_this.results.currentIndex];\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                _this.focusedIndex = _this.focusedElement.indexOf(_this.navigateToPreviousResult);\n            }\n        };\n        /**\n         * Fires on key down\n         * @param {KeyboardEvent} event - Speficies key down actions.\n         * @private\n         */\n        this.onKeyDown = function (event) {\n            var code = event.which || event.keyCode;\n            if (code === 13 && event.keyCode !== 9 && event.keyCode !== 40) {\n                event.preventDefault();\n                _this.findDiv.style.height = '';\n                _this.onKeyDownInternal();\n            }\n            else if (code === 8 && (_this.searchInput.value.length === 0)) {\n                _this.resultContainer.style.display = 'block';\n            }\n            else if (event.keyCode !== 9 && event.keyCode !== 40 && event.keyCode !== 27) {\n                _this.viewer.owner.searchModule.clearSearchHighlight();\n                _this.clearSearchResultItems();\n                _this.viewer.renderVisiblePages();\n                _this.resultsListBlock.style.display = 'none';\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'none';\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n                if (_this.searchIcon.classList.contains('e-de-op-search-close-icon')) {\n                    _this.searchIcon.classList.add('e-de-op-search-icon');\n                    _this.searchIcon.classList.remove('e-de-op-search-close-icon');\n                }\n            }\n            else if (code === 27 && event.keyCode === 27) {\n                _this.showHideOptionsPane(false);\n            }\n        };\n        /**\n         * Close the optios pane.\n         * @private\n         */\n        this.close = function () {\n            _this.clearFocusElement();\n            _this.showHideOptionsPane(false);\n            _this.resultsListBlock.innerHTML = '';\n            _this.focusedIndex = 1;\n            _this.isOptionsPane = true;\n        };\n        /**\n         * Fires on results list block.\n         * @param {MouseEvent} args - Specifies which list was clicked.\n         * @private\n         */\n        this.resultListBlockClick = function (args) {\n            var currentlist = args.target;\n            var element = _this.resultsListBlock.children;\n            var index = 0;\n            for (var i = 0; i < element.length; i++) {\n                var list_1 = element[i];\n                if (list_1.classList.contains('e-de-search-result-hglt')) {\n                    list_1.classList.remove('e-de-search-result-hglt');\n                    list_1.children[0].classList.remove('e-de-op-search-word-text');\n                    list_1.classList.add('e-de-search-result-item');\n                }\n            }\n            var list;\n            for (var i = 0; i < element.length; i++) {\n                if (currentlist === element[i]) {\n                    index = i;\n                    list = element[i];\n                    if (list.classList.contains('e-de-search-result-item')) {\n                        list.classList.remove('e-de-search-result-item');\n                        list.classList.add('e-de-search-result-hglt');\n                        list.children[0].classList.add('e-de-op-search-word-text');\n                        _this.focusedIndex = _this.focusedElement.indexOf(list);\n                    }\n                }\n            }\n            var currentelement = _this.results.innerList[index];\n            _this.results.currentIndex = index;\n            // tslint:disable-next-line:max-line-length\n            _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (index + 1) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n            _this.viewer.owner.searchModule.navigate(currentelement);\n            _this.viewer.owner.searchModule.highlight(_this.results);\n            list.focus();\n        };\n        this.viewer = layoutViewer;\n    }\n    /**\n     * Get the module name.\n     */\n    OptionsPane.prototype.getModuleName = function () {\n        return 'OptionsPane';\n    };\n    /**\n     * Initialize the options pane.\n     * @param {L10n} localeValue - Specifies the localization based on culture.\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    OptionsPane.prototype.initOptionsPane = function (localeValue, isRtl) {\n        var viewer = this.viewer;\n        this.localeValue = localeValue;\n        this.optionsPane = createElement('div', { className: 'e-de-op', styles: 'display:none;' });\n        this.optionsPane.addEventListener('keydown', this.onKeyDownOnOptionPane);\n        this.searchDiv = createElement('div', {\n            className: this.viewer.owner.containerId + '_searchDiv e-de-op-header',\n            innerHTML: localeValue.getConstant(this.searchText)\n        });\n        this.optionsPane.appendChild(this.searchDiv);\n        // tslint:disable-next-line:max-line-length\n        this.closeButton = createElement('button', { className: 'e-de-op-close-button e-de-op-icon-btn e-btn e-flat e-icon-btn', id: 'close' });\n        this.optionsPane.appendChild(this.closeButton);\n        var closeSpan = createElement('span', { className: 'e-de-op-close-icon e-btn-icon e-icons' });\n        this.closeButton.appendChild(closeSpan);\n        this.focusedElement.push(this.closeButton);\n        this.findTab = createElement('div', { id: this.viewer.owner.containerId + '_findTabDiv', className: 'e-de-op-tab' });\n        this.optionsPane.appendChild(this.findTab);\n        var tabHeader = createElement('div', { className: 'e-tab-header' });\n        this.findTab.appendChild(tabHeader);\n        this.findTabButton = createElement('div', { innerHTML: localeValue.getConstant(this.findPaneText) });\n        this.focusedElement.push(this.findTabButtonHeader);\n        tabHeader.appendChild(this.findTabButton);\n        this.replaceTabButton = createElement('div', { innerHTML: localeValue.getConstant(this.replacePaneText) });\n        this.focusedElement.push(this.replaceTabButtonHeader);\n        tabHeader.appendChild(this.replaceTabButton);\n        var tabContent = createElement('div', { className: 'e-content' });\n        var findTabContent = createElement('div', { id: 'findTabContent' });\n        tabContent.appendChild(findTabContent);\n        this.findTabContentDiv = createElement('div', { className: 'e-de-search-tab-content' });\n        this.searchTextBoxContainer = createElement('div', { className: 'e-input-group e-de-op-input-group' });\n        this.findTabContentDiv.appendChild(this.searchTextBoxContainer);\n        // tslint:disable-next-line:max-line-length\n        this.searchInput = createElement('input', { className: 'e-input e-de-search-input', id: this.viewer.owner.containerId + '_option_search_text_box', attrs: { placeholder: localeValue.getConstant('Search for') } });\n        this.searchTextBoxContainer.appendChild(this.searchInput);\n        this.searchIcon = createElement('span', {\n            className: 'e-de-op-icon e-de-op-search-icon e-input-group-icon e-icon',\n            id: this.viewer.owner.containerId + '_search-icon'\n        });\n        this.searchIcon.tabIndex = 0;\n        this.searchTextBoxContainer.appendChild(this.searchIcon);\n        this.focusedElement.push(this.searchIcon);\n        // tslint:disable-next-line:max-line-length\n        this.navigateToPreviousResult = createElement('span', { className: 'e-de-op-icon e-de-op-nav-btn e-arrow-up e-spin-up e-btn-icon e-icon e-input-group-icon' });\n        this.navigateToPreviousResult.tabIndex = 0;\n        this.searchTextBoxContainer.appendChild(this.navigateToPreviousResult);\n        this.focusedElement.push(this.navigateToPreviousResult);\n        // tslint:disable-next-line:max-line-length\n        this.navigateToNextResult = createElement('span', { className: 'e-de-op-icon e-de-op-nav-btn e-arrow-down e-spin-down e-btn-icon e-icon e-input-group-icon' });\n        this.navigateToNextResult.tabIndex = 0;\n        this.searchTextBoxContainer.appendChild(this.navigateToNextResult);\n        this.focusedElement.push(this.navigateToNextResult);\n        var div = createElement('div', { className: 'e-de-op-more-less' });\n        this.matchInput = createElement('input', {\n            attrs: { type: 'checkbox' },\n            id: this.viewer.owner.containerId + '_matchCase'\n        });\n        div.appendChild(this.matchInput);\n        // tslint:disable-next-line:max-line-length\n        this.matchCase = new CheckBox({ label: localeValue.getConstant('Match case'), enableRtl: isRtl, checked: false, change: this.matchChange });\n        this.matchCase.appendTo(this.matchInput);\n        this.focusedElement.push(this.matchInput);\n        this.matchInput.tabIndex = 0;\n        var wholeWordLabel;\n        if (isRtl) {\n            wholeWordLabel = '_e-de-rtl';\n        }\n        else {\n            wholeWordLabel = '_e-de-ltr';\n        }\n        this.wholeInput = createElement('input', {\n            attrs: { type: 'checkbox' },\n            id: this.viewer.owner.containerId + '_wholeWord' + wholeWordLabel\n        });\n        div.appendChild(this.wholeInput);\n        // tslint:disable-next-line:max-line-length\n        this.wholeWord = new CheckBox({ label: localeValue.getConstant('Whole words'), enableRtl: isRtl, checked: false, change: this.wholeWordsChange });\n        this.wholeWord.appendTo(this.wholeInput);\n        this.focusedElement.push(this.wholeInput);\n        this.wholeInput.tabIndex = 0;\n        this.findTabContentDiv.appendChild(div);\n        var replaceTabContent = createElement('div');\n        tabContent.appendChild(replaceTabContent);\n        this.replaceTabContentDiv = createElement('div', { className: 'e-de-op-replacetabcontentdiv', styles: 'display:none;' });\n        tabContent.appendChild(this.replaceTabContentDiv);\n        this.findTabContentDiv.appendChild(this.replaceTabContentDiv);\n        this.createReplacePane(isRtl);\n        this.findDiv = createElement('div', { className: 'findDiv', styles: 'display:block;' });\n        findTabContent.appendChild(this.findTabContentDiv);\n        this.resultContainer = createElement('div', { styles: 'width:85%;display:block;', className: 'e-de-op-result-container' });\n        this.findDiv.appendChild(this.resultContainer);\n        // tslint:disable-next-line:max-line-length\n        this.messageDiv = createElement('div', { className: this.viewer.owner.containerId + '_messageDiv e-de-op-msg', innerHTML: this.localeValue.getConstant(this.messageDivText), id: this.viewer.owner.containerId + '_search_status' });\n        this.resultContainer.appendChild(this.messageDiv);\n        // tslint:disable-next-line:max-line-length\n        this.resultsListBlock = createElement('div', { id: this.viewer.owner.containerId + '_list_box_container', styles: 'display:none;width:270px;list-style:none;padding-right:5px;overflow:auto;', className: 'e-de-result-list-block' });\n        this.findDiv.appendChild(this.resultsListBlock);\n        this.findTabContentDiv.appendChild(this.findDiv);\n        this.findTab.appendChild(tabContent);\n        this.tabInstance = new Tab({ enableRtl: isRtl, selected: this.selectedTabItem });\n        this.tabInstance.appendTo(this.findTab);\n        var findHeader = this.tabInstance.element.getElementsByClassName('e-item e-toolbar-item')[0];\n        this.findTabButtonHeader = findHeader.getElementsByClassName('e-tab-wrap')[0];\n        this.findTabButtonHeader.classList.add('e-de-op-find-tab-header');\n        this.findTabButtonHeader.tabIndex = 0;\n        var replaceHeader = this.tabInstance.element.getElementsByClassName('e-item e-toolbar-item')[1];\n        this.replaceTabButtonHeader = replaceHeader.getElementsByClassName('e-tab-wrap')[0];\n        this.replaceTabButtonHeader.classList.add('e-de-op-replace-tab-header');\n        this.replaceTabButtonHeader.tabIndex = 0;\n        this.onWireEvents();\n        if (isRtl) {\n            this.optionsPane.classList.add('e-de-rtl');\n            this.closeButton.classList.add('e-de-rtl');\n            this.searchDiv.classList.add('e-de-rtl');\n            this.findTabButtonHeader.classList.add('e-de-rtl');\n        }\n    };\n    /**\n     * Create replace pane instances.\n     */\n    OptionsPane.prototype.createReplacePane = function (isRtl) {\n        this.replaceDiv = createElement('div');\n        this.replaceTabContentDiv.appendChild(this.replaceDiv);\n        this.replaceWith = createElement('input', {\n            className: 'e-de-op-replacewith e-input',\n            attrs: { placeholder: this.localeValue.getConstant('Replace with') }\n        });\n        this.replaceDiv.appendChild(this.replaceWith);\n        var replaceButtonDivTextAlign;\n        var replaceButtonMargin;\n        if (isRtl) {\n            replaceButtonDivTextAlign = 'text-align:left';\n            replaceButtonMargin = 'margin-left:10px';\n        }\n        else {\n            replaceButtonDivTextAlign = 'text-align:right';\n            replaceButtonMargin = 'margin-right:10px';\n        }\n        var replaceButtonDiv = createElement('div', { styles: replaceButtonDivTextAlign, className: 'e-de-op-dlg-footer' });\n        this.replaceDiv.appendChild(replaceButtonDiv);\n        this.replaceButton = createElement('button', {\n            className: 'e-control e-btn e-flat e-replace',\n            styles: replaceButtonMargin,\n            innerHTML: this.localeValue.getConstant(this.replaceButtonText)\n        });\n        replaceButtonDiv.appendChild(this.replaceButton);\n        this.replaceAllButton = createElement('button', {\n            className: 'e-control e-btn e-flat e-replaceall',\n            innerHTML: this.localeValue.getConstant(this.replaceAllButtonText)\n        });\n        replaceButtonDiv.appendChild(this.replaceAllButton);\n        this.matchDiv = createElement('div', { styles: 'display:none;padding-top:10px;' });\n        this.replaceDiv.appendChild(this.matchDiv);\n        var emptyDiv6 = createElement('div', { className: 'e-de-op-search-replacediv' });\n        this.replaceDiv.appendChild(emptyDiv6);\n        this.occurrenceDiv = createElement('div', { styles: 'display:none;' });\n        this.replaceDiv.appendChild(this.occurrenceDiv);\n    };\n    OptionsPane.prototype.navigateSearchResult = function () {\n        this.viewer.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]);\n        this.viewer.owner.searchModule.highlight(this.results);\n        this.viewer.owner.searchModule.addFindResultView(this.results);\n        this.resultsListBlock.style.display = 'block';\n        this.resultContainer.style.display = 'block';\n        var lists = this.viewer.owner.findResultsList;\n        var text = '';\n        for (var i = 0; i < lists.length; i++) {\n            text += lists[i];\n        }\n        this.clearFocusElement();\n        this.resultsListBlock.innerHTML = text;\n        for (var i = 0; i < this.resultsListBlock.children.length; i++) {\n            this.focusedElement.push(this.resultsListBlock.children[i]);\n        }\n        var currentIndexValue = this.results.currentIndex;\n        // tslint:disable-next-line:max-line-length\n        this.messageDiv.innerHTML = this.localeValue.getConstant('Result') + ' ' + (currentIndexValue + 1) + ' ' + this.localeValue.getConstant('of') + ' ' + this.resultsListBlock.children.length;\n        var listElement = this.resultsListBlock.children[currentIndexValue];\n        if (listElement.classList.contains('e-de-search-result-item')) {\n            listElement.classList.remove('e-de-search-result-item');\n            listElement.classList.add('e-de-search-result-hglt');\n            listElement.children[0].classList.add('e-de-op-search-word-text');\n            this.scrollToPosition(listElement);\n        }\n    };\n    /**\n     * Fires on key down actions done.\n     * @private\n     */\n    OptionsPane.prototype.onKeyDownInternal = function () {\n        // tslint:disable-next-line:max-line-length\n        var inputElement = document.getElementById(this.viewer.owner.containerId + '_option_search_text_box');\n        inputElement.blur();\n        var text = inputElement.value;\n        if (text === '') {\n            return;\n        }\n        if (text.length >= 1 && this.searchIcon.classList.contains('e-de-op-search-icon')) {\n            this.searchIcon.classList.add('e-de-op-search-close-icon');\n            this.searchIcon.classList.remove('e-de-op-search-icon');\n        }\n        var height = this.isOptionsPane ? 215 : 292;\n        var resultsContainerHeight = this.viewer.owner.getDocumentEditorElement().offsetHeight - height;\n        this.clearSearchResultItems();\n        this.viewer.owner.searchModule.clearSearchHighlight();\n        var pattern = this.viewer.owner.searchModule.textSearch.stringToRegex(text, this.findOption);\n        var endSelection = this.viewer.selection.end;\n        var index = endSelection.getHierarchicalIndexInternal();\n        this.results = this.viewer.owner.searchModule.textSearch.findAll(pattern, this.findOption, index);\n        var results = this.results;\n        if (isNullOrUndefined(results)) {\n            this.viewer.renderVisiblePages();\n        }\n        if (results != null && results.length > 0) {\n            if ((this.focusedElement.indexOf(this.navigateToPreviousResult) === -1) && this.isOptionsPane) {\n                this.focusedElement.push(this.navigateToPreviousResult);\n            }\n            if ((this.focusedElement.indexOf(this.navigateToNextResult) === -1) && this.isOptionsPane) {\n                this.focusedElement.push(this.navigateToNextResult);\n            }\n            this.viewer.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]);\n            this.viewer.owner.searchModule.highlight(results);\n            this.viewer.owner.searchModule.addFindResultView(results);\n            // if (this.isOptionsPane) {\n            this.resultsListBlock.style.display = 'block';\n            this.resultsListBlock.style.height = resultsContainerHeight + 'px';\n            this.resultContainer.style.display = 'block';\n            var list = this.viewer.owner.findResultsList;\n            var text_1 = '';\n            this.clearFocusElement();\n            this.resultsListBlock.innerHTML = '';\n            for (var i = 0; i < list.length; i++) {\n                text_1 += list[i];\n            }\n            this.resultsListBlock.innerHTML = text_1;\n            for (var i = 0; i < this.resultsListBlock.children.length; i++) {\n                this.focusedElement.push(this.resultsListBlock.children[i]);\n            }\n            var lists = this.resultsListBlock.children;\n            var currentIndex = this.results.currentIndex;\n            // tslint:disable-next-line:max-line-length\n            this.messageDiv.innerHTML = this.localeValue.getConstant('Result') + ' ' + (currentIndex + 1) + ' ' + this.localeValue.getConstant('of') + ' ' + this.resultsListBlock.children.length;\n            var listElement = this.resultsListBlock.children[currentIndex];\n            if (listElement.classList.contains('e-de-search-result-item')) {\n                listElement.classList.remove('e-de-search-result-item');\n                listElement.classList.add('e-de-search-result-hglt');\n                listElement.children[0].classList.add('e-de-op-search-word-text');\n            }\n            this.navigateToNextResult.focus();\n            this.focusedIndex = 6;\n            this.getMessageDivHeight();\n            // } else {\n            //this.focusedIndex = 4;\n            // }\n        }\n        else {\n            this.messageDiv.innerHTML = this.localeValue.getConstant('No matches');\n            this.resultContainer.style.display = 'block';\n            this.resultsListBlock.style.display = 'none';\n            this.clearFocusElement();\n            this.resultsListBlock.innerHTML = '';\n        }\n    };\n    OptionsPane.prototype.getMessageDivHeight = function () {\n        if (!this.isOptionsPane && this.messageDiv.classList.contains('e-de-op-msg')) {\n            this.messageDiv.classList.add('e-de-op-replace-messagediv');\n            this.messageDiv.classList.remove('e-de-op-msg');\n        }\n        else if (this.isOptionsPane && this.messageDiv.classList.contains('e-de-op-replace-messagediv')) {\n            this.messageDiv.classList.add('e-de-op-msg');\n            this.messageDiv.classList.remove('e-de-op-replace-messagediv');\n        }\n    };\n    /**\n     * Replace all.\n     * @private\n     */\n    OptionsPane.prototype.replaceAll = function () {\n        var optionsPane = this.optionsPane;\n        var findText = this.searchInput.value;\n        var replaceText = this.replaceWith.value;\n        if (findText !== '' && !isNullOrUndefined(findText)) {\n            var pattern = this.viewer.owner.searchModule.textSearch.stringToRegex(findText, this.findOption);\n            var endSelection = this.viewer.selection.end;\n            var index = endSelection.getHierarchicalIndexInternal();\n            var results = this.viewer.owner.searchModule.textSearch.findAll(pattern, this.findOption, index);\n            var replace = isNullOrUndefined(replaceText) ? '' : replaceText;\n            var count = isNullOrUndefined(results) ? 0 : results.length;\n            this.viewer.owner.searchModule.replaceAll(replace, results);\n            this.matchDiv.style.display = 'block';\n            this.matchDiv.innerHTML = this.localeValue.getConstant('All Done') + '!';\n            this.occurrenceDiv.style.display = 'block';\n            // tslint:disable-next-line:max-line-length\n            this.occurrenceDiv.innerHTML = this.localeValue.getConstant('We replaced all') + ' ' + count + ' ' + this.localeValue.getConstant('instances') + ' ' + this.localeValue.getConstant('of') + ' \"' + findText + '\" ' + this.localeValue.getConstant('with') + ' \"' + replaceText + '\" ';\n        }\n    };\n    /**\n     * Scrolls to position.\n     * @param {HTMLElement} list - Specifies the list element.\n     * @private\n     */\n    OptionsPane.prototype.scrollToPosition = function (list) {\n        var rect = list.getBoundingClientRect();\n        var top;\n        if (rect.top > 0) {\n            top = rect.top - list.parentElement.getBoundingClientRect().top;\n            if ((list.parentElement.offsetHeight - top) <= list.offsetHeight) {\n                if (Math.ceil(top + list.offsetHeight) === list.parentElement.scrollHeight) {\n                    list.parentElement.scrollTop = top;\n                }\n                list.parentElement.scrollTop = list.parentElement.scrollTop + (list.parentElement.offsetHeight / 100) * 30;\n            }\n            else if (top < 0) {\n                list.parentElement.scrollTop = list.parentElement.scrollTop - (list.parentElement.offsetHeight / 100) * 30;\n            }\n        }\n        else {\n            list.parentElement.scrollTop = 0;\n        }\n    };\n    /**\n     * Clear the focus elements.\n     * @private\n     */\n    OptionsPane.prototype.clearFocusElement = function () {\n        for (var i = 0; i < this.resultsListBlock.children.length; i++) {\n            var index = this.focusedElement.indexOf(this.resultsListBlock.children[i]);\n            if (index !== -1) {\n                this.focusedElement.splice(index, 1);\n            }\n        }\n        this.focusedIndex = 0;\n    };\n    /**\n     * Show or hide option pane based on boolean value.\n     * @param {boolean} show - Specifies showing or hiding the options pane.\n     * @private\n     */\n    OptionsPane.prototype.showHideOptionsPane = function (show) {\n        if (!isNullOrUndefined(this.viewer.owner.selectionModule)) {\n            if (show) {\n                this.localeValue = new L10n('documenteditor', this.viewer.owner.defaultLocale);\n                this.localeValue.setLocale(this.viewer.owner.locale);\n                if (isNullOrUndefined(this.optionsPane)) {\n                    this.initOptionsPane(this.localeValue, this.viewer.owner.enableRtl);\n                    //Add Option Pane\n                    var isRtl = this.viewer.owner.enableRtl;\n                    var optionsPaneContainerStyle = void 0;\n                    if (isRtl) {\n                        optionsPaneContainerStyle = 'display:inline-flex;direction:rtl;';\n                    }\n                    else {\n                        optionsPaneContainerStyle = 'display:inline-flex;';\n                    }\n                    this.viewer.optionsPaneContainer.setAttribute('style', optionsPaneContainerStyle);\n                    // tslint:disable-next-line:max-line-length\n                    this.viewer.optionsPaneContainer.insertBefore(this.viewer.owner.optionsPaneModule.optionsPane, this.viewer.viewerContainer);\n                }\n                this.optionsPane.style.display = 'block';\n                if (this.viewer.owner.isReadOnlyMode) {\n                    this.tabInstance.hideTab(1);\n                }\n                else {\n                    this.tabInstance.hideTab(1, false);\n                }\n                if (this.isReplace && !this.viewer.owner.isReadOnlyMode) {\n                    this.tabInstance.select(1);\n                    this.isReplace = false;\n                    this.isOptionsPane = false;\n                }\n                else {\n                    this.tabInstance.select(0);\n                }\n                this.searchDiv.innerHTML = this.localeValue.getConstant(this.searchText);\n                this.isOptionsPaneShow = true;\n                // tslint:disable-next-line:max-line-length\n                var textBox = document.getElementById(this.viewer.owner.getDocumentEditorElement().id + '_option_search_text_box');\n                var selectedText = this.viewer.owner.selection.text;\n                if (!isNullOrUndefined(selectedText)) {\n                    var char = ['\\v', '\\r'];\n                    var index = HelperMethods.indexOfAny(selectedText, char);\n                    selectedText = index < 0 ? selectedText : selectedText.substring(0, index);\n                }\n                textBox.value = selectedText;\n                textBox.select();\n                this.messageDiv.innerHTML = '';\n                if (this.searchIcon.classList.contains('e-de-op-search-close-icon')) {\n                    this.searchIcon.classList.add('e-de-op-search-icon');\n                    this.searchIcon.classList.remove('e-de-op-search-close-icon');\n                }\n                this.viewer.selection.caret.style.display = 'none';\n                this.focusedIndex = 3;\n                this.focusedElement = [];\n                if (this.isOptionsPane) {\n                    // tslint:disable-next-line:max-line-length\n                    this.focusedElement.push(this.closeButton, this.findTabButtonHeader, this.replaceTabButtonHeader, this.searchInput, this.searchIcon, this.navigateToPreviousResult, this.navigateToNextResult, this.matchInput, this.wholeInput);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    this.focusedElement.push(this.closeButton, this.findTabButtonHeader, this.replaceTabButtonHeader, this.searchInput, this.searchIcon, this.navigateToPreviousResult, this.navigateToNextResult, this.matchInput, this.wholeInput, this.replaceWith, this.replaceButton, this.replaceAllButton);\n                }\n                this.viewer.updateViewerSize();\n            }\n            else {\n                if (!isNullOrUndefined(this.optionsPane)) {\n                    this.clearSearchResultItems();\n                    this.viewer.owner.searchModule.clearSearchHighlight();\n                    this.isOptionsPaneShow = false;\n                    var resultListBox = document.getElementById(this.viewer.owner.containerId + '_list_box_container');\n                    var message = document.getElementById(this.viewer.owner.containerId + '_search_status');\n                    if (!isNullOrUndefined(resultListBox) && !isNullOrUndefined(message)) {\n                        resultListBox.style.display = 'none';\n                        this.clearFocusElement();\n                        resultListBox.innerHTML = '';\n                        message.innerHTML = this.localeValue.getConstant('No matches');\n                    }\n                }\n                this.viewer.updateViewerSize();\n                if (!isNullOrUndefined(this.optionsPane)) {\n                    if (this.optionsPane.style.display !== 'none') {\n                        this.viewer.selection.updateCaretPosition();\n                        this.optionsPane.style.display = 'none';\n                    }\n                }\n                this.viewer.updateFocus();\n                this.viewer.selection.caret.style.display = 'block';\n            }\n        }\n    };\n    /**\n     * Clears search results.\n     * @private\n     */\n    OptionsPane.prototype.clearSearchResultItems = function () {\n        if (!isNullOrUndefined(this.viewer.owner.findResultsList)) {\n            this.viewer.owner.findResultsList = [];\n        }\n    };\n    /**\n     * Dispose the internal objects which are maintained.\n     * @private\n     */\n    OptionsPane.prototype.destroy = function () {\n        if (this.optionsPane) {\n            this.optionsPane.innerHTML = '';\n            this.optionsPane = undefined;\n        }\n        if (this.resultsListBlock) {\n            this.resultsListBlock.innerHTML = '';\n            this.resultsListBlock = undefined;\n        }\n        if (this.messageDiv) {\n            this.messageDiv.innerHTML = '';\n            this.messageDiv = undefined;\n        }\n        if (this.resultContainer) {\n            this.resultContainer.innerHTML = '';\n        }\n        this.resultContainer = undefined;\n        if (this.searchInput) {\n            this.searchInput.value = '';\n            this.searchInput = undefined;\n        }\n        if (this.searchDiv) {\n            this.searchDiv.innerHTML = '';\n            this.searchDiv = undefined;\n        }\n        if (this.searchTextBoxContainer) {\n            this.searchTextBoxContainer.innerHTML = '';\n            this.searchTextBoxContainer = undefined;\n        }\n        if (this.replaceWith) {\n            this.replaceWith.innerHTML = '';\n            this.replaceWith = undefined;\n        }\n        if (this.findDiv) {\n            this.findDiv.innerHTML = '';\n            this.findDiv = undefined;\n        }\n        if (this.replaceButton) {\n            this.replaceButton.innerHTML = '';\n            this.replaceButton = undefined;\n        }\n        if (this.replaceAllButton) {\n            this.replaceAllButton.innerHTML = '';\n            this.replaceAllButton = undefined;\n        }\n        if (this.matchInput) {\n            this.matchInput.innerHTML = '';\n            this.matchCase = undefined;\n        }\n        if (this.wholeInput) {\n            this.wholeInput.innerHTML = '';\n            this.wholeWord = undefined;\n        }\n        // if (this.regularInput) {\n        //     this.regularInput.innerHTML = '';\n        //     this.regular = undefined;\n        // }\n        if (!isNullOrUndefined(this.results)) {\n            this.results.destroy();\n        }\n        if (this.focusedElement) {\n            this.focusedElement = [];\n        }\n        this.focusedElement = undefined;\n        this.destroyInternal();\n    };\n    /**\n     * Dispose the internal objects which are maintained.\n     */\n    OptionsPane.prototype.destroyInternal = function () {\n        if (this.searchText) {\n            this.searchText = undefined;\n        }\n        if (this.resultsText) {\n            this.resultsText = undefined;\n        }\n        if (this.messageDivText) {\n            this.messageDivText = undefined;\n        }\n        if (this.replaceButtonText) {\n            this.replaceButtonText = undefined;\n        }\n        if (this.replaceAllButtonText) {\n            this.replaceAllButtonText = undefined;\n        }\n    };\n    return OptionsPane;\n}());\nexport { OptionsPane };\n","/**\n * Search Result info\n */\nvar SearchResults = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SearchResults(search) {\n        this.searchModule = search;\n    }\n    Object.defineProperty(SearchResults.prototype, \"length\", {\n        /**\n         * Gets the length of search results.\n         */\n        get: function () {\n            return this.searchModule.textSearchResults.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SearchResults.prototype, \"index\", {\n        /**\n         * Gets the index of current search result.\n         */\n        get: function () {\n            return this.searchModule.textSearchResults.currentIndex;\n        },\n        /**\n         * Set the index of current search result.\n         */\n        set: function (value) {\n            if (this.length === 0 || value < 0 || value > this.searchModule.textSearchResults.length - 1) {\n                return;\n            }\n            this.searchModule.textSearchResults.currentIndex = value;\n            this.navigate(value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Replace text in current search result.\n     * @param textToReplace text to replace\n     * @private\n     */\n    SearchResults.prototype.replace = function (textToReplace) {\n        if (this.index === -1) {\n            return;\n        }\n        this.searchModule.replaceInternal(textToReplace);\n    };\n    /**\n     * Replace all the instance of search result.\n     * @param textToReplace text to replace\n     */\n    SearchResults.prototype.replaceAll = function (textToReplace) {\n        if (this.index === -1) {\n            return;\n        }\n        this.searchModule.replaceAllInternal(textToReplace);\n    };\n    /**\n     * @private\n     */\n    SearchResults.prototype.navigate = function (index) {\n        this.searchModule.navigate(this.searchModule.textSearchResults.currentSearchResult);\n        this.searchModule.highlight(this.searchModule.textSearchResults);\n    };\n    /**\n     * Clears all the instance of search result.\n     */\n    SearchResults.prototype.clear = function () {\n        this.searchModule.textSearchResults.clearResults();\n        this.searchModule.clearSearchHighlight();\n        this.searchModule.viewer.renderVisiblePages();\n    };\n    return SearchResults;\n}());\nexport { SearchResults };\n","import { Dictionary } from '../../base/dictionary';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { TextPosition } from '../selection/selection-helper';\nimport { TextElementBox, FieldElementBox } from '../viewer/page';\nimport { SearchWidgetInfo } from './text-search';\nimport { TextSearch } from '../search/text-search';\nimport { TextSearchResults } from '../search/text-search-results';\nimport { SearchResults } from './search-results';\n/**\n * Search module\n */\nvar Search = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function Search(owner) {\n        /**\n         * @private\n         */\n        this.searchHighlighters = undefined;\n        this.isHandledOddPageHeader = undefined;\n        this.isHandledEvenPageHeader = undefined;\n        this.isHandledOddPageFooter = undefined;\n        this.isHandledEvenPageFooter = undefined;\n        this.owner = owner;\n        this.searchHighlighters = new Dictionary();\n        this.textSearch = new TextSearch(this.owner);\n        this.textSearchResults = new TextSearchResults(this.owner);\n        this.searchResultsInternal = new SearchResults(this);\n    }\n    Object.defineProperty(Search.prototype, \"viewer\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Search.prototype, \"searchResults\", {\n        /**\n         * Gets the search results object.\n         */\n        get: function () {\n            return this.searchResultsInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Get the module name.\n     */\n    Search.prototype.getModuleName = function () {\n        return 'Search';\n    };\n    //#region Find & Find All\n    /**\n     * Finds the immediate occurrence of specified text from cursor position in the document.\n     * @param  {string} text\n     * @param  {FindOption} findOption? - Default value of ‘findOptions’ parameter is 'None'.\n     * @private\n     */\n    Search.prototype.find = function (text, findOptions) {\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        var result = this.textSearch.find(text, findOptions);\n        if (!isNullOrUndefined(result)) {\n            this.navigate(result);\n        }\n    };\n    /**\n     * Finds all occurrence of specified text in the document.\n     * @param  {string} text\n     * @param  {FindOption} findOption? - Default value of ‘findOptions’ parameter is 'None'.\n     */\n    Search.prototype.findAll = function (text, findOptions) {\n        if (isNullOrUndefined(text || text === '')) {\n            return;\n        }\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        var results = this.textSearch.findAll(text, findOptions);\n        if (!isNullOrUndefined(results) && results.length > 0) {\n            this.navigate(results.innerList[results.currentIndex]);\n            this.highlight(results);\n        }\n    };\n    //#endregion\n    //#region Replace and Replace All   \n    /**\n     * Replace the searched string with specified string\n     * @param  {string} replaceText\n     * @param  {TextSearchResult} result\n     * @param  {TextSearchResults} results\n     * @private\n     */\n    Search.prototype.replace = function (replaceText, result, results) {\n        if (isNullOrUndefined(this.viewer.owner) || this.viewer.owner.isReadOnlyMode || isNullOrUndefined(results)) {\n            return 0;\n        }\n        if (!isNullOrUndefined(this.viewer)) {\n            this.clearSearchHighlight();\n        }\n        this.navigate(result);\n        var endPosition = this.viewer.selection.start;\n        var index = results.indexOf(result);\n        if (index < 0) {\n            return 0;\n        }\n        this.owner.editorModule.insertText(replaceText, true);\n        var endTextPosition = result.end;\n        var startPosition = new TextPosition(this.viewer.owner);\n        startPosition.setPositionParagraph(endTextPosition.currentWidget, endPosition.offset - replaceText.length);\n        this.viewer.selection.selectRange(endPosition, startPosition);\n        var eventArgs = { source: this.viewer.owner };\n        this.viewer.owner.trigger('searchResultsChange', eventArgs);\n        return 1;\n    };\n    /**\n     * Find the textToFind string in current document and replace the specified string.\n     * @param  {string} textToFind\n     * @param  {string} textToReplace\n     * @param  {FindOption} findOptions? - Default value of ‘findOptions’ parameter is FindOption.None.\n     * @private\n     */\n    Search.prototype.replaceInternal = function (textToReplace, findOptions) {\n        if ((textToReplace === '' || isNullOrUndefined(textToReplace))) {\n            return;\n        }\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        var textToFind = this.textSearchResults.currentSearchResult.text;\n        var pattern = this.viewer.owner.searchModule.textSearch.stringToRegex(textToFind, findOptions);\n        var index = this.owner.selection.end.getHierarchicalIndexInternal();\n        var result = this.viewer.owner.searchModule.textSearch.findNext(pattern, findOptions, index);\n        if (!isNullOrUndefined(result)) {\n            this.navigate(result);\n            this.textSearchResults.addResult();\n            this.textSearchResults.innerList[0] = result;\n            this.replace(textToReplace, result, this.textSearchResults);\n            index = this.owner.selection.end.getHierarchicalIndexInternal();\n            result = this.textSearch.findNext(textToFind, findOptions, index);\n            if (result) {\n                this.textSearchResults.addResult();\n                this.textSearchResults.innerList[0] = result;\n                this.navigate(result);\n            }\n        }\n    };\n    /**\n     * Replace all the searched string with specified string\n     * @param  {string} replaceText\n     * @param  {TextSearchResults} results\n     * @private\n     */\n    Search.prototype.replaceAll = function (replaceText, results) {\n        if (isNullOrUndefined(this.viewer.owner) || this.viewer.owner.isReadOnlyMode || isNullOrUndefined(results)) {\n            return 0;\n        }\n        if (this.owner.editorHistory) {\n            this.owner.editorHistory.initComplexHistory(this.owner.selection, 'ReplaceAll');\n        }\n        var count = results.length;\n        this.viewer.owner.isLayoutEnabled = false;\n        for (var i = count - 1; i >= 0; i--) {\n            var result = results.innerList[i];\n            this.navigate(results.innerList[i]);\n            this.owner.editorModule.insertText(replaceText, true);\n            if (result.isHeader || result.isFooter) {\n                this.viewer.layout.updateHeaderFooterToParent(this.viewer.selection.start.paragraph.bodyWidget);\n            }\n            results.innerList[i].destroy();\n        }\n        if (this.owner.editorHistory && !isNullOrUndefined(this.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.editorHistory.updateComplexHistory();\n        }\n        else {\n            this.owner.editorModule.updateComplexWithoutHistory(2);\n        }\n        this.searchResults.clear();\n        return count;\n    };\n    /**\n     * Find the textToFind string in current document and replace the specified string.\n     * @param  {string} textToFind\n     * @param  {string} textToReplace\n     * @param  {FindOption} findOptions? - Default value of ‘findOptions’ parameter is FindOption.None.\n     * @private\n     */\n    Search.prototype.replaceAllInternal = function (textToReplace, findOptions) {\n        if ((textToReplace === '' || isNullOrUndefined(textToReplace))) {\n            return;\n        }\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        if (this.textSearchResults.length > 0) {\n            this.navigate(this.textSearchResults.innerList[this.textSearchResults.currentIndex]);\n            this.highlight(this.textSearchResults);\n            this.replaceAll(textToReplace, this.textSearchResults);\n        }\n    };\n    //#endregion\n    //#region Highlight Search Result\n    /**\n     * @private\n     */\n    Search.prototype.navigate = function (textSearchResult) {\n        if (textSearchResult) {\n            var start = textSearchResult.start;\n            var end = textSearchResult.end;\n            if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.owner.selection) && !isNullOrUndefined(start) &&\n                !isNullOrUndefined(end) && !isNullOrUndefined(start.paragraph) && !isNullOrUndefined(end.paragraph)) {\n                this.owner.selection.selectRange(start, end);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Search.prototype.highlight = function (textSearchResults) {\n        this.searchHighlighters = new Dictionary();\n        for (var i = 0; i < textSearchResults.innerList.length; i++) {\n            var result = textSearchResults.innerList[i];\n            this.highlightResult(result);\n        }\n        this.viewer.renderVisiblePages();\n    };\n    /**\n     * @private\n     */\n    Search.prototype.highlightResult = function (result) {\n        this.highlightSearchResult(result.start.paragraph, result.start, result.end);\n    };\n    /**\n     * Highlight search result\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Search.prototype.highlightSearchResult = function (paragraph, start, end) {\n        var selectionStartIndex = 0;\n        var selectionEndIndex = 0;\n        var startElement = null;\n        var endElement = null;\n        // tslint:disable-next-line:max-line-length\n        var lineWidget = this.viewer.selection.getStartLineWidget(paragraph, start, startElement, selectionStartIndex);\n        selectionStartIndex = lineWidget.index;\n        startElement = lineWidget.element;\n        var startLineWidget = startElement ? startElement.line : paragraph.childWidgets[0];\n        var endLine = this.viewer.selection.getEndLineWidget(end, endElement, selectionEndIndex);\n        selectionEndIndex = endLine.index;\n        endElement = endLine.element;\n        var endLineWidget = endElement ? endElement.line :\n            end.paragraph.childWidgets[end.paragraph.childWidgets.length - 1];\n        var top = this.viewer.selection.getTop(startLineWidget);\n        var left = this.viewer.selection.getLeftInternal(startLineWidget, startElement, selectionStartIndex);\n        if (!isNullOrUndefined(startLineWidget) && startLineWidget === endLineWidget) {\n            //find result ends in current line.\n            var right = this.viewer.selection.getLeftInternal(endLineWidget, endElement, selectionEndIndex);\n            var isRtlText = false;\n            if (endElement instanceof TextElementBox) {\n                isRtlText = endElement.isRightToLeft;\n            }\n            var width = 0;\n            width = Math.abs(right - left);\n            if (!isRtlText && startElement instanceof TextElementBox) {\n                isRtlText = startElement.isRightToLeft;\n            }\n            // Handled the highlighting approach as genric for normal and rtl text.\n            if (isRtlText || paragraph.bidi) {\n                // tslint:disable-next-line:max-line-length\n                var elementBox = this.viewer.selection.getElementsForward(startLineWidget, startElement, endElement, paragraph.bidi);\n                if (elementBox && elementBox.length > 1) {\n                    for (var i = 0; i < elementBox.length; i++) {\n                        var element = elementBox[i];\n                        var elementIsRTL = false;\n                        var index = element instanceof TextElementBox ? element.length : 1;\n                        if (element === startElement) {\n                            left = this.viewer.selection.getLeftInternal(startLineWidget, element, selectionStartIndex);\n                            right = this.viewer.selection.getLeftInternal(startLineWidget, element, index);\n                        }\n                        else if (element === endElement) {\n                            left = this.viewer.selection.getLeftInternal(startLineWidget, element, 0);\n                            right = this.viewer.selection.getLeftInternal(startLineWidget, element, selectionEndIndex);\n                        }\n                        else {\n                            left = this.viewer.selection.getLeftInternal(startLineWidget, element, 0);\n                            right = this.viewer.selection.getLeftInternal(startLineWidget, element, index);\n                        }\n                        if (element instanceof TextElementBox) {\n                            elementIsRTL = element.isRightToLeft;\n                        }\n                        width = Math.abs(right - left);\n                        this.createHighlightBorder(startLineWidget, width, elementIsRTL ? right : left, top);\n                    }\n                }\n                else {\n                    this.createHighlightBorder(startLineWidget, width, isRtlText ? right : left, top);\n                }\n            }\n            else {\n                // Start element and end element will be in reverese for Bidi paragraph highlighting. \n                // So, the right is considered based on Bidi property. \n                this.createHighlightBorder(startLineWidget, width, left, top);\n            }\n        }\n        else {\n            if (!isNullOrUndefined(startLineWidget)) {\n                if (paragraph !== startLineWidget.paragraph) {\n                    paragraph = startLineWidget.paragraph;\n                }\n                var width = this.viewer.selection.getWidth(startLineWidget, true) - (left - startLineWidget.paragraph.x);\n                // Handled the  highlighting approach as genric for normal and rtl text.\n                if (paragraph.bidi || (startElement instanceof TextElementBox && startElement.isRightToLeft)) {\n                    var right = 0;\n                    // tslint:disable-next-line:max-line-length\n                    var elementCollection = this.viewer.selection.getElementsForward(startLineWidget, startElement, endElement, paragraph.bidi);\n                    if (elementCollection) {\n                        var elementIsRTL = false;\n                        for (var i = 0; i < elementCollection.length; i++) {\n                            var element = elementCollection[i];\n                            var index = element instanceof TextElementBox ? element.length : 1;\n                            right = this.viewer.selection.getLeftInternal(startLineWidget, element, index);\n                            elementIsRTL = false;\n                            if (element === startElement) {\n                                left = this.viewer.selection.getLeftInternal(startLineWidget, element, selectionStartIndex);\n                            }\n                            else {\n                                left = this.viewer.selection.getLeftInternal(startLineWidget, element, 0);\n                            }\n                            if (element instanceof TextElementBox) {\n                                elementIsRTL = element.isRightToLeft;\n                            }\n                            width = Math.abs(right - left);\n                            this.createHighlightBorder(startLineWidget, width, elementIsRTL ? right : left, top);\n                        }\n                        // Highlight the Paragrph mark for last line.\n                    }\n                }\n                else {\n                    this.createHighlightBorder(startLineWidget, width, left, top);\n                }\n                var lineIndex = startLineWidget.paragraph.childWidgets.indexOf(startLineWidget);\n                //Iterates to last item of paragraph or search result end.\n                for (var i = 0; i < paragraph.childWidgets.length; i++) {\n                    if (paragraph === startLineWidget.paragraph) {\n                        lineIndex += 1;\n                    }\n                    this.highlightSearchResultParaWidget(paragraph, lineIndex, endLineWidget, endElement, selectionEndIndex);\n                    if (paragraph === endLineWidget.paragraph) {\n                        return;\n                    }\n                    else {\n                        lineIndex = 0;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Search.prototype.createHighlightBorder = function (lineWidget, width, left, top) {\n        var findHighLight = this.addSearchHighlightBorder(lineWidget);\n        var page = this.viewer.owner.selection.getPage(lineWidget.paragraph);\n        var pageTop = page.boundingRectangle.y;\n        var pageLeft = page.boundingRectangle.x;\n        findHighLight.left = Math.ceil(left);\n        top = Math.ceil(top);\n        findHighLight.width = Math.floor(width);\n        var height = Math.floor(lineWidget.height);\n        var context = this.viewer.containerContext;\n    };\n    /**\n     * Adds search highlight border.\n     * @private\n     */\n    Search.prototype.addSearchHighlightBorder = function (lineWidget) {\n        var highlighters = undefined;\n        if (this.searchHighlighters.containsKey(lineWidget)) {\n            highlighters = this.searchHighlighters.get(lineWidget);\n        }\n        else {\n            highlighters = [];\n            this.searchHighlighters.add(lineWidget, highlighters);\n        }\n        var searchHighlight = new SearchWidgetInfo(0, 0);\n        highlighters.push(searchHighlight);\n        return searchHighlight;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Search.prototype.highlightSearchResultParaWidget = function (widget, startIndex, endLine, endElement, endIndex) {\n        var top = 0;\n        var width = 0;\n        var isRtlText = false;\n        for (var j = startIndex; j < widget.childWidgets.length; j++) {\n            var lineWidget = widget.childWidgets[j];\n            if (j === startIndex) {\n                top = this.viewer.selection.getTop(lineWidget);\n            }\n            var left = this.viewer.selection.getLeft(lineWidget);\n            if (endElement instanceof TextElementBox) {\n                isRtlText = endElement.isRightToLeft;\n            }\n            if (lineWidget === endLine) {\n                //Selection ends in current line.\n                var right = 0;\n                // Handled the highlighting using the element box highlighting approach as genric for normal and rtl text.\n                if (isRtlText || widget.bidi) {\n                    // tslint:disable-next-line:max-line-length\n                    var elementBox = this.viewer.selection.getElementsBackward(lineWidget, endElement, endElement, widget.bidi);\n                    for (var i = 0; i < elementBox.length; i++) {\n                        var element = elementBox[i];\n                        var elementIsRTL = false;\n                        left = this.viewer.selection.getLeftInternal(lineWidget, element, 0);\n                        if (element === endElement) {\n                            right = this.viewer.selection.getLeftInternal(lineWidget, element, endIndex);\n                        }\n                        else {\n                            var index = element instanceof TextElementBox ? element.length : 1;\n                            right = this.viewer.selection.getLeftInternal(lineWidget, element, index);\n                        }\n                        if (element instanceof TextElementBox) {\n                            elementIsRTL = element.isRightToLeft;\n                        }\n                        width = Math.abs(right - left);\n                        this.createHighlightBorder(lineWidget, width, elementIsRTL ? right : left, top);\n                    }\n                    return;\n                }\n                else {\n                    right = this.viewer.selection.getLeftInternal(endLine, endElement, endIndex);\n                    width = Math.abs(right - left);\n                    this.createHighlightBorder(lineWidget, width, isRtlText ? right : left, top);\n                    return;\n                }\n            }\n            else {\n                width = this.viewer.selection.getWidth(lineWidget, true) - (left - widget.x);\n                this.createHighlightBorder(lineWidget, width, left, top);\n                top += lineWidget.height;\n            }\n        }\n    };\n    //#endregion\n    //#region Get find result view\n    /**\n     * @private\n     */\n    Search.prototype.addSearchResultItems = function (result) {\n        if (isNullOrUndefined(result) || result === '') {\n            return;\n        }\n        if (isNullOrUndefined(this.owner.findResultsList)) {\n            this.owner.findResultsList = [];\n        }\n        this.owner.findResultsList.push(result);\n    };\n    /**\n     * @private\n     */\n    Search.prototype.addFindResultView = function (textSearchResults) {\n        for (var i = 0; i < textSearchResults.innerList.length; i++) {\n            var result = textSearchResults.innerList[i];\n            this.addFindResultViewForSearch(result);\n        }\n        this.isHandledOddPageHeader = true;\n        this.isHandledOddPageFooter = true;\n        this.isHandledEvenPageHeader = true;\n        this.isHandledEvenPageFooter = true;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Search.prototype.addFindResultViewForSearch = function (result) {\n        if (result.start != null && result.end != null && result.start.paragraph != null && result.end.paragraph != null) {\n            var prefixText = void 0;\n            var suffixtext = void 0;\n            var currentText = void 0;\n            var startIndex = 0;\n            var inlineObj = result.start.currentWidget.getInline(result.start.offset, startIndex);\n            var inline = inlineObj.element;\n            startIndex = inlineObj.index;\n            var prefix = '';\n            var lastIndex = 0;\n            if (inline instanceof FieldElementBox) {\n                var elementInfo = this.owner.selection.getRenderedInline(inline, startIndex);\n                if (elementInfo.element.nextNode instanceof TextElementBox) {\n                    inline = elementInfo.element.nextNode;\n                    startIndex = elementInfo.index;\n                }\n                else {\n                    inline = elementInfo.element;\n                    startIndex = elementInfo.index;\n                }\n            }\n            var boxObj = this.owner.selection.getElementBoxInternal(inline, startIndex);\n            var box = boxObj.element;\n            startIndex = boxObj.index;\n            if (box != null) {\n                if (box instanceof TextElementBox && startIndex > 0) {\n                    prefix = box.text.substring(0, startIndex);\n                }\n                var boxIndex = box.line.children.indexOf(box);\n                // tslint:disable-next-line:max-line-length\n                lastIndex = prefix.lastIndexOf(' ');\n                while (lastIndex < 0 && boxIndex > 0 && box.line.children[boxIndex - 1] instanceof TextElementBox) {\n                    prefix = box.line.children[boxIndex - 1].text + prefix;\n                    boxIndex--;\n                    lastIndex = prefix.lastIndexOf(' ');\n                }\n            }\n            var shiftIndex = prefix.lastIndexOf('\\v');\n            if (shiftIndex > 0) {\n                prefix = prefix.substring(0, shiftIndex);\n            }\n            else {\n                lastIndex = prefix.lastIndexOf(' ');\n                prefixText = lastIndex < 0 ? prefix : prefix.substring(lastIndex + 1);\n            }\n            currentText = result.text;\n            var endIndex = 0;\n            var endInlineObj = result.end.currentWidget.getInline(result.end.offset, endIndex);\n            var endInline = endInlineObj.element;\n            endIndex = endInlineObj.index;\n            suffixtext = '';\n            //Checks prefix element box is empty\n            if (boxObj != null) {\n                // Gets the element box using endIndex of the text and set as suffix\n                boxObj = this.owner.selection.getElementBoxInternal(endInline, endIndex);\n                box = boxObj.element;\n                endIndex = boxObj.index;\n            }\n            //Checks suffix element box is empty.\n            if (box != null) {\n                if (box instanceof TextElementBox && endIndex < box.length) {\n                    suffixtext = box.text.substring(endIndex);\n                }\n                var boxIndex = box.line.children.indexOf(box);\n                // tslint:disable-next-line:max-line-length\n                while (boxIndex + 1 < box.line.children.length && (box.line.children[boxIndex + 1] instanceof TextElementBox) || (box.line.children[boxIndex + 1] instanceof FieldElementBox)) {\n                    if (box.line.children[boxIndex + 1] instanceof FieldElementBox) {\n                        boxIndex = boxIndex + 2;\n                    }\n                    else {\n                        suffixtext = suffixtext + box.line.children[boxIndex + 1].text;\n                        boxIndex = boxIndex + 1;\n                    }\n                }\n            }\n            lastIndex = suffixtext.lastIndexOf(' ');\n            suffixtext = suffixtext === '\\v' ? suffixtext = '' : suffixtext;\n            var headerFooterString = '';\n            if (result.isHeader) {\n                headerFooterString = '<span class=\"e-de-header-footer-list\">' + 'Header' + ': ' + '</span>';\n            }\n            else if (result.isFooter) {\n                headerFooterString = '<span class=\"e-de-header-footer-list\">' + 'Footer' + ': ' + '</span>';\n            }\n            else {\n                headerFooterString = '';\n                headerFooterString = '';\n                this.isHandledOddPageHeader = true;\n                this.isHandledEvenPageHeader = true;\n                this.isHandledOddPageFooter = true;\n                this.isHandledEvenPageFooter = true;\n            }\n            var listElement = '';\n            var page = result.viewer.selection.getPage(result.start.paragraph);\n            if (isNullOrUndefined(this.isHandledEvenPageHeader) && isNullOrUndefined(this.isHandledEvenPageFooter)) {\n                this.isHandledEvenPageHeader = true;\n                this.isHandledEvenPageFooter = true;\n            }\n            else if (isNullOrUndefined(this.isHandledOddPageHeader) && isNullOrUndefined(this.isHandledOddPageFooter)) {\n                this.isHandledOddPageHeader = true;\n                this.isHandledOddPageFooter = true;\n            }\n            if (result.isHeader) {\n                if (page.headerWidget.headerFooterType === 'FirstPageHeader' && page.bodyWidgets[0].sectionFormat.differentFirstPage) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                }\n                else if (page.headerWidget.headerFooterType === 'EvenHeader' && this.isHandledEvenPageHeader) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledEvenPageHeader = false;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (page.headerWidget.headerFooterType === 'OddHeader' && this.isHandledOddPageHeader) {\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledOddPageHeader = false;\n                }\n            }\n            else if (result.isFooter) {\n                if (page.footerWidget.headerFooterType === 'FirstPageFooter' && page.bodyWidgets[0].sectionFormat.differentFirstPage) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                }\n                else if (page.footerWidget.headerFooterType === 'EvenFooter' && this.isHandledEvenPageFooter) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledEvenPageFooter = false;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (page.footerWidget.headerFooterType === 'OddFooter' && this.isHandledOddPageFooter) {\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledOddPageFooter = false;\n                }\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (!result.isHeader && !result.isFooter) {\n                listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n            }\n            this.addSearchResultItems(listElement);\n        }\n    };\n    //#endregion\n    /**\n     * Clears search highlight.\n     * @private\n     */\n    Search.prototype.clearSearchHighlight = function () {\n        if (!isNullOrUndefined(this.searchHighlighters)) {\n            this.searchHighlighters.clear();\n            this.searchHighlighters = undefined;\n        }\n        var eventArgs = { source: this.viewer.owner };\n        this.viewer.owner.trigger('searchResultsChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    Search.prototype.destroy = function () {\n        if (this.textSearchResults) {\n            this.textSearchResults.destroy();\n        }\n    };\n    return Search;\n}());\nexport { Search };\n","/**\n * @private\n */\nvar TextSearchResult = /** @class */ (function () {\n    function TextSearchResult(owner) {\n        this.startIn = undefined;\n        this.endIn = undefined;\n        this.owner = owner;\n    }\n    Object.defineProperty(TextSearchResult.prototype, \"viewer\", {\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResult.prototype, \"start\", {\n        get: function () {\n            return this.startIn;\n        },\n        set: function (value) {\n            this.startIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResult.prototype, \"end\", {\n        get: function () {\n            return this.endIn;\n        },\n        set: function (value) {\n            this.endIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResult.prototype, \"text\", {\n        get: function () {\n            return this.viewer.selection.getTextInternal(this.start, this.end, false);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextSearchResult.prototype.destroy = function () {\n        this.start = undefined;\n        this.end = undefined;\n    };\n    return TextSearchResult;\n}());\nexport { TextSearchResult };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { TextSearchResult } from './text-search-result';\n/**\n * @private\n */\nvar TextSearchResults = /** @class */ (function () {\n    function TextSearchResults(owner) {\n        this.currentIndex = -1;\n        this.owner = owner;\n    }\n    Object.defineProperty(TextSearchResults.prototype, \"length\", {\n        get: function () {\n            if (this.innerList === undefined) {\n                return 0;\n            }\n            return this.innerList.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResults.prototype, \"currentSearchResult\", {\n        get: function () {\n            if (this.innerList === undefined || this.currentIndex < 0 || this.currentIndex >= this.length) {\n                return undefined;\n            }\n            return this.innerList[this.currentIndex];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextSearchResults.prototype.addResult = function () {\n        var textSearchResult = new TextSearchResult(this.owner);\n        if (isNullOrUndefined(this.innerList)) {\n            this.innerList = [];\n        }\n        this.innerList.push(textSearchResult);\n        return textSearchResult;\n    };\n    TextSearchResults.prototype.clearResults = function () {\n        this.currentIndex = -1;\n        if (!isNullOrUndefined(this.innerList)) {\n            for (var i = this.innerList.length - 1; i >= 0; i--) {\n                this.innerList[i].destroy();\n                this.innerList.splice(i, 1);\n            }\n        }\n    };\n    TextSearchResults.prototype.indexOf = function (result) {\n        if (isNullOrUndefined(this.innerList)) {\n            return -1;\n        }\n        return this.innerList.indexOf(result);\n    };\n    TextSearchResults.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.innerList)) {\n            this.clearResults();\n        }\n        this.innerList = undefined;\n    };\n    return TextSearchResults;\n}());\nexport { TextSearchResults };\n","import { Dictionary } from '../../base/dictionary';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { TextPosition } from '../selection/selection-helper';\nimport { TextElementBox, ParagraphWidget, ListTextElementBox, FieldElementBox } from '../viewer/page';\n/**\n * @private\n */\nvar TextSearch = /** @class */ (function () {\n    function TextSearch(owner) {\n        this.wordBefore = '\\\\b';\n        this.wordAfter = '\\\\b';\n        this.isHeader = false;\n        this.isFooter = false;\n        this.owner = owner;\n    }\n    Object.defineProperty(TextSearch.prototype, \"viewer\", {\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextSearch.prototype.find = function (pattern, findOption) {\n        return this.findNext(pattern, findOption, '0;0;0');\n    };\n    // tslint:disable-next-line:max-line-length   \n    TextSearch.prototype.findNext = function (pattern, findOption, hierarchicalPosition) {\n        if (typeof pattern === 'string') {\n            pattern = this.stringToRegex(pattern, findOption);\n        }\n        if (hierarchicalPosition === undefined) {\n            hierarchicalPosition = '0;0;0';\n        }\n        this.owner.searchModule.textSearchResults.clearResults();\n        var results = this.owner.searchModule.textSearchResults;\n        this.findDocument(results, pattern, true, findOption, hierarchicalPosition);\n        return results.length > 0, results.currentSearchResult;\n    };\n    TextSearch.prototype.stringToRegex = function (textToFind, option) {\n        if (textToFind.indexOf('\\\\') > -1) {\n            textToFind = textToFind.split('\\\\').join('\\\\\\\\');\n        }\n        if (textToFind.indexOf('.') > -1) {\n            textToFind = '\\\\' + textToFind;\n        }\n        if (option === 'WholeWord' || option === 'CaseSensitiveWholeWord') {\n            textToFind = this.wordBefore + textToFind + this.wordAfter;\n        }\n        return new RegExp(textToFind, (option === 'CaseSensitive' || option === 'CaseSensitiveWholeWord') ? 'g' : 'ig');\n    };\n    TextSearch.prototype.isPatternEmpty = function (pattern) {\n        var wordEmpty = this.wordBefore + this.wordAfter;\n        var patternRegExp = pattern.toString();\n        return (patternRegExp.length === 0 || patternRegExp === wordEmpty);\n    };\n    // tslint:disable-next-line:max-line-length     \n    TextSearch.prototype.findAll = function (pattern, findOption, hierarchicalPosition) {\n        if (typeof pattern === 'string') {\n            pattern = this.stringToRegex(pattern, findOption);\n        }\n        if (hierarchicalPosition === undefined) {\n            hierarchicalPosition = '0;0;0';\n        }\n        this.owner.searchModule.textSearchResults.clearResults();\n        var results = this.owner.searchModule.textSearchResults;\n        this.findDocument(results, pattern, false, findOption, hierarchicalPosition);\n        if (results.length > 0 && results.currentIndex < 0) {\n            results.currentIndex = 0;\n        }\n        if (!isNullOrUndefined(results.currentSearchResult)) {\n            var eventArgs = { source: this.viewer.owner };\n            this.viewer.owner.trigger('searchResultsChange', eventArgs);\n            return results;\n        }\n        return undefined;\n    };\n    // tslint:disable-next-line:max-line-length     \n    TextSearch.prototype.findDocument = function (results, pattern, isFirstMatch, findOption, hierachicalPosition) {\n        if (this.isPatternEmpty(pattern)) {\n            return;\n        }\n        if (findOption === undefined) {\n            findOption = 'None';\n        }\n        var inline = undefined;\n        var selectionEnd = undefined;\n        if (hierachicalPosition !== undefined) {\n            selectionEnd = this.owner.selection.end;\n        }\n        if (hierachicalPosition !== undefined && isFirstMatch && selectionEnd !== undefined && selectionEnd.paragraph !== undefined) {\n            if (selectionEnd.paragraph instanceof ParagraphWidget) {\n                var indexInInline = 0;\n                // tslint:disable-next-line:max-line-length \n                // IndexInInline Handled specifically for simple find operation to start from starting point\n                var inlineElement = selectionEnd.currentWidget.getInline(this.owner.selection.start.offset, indexInInline);\n                inline = inlineElement.element;\n                indexInInline = inlineElement.index;\n                if (!isNullOrUndefined(inline)) {\n                    var nextParagraphWidget = undefined;\n                    // tslint:disable-next-line:max-line-length  \n                    nextParagraphWidget = this.findInline(inline, pattern, findOption, indexInInline, isFirstMatch, results, selectionEnd);\n                    while (results.length === 0 && !isNullOrUndefined(nextParagraphWidget)) {\n                        while (!isNullOrUndefined(nextParagraphWidget) && nextParagraphWidget.childWidgets.length === 0) {\n                            // tslint:disable-next-line:max-line-length \n                            nextParagraphWidget = this.owner.selection.getNextParagraph(nextParagraphWidget.containerWidget);\n                        }\n                        if (isNullOrUndefined(nextParagraphWidget)) {\n                            break;\n                        }\n                        var lineWidget = nextParagraphWidget.childWidgets[0];\n                        if (lineWidget.children[0] instanceof ListTextElementBox) {\n                            inline = (lineWidget.children[2] instanceof TextElementBox) ? lineWidget.children[2] : undefined;\n                        }\n                        else {\n                            inline = lineWidget.children[0];\n                        }\n                        if (isNullOrUndefined(inline)) {\n                            break;\n                        }\n                        // tslint:disable-next-line:max-line-length  \n                        nextParagraphWidget = this.findInline(inline, pattern, findOption, 0, isFirstMatch, results, selectionEnd);\n                    }\n                    if (results.length > 0) {\n                        return;\n                    }\n                }\n            }\n        }\n        var section;\n        section = this.viewer.pages[0].bodyWidgets[0];\n        while (!isNullOrUndefined(section) && section.childWidgets.length === 0) {\n            section = section.nextWidget;\n        }\n        if (isNullOrUndefined(section) || section.childWidgets.length === 0) {\n            return;\n        }\n        this.isHeader = false;\n        this.isFooter = false;\n        this.findInlineText(section, pattern, findOption, isFirstMatch, results, selectionEnd);\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var headerWidget = this.viewer.pages[i].headerWidget;\n            if (!isNullOrUndefined(headerWidget)) {\n                this.isHeader = true;\n                this.isFooter = false;\n                this.findInlineText(headerWidget, pattern, findOption, isFirstMatch, results, selectionEnd);\n            }\n        }\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var footerWidget = this.viewer.pages[i].footerWidget;\n            if (!isNullOrUndefined(footerWidget)) {\n                this.isHeader = false;\n                this.isFooter = true;\n                this.findInlineText(footerWidget, pattern, findOption, isFirstMatch, results, selectionEnd);\n            }\n        }\n        if (isFirstMatch && !isNullOrUndefined(results) && results.length > 0) {\n            return;\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    TextSearch.prototype.findInlineText = function (section, pattern, findOption, isFirstMatch, results, selectionEnd) {\n        var paragraphWidget = this.owner.selection.getFirstParagraphBlock(section.childWidgets[0]);\n        // tslint:disable-next-line:max-line-length \n        while (!isNullOrUndefined(paragraphWidget) && paragraphWidget.childWidgets.length === 1 && paragraphWidget.childWidgets[0].children.length === 0) {\n            paragraphWidget = this.owner.selection.getNextParagraphBlock(paragraphWidget);\n        }\n        while (!isNullOrUndefined(paragraphWidget) && paragraphWidget.childWidgets.length > 0) {\n            var inlineElement = paragraphWidget.childWidgets[0];\n            var inlineEle = inlineElement.children[0];\n            if (isNullOrUndefined(inlineEle)) {\n                break;\n            }\n            this.findInline(inlineEle, pattern, findOption, 0, isFirstMatch, results, selectionEnd);\n            paragraphWidget = this.owner.selection.getNextParagraphBlock(paragraphWidget);\n            // tslint:disable-next-line:max-line-length \n            while (!isNullOrUndefined(paragraphWidget) && (paragraphWidget.childWidgets.length === 1) && paragraphWidget.childWidgets[0].children.length === 0) {\n                paragraphWidget = this.owner.selection.getNextParagraphBlock(paragraphWidget);\n            }\n        }\n        if (isFirstMatch && !isNullOrUndefined(results) && results.length > 0) {\n            return;\n        }\n    };\n    // tslint:disable-next-line:max-line-length     \n    TextSearch.prototype.findInline = function (inlineElement, pattern, option, indexInInline, isFirstMatch, results, selectionEnd) {\n        var inlines = inlineElement;\n        var stringBuilder = '';\n        var spans = new Dictionary();\n        //tslint:disable no-constant-condition\n        do {\n            // tslint:disable-next-line:max-line-length \n            if (inlineElement instanceof TextElementBox && (!isNullOrUndefined(inlineElement.text) && inlineElement.text !== '')) {\n                spans.add(inlineElement, stringBuilder.length);\n                // IndexInInline Handled specifically for simple find operation to start from starting point\n                if (inlineElement === inlines) {\n                    stringBuilder = stringBuilder + (inlineElement.text.substring(indexInInline));\n                }\n                else {\n                    stringBuilder = stringBuilder + (inlineElement.text);\n                }\n            }\n            else if (inlineElement instanceof FieldElementBox) {\n                var fieldBegin = inlineElement;\n                if (!isNullOrUndefined(fieldBegin.fieldEnd)) {\n                    // tslint:disable-next-line:max-line-length \n                    inlineElement = isNullOrUndefined(fieldBegin.fieldSeparator) ? fieldBegin.fieldEnd : fieldBegin.fieldSeparator;\n                }\n            }\n            if (!isNullOrUndefined(inlineElement) && isNullOrUndefined(inlineElement.nextNode)) {\n                break;\n            }\n            if (!isNullOrUndefined(inlineElement)) {\n                inlineElement = inlineElement.nextNode;\n            }\n        } while (true);\n        var text = stringBuilder.toString();\n        var matches = [];\n        var matchObject;\n        //tslint:disable no-conditional-assignment\n        while (!isNullOrUndefined(matchObject = pattern.exec(text))) {\n            matches.push(matchObject);\n        }\n        for (var i = 0; i < matches.length; i++) {\n            var match = matches[i];\n            var result = results.addResult();\n            var spanKeys = spans.keys;\n            for (var i_1 = 0; i_1 < spanKeys.length; i_1++) {\n                var span = spanKeys[i_1];\n                var startIndex = spans.get(span);\n                var spanLength = span.length;\n                // IndexInInline Handled specifically for simple find operation to start from starting point\n                if (span === inlines) {\n                    spanLength -= indexInInline;\n                }\n                if (isNullOrUndefined(result.start) && match.index < startIndex + spanLength) {\n                    var index = match.index - startIndex;\n                    // IndexInInline Handled specifically for simple find operation to start from starting point\n                    if (span === inlines) {\n                        index += indexInInline;\n                    }\n                    var offset = (span.line).getOffset(span, index);\n                    result.start = this.getTextPosition(span.line, offset.toString());\n                    result.start.location = this.owner.selection.getPhysicalPositionInternal(span.line, offset, true);\n                    result.start.setPositionParagraph(span.line, offset);\n                }\n                if (match.index + match[0].length <= startIndex + spanLength) {\n                    var index = (match.index + match[0].length) - startIndex;\n                    // IndexInInline Handled specifically for simple find operation to start from starting point\n                    if (span === inlines) {\n                        index += indexInInline;\n                    }\n                    var offset = (span.line).getOffset(span, index);\n                    result.end = this.getTextPosition(span.line, offset.toString());\n                    result.end.location = this.owner.selection.getPhysicalPositionInternal(span.line, offset, true);\n                    result.end.setPositionParagraph(span.line, offset);\n                    break;\n                }\n            }\n            result.isHeader = this.isHeader;\n            result.isFooter = this.isFooter;\n            if (isFirstMatch) {\n                results.currentIndex = 0;\n                return undefined;\n            }\n            else if (results.currentIndex < 0 && selectionEnd.isExistBefore(result.start)) {\n                results.currentIndex = results.indexOf(result);\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        var paragraphWidget = this.owner.selection.getNextParagraphBlock(inlineElement.line.paragraph);\n        return paragraphWidget;\n    };\n    TextSearch.prototype.getTextPosition = function (lineWidget, hierarchicalIndex) {\n        var textPosition = new TextPosition(this.owner);\n        var index = textPosition.getHierarchicalIndex(lineWidget, hierarchicalIndex);\n        textPosition.setPositionForCurrentIndex(index);\n        return textPosition;\n    };\n    return TextSearch;\n}());\nexport { TextSearch };\n/**\n * @private\n */\nvar SearchWidgetInfo = /** @class */ (function () {\n    function SearchWidgetInfo(left, width) {\n        this.leftInternal = 0;\n        this.widthInternal = 0;\n        this.leftInternal = left;\n        this.widthInternal = width;\n    }\n    Object.defineProperty(SearchWidgetInfo.prototype, \"left\", {\n        get: function () {\n            return this.leftInternal;\n        },\n        set: function (value) {\n            this.leftInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SearchWidgetInfo.prototype, \"width\", {\n        get: function () {\n            return this.widthInternal;\n        },\n        set: function (value) {\n            this.widthInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SearchWidgetInfo;\n}());\nexport { SearchWidgetInfo };\n","/**\n * Selection Export\n */\nexport * from './selection';\nexport * from './selection-format';\nexport * from './selection-helper';\n","import { WShading } from '../format/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\n/**\n * Selection character format implementation\n */\nvar SelectionCharacterFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionCharacterFormat(selection) {\n        this.boldIn = undefined;\n        this.italicIn = undefined;\n        this.underlineIn = undefined;\n        this.strikeThroughIn = undefined;\n        this.baselineAlignmentIn = undefined;\n        this.highlightColorIn = undefined;\n        this.fontSizeIn = 0;\n        this.fontColorIn = undefined;\n        /**\n         * @private\n         */\n        this.boldBidi = undefined;\n        /**\n         * @private\n         */\n        this.italicBidi = undefined;\n        /**\n         * @private\n         */\n        this.fontSizeBidi = 0;\n        /**\n         * @private\n         */\n        this.bidi = undefined;\n        /**\n         * @private\n         */\n        this.bdo = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"fontSize\", {\n        /**\n         * Gets or sets the font size of selected contents.\n         */\n        get: function () {\n            return this.fontSizeIn;\n        },\n        set: function (value) {\n            if (value === this.fontSizeIn) {\n                return;\n            }\n            this.fontSizeIn = value;\n            this.notifyPropertyChanged('fontSize');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"fontFamily\", {\n        /**\n         * Gets or sets the font family of selected contents.\n         */\n        get: function () {\n            return this.fontFamilyIn;\n        },\n        set: function (value) {\n            if (value === this.fontFamilyIn) {\n                return;\n            }\n            this.fontFamilyIn = value;\n            this.notifyPropertyChanged('fontFamily');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"fontColor\", {\n        /**\n         * Gets or sets the font color of selected contents.\n         */\n        get: function () {\n            return this.fontColorIn;\n        },\n        set: function (value) {\n            if (value === this.fontColorIn) {\n                return;\n            }\n            this.fontColorIn = value;\n            this.notifyPropertyChanged('fontColor');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"bold\", {\n        /**\n         * Gets or sets the bold formatting of selected contents.\n         */\n        get: function () {\n            return this.boldIn;\n        },\n        set: function (value) {\n            if (value === this.boldIn) {\n                return;\n            }\n            this.boldIn = value;\n            this.notifyPropertyChanged('bold');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"italic\", {\n        /**\n         * Gets or sets the italic formatting of selected contents.\n         */\n        get: function () {\n            return this.italicIn;\n        },\n        set: function (value) {\n            if (value === this.italic) {\n                return;\n            }\n            this.italicIn = value;\n            this.notifyPropertyChanged('italic');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"strikethrough\", {\n        /**\n         * Gets or sets the strikethrough property of selected contents.\n         */\n        get: function () {\n            return this.strikeThroughIn;\n        },\n        set: function (value) {\n            if (value === this.strikeThroughIn) {\n                return;\n            }\n            this.strikeThroughIn = value;\n            this.notifyPropertyChanged('strikethrough');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"baselineAlignment\", {\n        /**\n         * Gets or sets the baseline alignment property of selected contents.\n         */\n        get: function () {\n            return this.baselineAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.baselineAlignmentIn) {\n                return;\n            }\n            this.baselineAlignmentIn = value;\n            this.notifyPropertyChanged('baselineAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"underline\", {\n        /**\n         * Gets or sets the underline style of selected contents.\n         */\n        get: function () {\n            return this.underlineIn;\n        },\n        set: function (value) {\n            if (value === this.underlineIn) {\n                return;\n            }\n            this.underlineIn = value;\n            this.notifyPropertyChanged('underline');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"highlightColor\", {\n        /**\n         * Gets or sets the highlight color of selected contents.\n         */\n        get: function () {\n            return this.highlightColorIn;\n        },\n        set: function (value) {\n            if (value === this.highlightColorIn) {\n                return;\n            }\n            this.highlightColorIn = value;\n            this.notifyPropertyChanged('highlightColor');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionCharacterFormat.prototype.getPropertyValue = function (property) {\n        switch (property) {\n            case 'bold':\n                return this.bold;\n            case 'italic':\n                return this.italic;\n            case 'fontSize':\n                if (this.fontSize >= 1) {\n                    return this.fontSize;\n                }\n                return undefined;\n            case 'fontFamily':\n                return this.fontFamily;\n            case 'strikethrough':\n                return this.strikethrough;\n            case 'baselineAlignment':\n                return this.baselineAlignment;\n            case 'highlightColor':\n                return this.highlightColor;\n            case 'underline':\n                return this.underline;\n            case 'fontColor':\n                return this.fontColor;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Notifies whenever property gets changed.\n     * @param  {string} propertyName\n     */\n    SelectionCharacterFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(this.selection) && (this.selection.isCleared || this.selection.owner.isReadOnlyMode || !this.selection.owner.isDocumentLoaded || this.selection.owner.isPastingContent) && !this.selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(this.selection) && !isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n            var propertyValue = this.getPropertyValue(propertyName);\n            if (!isNullOrUndefined(propertyValue)) {\n                this.selection.owner.editorModule.onApplyCharacterFormat(propertyName, propertyValue);\n            }\n        }\n    };\n    /**\n     * Copies the source format.\n     * @param  {WCharacterFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.copyFormat = function (format) {\n        this.styleName = !isNullOrUndefined(format.baseCharStyle) ? format.baseCharStyle.name : 'Default Paragraph Font';\n        this.fontSize = format.fontSize;\n        this.fontFamily = format.fontFamily;\n        this.bold = format.bold;\n        this.italic = format.italic;\n        this.baselineAlignment = format.baselineAlignment;\n        this.underline = format.underline;\n        this.fontColor = format.fontColor;\n        this.highlightColor = format.highlightColor;\n        this.strikethrough = format.strikethrough;\n        this.bidi = format.bidi;\n        this.bdo = format.bdo;\n        this.boldBidi = format.boldBidi;\n        this.italicBidi = format.italicBidi;\n        this.fontFamilyBidi = format.fontFamilyBidi;\n        this.fontSizeBidi = format.fontSizeBidi;\n    };\n    /**\n     * Combines the format.\n     * @param  {WCharacterFormat} format\n     * @private\n     */\n    SelectionCharacterFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.bold) && this.bold !== format.bold) {\n            this.bold = undefined;\n        }\n        if (!isNullOrUndefined(this.italic) && this.italic !== format.italic) {\n            this.italic = undefined;\n        }\n        if (this.fontSize !== 0 && this.fontSize !== format.fontSize) {\n            this.fontSize = 0;\n        }\n        if (!isNullOrUndefined(this.fontFamily) && this.fontFamily !== format.fontFamily) {\n            this.fontFamily = undefined;\n        }\n        if (!isNullOrUndefined(this.highlightColor) && this.highlightColor !== format.highlightColor) {\n            this.highlightColor = undefined;\n        }\n        if (!isNullOrUndefined(this.baselineAlignment) && this.baselineAlignment !== format.baselineAlignment) {\n            this.baselineAlignment = undefined;\n        }\n        if (!isNullOrUndefined(this.fontColor) && (this.fontColor !== format.fontColor)) {\n            this.fontColor = undefined;\n        }\n        if (!isNullOrUndefined(this.underline) && this.underline !== format.underline) {\n            this.underline = undefined;\n        }\n        if (!isNullOrUndefined(this.strikethrough) && this.strikethrough !== format.strikethrough) {\n            this.strikethrough = undefined;\n        }\n        if (!isNullOrUndefined(this.boldBidi) && this.boldBidi !== format.boldBidi) {\n            this.boldBidi = undefined;\n        }\n        if (!isNullOrUndefined(this.italicBidi) && this.italicBidi !== format.italicBidi) {\n            this.italicBidi = undefined;\n        }\n        if (this.fontSizeBidi !== 0 && this.fontSizeBidi !== format.fontSizeBidi) {\n            this.fontSizeBidi = 0;\n        }\n        if (!isNullOrUndefined(this.fontFamilyBidi) && this.fontFamilyBidi !== format.fontFamilyBidi) {\n            this.fontFamilyBidi = undefined;\n        }\n        if (!isNullOrUndefined(this.bidi) && this.bidi !== format.bidi) {\n            this.bidi = undefined;\n        }\n        if (!isNullOrUndefined(this.bdo) && this.bdo !== format.bdo) {\n            this.bdo = undefined;\n        }\n    };\n    /**\n     * Clones the format.\n     * @param  {SelectionCharacterFormat} selectionCharacterFormat\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.cloneFormat = function (selectionCharacterFormat) {\n        this.bold = selectionCharacterFormat.bold;\n        this.italic = selectionCharacterFormat.italic;\n        this.underline = selectionCharacterFormat.underline;\n        this.strikethrough = selectionCharacterFormat.strikethrough;\n        this.baselineAlignment = selectionCharacterFormat.baselineAlignment;\n        this.highlightColor = selectionCharacterFormat.highlightColor;\n        this.fontSize = selectionCharacterFormat.fontSize;\n        this.fontFamily = selectionCharacterFormat.fontFamily;\n        this.fontColor = selectionCharacterFormat.fontColor;\n        this.styleName = selectionCharacterFormat.styleName;\n        this.bidi = selectionCharacterFormat.bidi;\n        this.bdo = selectionCharacterFormat.bdo;\n        this.boldBidi = selectionCharacterFormat.boldBidi;\n        this.italicBidi = selectionCharacterFormat.italicBidi;\n        this.fontSizeBidi = selectionCharacterFormat.fontSizeBidi;\n        this.fontFamilyBidi = selectionCharacterFormat.fontFamilyBidi;\n    };\n    /**\n     * Checks whether current format is equal to the source format or not.\n     * @param  {SelectionCharacterFormat} format\n     * @returns boolean\n     * @private\n     */\n    SelectionCharacterFormat.prototype.isEqualFormat = function (format) {\n        return (this.fontSize === format.fontSize\n            && this.strikethrough === format.strikethrough\n            && this.bold === format.bold\n            && this.fontFamily === format.fontFamily\n            && this.underline === format.underline\n            && this.highlightColor === format.highlightColor\n            && this.italic === format.italic\n            && this.baselineAlignment === format.baselineAlignment\n            && this.fontColor === format.fontColor);\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.clearFormat = function () {\n        this.fontSizeIn = 0;\n        this.boldIn = undefined;\n        this.italicIn = undefined;\n        this.fontFamilyIn = undefined;\n        this.fontColorIn = undefined;\n        this.underlineIn = undefined;\n        this.strikeThroughIn = undefined;\n        this.highlightColorIn = undefined;\n        this.baselineAlignmentIn = undefined;\n        this.styleName = undefined;\n        this.bidi = undefined;\n        this.bdo = undefined;\n        this.boldBidi = undefined;\n        this.italicBidi = undefined;\n        this.fontFamilyBidi = undefined;\n        this.fontSizeBidi = undefined;\n    };\n    /**\n     * Destroys the maintained resources.\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.destroy = function () {\n        this.fontSizeIn = undefined;\n        this.boldIn = undefined;\n        this.italicIn = undefined;\n        this.fontFamilyIn = undefined;\n        this.fontColorIn = undefined;\n        this.underlineIn = undefined;\n        this.strikeThroughIn = undefined;\n        this.baselineAlignmentIn = undefined;\n        this.highlightColorIn = undefined;\n        this.selection = undefined;\n        this.styleName = undefined;\n        this.bidi = undefined;\n        this.bdo = undefined;\n        this.boldBidi = undefined;\n        this.italicBidi = undefined;\n        this.fontFamilyBidi = undefined;\n        this.fontSizeBidi = undefined;\n    };\n    return SelectionCharacterFormat;\n}());\nexport { SelectionCharacterFormat };\n/**\n * Selection paragraph format implementation\n */\nvar SelectionParagraphFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionParagraphFormat(selection, viewer) {\n        // Declaring the character format properties.\n        this.leftIndentIn = 0;\n        this.rightIndentIn = 0;\n        this.beforeSpacingIn = 0;\n        this.afterSpacingIn = 0;\n        this.textAlignmentIn = undefined;\n        this.firstLineIndentIn = 0;\n        this.lineSpacingIn = 1;\n        this.lineSpacingTypeIn = undefined;\n        this.bidiIn = undefined;\n        this.listLevelNumberIn = -1;\n        this.selection = selection;\n        this.viewer = viewer;\n    }\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"leftIndent\", {\n        /**\n         * Gets or Sets the left indent for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.leftIndentIn;\n        },\n        set: function (value) {\n            if (value === this.leftIndentIn) {\n                return;\n            }\n            this.leftIndentIn = value;\n            this.notifyPropertyChanged('leftIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"rightIndent\", {\n        /**\n         * Gets or Sets the right indent for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.rightIndentIn;\n        },\n        set: function (value) {\n            if (value === this.rightIndentIn) {\n                return;\n            }\n            this.rightIndentIn = value;\n            this.notifyPropertyChanged('rightIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"firstLineIndent\", {\n        /**\n         * Gets or Sets the first line indent for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.firstLineIndentIn;\n        },\n        set: function (value) {\n            if (value === this.firstLineIndentIn) {\n                return;\n            }\n            this.firstLineIndentIn = value;\n            this.notifyPropertyChanged('firstLineIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"textAlignment\", {\n        /**\n         * Gets or Sets the text alignment for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.textAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.textAlignmentIn) {\n                return;\n            }\n            this.textAlignmentIn = value;\n            this.notifyPropertyChanged('textAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"afterSpacing\", {\n        /**\n         * Gets or Sets the after spacing for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.afterSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.afterSpacingIn) {\n                return;\n            }\n            this.afterSpacingIn = value;\n            this.notifyPropertyChanged('afterSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"beforeSpacing\", {\n        /**\n         * Gets or Sets the before spacing for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.beforeSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.beforeSpacingIn) {\n                return;\n            }\n            this.beforeSpacingIn = value;\n            this.notifyPropertyChanged('beforeSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"lineSpacing\", {\n        /**\n         * Gets or Sets the line spacing for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.lineSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.lineSpacingIn) {\n                return;\n            }\n            this.lineSpacingIn = value;\n            this.notifyPropertyChanged('lineSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"lineSpacingType\", {\n        /**\n         * Gets or Sets the line spacing type for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.lineSpacingTypeIn;\n        },\n        set: function (value) {\n            if (value === this.lineSpacingTypeIn) {\n                return;\n            }\n            this.lineSpacingTypeIn = value;\n            this.notifyPropertyChanged('lineSpacingType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"listLevelNumber\", {\n        /**\n         * Gets or Sets the list level number for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.listLevelNumberIn;\n        },\n        set: function (value) {\n            if (value === this.listLevelNumberIn) {\n                return;\n            }\n            this.listLevelNumberIn = value;\n            this.notifyPropertyChanged('listLevelNumber');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"bidi\", {\n        /**\n         * Gets or Sets the bidirectional property for selected paragraphs\n         */\n        get: function () {\n            return this.bidiIn;\n        },\n        set: function (value) {\n            this.bidiIn = value;\n            this.notifyPropertyChanged('bidi');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"listText\", {\n        /**\n         * Gets the list text for selected paragraphs.\n         */\n        get: function () {\n            var listFormat = undefined;\n            var list = this.viewer.getListById(this.listId);\n            if (list instanceof WList && this.listLevelNumberIn > -1 && this.listLevelNumberIn < 9) {\n                var listLevel = list.getListLevel(this.listLevelNumber);\n                if (listLevel instanceof WListLevel) {\n                    if (listLevel.listLevelPattern === 'Bullet') {\n                        listFormat = listLevel.numberFormat;\n                    }\n                    else {\n                        listFormat = listLevel.numberFormat;\n                        for (var i = 0; i < 9; i++) {\n                            var levelPattern = '%' + (i + 1);\n                            if (listFormat.indexOf(levelPattern) > -1) {\n                                var level = i === this.listLevelNumberIn ? listLevel : list.getListLevel(i);\n                                var listTextElement = this.selection.getListTextElementBox(this.selection.start.paragraph);\n                                var listText = listTextElement ? listTextElement.text : '';\n                                listFormat = listText;\n                            }\n                        }\n                    }\n                }\n            }\n            return listFormat;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionParagraphFormat.prototype.getPropertyValue = function (property) {\n        switch (property) {\n            case 'leftIndent':\n                return this.leftIndent;\n            case 'rightIndent':\n                return this.rightIndent;\n            case 'firstLineIndent':\n                return this.firstLineIndent;\n            case 'beforeSpacing':\n                return this.beforeSpacing;\n            case 'afterSpacing':\n                return this.afterSpacing;\n            case 'textAlignment':\n                return this.textAlignment;\n            case 'lineSpacing':\n                return this.lineSpacing;\n            case 'lineSpacingType':\n                return this.lineSpacingType;\n            case 'bidi':\n                return this.bidi;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Notifies whenever the property gets changed.\n     * @param  {string} propertyName\n     */\n    SelectionParagraphFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        if (!isNullOrUndefined(this.selection) &&\n            (this.selection.owner.isReadOnlyMode || !this.selection.owner.isDocumentLoaded)\n            && !this.selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(this.selection) && !isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n            var editorModule = this.selection.owner.editorModule;\n            var value = this.getPropertyValue(propertyName);\n            if ((propertyName === 'leftIndent' || propertyName === 'rightIndent' || propertyName === 'firstLineIndent')\n                && !(value >= -1056 && value < 1056)) {\n                return;\n            }\n            if (propertyName === 'listLevelNumber') {\n                editorModule.onApplyListInternal(this.viewer.getListById(this.listId), this.listLevelNumber);\n            }\n            else {\n                editorModule.onApplyParagraphFormat(propertyName, value, propertyName === 'textAlignment' ? true : false, false);\n            }\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WParagraphFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionParagraphFormat.prototype.copyFormat = function (format) {\n        this.styleName = !isNullOrUndefined(format.baseStyle) ? format.baseStyle.name : 'Normal';\n        this.leftIndent = format.leftIndent;\n        this.rightIndent = format.rightIndent;\n        this.firstLineIndent = format.firstLineIndent;\n        this.afterSpacing = format.afterSpacing;\n        this.beforeSpacing = format.beforeSpacing;\n        this.lineSpacing = format.lineSpacing;\n        this.lineSpacingType = format.lineSpacingType;\n        this.textAlignment = format.textAlignment;\n        this.bidi = format.bidi;\n        if (!isNullOrUndefined(format.listFormat) && !isNullOrUndefined(format.listFormat.listId)) {\n            this.listId = format.listFormat.listId;\n            this.listLevelNumber = format.listFormat.listLevelNumber;\n        }\n        else {\n            this.listId = undefined;\n            this.listLevelNumber = 0;\n        }\n    };\n    /**\n     * Copies to format.\n     * @param  {WParagraphFormat} format\n     * @private\n     */\n    SelectionParagraphFormat.prototype.copyToFormat = function (format) {\n        if (isNullOrUndefined(format)) {\n            return;\n        }\n        if (!isNullOrUndefined(this.afterSpacing)) {\n            format.afterSpacing = this.afterSpacing;\n        }\n        if (!isNullOrUndefined(this.beforeSpacing)) {\n            format.beforeSpacing = this.beforeSpacing;\n        }\n        if (!isNullOrUndefined(this.leftIndent)) {\n            format.leftIndent = this.leftIndent;\n        }\n        if (!isNullOrUndefined(this.rightIndent)) {\n            format.rightIndent = this.rightIndent;\n        }\n        if (!isNullOrUndefined(this.textAlignment)) {\n            format.textAlignment = this.textAlignment;\n        }\n        if (!isNullOrUndefined(this.lineSpacing)) {\n            format.lineSpacing = this.lineSpacing;\n        }\n        if (!isNullOrUndefined(this.lineSpacingType)) {\n            format.lineSpacingType = this.lineSpacingType;\n        }\n        if (!isNullOrUndefined(this.firstLineIndent)) {\n            format.firstLineIndent = this.firstLineIndent;\n        }\n        if (!isNullOrUndefined(this.bidi)) {\n            format.bidi = this.bidi;\n        }\n    };\n    /**\n     * Combines the format.\n     * @param  {WParagraphFormat} format\n     * @private\n     */\n    SelectionParagraphFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.leftIndent) && this.leftIndent !== format.leftIndent) {\n            this.leftIndent = undefined;\n        }\n        if (!isNullOrUndefined(this.rightIndent) && this.rightIndent !== format.rightIndent) {\n            this.rightIndent = undefined;\n        }\n        if (!isNullOrUndefined(this.firstLineIndent) && this.firstLineIndent !== format.firstLineIndent) {\n            this.firstLineIndent = undefined;\n        }\n        if (this.lineSpacing !== 0 && this.lineSpacing !== format.lineSpacing) {\n            this.lineSpacing = 0;\n        }\n        if (this.beforeSpacing !== -1 && this.beforeSpacing !== format.beforeSpacing) {\n            this.beforeSpacing = -1;\n        }\n        if (this.afterSpacing !== -1 && this.afterSpacing !== format.afterSpacing) {\n            this.afterSpacing = -1;\n        }\n        if (!isNullOrUndefined(this.lineSpacingType) && this.lineSpacingType !== format.lineSpacingType) {\n            this.lineSpacingType = undefined;\n        }\n        if (!isNullOrUndefined(this.textAlignment) && this.textAlignment !== format.textAlignment) {\n            this.textAlignment = undefined;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (this.listLevelNumber >= 0 && !isNullOrUndefined(this.listId) && (isNullOrUndefined(format.listFormat) || format.listFormat.listLevelNumber !== this.listLevelNumber)) {\n            this.listLevelNumber = -1;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(format.listFormat) || isNullOrUndefined(format.listFormat.listId) || (!isNullOrUndefined(this.listId) && this.listId !== format.listFormat.listId)) {\n            this.listId = undefined;\n        }\n        if (!isNullOrUndefined(this.bidi) && this.bidi !== format.bidi) {\n            this.bidi = undefined;\n        }\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionParagraphFormat.prototype.clearFormat = function () {\n        this.leftIndent = 0;\n        this.rightIndent = 0;\n        this.beforeSpacing = 0;\n        this.afterSpacing = 0;\n        this.firstLineIndent = 0;\n        this.lineSpacing = 1;\n        this.textAlignment = undefined;\n        this.lineSpacingType = undefined;\n        this.listId = undefined;\n        this.listLevelNumber = -1;\n        this.styleName = undefined;\n        this.bidi = undefined;\n    };\n    /**\n     * Gets the clone of list at current selection.\n     * @returns WList\n     * @private\n     */\n    SelectionParagraphFormat.prototype.getList = function () {\n        var list = this.viewer.getListById(this.listId);\n        if (!isNullOrUndefined(list)) {\n            var listAdv = new WList();\n            var abstractList = new WAbstractList();\n            var currentAbstractList = this.viewer.getAbstractListById(list.abstractListId);\n            var editor = this.selection.owner.editorModule;\n            if (!isNullOrUndefined(currentAbstractList)) {\n                for (var i = 0; i < currentAbstractList.levels.length; i++) {\n                    var level = editor.cloneListLevel(currentAbstractList.levels[i]);\n                    abstractList.levels.push(level);\n                    level.ownerBase = abstractList;\n                }\n            }\n            else {\n                abstractList.levels.push(new WListLevel(abstractList));\n            }\n            if (!isNullOrUndefined(list.levelOverrides)) {\n                for (var i = 0; i < list.levelOverrides.length; i++) {\n                    var levelOverride = editor.cloneLevelOverride(list.levelOverrides[i]);\n                    listAdv.levelOverrides.push(levelOverride);\n                }\n            }\n            listAdv.abstractList = abstractList;\n            listAdv.abstractListId = abstractList.abstractListId;\n            listAdv.sourceListId = list.listId;\n            return listAdv;\n        }\n        return undefined;\n    };\n    /**\n     * Modifies the list at current selection.\n     * @param  {WList} listAdv\n     * @private\n     */\n    SelectionParagraphFormat.prototype.setList = function (listAdv) {\n        if (this.viewer.owner.isReadOnlyMode || !this.viewer.owner.isDocumentLoaded) {\n            return;\n        }\n        var list = this.viewer.getListById(this.listId);\n        var collection = undefined;\n        var currentAbstractList = listAdv ? this.viewer.getAbstractListById(listAdv.abstractListId) : undefined;\n        if (!isNullOrUndefined(list) && !isNullOrUndefined(listAdv)\n            && !isNullOrUndefined(currentAbstractList) && listAdv.sourceListId === list.listId) {\n            var history_1 = this.viewer.owner.editorHistory;\n            var listLevel = this.viewer.layout.getListLevel(list, 1);\n            this.selection.owner.isLayoutEnabled = false;\n            this.viewer.owner.editorModule.setOffsetValue(this.selection);\n            if (history_1) {\n                collection = history_1.updateListChangesInHistory(currentAbstractList, list);\n            }\n            this.viewer.owner.editorModule.updateListParagraphs();\n            if (history_1) {\n                history_1.applyListChanges(this.selection, collection);\n            }\n            this.selection.owner.isLayoutEnabled = true;\n            this.viewer.renderedLists.clear();\n            // this.viewer.pages = [];\n            this.viewer.owner.editorModule.layoutWholeDocument();\n            this.viewer.owner.editorModule.updateSelectionTextPosition(false);\n            if (history_1 && history_1.currentBaseHistoryInfo) {\n                if (history_1.currentBaseHistoryInfo.modifiedProperties.length > 0) {\n                    history_1.currentBaseHistoryInfo.updateSelection();\n                }\n                history_1.updateHistory();\n            }\n            this.viewer.owner.editorModule.fireContentChange();\n        }\n        else if (!isNullOrUndefined(listAdv)) {\n            this.selection.owner.isLayoutEnabled = false;\n            if (!isNullOrUndefined(currentAbstractList) && this.viewer.abstractLists.indexOf(currentAbstractList) === -1) {\n                this.viewer.abstractLists.push(currentAbstractList);\n            }\n            if (this.viewer.lists.indexOf(listAdv) === -1) {\n                this.viewer.lists.push(listAdv);\n            }\n            //currentAbstractList.listType = 'Numbering';\n            this.selection.owner.isLayoutEnabled = true;\n            this.selection.owner.editorModule.onApplyList(listAdv);\n        }\n        else {\n            this.selection.owner.editorModule.onApplyList(undefined);\n        }\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionParagraphFormat.prototype.destroy = function () {\n        this.leftIndentIn = undefined;\n        this.rightIndentIn = undefined;\n        this.beforeSpacingIn = undefined;\n        this.afterSpacingIn = undefined;\n        this.firstLineIndentIn = undefined;\n        this.lineSpacingIn = undefined;\n        this.textAlignmentIn = undefined;\n        this.lineSpacingTypeIn = undefined;\n        this.listId = undefined;\n        this.listLevelNumberIn = undefined;\n        this.viewer = undefined;\n        this.selection = undefined;\n        this.styleName = undefined;\n        this.bidi = undefined;\n    };\n    return SelectionParagraphFormat;\n}());\nexport { SelectionParagraphFormat };\n/**\n * Selection section format implementation\n */\nvar SelectionSectionFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionSectionFormat(selection) {\n        this.differentFirstPageIn = undefined;\n        this.differentOddAndEvenPagesIn = undefined;\n        /**\n         * private\n         */\n        this.bidi = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionSectionFormat.prototype, \"pageHeight\", {\n        /**\n         * Gets or sets the page height.\n         */\n        get: function () {\n            return this.pageHeightIn;\n        },\n        set: function (value) {\n            this.pageHeightIn = value;\n            this.notifyPropertyChanged('pageHeight');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"pageWidth\", {\n        /**\n         * Gets or sets the page width.\n         */\n        get: function () {\n            return this.pageWidthIn;\n        },\n        set: function (value) {\n            this.pageWidthIn = value;\n            this.notifyPropertyChanged('pageWidth');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"leftMargin\", {\n        /**\n         * Gets or sets the page left margin.\n         */\n        get: function () {\n            return this.leftMarginIn;\n        },\n        set: function (value) {\n            this.leftMarginIn = value;\n            this.notifyPropertyChanged('leftMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"bottomMargin\", {\n        /**\n         * Gets or sets the page bottom margin.\n         */\n        get: function () {\n            return this.bottomMarginIn;\n        },\n        set: function (value) {\n            this.bottomMarginIn = value;\n            this.notifyPropertyChanged('bottomMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"topMargin\", {\n        /**\n         * Gets or sets the page top margin.\n         */\n        get: function () {\n            return this.topMarginIn;\n        },\n        set: function (value) {\n            this.topMarginIn = value;\n            this.notifyPropertyChanged('topMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"rightMargin\", {\n        /**\n         * Gets or sets the page right margin.\n         */\n        get: function () {\n            return this.rightMarginIn;\n        },\n        set: function (value) {\n            this.rightMarginIn = value;\n            this.notifyPropertyChanged('rightMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"headerDistance\", {\n        /**\n         * Gets or sets the header distance.\n         */\n        get: function () {\n            return this.headerDistanceIn;\n        },\n        set: function (value) {\n            this.headerDistanceIn = value;\n            this.notifyPropertyChanged('headerDistance');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"footerDistance\", {\n        /**\n         * Gets or sets the footer distance.\n         */\n        get: function () {\n            return this.footerDistanceIn;\n        },\n        set: function (value) {\n            this.footerDistanceIn = value;\n            this.notifyPropertyChanged('footerDistance');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"differentFirstPage\", {\n        /**\n         * Gets or sets a value indicating whether the section has different first page.\n         */\n        get: function () {\n            return this.differentFirstPageIn;\n        },\n        set: function (value) {\n            this.differentFirstPageIn = value;\n            this.notifyPropertyChanged('differentFirstPage');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"differentOddAndEvenPages\", {\n        /**\n         * Gets or sets a value indicating whether the section has different odd and even page.\n         */\n        get: function () {\n            return this.differentOddAndEvenPagesIn;\n        },\n        set: function (value) {\n            this.differentOddAndEvenPagesIn = value;\n            this.notifyPropertyChanged('differentOddAndEvenPages');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Copies the format.\n     * @param  {WSectionFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionSectionFormat.prototype.copyFormat = function (format) {\n        this.pageHeight = format.pageHeight;\n        this.pageWidth = format.pageWidth;\n        this.leftMargin = format.leftMargin;\n        this.topMargin = format.topMargin;\n        this.rightMargin = format.rightMargin;\n        this.bottomMargin = format.bottomMargin;\n        this.headerDistance = format.headerDistance;\n        this.footerDistance = format.footerDistance;\n        this.differentFirstPage = format.differentFirstPage;\n        this.differentOddAndEvenPages = format.differentOddAndEvenPages;\n        this.bidi = format.bidi;\n    };\n    SelectionSectionFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        var selection = this.selection;\n        if (!isNullOrUndefined(selection) && (selection.isCleared || selection.owner.isPastingContent\n            || selection.owner.isReadOnlyMode || !selection.owner.isDocumentLoaded)\n            && !selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(selection) && !isNullOrUndefined(selection.start) && !selection.isRetrieveFormatting) {\n            var value = this.getPropertyvalue(propertyName);\n            if (!isNullOrUndefined(value)) {\n                selection.owner.editorModule.onApplySectionFormat(propertyName, value);\n            }\n        }\n    };\n    SelectionSectionFormat.prototype.getPropertyvalue = function (propertyName) {\n        switch (propertyName) {\n            case 'pageHeight':\n                if (this.pageHeight > 0) {\n                    return this.pageHeight;\n                }\n                return undefined;\n            case 'pageWidth':\n                if (this.pageWidth > 0) {\n                    return this.pageWidth;\n                }\n                return undefined;\n            case 'leftMargin':\n                if (this.leftMargin >= 0) {\n                    return this.leftMargin;\n                }\n                return undefined;\n            case 'rightMargin':\n                if (this.rightMargin >= 0) {\n                    return this.rightMargin;\n                }\n                return undefined;\n            case 'topMargin':\n                if (this.topMargin >= 0) {\n                    return this.topMargin;\n                }\n                return undefined;\n            case 'bottomMargin':\n                if (this.bottomMargin >= 0) {\n                    return this.bottomMargin;\n                }\n                return undefined;\n            case 'differentFirstPage':\n                if (!isNullOrUndefined(this.differentFirstPage)) {\n                    return this.differentFirstPage;\n                }\n                return undefined;\n            case 'differentOddAndEvenPages':\n                if (!isNullOrUndefined(this.differentOddAndEvenPages)) {\n                    return this.differentOddAndEvenPages;\n                }\n                return undefined;\n            case 'headerDistance':\n                return this.headerDistanceIn;\n            case 'footerDistance':\n                return this.footerDistance;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Combines the format.\n     * @param  {WSectionFormat} format\n     * @private\n     */\n    SelectionSectionFormat.prototype.combineFormat = function (format) {\n        if (this.pageHeight > 0 && this.pageHeight !== format.pageHeight) {\n            this.pageHeight = 0;\n        }\n        if (this.pageWidth > 0 && this.pageWidth !== format.pageWidth) {\n            this.pageWidth = 0;\n        }\n        if (this.leftMargin > -1 && this.leftMargin !== format.leftMargin) {\n            this.leftMargin = -1;\n        }\n        if (this.topMargin > -1 && this.topMargin !== format.topMargin) {\n            this.topMargin = -1;\n        }\n        if (this.rightMargin > -1 && this.rightMargin !== format.rightMargin) {\n            this.rightMargin = -1;\n        }\n        if (this.bottomMargin > -1 && this.bottomMargin !== format.bottomMargin) {\n            this.bottomMargin = -1;\n        }\n        if (this.headerDistance !== 0 && this.headerDistance !== format.headerDistance) {\n            this.headerDistance = 0;\n        }\n        if (this.footerDistance !== 0 && this.footerDistance !== format.footerDistance) {\n            this.footerDistance = 0;\n        }\n        if (!isNullOrUndefined(this.differentFirstPage) && this.differentFirstPage !== format.differentFirstPage) {\n            this.differentFirstPage = undefined;\n        }\n        if (!isNullOrUndefined(this.differentOddAndEvenPages) && this.differentOddAndEvenPages !== format.differentOddAndEvenPages) {\n            this.differentOddAndEvenPages = undefined;\n        }\n        if (!isNullOrUndefined(this.bidi) && this.bidi !== format.bidi) {\n            this.bidi = undefined;\n        }\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionSectionFormat.prototype.clearFormat = function () {\n        this.headerDistance = 0;\n        this.footerDistance = 0;\n        this.pageHeight = 0;\n        this.pageWidth = 0;\n        this.leftMargin = -1;\n        this.rightMargin = -1;\n        this.topMargin = -1;\n        this.bottomMargin = -1;\n        this.differentFirstPage = undefined;\n        this.differentOddAndEvenPages = undefined;\n        this.bidi = undefined;\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionSectionFormat.prototype.destroy = function () {\n        this.headerDistanceIn = undefined;\n        this.footerDistanceIn = undefined;\n        this.pageHeightIn = undefined;\n        this.pageWidthIn = undefined;\n        this.leftMarginIn = undefined;\n        this.rightMarginIn = undefined;\n        this.topMarginIn = undefined;\n        this.bottomMarginIn = undefined;\n        this.differentFirstPageIn = undefined;\n        this.differentOddAndEvenPagesIn = undefined;\n        this.selection = undefined;\n        this.bidi = undefined;\n    };\n    return SelectionSectionFormat;\n}());\nexport { SelectionSectionFormat };\n/**\n * Selection table format implementation\n */\nvar SelectionTableFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionTableFormat(selection) {\n        this.leftIndentIn = 0;\n        this.backgroundIn = undefined;\n        this.tableAlignmentIn = undefined;\n        this.cellSpacingIn = 0;\n        this.leftMarginIn = 0;\n        this.rightMarginIn = 0;\n        this.topMarginIn = 0;\n        this.bottomMarginIn = 0;\n        this.preferredWidthIn = 0;\n        this.bidiIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionTableFormat.prototype, \"table\", {\n        /**\n         * Gets or sets the table.\n         * @private\n         */\n        get: function () {\n            return this.tableIn;\n        },\n        set: function (value) {\n            this.tableIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"leftIndent\", {\n        /**\n         * Gets or Sets the left indent for selected table.\n         * @private\n         */\n        get: function () {\n            return this.leftIndentIn;\n        },\n        set: function (value) {\n            if (value === this.leftIndentIn) {\n                return;\n            }\n            this.leftIndentIn = value;\n            this.notifyPropertyChanged('leftIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"topMargin\", {\n        /**\n         * Gets or Sets the default top margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.topMarginIn;\n        },\n        set: function (value) {\n            if (value === this.topMarginIn) {\n                return;\n            }\n            this.topMarginIn = value;\n            this.notifyPropertyChanged('topMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"background\", {\n        /**\n         * Gets or Sets the background for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.backgroundIn;\n        },\n        set: function (value) {\n            if (value === this.backgroundIn) {\n                return;\n            }\n            this.backgroundIn = value;\n            this.notifyPropertyChanged('background');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"tableAlignment\", {\n        /**\n         * Gets or Sets the table alignment for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.tableAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.tableAlignmentIn) {\n                return;\n            }\n            this.tableAlignmentIn = value;\n            this.notifyPropertyChanged('tableAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"leftMargin\", {\n        /**\n         * Gets or Sets the default left margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.leftMarginIn;\n        },\n        set: function (value) {\n            if (value === this.leftMarginIn) {\n                return;\n            }\n            this.leftMarginIn = value;\n            this.notifyPropertyChanged('leftMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"bottomMargin\", {\n        /**\n         * Gets or Sets the default bottom margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.bottomMarginIn;\n        },\n        set: function (value) {\n            if (value === this.bottomMarginIn) {\n                return;\n            }\n            this.bottomMarginIn = value;\n            this.notifyPropertyChanged('bottomMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"cellSpacing\", {\n        /**\n         * Gets or Sets the cell spacing for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.cellSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.cellSpacingIn) {\n                return;\n            }\n            this.cellSpacingIn = value;\n            this.notifyPropertyChanged('cellSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"rightMargin\", {\n        /**\n         * Gets or Sets the default right margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.rightMarginIn;\n        },\n        set: function (value) {\n            if (value === this.rightMarginIn) {\n                return;\n            }\n            this.rightMarginIn = value;\n            this.notifyPropertyChanged('rightMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"preferredWidth\", {\n        /**\n         * Gets or Sets the preferred width for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthIn) {\n                return;\n            }\n            this.preferredWidthIn = value;\n            this.notifyPropertyChanged('preferredWidth');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"preferredWidthType\", {\n        /**\n         * Gets or Sets the preferred width type for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthTypeIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthTypeIn) {\n                return;\n            }\n            this.preferredWidthTypeIn = value;\n            this.notifyPropertyChanged('preferredWidthType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"bidi\", {\n        /**\n         * Gets or sets the bidi property\n         */\n        get: function () {\n            return this.bidiIn;\n        },\n        set: function (value) {\n            this.bidiIn = value;\n            this.notifyPropertyChanged('bidi');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionTableFormat.prototype.getPropertyValue = function (propertyName) {\n        switch (propertyName) {\n            case 'tableAlignment':\n                return this.tableAlignment;\n            case 'leftIndent':\n                return this.leftIndent;\n            case 'cellSpacing':\n                return this.cellSpacing;\n            case 'leftMargin':\n                return this.leftMargin;\n            case 'rightMargin':\n                return this.rightMargin;\n            case 'topMargin':\n                return this.topMargin;\n            case 'bottomMargin':\n                return this.bottomMargin;\n            case 'background':\n                var shading = new WShading();\n                shading.backgroundColor = this.background;\n                return shading;\n            case 'preferredWidth':\n                return this.preferredWidth;\n            case 'preferredWidthType':\n                return this.preferredWidthType;\n            case 'bidi':\n                return this.bidi;\n            default:\n                return undefined;\n        }\n    };\n    SelectionTableFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        if (!isNullOrUndefined(this.selection) && (this.selection.isCleared\n            || !this.selection.owner.isDocumentLoaded || this.selection.owner.isReadOnlyMode\n            || this.selection.owner.isPastingContent) && !this.selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(this.selection) && !isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n            var value = this.getPropertyValue(propertyName);\n            if (propertyName === 'background') {\n                propertyName = 'shading';\n            }\n            if (!isNullOrUndefined(value)) {\n                this.selection.owner.editorModule.onApplyTableFormat(propertyName, value);\n            }\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WTableFormat} format Format to copy.\n     * @returns void\n     * @private\n     */\n    SelectionTableFormat.prototype.copyFormat = function (format) {\n        this.leftIndent = format.leftIndent;\n        this.background = format.shading.backgroundColor;\n        this.tableAlignment = format.tableAlignment;\n        this.leftMargin = format.leftMargin;\n        this.rightMargin = format.rightMargin;\n        this.topMargin = format.topMargin;\n        this.bottomMargin = format.bottomMargin;\n        this.cellSpacing = format.cellSpacing;\n        this.preferredWidth = format.preferredWidth;\n        this.preferredWidthType = format.preferredWidthType;\n        this.bidi = format.bidi;\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionTableFormat.prototype.clearFormat = function () {\n        this.table = undefined;\n        this.leftIndent = 0;\n        this.background = undefined;\n        this.leftIndent = 0;\n        this.leftMargin = 0;\n        this.rightMargin = 0;\n        this.topMargin = 0;\n        this.bottomMargin = 0;\n        this.cellSpacing = 0;\n        this.tableAlignment = undefined;\n        this.bidi = undefined;\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionTableFormat.prototype.destroy = function () {\n        this.leftIndentIn = undefined;\n        this.backgroundIn = undefined;\n        this.leftIndentIn = undefined;\n        this.leftMarginIn = undefined;\n        this.rightMarginIn = undefined;\n        this.topMarginIn = undefined;\n        this.bottomMarginIn = undefined;\n        this.cellSpacingIn = undefined;\n        this.tableAlignmentIn = undefined;\n        this.tableIn = undefined;\n        this.selection = undefined;\n        this.bidi = undefined;\n    };\n    return SelectionTableFormat;\n}());\nexport { SelectionTableFormat };\n/**\n * Selection cell format implementation\n */\nvar SelectionCellFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionCellFormat(selection) {\n        this.verticalAlignmentIn = undefined;\n        this.leftMarginIn = 0;\n        this.rightMarginIn = 0;\n        this.topMarginIn = 0;\n        this.bottomMarginIn = 0;\n        this.backgroundIn = undefined;\n        this.preferredWidthTypeIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionCellFormat.prototype, \"verticalAlignment\", {\n        /**\n         * Gets or sets the vertical alignment of the selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.verticalAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.verticalAlignmentIn) {\n                return;\n            }\n            this.verticalAlignmentIn = value;\n            this.notifyPropertyChanged('verticalAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"leftMargin\", {\n        /**\n         * Gets or Sets the left margin for selected cells.\n         * @default undefined\n         */\n        /* tslint:disable */\n        get: function () {\n            return this.leftMarginIn;\n        },\n        set: function (value) {\n            if (value === this.leftMarginIn) {\n                return;\n            }\n            this.leftMarginIn = value;\n            this.notifyPropertyChanged('leftMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"rightMargin\", {\n        /**\n         * Gets or Sets the right margin for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.rightMarginIn;\n        },\n        set: function (value) {\n            if (value === this.rightMarginIn) {\n                return;\n            }\n            this.rightMarginIn = value;\n            this.notifyPropertyChanged('rightMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"topMargin\", {\n        /**\n         * Gets or Sets the top margin for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.topMarginIn;\n        },\n        set: function (value) {\n            if (value === this.topMarginIn) {\n                return;\n            }\n            this.topMarginIn = value;\n            this.notifyPropertyChanged('topMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"bottomMargin\", {\n        /**\n         * Gets or Sets the bottom margin for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.bottomMarginIn;\n        },\n        set: function (value) {\n            if (value === this.bottomMarginIn) {\n                return;\n            }\n            this.bottomMarginIn = value;\n            this.notifyPropertyChanged('bottomMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"background\", {\n        /**\n         * Gets or Sets the background for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.backgroundIn;\n        },\n        /* tslint:enable */\n        set: function (value) {\n            if (value === this.backgroundIn) {\n                return;\n            }\n            this.backgroundIn = value;\n            this.notifyPropertyChanged('background');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"preferredWidthType\", {\n        /* tslint:disable */\n        /**\n         * Gets or Sets the preferred width type for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthTypeIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthTypeIn) {\n                return;\n            }\n            this.preferredWidthTypeIn = value;\n            this.notifyPropertyChanged('preferredWidthType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"preferredWidth\", {\n        /**\n         * Gets or Sets the preferred width  for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthIn) {\n                return;\n            }\n            this.preferredWidthIn = value;\n            this.notifyPropertyChanged('preferredWidth');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /* tslint:enable */\n    SelectionCellFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        var selection = this.selection;\n        if (!isNullOrUndefined(selection)) {\n            if ((selection.isCleared || !selection.owner.isDocumentLoaded\n                || selection.owner.isReadOnlyMode || selection.owner.isPastingContent) && !selection.isRetrieveFormatting) {\n                return;\n            }\n            if (!isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n                var value = this.getPropertyValue(propertyName);\n                if (propertyName === 'background') {\n                    propertyName = 'shading';\n                }\n                if (!isNullOrUndefined(value)) {\n                    this.selection.owner.editorModule.onApplyTableCellFormat(propertyName, value);\n                }\n            }\n        }\n    };\n    SelectionCellFormat.prototype.getPropertyValue = function (propertyName) {\n        switch (propertyName) {\n            case 'verticalAlignment':\n                return this.verticalAlignment;\n            case 'leftMargin':\n                return this.leftMargin;\n            case 'rightMargin':\n                return this.rightMargin;\n            case 'topMargin':\n                return this.topMargin;\n            case 'bottomMargin':\n                return this.bottomMargin;\n            case 'preferredWidth':\n                return this.preferredWidth;\n            case 'preferredWidthType':\n                return this.preferredWidthType;\n            case 'background':\n                var shading = new WShading();\n                shading.backgroundColor = this.background;\n                return shading;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WCellFormat} format Source Format to copy.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.copyFormat = function (format) {\n        this.leftMargin = format.leftMargin;\n        this.rightMargin = format.rightMargin;\n        this.topMargin = format.topMargin;\n        this.bottomMargin = format.bottomMargin;\n        this.background = format.shading.backgroundColor;\n        this.verticalAlignment = format.verticalAlignment;\n        this.preferredWidth = format.preferredWidth;\n        this.preferredWidthType = format.preferredWidthType;\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.clearCellFormat = function () {\n        this.leftMargin = undefined;\n        this.rightMargin = undefined;\n        this.topMargin = undefined;\n        this.bottomMargin = undefined;\n        this.background = undefined;\n        this.verticalAlignment = undefined;\n    };\n    /**\n     * Combines the format.\n     * @param  {WCellFormat} format\n     * @private\n     */\n    SelectionCellFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.leftMargin) && this.leftMargin !== format.leftMargin) {\n            this.leftMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.topMargin) && this.topMargin !== format.topMargin) {\n            this.topMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.rightMargin) && this.rightMargin !== format.rightMargin) {\n            this.rightMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.bottomMargin) && this.bottomMargin !== format.bottomMargin) {\n            this.bottomMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.background) && this.background !== format.shading.backgroundColor) {\n            this.background = undefined;\n        }\n        if (!isNullOrUndefined(this.verticalAlignment) && this.verticalAlignment !== format.verticalAlignment) {\n            this.verticalAlignment = undefined;\n        }\n        if (!isNullOrUndefined(this.preferredWidth) && this.preferredWidth !== format.preferredWidth) {\n            this.preferredWidth = undefined;\n        }\n        if (!isNullOrUndefined(this.preferredWidthType) && this.preferredWidthType !== format.preferredWidthType) {\n            this.preferredWidthType = undefined;\n        }\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.clearFormat = function () {\n        this.background = undefined;\n        this.bottomMargin = 0;\n        this.leftMargin = 0;\n        this.rightMargin = 0;\n        this.topMargin = 0;\n        this.verticalAlignment = undefined;\n    };\n    /**\n     * Destroys the manages resources.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.destroy = function () {\n        this.backgroundIn = undefined;\n        this.verticalAlignmentIn = undefined;\n        this.bottomMarginIn = undefined;\n        this.leftMarginIn = undefined;\n        this.rightMarginIn = undefined;\n        this.topMarginIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionCellFormat;\n}());\nexport { SelectionCellFormat };\n/**\n * Selection row format implementation\n */\nvar SelectionRowFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionRowFormat(selection) {\n        this.heightIn = undefined;\n        this.heightTypeIn = undefined;\n        this.isHeaderIn = undefined;\n        this.allowRowBreakAcrossPagesIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionRowFormat.prototype, \"height\", {\n        /**\n         * Gets or Sets the height for selected rows.\n         * @default undefined\n         */\n        get: function () {\n            return this.heightIn;\n        },\n        set: function (value) {\n            if (value === this.heightIn) {\n                return;\n            }\n            this.heightIn = value;\n            this.notifyPropertyChanged('height');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionRowFormat.prototype, \"heightType\", {\n        /**\n         * Gets or Sets the height type for selected rows.\n         * @default undefined\n         */\n        get: function () {\n            return this.heightTypeIn;\n        },\n        set: function (value) {\n            if (value === this.heightTypeIn) {\n                return;\n            }\n            this.heightTypeIn = value;\n            this.notifyPropertyChanged('heightType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionRowFormat.prototype, \"isHeader\", {\n        /**\n         * Gets or Sets a value indicating whether the selected rows are header rows or not.\n         * @default undefined\n         */\n        get: function () {\n            return this.isHeaderIn;\n        },\n        set: function (value) {\n            if (value === this.isHeaderIn) {\n                return;\n            }\n            this.isHeaderIn = value;\n            this.notifyPropertyChanged('isHeader');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionRowFormat.prototype, \"allowBreakAcrossPages\", {\n        /**\n         * Gets or Sets a value indicating whether to allow break across pages for selected rows.\n         * @default undefined\n         */\n        get: function () {\n            return this.allowRowBreakAcrossPagesIn;\n        },\n        set: function (value) {\n            if (value === this.allowRowBreakAcrossPagesIn) {\n                return;\n            }\n            this.allowRowBreakAcrossPagesIn = value;\n            this.notifyPropertyChanged('allowBreakAcrossPages');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionRowFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        var selection = this.selection;\n        if (!isNullOrUndefined(selection) && (selection.isCleared || selection.owner.isReadOnlyMode\n            || !selection.owner.isDocumentLoaded || selection.owner.isPastingContent) && !selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(selection) && !isNullOrUndefined(selection.start) && !selection.isRetrieveFormatting) {\n            var value = this.getPropertyValue(propertyName);\n            if (!isNullOrUndefined(value)) {\n                selection.owner.editorModule.onApplyTableRowFormat(propertyName, value);\n            }\n        }\n    };\n    SelectionRowFormat.prototype.getPropertyValue = function (propertyName) {\n        switch (propertyName) {\n            case 'height':\n                return this.height;\n            case 'heightType':\n                return this.heightType;\n            case 'isHeader':\n                return this.isHeader;\n            case 'allowBreakAcrossPages':\n                return this.allowBreakAcrossPages;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WRowFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.copyFormat = function (format) {\n        this.height = format.height;\n        this.heightType = format.heightType;\n        this.allowBreakAcrossPages = format.allowBreakAcrossPages;\n        this.isHeader = format.isHeader;\n    };\n    /**\n     * Combines the format.\n     * @param  {WRowFormat} format\n     * @private\n     */\n    SelectionRowFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.height) && this.height !== format.height) {\n            this.height = undefined;\n        }\n        if (!isNullOrUndefined(this.heightType) && this.heightType !== format.heightType) {\n            this.heightType = undefined;\n        }\n        if (!isNullOrUndefined(this.allowBreakAcrossPages) && this.allowBreakAcrossPages !== format.allowBreakAcrossPages) {\n            this.allowBreakAcrossPages = undefined;\n        }\n        if (!isNullOrUndefined(this.isHeader) && this.isHeader !== format.isHeader) {\n            this.isHeader = undefined;\n        }\n    };\n    /**\n     * Clears the row format.\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.clearRowFormat = function () {\n        this.height = undefined;\n        this.heightType = undefined;\n        this.allowBreakAcrossPages = undefined;\n        this.isHeader = undefined;\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.clearFormat = function () {\n        this.height = 0;\n        this.heightType = undefined;\n        this.allowBreakAcrossPages = undefined;\n        this.isHeader = undefined;\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.destroy = function () {\n        this.heightIn = undefined;\n        this.heightTypeIn = undefined;\n        this.allowRowBreakAcrossPagesIn = undefined;\n        this.isHeaderIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionRowFormat;\n}());\nexport { SelectionRowFormat };\n/**\n * Selection image format implementation\n */\nvar SelectionImageFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionImageFormat(selection) {\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionImageFormat.prototype, \"width\", {\n        /**\n         * Gets the width of the image.\n         */\n        get: function () {\n            if (this.image) {\n                return this.image.width;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionImageFormat.prototype, \"height\", {\n        /**\n         * Gets the height of the image.\n         */\n        get: function () {\n            if (this.image) {\n                return this.image.height;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Resizes the image based on given size.\n     * @param width\n     * @param height\n     */\n    SelectionImageFormat.prototype.resize = function (width, height) {\n        this.updateImageFormat(width, height);\n    };\n    /**\n     * Update image width and height\n     * @private\n     */\n    SelectionImageFormat.prototype.updateImageFormat = function (width, height) {\n        if (this.image) {\n            if (this.selection.owner.editorModule) {\n                this.selection.owner.editorModule.onImageFormat(this.image, width, height);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    SelectionImageFormat.prototype.copyImageFormat = function (image) {\n        this.image = image;\n    };\n    /**\n     * @private\n     */\n    SelectionImageFormat.prototype.clearImageFormat = function () {\n        this.image = undefined;\n    };\n    return SelectionImageFormat;\n}());\nexport { SelectionImageFormat };\n/* tslint:enable */ \n","import { Widget, TableRowWidget, TableWidget, LineWidget, ElementBox, TextElementBox, ListTextElementBox, ImageElementBox, ParagraphWidget, TableCellWidget, FieldElementBox, BlockContainer, BookmarkElementBox } from '../index';\nimport { HelperMethods } from '../index';\nimport { Point } from '../index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar TextPosition = /** @class */ (function () {\n    function TextPosition(owner) {\n        /**\n         * @private\n         */\n        this.location = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.isUpdateLocation = true;\n        this.owner = owner;\n        this.viewer = this.owner.viewer;\n    }\n    Object.defineProperty(TextPosition.prototype, \"paragraph\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.currentWidget.paragraph;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"isAtParagraphStart\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.offset === this.owner.selection.getStartOffset(this.paragraph);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"isAtParagraphEnd\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.selection.isParagraphLastLine(this.currentWidget)\n                && this.offset === this.owner.selection.getLineLength(this.currentWidget);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"isCurrentParaBidi\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.currentWidget.paragraph)) {\n                return this.currentWidget.paragraph.paragraphFormat.bidi;\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"selection\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.selection;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"hierarchicalPosition\", {\n        /**\n         * Gets the hierarchical position of logical text position in the document\n         * @returns {string}\n         */\n        get: function () {\n            return this.getHierarchicalIndexInternal();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Return clone of current text position\n     * @private\n     */\n    TextPosition.prototype.clone = function () {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.currentWidget = this.currentWidget;\n        textPosition.offset = this.offset;\n        textPosition.location = this.location;\n        return textPosition;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.containsRtlText = function (widget) {\n        for (var i = 0; i < widget.children.length; i++) {\n            if (widget.children[i].isRightToLeft) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Set text position for paragraph and inline\n     * @private\n     */\n    TextPosition.prototype.setPositionForSelection = function (line, element, index, physicalLocation) {\n        //Set the start end position\n        var isParagraphEnd = false;\n        if (isNullOrUndefined(element)) {\n            this.currentWidget = line;\n        }\n        else {\n            this.currentWidget = element.line;\n            if (element.nextNode instanceof FieldElementBox && index > element.length) {\n                isParagraphEnd = this.selection.isLastRenderedInline(element, element.length);\n            }\n        }\n        this.location = physicalLocation;\n        if (isParagraphEnd) {\n            this.offset = this.selection.getParagraphLength(this.currentWidget.paragraph) + 1;\n        }\n        else {\n            this.offset = this.currentWidget.getOffset(element, index);\n        }\n    };\n    /**\n     * Set text position\n     * @private\n     */\n    TextPosition.prototype.setPositionFromLine = function (line, offset, location) {\n        this.currentWidget = line;\n        this.offset = offset;\n        if (location instanceof Point) {\n            this.location.copy(location);\n        }\n    };\n    /**\n     * Set text position\n     * @private\n     */\n    TextPosition.prototype.setPosition = function (line, positionAtStart) {\n        this.currentWidget = line;\n        this.offset = positionAtStart ? this.selection.getStartOffset(line.paragraph)\n            : this.selection.getParagraphLength(line.paragraph) + 1;\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Set position for text position\n     * @private\n     */\n    TextPosition.prototype.setPositionInternal = function (textPosition) {\n        this.currentWidget = textPosition.currentWidget;\n        this.offset = textPosition.offset;\n        this.location = textPosition.location;\n    };\n    /**\n     * Set position for current index\n     * @private\n     */\n    TextPosition.prototype.setPositionForCurrentIndex = function (hierarchicalIndex) {\n        var index = { index: hierarchicalIndex };\n        var paragraph = this.getParagraphWidget(index); //ref hierarchicalIndex\n        this.offset = parseFloat(index.index);\n        this.setPositionParagraph(paragraph, this.offset);\n    };\n    /**\n     * Get Page\n     */\n    TextPosition.prototype.getPage = function (position) {\n        var page;\n        var index = position.index.indexOf(';');\n        var newValue = '0';\n        if (index >= 0) {\n            newValue = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n        }\n        index = parseInt(newValue, 10);\n        page = this.viewer.pages[index];\n        return page;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.getParagraphWidget = function (position) {\n        if (isNullOrUndefined(position.index)) {\n            return undefined;\n        }\n        var page = this.getPage(position);\n        var child = this.getLineWidget(undefined, position, page);\n        return child;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.getLineWidget = function (widget, position, page) {\n        if (isNullOrUndefined(position.index)) {\n            return undefined;\n        }\n        var index = position.index.indexOf(';');\n        var value = '0';\n        if (index >= 0) {\n            value = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n        }\n        if (value === 'H' || value === 'F') {\n            if (value === 'H') {\n                widget = page.headerWidget;\n            }\n            else {\n                widget = page.footerWidget;\n            }\n        }\n        else if (!isNullOrUndefined(page)) {\n            widget = page.bodyWidgets[0];\n        }\n        index = parseInt(value, 10);\n        if (widget instanceof BlockContainer) {\n            index = position.index.indexOf(';');\n            value = '0';\n            value = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n            index = parseInt(value, 10);\n        }\n        if (widget instanceof TableRowWidget && index >= widget.childWidgets.length) {\n            position.index = '0;0';\n            index = widget.childWidgets.length - 1;\n        }\n        if (index >= 0 && index < widget.childWidgets.length) {\n            var child = widget.childWidgets[index];\n            if (child instanceof LineWidget) {\n                if (position.index.indexOf(';') > 0) {\n                    position.index = '0';\n                }\n                return child;\n            }\n            if (child instanceof Widget) {\n                if (position.index.indexOf(';') > 0) {\n                    return this.getLineWidget(child, position);\n                }\n                else {\n                    //If table is shifted to previous text position then return the first paragraph within table.\n                    if (child instanceof TableWidget) {\n                        return this.getLineWidget(this.selection.getFirstParagraphInFirstCell(child), position);\n                    }\n                    else if (child instanceof TableRowWidget && position.index.indexOf(';') === -1) {\n                        return this.selection.getFirstParagraphInFirstCell(child.ownerTable).childWidgets[0];\n                    }\n                    return undefined;\n                }\n            }\n        }\n        else if (widget.nextRenderedWidget instanceof Widget) {\n            position.index = '0';\n            if (widget.nextRenderedWidget instanceof TableWidget) {\n                return this.selection.getFirstParagraphInFirstCell(widget.nextRenderedWidget).firstChild;\n            }\n            return this.getLineWidget(widget.nextRenderedWidget, position);\n        }\n        return undefined;\n    };\n    /**\n     * Update physical location of paragraph\n     * @private\n     */\n    TextPosition.prototype.updatePhysicalPosition = function (moveNextLine) {\n        if (this.currentWidget && this.owner.isLayoutEnabled && this.isUpdateLocation) {\n            this.location = this.selection.getPhysicalPositionInternal(this.currentWidget, this.offset, moveNextLine);\n        }\n    };\n    /**\n     * Return true if text position are in same paragraph and offset\n     * @private\n     */\n    TextPosition.prototype.isAtSamePosition = function (textPosition) {\n        return this.currentWidget === textPosition.currentWidget\n            && this.offset === textPosition.offset;\n    };\n    /**\n     * Return true if text position is in same paragraph\n     * @private\n     */\n    TextPosition.prototype.isInSameParagraph = function (textPosition) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        return this.paragraph === textPosition.paragraph;\n    };\n    /**\n     * Return true is current text position exist before given text position\n     * @private\n     */\n    TextPosition.prototype.isExistBefore = function (textPosition) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        if (this.currentWidget === textPosition.currentWidget) {\n            return this.offset < textPosition.offset;\n        }\n        var currentParagraph = this.currentWidget.paragraph;\n        var paragraph = textPosition.currentWidget.paragraph;\n        if (currentParagraph === paragraph) {\n            return currentParagraph.childWidgets.indexOf(this.currentWidget) < paragraph.childWidgets.indexOf(textPosition.currentWidget);\n        }\n        if (currentParagraph.containerWidget === paragraph.containerWidget) {\n            if (currentParagraph.isInsideTable) {\n                return currentParagraph.associatedCell.childWidgets.indexOf(currentParagraph) <\n                    paragraph.associatedCell.childWidgets.indexOf(paragraph);\n                //handle after header footer implementation\n                // } else if ((this.currentParagraph).owner instanceof WHeaderFooter) {\n                //     return ((this.currentParagraph).owner as WHeaderFooter).blocks.indexOf((this.currentParagraph)) <\n                //         ((textPosition.currentParagraph).owner as WHeaderFooter).blocks.indexOf((textPosition.currentParagraph));\n            }\n            else {\n                return (currentParagraph.containerWidget.childWidgets.indexOf(currentParagraph)) <\n                    (paragraph.containerWidget.childWidgets.indexOf(paragraph));\n            }\n        }\n        return this.owner.selection.isExistBefore(currentParagraph, paragraph);\n    };\n    /**\n     * Return true is current text position exist after given text position\n     * @private\n     */\n    TextPosition.prototype.isExistAfter = function (textPosition) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        if (this.currentWidget === textPosition.currentWidget) {\n            return this.offset > textPosition.offset;\n        }\n        if (this.currentWidget.paragraph === textPosition.currentWidget.paragraph) {\n            return this.currentWidget.paragraph.childWidgets.indexOf(this.currentWidget) >\n                textPosition.currentWidget.paragraph.childWidgets.indexOf(textPosition.currentWidget);\n        }\n        var startParagraph = this.currentWidget.paragraph;\n        var endParagraph = textPosition.currentWidget.paragraph;\n        if (startParagraph.containerWidget.index === endParagraph.containerWidget.index) {\n            if (startParagraph.isInsideTable) {\n                return startParagraph.associatedCell.childWidgets.indexOf(startParagraph) >\n                    endParagraph.associatedCell.childWidgets.indexOf(endParagraph);\n                // } else if ((this.currentParagraph).owner instanceof WHeaderFooter) {\n                //     return ((this.currentParagraph).owner as WHeaderFooter).blocks.indexOf((this.currentParagraph)) >\n                //         ((textPosition.currentParagraph).owner as WHeaderFooter).blocks.indexOf((textPosition.currentParagraph));\n            }\n            else {\n                return (startParagraph.containerWidget.childWidgets.indexOf(startParagraph) >\n                    (endParagraph.containerWidget.childWidgets.indexOf(endParagraph)));\n            }\n        }\n        return this.owner.selection.isExistAfter(startParagraph, endParagraph);\n    };\n    /**\n     * Return hierarchical index of current text position\n     * @private\n     */\n    TextPosition.prototype.getHierarchicalIndexInternal = function () {\n        return this.getHierarchicalIndex(this.currentWidget, this.offset.toString());\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.getHierarchicalIndex = function (line, hierarchicalIndex) {\n        var node = line;\n        if (node) {\n            return node.getHierarchicalIndex(hierarchicalIndex);\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.setPositionParagraph = function (line, offsetInLine) {\n        this.currentWidget = line;\n        this.offset = offsetInLine;\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.setPositionForLineWidget = function (lineWidget, offset) {\n        var lineLength = this.selection.getLineLength(lineWidget);\n        var lineIndex = lineWidget.paragraph.childWidgets.indexOf(lineWidget);\n        if (lineWidget.isLastLine()) {\n            lineLength = lineLength + 1;\n        }\n        if (offset > lineLength) {\n            var nextLineWidget = void 0;\n            if (lineIndex >= lineWidget.paragraph.childWidgets.length - 1) {\n                var nextBlock = this.selection.getNextRenderedBlock(lineWidget.paragraph);\n                if (nextBlock && nextBlock.index === lineWidget.paragraph.index) {\n                    nextLineWidget = nextBlock.firstChild;\n                }\n            }\n            else {\n                nextLineWidget = lineWidget.paragraph.childWidgets[lineIndex + 1];\n            }\n            this.setPositionForLineWidget(nextLineWidget, offset - lineLength);\n            return;\n        }\n        else if (offset < 0) {\n            var prevLine = lineWidget.paragraph.childWidgets[lineIndex - 1];\n            var currentOffSet = this.selection.getLineLength(prevLine) + offset;\n            this.setPositionForLineWidget(prevLine, currentOffSet);\n            return;\n        }\n        else {\n            this.currentWidget = lineWidget;\n            this.offset = offset;\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * move to next text position\n     * @private\n     */\n    TextPosition.prototype.moveNextPosition = function (isNavigate) {\n        if (isNullOrUndefined(isNavigate)) {\n            isNavigate = true;\n        }\n        var inline = this.selection.getNextStartInline(this.currentWidget, this.offset);\n        if (inline instanceof FieldElementBox && inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd)) {\n            if (isNavigate) {\n                this.moveNextPositionInternal(inline);\n                this.moveNextPosition();\n                return;\n            }\n            else {\n                var line = inline.fieldEnd.line;\n                var fieldEnd = inline.fieldEnd;\n                var fieldEndOffset = line.getOffset(fieldEnd, 1);\n                var fieldEndIndex = this.getHierarchicalIndex(line, fieldEndOffset.toString());\n                if (TextPosition.isForwardSelection(this.selection.end.getHierarchicalIndexInternal(), fieldEndIndex)) {\n                    //If field end is after selection end, extend selection end to field end.\n                    this.selection.end.moveToInline(inline.fieldEnd, 1);\n                    return;\n                }\n                this.moveToInline(inline.fieldEnd, 1);\n            }\n        }\n        var nextOffset = this.selection.getNextValidOffset(this.currentWidget, this.offset);\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        var index = 0;\n        if (nextOffset > this.offset) {\n            this.offset = nextOffset;\n            var info = this.currentWidget.getInline(this.offset, index);\n            inline = info.element;\n            index = info.index;\n            if (!isNullOrUndefined(inline) && index === inline.length && inline.nextNode instanceof FieldElementBox) {\n                var nextValidInline = this.selection.getNextValidElement(inline.nextNode);\n                //Moves to field end mark.\n                if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 1) {\n                    inline = nextValidInline;\n                    this.offset = this.currentWidget.getOffset(inline, 1);\n                }\n            }\n        }\n        else if (lineIndex + 1 < this.paragraph.childWidgets.length) {\n            var nextLineWidget = this.paragraph.childWidgets[lineIndex + 1];\n            if (nextLineWidget) {\n                this.currentWidget = nextLineWidget;\n                this.offset = this.selection.getStartLineOffset(this.currentWidget);\n            }\n            var inlineObj = this.currentWidget.getInline(this.offset, index);\n            inline = inlineObj.element;\n            index = inlineObj.index;\n            if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n                this.offset++;\n            }\n        }\n        else {\n            this.updateOffsetToNextParagraph(index, false);\n        }\n        //Gets physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Move text position to previous paragraph inside table\n     * @private\n     */\n    TextPosition.prototype.moveToPreviousParagraphInTable = function (selection) {\n        var previousParagraph;\n        var currentPara = this.currentWidget.paragraph;\n        if (currentPara.isInsideTable) {\n            previousParagraph = selection.getPreviousSelectionCell(currentPara.associatedCell);\n        }\n        else {\n            previousParagraph = selection.getPreviousParagraphBlock(currentPara);\n        }\n        if (isNullOrUndefined(previousParagraph)) {\n            return;\n        }\n        this.currentWidget = previousParagraph.childWidgets[previousParagraph.childWidgets.length - 1];\n        this.offset = this.currentWidget.getEndOffset() + 1;\n    };\n    TextPosition.prototype.updateOffsetToNextParagraph = function (indexInInline, isHighlight) {\n        //Moves to owner and get next paragraph.\n        var inline;\n        var positionAtStart = false;\n        var nextParagraph = undefined;\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        if (!isHighlight) {\n            nextParagraph = this.selection.getNextParagraphBlock(this.paragraph);\n        }\n        else if (lineIndex + 1 < this.paragraph.childWidgets.length) {\n            var nextLineWidget = this.paragraph.childWidgets[lineIndex + 1];\n            if (nextLineWidget) {\n                this.currentWidget = nextLineWidget;\n                this.offset = 1;\n            }\n        }\n        else {\n            nextParagraph = this.selection.getNextSelectionBlock(this.paragraph);\n            if (!isNullOrUndefined(nextParagraph)) {\n                if (nextParagraph.containerWidget instanceof TableCellWidget) {\n                    if (this.selection.start.paragraph.isInsideTable) {\n                        // tslint:disable-next-line:max-line-length\n                        var containerCell = this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell, nextParagraph.associatedCell);\n                        positionAtStart = !containerCell.ownerTable.contains(nextParagraph.associatedCell);\n                    }\n                    else {\n                        positionAtStart = true;\n                    }\n                }\n            }\n        }\n        if (!isNullOrUndefined(nextParagraph) && nextParagraph.childWidgets.length > 0) {\n            if (!positionAtStart) {\n                this.currentWidget = nextParagraph.firstChild;\n                this.offset = isHighlight ? 1 : this.selection.getStartLineOffset(this.currentWidget);\n            }\n            else {\n                this.currentWidget = nextParagraph.childWidgets[nextParagraph.childWidgets.length - 1];\n                this.offset = this.selection.getLineLength(this.currentWidget) + 1;\n            }\n        }\n        var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n        inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            this.offset++;\n        }\n    };\n    TextPosition.prototype.updateOffsetToPrevPosition = function (index, isHighlight) {\n        var inlineInfo;\n        var inline;\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        var prevOffset = this.selection.getPreviousValidOffset(this.currentWidget.paragraph, this.offset);\n        if (this.offset > prevOffset) {\n            this.offset = prevOffset;\n        }\n        else if (lineIndex > 0) {\n            var prevLineWidget = this.paragraph.childWidgets[lineIndex - 1];\n            if (prevLineWidget) {\n                this.currentWidget = prevLineWidget;\n                var endOffset = this.currentWidget.getEndOffset();\n                this.offset = endOffset > 0 ? endOffset - 1 : endOffset;\n            }\n        }\n        else {\n            //Moves to owner and get previous paragraph.\n            var previousParagraph = undefined;\n            var positionAtStart = false;\n            if (!isHighlight) {\n                previousParagraph = this.selection.getPreviousParagraphBlock(this.paragraph);\n            }\n            else {\n                previousParagraph = this.selection.getPreviousSelectionBlock(this.paragraph);\n                if (!isNullOrUndefined(previousParagraph)) {\n                    if (previousParagraph.containerWidget instanceof TableCellWidget) {\n                        if (this.selection.start.paragraph.isInsideTable) {\n                            // tslint:disable-next-line:max-line-length\n                            var containerCell = this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell, previousParagraph.associatedCell);\n                            positionAtStart = !containerCell.ownerTable.contains(previousParagraph.associatedCell);\n                        }\n                        else {\n                            positionAtStart = true;\n                        }\n                    }\n                }\n            }\n            if (!isNullOrUndefined(previousParagraph)) {\n                if (!positionAtStart) {\n                    this.currentWidget = previousParagraph.childWidgets[previousParagraph.childWidgets.length - 1];\n                    this.offset = this.currentWidget.getEndOffset();\n                }\n                else {\n                    this.currentWidget = previousParagraph.firstChild;\n                    this.offset = this.selection.getStartLineOffset(this.currentWidget);\n                }\n            }\n        }\n        index = 0;\n        inlineInfo = this.currentWidget.getInline(this.offset, index);\n        inline = inlineInfo.element;\n        index = inlineInfo.index;\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            this.offset++;\n        }\n        if (inline instanceof FieldElementBox) {\n            //Checks if field character is part of rendered field, otherwise moves to previous rendered content.\n            var previousInline = this.selection.getPreviousValidElement(inline);\n            if (!isNullOrUndefined(previousInline)) {\n                inline = previousInline;\n                this.currentWidget = inline.line;\n                this.offset = this.currentWidget.getOffset(inline, inline.length);\n                if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n                    this.offset--;\n                }\n            }\n        }\n        //Gets physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Moves the text position to start of the next paragraph.\n     */\n    TextPosition.prototype.moveToNextParagraphStartInternal = function () {\n        var paragraph = this.currentWidget.paragraph;\n        if (!isNullOrUndefined(this.selection.getNextParagraphBlock(paragraph))) {\n            // tslint:disable-next-line:max-line-length\n            this.currentWidget = this.selection.getNextParagraphBlock(paragraph).firstChild;\n            this.offset = this.selection.getStartOffset(paragraph);\n            this.updatePhysicalPosition(true);\n        }\n    };\n    /**\n     * Move to previous position\n     * @private\n     */\n    TextPosition.prototype.movePreviousPosition = function () {\n        var index = 0;\n        var inlineInfo = this.currentWidget.getInline(this.offset, index);\n        var inline = inlineInfo.element;\n        index = inlineInfo.index;\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        if (inline instanceof FieldElementBox && inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n            this.movePreviousPositionInternal(inline);\n        }\n        this.updateOffsetToPrevPosition(index, false);\n    };\n    /**\n     * Move to next position\n     * @private\n     */\n    TextPosition.prototype.moveNextPositionInternal = function (fieldBegin) {\n        var inline;\n        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            inline = fieldBegin.fieldEnd;\n        }\n        else {\n            inline = fieldBegin.fieldSeparator;\n            this.currentWidget = inline.line;\n            // tslint:disable-next-line:max-line-length\n            if (this.currentWidget === fieldBegin.fieldEnd.line && !this.selection.hasValidInline(this.paragraph, inline, fieldBegin.fieldEnd)) {\n                inline = fieldBegin.fieldEnd;\n            }\n        }\n        this.currentWidget = inline.line;\n        this.offset = this.currentWidget.getOffset(inline, 1);\n    };\n    /**\n     * Move text position backward\n     * @private\n     */\n    TextPosition.prototype.moveBackward = function () {\n        var indexInInline = 0;\n        var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!this.owner.selection.isEmpty && !isNullOrUndefined(inline)) {\n            var nextInline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n            if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0) {\n                var hierarchicalIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n                // tslint:disable-next-line:max-line-length\n                var fieldEndOffset = nextInline.fieldEnd.line.getOffset(nextInline.fieldEnd, 1);\n                // tslint:disable-next-line:max-line-length\n                var fieldEndIndex = this.getHierarchicalIndex(nextInline.fieldEnd.line, fieldEndOffset.toString());\n                if (!TextPosition.isForwardSelection(fieldEndIndex, hierarchicalIndex)) {\n                    //If field end is after selection start, move selection start to field end.\n                    // tslint:disable-next-line:max-line-length\n                    this.owner.selection.start.setPositionParagraph(nextInline.fieldEnd.line, fieldEndOffset);\n                    return;\n                }\n            }\n        }\n        if (inline instanceof FieldElementBox && inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n            var hierarchicalIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n            var fieldEndOffset = inline.line.getOffset(inline, 1);\n            var fieldEndIndex = this.getHierarchicalIndex(inline.line, fieldEndOffset.toString());\n            if (!TextPosition.isForwardSelection(hierarchicalIndex, fieldEndIndex)) {\n                //If field end is after selection start, extend selection end to field begin.\n                // tslint:disable-next-line:max-line-length\n                var fieldBeginOffset = inline.fieldBegin.line.getOffset(inline.fieldBegin, 0);\n                this.currentWidget = inline.fieldBegin.line;\n                this.offset = fieldBeginOffset;\n                //Updates physical position in current page.\n                this.updatePhysicalPosition(true);\n                return;\n            }\n            this.movePreviousPositionInternal(inline);\n        }\n        this.updateOffsetToPrevPosition(indexInInline, true);\n    };\n    /**\n     * Move text position forward\n     * @private\n     */\n    TextPosition.prototype.moveForward = function () {\n        var indexInInline = 0;\n        var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!isNullOrUndefined(inline)) {\n            if (!this.owner.selection.isEmpty && indexInInline === inline.length && inline instanceof FieldElementBox\n                && inline.fieldType === 1) {\n                var hierarchicalIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n                // tslint:disable-next-line:max-line-length\n                var fieldBeginOffset = inline.fieldBegin.line.getOffset(inline.fieldBegin, 0);\n                // tslint:disable-next-line:max-line-length\n                var fieldBeginIndex = this.getHierarchicalIndex(inline.fieldBegin.line, fieldBeginOffset.toString());\n                if (!TextPosition.isForwardSelection(hierarchicalIndex, fieldBeginIndex)) {\n                    //If field begin is before selection start, move selection start to field begin.\n                    // tslint:disable-next-line:max-line-length\n                    this.owner.selection.start.setPositionParagraph(inline.fieldBegin.line, fieldBeginOffset);\n                    return;\n                }\n            }\n            inline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n        }\n        if (inline instanceof FieldElementBox && !isNullOrUndefined(inline.fieldEnd)) {\n            var selectionStartParagraph = this.owner.selection.start.paragraph;\n            var selectionStartIndex = 0;\n            // tslint:disable-next-line:max-line-length\n            var selectionStartInlineObj = selectionStartParagraph.getInline(this.owner.selection.start.offset, selectionStartIndex);\n            var selectionStartInline = selectionStartInlineObj.element;\n            selectionStartIndex = selectionStartInlineObj.index;\n            var nextRenderInline = this.selection.getNextRenderedElementBox(selectionStartInline, selectionStartIndex);\n            if (nextRenderInline === inline) {\n                this.moveNextPositionInternal(inline);\n            }\n            else {\n                //If selection start is before field begin, extend selection end to field end.\n                inline = inline.fieldEnd;\n                this.currentWidget = inline.line;\n                this.offset = this.currentWidget.getOffset(inline, 1);\n                //Updates physical position in current page.\n                this.updatePhysicalPosition(true);\n                return;\n            }\n        }\n        else if ((inline instanceof FieldElementBox)\n            && (inline.fieldType === 0 || inline.fieldType === 1)) {\n            this.currentWidget = inline.line;\n            this.offset = this.currentWidget.getOffset(inline, 1);\n        }\n        indexInInline = 0;\n        var nextOffset = this.selection.getNextValidOffset(this.currentWidget, this.offset);\n        var length = this.selection.getLineLength(this.currentWidget);\n        var isParagraphEnd = this.selection.isParagraphLastLine(this.currentWidget);\n        if (this.offset < nextOffset) {\n            this.offset = nextOffset;\n            var inlineObj_1 = this.currentWidget.getInline(this.offset, indexInInline);\n            inline = inlineObj_1.element;\n            indexInInline = inlineObj_1.index;\n            if (!isNullOrUndefined(inline) && indexInInline === inline.length && inline.nextNode instanceof FieldElementBox) {\n                var nextValidInline = this.selection.getNextValidElement(inline.nextNode);\n                //Moves to field end mark.\n                if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 1) {\n                    inline = nextValidInline;\n                    this.offset = this.currentWidget.getOffset(inline, 1);\n                }\n            }\n        }\n        else if (this.offset === nextOffset && this.offset < length + 1 && isParagraphEnd) {\n            this.offset = length + 1;\n        }\n        else {\n            this.updateOffsetToNextParagraph(indexInInline, true);\n        }\n        //Gets physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Move to given inline\n     * @private\n     */\n    TextPosition.prototype.moveToInline = function (inline, index) {\n        this.currentWidget = inline.line;\n        this.offset = this.currentWidget.getOffset(inline, index);\n        //Updates physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Return true is start element exist before end element\n     * @private\n     */\n    TextPosition.isForwardSelection = function (start, end) {\n        if (start === end) {\n            return true;\n        }\n        start = start.replace(/C;/g, '');\n        end = end.replace(/C;/g, '');\n        start = start.replace(/H;/g, '');\n        end = end.replace(/H;/g, '');\n        start = start.replace(/F;/g, '');\n        end = end.replace(/F;/g, '');\n        var selectionStart = start.split(';');\n        var selectionEnd = end.split(';');\n        var length = selectionStart.length;\n        if (length > selectionEnd.length) {\n            length = selectionEnd.length - 1;\n        }\n        for (var i = 0; i < length; i++) {\n            var startOffset = parseFloat(selectionStart[i]);\n            var endOffset = parseFloat(selectionEnd[i]);\n            if (startOffset !== endOffset) {\n                return startOffset < endOffset;\n            }\n        }\n        return false;\n    };\n    /**\n     * Move to previous position offset\n     * @private\n     */\n    TextPosition.prototype.movePreviousPositionInternal = function (fieldEnd) {\n        var inline;\n        if (isNullOrUndefined(fieldEnd.fieldSeparator)) {\n            inline = this.selection.getPreviousValidElement(fieldEnd.fieldBegin);\n        }\n        else {\n            inline = this.selection.getPreviousValidElement(fieldEnd);\n        }\n        this.currentWidget = inline.line;\n        this.offset = this.currentWidget.getOffset(inline, inline instanceof FieldElementBox ? 0 : inline.length);\n    };\n    /**\n     * Moves the text position to start of the word.\n     * @private\n     */\n    TextPosition.prototype.moveToWordStartInternal = function (type) {\n        var endOffset = this.currentWidget.getEndOffset();\n        var currentPara = this.currentWidget.paragraph;\n        var selection = this.selection;\n        if (type === 2 && (this.offset === endOffset || this.offset === endOffset + 1)) {\n            return;\n        }\n        if (this.offset === endOffset + 1) {\n            this.offset = endOffset;\n        }\n        else if (this.offset === selection.getStartOffset(currentPara) && this.currentWidget === currentPara.childWidgets[0]) {\n            var previousParagraph = selection.getPreviousParagraphBlock(currentPara);\n            if (isNullOrUndefined(previousParagraph)) {\n                return;\n            }\n            this.currentWidget = previousParagraph.childWidgets[previousParagraph.childWidgets.length - 1];\n            this.offset = this.currentWidget.getEndOffset();\n        }\n        else {\n            if (this.offset === selection.getStartLineOffset(this.currentWidget)) {\n                var lineIndex = currentPara.childWidgets.indexOf(this.currentWidget);\n                if (lineIndex - 1 >= 0) {\n                    this.currentWidget = currentPara.childWidgets[lineIndex - 1];\n                    this.offset = this.currentWidget.getEndOffset();\n                }\n            }\n            var isStarted = false;\n            var endSelection = false;\n            var indexInInline = 0;\n            var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            // tslint:disable-next-line:max-line-length           \n            this.getPreviousWordOffset(inline, selection, indexInInline, type, (inline instanceof FieldElementBox && inline.fieldType === 1), isStarted, endSelection, this);\n        }\n        if (type === 1) {\n            this.calculateOffset();\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Get next word offset\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffset = function (inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (inline instanceof TextElementBox) {\n            this.getNextWordOffsetSpan(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof ImageElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetImage(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldBegin(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 2 || inline instanceof BookmarkElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldSeperator(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldEnd(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n    };\n    /**\n     * get next word offset from field begin\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetFieldBegin = function (fieldBegin, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        var startOffset = fieldBegin.line.getOffset(fieldBegin, 0);\n        var endOffset = startOffset + fieldBegin.length;\n        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            this.getNextWordOffsetFieldEnd(fieldBegin.fieldEnd, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (type === 0) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldSeperator(fieldBegin.fieldSeparator, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (!isNullOrUndefined(fieldBegin.fieldEnd)) {\n            var inline = fieldBegin.fieldSeparator;\n            // tslint:disable-next-line:max-line-length\n            if (inline.line.paragraph === fieldBegin.fieldEnd.line.paragraph && !this.selection.hasValidInline(inline.line.paragraph, inline, fieldBegin.fieldEnd)) {\n                inline = fieldBegin.fieldEnd;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffset(inline, 0, type, !(endPosition.paragraph === fieldBegin.line.paragraph && endPosition.offset === startOffset), endSelection, endPosition, excludeSpace);\n            // tslint:disable-next-line:max-line-length\n            if (endSelection && !isNullOrUndefined(fieldBegin.fieldSeparator) && (endPosition.paragraph === fieldBegin.line.paragraph) && (endPosition.offset === fieldBegin.fieldSeparator.line.getOffset(fieldBegin.fieldSeparator, fieldBegin.fieldSeparator.length))) {\n                endPosition.setPositionParagraph(fieldBegin.line, startOffset);\n                return;\n            }\n            if (!endSelection) {\n                // tslint:disable-next-line:max-line-length\n                endPosition.setPositionParagraph(fieldBegin.fieldEnd.line, fieldBegin.fieldEnd.line.getOffset(fieldBegin.fieldEnd, fieldBegin.fieldEnd.length));\n            }\n        }\n    };\n    /**\n     * get next word offset from image\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetImage = function (image, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (isInField) {\n            endPosition.setPositionParagraph(image.line, image.line.getOffset(image, indexInInline));\n            endSelection = false;\n            return;\n        }\n        if (indexInInline === 0) {\n            var startOffset = image.line.getOffset(image, 0);\n            endSelection = true;\n            if (endPosition.offset === startOffset) {\n                if (isNullOrUndefined(image.nextNode)) {\n                    endPosition.setPositionParagraph(image.line, startOffset + image.length);\n                }\n                else {\n                    this.getNextWordOffset(image.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n                }\n            }\n            else {\n                endPosition.setPositionParagraph(image.line, startOffset);\n            }\n        }\n        else if (!isNullOrUndefined(image.nextNode)) {\n            this.getNextWordOffset(image.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n    };\n    /**\n     * get next word offset from span\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetSpan = function (span, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (span.text === '\\t' || span.text === '\\v') {\n            if (isInField) {\n                endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n                endSelection = false;\n                return;\n            }\n            if (indexInInline === 0) {\n                endSelection = true;\n                var startOffset = span.line.getOffset(span, 0);\n                if (endPosition.offset === startOffset) {\n                    endPosition.setPositionParagraph(span.line, startOffset + span.length);\n                }\n                else {\n                    endPosition.setPositionParagraph(span.line, startOffset);\n                }\n            }\n            else if (!isNullOrUndefined(span.nextNode)) {\n                this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n            }\n        }\n        else {\n            var wordEndIndex = 0;\n            if (indexInInline === 0 && endSelection && (HelperMethods.wordSplitCharacters.indexOf(span.text[0]) === -1)) {\n                endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n                if (isInField) {\n                    return;\n                }\n            }\n            else if (indexInInline < span.length) {\n                // tslint:disable-next-line:max-line-length\n                var txt = indexInInline > 0 && span.text.length - 1 >= indexInInline ? span.text.slice(indexInInline, span.length) : span.text;\n                wordEndIndex = HelperMethods.indexOfAny(txt, HelperMethods.wordSplitCharacters);\n                if (wordEndIndex !== -1) {\n                    if (isInField) {\n                        endSelection = false;\n                        return;\n                    }\n                    var offset = span.line.getOffset(span, wordEndIndex + indexInInline);\n                    // tslint:disable-next-line:max-line-length\n                    if ((excludeSpace || txt[wordEndIndex] !== ' ') && !endSelection && span.line.paragraph === endPosition.paragraph && offset !== endPosition.offset) {\n                        endSelection = true;\n                        endPosition.setPositionParagraph(span.line, offset);\n                        return;\n                    }\n                    wordEndIndex++;\n                    while (wordEndIndex < txt.length && HelperMethods.wordSplitCharacters.indexOf(txt[wordEndIndex]) !== -1) {\n                        if (txt[wordEndIndex] !== ' ' && txt[wordEndIndex] !== '　') {\n                            break;\n                        }\n                        wordEndIndex++;\n                    }\n                    endSelection = true;\n                    if (wordEndIndex < txt.length) {\n                        // tslint:disable-next-line:max-line-length\n                        endPosition.setPositionParagraph(span.line, span.line.getOffset(span, wordEndIndex + indexInInline));\n                    }\n                    else if (!isNullOrUndefined(span.nextNode)) {\n                        // tslint:disable-next-line:max-line-length\n                        this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        endPosition.setPositionParagraph(span.line, span.line.getOffset(span, wordEndIndex + indexInInline));\n                    }\n                }\n                else if (!isNullOrUndefined(span.nextNode)) {\n                    this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n                }\n                else {\n                    endPosition.setPositionParagraph(span.line, span.line.getEndOffset());\n                }\n            }\n            else if (!isNullOrUndefined(span.nextNode)) {\n                this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n            }\n        }\n    };\n    /**\n     * get next word offset from field separator\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetFieldSeperator = function (fieldSeparator, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (!isNullOrUndefined(fieldSeparator.nextNode)) {\n            this.getNextWordOffset(fieldSeparator.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n    };\n    /**\n     * get next word offset from field end\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetFieldEnd = function (fieldEnd, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        var startOffset = fieldEnd.line.getOffset(fieldEnd, 0);\n        var endOffset = startOffset + fieldEnd.length;\n        if (endPosition.offset === startOffset) {\n            endPosition.setPositionParagraph(fieldEnd.line, endOffset);\n            if (isNullOrUndefined(fieldEnd.nextNode)) {\n                return;\n            }\n        }\n        if (!isNullOrUndefined(fieldEnd.nextNode)) {\n            this.getNextWordOffset(fieldEnd.nextNode, 0, type, false, endSelection, endPosition, excludeSpace);\n            if (endPosition.offset === endOffset) {\n                endPosition.setPositionParagraph(fieldEnd.line, startOffset);\n            }\n        }\n        else {\n            endPosition.setPositionParagraph(fieldEnd.line, startOffset);\n        }\n        endSelection = true;\n    };\n    /**\n     * Get previous word offset\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffset = function (inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (inline instanceof TextElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetSpan(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof ImageElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetImage(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetFieldBegin(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetFieldSeparator(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetFieldEnd(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof BookmarkElementBox) {\n            this.getPreviousWordOffsetBookMark(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof ListTextElementBox && inline.previousNode) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetSpan(inline.previousNode, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetBookMark = function (bookmark, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (bookmark.previousNode) {\n            if (bookmark.previousNode instanceof TextElementBox) {\n                var inline = bookmark.previousNode;\n                if (HelperMethods.lastIndexOfAny(inline.text, HelperMethods.wordSplitCharacters) !== inline.text.length - 1) {\n                    this.getPreviousWordOffset(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n                }\n                else {\n                    endPosition.setPositionParagraph(bookmark.line, bookmark.line.getOffset(bookmark, 0));\n                }\n            }\n        }\n        else {\n            endPosition.setPositionParagraph(bookmark.line, selection.getStartLineOffset(bookmark.line));\n        }\n    };\n    /**\n     * get previous word offset from field end\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetFieldEnd = function (fieldEnd, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        var startOffset = fieldEnd.line.getOffset(fieldEnd, 0);\n        var endOffset = startOffset + fieldEnd.length;\n        if (isNullOrUndefined(fieldEnd.fieldSeparator)) {\n            this.getPreviousWordOffsetFieldBegin(fieldEnd.fieldBegin, selection, 0, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (type === 0 && !isNullOrUndefined(fieldEnd.previousNode)) {\n            var inline = fieldEnd.previousNode;\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(inline, selection, inline.length, type, (inline instanceof FieldElementBox && inline.fieldType === 1), isStarted, endSelection, endPosition);\n        }\n        else if (!isNullOrUndefined(fieldEnd.fieldBegin) && type !== 0) {\n            var inline = fieldEnd.previousNode;\n            // tslint:disable-next-line:max-line-length\n            if (isNullOrUndefined(inline) || (inline.line.paragraph === fieldEnd.fieldBegin.line.paragraph && !selection.hasValidInline(inline.line.paragraph, inline, fieldEnd.fieldBegin))) {\n                inline = fieldEnd.fieldBegin;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(inline, selection, inline.length, type, !(endPosition.paragraph === fieldEnd.line.paragraph && endPosition.offset === endOffset), isStarted, endSelection, endPosition);\n            if (endSelection && endPosition.paragraph === fieldEnd.line.paragraph\n                && endPosition.offset === startOffset) {\n                endPosition.setPositionParagraph(fieldEnd.line, endOffset);\n                return;\n            }\n            if (!endSelection) {\n                // tslint:disable-next-line:max-line-length\n                endPosition.setPositionParagraph(fieldEnd.fieldBegin.line, fieldEnd.fieldBegin.line.getOffset(fieldEnd.fieldBegin, 0));\n            }\n        }\n    };\n    /**\n     * get previous word offset from field separator\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetFieldSeparator = function (fieldSeparator, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        this.getPreviousWordOffsetFieldBegin(fieldSeparator.fieldBegin, selection, fieldSeparator.fieldBegin.length, type, isInField, isStarted, endSelection, endPosition);\n    };\n    /**\n     * get previous word offset from field begin\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetFieldBegin = function (fieldBegin, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        var startOffset = fieldBegin.line.getOffset(fieldBegin, 0);\n        var endOffset = startOffset + fieldBegin.length;\n        if (endPosition.offset === endOffset) {\n            endPosition.setPositionParagraph(fieldBegin.line, startOffset);\n        }\n        if (!isNullOrUndefined(fieldBegin.previousNode)) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(fieldBegin.previousNode, selection, fieldBegin.previousNode.length, type, false, isStarted, endSelection, endPosition);\n            if (endPosition.offset === startOffset) {\n                if (type !== 0 && !isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    // tslint:disable-next-line:max-line-length\n                    endPosition.setPositionParagraph(fieldBegin.line, fieldBegin.fieldSeparator.line.getOffset(fieldBegin.fieldSeparator, fieldBegin.fieldSeparator.length));\n                }\n            }\n        }\n        else {\n            endPosition.setPositionParagraph(fieldBegin.line, selection.getStartLineOffset(fieldBegin.line));\n        }\n    };\n    /**\n     * get previous word offset from image\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetImage = function (image, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (isInField) {\n            endPosition.setPositionParagraph(image.line, image.line.getOffset(image, indexInInline));\n            endSelection = false;\n            return;\n        }\n        if (indexInInline === image.length) {\n            var endOffset = image.line.getOffset(image, image.length);\n            if (endOffset === endPosition.offset) {\n                endPosition.setPositionParagraph(image.line, endOffset - image.length);\n            }\n            else {\n                endPosition.setPositionParagraph(image.line, endOffset);\n            }\n        }\n        else if (!isNullOrUndefined(image.previousNode)) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(image.previousNode, selection, image.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n        }\n    };\n    /**\n     * Get previous word offset from span\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length   \n    TextPosition.prototype.getPreviousWordOffsetSpan = function (span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (span.text === '\\t' || span.text === '\\v') {\n            if (isInField) {\n                endSelection = false;\n                return;\n            }\n            if (indexInInline === span.length) {\n                endSelection = true;\n                var endOffset = span.line.getOffset(span, span.length);\n                if (endOffset === endPosition.offset) {\n                    endPosition.setPositionParagraph(span.line, endOffset - span.length);\n                }\n                else {\n                    endPosition.setPositionParagraph(span.line, endOffset);\n                }\n            }\n            else if (!isNullOrUndefined(span.previousNode)) {\n                // tslint:disable-next-line:max-line-length\n                this.getPreviousWordOffset(span.previousNode, selection, span.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n            }\n        }\n        else {\n            var wordStartIndex = 0;\n            if (!isStarted) {\n                while (indexInInline > 0 && span.text[indexInInline - 1] === ' ') {\n                    indexInInline--;\n                }\n                endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n            }\n            if (indexInInline > 0) {\n                isStarted = true;\n                if (indexInInline === 0 && endSelection && (HelperMethods.wordSplitCharacters.indexOf(span.text[0])) === -1) {\n                    endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n                    endSelection = true;\n                    return;\n                }\n                var txt = span.text.length > indexInInline ? span.text.slice(0, indexInInline) : span.text;\n                wordStartIndex = HelperMethods.lastIndexOfAny(txt, HelperMethods.wordSplitCharacters);\n                if (wordStartIndex !== -1) {\n                    if (isInField) {\n                        endSelection = false;\n                        return;\n                    }\n                    while (wordStartIndex > 0 && endSelection && txt[wordStartIndex] !== ' '\n                        && (HelperMethods.wordSplitCharacters.indexOf(txt[wordStartIndex - 1])) !== -1) {\n                        wordStartIndex--;\n                    }\n                    if (txt[wordStartIndex] === ' ' || txt[wordStartIndex] === '　' || !endSelection) {\n                        wordStartIndex++;\n                    }\n                    endSelection = true;\n                    if (wordStartIndex > 0) {\n                        var offset = span.line.getOffset(span, wordStartIndex);\n                        if (span.line.paragraph === endPosition.paragraph && offset === endPosition.offset) {\n                            // tslint:disable-next-line:max-line-length\n                            this.getPreviousWordOffsetSpan(span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n                        }\n                        else {\n                            endPosition.setPositionParagraph(span.line, offset);\n                        }\n                    }\n                    else if (span.previousNode instanceof TextElementBox) {\n                        // tslint:disable-next-line:max-line-length\n                        this.getPreviousWordOffset(span.previousNode, selection, span.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n                    }\n                    else {\n                        endPosition.setPositionParagraph(span.line, span.line.getOffset(span, 0));\n                    }\n                }\n                else {\n                    this.setPreviousWordOffset(span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n                }\n            }\n            else {\n                this.setPreviousWordOffset(span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n            }\n        }\n    };\n    /**\n     * set previous word offset in span\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.setPreviousWordOffset = function (span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (span.previousNode instanceof ElementBox && span.line === span.previousNode.line) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(span.previousNode, selection, span.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else {\n            endPosition.setPositionParagraph(span.line, selection.getStartLineOffset(span.line));\n        }\n    };\n    /**\n     * Validate if text position is in field forward\n     * @private\n     */\n    TextPosition.prototype.validateForwardFieldSelection = function (currentIndex, selectionEndIndex) {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionForCurrentIndex(currentIndex);\n        textPosition.isUpdateLocation = false;\n        var isPositionMoved = false;\n        while (currentIndex !== selectionEndIndex && TextPosition.isForwardSelection(currentIndex, selectionEndIndex)) {\n            if (!isPositionMoved) {\n                textPosition.moveNextPosition(false);\n                var nextIndex = textPosition.getHierarchicalIndexInternal();\n                //Handled specifically to break infinite looping, if selection ends at last paragraph mark.\n                if (currentIndex === nextIndex) {\n                    break;\n                }\n            }\n            var indexInInline = 0;\n            var inlineObj = textPosition.currentWidget.getInline(textPosition.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!isNullOrUndefined(inline)) {\n                var selectionStartIndex = this.selection.start.getHierarchicalIndexInternal();\n                if (indexInInline === inline.length && inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    if (inline.line.getOffset(inline, 0) === this.offset) {\n                        return;\n                    }\n                    var lineWidget = inline.fieldBegin.line;\n                    var fieldBeginOffset = lineWidget.getOffset(inline.fieldBegin, 0);\n                    var fieldBeginIndex = this.getHierarchicalIndex(lineWidget, fieldBeginOffset.toString());\n                    if (!TextPosition.isForwardSelection(selectionStartIndex, fieldBeginIndex)) {\n                        this.selection.start.setPositionParagraph(lineWidget, fieldBeginOffset);\n                    }\n                }\n                var nextInline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n                if (!isNullOrUndefined(nextInline) && nextInline instanceof ElementBox) {\n                    inline = nextInline;\n                }\n            }\n            isPositionMoved = (inline instanceof FieldElementBox && inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd));\n            if (isPositionMoved) {\n                if (inline.line.getOffset(inline, 0) === this.offset) {\n                    return;\n                }\n                var fieldEnd = inline.fieldEnd;\n                var paragraph = fieldEnd.line.paragraph;\n                var fieldEndOffset = fieldEnd.line.getOffset(fieldEnd, 1);\n                var fieldEndIndex = this.getHierarchicalIndex(fieldEnd.line, fieldEndOffset.toString());\n                if (!TextPosition.isForwardSelection(fieldEndIndex, selectionEndIndex)) {\n                    //If selection end is after field begin, extend selection end to field end.\n                    this.moveToInline(inline.fieldEnd, 1);\n                    return;\n                }\n                textPosition.moveToInline(inline.fieldEnd, 1);\n            }\n            currentIndex = textPosition.getHierarchicalIndexInternal();\n        }\n    };\n    /**\n     * Validate if text position is in field backward\n     * @private\n     */\n    TextPosition.prototype.validateBackwardFieldSelection = function (currentIndex, selectionEndIndex) {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionForCurrentIndex(currentIndex);\n        textPosition.isUpdateLocation = false;\n        var selectionStartIndex = this.selection.start.getHierarchicalIndexInternal();\n        while (currentIndex !== selectionEndIndex && TextPosition.isForwardSelection(selectionEndIndex, currentIndex)) {\n            var indexInInline = 0;\n            var inlineObj = textPosition.currentWidget.getInline(textPosition.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!isNullOrUndefined(inline)) {\n                var nextInline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n                if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0) {\n                    var paragraph = nextInline.fieldEnd.line;\n                    var fieldEndOffset = paragraph.getOffset(nextInline.fieldEnd, 1);\n                    var fieldEndIndex = this.getHierarchicalIndex(paragraph, fieldEndOffset.toString());\n                    if (!TextPosition.isForwardSelection(fieldEndIndex, selectionStartIndex)) {\n                        this.selection.start.setPositionParagraph(paragraph, fieldEndOffset);\n                        selectionStartIndex = fieldEndIndex;\n                    }\n                }\n            }\n            if (inline instanceof FieldElementBox && inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n                var line = inline.fieldBegin.line;\n                var fieldBegin = inline.fieldBegin;\n                var fieldBeginOffset = line.getOffset(fieldBegin, 0);\n                var fieldBeginIndex = this.getHierarchicalIndex(line, fieldBeginOffset.toString());\n                if (!TextPosition.isForwardSelection(selectionEndIndex, fieldBeginIndex)) {\n                    //If field begin is before selection end, extend selection end to field begin.\n                    this.moveToInline(inline.fieldBegin, 0);\n                    return;\n                }\n                textPosition.moveToInline(inline.fieldBegin, 0);\n            }\n            else {\n                textPosition.movePreviousPosition();\n            }\n            currentIndex = textPosition.getHierarchicalIndexInternal();\n        }\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.paragraphStartInternal = function (selection, moveToPreviousParagraph) {\n        var offset = selection.getStartLineOffset(this.currentWidget);\n        if (this.offset === offset && moveToPreviousParagraph) {\n            var startParagraph = this.moveToNextParagraphInTableCheck();\n            if (startParagraph) {\n                this.moveToPreviousParagraphInTable(selection);\n            }\n            else if (!isNullOrUndefined(selection.getPreviousParagraphBlock(this.currentWidget.paragraph))) {\n                var paragraphValue = selection.getPreviousParagraphBlock(this.currentWidget.paragraph);\n                this.currentWidget = paragraphValue.childWidgets[0];\n                this.offset = selection.getStartLineOffset(this.currentWidget);\n            }\n        }\n        else {\n            this.currentWidget = this.currentWidget.paragraph.getSplitWidgets()[0].childWidgets[0];\n            this.offset = offset;\n        }\n        this.calculateOffset();\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.calculateOffset = function () {\n        var selectionStartIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        if (selectionStartIndex !== selectionEndIndex) {\n            this.validateBackwardFieldSelection(selectionStartIndex, selectionEndIndex);\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Moves the text position to start of the paragraph.\n     * @private\n     */\n    TextPosition.prototype.moveToParagraphStartInternal = function (selection, moveToPreviousParagraph) {\n        var startOffset = selection.getStartOffset(this.paragraph);\n        if (this.offset === startOffset && moveToPreviousParagraph) {\n            var paragraphstart = this.moveToNextParagraphInTableCheck();\n            if (paragraphstart) {\n                this.moveToPreviousParagraphInTable(selection);\n            }\n            else if (!isNullOrUndefined(selection.getPreviousParagraphBlock(this.paragraph))) {\n                this.currentWidget = selection.getPreviousParagraphBlock(this.paragraph).firstChild;\n                this.offset = selection.getStartOffset(this.paragraph);\n            }\n        }\n        else {\n            this.currentWidget = this.paragraph.firstChild;\n            this.offset = selection.getStartLineOffset(this.currentWidget);\n        }\n        var selectionStartIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        if (selectionStartIndex !== selectionEndIndex) {\n            this.validateBackwardFieldSelection(selectionStartIndex, selectionEndIndex);\n        }\n        this.updatePhysicalPosition(false);\n    };\n    /**\n     * Moves the text position to end of the paragraph.\n     * @private\n     */\n    TextPosition.prototype.moveToParagraphEndInternal = function (selection, moveToNextParagraph) {\n        // tslint:disable-next-line:max-line-length\n        var splittedParagraph = this.currentWidget.paragraph;\n        while (splittedParagraph.nextSplitWidget) {\n            splittedParagraph = splittedParagraph.nextSplitWidget;\n        }\n        this.currentWidget = splittedParagraph.childWidgets[splittedParagraph.childWidgets.length - 1];\n        var endOffset = this.currentWidget.getEndOffset() + 1;\n        if (this.offset === endOffset && moveToNextParagraph) {\n            var paragraphEnd = this.moveToNextParagraphInTableCheck();\n            if (paragraphEnd) {\n                this.moveToNextParagraphInTable();\n            }\n            else if (!isNullOrUndefined(selection.getNextParagraphBlock(this.currentWidget.paragraph))) {\n                var endParagraph = selection.getNextParagraphBlock(this.currentWidget.paragraph);\n                this.currentWidget = endParagraph.childWidgets[endParagraph.childWidgets.length - 1];\n                this.offset = this.currentWidget.getEndOffset() + 1;\n            }\n        }\n        else {\n            this.offset = endOffset;\n        }\n        this.calculateOffset();\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.moveUp = function (selection, left) {\n        var paragraph = this.currentWidget.paragraph;\n        //Moves text position to start of line.\n        this.moveToLineStartInternal(selection, true);\n        //Moves previous line starting.\n        this.movePreviousPosition();\n        var prevLine = undefined;\n        var currentParagraph = this.currentWidget.paragraph;\n        if (paragraph.isInsideTable && paragraph !== currentParagraph && paragraph.associatedCell !== currentParagraph.associatedCell\n            // tslint:disable-next-line:max-line-length\n            && (!isNullOrUndefined(currentParagraph.associatedCell) && (paragraph.associatedCell.ownerRow === currentParagraph.associatedCell.ownerRow))) {\n            var ownerRow = currentParagraph.associatedCell.ownerRow;\n            if (ownerRow.previousRenderedWidget instanceof TableRowWidget) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getFirstCellInRegion(ownerRow.previousRenderedWidget, currentParagraph.associatedCell, left, true);\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n            }\n            else {\n                var prevBlock = ownerRow.ownerTable.previousRenderedWidget;\n                do {\n                    if (prevBlock instanceof TableWidget) {\n                        prevBlock = selection.getLastBlockInLastCell(prevBlock);\n                    }\n                } while (prevBlock instanceof TableWidget);\n                if (prevBlock instanceof ParagraphWidget) {\n                    this.setPosition(prevBlock.childWidgets[prevBlock.childWidgets.length - 1], false);\n                }\n            }\n            prevLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        else {\n            if (!paragraph.isInsideTable && this.currentWidget.paragraph.isInsideTable) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getFirstCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, true);\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (paragraph.isInsideTable && (!isNullOrUndefined(this.currentWidget.paragraph.associatedCell) && paragraph.associatedCell.ownerRow.previousRenderedWidget !== paragraph.associatedCell.ownerRow.previousSplitWidget &&\n                paragraph.associatedCell.ownerRow.previousRenderedWidget === this.currentWidget.paragraph.associatedCell.ownerRow)) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, true);\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n            }\n            prevLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        //Moves till the Up/Down selection width.\n        var top = selection.getTop(prevLine);\n        selection.updateTextPositionWidget(prevLine, new Point(left, top), this, false);\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.moveDown = function (selection, left) {\n        //Moves text position to end of line.\n        var prevParagraph = this.currentWidget.paragraph;\n        var prevOffset = this.offset;\n        this.moveToLineEndInternal(selection, true);\n        var length = this.selection.getParagraphLength(this.currentWidget.paragraph);\n        if (this.offset > length) {\n            this.offset = length;\n        }\n        //Moves next line starting.\n        this.moveNextPosition();\n        var nextLine = undefined;\n        // tslint:disable-next-line:max-line-length\n        if (prevParagraph.isInsideTable && prevParagraph !== this.currentWidget.paragraph && prevParagraph.associatedCell !== this.currentWidget.paragraph.associatedCell && (!isNullOrUndefined(this.currentWidget.paragraph.associatedCell) && prevParagraph.associatedCell.ownerRow === this.currentWidget.paragraph.associatedCell.ownerRow)) {\n            var ownerRow = this.currentWidget.paragraph.associatedCell.ownerRow;\n            // tslint:disable-next-line:max-line-length\n            if (prevParagraph.isInsideTable && this.currentWidget.paragraph.isInsideTable && prevParagraph.associatedCell.cellFormat.rowSpan > 1 && prevParagraph.associatedCell.cellFormat.rowSpan + prevParagraph.associatedCell.ownerRow.rowIndex === prevParagraph.associatedCell.ownerTable.childWidgets.length) {\n                //If the prevParagraph  owner cell is Verically merged upto the last row, then theposition moved to next column. the position moved to out of the current tabel so owner row is assigned to last row.\n                // tslint:disable-next-line:max-line-length\n                ownerRow = this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets[this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets.length - 1];\n            }\n            if (ownerRow.nextRenderedWidget instanceof TableRowWidget) {\n                // tslint:disable-next-line:max-line-length\n                var cell = this.selection.getLastCellInRegion(ownerRow.nextRenderedWidget, this.currentWidget.paragraph.associatedCell, left, false);\n                this.setPosition(this.selection.getFirstParagraph(cell).childWidgets[0], true);\n            }\n            else {\n                var nextBlock = this.selection.getNextRenderedBlock(ownerRow.ownerTable);\n                do {\n                    if (nextBlock instanceof TableWidget) {\n                        nextBlock = this.selection.getFirstBlockInFirstCell(nextBlock);\n                    }\n                } while (nextBlock instanceof TableWidget);\n                if (nextBlock instanceof ParagraphWidget) {\n                    this.setPosition(nextBlock.childWidgets[0], true);\n                }\n            }\n            nextLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        else {\n            if (!prevParagraph.isInsideTable && this.currentWidget.paragraph.isInsideTable) {\n                // tslint:disable-next-line:max-line-length\n                var cell = this.selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, false);\n                this.setPosition(this.selection.getFirstParagraph(cell).childWidgets[0], true);\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (prevParagraph.isInsideTable && (!isNullOrUndefined(this.currentWidget.paragraph.associatedCell) && prevParagraph.associatedCell.ownerRow.nextRenderedWidget !== prevParagraph.associatedCell.ownerRow.nextSplitWidget\n                && prevParagraph.associatedCell.ownerRow.nextRenderedWidget === this.currentWidget.paragraph.associatedCell.ownerRow)) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, true);\n                this.setPosition(selection.getFirstParagraph(cell).childWidgets[0], false);\n            }\n            nextLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        //Moves till the Up/Down selection width.\n        var top = this.selection.getTop(nextLine);\n        this.selection.updateTextPositionWidget(nextLine, new Point(left, top), this, false);\n    };\n    /**\n     * Moves the text position to start of the line.\n     * @private\n     */\n    TextPosition.prototype.moveToLineStartInternal = function (selection, moveToPreviousLine) {\n        if (this.location.x > this.viewer.clientActiveArea.right) {\n            this.offset = this.offset - 1;\n        }\n        var currentLine = selection.getLineWidgetInternal(this.currentWidget, this.offset, moveToPreviousLine);\n        var firstElement;\n        var isParaBidi = this.currentWidget.paragraph.paragraphFormat.bidi;\n        if (isParaBidi && currentLine.children.length > 0 && this.containsRtlText(currentLine)) {\n            firstElement = currentLine.children[currentLine.children.length - 1];\n            if (firstElement instanceof ListTextElementBox) {\n                firstElement = undefined;\n            }\n        }\n        else {\n            firstElement = selection.getFirstElementInternal(currentLine);\n        }\n        this.viewer.moveCaretPosition = 1;\n        var startOffset = selection.getStartOffset(this.currentWidget.paragraph);\n        if (isNullOrUndefined(firstElement) && this.offset > startOffset) {\n            var index = 0;\n            var inlineObj = this.currentWidget.getInline(this.offset, index);\n            var inline = inlineObj.element;\n            index = inlineObj.index;\n            if (inline instanceof TextElementBox && inline.text !== '\\v') {\n                this.offset = startOffset;\n            }\n        }\n        else if (!isNullOrUndefined(firstElement)) {\n            var indexInInline = selection.getIndexInInline(firstElement);\n            this.currentWidget = firstElement.line;\n            this.offset = this.currentWidget.getOffset(firstElement, indexInInline);\n            indexInInline = 0;\n            var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (inline instanceof FieldElementBox) {\n                //Checks if field character is part of rendered field, otherwise moves to previous rendered content.\n                var prevInline = selection.getPreviousValidElement(inline);\n                if (!isNullOrUndefined(prevInline)) {\n                    inline = prevInline;\n                    this.currentWidget = inline.line;\n                    this.offset = this.currentWidget.getOffset(inline, inline.length);\n                    if (inline instanceof FieldElementBox) {\n                        this.offset--;\n                    }\n                }\n            }\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Check paragraph is inside table\n     * @private\n     */\n    TextPosition.prototype.moveToNextParagraphInTableCheck = function () {\n        if ((this.selection.start.paragraph.isInsideTable || this.paragraph.isInsideTable)\n            && (this.selection.start.paragraph.associatedCell !== this.paragraph.associatedCell\n                || this.selection.isCellSelected(this.selection.start.paragraph.associatedCell, this.selection.start, this))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Moves the text position to end of the word.\n     * @private\n     */\n    TextPosition.prototype.moveToWordEndInternal = function (type, excludeSpace) {\n        // type === 0 -------->CTRL+ARROW Navigation\n        // type === 1 -------->CTRL+SHIFT+ARROW Selection\n        // type === 2 -------->Double-tap Word Selection\n        var incrementValue = 0;\n        var endOffset = this.currentWidget.getEndOffset();\n        if (this.selection.isParagraphFirstLine(this.currentWidget)) {\n            if (this.currentWidget.children[0] instanceof ListTextElementBox) {\n                incrementValue = 1;\n            }\n            if (this.currentWidget.children[1] instanceof ListTextElementBox) {\n                incrementValue = 2;\n            }\n        }\n        if (this.offset + incrementValue === endOffset || this.offset === endOffset + 1) {\n            if (this.offset === endOffset && type !== 0) {\n                this.setPositionParagraph(this.currentWidget, endOffset + 1);\n            }\n            else {\n                var nextParagraph = this.selection.getNextParagraphBlock(this.currentWidget.paragraph);\n                if (isNullOrUndefined(nextParagraph)) {\n                    return;\n                }\n                this.currentWidget = nextParagraph.childWidgets[0];\n                this.offset = this.selection.getStartLineOffset(this.currentWidget);\n                if (type === 1) {\n                    // tslint:disable-next-line:max-line-length\n                    var nextWord = this.moveToNextParagraphInTableCheck();\n                    if (nextWord) {\n                        this.moveToNextParagraphInTable();\n                    }\n                    else {\n                        this.moveToWordEndInternal(type, excludeSpace);\n                    }\n                }\n            }\n        }\n        else {\n            var indexInInline = 0;\n            var endSelection = false;\n            var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            this.getNextWordOffset(inline, indexInInline, type, false, endSelection, this, excludeSpace);\n        }\n        if (type !== 0) {\n            var selectionStartIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n            var selectionEndIndex = this.getHierarchicalIndexInternal();\n            if (selectionStartIndex !== selectionEndIndex) {\n                this.validateForwardFieldSelection(selectionStartIndex, selectionEndIndex);\n            }\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * move text position to next paragraph inside table\n     * @private\n     */\n    TextPosition.prototype.moveToNextParagraphInTable = function () {\n        var paragraph = this.currentWidget.paragraph;\n        var nextParagraph = (paragraph.isInsideTable) ? this.selection.getNextSelectionCell(paragraph.associatedCell) :\n            this.selection.getNextParagraphBlock(paragraph);\n        if (isNullOrUndefined(nextParagraph)) {\n            return;\n        }\n        this.currentWidget = nextParagraph.childWidgets[nextParagraph.childWidgets.length - 1];\n        this.offset = this.currentWidget.getEndOffset() + 1;\n    };\n    /**\n     * Moves the text position to start of the previous paragraph.\n     */\n    TextPosition.prototype.moveToPreviousParagraph = function (selection) {\n        var startOffset = selection.getStartOffset(this.currentWidget.paragraph);\n        // tslint:disable-next-line:max-line-length\n        if (this.offset === startOffset && !isNullOrUndefined(selection.getPreviousParagraphBlock(this.currentWidget.paragraph))) {\n            var previousParagraph = selection.getPreviousParagraphBlock(this.currentWidget.paragraph);\n            this.currentWidget = previousParagraph.childWidgets[0];\n            this.offset = selection.getStartOffset(this.currentWidget.paragraph);\n        }\n        else {\n            this.offset = selection.getStartOffset(this.currentWidget.paragraph);\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Move to previous line from current position\n     * @private\n     */\n    TextPosition.prototype.moveToPreviousLine = function (selection, left) {\n        var currentIndex = this.getHierarchicalIndexInternal();\n        var currentLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        //Moves text position to start of line.\n        this.moveToLineStartInternal(selection, true);\n        if (this.currentWidget.paragraph.isInsideTable) {\n            this.moveUpInTable(selection);\n        }\n        else {\n            this.moveBackward();\n        }\n        var prevLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var lineStart = selection.getLeft(prevLine);\n        var lineWidth = selection.getWidth(prevLine, true);\n        //Moves till the Up/Down selection width.\n        if (lineWidth + lineStart >= left && currentLine !== prevLine) {\n            var top_1 = selection.getTop(prevLine);\n            var point = new Point(left, top_1);\n            selection.updateTextPositionWidget(prevLine, point, this, true);\n        }\n        //Checks if the current position is between field result, then move to field begin.\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        this.validateBackwardFieldSelection(currentIndex, selectionEndIndex);\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.moveToLineEndInternal = function (selection, moveToNextLine) {\n        if (this.location.x > this.viewer.clientActiveArea.right) {\n            this.offset = this.offset - 1;\n        }\n        var currentLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var firstElement = selection.getFirstElementInternal(currentLine);\n        var isParaBidi = this.currentWidget.paragraph.paragraphFormat.bidi;\n        this.viewer.moveCaretPosition = 2;\n        if (isNullOrUndefined(firstElement) && this.offset === selection.getStartLineOffset(this.currentWidget)) {\n            this.offset = selection.getParagraphLength(this.paragraph) + 1;\n            this.updatePhysicalPosition(true);\n        }\n        else if (!isNullOrUndefined(firstElement)) {\n            var lastElement = void 0;\n            // As per Microsoft Behavior, when current para is RTL and if line widget contains rtl text or mixed inlines(rtl, normal),\n            // then need to consider the last element and to update offset to last element\n            if (isParaBidi && this.containsRtlText(currentLine)) {\n                lastElement = firstElement;\n            }\n            else {\n                lastElement = currentLine.children[currentLine.children.length - 1];\n                if (lastElement instanceof ListTextElementBox && currentLine.children.length > 2) {\n                    lastElement = currentLine.children[currentLine.children.length - 3];\n                }\n            }\n            var index = 0;\n            index += lastElement instanceof TextElementBox ? lastElement.length : 1;\n            this.currentWidget = lastElement.line;\n            if (index === lastElement.length\n                && isNullOrUndefined(lastElement.nextNode) && selection.isParagraphLastLine(this.currentWidget)) {\n                var length_1 = selection.getLineLength(this.currentWidget);\n                this.offset = moveToNextLine ? length_1 + 1 : length_1;\n            }\n            else {\n                var inline = lastElement;\n                while (!isNullOrUndefined(inline) && inline.length === index && inline.nextNode instanceof FieldElementBox) {\n                    var nextInline = selection.getNextValidElement(inline.nextNode);\n                    if (inline !== nextInline) {\n                        inline = nextInline;\n                        index = 0;\n                    }\n                    if (inline instanceof FieldElementBox && inline.fieldType === 0\n                        && !isNullOrUndefined(inline.fieldEnd)) {\n                        var fieldBegin = inline;\n                        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                            inline = fieldBegin.fieldEnd;\n                        }\n                        else {\n                            inline = fieldBegin.fieldSeparator;\n                            this.currentWidget = inline.line;\n                            if (this.currentWidget === fieldBegin.fieldEnd.line\n                                && !selection.hasValidInline(this.currentWidget.paragraph, inline, fieldBegin.fieldEnd)) {\n                                inline = fieldBegin.fieldEnd;\n                            }\n                        }\n                        this.currentWidget = inline.line;\n                    }\n                    if (inline instanceof FieldElementBox) {\n                        index = 1;\n                    }\n                }\n                if (index === inline.length && isNullOrUndefined(inline.nextNode)) {\n                    index++;\n                }\n                if (!moveToNextLine && inline instanceof ElementBox && inline.text === '\\v') {\n                    index--;\n                }\n                this.offset = this.currentWidget.getOffset(inline, index);\n            }\n            this.updatePhysicalPosition(moveToNextLine);\n        }\n    };\n    /**\n     * Move to next line\n     * @private\n     */\n    TextPosition.prototype.moveToNextLine = function (left) {\n        var selection = this.selection;\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionInternal(this);\n        var currentIndex = this.getHierarchicalIndexInternal();\n        var currentLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var isAtLineStart = this.offset === 0 ? true : false;\n        //Moves text position to end of line.\n        this.moveToLineEndInternal(selection, true);\n        var isMoveToLineEnd = !textPosition.isAtSamePosition(this);\n        textPosition.setPositionInternal(this);\n        if (this.currentWidget.paragraph.isInsideTable) {\n            this.moveDownInTable(selection);\n        }\n        else {\n            this.moveNextPosition();\n            this.moveForward();\n        }\n        var nextLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var lineStart = selection.getLeft(nextLine);\n        var firstElement = selection.getFirstElementInternal(nextLine);\n        // tslint:disable-next-line:max-line-length\n        var firstItemWidth = isNullOrUndefined(firstElement) ? selection.getWidth(nextLine, true) : selection.getLeftInternal(nextLine, firstElement, 1) - lineStart;\n        //Moves till the Up/Down selection width.\n        if (lineStart < left && (firstItemWidth / 2 < left - lineStart)) {\n            var top_2 = selection.getTop(nextLine);\n            var point = new Point(left, top_2);\n            selection.updateTextPositionWidget(nextLine, point, this, true);\n            var width = selection.getWidth(nextLine, true);\n            if (width < left - lineStart) {\n                this.moveToLineEndInternal(selection, true);\n            }\n        }\n        else if (isMoveToLineEnd && this.currentWidget.paragraph.isInsideTable\n            && this.currentWidget === this.owner.selection.start.currentWidget) {\n            this.setPositionInternal(textPosition);\n        }\n        else if (!isMoveToLineEnd) {\n            this.moveToLineEndInternal(selection, true);\n        }\n        //Checks if the current position is between field result, then move to field end.\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        this.validateForwardFieldSelection(currentIndex, selectionEndIndex);\n    };\n    /**\n     * Move upward in table\n     * @private\n     */\n    TextPosition.prototype.moveUpInTable = function (selection) {\n        var isPositionUpdated = false;\n        var end = this.owner.selection.end;\n        var isBackwardSelection = !this.owner.selection.isEmpty;\n        isPositionUpdated = end.paragraph.isInsideTable;\n        if (isPositionUpdated) {\n            var startCell = this.currentWidget.paragraph.associatedCell;\n            var endCell = end.paragraph.associatedCell;\n            var containerCell = selection.getContainerCellOf(endCell, startCell);\n            isPositionUpdated = containerCell.ownerTable.contains(startCell);\n            if (isPositionUpdated) {\n                endCell = selection.getSelectedCell(endCell, containerCell);\n                startCell = selection.getSelectedCell(startCell, containerCell);\n                // tslint:disable-next-line:max-line-length\n                var isInContainerCell = selection.containsCell(containerCell, this.currentWidget.paragraph.associatedCell);\n                var isContainerCellSelected = selection.isCellSelected(containerCell, this, end);\n                if (!isContainerCellSelected) {\n                    // tslint:disable-next-line:max-line-length\n                    isContainerCellSelected = this.currentWidget.paragraph === selection.getFirstParagraph(containerCell) && this.isAtParagraphStart;\n                }\n                if ((isInContainerCell && isContainerCellSelected\n                    || !isInContainerCell) && !isNullOrUndefined(startCell.ownerRow.previousRenderedWidget)) {\n                    //Moves to cell in previous row.\n                    var row = startCell.ownerRow.previousRenderedWidget;\n                    // tslint:disable-next-line:max-line-length\n                    var cell = selection.getFirstCellInRegion(row, containerCell, this.owner.selection.upDownSelectionLength, true);\n                    var previousParagraph = selection.getLastParagraph(cell);\n                    this.setPosition(previousParagraph.childWidgets[0], true);\n                    return;\n                }\n                else if (isInContainerCell && isContainerCellSelected\n                    && isNullOrUndefined(startCell.ownerRow.previousRenderedWidget) || !isInContainerCell) {\n                    if (isBackwardSelection) {\n                        //Moves to first cell of row.\n                        startCell = startCell.ownerRow.childWidgets[0];\n                        var previousParagraph = selection.getFirstParagraph(startCell);\n                        this.setPosition(previousParagraph.childWidgets[0], true);\n                    }\n                    else {\n                        //Moves to last cell of row.\n                        startCell = startCell.ownerRow.childWidgets[startCell.ownerRow.childWidgets.length - 1];\n                        var previousParagraph = selection.getLastParagraph(startCell);\n                        this.setPosition(previousParagraph.childWidgets[0], false);\n                    }\n                }\n            }\n        }\n        if (!isPositionUpdated) {\n            //Moves to previous row / previous block.\n            var cell = selection.getContainerCell(this.currentWidget.paragraph.associatedCell);\n            if (isBackwardSelection) {\n                //Moves to first cell of row.\n                cell = cell.ownerRow.childWidgets[0];\n                var previousParagraph = selection.getFirstParagraph(cell);\n                this.setPosition(previousParagraph.childWidgets[0], true);\n            }\n            else {\n                //Moves to end of row.\n                cell = cell.ownerRow.childWidgets[cell.ownerRow.childWidgets.length - 1];\n                var previousParagraph = selection.getLastParagraph(cell);\n                this.setPosition(previousParagraph.childWidgets[0], false);\n            }\n        }\n        //Moves to previous row / previous block.\n        this.moveBackward();\n    };\n    /**\n     * Move down inside table\n     * @private\n     */\n    TextPosition.prototype.moveDownInTable = function (selection) {\n        var isPositionUpdated = false;\n        var isForwardSelection = this.owner.selection.isEmpty || this.owner.selection.isForward;\n        isPositionUpdated = this.owner.selection.start.paragraph.isInsideTable;\n        if (isPositionUpdated) {\n            var startCell = this.owner.selection.start.paragraph.associatedCell;\n            var endCell = this.currentWidget.paragraph.associatedCell;\n            var containerCell = selection.getContainerCellOf(startCell, endCell);\n            isPositionUpdated = containerCell.ownerTable.contains(endCell);\n            if (isPositionUpdated) {\n                startCell = selection.getSelectedCell(startCell, containerCell);\n                endCell = selection.getSelectedCell(endCell, containerCell);\n                // tslint:disable-next-line:max-line-length\n                var isInContainerCell = selection.containsCell(containerCell, this.currentWidget.paragraph.associatedCell);\n                var isContainerCellSelected = selection.isCellSelected(containerCell, this.owner.selection.start, this);\n                if ((isInContainerCell && isContainerCellSelected\n                    || !isInContainerCell) && !isNullOrUndefined(endCell.ownerRow.nextRenderedWidget)) {\n                    //Moves to cell in next row.\n                    var row = endCell.ownerRow.nextRenderedWidget;\n                    // tslint:disable-next-line:max-line-length\n                    var cell = selection.getLastCellInRegion(row, containerCell, this.owner.selection.upDownSelectionLength, false);\n                    var lastParagraph = selection.getLastParagraph(cell);\n                    this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n                    return;\n                }\n                else if (isInContainerCell && isContainerCellSelected\n                    && isNullOrUndefined(endCell.ownerRow.nextRenderedWidget) || !isInContainerCell) {\n                    if (isForwardSelection) {\n                        //Moves to last cell of row.\n                        endCell = endCell.ownerRow.childWidgets[endCell.ownerRow.childWidgets.length - 1];\n                        var lastParagraph = selection.getLastParagraph(endCell);\n                        this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n                    }\n                    else {\n                        //Moves to first cell of row.\n                        endCell = endCell.ownerRow.childWidgets[0];\n                        var lastParagraph = selection.getFirstParagraph(endCell);\n                        this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], true);\n                    }\n                }\n            }\n        }\n        if (!isPositionUpdated) {\n            //Moves to next row / next block.\n            var cell = selection.getContainerCell(this.currentWidget.paragraph.associatedCell);\n            if (isForwardSelection) {\n                //Moves to end of row.\n                cell = cell.ownerRow.childWidgets[cell.ownerRow.childWidgets.length - 1];\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n            }\n            else if (cell.ownerRow.nextRenderedWidget) {\n                //Moves to first cell of row.\n                cell = cell.ownerRow.nextRenderedWidget.childWidgets[0];\n                var lastParagraph = selection.getFirstParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], true);\n            }\n        }\n        //Moves to next row / next block.\n        this.moveForward();\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.destroy = function () {\n        this.offset = undefined;\n        this.isUpdateLocation = undefined;\n        if (!isNullOrUndefined(this.location)) {\n            this.location.destroy();\n        }\n        this.location = undefined;\n        this.currentWidget = undefined;\n        this.owner = undefined;\n        this.viewer = undefined;\n    };\n    return TextPosition;\n}());\nexport { TextPosition };\n/**\n * @private\n */\nvar SelectionWidgetInfo = /** @class */ (function () {\n    function SelectionWidgetInfo(left, width) {\n        this.leftIn = 0;\n        this.widthIn = 0;\n        this.leftIn = left;\n        this.widthIn = width;\n    }\n    Object.defineProperty(SelectionWidgetInfo.prototype, \"left\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.leftIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.leftIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionWidgetInfo.prototype, \"width\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.widthIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.widthIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    SelectionWidgetInfo.prototype.destroy = function () {\n        this.widthIn = undefined;\n        this.leftIn = undefined;\n    };\n    return SelectionWidgetInfo;\n}());\nexport { SelectionWidgetInfo };\n/**\n * @private\n */\nvar Hyperlink = /** @class */ (function () {\n    function Hyperlink(fieldBeginAdv, selection) {\n        this.linkInternal = '';\n        this.localRef = '';\n        this.opensNewWindow = false;\n        var fieldCode = selection.getFieldCode(fieldBeginAdv);\n        var lowercase = fieldCode.toLowerCase();\n        if (lowercase.substring(0, 9) === 'hyperlink') {\n            this.parseFieldValues(fieldCode.substring(9).trim(), selection);\n        }\n    }\n    Object.defineProperty(Hyperlink.prototype, \"navigationLink\", {\n        /**\n         * Gets navigation link.\n         * @returns string\n         * @private\n         */\n        get: function () {\n            return this.linkInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Hyperlink.prototype, \"localReference\", {\n        /**\n         * Gets the local reference if any.\n         * @returns string\n         * @private\n         */\n        get: function () {\n            return this.localRef;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Hyperlink.prototype, \"linkType\", {\n        /**\n         * Gets hyper link type.\n         * @returns HyperLinkType\n         * @private\n         */\n        get: function () {\n            return this.typeInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Parse field values\n     * @param  {string} value\n     * @returns Void\n     */\n    Hyperlink.prototype.parseFieldValues = function (value, selection) {\n        var codes = value.split(' ');\n        var isLocalRef = false;\n        for (var i = 0; i < codes.length; i++) {\n            var code = codes[i];\n            if (code.length < 1) {\n                continue;\n            }\n            if (code === '\\\\t' || code === '\\\\l') {\n                isLocalRef = true;\n            }\n            else if (code === '\\\\n') {\n                this.opensNewWindow = true;\n            }\n            else {\n                code = this.parseFieldValue(code, code[0] === '\\\"' ? '\\\"' : undefined);\n                if (isLocalRef) {\n                    this.localRef = code;\n                    isLocalRef = false;\n                }\n                else {\n                    this.linkInternal = code;\n                }\n            }\n        }\n        this.setLinkType();\n    };\n    Hyperlink.prototype.parseFieldValue = function (value, endChar) {\n        value = value.substring(1);\n        var endIndex = endChar ? value.indexOf(endChar) : -1;\n        if (endIndex < 0) {\n            endIndex = value.length;\n        }\n        return value.substring(0, endIndex).trim();\n    };\n    Hyperlink.prototype.setLinkType = function () {\n        // If only local reference.\n        if (isNullOrUndefined(this.linkInternal) || this.linkInternal.length < 1) {\n            this.typeInternal = 'Bookmark';\n            return;\n        }\n        // Validates link.\n        if (this.linkInternal.substring(0, 4) === ('www.')) {\n            this.linkInternal = 'http://' + this.navigationLink;\n        }\n        else if (this.linkInternal[0] === '@') {\n            this.linkInternal = 'mailto:' + this.navigationLink;\n        }\n        // Finds proper link type.\n        if (this.linkInternal.substring(0, 7) === 'http://'\n            || this.linkInternal.substring(0, 8) === 'https://') {\n            this.typeInternal = 'WebPage';\n        }\n        else if (this.linkInternal.substring(0, 7) === 'mailto:') {\n            this.typeInternal = 'Email';\n        }\n        else {\n            this.typeInternal = 'File';\n        }\n    };\n    /**\n     * @private\n     */\n    Hyperlink.prototype.destroy = function () {\n        this.linkInternal = undefined;\n        this.localRef = undefined;\n        this.typeInternal = undefined;\n        this.opensNewWindow = undefined;\n    };\n    return Hyperlink;\n}());\nexport { Hyperlink };\n/**\n * @private\n */\nvar ImageFormat = /** @class */ (function () {\n    /**\n     * Constructor for image format class\n     * @param imageContainer - Specifies for image width and height values.\n     */\n    function ImageFormat(imageContainer) {\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        this.width = imageContainer.width;\n        this.height = imageContainer.height;\n    }\n    /**\n     * Dispose the internal objects which are maintained.\n     * @private\n     */\n    ImageFormat.prototype.destroy = function () {\n        this.width = undefined;\n        this.height = undefined;\n    };\n    return ImageFormat;\n}());\nexport { ImageFormat };\n","import { Widget, BodyWidget, TableRowWidget, TableWidget, LineWidget, TextElementBox, ListTextElementBox, ImageElementBox, ParagraphWidget, TableCellWidget, FieldElementBox, BlockWidget, HeaderFooterWidget, BlockContainer, BookmarkElementBox, ElementBox } from '../viewer/page';\nimport { HelperMethods, Point } from '../editor/editor-helper';\nimport { SelectionCharacterFormat, SelectionCellFormat, SelectionParagraphFormat, SelectionRowFormat, SelectionSectionFormat, SelectionTableFormat, SelectionImageFormat } from './selection-format';\nimport { isNullOrUndefined, createElement, L10n } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WCharacterFormat, WParagraphFormat, WParagraphStyle } from '../index';\nimport { HtmlExport } from '../writer/html-export';\nimport { Popup } from '@syncfusion/ej2-popups';\nimport { TextPosition, SelectionWidgetInfo, Hyperlink } from './selection-helper';\n/**\n * Selection\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function Selection(documentEditor) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.upDownSelectionLength = 0;\n        /**\n         * @private\n         */\n        this.isSkipLayouting = false;\n        /**\n         * @private\n         */\n        this.isImageSelected = false;\n        this.contextTypeInternal = undefined;\n        /**\n         * @private\n         */\n        this.caret = undefined;\n        //Format Retrieval Field\n        /**\n         * @private\n         */\n        this.isRetrieveFormatting = false;\n        /**\n         * @private\n         */\n        this.skipFormatRetrieval = false;\n        this.isMoveDownOrMoveUp = false;\n        /**\n         * @private\n         */\n        this.selectedWidgets = undefined;\n        /**\n         * Hides caret.\n         * @private\n         */\n        this.hideCaret = function () {\n            _this.caret.style.display = 'none';\n        };\n        this.owner = documentEditor;\n        this.viewer = this.owner.viewer;\n        this.start = new TextPosition(this.owner);\n        this.end = new TextPosition(this.owner);\n        this.selectedWidgets = new Dictionary();\n        this.characterFormatIn = new SelectionCharacterFormat(this);\n        this.paragraphFormatIn = new SelectionParagraphFormat(this, this.viewer);\n        this.sectionFormatIn = new SelectionSectionFormat(this);\n        this.rowFormatIn = new SelectionRowFormat(this);\n        this.cellFormatIn = new SelectionCellFormat(this);\n        this.tableFormatIn = new SelectionTableFormat(this);\n        this.imageFormatInternal = new SelectionImageFormat(this);\n    }\n    Object.defineProperty(Selection.prototype, \"htmlWriter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.htmlWriterIn)) {\n                this.htmlWriterIn = new HtmlExport();\n            }\n            return this.htmlWriterIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"start\", {\n        /**\n         * Gets the start text position of last range in the selection\n         * @returns {TextPosition}\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.viewer)) {\n                if (isNullOrUndefined(this.startInternal)) {\n                    this.startInternal = this.owner.documentStart;\n                }\n                return this.startInternal;\n            }\n            return undefined;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.startInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"characterFormat\", {\n        //Format retrieval properties\n        /**\n         * Gets the instance of selection character format.\n         * @default undefined\n         * @return {SelectionCharacterFormat}\n         */\n        get: function () {\n            return this.characterFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"paragraphFormat\", {\n        /**\n         * Gets the instance of selection paragraph format.\n         * @default undefined\n         * @return {SelectionParagraphFormat}\n         */\n        get: function () {\n            return this.paragraphFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"sectionFormat\", {\n        /**\n         * Gets the instance of selection section format.\n         * @default undefined\n         * @return {SelectionSectionFormat}\n         */\n        get: function () {\n            return this.sectionFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"tableFormat\", {\n        /**\n         * Gets the instance of selection table format.\n         * @default undefined\n         * @return {SelectionTableFormat}\n         */\n        get: function () {\n            return this.tableFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"cellFormat\", {\n        /**\n         * Gets the instance of selection cell format.\n         * @default undefined\n         * @return {SelectionCellFormat}\n         */\n        get: function () {\n            return this.cellFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"rowFormat\", {\n        /**\n         * Gets the instance of selection row format.\n         * @default undefined\n         * @returns SelectionRowFormat\n         */\n        get: function () {\n            return this.rowFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"imageFormat\", {\n        /**\n         * Gets the instance of selection image format.\n         * @default undefined\n         * @returns SelectionImageFormat\n         */\n        get: function () {\n            return this.imageFormatInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"end\", {\n        /**\n         * Gets the start text position of selection range.\n         * @private\n         */\n        get: function () {\n            return this.endInternal;\n        },\n        /**\n         * For internal use\n         * @private\n         */\n        set: function (value) {\n            this.endInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"startPage\", {\n        /**\n         * Gets the page number where the selection ends.\n         * @private\n         */\n        get: function () {\n            if (!this.owner.isDocumentLoaded || isNullOrUndefined(this.viewer)\n                || isNullOrUndefined(this.viewer.selectionStartPage)) {\n                return 1;\n            }\n            return this.viewer.pages.indexOf(this.viewer.selectionStartPage) + 1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"endPage\", {\n        /**\n         * Gets the page number where the selection ends.\n         * @private\n         */\n        get: function () {\n            if (!this.owner.isDocumentLoaded || isNullOrUndefined(this.viewer)\n                || isNullOrUndefined(this.viewer.selectionEndPage)) {\n                return 1;\n            }\n            return this.viewer.pages.indexOf(this.viewer.selectionEndPage) + 1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"isForward\", {\n        /**\n         * Determines whether the selection direction is forward or not.\n         * @default false\n         * @returns {boolean}\n         * @private\n         */\n        get: function () {\n            return this.start.isExistBefore(this.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"isEmpty\", {\n        /**\n         * Determines whether the start and end positions are same or not.\n         * @default false\n         * @returns {boolean}\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.start)) {\n                return true;\n            }\n            return this.start.isAtSamePosition(this.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"text\", {\n        /**\n         * Gets the text within selection.\n         * @default ''\n         * @returns {string}\n         */\n        get: function () {\n            return this.getText(false);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"contextType\", {\n        /**\n         * Gets the context type of the selection.\n         */\n        get: function () {\n            return this.contextTypeInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"isCleared\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return isNullOrUndefined(this.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Selection.prototype.getModuleName = function () {\n        return 'Selection';\n    };\n    //Public API\n    /**\n     * Moves the selection to the header of current page.\n     */\n    Selection.prototype.goToHeader = function () {\n        this.owner.enableHeaderAndFooter = true;\n        this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.headerWidget);\n    };\n    /**\n     * Moves the selection to the footer of current page.\n     */\n    Selection.prototype.goToFooter = function () {\n        this.owner.enableHeaderAndFooter = true;\n        this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.footerWidget);\n    };\n    /**\n     * Closes the header and footer region.\n     */\n    Selection.prototype.closeHeaderFooter = function () {\n        this.disableHeaderFooter();\n    };\n    /**\n     * Moves the selection to the start of specified page number.\n     */\n    Selection.prototype.goToPage = function (pageNumber) {\n        if (pageNumber >= 1 && pageNumber <= this.viewer.pages.length) {\n            var page = this.viewer.pages[pageNumber - 1];\n            this.updateTextPositionForBlockContainer(page.bodyWidgets[0]);\n        }\n    };\n    /**\n     * Selects the entire table if the context is within table.\n     */\n    Selection.prototype.selectTable = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectTableInternal();\n    };\n    /**\n     * Selects the entire row if the context is within table.\n     */\n    Selection.prototype.selectRow = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectTableRow();\n    };\n    /**\n     * Selects the entire column if the context is within table.\n     */\n    Selection.prototype.selectColumn = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectColumnInternal();\n    };\n    /**\n     * Selects the entire cell if the context is within table.\n     */\n    Selection.prototype.selectCell = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectTableCell();\n    };\n    /**\n     * Select content based on selection settings\n     */\n    Selection.prototype.select = function (selectionSettings) {\n        var point = new Point(selectionSettings.x, selectionSettings.y);\n        var pageCoordinates = this.viewer.findFocusedPage(point, true);\n        if (selectionSettings.extend) {\n            this.moveTextPosition(pageCoordinates, this.end);\n        }\n        else {\n            this.viewer.updateTextPositionForSelection(pageCoordinates, 1);\n        }\n    };\n    /**\n     * Toggles the bold property of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleBold = function () {\n        if (this.owner.editorModule) {\n            this.owner.editorModule.toggleBold();\n        }\n    };\n    /**\n     * Toggles the italic property of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleItalic = function () {\n        if (this.owner.editorModule) {\n            this.owner.editorModule.toggleItalic();\n        }\n    };\n    /**\n     * Toggles the underline property of selected contents.\n     * @param underline Default value of ‘underline’ parameter is Single.\n     * @private\n     */\n    Selection.prototype.toggleUnderline = function (underline) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleUnderline(underline);\n        }\n    };\n    /**\n     * Toggles the strike through property of selected contents.\n     * @param {Strikethrough} strikethrough Default value of strikethrough parameter is SingleStrike.\n     * @private\n     */\n    Selection.prototype.toggleStrikethrough = function (strikethrough) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleStrikethrough(strikethrough);\n        }\n    };\n    /**\n     * Toggles the highlight color property of selected contents.\n     * @param {HighlightColor} highlightColor Default value of ‘underline’ parameter is Yellow.\n     * @private\n     */\n    Selection.prototype.toggleHighlightColor = function (highlightColor) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleHighlightColor(highlightColor);\n        }\n    };\n    /**\n     * Toggles the subscript formatting of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleSubscript = function () {\n        if (this.owner.editor) {\n            this.owner.editor.toggleSubscript();\n        }\n    };\n    /**\n     * Toggles the superscript formatting of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleSuperscript = function () {\n        if (this.owner.editor) {\n            this.owner.editor.toggleSuperscript();\n        }\n    };\n    /**\n     * Toggles the text alignment property of selected contents.\n     * @param {TextAlignment} textAlignment Default value of ‘textAlignment parameter is TextAlignment.Left.\n     * @private\n     */\n    Selection.prototype.toggleTextAlignment = function (textAlignment) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleTextAlignment(textAlignment);\n        }\n    };\n    /**\n     * Increases the left indent of selected paragraphs to a factor of 36 points.\n     * @private\n     */\n    Selection.prototype.increaseIndent = function () {\n        if (this.owner.editor) {\n            this.owner.editor.increaseIndent();\n        }\n    };\n    /**\n     * Decreases the left indent of selected paragraphs to a factor of 36 points.\n     * @private\n     */\n    Selection.prototype.decreaseIndent = function () {\n        if (this.owner.editor) {\n            this.owner.editor.decreaseIndent();\n        }\n    };\n    /**\n     * Fires the `requestNavigate` event if current selection context is in hyperlink.\n     */\n    Selection.prototype.navigateHyperlink = function () {\n        var fieldBegin = this.getHyperlinkField();\n        if (fieldBegin) {\n            this.fireRequestNavigate(fieldBegin);\n        }\n    };\n    /**\n     * Navigate Hyperlink\n     * @param fieldBegin\n     * @private\n     */\n    Selection.prototype.fireRequestNavigate = function (fieldBegin) {\n        var hyperlink = new Hyperlink(fieldBegin, this);\n        var eventArgs = {\n            isHandled: false,\n            navigationLink: hyperlink.navigationLink,\n            linkType: hyperlink.linkType,\n            localReference: hyperlink.localReference,\n            source: this.owner\n        };\n        this.owner.trigger('requestNavigate', eventArgs);\n        if (!eventArgs.isHandled) {\n            this.viewer.selection.navigateBookmark(hyperlink.localReference, true);\n        }\n    };\n    /**\n     * Copies the hyperlink URL if the context is within hyperlink.\n     */\n    Selection.prototype.copyHyperlink = function () {\n        var hyperLinkField = this.getHyperlinkField();\n        var linkText = this.getLinkText(hyperLinkField);\n        this.copyToClipboard(linkText);\n    };\n    //Selection add, Highlight, remove API starts\n    /**\n     * @private\n     */\n    Selection.prototype.highlightSelection = function (isSelectionChanged) {\n        if (this.owner.enableImageResizerMode) {\n            this.owner.imageResizerModule.hideImageResizer();\n        }\n        if (this.isEmpty) {\n            this.updateCaretPosition();\n        }\n        else {\n            if (this.isForward) {\n                this.highlightSelectedContent(this.start, this.end);\n            }\n            else {\n                this.highlightSelectedContent(this.end, this.start);\n            }\n            if (this.viewer.isComposingIME) {\n                this.updateCaretPosition();\n            }\n        }\n        this.viewer.updateTouchMarkPosition();\n        if (isSelectionChanged) {\n            this.viewer.scrollToPosition(this.start, this.end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.createHighlightBorder = function (lineWidget, width, left, top, isElementBoxHighlight) {\n        if (width < 0) {\n            width = 0;\n        }\n        var page = this.getPage(lineWidget.paragraph);\n        var height = lineWidget.height;\n        var selectionWidget = undefined;\n        var selectionWidgetCollection = undefined;\n        if (this.selectedWidgets.containsKey(lineWidget)) {\n            if (this.selectedWidgets.get(lineWidget) instanceof SelectionWidgetInfo) {\n                selectionWidget = this.selectedWidgets.get(lineWidget);\n                // if the line element has already added with SelectionWidgetInfo\n                // now its need to be added as ElementBox highlighting them remove it from dictionary and add it collection.\n                if (isElementBoxHighlight) {\n                    this.selectedWidgets.remove(lineWidget);\n                    selectionWidgetCollection = [];\n                    this.selectedWidgets.add(lineWidget, selectionWidgetCollection);\n                }\n            }\n            else {\n                selectionWidgetCollection = this.selectedWidgets.get(lineWidget);\n            }\n        }\n        else {\n            if (isElementBoxHighlight) {\n                selectionWidgetCollection = [];\n                this.selectedWidgets.add(lineWidget, selectionWidgetCollection);\n            }\n            else {\n                selectionWidget = new SelectionWidgetInfo(left, width);\n                this.selectedWidgets.add(lineWidget, selectionWidget);\n            }\n        }\n        if (selectionWidget === undefined) {\n            selectionWidget = new SelectionWidgetInfo(left, width);\n            this.selectedWidgets.add(lineWidget, selectionWidget);\n        }\n        var viewer = this.viewer;\n        var pageTop = this.getPageTop(page);\n        var pageLeft = page.boundingRectangle.x;\n        if (viewer.containerTop <= pageTop\n            || pageTop < viewer.containerTop + viewer.selectionCanvas.height) {\n            var zoomFactor = viewer.zoomFactor;\n            this.clipSelection(page, pageTop);\n            if (this.viewer.isComposingIME) {\n                // tslint:disable-next-line:max-line-length\n                this.renderDashLine(viewer.selectionContext, page, lineWidget, (pageLeft + (left * zoomFactor)) - viewer.containerLeft, top, width * zoomFactor, height);\n            }\n            else {\n                viewer.selectionContext.fillStyle = 'gray';\n                viewer.selectionContext.globalAlpha = 0.4;\n                // tslint:disable-next-line:max-line-length\n                viewer.selectionContext.fillRect((pageLeft + (left * zoomFactor)) - viewer.containerLeft, (pageTop + (top * zoomFactor)) - viewer.containerTop, width * zoomFactor, height * zoomFactor);\n            }\n            viewer.selectionContext.restore();\n        }\n        if (isElementBoxHighlight) {\n            selectionWidgetCollection.push(selectionWidget);\n        }\n    };\n    /**\n     * Create selection highlight inside table\n     * @private\n     */\n    Selection.prototype.createHighlightBorderInsideTable = function (cellWidget) {\n        var page = this.getPage(cellWidget);\n        var selectionWidget = undefined;\n        var left = cellWidget.x - cellWidget.margin.left + cellWidget.leftBorderWidth;\n        var width = cellWidget.width + cellWidget.margin.left\n            + cellWidget.margin.right - cellWidget.leftBorderWidth - cellWidget.rightBorderWidth;\n        var top = cellWidget.y;\n        var height = cellWidget.height;\n        var pageTop = this.getPageTop(page);\n        var pageLeft = page.boundingRectangle.x;\n        var isVisiblePage = this.viewer.containerTop <= pageTop\n            || pageTop < this.viewer.containerTop + this.viewer.selectionCanvas.height;\n        if (this.selectedWidgets.containsKey(cellWidget) && this.selectedWidgets.get(cellWidget) instanceof SelectionWidgetInfo) {\n            selectionWidget = this.selectedWidgets.get(cellWidget);\n            if (isVisiblePage) {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.selectionContext.clearRect((pageLeft + (selectionWidget.left * this.viewer.zoomFactor) - this.viewer.containerLeft), (pageTop + (top * this.viewer.zoomFactor)) - this.viewer.containerTop, selectionWidget.width * this.viewer.zoomFactor, height * this.viewer.zoomFactor);\n            }\n        }\n        else {\n            selectionWidget = new SelectionWidgetInfo(left, width);\n            if (this.selectedWidgets.containsKey(cellWidget)) {\n                this.selectedWidgets.remove(this.selectedWidgets.get(cellWidget));\n            }\n            this.selectedWidgets.add(cellWidget, selectionWidget);\n        }\n        if (isVisiblePage) {\n            this.viewer.selectionContext.fillStyle = 'gray';\n            this.viewer.selectionContext.globalAlpha = 0.4;\n            var zoomFactor = this.viewer.zoomFactor;\n            this.clipSelection(page, pageTop);\n            // tslint:disable-next-line:max-line-length\n            this.viewer.selectionContext.fillRect((pageLeft + (left * zoomFactor)) - this.viewer.containerLeft, (pageTop + (top * zoomFactor)) - this.viewer.containerTop, width * zoomFactor, height * zoomFactor);\n            this.viewer.selectionContext.restore();\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.clipSelection = function (page, pageTop) {\n        var viewer = this.viewer;\n        var width = page.boundingRectangle.width * viewer.zoomFactor;\n        var height = page.boundingRectangle.height * viewer.zoomFactor;\n        var left = page.boundingRectangle.x;\n        viewer.selectionContext.beginPath();\n        viewer.selectionContext.save();\n        viewer.selectionContext.rect(left - viewer.containerLeft, pageTop - viewer.containerTop, width, height);\n        viewer.selectionContext.clip();\n    };\n    /**\n     * Add selection highlight\n     * @private\n     */\n    Selection.prototype.addSelectionHighlight = function (canvasContext, widget, top) {\n        if (this.selectedWidgets.containsKey(widget)) {\n            var height = widget.height;\n            var widgetInfo = this.selectedWidgets.get(widget);\n            var widgetInfoCollection = undefined;\n            if (widgetInfo instanceof SelectionWidgetInfo) {\n                widgetInfoCollection = [];\n                widgetInfoCollection.push(widgetInfo);\n            }\n            else {\n                widgetInfoCollection = widgetInfo;\n            }\n            if (!isNullOrUndefined(widgetInfoCollection)) {\n                for (var i = 0; i < widgetInfoCollection.length; i++) {\n                    var width = this.viewer.render.getScaledValue(widgetInfoCollection[i].width);\n                    var left = this.viewer.render.getScaledValue(widgetInfoCollection[i].left, 1);\n                    var page = this.owner.selection.getPage(widget.paragraph);\n                    this.owner.selection.clipSelection(page, this.owner.selection.getPageTop(page));\n                    if (this.viewer.isComposingIME) {\n                        this.renderDashLine(canvasContext, page, widget, left, top, width, height);\n                    }\n                    else {\n                        height = this.viewer.render.getScaledValue(height);\n                        canvasContext.globalAlpha = 0.4;\n                        canvasContext.fillStyle = 'gray';\n                        canvasContext.fillRect(left, this.viewer.render.getScaledValue(top, 2), width, height);\n                    }\n                    canvasContext.restore();\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.renderDashLine = function (ctx, page, widget, left, top, width, height) {\n        var fontColor = this.characterFormat.fontColor;\n        var fillColor = fontColor ? this.viewer.render.getColor(fontColor) : '#000000';\n        ctx.globalAlpha = 1;\n        // Get character format copied from selection format\n        var format = this.owner.editor.copyInsertFormat(new WCharacterFormat(), false);\n        var heightInfo = this.viewer.textHelper.getHeight(format);\n        var pageTop = this.getPageTop(page);\n        var descent = heightInfo.Height - heightInfo.BaselineOffset;\n        top = this.viewer.render.getUnderlineYPosition(widget) + top + 4 - descent;\n        // tslint:disable-next-line:max-line-length\n        this.viewer.render.renderDashLine(ctx, left, (pageTop - this.viewer.containerTop) + (top * this.viewer.zoomFactor), width, fillColor, true);\n    };\n    /**\n     * Add Selection highlight inside table\n     * @private\n     */\n    Selection.prototype.addSelectionHighlightTable = function (canvasContext, tableCellWidget) {\n        if (this.selectedWidgets.containsKey(tableCellWidget)) {\n            var selectedWidgetInfo = this.selectedWidgets.get(tableCellWidget);\n            var selectedWidgetInfoCollection = undefined;\n            if (selectedWidgetInfo instanceof SelectionWidgetInfo) {\n                selectedWidgetInfoCollection = [];\n                selectedWidgetInfoCollection.push(selectedWidgetInfo);\n            }\n            else {\n                selectedWidgetInfoCollection = selectedWidgetInfo;\n            }\n            if (!isNullOrUndefined(selectedWidgetInfoCollection)) {\n                for (var i = 0; i < selectedWidgetInfoCollection.length; i++) {\n                    var left = this.viewer.render.getScaledValue(selectedWidgetInfoCollection[i].left, 1);\n                    var top_1 = this.viewer.render.getScaledValue(tableCellWidget.y, 2);\n                    var width = this.viewer.render.getScaledValue(selectedWidgetInfoCollection[i].width);\n                    var height = this.viewer.render.getScaledValue(tableCellWidget.height);\n                    canvasContext.fillStyle = 'gray';\n                    var page = this.owner.selection.getPage(tableCellWidget);\n                    this.owner.selection.clipSelection(page, this.owner.selection.getPageTop(page));\n                    canvasContext.fillRect(left, top_1, width, height);\n                    canvasContext.restore();\n                }\n            }\n        }\n    };\n    /**\n     * Remove Selection highlight\n     * @private\n     */\n    Selection.prototype.removeSelectionHighlight = function (widget) {\n        var left = 0;\n        var top = 0;\n        var width = 0;\n        var height = 0;\n        var page = undefined;\n        if (widget instanceof LineWidget) {\n            var lineWidget = widget;\n            var currentParaWidget = lineWidget.paragraph;\n            page = !isNullOrUndefined(currentParaWidget) ?\n                this.getPage((lineWidget.paragraph)) : undefined;\n            if (isNullOrUndefined(page)) {\n                return;\n            }\n            top = this.getTop(lineWidget);\n            height = lineWidget.height;\n        }\n        else if (widget instanceof TableCellWidget) {\n            page = !isNullOrUndefined(widget) ?\n                this.getPage(widget) : undefined;\n            if (isNullOrUndefined(page)) {\n                return;\n            }\n            top = widget.y;\n            height = widget.height;\n        }\n        if (isNullOrUndefined(page)) {\n            return;\n        }\n        var selectedWidget = this.selectedWidgets.get(widget);\n        var selectedWidgetCollection = undefined;\n        if (selectedWidget instanceof SelectionWidgetInfo) {\n            selectedWidgetCollection = [];\n            selectedWidgetCollection.push(selectedWidget);\n        }\n        else {\n            selectedWidgetCollection = selectedWidget;\n        }\n        if (!isNullOrUndefined(selectedWidgetCollection)) {\n            for (var i = 0; i < selectedWidgetCollection.length; i++) {\n                width = selectedWidgetCollection[i].width;\n                left = selectedWidgetCollection[i].left;\n                var pageRect = page.boundingRectangle;\n                var pageIndex = this.viewer.pages.indexOf(page);\n                var pageGap = this.viewer.pageGap;\n                var pageTop = (pageRect.y - pageGap * (pageIndex + 1)) * this.viewer.zoomFactor + pageGap * (pageIndex + 1);\n                var pageLeft = pageRect.x;\n                var zoomFactor = this.viewer.zoomFactor;\n                if (this.viewer.containerTop <= pageTop\n                    || pageTop < this.viewer.containerTop + this.viewer.selectionCanvas.height) {\n                    // tslint:disable-next-line:max-line-length\n                    this.viewer.selectionContext.clearRect((pageLeft + (left * zoomFactor) - this.viewer.containerLeft) - 0.5, (pageTop + (top * zoomFactor)) - this.viewer.containerTop - 0.5, width * zoomFactor + 0.5, height * zoomFactor + 0.5);\n                }\n            }\n        }\n    };\n    /**\n     * Select Current word\n     * @private\n     */\n    Selection.prototype.selectCurrentWord = function () {\n        var startPosition = this.start.clone();\n        var endPosition = this.end.clone();\n        this.selectCurrentWordRange(startPosition, endPosition, false);\n        this.selectRange(startPosition, endPosition);\n    };\n    /**\n     * Select current paragraph\n     * @private\n     */\n    Selection.prototype.selectCurrentParagraph = function () {\n        if (!isNullOrUndefined(this.start)) {\n            this.start.paragraphStartInternal(this, false);\n            this.end.moveToParagraphEndInternal(this, false);\n            this.upDownSelectionLength = this.end.location.x;\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Select current word range\n     * @private\n     */\n    Selection.prototype.selectCurrentWordRange = function (startPosition, endPosition, excludeSpace) {\n        if (!isNullOrUndefined(startPosition)) {\n            if (startPosition.offset > 0) {\n                var wordStart = startPosition.clone();\n                var indexInInline = 0;\n                var inlineObj = startPosition.currentWidget.getInline(startPosition.offset, indexInInline);\n                var inline = inlineObj.element;\n                indexInInline = inlineObj.index;\n                if (!isNullOrUndefined(inline) && inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    // tslint:disable-next-line:max-line-length\n                    if (startPosition.offset > 2 && (!isNullOrUndefined(inline.fieldSeparator) || isNullOrUndefined(inline.fieldBegin))) {\n                        wordStart.setPositionParagraph(wordStart.currentWidget, startPosition.offset - 2);\n                        wordStart.moveToWordEndInternal(0, false);\n                        if (!(wordStart.paragraph === startPosition.paragraph && wordStart.offset === startPosition.offset - 1)) {\n                            startPosition.moveToWordStartInternal(2);\n                        }\n                    }\n                    else if (startPosition.offset > 3 && isNullOrUndefined(inline.fieldSeparator)) {\n                        wordStart.setPositionParagraph(wordStart.currentWidget, startPosition.offset - 3);\n                        wordStart.moveToWordEndInternal(0, false);\n                        if (!(wordStart.paragraph === startPosition.paragraph && wordStart.offset === startPosition.offset)) {\n                            startPosition.moveToWordStartInternal(2);\n                        }\n                    }\n                }\n                else {\n                    wordStart.setPositionParagraph(wordStart.currentWidget, startPosition.offset - 1);\n                    wordStart.moveToWordEndInternal(0, false);\n                    if (!(wordStart.paragraph === startPosition.paragraph && wordStart.offset === startPosition.offset)) {\n                        startPosition.moveToWordStartInternal(2);\n                    }\n                }\n            }\n            endPosition.moveToWordEndInternal(2, excludeSpace);\n        }\n    };\n    /**\n     * Extend selection to paragraph start\n     * @private\n     */\n    Selection.prototype.extendToParagraphStart = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.paragraphStartInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to paragraph end\n     * @private\n     */\n    Selection.prototype.extendToParagraphEnd = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToParagraphEndInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to next text position\n     * @private\n     */\n    Selection.prototype.moveNextPosition = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (this.isEmpty) {\n            this.start.moveNextPosition();\n            this.end.setPositionInternal(this.start);\n        }\n        this.updateForwardSelection();\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to next paragraph\n     * @private\n     */\n    Selection.prototype.moveToNextParagraph = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToNextParagraphStartInternal();\n        this.start.setPositionInternal(this.end);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to previous text position\n     * @private\n     */\n    Selection.prototype.movePreviousPosition = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (this.isEmpty) {\n            this.start.movePreviousPosition();\n            this.end.setPositionInternal(this.start);\n        }\n        this.updateBackwardSelection();\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to previous paragraph\n     * @private\n     */\n    Selection.prototype.moveToPreviousParagraph = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToPreviousParagraph(this);\n        this.start.setPositionInternal(this.end);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to previous line\n     * @private\n     */\n    Selection.prototype.extendToPreviousLine = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToPreviousLine(this, this.upDownSelectionLength);\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to line end\n     * @private\n     */\n    Selection.prototype.extendToLineEnd = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToLineEndInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend to line start\n     * @private\n     */\n    Selection.prototype.extendToLineStart = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToLineStartInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.moveUp = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.end.setPositionInternal(this.start);\n            }\n            else {\n                this.start.setPositionInternal(this.end);\n            }\n            this.upDownSelectionLength = this.start.location.x;\n        }\n        this.upDownSelectionLength = this.start.location.x;\n        this.start.moveUp(this, this.upDownSelectionLength);\n        this.end.setPositionInternal(this.start);\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.moveDown = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.start.setPositionInternal(this.end);\n            }\n            else {\n                this.end.setPositionInternal(this.start);\n            }\n            this.upDownSelectionLength = this.start.location.x;\n        }\n        this.start.moveDown(this, this.upDownSelectionLength);\n        this.end.setPositionInternal(this.start);\n        this.fireSelectionChanged(true);\n    };\n    Selection.prototype.updateForwardSelection = function () {\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.start.setPositionInternal(this.end);\n            }\n            else {\n                this.end.setPositionInternal(this.start);\n            }\n        }\n    };\n    Selection.prototype.updateBackwardSelection = function () {\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.end.setPositionInternal(this.start);\n            }\n            else {\n                this.start.setPositionInternal(this.end);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstBlockInFirstCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var firstrow = table.childWidgets[0];\n            if (firstrow.childWidgets.length > 0) {\n                var firstcell = firstrow.childWidgets[0];\n                if (firstcell.childWidgets.length === 0) {\n                    return undefined;\n                }\n                return firstcell.childWidgets[0];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getFirstCellInRegion = function (row, startCell, selectionLength, isMovePrevious) {\n        var cellStart = this.getCellLeft(row, startCell);\n        var cellEnd = cellStart + startCell.cellFormat.cellWidth;\n        var flag = true;\n        if (cellStart <= selectionLength && selectionLength < cellEnd) {\n            for (var k = 0; k < row.childWidgets.length; k++) {\n                var left = this.getCellLeft(row, row.childWidgets[k]);\n                if (HelperMethods.round(cellStart, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(cellEnd, 2)) {\n                    flag = false;\n                    return row.childWidgets[k];\n                }\n            }\n        }\n        else {\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cellLeft = this.getCellLeft(row, row.childWidgets[j]);\n                if (cellLeft <= selectionLength && cellLeft +\n                    row.childWidgets[j].cellFormat.cellWidth > selectionLength) {\n                    flag = false;\n                    return row.childWidgets[j];\n                }\n            }\n        }\n        if (flag) {\n            if (!isNullOrUndefined(row.previousRenderedWidget) && isMovePrevious) {\n                var previousWidget = row.previousRenderedWidget;\n                return this.getFirstCellInRegion(previousWidget, startCell, selectionLength, isMovePrevious);\n            }\n            else if (!isNullOrUndefined(row.nextRenderedWidget) && !isMovePrevious) {\n                return this.getFirstCellInRegion(row.nextRenderedWidget, startCell, selectionLength, isMovePrevious);\n            }\n        }\n        return row.childWidgets[0];\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstParagraph = function (tableCell) {\n        while (tableCell.previousSplitWidget) {\n            tableCell = tableCell.previousSplitWidget;\n        }\n        var firstBlock = tableCell.firstChild;\n        return this.getFirstParagraphBlock(firstBlock);\n    };\n    /**\n     * Get last block in last cell\n     * @private\n     */\n    //Table\n    Selection.prototype.getLastBlockInLastCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastRow = table.childWidgets[table.childWidgets.length - 1];\n            var lastCell = lastRow.childWidgets[lastRow.childWidgets.length - 1];\n            while (lastCell.childWidgets.length === 0 && !isNullOrUndefined(lastCell.previousSplitWidget)) {\n                lastCell = lastCell.previousSplitWidget;\n            }\n            return lastCell.childWidgets[lastCell.childWidgets.length - 1];\n        }\n        return undefined;\n    };\n    /**\n     * Move to line start\n     * @private\n     */\n    Selection.prototype.moveToLineStart = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.updateBackwardSelection();\n        this.start.moveToLineStartInternal(this, false);\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to line end\n     * @private\n     */\n    Selection.prototype.moveToLineEnd = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.updateForwardSelection();\n        this.start.moveToLineEndInternal(this, false);\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Get Page top\n     * @private\n     */\n    Selection.prototype.getPageTop = function (page) {\n        // tslint:disable-next-line:max-line-length\n        return (page.boundingRectangle.y - this.viewer.pageGap * (this.viewer.pages.indexOf(page) + 1)) * this.viewer.zoomFactor + this.viewer.pageGap * (this.viewer.pages.indexOf(page) + 1);\n    };\n    /**\n     * Move text position to cursor point\n     * @private\n     */\n    Selection.prototype.moveTextPosition = function (cursorPoint, textPosition) {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        //Updates the text position based on the cursor position.\n        var widget = this.viewer.getLineWidgetInternal(cursorPoint, true);\n        if (!isNullOrUndefined(widget)) {\n            this.updateTextPositionWidget(widget, cursorPoint, textPosition, true);\n        }\n        this.upDownSelectionLength = textPosition.location.x;\n        var selectionStartIndex = this.start.getHierarchicalIndexInternal();\n        var selectionEndIndex = this.end.getHierarchicalIndexInternal();\n        if (selectionStartIndex !== selectionEndIndex) {\n            // Extends selection end to field begin or field end.\n            if (TextPosition.isForwardSelection(selectionStartIndex, selectionEndIndex)) {\n                textPosition.validateForwardFieldSelection(selectionStartIndex, selectionEndIndex);\n            }\n            else {\n                textPosition.validateBackwardFieldSelection(selectionStartIndex, selectionEndIndex);\n            }\n        }\n        this.fireSelectionChanged(true);\n    };\n    //Helper Method Implementation \n    //Document\n    /**\n     * Get document start position\n     * @private\n     */\n    Selection.prototype.getDocumentStart = function () {\n        var textPosition = undefined;\n        var block = this.viewer.pages[0].bodyWidgets[0].childWidgets[0];\n        return this.setPositionForBlock(block, true);\n    };\n    /**\n     * Get document end position\n     * @private\n     */\n    Selection.prototype.getDocumentEnd = function () {\n        var textPosition = undefined;\n        var documentStart = this.owner.documentStart;\n        var lastPage = this.viewer.pages[this.viewer.pages.length - 1];\n        if (!isNullOrUndefined(documentStart) && lastPage.bodyWidgets[0].childWidgets.length > 0) {\n            var block = undefined;\n            var section = lastPage.bodyWidgets[0];\n            var blocks = section.childWidgets;\n            var lastBlkItem = blocks.length - 1;\n            var lastBlock = blocks[lastBlkItem];\n            if (lastBlock instanceof BlockWidget) {\n                block = lastBlock;\n            }\n            textPosition = this.setPositionForBlock(block, false);\n        }\n        return textPosition;\n    };\n    //Keyboard shortcut internal API\n    /**\n     * @private\n     * Handles control end key.\n     */\n    Selection.prototype.handleControlEndKey = function () {\n        var documentEnd = undefined;\n        if (!isNullOrUndefined(this.owner.documentEnd)) {\n            documentEnd = this.owner.documentEnd;\n        }\n        if (!isNullOrUndefined(documentEnd)) {\n            this.owner.selection.selectContent(documentEnd, true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control home key.\n     */\n    Selection.prototype.handleControlHomeKey = function () {\n        var documentStart = undefined;\n        if (!isNullOrUndefined(this.owner.documentStart)) {\n            documentStart = this.owner.documentStart;\n        }\n        if (!isNullOrUndefined(documentStart)) {\n            this.owner.selection.selectContent(documentStart, true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control left key.\n     */\n    Selection.prototype.handleControlLeftKey = function () {\n        this.extendToWordStart(true);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control right key.\n     */\n    Selection.prototype.handleControlRightKey = function () {\n        this.extendToWordEnd(true);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control down key.\n     * @private\n     */\n    Selection.prototype.handleControlDownKey = function () {\n        this.moveToNextParagraph();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control up key.\n     * @private\n     */\n    Selection.prototype.handleControlUpKey = function () {\n        this.moveToPreviousParagraph();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles shift left key.\n     */\n    Selection.prototype.handleShiftLeftKey = function () {\n        this.extendBackward();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift up key.\n     * @private\n     */\n    Selection.prototype.handleShiftUpKey = function () {\n        this.extendToPreviousLine();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift right key.\n     * @private\n     */\n    Selection.prototype.handleShiftRightKey = function () {\n        this.extendForward();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift down key.\n     * @private\n     */\n    Selection.prototype.handleShiftDownKey = function () {\n        this.extendToNextLine();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control shift left key.\n     */\n    Selection.prototype.handleControlShiftLeftKey = function () {\n        var isForward = this.isForward ? this.start.isCurrentParaBidi : this.end.isCurrentParaBidi;\n        if (isForward) {\n            this.extendToWordEnd(false);\n        }\n        else {\n            this.extendToWordStart(false);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift up key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftUpKey = function () {\n        this.extendToParagraphStart();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift right key\n     * @private\n     */\n    Selection.prototype.handleControlShiftRightKey = function () {\n        var isForward = this.isForward ? this.start.isCurrentParaBidi : this.end.isCurrentParaBidi;\n        if (isForward) {\n            this.extendToWordStart(false);\n        }\n        else {\n            this.extendToWordEnd(false);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift down key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftDownKey = function () {\n        this.extendToParagraphEnd();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles left key.\n     * @private\n     */\n    Selection.prototype.handleLeftKey = function () {\n        if (this.end.isCurrentParaBidi) {\n            this.moveNextPosition();\n        }\n        else {\n            this.movePreviousPosition();\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles up key.\n     * @private\n     */\n    Selection.prototype.handleUpKey = function () {\n        this.isMoveDownOrMoveUp = true;\n        this.moveUp();\n        this.isMoveDownOrMoveUp = false;\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles right key.\n     * @private\n     */\n    Selection.prototype.handleRightKey = function () {\n        if (this.end.isCurrentParaBidi) {\n            this.movePreviousPosition();\n        }\n        else {\n            this.moveNextPosition();\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles end key.\n     * @private\n     */\n    Selection.prototype.handleEndKey = function () {\n        this.moveToLineEnd();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles home key.\n     * @private\n     */\n    Selection.prototype.handleHomeKey = function () {\n        this.moveToLineStart();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles down key.\n     * @private\n     */\n    Selection.prototype.handleDownKey = function () {\n        this.isMoveDownOrMoveUp = true;\n        this.moveDown();\n        this.isMoveDownOrMoveUp = false;\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift end key.\n     * @private\n     */\n    Selection.prototype.handleShiftEndKey = function () {\n        this.extendToLineEnd();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift home key.\n     * @private\n     */\n    Selection.prototype.handleShiftHomeKey = function () {\n        this.extendToLineStart();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift end key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftEndKey = function () {\n        var documentEnd = undefined;\n        if (!isNullOrUndefined(this.owner.documentEnd)) {\n            documentEnd = this.owner.documentEnd;\n        }\n        if (!isNullOrUndefined(documentEnd)) {\n            this.end.setPosition(documentEnd.currentWidget, false);\n            this.fireSelectionChanged(true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift home key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftHomeKey = function () {\n        var documentStart = undefined;\n        if (!isNullOrUndefined(this.owner.documentStart)) {\n            documentStart = this.owner.documentStart;\n        }\n        if (!isNullOrUndefined(documentStart)) {\n            this.end.setPositionInternal(documentStart);\n            this.fireSelectionChanged(true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles tab key.\n     * @param isNavigateInCell\n     * @param isShiftTab\n     * @private\n     */\n    Selection.prototype.handleTabKey = function (isNavigateInCell, isShiftTab) {\n        var start = this.start;\n        if (isNullOrUndefined(start)) {\n            return;\n        }\n        if (start.paragraph.isInsideTable && this.end.paragraph.isInsideTable && (isNavigateInCell || isShiftTab)) {\n            //Perform tab navigation\n            if (isShiftTab) {\n                this.selectPreviousCell();\n            }\n            else {\n                this.selectNextCell();\n            }\n        }\n        else if ((isNavigateInCell || isShiftTab) && !isNullOrUndefined(start) && start.offset === this.getStartOffset(start.paragraph)\n            && !isNullOrUndefined(start.paragraph.paragraphFormat) && !isNullOrUndefined(start.paragraph.paragraphFormat.listFormat)\n            && start.paragraph.paragraphFormat.listFormat.listId !== -1 && !this.owner.isReadOnlyMode) {\n            this.owner.editorModule.updateListLevel(isShiftTab ? false : true);\n        }\n        else if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.handleTextInput('\\t');\n        }\n        this.checkForCursorVisibility();\n    };\n    Selection.prototype.selectPreviousCell = function () {\n        var tableCell = this.start.paragraph.associatedCell;\n        var tableRow = tableCell.ownerRow;\n        var tableAdv = tableRow.ownerTable;\n        if (isNullOrUndefined(tableCell.previousWidget)) {\n            if (!isNullOrUndefined(tableRow.previousRenderedWidget)) {\n                //Move text selection or cursor to previous row's last cell\n                var prevRow = undefined;\n                if (tableRow.previousRenderedWidget instanceof TableRowWidget) {\n                    prevRow = tableRow.previousRenderedWidget;\n                }\n                this.selectTableCellInternal(prevRow.childWidgets[prevRow.childWidgets.length - 1], true);\n            }\n        }\n        else {\n            //Move text selection or cursor to next cell in current row\n            var prevCell = undefined;\n            if (tableCell.previousWidget instanceof TableCellWidget) {\n                prevCell = tableCell.previousWidget;\n            }\n            this.selectTableCellInternal(prevCell, true);\n        }\n    };\n    Selection.prototype.selectNextCell = function () {\n        var tableCell = this.start.paragraph.associatedCell;\n        var tableRow = tableCell.ownerRow;\n        var tableAdv = tableRow.ownerTable;\n        if (isNullOrUndefined(tableCell.nextWidget)) {\n            if (isNullOrUndefined(tableRow.nextRenderedWidget) && !this.owner.isReadOnlyMode) {\n                //Insert new row below                  \n                this.owner.editorModule.insertRow(false);\n            }\n            else {\n                //Move text selection or cursor to next row's first cell\n                var nextRow = undefined;\n                if (tableRow.nextRenderedWidget instanceof TableRowWidget) {\n                    nextRow = tableRow.nextRenderedWidget;\n                }\n                this.selectTableCellInternal(nextRow.childWidgets[0], true);\n            }\n            // }\n        }\n        else {\n            //Move text selection or cursor to next cell in current row\n            var nextCell = undefined;\n            if (tableCell.nextRenderedWidget instanceof TableCellWidget) {\n                nextCell = tableCell.nextRenderedWidget;\n            }\n            this.selectTableCellInternal(nextCell, true);\n        }\n    };\n    /**\n     * Select given table cell\n     * @private\n     */\n    Selection.prototype.selectTableCellInternal = function (tableCell, clearMultiSelection) {\n        var firstParagraph = this.getFirstParagraph(tableCell);\n        var lastParagraph = this.getLastParagraph(tableCell);\n        if (firstParagraph === lastParagraph && lastParagraph.isEmpty()) {\n            this.selectParagraph(lastParagraph, true);\n        }\n        else {\n            var firstLineWidget = lastParagraph.childWidgets[0];\n            this.start.setPosition(firstParagraph.childWidgets[0], true);\n            this.end.setPositionParagraph(firstLineWidget, firstLineWidget.getEndOffset());\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Select while table\n     * @private\n     */\n    Selection.prototype.selectTableInternal = function () {\n        var start = this.start;\n        var end = this.end;\n        if (!this.isForward) {\n            start = this.end;\n            end = this.start;\n        }\n        if (!isNullOrUndefined(start) && !isNullOrUndefined(end) && !isNullOrUndefined(this.getTable(start, end))) {\n            var containerCell = this.getContainerCellOf(start.paragraph.associatedCell, end.paragraph.associatedCell);\n            var table = containerCell.ownerTable;\n            var firstPara = this.getFirstParagraphBlock(table);\n            var lastPara = this.getLastParagraphBlock(table);\n            var offset = lastPara.lastChild.getEndOffset();\n            this.start.setPosition(firstPara.childWidgets[0], true);\n            this.end.setPositionParagraph(lastPara.lastChild, offset + 1);\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * Select single column\n     * @private\n     */\n    Selection.prototype.selectColumnInternal = function () {\n        var startTextPos = this.start;\n        var endTextPos = this.end;\n        if (!this.isForward) {\n            startTextPos = this.end;\n            endTextPos = this.start;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(startTextPos) && !isNullOrUndefined(endTextPos) && !isNullOrUndefined(this.getTable(startTextPos, endTextPos))) {\n            var containerCell = this.getContainerCellOf(startTextPos.paragraph.associatedCell, endTextPos.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(endTextPos.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(startTextPos.paragraph.associatedCell, containerCell);\n                var endCell = this.getSelectedCell(endTextPos.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, endTextPos.paragraph.associatedCell)) {\n                    var row = startCell.ownerRow;\n                    var columnCells = containerCell.ownerTable.getColumnCellsForSelection(containerCell, containerCell);\n                    if (columnCells.length > 0) {\n                        var firstPara = this.getFirstParagraph(columnCells[0]);\n                        var lastPara = this.getLastParagraph(columnCells[columnCells.length - 1]);\n                        this.start.setPosition(firstPara.firstChild, true);\n                        var lastLine = lastPara.lastChild;\n                        this.end.setPositionParagraph(lastLine, lastLine.getEndOffset() + 1);\n                    }\n                }\n                else {\n                    var startCellColumnCells = containerCell.ownerTable.getColumnCellsForSelection(startCell, startCell);\n                    var endCellColumnCells = containerCell.ownerTable.getColumnCellsForSelection(endCell, endCell);\n                    if (startCellColumnCells.length > 0 && endCellColumnCells.length > 0) {\n                        var firstPara = this.getFirstParagraph(startCellColumnCells[0]);\n                        // tslint:disable-next-line:max-line-length\n                        var lastPara = this.getLastParagraph(endCellColumnCells[endCellColumnCells.length - 1]);\n                        this.start.setPosition(firstPara.firstChild, true);\n                        var lastLine = lastPara.lastChild;\n                        this.end.setPositionParagraph(lastLine, lastLine.getEndOffset() + 1);\n                    }\n                }\n            }\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * Select single row\n     * @private\n     */\n    Selection.prototype.selectTableRow = function () {\n        var startPos = this.start;\n        var endPos = this.end;\n        if (!this.isForward) {\n            startPos = this.end;\n            endPos = this.start;\n        }\n        if (!isNullOrUndefined(startPos) && !isNullOrUndefined(endPos) && !isNullOrUndefined(this.getTable(startPos, endPos))) {\n            var containerCell = void 0;\n            containerCell = this.getContainerCellOf(startPos.paragraph.associatedCell, endPos.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(endPos.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(startPos.paragraph.associatedCell, containerCell);\n                var endCell = this.getSelectedCell(endPos.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, endPos.paragraph.associatedCell)) {\n                    var row = startCell.ownerRow;\n                    var firstPara = this.getFirstParagraph(row.childWidgets[0]);\n                    var lastPara = this.getLastParagraph(row.childWidgets[row.childWidgets.length - 1]);\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n                else {\n                    var firstPara = this.getFirstParagraph(startCell.ownerRow.childWidgets[0]);\n                    var lastPara = void 0;\n                    // tslint:disable-next-line:max-line-length\n                    lastPara = this.getLastParagraph(endCell.ownerRow.childWidgets[endCell.ownerRow.childWidgets.length - 1]);\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n            }\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * Select single cell\n     * @private\n     */\n    Selection.prototype.selectTableCell = function () {\n        var start = this.start;\n        var end = this.end;\n        if (!this.isForward) {\n            start = this.end;\n            end = this.start;\n        }\n        if (isNullOrUndefined(this.getTable(start, end))) {\n            return;\n        }\n        if (this.isEmpty) {\n            if (start.paragraph.isInsideTable && !isNullOrUndefined(start.paragraph.associatedCell)) {\n                var firstPara = this.getFirstParagraph(start.paragraph.associatedCell);\n                var lastPara = this.getLastParagraph(end.paragraph.associatedCell);\n                if (firstPara === lastPara) {\n                    this.start.setPosition(lastPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n                else {\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n            }\n        }\n        else {\n            var containerCell = this.getContainerCell(start.paragraph.associatedCell);\n            // tslint:disable-next-line:max-line-length\n            if (this.containsCell(containerCell, start.paragraph.associatedCell) && this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                var firstPara = this.getFirstParagraph(containerCell);\n                var lastPara = this.getLastParagraph(containerCell);\n                if (!isNullOrUndefined(firstPara) && !isNullOrUndefined(lastPara)) {\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n            }\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * @private\n     * Selects the entire document.\n     */\n    Selection.prototype.selectAll = function () {\n        var documentStart;\n        var documentEnd;\n        if (this.owner.enableHeaderAndFooter) {\n            var headerFooter = this.getContainerWidget(this.start.paragraph);\n            documentStart = this.setPositionForBlock(headerFooter.firstChild, true);\n            documentEnd = this.setPositionForBlock(headerFooter.lastChild, false);\n        }\n        else {\n            documentStart = this.owner.documentStart;\n            documentEnd = this.owner.documentEnd;\n        }\n        //Selects the entire document.        \n        if (!isNullOrUndefined(documentStart)) {\n            this.start.setPositionInternal(documentStart);\n            this.end.setPositionParagraph(documentEnd.currentWidget, documentEnd.offset + 1);\n            this.upDownSelectionLength = this.end.location.x;\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Extend selection backward\n     * @private\n     */\n    Selection.prototype.extendBackward = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        var isForward = this.isForward ? this.start.isCurrentParaBidi : this.end.isCurrentParaBidi;\n        if (isForward) {\n            this.end.moveForward();\n        }\n        else {\n            this.end.moveBackward();\n        }\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extent selection forward\n     * @private\n     */\n    Selection.prototype.extendForward = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        var isForward = this.isForward ? this.start.isCurrentParaBidi : this.end.isCurrentParaBidi;\n        if (isForward) {\n            this.end.moveBackward();\n        }\n        else {\n            this.end.moveForward();\n        }\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to word start and end\n     * @private\n     */\n    Selection.prototype.extendToWordStartEnd = function () {\n        if ((this.start.paragraph.isInsideTable || this.end.paragraph.isInsideTable)\n            && (this.start.paragraph.associatedCell !== this.end.paragraph.associatedCell\n                || this.isCellSelected(this.start.paragraph.associatedCell, this.start, this.end))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Extend selection to word start\n     * @private\n     */\n    Selection.prototype.extendToWordStart = function (isNavigation) {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        var isCellSelected = this.extendToWordStartEnd();\n        if (isCellSelected) {\n            this.end.moveToPreviousParagraphInTable(this);\n        }\n        else {\n            if (isNavigation && this.end.isCurrentParaBidi) {\n                this.end.moveToWordEndInternal(isNavigation ? 0 : 1, false);\n            }\n            else {\n                this.end.moveToWordStartInternal(isNavigation ? 0 : 1);\n            }\n        }\n        if (isNavigation) {\n            this.start.setPositionInternal(this.end);\n        }\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extent selection to word end\n     * @private\n     */\n    Selection.prototype.extendToWordEnd = function (isNavigation) {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        var isCellSelect = this.extendToWordStartEnd();\n        if (isCellSelect) {\n            this.end.moveToNextParagraphInTable();\n        }\n        else {\n            if (isNavigation && this.end.isCurrentParaBidi) {\n                this.end.moveToWordStartInternal(isNavigation ? 0 : 1);\n            }\n            else {\n                this.end.moveToWordEndInternal(isNavigation ? 0 : 1, false);\n            }\n        }\n        if (isNavigation) {\n            this.start.setPositionInternal(this.end);\n        }\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to next line\n     * @private\n     */\n    Selection.prototype.extendToNextLine = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToNextLine(this.upDownSelectionLength);\n        this.fireSelectionChanged(true);\n    };\n    //Selection Text get API\n    //Selection add, Highlight, remove API enda\n    Selection.prototype.getTextPosition = function (hierarchicalIndex) {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionForCurrentIndex(hierarchicalIndex);\n        return textPosition;\n    };\n    /**\n     * Get Selected text\n     * @private\n     */\n    Selection.prototype.getText = function (includeObject) {\n        if (isNullOrUndefined(this.start) || isNullOrUndefined(this.end)\n            || isNullOrUndefined(this.start.paragraph) || isNullOrUndefined(this.end.paragraph)) {\n            return undefined;\n        }\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (startPosition.isAtSamePosition(endPosition)) {\n            return '';\n        }\n        return this.getTextInternal(startPosition, endPosition, includeObject);\n    };\n    /**\n     * Get selected text\n     * @private\n     */\n    Selection.prototype.getTextInternal = function (start, end, includeObject) {\n        if (start.isExistAfter(end)) {\n            var temp = end;\n            end = start;\n            start = temp;\n        }\n        var startPosition = start;\n        var endPosition = end;\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(start) && !isNullOrUndefined(end) && !isNullOrUndefined(start.paragraph) && !isNullOrUndefined(end.paragraph)) {\n            var startIndex = 0;\n            var endIndex = 0;\n            var startOffset = start.offset;\n            var endOffset = end.offset;\n            var startInlineObj = start.currentWidget.getInline(startOffset, startIndex);\n            startIndex = startInlineObj.index;\n            var inline = startInlineObj.element;\n            // If the start position is at the beginning of field begin that has field end, then field code should be skipped.\n            if (inline instanceof FieldElementBox && !isNullOrUndefined(inline.fieldEnd)) {\n                var elementInfo = this.getRenderedInline(inline, startIndex);\n                inline = elementInfo.element;\n                startIndex = elementInfo.index;\n            }\n            var endInlineObj = end.currentWidget.getInline(endOffset, endIndex);\n            var endInline = endInlineObj.element;\n            endIndex = endInlineObj.index;\n            var text = '';\n            // Retrieves the text from start inline.\n            if (inline instanceof ImageElementBox && includeObject && startIndex === 0) {\n                text = ElementBox.objectCharacter;\n            }\n            else if (inline instanceof TextElementBox) {\n                // tslint:disable-next-line:max-line-length\n                text = ((isNullOrUndefined(inline.text)) || (inline.text) === '') || inline.text.length < startIndex ? text : inline.text.substring(startIndex);\n            }\n            if (startPosition.paragraph === endPosition.paragraph) {\n                if (inline instanceof ElementBox) {\n                    if (inline === endInline && inline instanceof TextElementBox) {\n                        text = text.length < endIndex - startIndex ? text : text.substring(0, endIndex - startIndex);\n                    }\n                    else if (inline.nextNode instanceof ElementBox) {\n                        // tslint:disable-next-line:max-line-length\n                        text = text + this.getTextInline(inline.nextNode, endPosition.paragraph, endInline, endIndex, includeObject);\n                    }\n                }\n            }\n            else {\n                if (inline instanceof ElementBox && inline.nextNode instanceof ElementBox) {\n                    text = text + this.getTextInline(inline.nextNode, endPosition.paragraph, undefined, 0, includeObject);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    var nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(startPosition.paragraph);\n                    text = text + '\\r';\n                    while (!isNullOrUndefined(nextParagraphWidget) && nextParagraphWidget.isEmpty()) {\n                        text = text + '\\r';\n                        if (nextParagraphWidget === endPosition.paragraph) {\n                            return text;\n                        }\n                        nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(nextParagraphWidget);\n                    }\n                    if (!isNullOrUndefined(nextParagraphWidget) && !nextParagraphWidget.isEmpty()) {\n                        // tslint:disable-next-line:max-line-length\n                        text = text + this.getTextInline(nextParagraphWidget.childWidgets[0].children[0], endPosition.paragraph, endInline, endIndex, includeObject);\n                    }\n                }\n            }\n            // If the selection includes end paragraph mark.\n            if (endOffset === (endPosition.currentWidget).getEndOffset() + 1) {\n                text = text + '\\r';\n            }\n            return text;\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getListTextElementBox = function (paragarph) {\n        if (isNullOrUndefined(paragarph)) {\n            return undefined;\n        }\n        var listTextElement;\n        if (!paragarph.isEmpty()) {\n            var lineWidget = paragarph.childWidgets[0];\n            if (lineWidget.children.length > 1) {\n                if (lineWidget.children[0] instanceof ListTextElementBox) {\n                    listTextElement = lineWidget.children[0];\n                }\n            }\n        }\n        return listTextElement;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getTextInline = function (inlineElement, endParagraphWidget, endInline, endIndex, includeObject) {\n        var text = '';\n        do {\n            if (inlineElement === endInline) {\n                if (inlineElement instanceof TextElementBox) {\n                    var span = inlineElement;\n                    if (!(isNullOrUndefined(span.text) || span.text === '')) {\n                        if (span.text.length < endIndex) {\n                            text = text + span.text;\n                        }\n                        else {\n                            text = text + span.text.substring(0, endIndex);\n                        }\n                    }\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (inlineElement instanceof ImageElementBox && includeObject && endIndex === inlineElement.length) {\n                    text = text + ElementBox.objectCharacter;\n                }\n                return text;\n            }\n            if (inlineElement instanceof TextElementBox) {\n                text = text + inlineElement.text;\n            }\n            else if (inlineElement instanceof ImageElementBox && includeObject) {\n                text = text + ElementBox.objectCharacter;\n            }\n            else if (inlineElement instanceof FieldElementBox && !isNullOrUndefined(inlineElement.fieldEnd)) {\n                if (!isNullOrUndefined(inlineElement.fieldSeparator)) {\n                    inlineElement = inlineElement.fieldSeparator;\n                }\n                else {\n                    inlineElement = inlineElement.fieldEnd;\n                }\n            }\n            if (isNullOrUndefined(inlineElement.nextNode)) {\n                break;\n            }\n            inlineElement = inlineElement.nextNode;\n        } while (!isNullOrUndefined(inlineElement));\n        if (endParagraphWidget === inlineElement.line.paragraph) {\n            return text;\n        }\n        // tslint:disable-next-line:max-line-length\n        var nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(inlineElement.line.paragraph);\n        while (!isNullOrUndefined(nextParagraphWidget) && nextParagraphWidget.isEmpty()) {\n            text = text + '\\r';\n            if (nextParagraphWidget === endParagraphWidget) {\n                return text;\n            }\n            nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(nextParagraphWidget);\n        }\n        if (!isNullOrUndefined(nextParagraphWidget) && !nextParagraphWidget.isEmpty()) {\n            var lineWidget = nextParagraphWidget.childWidgets[0];\n            // tslint:disable-next-line:max-line-length\n            text = text + '\\r' + this.getTextInline(lineWidget.children[0], endParagraphWidget, endInline, endIndex, includeObject);\n        }\n        return text;\n    };\n    /**\n     * Returns field code.\n     * @private\n     * @param fieldBegin\n     */\n    Selection.prototype.getFieldCode = function (fieldBegin) {\n        var fieldCode = '';\n        if (!(fieldBegin.fieldEnd instanceof FieldElementBox)) {\n            return fieldCode;\n        }\n        var paragraph = fieldBegin.paragraph;\n        var endParagraph = fieldBegin.fieldEnd.paragraph;\n        if (fieldBegin.fieldSeparator instanceof FieldElementBox) {\n            endParagraph = fieldBegin.fieldSeparator.paragraph;\n        }\n        var startLineIndex = fieldBegin.line.indexInOwner;\n        var startIndex = fieldBegin.indexInOwner;\n        do {\n            fieldCode += this.getFieldCodeInternal(paragraph, startLineIndex, startIndex);\n            if (paragraph === endParagraph) {\n                break;\n            }\n            paragraph = this.getNextParagraphBlock(paragraph);\n            startLineIndex = 0;\n            startIndex = 0;\n        } while (paragraph instanceof ParagraphWidget);\n        return fieldCode.trim();\n    };\n    Selection.prototype.getFieldCodeInternal = function (paragraph, startLineIndex, inlineIndex) {\n        var fieldCode = '';\n        for (var i = startLineIndex; i < paragraph.childWidgets.length; i++) {\n            var line = paragraph.childWidgets[i];\n            for (var i_1 = inlineIndex; i_1 < line.children.length; i_1++) {\n                var element = line.children[i_1];\n                if (element instanceof TextElementBox) {\n                    fieldCode += element.text;\n                }\n                if (element instanceof FieldElementBox\n                    && (element.fieldType === 2 || element.fieldType === 1)) {\n                    return fieldCode;\n                }\n            }\n            inlineIndex = 0;\n        }\n        return fieldCode;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getTocFieldInternal = function () {\n        var paragraph = this.start.paragraph;\n        if (!this.isEmpty && !this.isForward) {\n            paragraph = this.end.paragraph;\n        }\n        while (paragraph instanceof ParagraphWidget && paragraph.childWidgets.length > 0) {\n            var line = paragraph.firstChild;\n            if (line.children.length > 0) {\n                var element = line.children[0];\n                var nextElement = element.nextNode;\n                if (element instanceof FieldElementBox && element.fieldType === 0 && nextElement instanceof TextElementBox\n                    && nextElement.text.trim().toLowerCase().indexOf('toc') === 0) {\n                    return element;\n                }\n            }\n            paragraph = paragraph.previousRenderedWidget;\n        }\n        return undefined;\n    };\n    /**\n     * Get next paragraph in bodyWidget\n     * @private\n     */\n    Selection.prototype.getNextParagraph = function (section) {\n        if (section.nextRenderedWidget instanceof BodyWidget) {\n            var block = section.nextRenderedWidget.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousParagraph = function (section) {\n        if (section.previousRenderedWidget instanceof BodyWidget) {\n            var bodyWidget = section.previousRenderedWidget;\n            var block = bodyWidget.childWidgets[bodyWidget.childWidgets.length - 1];\n            return this.getLastParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get first paragraph in cell\n     * @private\n     */\n    Selection.prototype.getFirstParagraphInCell = function (cell) {\n        var firstBlock = cell.childWidgets[0];\n        if (firstBlock instanceof ParagraphWidget) {\n            return firstBlock;\n        }\n        else {\n            return this.getFirstParagraphInFirstCell(firstBlock);\n        }\n    };\n    /**\n     * Get first paragraph in first cell\n     * @private\n     */\n    Selection.prototype.getFirstParagraphInFirstCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var firstRow = table.childWidgets[0];\n            var cell = firstRow.childWidgets[0];\n            var block = cell.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in last cell\n     * @private\n     */\n    Selection.prototype.getLastParagraphInLastCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastrow = table.lastChild;\n            var lastcell = lastrow.lastChild;\n            var lastBlock = lastcell.lastChild;\n            return this.getLastParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in first row\n     * @private\n     */\n    Selection.prototype.getLastParagraphInFirstRow = function (table) {\n        if (table.childWidgets.length > 0) {\n            var row = table.firstChild;\n            var lastcell = row.lastChild;\n            var lastBlock = lastcell.lastChild;\n            return this.getLastParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get Next start inline\n     * @private\n     */\n    Selection.prototype.getNextStartInline = function (line, offset) {\n        var indexInInline = 0;\n        var inlineObj = line.getInline(offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!isNullOrUndefined(inline) && indexInInline === inline.length && inline.nextNode instanceof FieldElementBox) {\n            var nextValidInline = this.getNextValidElement(inline.nextNode);\n            if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 0) {\n                inline = nextValidInline;\n            }\n        }\n        return inline;\n    };\n    /**\n     * Get previous text inline\n     * @private\n     */\n    Selection.prototype.getPreviousTextInline = function (inline) {\n        if (inline.previousNode instanceof TextElementBox) {\n            return inline.previousNode;\n        }\n        if (inline.previousNode instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline.previousNode)) {\n            if (inline.previousNode.fieldType === 0 || inline.previousNode.fieldType === 1) {\n                return inline.previousNode;\n            }\n            return inline.previousNode.fieldBegin;\n        }\n        if (!isNullOrUndefined(inline.previousNode)) {\n            return this.getPreviousTextInline((inline.previousNode));\n        }\n        return undefined;\n    };\n    /**\n     * Get next text inline\n     * @private\n     */\n    Selection.prototype.getNextTextInline = function (inline) {\n        if (inline.nextNode instanceof TextElementBox) {\n            return inline.nextNode;\n        }\n        if (inline.nextNode instanceof FieldElementBox && (HelperMethods.isLinkedFieldCharacter(inline.nextNode))) {\n            if (inline.nextNode.fieldType === 1 || inline.nextNode.fieldType === 0) {\n                return inline.nextNode;\n            }\n            return inline.nextNode.fieldEnd;\n        }\n        if (!isNullOrUndefined(inline.nextNode)) {\n            return this.getNextTextInline((inline.nextNode));\n        }\n        return undefined;\n    };\n    /**\n     * Get container table\n     * @private\n     */\n    Selection.prototype.getContainerTable = function (block) {\n        if (block.isInsideTable) {\n            if (block.associatedCell.ownerTable.isInsideTable) {\n                block = this.getContainerTable(block.associatedCell.ownerTable);\n            }\n            else {\n                block = block.associatedCell.ownerTable;\n            }\n        }\n        if (block instanceof TableWidget) {\n            return block;\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isExistBefore = function (start, block) {\n        if (start.isInsideTable) {\n            var cell1 = start.associatedCell;\n            if (block.isInsideTable) {\n                var cell2 = block.associatedCell;\n                if (cell1 === cell2) {\n                    return cell1.childWidgets.indexOf(start) < cell1.childWidgets.indexOf(block);\n                }\n                if (cell1.ownerRow === cell2.ownerRow) {\n                    return cell1.cellIndex < cell2.cellIndex;\n                }\n                if (cell1.ownerTable === cell2.ownerTable) {\n                    return cell1.ownerRow.rowIndex < cell2.ownerRow.rowIndex;\n                }\n                //Checks if current block exists before the block.\n                var containerCell = this.getContainerCellOf(cell1, cell2);\n                if (containerCell.ownerTable.contains(cell2)) {\n                    cell1 = this.getSelectedCell(cell1, containerCell);\n                    cell2 = this.getSelectedCell(cell2, containerCell);\n                    if (cell1 === containerCell) {\n                        return this.isExistBefore(start, cell2.ownerTable);\n                    }\n                    if (cell2 === containerCell) {\n                        return this.isExistBefore(cell1.ownerTable, block);\n                    }\n                    if (containerCell.ownerRow === cell2.ownerRow) {\n                        return containerCell.cellIndex < cell2.cellIndex;\n                    }\n                    if (containerCell.ownerTable === cell2.ownerTable) {\n                        return containerCell.ownerRow.rowIndex < cell2.ownerRow.rowIndex;\n                    }\n                    return this.isExistBefore(cell1.ownerTable, cell2.ownerTable);\n                }\n                return this.isExistBefore(containerCell.ownerTable, this.getContainerTable(cell2.ownerTable));\n            }\n            else {\n                var ownerTable = this.getContainerTable(start);\n                return this.isExistBefore(ownerTable, block);\n            }\n        }\n        else if (block.isInsideTable) {\n            var ownerTable = this.getContainerTable(block);\n            return this.isExistBefore(start, ownerTable);\n        }\n        else {\n            {\n                if (start.containerWidget === block.containerWidget) {\n                    return start.index <\n                        block.index;\n                }\n                if (start.containerWidget instanceof BodyWidget && block.containerWidget instanceof BodyWidget) {\n                    //Splitted blocks                     \n                    var startPage = this.viewer.pages.indexOf(start.containerWidget.page);\n                    var endPage = this.viewer.pages.indexOf(block.containerWidget.page);\n                    return startPage < endPage;\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isExistAfter = function (start, block) {\n        if (start.isInsideTable) {\n            var cell1 = start.associatedCell;\n            //Current paragraph in cell, paragraph in cell\n            if (block.isInsideTable) {\n                var cell2 = block.associatedCell;\n                if (cell1 === cell2) {\n                    return cell1.childWidgets.indexOf(start) > cell1.childWidgets.indexOf(block);\n                }\n                if (cell1.ownerRow === cell2.ownerRow) {\n                    return cell1.cellIndex > cell2.cellIndex;\n                }\n                if (cell1.ownerTable === cell2.ownerTable) {\n                    return cell1.ownerRow.rowIndex > cell2.ownerRow.rowIndex;\n                }\n                //Checks if this block exists before block.\n                var containerCell = this.getContainerCellOf(cell1, cell2);\n                if (containerCell.ownerTable.contains(cell2)) {\n                    cell1 = this.getSelectedCell(cell1, containerCell);\n                    cell2 = this.getSelectedCell(cell2, containerCell);\n                    if (cell1 === containerCell) {\n                        return this.isExistAfter(start, cell2.ownerTable);\n                    }\n                    if (cell2 === containerCell) {\n                        return this.isExistAfter(cell1.ownerTable, block);\n                    }\n                    if (containerCell.ownerRow === cell2.ownerRow) {\n                        return containerCell.cellIndex > cell2.cellIndex;\n                    }\n                    if (containerCell.ownerTable === cell2.ownerTable) {\n                        return containerCell.ownerRow.rowIndex > cell2.ownerRow.rowIndex;\n                    }\n                    return this.isExistAfter(cell1.ownerTable, cell2.ownerTable);\n                }\n                return this.isExistAfter(containerCell.ownerTable, this.getContainerTable(cell2.ownerTable));\n            }\n            else {\n                var ownerTable = this.getContainerTable(start);\n                return this.isExistAfter(ownerTable, block);\n            }\n        }\n        else if (block.isInsideTable) {\n            var ownerTable = this.getContainerTable(block);\n            return this.isExistAfter(start, ownerTable);\n        }\n        else {\n            if (start.containerWidget === block.containerWidget) {\n                return start.index >\n                    block.index;\n            }\n            if (start.containerWidget instanceof BodyWidget && block.containerWidget instanceof BodyWidget) {\n                //Splitted blocks                     \n                var startPage = this.viewer.pages.indexOf(start.containerWidget.page);\n                var endPage = this.viewer.pages.indexOf(block.containerWidget.page);\n                return startPage > endPage;\n            }\n            //     if (start.owner instanceof WHeaderFooter) {\n            //         return (start.owner as WHeaderFooter).childWidgets.indexOf(start) \n            // > (block.owner as WHeaderFooter).childWidgets.indexOf(block);\n            //     } else if (start.section === block.section && start.section instanceof WSection) {\n            //         return (start.section as WSection).childWidgets.indexOf(start)\n            //  > (start.section as WSection).childWidgets.indexOf(block);\n            //     } else if (start.wordDocument instanceof WordDocument) {\n            // tslint:disable-next-line:max-line-length\n            //         return (start.wordDocument as WordDocument).sections.indexOf(start.section as WSection) > (start.wordDocument as WordDocument).sections.indexOf(block.section as WSection);\n        }\n        return false;\n    };\n    /**\n     * Return true if current inline in exist before inline\n     * @private\n     */\n    Selection.prototype.isExistBeforeInline = function (currentInline, inline) {\n        if (currentInline.line === inline.line) {\n            return currentInline.line.children.indexOf(currentInline) <\n                inline.line.children.indexOf(inline);\n        }\n        if (currentInline.line.paragraph === inline.line.paragraph) {\n            return currentInline.line.paragraph.childWidgets.indexOf(currentInline.line)\n                < inline.line.paragraph.childWidgets.indexOf(inline.line);\n        }\n        var startParagraph = currentInline.line.paragraph;\n        var endParagraph = inline.line.paragraph;\n        if (startParagraph.containerWidget === endParagraph.containerWidget) {\n            if (startParagraph.isInsideTable) {\n                return startParagraph.associatedCell.childWidgets.indexOf(startParagraph) <\n                    endParagraph.associatedCell.childWidgets.indexOf(endParagraph);\n            }\n            else if (startParagraph.containerWidget instanceof HeaderFooterWidget) {\n                // return ((currentInline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(currentInline.owner as WParagraph) <\n                //     ((inline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(inline.owner as WParagraph);\n            }\n            else {\n                return startParagraph.containerWidget.childWidgets.indexOf(startParagraph) <\n                    endParagraph.containerWidget.childWidgets.indexOf(endParagraph);\n            }\n        }\n        return this.isExistBefore(startParagraph, endParagraph);\n    };\n    /**\n     * Return true id current inline is exist after inline\n     * @private\n     */\n    Selection.prototype.isExistAfterInline = function (currentInline, inline) {\n        if (currentInline.line === inline.line) {\n            return currentInline.line.children.indexOf(currentInline) >\n                inline.line.children.indexOf(inline);\n        }\n        if (currentInline.line.paragraph === inline.line.paragraph) {\n            return currentInline.line.paragraph.childWidgets.indexOf(currentInline.line)\n                > inline.line.paragraph.childWidgets.indexOf(inline.line);\n        }\n        var startParagraph = currentInline.line.paragraph;\n        var endParagraph = inline.line.paragraph;\n        if (startParagraph.containerWidget === endParagraph.containerWidget) {\n            if (startParagraph.isInsideTable) {\n                return startParagraph.associatedCell.childWidgets.indexOf(startParagraph) >\n                    endParagraph.associatedCell.childWidgets.indexOf(endParagraph);\n            }\n            else if (startParagraph.containerWidget instanceof HeaderFooterWidget) {\n                // return ((currentInline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(currentInline.owner as WParagraph) <\n                //     ((inline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(inline.owner as WParagraph);\n            }\n            else {\n                return startParagraph.containerWidget.childWidgets.indexOf(startParagraph) >\n                    endParagraph.containerWidget.childWidgets.indexOf(endParagraph);\n            }\n        }\n        return this.isExistAfter(startParagraph, endParagraph);\n    };\n    /**\n     * Get next rendered block\n     * @private\n     */\n    Selection.prototype.getNextRenderedBlock = function (block) {\n        if (isNullOrUndefined(block.nextWidget)) {\n            return block.nextRenderedWidget;\n        }\n        return block.nextWidget;\n    };\n    /**\n     * Get next rendered block\n     * @private\n     */\n    Selection.prototype.getPreviousRenderedBlock = function (block) {\n        if (isNullOrUndefined(block.previousWidget)) {\n            return block.previousRenderedWidget;\n        }\n        return block.previousWidget;\n    };\n    /**\n     * Get Next paragraph in block\n     * @private\n     */\n    Selection.prototype.getNextParagraphBlock = function (block) {\n        if (block.nextRenderedWidget instanceof ParagraphWidget) {\n            return block.nextRenderedWidget;\n        }\n        else if (block.nextRenderedWidget instanceof TableWidget) {\n            return this.getFirstParagraphInFirstCell(block.nextRenderedWidget);\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getNextParagraphCell(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            var bodyWidget = block.containerWidget;\n            return this.getNextParagraph(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget && this.isMoveDownOrMoveUp) {\n            return this.getFirstBlockInNextHeaderFooter(block);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstBlockInNextHeaderFooter = function (block) {\n        var headerFooter = block.containerWidget;\n        var nextBlock;\n        if (headerFooter.headerFooterType.indexOf('Header') !== -1) {\n            nextBlock = headerFooter.page.footerWidget.firstChild;\n        }\n        else if (headerFooter.page.nextPage) {\n            nextBlock = headerFooter.page.nextPage.headerWidget.firstChild;\n        }\n        else {\n            return undefined;\n        }\n        if (nextBlock instanceof ParagraphWidget) {\n            return nextBlock;\n        }\n        else {\n            return this.getFirstBlockInFirstCell(nextBlock);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getLastBlockInPreviousHeaderFooter = function (block) {\n        var headerFooter = block.containerWidget;\n        var previousBlock;\n        if (headerFooter.headerFooterType.indexOf('Footer') !== -1) {\n            previousBlock = headerFooter.page.headerWidget.lastChild;\n        }\n        else if (headerFooter.page.previousPage) {\n            previousBlock = headerFooter.page.previousPage.footerWidget.lastChild;\n        }\n        else {\n            return undefined;\n        }\n        if (previousBlock instanceof ParagraphWidget) {\n            return previousBlock;\n        }\n        else {\n            return this.getFirstBlockInFirstCell(previousBlock);\n        }\n    };\n    /**\n     * Get previous paragraph in block\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphBlock = function (block) {\n        if (block.previousRenderedWidget instanceof ParagraphWidget) {\n            return block.previousRenderedWidget;\n        }\n        else if (block.previousRenderedWidget instanceof TableWidget) {\n            return this.getLastParagraphInLastCell((block.previousRenderedWidget));\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getPreviousParagraphCell((block.containerWidget));\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            return this.getPreviousParagraph(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget && this.isMoveDownOrMoveUp) {\n            return this.getLastBlockInPreviousHeaderFooter(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get first paragraph in block\n     * @private\n     */\n    Selection.prototype.getFirstParagraphBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            return block;\n        }\n        else if (block instanceof TableWidget) {\n            return this.getFirstParagraphInFirstCell(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in block\n     * @private\n     */\n    Selection.prototype.getLastParagraphBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            return block;\n        }\n        else if (block instanceof TableWidget) {\n            return this.getLastParagraphInLastCell(block);\n        }\n        return undefined;\n    };\n    /**\n     * Return true if paragraph has valid inline\n     * @private\n     */\n    Selection.prototype.hasValidInline = function (paragraph, start, end) {\n        var index = paragraph.childWidgets.indexOf(start.line);\n        for (var i = index; i < paragraph.childWidgets.length; i++) {\n            for (var j = 0; j < paragraph.childWidgets[i].children.length; j++) {\n                var inline = paragraph.childWidgets[i].children[j];\n                if (inline.length === 0) {\n                    continue;\n                }\n                if (inline === end) {\n                    return false;\n                }\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * Get paragraph length\n     * @private\n     */\n    Selection.prototype.getParagraphLength = function (paragraph, endLine, elementInfo) {\n        var length = 0;\n        for (var j = 0; j < paragraph.childWidgets.length; j++) {\n            var line = paragraph.childWidgets[j];\n            if (endLine instanceof LineWidget && endLine === line) {\n                if (elementInfo) {\n                    length += this.getLineLength(line, elementInfo);\n                }\n                break;\n            }\n            length += this.getLineLength(line);\n        }\n        return length;\n    };\n    /**\n     * Get Line length\n     * @private\n     */\n    Selection.prototype.getLineLength = function (line, elementInfo) {\n        var length = 0;\n        var bidi = line.paragraph.bidi;\n        for (var i = !bidi ? 0 : line.children.length - 1; bidi ? i > -1 : i < line.children.length; bidi ? i-- : i++) {\n            var element = line.children[i];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            if (elementInfo && elementInfo.element instanceof ElementBox && elementInfo.element === element) {\n                length += elementInfo.index;\n                break;\n            }\n            length += element.length;\n        }\n        return length;\n    };\n    /**\n     * Get line information\n     * @private\n     */\n    Selection.prototype.getLineInfo = function (paragraph, offset) {\n        var line = undefined;\n        var length = 0;\n        var childLength = paragraph.childWidgets.length;\n        for (var j = 0; j < childLength; j++) {\n            line = paragraph.childWidgets[j];\n            length = this.getLineLength(line);\n            if (offset <= length || j === childLength - 1) {\n                break;\n            }\n            else {\n                offset = offset - length;\n            }\n        }\n        return { 'line': line, 'offset': offset };\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getElementInfo = function (line, offset) {\n        var index = 0;\n        var element = undefined;\n        for (var i = 0; i < line.children.length; i++) {\n            element = line.children[i];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            if (offset > element.length\n                && (!(offset === element.length + 1 && isNullOrUndefined(element.nextNode)))) {\n                offset = offset - element.length;\n            }\n            else {\n                break;\n            }\n        }\n        return { 'element': element, 'index': offset };\n    };\n    /**\n     * Get paragraph start offset\n     * @private\n     */\n    Selection.prototype.getStartOffset = function (paragraph) {\n        var startOffset = 0;\n        if (paragraph.childWidgets.length > 0) {\n            var childWidgets = paragraph.childWidgets[0];\n            return this.getStartLineOffset(childWidgets);\n        }\n        return startOffset;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getStartLineOffset = function (line) {\n        var startOffset = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var inline = line.children[i];\n            if (inline.length === 0) {\n                continue;\n            }\n            if (inline instanceof TextElementBox || inline instanceof ImageElementBox || inline instanceof BookmarkElementBox\n                || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                return startOffset;\n            }\n            if (inline instanceof ListTextElementBox) {\n                continue;\n            }\n            startOffset += inline.length;\n        }\n        return startOffset;\n    };\n    /**\n     * Get previous paragraph from selection\n     * @private\n     */\n    Selection.prototype.getPreviousSelectionCell = function (cell) {\n        if (!isNullOrUndefined(cell.previousRenderedWidget)) {\n            if (!this.isForward) {\n                var block = cell.previousRenderedWidget.childWidgets[0];\n                if (block instanceof ParagraphWidget) {\n                    return block;\n                }\n                else {\n                    return this.getFirstParagraphInLastRow(block);\n                }\n            }\n            else {\n                var widgets = cell.previousRenderedWidget.childWidgets;\n                var block = widgets[widgets.length - 1];\n                if (block instanceof ParagraphWidget) {\n                    return block;\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    return this.getPreviousParagraphSelection(block.childWidgets[block.childWidgets.length - 1]);\n                }\n            }\n        }\n        return this.getPreviousSelectionRow(cell.ownerRow);\n    };\n    /**\n     * Get previous paragraph selection in selection\n     * @private\n     */\n    Selection.prototype.getPreviousSelectionRow = function (row) {\n        if (!isNullOrUndefined(row.previousRenderedWidget)) {\n            if (!this.isForward) {\n                var cell = row.previousRenderedWidget.childWidgets[0];\n                var block = cell.childWidgets[0];\n                return this.getFirstParagraphBlock(block);\n            }\n            else {\n                return this.getPreviousParagraphSelection(row.previousRenderedWidget);\n            }\n        }\n        return this.getPreviousSelectionBlock(row.ownerTable);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextSelectionBlock = function (block) {\n        if (block.nextRenderedWidget instanceof ParagraphWidget) {\n            return block.nextRenderedWidget;\n        }\n        else if (block.nextRenderedWidget instanceof TableWidget) {\n            if (this.isEmpty || this.isForward) {\n                return this.getLastParagraphInFirstRow(block.nextRenderedWidget);\n            }\n            else {\n                return this.getNextParagraphSelection(block.nextRenderedWidget.childWidgets[0]);\n            }\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getNextSelectionCell(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            return this.getNextSelection(block.containerWidget);\n        }\n        return undefined;\n    };\n    /**\n     * Get next paragraph from selected cell\n     * @private\n     */\n    Selection.prototype.getNextSelectionCell = function (cell) {\n        if (!isNullOrUndefined(cell.nextRenderedWidget)) {\n            if (this.isEmpty || this.isForward) {\n                // tslint:disable-next-line:max-line-length\n                var block = cell.nextRenderedWidget.childWidgets[cell.nextRenderedWidget.childWidgets.length - 1];\n                return this.getLastParagraphBlock(block);\n            }\n            else {\n                //Return first paragraph in cell. \n                var block = cell.nextRenderedWidget.childWidgets[0];\n                if (block instanceof ParagraphWidget) {\n                    return block;\n                }\n                else {\n                    return this.getNextParagraphSelection(block.childWidgets[0]);\n                }\n            }\n        }\n        return this.getNextSelectionRow(cell.ownerRow);\n    };\n    /**\n     * Get next paragraph in selection\n     * @private\n     */\n    Selection.prototype.getNextSelectionRow = function (row) {\n        if (!isNullOrUndefined(row.nextRenderedWidget)) {\n            var isForwardSelection = this.isEmpty || this.isForward;\n            if (isForwardSelection) {\n                // tslint:disable-next-line:max-line-length\n                var cell = row.nextRenderedWidget.childWidgets[row.nextRenderedWidget.childWidgets.length - 1];\n                var block = cell.childWidgets[cell.childWidgets.length - 1];\n                return this.getLastParagraphBlock(block);\n            }\n            else {\n                return this.getNextParagraphSelection(row.nextRenderedWidget);\n            }\n        }\n        return this.getNextSelectionBlock(row.ownerTable);\n    };\n    /**\n     * Get next block with selection\n     * @private\n     */\n    Selection.prototype.getNextSelection = function (section) {\n        if (section.nextRenderedWidget instanceof BodyWidget) {\n            var block = section.nextRenderedWidget.childWidgets[0];\n            if (block instanceof ParagraphWidget) {\n                return block;\n            }\n            else {\n                if (this.isEmpty || this.isForward) {\n                    return this.getLastParagraphInFirstRow(block);\n                }\n                else {\n                    return this.getNextParagraphSelection(block.childWidgets[0]);\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextParagraphSelection = function (row) {\n        //Iterate the exact cell based on UP/Down selection length.\n        var cell = row.childWidgets[0];\n        if (this.start.paragraph.isInsideTable\n            && row.ownerTable.contains(this.start.paragraph.associatedCell)) {\n            var startCell = this.getCellInTable(row.ownerTable, this.start.paragraph.associatedCell);\n            cell = this.getFirstCellInRegion(row, startCell, this.upDownSelectionLength, false);\n        }\n        var block = cell.childWidgets[0];\n        return this.getFirstParagraphBlock(block);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousSelectionBlock = function (block) {\n        if (block.previousRenderedWidget instanceof ParagraphWidget) {\n            return block.previousRenderedWidget;\n        }\n        else if (block.previousRenderedWidget instanceof TableWidget) {\n            if (!this.isForward) {\n                return this.getFirstParagraphInLastRow(block.previousRenderedWidget);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                return this.getPreviousParagraphSelection(block.previousRenderedWidget.childWidgets[block.previousRenderedWidget.childWidgets.length - 1]);\n            }\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getPreviousSelectionCell(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            return this.getPreviousSelection(block.containerWidget);\n        }\n        return undefined;\n    };\n    /**\n     * Get previous paragraph in selection\n     * @private\n     */\n    Selection.prototype.getPreviousSelection = function (section) {\n        if (section.previousRenderedWidget instanceof BodyWidget) {\n            var prevBodyWidget = section.previousRenderedWidget;\n            var block = prevBodyWidget.childWidgets[prevBodyWidget.childWidgets.length - 1];\n            if (block instanceof ParagraphWidget) {\n                return block;\n            }\n            else {\n                if (!this.isForward) {\n                    return this.getFirstParagraphInLastRow(block);\n                }\n                else {\n                    var tableWidget = block;\n                    // tslint:disable-next-line:max-line-length\n                    return this.getPreviousParagraphSelection(tableWidget.childWidgets[tableWidget.childWidgets.length - 1]);\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphSelection = function (row) {\n        //Iterate the exact cell based on UP/Down selection length.\n        var cell = row.childWidgets[row.childWidgets.length - 1];\n        if (this.start.paragraph.isInsideTable\n            && row.ownerTable.contains(this.start.paragraph.associatedCell)) {\n            var startCell = this.getCellInTable(row.ownerTable, this.start.paragraph.associatedCell);\n            cell = this.getLastCellInRegion(row, startCell, this.upDownSelectionLength, true);\n        }\n        var block = cell.childWidgets[cell.childWidgets.length - 1];\n        return this.getLastParagraphBlock(block);\n    };\n    /**\n     * Get last cell in the selected region\n     * @private\n     */\n    Selection.prototype.getLastCellInRegion = function (row, startCell, selLength, isMovePrev) {\n        var start = this.getCellLeft(row, startCell);\n        var end = start + startCell.cellFormat.cellWidth;\n        var flag = true;\n        if (start <= selLength && selLength < end) {\n            for (var i = row.childWidgets.length - 1; i >= 0; i--) {\n                var left = this.getCellLeft(row, row.childWidgets[i]);\n                if (HelperMethods.round(start, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(end, 2)) {\n                    flag = false;\n                    return row.childWidgets[i];\n                }\n            }\n        }\n        else {\n            for (var i = row.childWidgets.length - 1; i >= 0; i--) {\n                var left = this.getCellLeft(row, row.childWidgets[i]);\n                if (left <= selLength && left + row.childWidgets[i].cellFormat.cellWidth > selLength) {\n                    flag = false;\n                    return row.childWidgets[i];\n                }\n            }\n        }\n        if (flag) {\n            if (!isNullOrUndefined(row.previousRenderedWidget) && isMovePrev) {\n                return this.getLastCellInRegion(row.previousRenderedWidget, startCell, selLength, isMovePrev);\n            }\n            else if (!isNullOrUndefined(row.nextRenderedWidget) && !isMovePrev) {\n                return this.getLastCellInRegion(row.nextRenderedWidget, startCell, selLength, isMovePrev);\n            }\n        }\n        return row.childWidgets[row.childWidgets.length - 1];\n    };\n    /**\n     * Get Container table\n     * @private\n     */\n    Selection.prototype.getCellInTable = function (table, tableCell) {\n        while (tableCell.ownerTable.isInsideTable) {\n            if (table.equals(tableCell.ownerTable)) {\n                return tableCell;\n            }\n            tableCell = tableCell.ownerTable.associatedCell;\n        }\n        return tableCell;\n    };\n    /**\n     * Get first paragraph in last row\n     * @private\n     */\n    Selection.prototype.getFirstParagraphInLastRow = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastRow = table.childWidgets[table.childWidgets.length - 1];\n            var lastCell = lastRow.childWidgets[0];\n            var lastBlock = lastCell.childWidgets[0];\n            return this.getFirstParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get previous valid offset\n     * @private\n     */\n    Selection.prototype.getPreviousValidOffset = function (paragraph, offset) {\n        if (offset === 0) {\n            return 0;\n        }\n        var validOffset = 0;\n        var count = 0;\n        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n            var lineWidget = paragraph.childWidgets[i];\n            for (var j = 0; j < lineWidget.children.length; j++) {\n                var inline = lineWidget.children[j];\n                if (inline.length === 0) {\n                    continue;\n                }\n                if (offset <= count + inline.length) {\n                    return offset - 1 === count ? validOffset : offset - 1;\n                }\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    validOffset = count + inline.length;\n                }\n                count += inline.length;\n            }\n        }\n        return offset - 1 === count ? validOffset : offset - 1;\n    };\n    /**\n     * Get next valid offset\n     * @private\n     */\n    Selection.prototype.getNextValidOffset = function (line, offset) {\n        var count = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var inline = line.children[i];\n            if (inline.length === 0 || inline instanceof ListTextElementBox) {\n                continue;\n            }\n            if (offset < count + inline.length) {\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    return (offset > count ? offset : count) + 1;\n                }\n            }\n            count += inline.length;\n        }\n        return offset;\n    };\n    /**\n     * Get paragraph mark size info\n     * @private\n     */\n    Selection.prototype.getParagraphMarkSize = function (paragraph, topMargin, bottomMargin) {\n        var size = this.viewer.textHelper.getParagraphMarkSize(paragraph.characterFormat);\n        var baselineOffset = size.BaselineOffset;\n        var maxHeight = size.Height;\n        var maxBaselineOffset = baselineOffset;\n        if (paragraph instanceof ParagraphWidget) {\n            // let paragraphWidget: ParagraphWidget[] = paragraph.renderedElement() as ParagraphWidget[];\n            if (paragraph.childWidgets.length > 0) {\n                var lineWidget = paragraph.childWidgets[0];\n            }\n            //Gets line spacing.\n            var lineSpacing = this.viewer.layout.getLineSpacing(paragraph, maxHeight);\n            var beforeSpacing = this.viewer.layout.getBeforeSpacing(paragraph);\n            topMargin = maxBaselineOffset - baselineOffset;\n            bottomMargin = maxHeight - maxBaselineOffset - (size.Height - baselineOffset);\n            //Updates line spacing, paragraph after/ before spacing and aligns the text to base line offset.\n            var lineSpacingType = paragraph.paragraphFormat.lineSpacingType;\n            if (lineSpacingType === 'Multiple') {\n                if (lineSpacing > maxHeight) {\n                    bottomMargin += lineSpacing - maxHeight;\n                }\n                else {\n                    topMargin += lineSpacing - maxHeight;\n                }\n            }\n            else if (lineSpacingType === 'Exactly') {\n                topMargin += lineSpacing - (topMargin + size.Height + bottomMargin);\n            }\n            else if (lineSpacing > topMargin + size.Height + bottomMargin) {\n                topMargin += lineSpacing - (topMargin + size.Height + bottomMargin);\n            }\n            topMargin += beforeSpacing;\n            bottomMargin += paragraph.paragraphFormat.afterSpacing;\n        }\n        return { 'width': size.Width, 'height': size.Height, 'topMargin': topMargin, 'bottomMargin': bottomMargin };\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPhysicalPositionInternal = function (line, offset, moveNextLine) {\n        if (line.paragraph.isEmpty()) {\n            var paragraphWidget = line.paragraph;\n            var left = paragraphWidget.x;\n            if (paragraphWidget.childWidgets.length > 0) {\n                var lineWidget = paragraphWidget.childWidgets[0];\n                left = this.getLeft(lineWidget);\n            }\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var size = this.getParagraphMarkSize(line.paragraph, topMargin, bottomMargin);\n            if (offset > 0) {\n                left += size.width;\n            }\n            return new Point(left, paragraphWidget.y + topMargin);\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = line.getInline(offset, indexInInline, line.paragraph.bidi);\n            var inline = inlineObj.element; //return indexInInline must\n            indexInInline = inlineObj.index;\n            // tslint:disable-next-line:max-line-length\n            // if (inline.length === indexInInline && !isNullOrUndefined(inline.nextNode) && this.viewer.renderedElements.containsKey(inline) &&\n            //     this.viewer.renderedElements.get(inline).length > 0 && this.viewer.renderedElements.containsKey(inline.nextNode as WInline)\n            //     && this.viewer.renderedElements.get(inline.nextNode as WInline).length > 0 &&\n            // tslint:disable-next-line:max-line-length\n            //     (this.viewer.renderedElements.get(inline)[this.viewer.renderedElements.get(inline).length - 1] as ElementBox).line !== (this.viewer.renderedElements.get(inline.nextNode as WInline)[0] as ElementBox).line) {\n            //     //Handled specifically to move the cursor at start of next line.\n            //     inline = inline.nextNode as WInline;\n            //     indexInInline = 0;\n            // }\n            return this.getPhysicalPositionInline(inline, indexInInline, moveNextLine);\n        }\n    };\n    /**\n     * Highlight selected content\n     * @private\n     */\n    Selection.prototype.highlightSelectedContent = function (start, end) {\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || (!start.paragraph.associatedCell.equals(end.paragraph.associatedCell))\n            || this.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            this.highlightCell(start.paragraph.associatedCell, this, start, end);\n        }\n        else {\n            var inline = undefined;\n            var index = 0;\n            if (!this.owner.isReadOnlyMode && start.paragraph === end.paragraph) {\n                if (start.offset + 1 === end.offset) {\n                    var inlineObj = end.currentWidget.getInline(end.offset, index);\n                    inline = inlineObj.element; // return index value\n                    index = inlineObj.index;\n                    if (inline instanceof ImageElementBox) {\n                        var startOffset = start.currentWidget.getOffset(inline, 0);\n                        if (startOffset !== start.offset) {\n                            inline = undefined;\n                        }\n                    }\n                }\n                else {\n                    var indexInInline = 0;\n                    var startInlineObj = start.currentWidget.getInline(start.offset, indexInInline);\n                    var startInline = startInlineObj.element; //return indexInInline\n                    indexInInline = startInlineObj.index;\n                    if (indexInInline === startInline.length) {\n                        startInline = this.getNextRenderedElementBox(startInline, indexInInline);\n                    }\n                    var endInlineObj = end.currentWidget.getInline(end.offset, indexInInline);\n                    var endInline = endInlineObj.element; //return indexInInline\n                    indexInInline = endInlineObj.index;\n                    // tslint:disable-next-line:max-line-length\n                    if (startInline instanceof FieldElementBox && endInline instanceof FieldElementBox && !isNullOrUndefined(startInline.fieldSeparator)) {\n                        var fieldValue = startInline.fieldSeparator.nextNode;\n                        if (fieldValue instanceof ImageElementBox && fieldValue.nextNode === endInline) {\n                            inline = fieldValue;\n                        }\n                    }\n                }\n            }\n            if (!this.owner.isReadOnlyMode && inline instanceof ImageElementBox && this.owner.isDocumentLoaded) {\n                var elementBoxObj = this.getElementBoxInternal(inline, index);\n                var elementBox = elementBoxObj.element; //return index \n                index = elementBoxObj.index;\n                if (this.owner.enableImageResizerMode) {\n                    this.owner.imageResizerModule.positionImageResizer(elementBox);\n                    this.owner.imageResizerModule.showImageResizer();\n                }\n                if (this.viewer.isTouchInput) {\n                    this.viewer.touchStart.style.display = 'none';\n                    this.viewer.touchEnd.style.display = 'none';\n                }\n            }\n            else {\n                this.highlight(start.paragraph, start, end);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Selection.prototype.highlight = function (paragraph, start, end) {\n        var selectionStartIndex = 0;\n        var selectionEndIndex = 0;\n        var startElement = undefined;\n        var endElement = undefined;\n        var startLineWidget = undefined;\n        var endLineWidget = undefined;\n        //return start Element and selection start index\n        var startLineObj = this.getStartLineWidget(paragraph, start, startElement, selectionStartIndex);\n        startElement = startLineObj.element;\n        if (isNullOrUndefined(startElement)) {\n            startLineWidget = paragraph.childWidgets[0];\n        }\n        else {\n            startLineWidget = startElement.line;\n        }\n        selectionStartIndex = startLineObj.index;\n        var endLineObj = this.getEndLineWidget(end, endElement, selectionEndIndex);\n        endElement = endLineObj.element;\n        if (endElement) {\n            endLineWidget = endElement.line;\n        }\n        else {\n            endLineWidget = end.paragraph.childWidgets[end.paragraph.childWidgets.length - 1];\n        }\n        selectionEndIndex = endLineObj.index;\n        var top = 0;\n        var left = 0;\n        if (!isNullOrUndefined(startLineWidget)) {\n            top = this.getTop(startLineWidget);\n            left = this.getLeftInternal(startLineWidget, startElement, selectionStartIndex);\n        }\n        if (!isNullOrUndefined(startLineWidget) && startLineWidget === endLineWidget) {\n            //Selection ends in current line.\n            var right = this.getLeftInternal(endLineWidget, endElement, selectionEndIndex);\n            var width = 0;\n            var isRtlText = false;\n            if (endElement instanceof TextElementBox) {\n                isRtlText = endElement.isRightToLeft;\n            }\n            if (!isRtlText && startElement instanceof TextElementBox) {\n                isRtlText = startElement.isRightToLeft;\n            }\n            width = Math.abs(right - left);\n            // Handled the highlighting approach as genric for normal and rtl text.\n            if (isRtlText || paragraph.bidi) {\n                var elementBoxCollection = this.getElementsForward(startLineWidget, startElement, endElement, paragraph.bidi);\n                if (elementBoxCollection && elementBoxCollection.length > 1) {\n                    for (var i = 0; i < elementBoxCollection.length; i++) {\n                        var element = elementBoxCollection[i];\n                        var elementIsRTL = false;\n                        var index = element instanceof TextElementBox ? element.length : 1;\n                        if (element === startElement) {\n                            left = this.getLeftInternal(startLineWidget, element, selectionStartIndex);\n                            right = this.getLeftInternal(startLineWidget, element, index);\n                        }\n                        else if (element === endElement) {\n                            left = this.getLeftInternal(startLineWidget, element, 0);\n                            right = this.getLeftInternal(startLineWidget, element, selectionEndIndex);\n                        }\n                        else {\n                            left = this.getLeftInternal(startLineWidget, element, 0);\n                            right = this.getLeftInternal(startLineWidget, element, index);\n                        }\n                        if (element instanceof TextElementBox) {\n                            elementIsRTL = element.isRightToLeft;\n                        }\n                        width = Math.abs(right - left);\n                        // Handled the paragraph mark highliting as special case.\n                        if (element === endElement && element instanceof TextElementBox\n                            && selectionEndIndex > element.length) {\n                            var charFormat = element.line.paragraph.characterFormat;\n                            var paragraphMarkWidth = this.viewer.textHelper.getParagraphMarkSize(charFormat).Width;\n                            if (elementIsRTL) {\n                                right += paragraphMarkWidth;\n                                // Paragrph and Selection ends in normal text\n                            }\n                            else if (paragraph.bidi) {\n                                width -= paragraphMarkWidth;\n                                // Highlight the element.\n                                this.createHighlightBorder(startLineWidget, width, left, top, true);\n                                // Highlight the paragraph mark of Bidi paragrph. \n                                left = this.getLineStartLeft(startLineWidget) - paragraphMarkWidth;\n                                this.createHighlightBorder(startLineWidget, paragraphMarkWidth, left, top, true);\n                                // continue to next element.\n                                continue;\n                            }\n                        }\n                        this.createHighlightBorder(startLineWidget, width, elementIsRTL ? right : left, top, true);\n                    }\n                }\n                else { // Need to handle the Paragraph mark highlighting.\n                    if (endElement instanceof TextElementBox && selectionEndIndex > endElement.length) {\n                        var charFormat = endElement.line.paragraph.characterFormat;\n                        var paragraphMarkWidth = this.viewer.textHelper.getParagraphMarkSize(charFormat).Width;\n                        // Since isRTLText is truo, so the right is considered as left\n                        if (!paragraph.bidi && isRtlText) {\n                            right += paragraphMarkWidth;\n                            width -= paragraphMarkWidth;\n                            // Highlight the element.\n                            this.createHighlightBorder(startLineWidget, width, right, top, true);\n                            // Highlight the paragraph mark. \n                            right += endElement.width;\n                            this.createHighlightBorder(startLineWidget, paragraphMarkWidth, right, top, true);\n                        }\n                        else if (paragraph.bidi && !isRtlText) {\n                            width -= paragraphMarkWidth;\n                            // Highlight the element.\n                            this.createHighlightBorder(startLineWidget, width, left, top, true);\n                            // Highlight the paragraph mark of Bidi paragrph. \n                            left = this.getLineStartLeft(startLineWidget) - paragraphMarkWidth;\n                            this.createHighlightBorder(startLineWidget, paragraphMarkWidth, left, top, true);\n                        }\n                        else {\n                            this.createHighlightBorder(startLineWidget, width, isRtlText ? right : left, top, false);\n                        }\n                    }\n                    else {\n                        this.createHighlightBorder(startLineWidget, width, isRtlText ? right : left, top, false);\n                    }\n                }\n            }\n            else {\n                // Start element and end element will be in reverese for Bidi paragraph highlighting. \n                // So, the right is considered based on Bidi property. \n                this.createHighlightBorder(startLineWidget, width, paragraph.bidi ? right : left, top, false);\n            }\n        }\n        else {\n            if (!isNullOrUndefined(startLineWidget)) {\n                var x = startLineWidget.paragraph.x;\n                if (paragraph !== startLineWidget.paragraph) {\n                    paragraph = startLineWidget.paragraph;\n                }\n                var width = this.getWidth(startLineWidget, true) - (left - startLineWidget.paragraph.x);\n                // Handled the  highlighting approach as genric for normal and rtl text.\n                if (paragraph.bidi || (startElement instanceof TextElementBox && startElement.isRightToLeft)) {\n                    var right = 0;\n                    // tslint:disable-next-line:max-line-length\n                    var elementCollection = this.getElementsForward(startLineWidget, startElement, endElement, paragraph.bidi);\n                    if (elementCollection) {\n                        var elementIsRTL = false;\n                        for (var i = 0; i < elementCollection.length; i++) {\n                            var element = elementCollection[i];\n                            elementIsRTL = false;\n                            if (element === startElement) {\n                                left = this.getLeftInternal(startLineWidget, element, selectionStartIndex);\n                            }\n                            else {\n                                left = this.getLeftInternal(startLineWidget, element, 0);\n                            }\n                            var index = element instanceof TextElementBox ? element.length : 1;\n                            right = this.getLeftInternal(startLineWidget, element, index);\n                            if (element instanceof TextElementBox) {\n                                elementIsRTL = element.isRightToLeft;\n                            }\n                            width = Math.abs(right - left);\n                            this.createHighlightBorder(startLineWidget, width, elementIsRTL ? right : left, top, true);\n                        }\n                        // Highlight the Paragrph mark for last line.\n                        if (startLineWidget.isLastLine()) {\n                            // tslint:disable-next-line:max-line-length\n                            var charFormat = elementCollection[elementCollection.length - 1].line.paragraph.characterFormat;\n                            var paragraphMarkWidth = this.viewer.textHelper.getParagraphMarkSize(charFormat).Width;\n                            if (paragraph.bidi) {\n                                // The paragraph mark will be at the left most end.\n                                left = this.getLineStartLeft(startLineWidget) - paragraphMarkWidth;\n                            }\n                            else { // The paragraph mark will at right most end.\n                                left = elementIsRTL ? startLineWidget.paragraph.x + this.getWidth(startLineWidget, false) : right;\n                            }\n                            this.createHighlightBorder(startLineWidget, paragraphMarkWidth, left, top, true);\n                        }\n                    }\n                    else {\n                        this.createHighlightBorder(startLineWidget, width, left, top, false);\n                    }\n                }\n                else {\n                    this.createHighlightBorder(startLineWidget, width, left, top, false);\n                }\n                var lineIndex = startLineWidget.paragraph.childWidgets.indexOf(startLineWidget);\n                //Iterates to last item of paragraph or selection end.                                             \n                this.highlightParagraph(paragraph, lineIndex + 1, endLineWidget, endElement, selectionEndIndex);\n                if (paragraph.childWidgets.indexOf(end.currentWidget) !== -1) {\n                    return;\n                }\n            }\n            this.highlightNextBlock(paragraph, start, end);\n        }\n    };\n    Selection.prototype.highlightNextBlock = function (paragraph, start, end) {\n        var block = paragraph.nextRenderedWidget;\n        if (!isNullOrUndefined(block)) {\n            if (block instanceof ParagraphWidget) {\n                this.highlight(block, start, end);\n            }\n            else {\n                this.highlightTable(block, start, end);\n            }\n        }\n    };\n    /**\n     * Get start line widget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getStartLineWidget = function (paragraph, start, startElement, selectionStartIndex) {\n        var offset = paragraph === start.paragraph ? start.offset : this.getStartOffset(paragraph);\n        var startInlineObj = undefined;\n        if (paragraph === start.paragraph) {\n            startInlineObj = start.currentWidget.getInline(offset, selectionStartIndex);\n        }\n        else {\n            startInlineObj = paragraph.firstChild.getInline(offset, selectionStartIndex);\n        }\n        startElement = startInlineObj.element; //return selectionStartIndex\n        selectionStartIndex = startInlineObj.index;\n        if (startElement instanceof FieldElementBox) {\n            var inlineInfo = this.getRenderedInline(startElement, selectionStartIndex);\n            startElement = inlineInfo.element;\n            selectionStartIndex = inlineInfo.index;\n        }\n        if (offset === this.getParagraphLength(start.paragraph) + 1) {\n            selectionStartIndex++;\n        }\n        return {\n            'index': selectionStartIndex, 'element': startElement\n        };\n    };\n    /**\n     * Get end line widget\n     * @private\n     */\n    Selection.prototype.getEndLineWidget = function (end, endElement, selectionEndIndex) {\n        var endInlineObj = end.currentWidget.getInline(end.offset, selectionEndIndex);\n        endElement = endInlineObj.element; //return selection end index\n        selectionEndIndex = endInlineObj.index;\n        if (endElement instanceof FieldElementBox) {\n            var inlineInfo = this.getRenderedInline(endElement, selectionEndIndex);\n            endElement = inlineInfo.element;\n            selectionEndIndex = inlineInfo.index;\n        }\n        var lineIndex = end.paragraph.childWidgets.indexOf(end.currentWidget);\n        if (lineIndex === end.paragraph.childWidgets.length - 1 && end.offset === this.getLineLength(end.currentWidget) + 1) {\n            selectionEndIndex = endElement ? endElement.length + 1 : 1;\n        }\n        return { 'index': selectionEndIndex, 'element': endElement };\n    };\n    /**\n     * Get line widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetInternal = function (line, offset, moveToNextLine) {\n        var lineWidget = undefined;\n        if (line.children.length === 0 && line instanceof LineWidget) {\n            lineWidget = line;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineInfo = line.getInline(offset, indexInInline);\n            var inline = inlineInfo.element;\n            indexInInline = inlineInfo.index;\n            lineWidget = inline instanceof ElementBox ? inline.line\n                : this.getLineWidgetInternalInline(inline, indexInInline, moveToNextLine);\n        }\n        return lineWidget;\n    };\n    /**\n     * Get last line widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetParagraph = function (offset, line) {\n        var linewidget = undefined;\n        if (line.children.length === 0) {\n            linewidget = line;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineInfo = line.getInline(offset, indexInInline);\n            var inline = inlineInfo.element;\n            indexInInline = inlineInfo.index;\n            linewidget = this.getLineWidget(inline, indexInInline);\n        }\n        return linewidget;\n    };\n    /**\n     * Highlight selected cell\n     * @private\n     */\n    /* tslint:disable */\n    // tslint:disable-next-line:max-line-length    \n    Selection.prototype.highlightCells = function (table, startCell, endCell) {\n        var start = this.getCellLeft(startCell.ownerRow, startCell);\n        var end = start + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        if (start > endCellLeft) {\n            start = endCellLeft;\n        }\n        if (end < endCellRight) {\n            end = endCellRight;\n        }\n        if (start > this.upDownSelectionLength) {\n            start = this.upDownSelectionLength;\n        }\n        if (end < this.upDownSelectionLength) {\n            end = this.upDownSelectionLength;\n        }\n        var tableWidgetCollection = table.getSplitWidgets();\n        var startTableIndex = tableWidgetCollection.indexOf(startCell.ownerRow.ownerTable);\n        var endTableIndex = tableWidgetCollection.indexOf(endCell.ownerRow.ownerTable);\n        if (startTableIndex === endTableIndex) {\n            var count = table.childWidgets.indexOf(endCell.ownerRow);\n            for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n                this.highlightRow(table.childWidgets[i], start, end);\n            }\n        }\n        else {\n            var startRowIndex = 0;\n            var endRowIndex = 0;\n            for (var i = startTableIndex; i <= endTableIndex; i++) {\n                table = tableWidgetCollection[i];\n                if (i === startTableIndex) {\n                    startRowIndex = table.childWidgets.indexOf(startCell.ownerRow);\n                }\n                else {\n                    startRowIndex = 0;\n                }\n                if (i === endTableIndex) {\n                    endRowIndex = table.childWidgets.indexOf(endCell.ownerRow);\n                }\n                else {\n                    endRowIndex = table.childWidgets.length - 1;\n                }\n                for (var j = startRowIndex; j <= endRowIndex; j++) {\n                    this.highlightRow(table.childWidgets[j], start, end);\n                }\n            }\n        }\n    };\n    /* tslint:enable */\n    /**\n     * highlight selected table\n     * @private\n     */\n    Selection.prototype.highlightTable = function (table, start, end) {\n        this.highlightInternal(table.childWidgets[0], start, end);\n        if (!end.paragraph.isInsideTable //Selection end is outside the table cell.\n            || !table.contains(end.paragraph.associatedCell)) { //Selection end is not inside the current table.\n            this.highlightNextBlock(table, start, end);\n        }\n    };\n    /**\n     * Get cell left\n     * @private\n     */\n    Selection.prototype.getCellLeft = function (row, cell) {\n        var left = 0;\n        left += cell.x - cell.margin.left;\n        return left;\n    };\n    /**\n     * Get next paragraph for row\n     * @private\n     */\n    Selection.prototype.getNextParagraphRow = function (row) {\n        if (!isNullOrUndefined(row.nextRenderedWidget)) {\n            var cell = row.nextRenderedWidget.childWidgets[0];\n            var block = cell.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return this.getNextParagraphBlock(row.ownerTable);\n    };\n    /**\n     * Get previous paragraph from row\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphRow = function (row) {\n        if (!isNullOrUndefined(row.previousRenderedWidget)) {\n            // tslint:disable-next-line:max-line-length\n            var cell = row.previousRenderedWidget.lastChild;\n            var block = cell.lastChild ? cell.lastChild : (cell.previousSplitWidget).lastChild;\n            return this.getLastParagraphBlock(block);\n        }\n        return this.getPreviousParagraphBlock(row.ownerTable);\n    };\n    /**\n     * Return true if row contain cell\n     * @private\n     */\n    Selection.prototype.containsRow = function (row, tableCell) {\n        if (row.childWidgets.indexOf(tableCell) !== -1) {\n            return true;\n        }\n        while (tableCell.ownerTable.isInsideTable) {\n            if (row.childWidgets.indexOf(tableCell) !== -1) {\n                return true;\n            }\n            tableCell = tableCell.ownerTable.associatedCell;\n        }\n        return row.childWidgets.indexOf(tableCell) !== -1;\n    };\n    /**\n     * Highlight selected row\n     * @private\n     */\n    Selection.prototype.highlightRow = function (row, start, end) {\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var left = this.getCellLeft(row, row.childWidgets[i]);\n            if (HelperMethods.round(start, 2) <= HelperMethods.round(left, 2) &&\n                HelperMethods.round(left, 2) < HelperMethods.round(end, 2)) {\n                this.highlightCellWidget(row.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.highlightInternal = function (row, start, end) {\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            this.highlightCellWidget(row.childWidgets[i]);\n        }\n        if (end.paragraph.isInsideTable && this.containsRow(row, end.paragraph.associatedCell)) {\n            return;\n        }\n        else if (row.nextRenderedWidget instanceof TableRowWidget) {\n            this.highlightInternal(row.nextRenderedWidget, start, end);\n        }\n    };\n    /**\n     * Get last paragraph in cell\n     * @private\n     */\n    Selection.prototype.getLastParagraph = function (cell) {\n        while (cell.nextSplitWidget) {\n            if (cell.nextSplitWidget.childWidgets.length > 0) {\n                cell = cell.nextSplitWidget;\n            }\n            else {\n                break;\n            }\n        }\n        var lastBlock;\n        if (cell.childWidgets.length > 0) {\n            lastBlock = cell.lastChild;\n        }\n        else {\n            lastBlock = cell.previousSplitWidget.lastChild;\n        }\n        return this.getLastParagraphBlock(lastBlock);\n    };\n    /**\n     * Return true is source cell contain cell\n     * @private\n     */\n    Selection.prototype.containsCell = function (sourceCell, cell) {\n        if (sourceCell.equals(cell)) {\n            return true;\n        }\n        while (cell.ownerTable.isInsideTable) {\n            if (sourceCell.equals(cell.ownerTable.associatedCell)) {\n                return true;\n            }\n            cell = cell.ownerTable.associatedCell;\n        }\n        return false;\n    };\n    /**\n     * Return true if cell is selected\n     * @private\n     */\n    Selection.prototype.isCellSelected = function (cell, startPosition, endPosition) {\n        var lastParagraph = this.getLastParagraph(cell);\n        // tslint:disable-next-line:max-line-length\n        var isAtCellEnd = lastParagraph === endPosition.paragraph && endPosition.offset === this.getParagraphLength(lastParagraph) + 1;\n        return isAtCellEnd || (!this.containsCell(cell, startPosition.paragraph.associatedCell) ||\n            !this.containsCell(cell, endPosition.paragraph.associatedCell));\n    };\n    /**\n     * Return Container cell\n     * @private\n     */\n    Selection.prototype.getContainerCellOf = function (cell, tableCell) {\n        while (cell.ownerTable.isInsideTable) {\n            if (cell.ownerTable.contains(tableCell)) {\n                return cell;\n            }\n            cell = cell.ownerTable.associatedCell;\n        }\n        return cell;\n    };\n    /**\n     * Get Selected cell\n     * @private\n     */\n    Selection.prototype.getSelectedCell = function (cell, containerCell) {\n        if (cell.ownerTable.equals(containerCell.ownerTable)) {\n            return cell;\n        }\n        while (cell.ownerTable.isInsideTable) {\n            if (cell.ownerTable.associatedCell.equals(containerCell)) {\n                return cell;\n            }\n            cell = cell.ownerTable.associatedCell;\n        }\n        return cell;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getSelectedCells = function () {\n        var cells = [];\n        for (var i = 0; i < this.selectedWidgets.keys.length; i++) {\n            var widget = this.selectedWidgets.keys[i];\n            if (widget instanceof TableCellWidget) {\n                cells.push(widget);\n            }\n        }\n        return cells;\n    };\n    /**\n     * Get Next paragraph from cell\n     * @private\n     */\n    Selection.prototype.getNextParagraphCell = function (cell) {\n        if (cell.nextRenderedWidget && cell.nextRenderedWidget instanceof TableCellWidget) {\n            //Return first paragraph in cell.            \n            cell = cell.nextRenderedWidget;\n            var block = cell.firstChild;\n            if (block) {\n                return this.getFirstParagraphBlock(block);\n            }\n            else {\n                return this.getNextParagraphCell(cell);\n            }\n        }\n        return this.getNextParagraphRow(cell.containerWidget);\n    };\n    /**\n     * Get previous paragraph from cell\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphCell = function (cell) {\n        if (!isNullOrUndefined(cell.previousRenderedWidget) && cell.previousRenderedWidget instanceof TableCellWidget) {\n            cell = cell.previousRenderedWidget;\n            var block = cell.lastChild;\n            return this.getLastParagraphBlock(block);\n        }\n        return this.getPreviousParagraphRow(cell.ownerRow);\n    };\n    /**\n     * Get cell's container cell\n     * @private\n     */\n    Selection.prototype.getContainerCell = function (cell) {\n        while (!isNullOrUndefined(cell.ownerTable) && cell.ownerTable.isInsideTable) {\n            cell = cell.ownerTable.associatedCell;\n        }\n        return cell;\n    };\n    /**\n     * Highlight selected cell\n     * @private\n     */\n    /* tslint:disable */\n    Selection.prototype.highlightCell = function (cell, selection, start, end) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = this.getContainerCellOf(cell, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(cell, containerCell);\n                var endCell = this.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    /* tslint:enable */\n                    //Selection end is in container cell.\n                    if (this.isCellSelected(containerCell, start, end)) {\n                        this.highlightCellWidget(containerCell);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.highlight(start.paragraph, start, end);\n                        }\n                        else {\n                            this.highlightContainer(startCell, start, end);\n                        }\n                    }\n                }\n                else {\n                    //Selection end is not in container cell.\n                    this.highlightCellWidget(containerCell);\n                    if (containerCell.ownerRow.equals(endCell.ownerRow)) {\n                        //Highlight other selected cells in current row.\n                        startCell = containerCell;\n                        while (!isNullOrUndefined(startCell.nextRenderedWidget)) {\n                            startCell = startCell.nextRenderedWidget;\n                            this.highlightCellWidget(startCell);\n                            if (startCell === endCell) {\n                                break;\n                            }\n                        }\n                    }\n                    else {\n                        this.highlightCells(containerCell.ownerTable, containerCell, endCell);\n                    }\n                }\n            }\n            else {\n                this.highlightContainer(containerCell, start, end);\n            }\n        }\n        else {\n            var cell1 = this.getContainerCell(cell);\n            this.highlightContainer(cell1, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.highlightContainer = function (cell, start, end) {\n        this.highlightInternal(cell.containerWidget, start, end);\n        this.highlightNextBlock(cell.ownerTable, start, end);\n    };\n    /**\n     * Get previous valid element\n     * @private\n     */\n    Selection.prototype.getPreviousValidElement = function (inline) {\n        var previousValidInline = undefined;\n        while (inline instanceof FieldElementBox) {\n            if (HelperMethods.isLinkedFieldCharacter(inline)) {\n                if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n                    previousValidInline = inline;\n                }\n                else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    previousValidInline = inline;\n                    if (isNullOrUndefined(inline.fieldSeparator)) {\n                        inline = inline.fieldBegin;\n                        previousValidInline = inline;\n                    }\n                }\n                else {\n                    inline = inline.fieldBegin;\n                    previousValidInline = inline;\n                }\n            }\n            inline = inline.previousNode;\n        }\n        return isNullOrUndefined(previousValidInline) ? inline : previousValidInline;\n    };\n    /**\n     * Get next valid element\n     * @private\n     */\n    Selection.prototype.getNextValidElement = function (inline) {\n        var nextValidInline = undefined;\n        while (inline instanceof FieldElementBox) {\n            if (inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd)) {\n                return isNullOrUndefined(nextValidInline) ? inline : nextValidInline;\n            }\n            else if (inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n                nextValidInline = inline;\n            }\n            inline = inline.nextNode;\n        }\n        return (isNullOrUndefined(nextValidInline) ? inline : nextValidInline);\n    };\n    /**\n     * Return next valid inline with index\n     * @private\n     */\n    Selection.prototype.validateTextPosition = function (inline, index) {\n        if (inline.length === index && inline.nextNode instanceof FieldElementBox) {\n            //If inline is last item within field, then set field end as text position.\n            var nextInline = this.getNextValidElement(inline.nextNode);\n            if (nextInline instanceof FieldElementBox && nextInline.fieldType === 1) {\n                inline = nextInline;\n                index = 1;\n            }\n        }\n        else if (index === 0 && inline.previousNode instanceof FieldElementBox) {\n            var prevInline = this.getPreviousValidElement(inline.previousNode);\n            inline = prevInline;\n            index = inline instanceof FieldElementBox ? 0 : inline.length;\n            if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n                index++;\n            }\n        }\n        return { 'element': inline, 'index': index };\n    };\n    /**\n     * Get inline physical location\n     * @private\n     */\n    Selection.prototype.getPhysicalPositionInline = function (inline, index, moveNextLine) {\n        var element = undefined;\n        element = this.getElementBox(inline, index, moveNextLine).element;\n        var lineWidget = undefined;\n        if (isNullOrUndefined(element) || isNullOrUndefined(element.line)) {\n            if (inline instanceof FieldElementBox || inline instanceof BookmarkElementBox) {\n                return this.getFieldCharacterPosition(inline);\n            }\n            return new Point(0, 0);\n        }\n        var margin = element.margin;\n        var top = 0;\n        var left = 0;\n        if (element instanceof TextElementBox && element.text === '\\v' && isNullOrUndefined(inline.nextNode)) {\n            lineWidget = this.getNextLineWidget(element.line.paragraph, element);\n            index = 0;\n        }\n        else {\n            lineWidget = element.line;\n        }\n        top = this.getTop(lineWidget);\n        if (element instanceof ImageElementBox) {\n            var format = element.line.paragraph.characterFormat;\n            var previousInline = this.getPreviousTextElement(inline);\n            if (!isNullOrUndefined(previousInline)) {\n                format = previousInline.characterFormat;\n            }\n            else {\n                var nextInline = this.getNextTextElement(inline);\n                if (!isNullOrUndefined(nextInline)) {\n                    format = nextInline.characterFormat;\n                }\n            }\n            var measureObj = this.viewer.textHelper.getHeight(format);\n            if (element.margin.top + element.height - measureObj.BaselineOffset > 0) {\n                top += element.margin.top + element.height - measureObj.BaselineOffset;\n            }\n        }\n        else if (!(element instanceof FieldElementBox)) {\n            top += margin.top > 0 ? margin.top : 0;\n        }\n        left = (isNullOrUndefined(element) || isNullOrUndefined(lineWidget)) ? 0 : this.getLeftInternal(lineWidget, element, index);\n        return new Point(left, top);\n    };\n    /**\n     * Get field character position\n     * @private\n     */\n    Selection.prototype.getFieldCharacterPosition = function (firstInline) {\n        var nextValidInline = this.getNextValidElementForField(firstInline);\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            var nextParagraph = firstInline.line.paragraph;\n            return this.getEndPosition(nextParagraph);\n        }\n        else {\n            return this.getPhysicalPositionInline(nextValidInline, 0, true);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextValidElementForField = function (firstInline) {\n        if (firstInline instanceof FieldElementBox && firstInline.fieldType === 0\n            && HelperMethods.isLinkedFieldCharacter(firstInline)) {\n            var fieldBegin = firstInline;\n            if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                firstInline = fieldBegin.fieldEnd;\n            }\n            else {\n                firstInline = fieldBegin.fieldSeparator;\n            }\n        }\n        var nextValidInline = undefined;\n        if (!isNullOrUndefined(firstInline.nextNode)) {\n            nextValidInline = this.getNextValidElement(firstInline.nextNode);\n        }\n        return nextValidInline;\n    };\n    /**\n     * Get paragraph end position\n     * @private\n     */\n    Selection.prototype.getEndPosition = function (widget) {\n        var left = widget.x;\n        var top = widget.y;\n        var lineWidget = undefined;\n        if (widget.childWidgets.length > 0) {\n            lineWidget = widget.childWidgets[widget.childWidgets.length - 1];\n            left += this.getWidth(lineWidget, false);\n        }\n        if (!isNullOrUndefined(lineWidget)) {\n            top = this.getTop(lineWidget);\n        }\n        var topMargin = 0;\n        var bottomMargin = 0;\n        var size = this.getParagraphMarkSize(widget, topMargin, bottomMargin);\n        return new Point(left, top + size.topMargin);\n    };\n    /**\n     * Get element box\n     * @private\n     */\n    Selection.prototype.getElementBox = function (currentInline, index, moveToNextLine) {\n        var elementBox = undefined;\n        if (!(currentInline instanceof FieldElementBox || currentInline instanceof BookmarkElementBox)) {\n            elementBox = currentInline;\n        }\n        return { 'element': elementBox, 'index': index };\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousTextElement = function (inline) {\n        if (inline.previousNode instanceof TextElementBox) {\n            return inline.previousNode;\n        }\n        if (!isNullOrUndefined(inline.previousNode)) {\n            return this.getPreviousTextElement(inline.previousNode);\n        }\n        return undefined;\n    };\n    /**\n     * Get next text inline\n     * @private\n     */\n    Selection.prototype.getNextTextElement = function (inline) {\n        if (inline.nextNode instanceof TextElementBox) {\n            return inline.nextNode;\n        }\n        if (!isNullOrUndefined(inline.nextNode)) {\n            return this.getNextTextElement(inline.nextNode);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextRenderedElementBox = function (inline, indexInInline) {\n        if (inline instanceof FieldElementBox) {\n            var fieldBegin = inline;\n            if (fieldBegin.fieldType === 0) {\n                inline = this.getRenderedField(fieldBegin);\n                if (fieldBegin === inline) {\n                    return fieldBegin;\n                }\n            }\n            indexInInline = 1;\n        }\n        while (!isNullOrUndefined(inline) && indexInInline === inline.length && inline.nextNode instanceof FieldElementBox) {\n            var nextValidInline = this.getNextValidElement((inline.nextNode));\n            if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 0) {\n                var fieldBegin = nextValidInline;\n                inline = this.getRenderedField(fieldBegin);\n                if (!isNullOrUndefined(inline) && fieldBegin === inline) {\n                    return fieldBegin;\n                }\n                indexInInline = 1;\n            }\n            else {\n                inline = nextValidInline;\n            }\n        }\n        return inline;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getElementBoxInternal = function (inline, index) {\n        var element = undefined;\n        element = inline;\n        return {\n            'element': element, 'index': index\n        };\n    };\n    /**\n     * Get Line widget\n     * @private\n     */\n    Selection.prototype.getLineWidget = function (inline, index) {\n        return this.getLineWidgetInternalInline(inline, index, true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getLineWidgetInternalInline = function (inline, index, moveToNextLine) {\n        var elementObj = this.getElementBox(inline, index, moveToNextLine);\n        var element = elementObj.element; //return index\n        index = elementObj.index;\n        if (!isNullOrUndefined(element)) {\n            if (moveToNextLine && element instanceof TextElementBox && element.text === '\\v' && index === 1) {\n                return this.getNextLineWidget(element.line.paragraph, element);\n            }\n            else {\n                return element.line;\n            }\n        }\n        var startInline = inline;\n        //ToDo: Check previous inline here.\n        var nextValidInline = this.getNextValidElementForField(startInline);\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            var lineWidget = undefined;\n            var widget = startInline.line.paragraph;\n            if (widget.childWidgets.length > 0) {\n                lineWidget = widget.childWidgets[widget.childWidgets.length - 1];\n            }\n            return lineWidget;\n        }\n        else {\n            return this.getLineWidget(nextValidInline, 0);\n        }\n    };\n    /**\n     * Get next line widget\n     * @private\n     */\n    Selection.prototype.getNextLineWidget = function (paragraph, element) {\n        var lineWidget = undefined;\n        var widget = paragraph;\n        if (widget.childWidgets.length > 0) {\n            var widgetIndex = widget.childWidgets.indexOf(element.line);\n            if (widgetIndex === widget.childWidgets.length - 1) {\n                widget = paragraph;\n                // widget = paragraph.leafWidgets[paragraph.leafWidgets.length - 1];\n                widgetIndex = -1;\n            }\n            else if (widgetIndex > widget.childWidgets.length - 1) {\n                widget = this.getNextParagraphBlock(paragraph);\n                widgetIndex = -1;\n            }\n            else if (widgetIndex < 0) {\n                // widget = paragraph.leafWidgets[paragraph.leafWidgets.length - 1];\n                widget = paragraph;\n                widgetIndex = widget.childWidgets.indexOf(element.line);\n            }\n            lineWidget = widget.childWidgets[widgetIndex + 1];\n        }\n        return lineWidget;\n    };\n    /**\n     * Get Caret height\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getCaretHeight = function (inline, index, format, isEmptySelection, topMargin, isItalic) {\n        var elementBoxInfo = this.getElementBox(inline, index, false);\n        var element = elementBoxInfo.element;\n        var currentInline = inline;\n        if (isNullOrUndefined(element)) {\n            if (currentInline instanceof FieldElementBox) {\n                return this.getFieldCharacterHeight(currentInline, format, isEmptySelection, topMargin, isItalic);\n            }\n            return { 'height': this.viewer.textHelper.getHeight(format).Height, 'topMargin': topMargin, 'isItalic': isItalic };\n        }\n        var margin = element.margin;\n        var heightElement = element.height;\n        var maxLineHeight = 0;\n        if (element instanceof ImageElementBox) {\n            var previousInline = this.getPreviousTextElement(inline);\n            var nextInline = this.getNextTextElement(inline);\n            if (isNullOrUndefined(previousInline) && isNullOrUndefined(nextInline)) {\n                var top_2 = 0;\n                var bottom = 0;\n                var paragarph = inline.line.paragraph;\n                var sizeInfo = this.getParagraphMarkSize(paragarph, top_2, bottom);\n                top_2 = sizeInfo.topMargin;\n                bottom = sizeInfo.bottomMargin;\n                maxLineHeight = sizeInfo.height;\n                isItalic = paragarph.characterFormat.italic;\n                if (!isEmptySelection) {\n                    maxLineHeight += paragarph.paragraphFormat.afterSpacing;\n                }\n            }\n            else if (isNullOrUndefined(previousInline)) {\n                isItalic = nextInline.characterFormat.italic;\n                return this.getCaretHeight(nextInline, 0, nextInline.characterFormat, isEmptySelection, topMargin, isItalic);\n            }\n            else {\n                if (!isNullOrUndefined(nextInline) && element instanceof ImageElementBox) {\n                    //Calculates the caret size using image character format.\n                    var textSizeInfo = this.viewer.textHelper.getHeight(element.characterFormat);\n                    var charHeight = textSizeInfo.Height;\n                    var baselineOffset = textSizeInfo.BaselineOffset;\n                    // tslint:disable-next-line:max-line-length\n                    maxLineHeight = (element.margin.top < 0 && baselineOffset > element.margin.top + element.height) ? element.margin.top + element.height + charHeight - baselineOffset : charHeight;\n                    if (!isEmptySelection) {\n                        maxLineHeight += element.margin.bottom;\n                    }\n                }\n                else {\n                    isItalic = previousInline.characterFormat.italic;\n                    // tslint:disable-next-line:max-line-length\n                    return this.getCaretHeight(previousInline, previousInline.length, previousInline.characterFormat, isEmptySelection, topMargin, isItalic);\n                }\n            }\n        }\n        else {\n            var baselineAlignment = format.baselineAlignment;\n            var elementHeight = heightElement;\n            if (baselineAlignment !== 'Normal' && isEmptySelection) {\n                //Set the caret height as sub/super script text height and updates the top margin for sub script text.\n                elementHeight = elementHeight / 1.5;\n                if (baselineAlignment === 'Subscript') {\n                    topMargin = heightElement - elementHeight;\n                }\n            }\n            maxLineHeight = (margin.top < 0 ? margin.top : 0) + elementHeight;\n            if (!isEmptySelection) {\n                maxLineHeight += margin.bottom;\n            }\n        }\n        if (!isEmptySelection) {\n            return { 'height': maxLineHeight, 'topMargin': topMargin, 'isItalic': isItalic };\n        }\n        var height = this.viewer.textHelper.getHeight(format).Height;\n        if (height > maxLineHeight) {\n            height = maxLineHeight;\n        }\n        return { 'height': height, 'topMargin': topMargin, 'isItalic': isItalic };\n    };\n    /**\n     * Get field characters height\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getFieldCharacterHeight = function (startInline, format, isEmptySelection, topMargin, isItalic) {\n        var nextValidInline = this.getNextValidElementForField(startInline);\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            var nextParagraph = startInline.line.paragraph;\n            var height = this.viewer.textHelper.getParagraphMarkSize(format).Height;\n            var top_3 = 0;\n            var bottom = 0;\n            var sizeInfo = this.getParagraphMarkSize(nextParagraph, top_3, bottom);\n            var maxLineHeight = sizeInfo.height;\n            top_3 = sizeInfo.topMargin;\n            bottom = sizeInfo.bottomMargin;\n            if (!isEmptySelection) {\n                maxLineHeight += bottom;\n                return { 'height': maxLineHeight, 'topMargin': topMargin, 'isItalic': isItalic };\n            }\n            if (height > maxLineHeight) {\n                height = maxLineHeight;\n            }\n            return { 'height': height, 'topMargin': topMargin, 'isItalic': isItalic };\n        }\n        else {\n            return this.getCaretHeight(nextValidInline, 0, format, isEmptySelection, topMargin, isItalic);\n        }\n    };\n    /**\n     * Get rendered inline\n     * @private\n     */\n    //FieldCharacter\n    Selection.prototype.getRenderedInline = function (inline, inlineIndex) {\n        var prevInline = this.getPreviousValidElement(inline);\n        while (prevInline instanceof FieldElementBox) {\n            prevInline = this.getPreviousTextElement(prevInline);\n            if (prevInline instanceof FieldElementBox) {\n                prevInline = prevInline.previousNode;\n            }\n        }\n        if (!isNullOrUndefined(prevInline)) {\n            inlineIndex = prevInline.length;\n            return { 'element': prevInline, 'index': inlineIndex };\n        }\n        inlineIndex = 0;\n        var nextInline = this.getNextRenderedElementBox(inline, 0);\n        if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0) {\n            nextInline = nextInline.fieldSeparator;\n            nextInline = nextInline.nextNode;\n            while (nextInline instanceof FieldElementBox) {\n                if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0\n                    && HelperMethods.isLinkedFieldCharacter(nextInline)) {\n                    if (isNullOrUndefined(nextInline.fieldSeparator)) {\n                        nextInline = nextInline.fieldEnd;\n                    }\n                    else {\n                        nextInline = nextInline.fieldSeparator;\n                    }\n                }\n                nextInline = nextInline.nextNode;\n            }\n        }\n        return { 'element': nextInline, 'index': inlineIndex };\n    };\n    //Field Begin\n    /**\n     * Get rendered field\n     * @private\n     */\n    Selection.prototype.getRenderedField = function (fieldBegin) {\n        var inline = fieldBegin;\n        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            inline = fieldBegin.fieldEnd;\n        }\n        else {\n            inline = fieldBegin.fieldSeparator;\n            var paragraph = inline.line.paragraph;\n            if (paragraph === fieldBegin.fieldEnd.line.paragraph\n                && !this.hasValidInline(paragraph, inline, fieldBegin.fieldEnd)) {\n                inline = fieldBegin.fieldEnd;\n            }\n            else {\n                return inline;\n            }\n        }\n        return inline;\n    };\n    /**\n     * Return true is inline is tha last inline\n     * @private\n     */\n    Selection.prototype.isLastRenderedInline = function (inline, index) {\n        while (index === inline.length && inline.nextNode instanceof FieldElementBox) {\n            var nextValidInline = this.getNextValidElement(inline.nextNode);\n            index = 0;\n            if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 0) {\n                inline = nextValidInline;\n            }\n            if (inline instanceof FieldElementBox && inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd)) {\n                var fieldBegin = inline;\n                if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    inline = fieldBegin.fieldEnd;\n                    index = 1;\n                }\n                else {\n                    inline = fieldBegin.fieldSeparator;\n                    var paragraph = inline.line.paragraph;\n                    index = 1;\n                    if (paragraph === fieldBegin.fieldEnd.line.paragraph\n                        && !this.hasValidInline(paragraph, inline, fieldBegin.fieldEnd)) {\n                        inline = fieldBegin.fieldEnd;\n                    }\n                    else {\n                        break;\n                    }\n                }\n            }\n        }\n        return index === inline.length && isNullOrUndefined(inline.nextNode);\n    };\n    /**\n     * Get page\n     * @private\n     */\n    Selection.prototype.getPage = function (widget) {\n        var page = undefined;\n        if (widget.containerWidget instanceof BlockContainer) {\n            var bodyWidget = widget.containerWidget;\n            page = widget.containerWidget.page;\n        }\n        else if (!isNullOrUndefined(widget.containerWidget)) {\n            page = this.getPage(widget.containerWidget);\n        }\n        return page;\n    };\n    /**\n     * Clear Selection highlight\n     * @private\n     */\n    Selection.prototype.clearSelectionHighlightInSelectedWidgets = function () {\n        var isNonEmptySelection = false;\n        var widgets = this.selectedWidgets.keys;\n        for (var i = 0; i < widgets.length; i++) {\n            this.removeSelectionHighlight(widgets[i]);\n            isNonEmptySelection = true;\n        }\n        this.selectedWidgets.clear();\n        return isNonEmptySelection;\n    };\n    /**\n     * Clear selection highlight\n     * @private\n     */\n    Selection.prototype.clearChildSelectionHighlight = function (widget) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            if (widget.childWidgets[i] instanceof LineWidget) {\n                this.clearSelectionHighlightLineWidget(widget.childWidgets[i]);\n            }\n            else if (widget.childWidgets[i] instanceof TableCellWidget) {\n                this.clearSelectionHighlight(widget.childWidgets[i]);\n            }\n            else if (widget.childWidgets[i] instanceof Widget) {\n                this.clearChildSelectionHighlight(widget.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * Get line widget from paragraph widget\n     * @private\n     */\n    //Body Widget\n    Selection.prototype.getLineWidgetBodyWidget = function (widget, point) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var childWidget = widget.childWidgets[i];\n            if (childWidget instanceof Widget && childWidget.y <= point.y\n                && (childWidget.y + childWidget.height) >= point.y) {\n                if (childWidget instanceof ParagraphWidget) {\n                    return this.getLineWidgetParaWidget(childWidget, point);\n                }\n                else {\n                    return this.getLineWidgetTableWidget(childWidget, point);\n                }\n            }\n        }\n        var line = undefined;\n        if (widget.childWidgets.length > 0) {\n            var firstChild = widget.childWidgets[0];\n            if (firstChild instanceof Widget && firstChild.y <= point.y) {\n                if (widget.childWidgets[widget.childWidgets.length - 1] instanceof ParagraphWidget) {\n                    // tslint:disable-next-line:max-line-length\n                    line = this.getLineWidgetParaWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    line = this.getLineWidgetTableWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n                }\n            }\n            else {\n                var childWidget = undefined;\n                if (firstChild instanceof Widget) {\n                    childWidget = firstChild;\n                }\n                if (!isNullOrUndefined(childWidget)) {\n                    if (childWidget instanceof ParagraphWidget) {\n                        line = this.getLineWidgetParaWidget(firstChild, point);\n                    }\n                    else {\n                        line = this.getLineWidgetTableWidget(firstChild, point);\n                    }\n                }\n            }\n        }\n        return line;\n    };\n    //ParagraphWidget\n    /**\n     * Get line widget from paragraph widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetParaWidget = function (widget, point) {\n        var childWidgets = widget.childWidgets;\n        var top = widget.y;\n        for (var i = 0; i < childWidgets.length; i++) {\n            if (top <= point.y\n                && (top + childWidgets[i].height) >= point.y) {\n                return childWidgets[i];\n            }\n            top += childWidgets[i].height;\n        }\n        var lineWidget = undefined;\n        if (childWidgets.length > 0) {\n            if (widget.y <= point.y) {\n                lineWidget = childWidgets[childWidgets.length - 1];\n            }\n            else {\n                lineWidget = childWidgets[0];\n            }\n        }\n        return lineWidget;\n    };\n    /**\n     * highlight paragraph widget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.highlightParagraph = function (widget, startIndex, endLine, endElement, endIndex) {\n        var top = 0;\n        var width = 0;\n        var isRtlText = false;\n        for (var i = startIndex; i < widget.childWidgets.length; i++) {\n            var line = widget.childWidgets[i];\n            if (i === startIndex) {\n                top = this.getTop(line);\n            }\n            if (endElement instanceof TextElementBox) {\n                isRtlText = endElement.isRightToLeft;\n            }\n            var left = this.getLeft(line);\n            if (line === endLine) {\n                //Selection ends in current line.\n                var right = 0;\n                // highlighting approach for normal and rtl text.\n                if (isRtlText || widget.bidi) {\n                    var elementBoxCollection = this.getElementsBackward(line, endElement, endElement, widget.bidi);\n                    for (var i_2 = 0; i_2 < elementBoxCollection.length; i_2++) {\n                        var element = elementBoxCollection[i_2];\n                        var elementIsRTL = false;\n                        if (element === endElement) {\n                            right = this.getLeftInternal(line, element, endIndex);\n                        }\n                        else {\n                            var index = element instanceof TextElementBox ? element.length : 1;\n                            right = this.getLeftInternal(line, element, index);\n                        }\n                        left = this.getLeftInternal(line, element, 0);\n                        if (element instanceof TextElementBox) {\n                            elementIsRTL = element.isRightToLeft;\n                        }\n                        width = Math.abs(right - left);\n                        // Handled the paragraph mark highliting as special case.\n                        if (element === endElement && element instanceof TextElementBox && endIndex > element.length) {\n                            // tslint:disable-next-line:max-line-length\n                            var paragraphMarkWidth = this.viewer.textHelper.getParagraphMarkSize(element.line.paragraph.characterFormat).Width;\n                            if (!widget.bidi && elementIsRTL) {\n                                right += paragraphMarkWidth;\n                            }\n                            else if (widget.bidi && !elementIsRTL) { // Paragrph and Selection ends in normal text\n                                width -= paragraphMarkWidth;\n                                // Highlight the element.\n                                this.createHighlightBorder(line, width, left, top, true);\n                                // Highlight the paragraph mark of Bidi paragrph. \n                                left = this.getLineStartLeft(line) - paragraphMarkWidth;\n                                this.createHighlightBorder(line, paragraphMarkWidth, left, top, true);\n                                // continue to next element.\n                                continue;\n                            }\n                        }\n                        this.createHighlightBorder(line, width, elementIsRTL ? right : left, top, true);\n                    }\n                    return;\n                }\n                else {\n                    right = this.getLeftInternal(endLine, endElement, endIndex);\n                    width = Math.abs(right - left);\n                    this.createHighlightBorder(line, width, isRtlText ? right : left, top, false);\n                    return;\n                }\n            }\n            else {\n                width = this.getWidth(line, true) - (left - widget.x);\n                // Highlight the paragrph mark for Bidi paragrph.\n                if (widget.bidi && line.isLastLine()) {\n                    left -= this.viewer.textHelper.getParagraphMarkSize(widget.characterFormat).Width;\n                }\n                this.createHighlightBorder(line, width, left, top, false);\n                top += line.height;\n            }\n        }\n    };\n    //Table Widget\n    /**\n     * Get line widget form table widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetTableWidget = function (widget, point) {\n        var lineWidget = undefined;\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            //Removed the height condition check to handle the vertically merged cells.\n            var childWidget = widget.childWidgets[i];\n            if (childWidget instanceof TableRowWidget && childWidget.y <= point.y) {\n                lineWidget = this.getLineWidgetRowWidget(childWidget, point);\n                var cellWidget = undefined;\n                if (!isNullOrUndefined(lineWidget) && lineWidget.paragraph.containerWidget instanceof TableCellWidget) {\n                    cellWidget = lineWidget.paragraph.containerWidget;\n                }\n                var cellSpacing = 0;\n                var rowSpan = 0;\n                if (!isNullOrUndefined(cellWidget)) {\n                    var tableWidget = cellWidget.ownerRow.containerWidget;\n                    cellSpacing = HelperMethods.convertPointToPixel(tableWidget.tableFormat.cellSpacing);\n                    rowSpan = cellWidget.cellFormat.rowSpan;\n                }\n                var leftCellSpacing = 0;\n                var rightCellSpacing = 0;\n                var topCellSpacing = 0;\n                var bottomCellSpacing = 0;\n                if (cellSpacing > 0) {\n                    leftCellSpacing = cellWidget.cellIndex === 0 ? cellSpacing : cellSpacing / 2;\n                    // tslint:disable-next-line:max-line-length\n                    rightCellSpacing = cellWidget.cellIndex === cellWidget.ownerRow.childWidgets.length - 1 ? cellSpacing : cellSpacing / 2;\n                    var rowWidget = undefined;\n                    if (cellWidget.containerWidget instanceof TableRowWidget) {\n                        rowWidget = cellWidget.containerWidget;\n                    }\n                    var tableWidget = undefined;\n                    if (cellWidget.containerWidget.containerWidget instanceof TableWidget) {\n                        tableWidget = cellWidget.containerWidget.containerWidget;\n                    }\n                    if (!isNullOrUndefined(rowWidget) && !isNullOrUndefined(tableWidget)) {\n                        topCellSpacing = cellWidget.ownerRow.rowIndex === 0 ? cellSpacing : cellSpacing / 2;\n                        if (cellWidget.ownerRow.rowIndex + rowSpan === cellWidget.ownerTable.childWidgets.length) {\n                            bottomCellSpacing = cellSpacing;\n                        }\n                        else {\n                            bottomCellSpacing = cellSpacing / 2;\n                        }\n                    }\n                }\n                if ((!isNullOrUndefined(lineWidget) && lineWidget.paragraph.x <= point.x\n                    && lineWidget.paragraph.x + lineWidget.width >= point.x\n                    && lineWidget.paragraph.y <= point.y && this.getTop(lineWidget) + lineWidget.height >= point.y)\n                    || (!isNullOrUndefined(cellWidget) && cellWidget.x - cellWidget.margin.left - leftCellSpacing <= point.x\n                        && cellWidget.x + cellWidget.width + cellWidget.margin.right + rightCellSpacing >= point.x\n                        && cellWidget.y - cellWidget.margin.top - topCellSpacing <= point.y\n                        && cellWidget.y + cellWidget.height + cellWidget.margin.bottom + bottomCellSpacing >= point.y)) {\n                    break;\n                }\n            }\n        }\n        return lineWidget;\n    };\n    //TableRowWidget\n    /**\n     * Get line widget fom row\n     * @private\n     */\n    Selection.prototype.getLineWidgetRowWidget = function (widget, point) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var cellSpacing = 0;\n            cellSpacing = HelperMethods.convertPointToPixel(widget.ownerTable.tableFormat.cellSpacing);\n            var leftCellSpacing = 0;\n            var rightCellSpacing = 0;\n            if (cellSpacing > 0) {\n                leftCellSpacing = widget.childWidgets[i].columnIndex === 0 ? cellSpacing : cellSpacing / 2;\n                // tslint:disable-next-line:max-line-length\n                rightCellSpacing = widget.childWidgets[i].cellIndex === widget.childWidgets[i].ownerRow.childWidgets.length - 1 ? cellSpacing : cellSpacing / 2;\n            }\n            if (widget.childWidgets[i].x -\n                // tslint:disable-next-line:max-line-length\n                widget.childWidgets[i].margin.left - leftCellSpacing <= point.x && (widget.childWidgets[i].x +\n                // tslint:disable-next-line:max-line-length\n                widget.childWidgets[i].width) + widget.childWidgets[i].margin.right + rightCellSpacing >= point.x) {\n                return this.getLineWidgetCellWidget(widget.childWidgets[i], point);\n            }\n        }\n        var lineWidget = undefined;\n        if (widget.childWidgets.length > 0) {\n            if (widget.childWidgets[0].x <= point.x) {\n                lineWidget = this.getLineWidgetCellWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n            }\n            else {\n                lineWidget = this.getLineWidgetCellWidget(widget.childWidgets[0], point);\n            }\n        }\n        return lineWidget;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstBlock = function (cell) {\n        if (cell.childWidgets.length > 0) {\n            return cell.childWidgets[0];\n        }\n        return undefined;\n    };\n    //Table Cell Widget\n    /**\n     * Highlight selected cell widget\n     * @private\n     */\n    Selection.prototype.highlightCellWidget = function (widget) {\n        var widgets = [];\n        if (widget.previousSplitWidget || widget.nextSplitWidget) {\n            widgets = widget.getSplitWidgets();\n        }\n        else {\n            widgets.push(widget);\n        }\n        for (var i = 0; i < widgets.length; i++) {\n            widget = widgets[i];\n            //Clears Selection highlight of the child widgets.\n            this.clearChildSelectionHighlight(widget);\n            //Highlights the entire cell.\n            this.createHighlightBorderInsideTable(widget);\n        }\n    };\n    /**\n     * Clear selection highlight\n     * @private\n     */\n    Selection.prototype.clearSelectionHighlight = function (widget) {\n        if (this.selectedWidgets.containsKey(widget)) {\n            this.removeSelectionHighlight(widget);\n            this.selectedWidgets.remove(widget);\n        }\n    };\n    /**\n     * Get line widget from cell widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetCellWidget = function (widget, point) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            if (widget.childWidgets[i].y <= point.y\n                && (widget.childWidgets[i].y + widget.childWidgets[i].height) >= point.y) {\n                if (widget.childWidgets[i] instanceof ParagraphWidget) {\n                    return this.getLineWidgetParaWidget(widget.childWidgets[i], point);\n                }\n                else {\n                    return this.getLineWidgetTableWidget(widget.childWidgets[i], point);\n                }\n            }\n        }\n        var lineWidget = undefined;\n        if (widget.childWidgets.length > 0) {\n            if (widget.childWidgets[0].y <= point.y) {\n                if (widget.childWidgets[widget.childWidgets.length - 1] instanceof ParagraphWidget) {\n                    // tslint:disable-next-line:max-line-length\n                    lineWidget = this.getLineWidgetParaWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n                }\n                else {\n                    lineWidget = this.getLineWidgetTableWidget(widget.childWidgets[0], point);\n                }\n            }\n        }\n        return lineWidget;\n    };\n    //LineWidget\n    /**\n     * update text position\n     * @private\n     */\n    Selection.prototype.updateTextPosition = function (widget, point) {\n        var caretPosition = point;\n        var element = undefined;\n        var index = 0;\n        var isImageSelected = false;\n        var isImageSelectedObj = this.updateTextPositionIn(widget, element, index, point, false);\n        if (!isNullOrUndefined(isImageSelectedObj)) {\n            element = isImageSelectedObj.element;\n            index = isImageSelectedObj.index;\n            caretPosition = isImageSelectedObj.caretPosition;\n            isImageSelected = isImageSelectedObj.isImageSelected;\n            this.isImageSelected = isImageSelected;\n        }\n        if (isImageSelected) {\n            this.selectInternal(widget, element, index, caretPosition);\n            if (index === 0) {\n                this.extendForward();\n            }\n            else {\n                this.extendBackward();\n            }\n        }\n        else {\n            this.selectInternal(widget, element, index, caretPosition);\n        }\n    };\n    /**\n     * @private\n     */\n    /* tslint:disable */\n    Selection.prototype.updateTextPositionIn = function (widget, inline, index, caretPosition, includeParagraphMark) {\n        var isImageSelected = false;\n        var top = this.getTop(widget);\n        var left = widget.paragraph.x;\n        var elementValues = this.getFirstElement(widget, left);\n        var element = elementValues.element;\n        var isRtlText = false;\n        var isParaBidi = false;\n        left = elementValues.left;\n        if (isNullOrUndefined(element)) {\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var size = this.getParagraphMarkSize(widget.paragraph, topMargin, bottomMargin);\n            topMargin = size.topMargin;\n            bottomMargin = size.bottomMargin;\n            var selectParaMark = this.viewer.mouseDownOffset.y >= top && this.viewer.mouseDownOffset.y < top + widget.height ? (this.viewer.mouseDownOffset.x < left + size.width) : true;\n            if (selectParaMark && includeParagraphMark && caretPosition.x > left + size.width / 2) {\n                left += size.width;\n                if (widget.children.length > 0) {\n                    inline = widget.children[widget.children.length - 1];\n                    index = inline.length;\n                }\n                index++;\n            }\n            caretPosition = new Point(left, topMargin > 0 ? top + topMargin : top);\n        }\n        else {\n            if (!isNullOrUndefined(element)) {\n                if (caretPosition.x > left + element.margin.left) {\n                    for (var i = widget.children.indexOf(element); i < widget.children.length; i++) {\n                        element = widget.children[i];\n                        var isCurrentParaBidi = false;\n                        if (element instanceof ListTextElementBox || element instanceof TextElementBox) {\n                            isCurrentParaBidi = element.line.paragraph.paragraphFormat.bidi;\n                        }\n                        if (caretPosition.x < left + element.margin.left + element.width || i === widget.children.length - 1\n                            || ((widget.children[i + 1] instanceof ListTextElementBox) && isCurrentParaBidi)) {\n                            break;\n                        }\n                        left += element.margin.left + element.width;\n                    }\n                    if (element instanceof TextElementBox) {\n                        isRtlText = element.isRightToLeft;\n                        isParaBidi = element.line.paragraph.paragraphFormat.bidi;\n                    }\n                    if (caretPosition.x > left + element.margin.left + element.width) {\n                        //Line End\n                        index = element instanceof TextElementBox ? element.length : 1;\n                        if (isRtlText && isParaBidi) {\n                            index = 0;\n                        }\n                        if ((element instanceof TextElementBox && element.text !== \"\\v\") || includeParagraphMark) {\n                            left += element.margin.left + element.width;\n                        }\n                    }\n                    else if (element instanceof TextElementBox) {\n                        if (element instanceof TextElementBox && isRtlText) {\n                            left += element.width;\n                        }\n                        var x = 0;\n                        if (isRtlText) {\n                            x = (left + element.margin.left) - caretPosition.x;\n                        }\n                        else {\n                            x = caretPosition.x - left - element.margin.left;\n                        }\n                        left += element.margin.left;\n                        var prevWidth = 0;\n                        var charIndex = 0;\n                        for (var i = 1; i <= element.length; i++) {\n                            var width = 0;\n                            if (i === element.length) {\n                                width = element.width;\n                            }\n                            else {\n                                width = this.viewer.textHelper.getWidth(element.text.substr(0, i), element.characterFormat);\n                            }\n                            if (x < width || i === element.length) {\n                                //Updates exact left position of the caret.\n                                var charWidth = width - prevWidth;\n                                if (x - prevWidth > charWidth / 2) {\n                                    if (isRtlText) {\n                                        left -= width;\n                                    }\n                                    else {\n                                        left += width;\n                                    }\n                                    charIndex = i;\n                                }\n                                else {\n                                    if (isRtlText) {\n                                        left -= prevWidth;\n                                    }\n                                    else {\n                                        left += prevWidth;\n                                    }\n                                    charIndex = i - 1;\n                                    if (i === 1 && element !== widget.children[0]) {\n                                        var curIndex = widget.children.indexOf(element);\n                                        if (!(widget.children[curIndex - 1] instanceof ListTextElementBox) && !isRtlText) {\n                                            element = widget.children[curIndex - 1];\n                                            charIndex = element instanceof TextElementBox ? element.length : 1;\n                                        }\n                                    }\n                                }\n                                break;\n                            }\n                            prevWidth = width;\n                        }\n                        index = charIndex;\n                    }\n                    else {\n                        isImageSelected = element instanceof ImageElementBox;\n                        if (caretPosition.x - left - element.margin.left > element.width / 2) {\n                            index = 1;\n                            left += element.margin.left + element.width;\n                        }\n                        else if (element !== widget.children[0] && !isImageSelected) {\n                            var curIndex = widget.children.indexOf(element);\n                            if (!(widget.children[curIndex - 1] instanceof ListTextElementBox)) {\n                                element = widget.children[curIndex - 1];\n                                index = element instanceof TextElementBox ? element.length : 1;\n                            }\n                        }\n                    }\n                    if (element instanceof TextElementBox && element.text === '\\v') {\n                        index = 0;\n                    }\n                }\n                else {\n                    isRtlText = element.isRightToLeft;\n                    isParaBidi = element.line.paragraph.paragraphFormat.bidi;\n                    if (element instanceof TextElementBox && (isParaBidi || isRtlText) && caretPosition.x < left + element.margin.left + element.width) {\n                        index = this.getTextLength(element.line, element) + element.length;\n                    }\n                    else {\n                        index = this.getTextLength(element.line, element);\n                    }\n                    left += element.margin.left;\n                }\n                if (element instanceof TextElementBox) {\n                    top += element.margin.top > 0 ? element.margin.top : 0;\n                }\n                else {\n                    var textMetrics = this.viewer.textHelper.getHeight(element.characterFormat); //for ascent and descent\n                    var height = element.height;\n                    if (element instanceof BookmarkElementBox && !this.viewer.layout.hasValidElement(element.line.paragraph)) {\n                        height = textMetrics.Height; //after text helper class\n                    }\n                    top += element.margin.top + height - textMetrics.BaselineOffset;\n                }\n                inline = element;\n                var inlineObj = this.validateTextPosition(inline, index);\n                inline = inlineObj.element;\n                index = inlineObj.index;\n                var isParagraphEnd = isNullOrUndefined(inline.nextNode) && index === inline.length;\n                var isLineEnd = isNullOrUndefined(inline.nextNode)\n                    && inline instanceof TextElementBox && inline.text === '\\v';\n                if (includeParagraphMark && inline.nextNode instanceof FieldElementBox && index === inline.length) {\n                    isParagraphEnd = this.isLastRenderedInline(inline, index);\n                }\n                if (includeParagraphMark && isParagraphEnd || isLineEnd) {\n                    var width = 0;\n                    //Include width of Paragraph mark.\n                    if (isParagraphEnd) {\n                        width = this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n                        var selectParaMark = this.viewer.mouseDownOffset.y >= top && this.viewer.mouseDownOffset.y < top + widget.height ? (this.viewer.mouseDownOffset.x < left + width) : true;\n                        if (selectParaMark && caretPosition.x > left + width / 2) {\n                            left += width;\n                            index = inline.length + 1;\n                        }\n                        //Include width of line break mark.\n                    }\n                    else if (isLineEnd) {\n                        width = element.width;\n                        left += width;\n                        index = inline.length;\n                    }\n                }\n                caretPosition = new Point(left, top);\n            }\n        }\n        return {\n            'element': inline,\n            'index': index,\n            'caretPosition': caretPosition,\n            'isImageSelected': isImageSelected\n        };\n    };\n    /* tslint:enable */\n    /**\n     * Get text length if the line widget\n     * @private\n     */\n    Selection.prototype.getTextLength = function (widget, element) {\n        var length = 0;\n        var count = widget.children.indexOf(element);\n        if (widget.children.length > 0 && widget.children[0] instanceof ListTextElementBox) {\n            if (widget.children[1] instanceof ListTextElementBox) {\n                count -= 2;\n            }\n            else {\n                count -= 1;\n            }\n        }\n        for (var i = 1; i < count; i++) {\n            length += widget.children[i].length;\n        }\n        return length;\n    };\n    /**\n     * Get Line widget left\n     * @private\n     */\n    Selection.prototype.getLeft = function (widget) {\n        var left = widget.paragraph.x;\n        var paragraphFormat = widget.paragraph.paragraphFormat;\n        if (this.isParagraphFirstLine(widget) && !paragraphFormat.bidi && !(paragraphFormat.textAlignment === 'Right')) {\n            left += HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n        }\n        for (var i = 0; i < widget.children.length; i++) {\n            var element = widget.children[i];\n            if (element instanceof ListTextElementBox) { //after list implementation\n                if (i === 0) {\n                    left += element.margin.left + element.width;\n                }\n                else {\n                    left += element.width;\n                }\n            }\n            else {\n                left += element.margin.left;\n                break;\n            }\n        }\n        return left;\n    };\n    /**\n     * Get line widget top\n     * @private\n     */\n    Selection.prototype.getTop = function (widget) {\n        var top = widget.paragraph.y;\n        var count = widget.paragraph.childWidgets.indexOf(widget);\n        for (var i = 0; i < count; i++) {\n            top += widget.paragraph.childWidgets[i].height;\n        }\n        return top;\n    };\n    /**\n     * Get first element the widget\n     * @private\n     */\n    Selection.prototype.getFirstElement = function (widget, left) {\n        var firstLineIndent = 0;\n        if (this.isParagraphFirstLine(widget) && !widget.paragraph.paragraphFormat.bidi) {\n            firstLineIndent = HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        left += firstLineIndent;\n        var element = undefined;\n        for (var i = 0; i < widget.children.length; i++) {\n            element = widget.children[i];\n            if (element instanceof ListTextElementBox) {\n                left += element.margin.left + element.width;\n                element = undefined;\n                // }\n                //  else if (element instanceof FieldElementBox || element instanceof BookmarkElementBox\n                //     || (element.nextNode instanceof FieldElementBox && ((element.nextNode as FieldElementBox).fieldType === 2))) {\n                //     element = undefined;\n            }\n            else {\n                break;\n            }\n        }\n        return { 'element': element, 'left': left };\n    };\n    /**\n     * Return inline index\n     * @private\n     */\n    //ElementBox\n    Selection.prototype.getIndexInInline = function (elementBox) {\n        var indexInInline = 0;\n        if (elementBox instanceof TextElementBox) {\n            var count = elementBox.line.children.indexOf(elementBox);\n            for (var i = 0; i < count; i++) {\n                var element = elementBox.line.children[i];\n                if (element instanceof FieldElementBox || element instanceof ListTextElementBox) {\n                    continue;\n                }\n                indexInInline += element.length;\n            }\n        }\n        return indexInInline;\n    };\n    /**\n     * Return true if widget is first inline of paragraph\n     * @private\n     */\n    Selection.prototype.isParagraphFirstLine = function (widget) {\n        if (isNullOrUndefined(widget.paragraph.previousSplitWidget) &&\n            widget === widget.paragraph.firstChild) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isParagraphLastLine = function (widget) {\n        if (isNullOrUndefined(widget.paragraph.nextSplitWidget)\n            && widget === widget.paragraph.lastChild) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Return line widget width\n     * @private\n     */\n    Selection.prototype.getWidth = function (widget, includeParagraphMark) {\n        var width = 0;\n        var paraFormat = widget.paragraph.paragraphFormat;\n        if (this.isParagraphFirstLine(widget) && !paraFormat.bidi) {\n            width += HelperMethods.convertPointToPixel(paraFormat.firstLineIndent);\n        }\n        for (var i = 0; i < widget.children.length; i++) {\n            width += widget.children[i].margin.left + widget.children[i].width;\n        }\n        if (includeParagraphMark && widget.paragraph.childWidgets.indexOf(widget) === widget.paragraph.childWidgets.length - 1\n            && isNullOrUndefined(widget.paragraph.nextSplitWidget)) {\n            width += this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n        }\n        return width;\n    };\n    /**\n     * Return line widget left\n     * @private\n     */\n    Selection.prototype.getLeftInternal = function (widget, elementBox, index) {\n        var left = widget.paragraph.x;\n        var paraFormat = widget.paragraph.paragraphFormat;\n        if (this.isParagraphFirstLine(widget) && !paraFormat.bidi) {\n            // tslint:disable-next-line:max-line-length\n            left += HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        var isRtlText = false;\n        var isParaBidi = false;\n        if (elementBox instanceof TextElementBox) {\n            isRtlText = elementBox.isRightToLeft;\n            isParaBidi = elementBox.line.paragraph.paragraphFormat.bidi;\n        }\n        //when line contains normal text and para is RTL para.\n        //if home key is pressed, update caret position after the last element in a line.\n        //if end key pressed, update caret position before the first element in a line. \n        if (isParaBidi) {\n            if (!isRtlText) {\n                if (this.viewer.moveCaretPosition === 1 && widget.children.length > 0) {\n                    elementBox = widget.children[widget.children.length - 1];\n                }\n                else if (this.viewer.moveCaretPosition === 2) {\n                    elementBox = widget.children[0];\n                }\n                if (elementBox instanceof ListTextElementBox && widget.children.length > 2) {\n                    elementBox = widget.children[widget.children.length - 3];\n                }\n            }\n        }\n        var count = widget.children.indexOf(elementBox);\n        if ((widget.children.length === 1 && widget.children[0] instanceof ListTextElementBox) || (widget.children.length === 2\n            && widget.children[0] instanceof ListTextElementBox && widget.children[1] instanceof ListTextElementBox)) {\n            count = widget.children.length;\n        }\n        for (var i = 0; i < count; i++) {\n            var widgetInternal = widget.children[i];\n            // if (widgetInternal instanceof FieldElementBox) {\n            //     continue;\n            // }\n            if (i === 1 && widget.children[i] instanceof ListTextElementBox) {\n                left += widget.children[i].width;\n            }\n            else {\n                left += widget.children[i].margin.left + widget.children[i].width;\n            }\n        }\n        if (!isNullOrUndefined(elementBox)) {\n            left += elementBox.margin.left;\n            if (isRtlText || (this.viewer.moveCaretPosition === 1 && !isRtlText && isParaBidi)) {\n                left += elementBox.width;\n            }\n        }\n        var width = 0;\n        if (elementBox instanceof TextElementBox) {\n            if ((this.viewer.moveCaretPosition !== 0) && (isParaBidi || isRtlText)) {\n                if ((isRtlText && isParaBidi && this.viewer.moveCaretPosition === 2)\n                    || (isRtlText && !isParaBidi && this.viewer.moveCaretPosition === 1)) {\n                    left -= elementBox.width;\n                }\n                this.viewer.moveCaretPosition = 0;\n                return left;\n            }\n            if (index === elementBox.length && !isRtlText) {\n                left += elementBox.width;\n            }\n            else if (index > elementBox.length) {\n                width = this.viewer.textHelper.getParagraphMarkWidth(elementBox.line.paragraph.characterFormat);\n                if (isRtlText) {\n                    left -= elementBox.width + width;\n                }\n                else {\n                    left += elementBox.width + width;\n                }\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                width = this.viewer.textHelper.getWidth(elementBox.text.substr(0, index), elementBox.characterFormat);\n                if (isRtlText) {\n                    left -= width;\n                }\n                else {\n                    left += width;\n                }\n            }\n            this.viewer.moveCaretPosition = 0;\n        }\n        else if (index > 0) {\n            if (!isNullOrUndefined(elementBox) && !(elementBox instanceof ListTextElementBox)) {\n                left += elementBox.width;\n                if (index === 2) {\n                    var paragraph = elementBox.line.paragraph;\n                    left += this.viewer.textHelper.getParagraphMarkWidth(paragraph.characterFormat);\n                }\n            }\n            else {\n                left += this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n            }\n        }\n        return left;\n    };\n    /**\n     * Return line widget start offset\n     * @private\n     */\n    Selection.prototype.getLineStartLeft = function (widget) {\n        var left = widget.paragraph.x;\n        var paragraphFormat = widget.paragraph.paragraphFormat;\n        if (this.isParagraphFirstLine(widget) && !paragraphFormat.bidi) {\n            left += HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n        }\n        if (widget.children.length > 0) {\n            left += widget.children[0].margin.left;\n        }\n        return left;\n    };\n    /**\n     * Update text position\n     * @private\n     */\n    Selection.prototype.updateTextPositionWidget = function (widget, point, textPosition, includeParagraphMark) {\n        var caretPosition = point;\n        var inline = undefined;\n        var index = 0;\n        var updatePositionObj;\n        updatePositionObj = this.updateTextPositionIn(widget, inline, index, caretPosition, includeParagraphMark);\n        inline = updatePositionObj.element;\n        index = updatePositionObj.index;\n        caretPosition = updatePositionObj.caretPosition;\n        textPosition.setPositionForSelection(widget, inline, index, caretPosition);\n    };\n    /**\n     * Clear selection highlight\n     * @private\n     */\n    Selection.prototype.clearSelectionHighlightLineWidget = function (widget) {\n        if (!isNullOrUndefined(this.owner) && this.selectedWidgets.length > 0) {\n            this.clearSelectionHighlight(this);\n        }\n    };\n    /**\n     * Return first element from line widget\n     * @private\n     */\n    Selection.prototype.getFirstElementInternal = function (widget) {\n        var element = undefined;\n        for (var i = 0; i < widget.children.length; i++) {\n            element = widget.children[i];\n            if (element instanceof ListTextElementBox) {\n                element = undefined;\n            }\n            else {\n                break;\n            }\n        }\n        return element;\n    };\n    //Selection API    \n    /**\n     * Select content between given range\n     * @private\n     */\n    Selection.prototype.selectRange = function (startPosition, endPosition) {\n        this.start.setPositionInternal(startPosition);\n        this.end.setPositionInternal(endPosition);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Selects current paragraph\n     * @private\n     */\n    Selection.prototype.selectParagraph = function (paragraph, positionAtStart) {\n        var line = paragraph.firstChild;\n        if (positionAtStart) {\n            this.start.setPosition(line, positionAtStart);\n        }\n        else {\n            var endOffset = line.getEndOffset();\n            this.start.setPositionParagraph(line, endOffset);\n        }\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.setPositionForBlock = function (block, selectFirstBlock) {\n        var position;\n        if (block instanceof TableWidget) {\n            if (selectFirstBlock) {\n                block = this.getFirstParagraphInFirstCell(block);\n            }\n            else {\n                block = this.getLastParagraphInLastCell(block);\n            }\n        }\n        if (block instanceof ParagraphWidget) {\n            position = new TextPosition(this.owner);\n            if (selectFirstBlock) {\n                position.setPosition(block.firstChild, true);\n            }\n            else {\n                var line = block.lastChild;\n                position.setPositionParagraph(line, line.getEndOffset());\n            }\n        }\n        return position;\n    };\n    /**\n     * Select content in given text position\n     * @private\n     */\n    Selection.prototype.selectContent = function (textPosition, clearMultiSelection) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        this.start.setPositionInternal(textPosition);\n        this.end.setPositionInternal(textPosition);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Select paragraph\n     * @private\n     */\n    Selection.prototype.selectInternal = function (lineWidget, element, index, physicalLocation) {\n        this.start.setPositionForSelection(lineWidget, element, index, physicalLocation);\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = physicalLocation.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.selects = function (lineWidget, offset, skipSelectionChange) {\n        this.viewer.clearSelectionHighlight();\n        this.start.setPositionForLineWidget(lineWidget, offset);\n        this.end.setPositionInternal(this.start);\n        if (!skipSelectionChange) {\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Select content between start and end position\n     * @private\n     */\n    Selection.prototype.selectPosition = function (startPosition, endPosition) {\n        if (isNullOrUndefined(startPosition) || isNullOrUndefined(endPosition)) {\n            throw new Error('TextPosition cannot be undefined');\n        }\n        if (isNullOrUndefined(startPosition.paragraph)\n            || startPosition.offset > this.getParagraphLength(startPosition.paragraph) + 1) {\n            throw new Error('Start TextPosition is not valid.');\n        }\n        if (isNullOrUndefined(endPosition.paragraph)\n            || endPosition.offset > this.getParagraphLength(endPosition.paragraph) + 1) {\n            throw new Error('End TextPosition is not valid.');\n        }\n        if (startPosition.isAtSamePosition(endPosition)) {\n            // Select start position.\n            this.selectRange(startPosition, startPosition);\n        }\n        else {\n            // If both text position exists within same comment or outside comment, and not at same position.\n            if (startPosition.isExistBefore(endPosition)) {\n                // tslint:disable-next-line:max-line-length\n                endPosition.validateForwardFieldSelection(startPosition.getHierarchicalIndexInternal(), endPosition.getHierarchicalIndexInternal());\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                startPosition.validateForwardFieldSelection(endPosition.getHierarchicalIndexInternal(), startPosition.getHierarchicalIndexInternal());\n            }\n            this.selectRange(startPosition, endPosition);\n        }\n    };\n    /**\n     * Notify selection change event\n     * @private\n     */\n    Selection.prototype.fireSelectionChanged = function (isSelectionChanged) {\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.start.updatePhysicalPosition(true);\n                this.end.updatePhysicalPosition(false);\n            }\n            else {\n                this.start.updatePhysicalPosition(false);\n                this.end.updatePhysicalPosition(true);\n            }\n        }\n        if (!this.skipFormatRetrieval) {\n            this.retrieveCurrentFormatProperties();\n        }\n        this.viewer.clearSelectionHighlight();\n        this.hideToolTip();\n        if (this.owner.isLayoutEnabled && !this.owner.isShiftingEnabled) {\n            this.highlightSelection(true);\n        }\n        if (isSelectionChanged) {\n            if (this.start.paragraph.isInHeaderFooter && !this.owner.enableHeaderAndFooter) {\n                this.owner.enableHeaderAndFooter = true;\n            }\n            else if (!this.start.paragraph.isInHeaderFooter && this.owner.enableHeaderAndFooter) {\n                this.owner.enableHeaderAndFooter = false;\n            }\n            this.owner.fireSelectionChange();\n        }\n        this.viewer.updateFocus();\n    };\n    //Formats Retrieval\n    /**\n     * Retrieve all current selection format\n     * @private\n     */\n    Selection.prototype.retrieveCurrentFormatProperties = function () {\n        this.isRetrieveFormatting = true;\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        this.retrieveImageFormat(startPosition, endPosition);\n        this.retrieveCharacterFormat(startPosition, endPosition);\n        this.retrieveParagraphFormat(startPosition, endPosition);\n        this.retrieveSectionFormat(startPosition, endPosition);\n        this.retrieveTableFormat(startPosition, endPosition);\n        if (!this.isImageSelected) {\n            this.imageFormat.clearImageFormat();\n        }\n        this.isRetrieveFormatting = false;\n        this.setCurrentContextType();\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.retrieveImageFormat = function (start, end) {\n        var image;\n        if (start.currentWidget === end.currentWidget && start.offset + 1 === end.offset) {\n            var elementInfo = end.currentWidget.getInline(end.offset, 0);\n            image = elementInfo.element;\n            var index = elementInfo.index;\n            if (image instanceof ImageElementBox) {\n                var startOffset = start.currentWidget.getOffset(image, 0);\n                if (startOffset !== start.offset) {\n                    image = undefined;\n                }\n            }\n        }\n        if (image instanceof ImageElementBox) {\n            this.imageFormat.copyImageFormat(image);\n        }\n        else {\n            this.imageFormat.clearImageFormat();\n        }\n    };\n    Selection.prototype.setCurrentContextType = function () {\n        var contextIsinImage = this.imageFormat.image ? true : false;\n        var contextIsinTable = (isNullOrUndefined(this.tableFormat) || isNullOrUndefined(this.tableFormat.table)) ? false : true;\n        var style = this.start.paragraph.paragraphFormat.baseStyle;\n        if (style instanceof WParagraphStyle && style.name.toLowerCase().indexOf('toc') === 0) {\n            var tocField = this.getTocFieldInternal();\n            if (!isNullOrUndefined(tocField)) {\n                this.contextTypeInternal = 'TableOfContents';\n                return;\n            }\n        }\n        if (this.start.paragraph.isInHeaderFooter) {\n            var isInHeader = this.start.paragraph.bodyWidget.headerFooterType.indexOf('Header') !== -1;\n            if (contextIsinTable) {\n                if (contextIsinImage) {\n                    this.contextTypeInternal = isInHeader ? 'HeaderTableImage' : 'FooterTableImage';\n                }\n                else {\n                    this.contextTypeInternal = isInHeader ? 'HeaderTableText' : 'FooterTableText';\n                }\n            }\n            else {\n                if (contextIsinImage) {\n                    this.contextTypeInternal = isInHeader ? 'HeaderImage' : 'FooterImage';\n                }\n                else {\n                    this.contextTypeInternal = isInHeader ? 'HeaderText' : 'FooterText';\n                }\n            }\n        }\n        else {\n            if (contextIsinTable) {\n                this.contextTypeInternal = contextIsinImage ? 'TableImage' : 'TableText';\n            }\n            else {\n                this.contextTypeInternal = contextIsinImage ? 'Image' : 'Text';\n            }\n        }\n    };\n    //Table Format retrieval starts\n    /**\n     * Retrieve selection table format\n     * @private\n     */\n    Selection.prototype.retrieveTableFormat = function (start, end) {\n        var tableAdv = this.getTable(start, end);\n        if (!isNullOrUndefined(tableAdv)) {\n            this.tableFormat.copyFormat(tableAdv.tableFormat);\n            this.tableFormat.table = tableAdv;\n            this.retrieveCellFormat(start, end);\n            this.retrieveRowFormat(start, end);\n        }\n        else {\n            //When the selection is out of table\n            this.tableFormat.clearFormat();\n        }\n    };\n    /**\n     * Retrieve selection cell format\n     * @private\n     */\n    Selection.prototype.retrieveCellFormat = function (start, end) {\n        if (start.paragraph.isInsideTable && end.paragraph.isInsideTable) {\n            this.cellFormat.copyFormat(start.paragraph.associatedCell.cellFormat);\n            this.getCellFormat(start.paragraph.associatedCell.ownerTable, start, end);\n        }\n        else {\n            //When the selection is out of table\n            this.cellFormat.clearCellFormat();\n        }\n    };\n    /**\n     * Retrieve selection row format\n     * @private\n     */\n    Selection.prototype.retrieveRowFormat = function (start, end) {\n        if (start.paragraph.isInsideTable && end.paragraph.isInsideTable) {\n            this.rowFormat.copyFormat(start.paragraph.associatedCell.ownerRow.rowFormat);\n            this.getRowFormat(start.paragraph.associatedCell.ownerTable, start, end);\n        }\n        else {\n            //When the selection is out of table\n            this.rowFormat.clearRowFormat();\n        }\n    };\n    /**\n     * Get selected cell format\n     * @private\n     */\n    Selection.prototype.getCellFormat = function (table, start, end) {\n        if (start.paragraph.associatedCell.equals(end.paragraph.associatedCell)) {\n            return;\n        }\n        var isStarted = false;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row === start.paragraph.associatedCell.ownerRow) {\n                isStarted = true;\n            }\n            if (isStarted) {\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    var cell = row.childWidgets[j];\n                    if (this.isCellSelected(cell, start, end)) {\n                        this.cellFormat.combineFormat(cell.cellFormat);\n                    }\n                    if (cell === end.paragraph.associatedCell) {\n                        this.cellFormat.combineFormat(cell.cellFormat);\n                        return;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Get selected row format\n     * @private\n     */\n    Selection.prototype.getRowFormat = function (table, start, end) {\n        var tableRow = start.paragraph.associatedCell.ownerRow;\n        if (tableRow === end.paragraph.associatedCell.ownerRow) {\n            return;\n        }\n        for (var i = table.childWidgets.indexOf(tableRow) + 1; i < table.childWidgets.length; i++) {\n            var tempTableRow = table.childWidgets[i];\n            this.rowFormat.combineFormat(tempTableRow.rowFormat);\n            if (tempTableRow === end.paragraph.associatedCell.ownerRow) {\n                return;\n            }\n        }\n    };\n    /**\n     * Return table with given text position\n     * @private\n     */\n    Selection.prototype.getTable = function (startPosition, endPosition) {\n        if (!isNullOrUndefined(startPosition.paragraph.associatedCell) && !isNullOrUndefined(endPosition.paragraph.associatedCell)) {\n            var startTable = startPosition.paragraph.associatedCell.ownerTable;\n            var endTable = startPosition.paragraph.associatedCell.ownerTable;\n            if (startTable === endTable) {\n                return startTable;\n            }\n            else {\n                if (startTable.contains(startPosition.paragraph.associatedCell)) {\n                    return startTable;\n                }\n                else if (endTable.contains(startPosition.paragraph.associatedCell)) {\n                    return endTable;\n                }\n                else if (!startTable.isInsideTable || !endTable.isInsideTable) {\n                    return undefined;\n                }\n                else {\n                    do {\n                        startTable = startTable.associatedCell.ownerTable;\n                        if (startTable === endTable || startTable.contains(endTable.associatedCell)) {\n                            return startTable;\n                        }\n                        else if (endTable.contains(startTable.associatedCell)) {\n                            return endTable;\n                        }\n                    } while (!isNullOrUndefined(startTable.associatedCell));\n                }\n            }\n        }\n        return undefined;\n    };\n    Selection.prototype.getContainerWidget = function (block) {\n        var bodyWidget;\n        if (block.containerWidget instanceof BlockContainer) {\n            bodyWidget = block.containerWidget;\n        }\n        else {\n            bodyWidget = block.containerWidget;\n            while (!(bodyWidget instanceof BlockContainer)) {\n                bodyWidget = bodyWidget.containerWidget;\n            }\n        }\n        return bodyWidget;\n    };\n    //Table format retrieval ends\n    //Section format retrieval starts\n    /**\n     * Retrieve selection section format\n     * @private\n     */\n    Selection.prototype.retrieveSectionFormat = function (start, end) {\n        var startParaSection = this.getContainerWidget(start.paragraph);\n        var endParaSection = this.getContainerWidget(end.paragraph);\n        if (!isNullOrUndefined(startParaSection)) {\n            this.sectionFormat.copyFormat(startParaSection.sectionFormat);\n            var startPageIndex = this.viewer.pages.indexOf(startParaSection.page);\n            var endPageIndex = this.viewer.pages.indexOf(endParaSection.page);\n            for (var i = startPageIndex + 1; i <= endPageIndex; i++) {\n                this.sectionFormat.combineFormat(this.viewer.pages[i].bodyWidgets[0].sectionFormat);\n            }\n        }\n    };\n    //section format retrieval ends.\n    //Paragraph format retrieval implementation starts.\n    /**\n     * Retrieve selection paragraph format\n     * @private\n     */\n    Selection.prototype.retrieveParagraphFormat = function (start, end) {\n        this.getParagraphFormatForSelection(start.paragraph, this, start, end);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatForSelection = function (paragraph, selection, start, end) {\n        //Selection start in cell.\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || this.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            this.getParagraphFormatInternalInCell(start.paragraph.associatedCell, start, end);\n        }\n        else {\n            this.getParagraphFormatInternalInParagraph(paragraph, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getParagraphFormatInternalInParagraph = function (paragraph, start, end) {\n        if (start.paragraph === paragraph) {\n            this.paragraphFormat.copyFormat(paragraph.paragraphFormat);\n        }\n        else {\n            this.paragraphFormat.combineFormat(paragraph.paragraphFormat);\n        }\n        if (end.paragraph === paragraph) {\n            return;\n        }\n        var block = this.getNextRenderedBlock(paragraph);\n        if (!isNullOrUndefined(block)) {\n            this.getParagraphFormatInternalInBlock(block, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInternalInBlock = function (block, start, end) {\n        if (block instanceof ParagraphWidget) {\n            this.getParagraphFormatInternalInParagraph(block, start, end);\n        }\n        else {\n            this.getParagraphFormatInternalInTable(block, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInternalInTable = function (table, start, end) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var tableRow = table.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                this.getParagraphFormatInCell(tableRow.childWidgets[j]);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(tableRow, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var block = this.getNextRenderedBlock(table);\n        //Goto the next block.\n        this.getParagraphFormatInternalInBlock(block, start, end);\n    };\n    /**\n     * Get paragraph format in cell\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInCell = function (cell) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            this.getParagraphFormatInBlock(cell.childWidgets[i]);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            this.getParagraphFormatInParagraph(block);\n        }\n        else {\n            this.getParagraphFormatInTable(block);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInTable = function (tableAdv) {\n        for (var i = 0; i < tableAdv.childWidgets.length; i++) {\n            var tableRow = tableAdv.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                this.getParagraphFormatInCell(tableRow.childWidgets[j]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInParagraph = function (paragraph) {\n        this.paragraphFormat.combineFormat(paragraph.paragraphFormat);\n    };\n    /**\n     * Get paragraph format in cell\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInternalInCell = function (cellAdv, start, end) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = this.getContainerCellOf(cellAdv, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(cellAdv, containerCell);\n                var endCell = this.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (this.isCellSelected(containerCell, start, end)) {\n                        this.getParagraphFormatInCell(containerCell);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.getParagraphFormatInternalInParagraph(start.paragraph, start, end);\n                        }\n                        else {\n                            this.getParagraphFormatInRow(startCell.ownerRow, start, end);\n                        }\n                    }\n                }\n                else {\n                    //Format other selected cells in current table.\n                    this.getParaFormatForCell(containerCell.ownerTable, containerCell, endCell);\n                }\n            }\n            else {\n                this.getParagraphFormatInRow(containerCell.ownerRow, start, end);\n            }\n        }\n        else {\n            var cell = this.getContainerCell(cellAdv);\n            this.getParagraphFormatInRow(cell.ownerRow, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParaFormatForCell = function (table, startCell, endCell) {\n        var startCellIn = this.getCellLeft(startCell.ownerRow, startCell);\n        var endCellIn = startCellIn + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        if (startCellIn > endCellLeft) {\n            startCellIn = endCellLeft;\n        }\n        if (endCellIn < endCellRight) {\n            endCellIn = endCellRight;\n        }\n        if (startCellIn > this.upDownSelectionLength) {\n            startCellIn = this.upDownSelectionLength;\n        }\n        if (startCellIn < this.upDownSelectionLength) {\n            startCellIn = this.upDownSelectionLength;\n        }\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n            var tableRow = table.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                var cell = tableRow.childWidgets[j];\n                var left = this.getCellLeft(tableRow, cell);\n                if (HelperMethods.round(startCellIn, 2) <= HelperMethods.round(left, 2)\n                    && HelperMethods.round(left, 2) < HelperMethods.round(endCellIn, 2)) {\n                    this.getParagraphFormatInCell(cell);\n                }\n            }\n        }\n    };\n    /**\n     * Get paragraph format ins row\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInRow = function (tableRow, start, end) {\n        for (var i = tableRow.rowIndex; i < tableRow.ownerTable.childWidgets.length; i++) {\n            var row = tableRow.ownerTable.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.getParagraphFormatInCell(row.childWidgets[j]);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(row, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var block = this.getNextRenderedBlock(tableRow.ownerTable);\n        //Goto the next block.\n        this.getParagraphFormatInternalInBlock(block, start, end);\n    };\n    // paragraph format retrieval implementation ends\n    // Character format retrieval implementation starts.\n    /**\n     * Retrieve Selection character format\n     * @private\n     */\n    Selection.prototype.retrieveCharacterFormat = function (start, end) {\n        this.characterFormat.copyFormat(start.paragraph.characterFormat);\n        if (start.paragraph === end.paragraph && start.currentWidget.isLastLine()\n            && start.offset === this.getLineLength(start.currentWidget) && start.offset + 1 === end.offset) {\n            return;\n        }\n        var para = start.paragraph;\n        if (start.offset === this.getParagraphLength(para) && !this.isEmpty) {\n            para = this.getNextParagraphBlock(para);\n        }\n        while (!isNullOrUndefined(para) && para !== end.paragraph && para.isEmpty()) {\n            para = this.getNextParagraphBlock(para);\n        }\n        var offset = para === start.paragraph ? start.offset : 0;\n        var indexInInline = 0;\n        if (!isNullOrUndefined(para) && !para.isEmpty()) {\n            var position = new TextPosition(this.owner);\n            var elemInfo = start.currentWidget.getInline(offset, indexInInline);\n            var physicalLocation = this.getPhysicalPositionInternal(start.currentWidget, offset, true);\n            position.setPositionForSelection(start.currentWidget, elemInfo.element, elemInfo.index, physicalLocation);\n            this.getCharacterFormatForSelection(para, this, position, end);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getCharacterFormatForSelection = function (paragraph, selection, startPosition, endPosition) {\n        //Selection start in cell.\n        if (startPosition.paragraph instanceof ParagraphWidget && startPosition.paragraph.isInsideTable\n            && (!endPosition.paragraph.isInsideTable\n                || startPosition.paragraph.associatedCell !== endPosition.paragraph.associatedCell\n                || this.isCellSelected(startPosition.paragraph.associatedCell, startPosition, endPosition))) {\n            this.getCharacterFormatInTableCell(startPosition.paragraph.associatedCell, selection, startPosition, endPosition);\n        }\n        else {\n            this.getCharacterFormat(paragraph, startPosition, endPosition);\n        }\n    };\n    /**\n     * Get Character format\n     * @private\n     */\n    //Format Retrieval\n    Selection.prototype.getCharacterFormatForTableRow = function (tableRowAdv, start, end) {\n        for (var i = tableRowAdv.rowIndex; i < tableRowAdv.ownerTable.childWidgets.length; i++) {\n            var tableRow = tableRowAdv.ownerTable.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                this.getCharacterFormatForSelectionCell(tableRow.childWidgets[j], start, end);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(tableRow, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var block = this.getNextRenderedBlock(tableRowAdv.ownerTable);\n        // //Goto the next block.\n        this.getCharacterFormatForBlock(block, start, end);\n    };\n    /**\n     * Get Character format in table\n     * @private\n     */\n    Selection.prototype.getCharacterFormatInTableCell = function (tableCell, selection, start, end) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = this.getContainerCellOf(tableCell, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(tableCell, containerCell);\n                var endCell = this.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (this.isCellSelected(containerCell, start, end)) {\n                        this.getCharacterFormatForSelectionCell(containerCell, start, end);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.getCharacterFormat(start.paragraph, start, end);\n                        }\n                        else {\n                            this.getCharacterFormatForTableRow(startCell.ownerRow, start, end);\n                        }\n                    }\n                }\n                else {\n                    //Format other selected cells in current table.\n                    this.getCharacterFormatInternalInTable(containerCell.ownerTable, containerCell, endCell, start, end);\n                }\n            }\n            else {\n                this.getCharacterFormatForTableRow(containerCell.ownerRow, start, end);\n            }\n        }\n        else {\n            var cell = this.getContainerCell(tableCell);\n            this.getCharacterFormatForTableRow(cell.ownerRow, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getCharacterFormatInternalInTable = function (table, startCell, endCell, startPosition, endPosition) {\n        var startIn = this.getCellLeft(startCell.ownerRow, startCell);\n        var endIn = startIn + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        if (startIn > endCellLeft) {\n            startIn = endCellLeft;\n        }\n        if (endIn < endCellRight) {\n            endIn = endCellRight;\n        }\n        if (startIn > this.upDownSelectionLength) {\n            startIn = this.upDownSelectionLength;\n        }\n        if (endIn < this.upDownSelectionLength) {\n            endIn = this.upDownSelectionLength;\n        }\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var left = this.getCellLeft(row, cell);\n                if (HelperMethods.round(startIn, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(endIn, 2)) {\n                    this.getCharacterFormatForSelectionCell(cell, startPosition, endPosition);\n                }\n            }\n        }\n    };\n    /**\n     * Get character format with in selection\n     * @private\n     */\n    Selection.prototype.getCharacterFormat = function (paragraph, start, end) {\n        if (paragraph !== start.paragraph && paragraph !== end.paragraph) {\n            this.getCharacterFormatInternal(paragraph, this);\n            return;\n        }\n        if (end.paragraph === paragraph && start.paragraph !== paragraph && end.offset === 0) {\n            return;\n        }\n        var startOffset = 0;\n        var length = this.getParagraphLength(paragraph);\n        if (paragraph === start.paragraph) {\n            startOffset = start.offset;\n            //Sets selection character format.            \n            var isUpdated = this.setCharacterFormat(paragraph, start, end, length);\n            if (isUpdated) {\n                return;\n            }\n        }\n        var startLineWidget = paragraph.childWidgets.indexOf(start.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(start.currentWidget) : 0;\n        var endLineWidget = paragraph.childWidgets.indexOf(end.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(end.currentWidget) : paragraph.childWidgets.length - 1;\n        var endOffset = end.offset;\n        if (paragraph !== end.paragraph) {\n            endOffset = length;\n        }\n        var isFieldStartSelected = false;\n        for (var i = startLineWidget; i <= endLineWidget; i++) {\n            var lineWidget = paragraph.childWidgets[i];\n            if (i !== startLineWidget) {\n                startOffset = this.getStartLineOffset(lineWidget);\n            }\n            if (lineWidget === end.currentWidget) {\n                endOffset = end.offset;\n            }\n            else {\n                endOffset = this.getLineLength(lineWidget);\n            }\n            var count = 0;\n            for (var j = 0; j < lineWidget.children.length; j++) {\n                var inline = lineWidget.children[j];\n                if (startOffset >= count + inline.length) {\n                    count += inline.length;\n                    continue;\n                }\n                if (inline instanceof FieldElementBox && inline.fieldType === 0\n                    && HelperMethods.isLinkedFieldCharacter(inline)) {\n                    var nextInline = isNullOrUndefined(inline.fieldSeparator) ?\n                        inline.fieldEnd : inline.fieldSeparator;\n                    do {\n                        count += inline.length;\n                        inline = inline.nextNode;\n                        i++;\n                    } while (!isNullOrUndefined(inline) && inline !== nextInline);\n                    isFieldStartSelected = true;\n                }\n                if (inline instanceof FieldElementBox && inline.fieldType === 1\n                    && HelperMethods.isLinkedFieldCharacter(inline) && isFieldStartSelected) {\n                    var fieldInline = inline.fieldBegin;\n                    do {\n                        this.characterFormat.combineFormat(fieldInline.characterFormat);\n                        fieldInline = fieldInline.nextNode;\n                    } while (!(fieldInline instanceof FieldElementBox));\n                }\n                if (inline instanceof TextElementBox) {\n                    this.characterFormat.combineFormat(inline.characterFormat);\n                }\n                if (isNullOrUndefined(inline) || endOffset <= count + inline.length) {\n                    break;\n                }\n                count += inline.length;\n            }\n        }\n        if (end.paragraph === paragraph) {\n            return;\n        }\n        var block = this.getNextRenderedBlock(paragraph);\n        if (!isNullOrUndefined(block)) {\n            this.getCharacterFormatForBlock(block, start, end);\n        }\n    };\n    Selection.prototype.setCharacterFormat = function (para, startPos, endPos, length) {\n        var index = 0;\n        var startOffset = startPos.offset;\n        var inlineAndIndex = startPos.currentWidget.getInline(startOffset, index);\n        index = inlineAndIndex.index;\n        var inline = inlineAndIndex.element;\n        if (isNullOrUndefined(inline)) {\n            var currentLineIndex = startPos.paragraph.childWidgets.indexOf(startPos.currentWidget);\n            if (startPos.currentWidget.previousLine) {\n                inline = startPos.currentWidget.previousLine.children[startPos.currentWidget.previousLine.children.length - 1];\n                this.characterFormat.copyFormat(inline.characterFormat);\n                return true;\n            }\n        }\n        if (startOffset < length) {\n            if (this.isEmpty) {\n                if (inline instanceof TextElementBox || (inline instanceof FieldElementBox\n                    && (inline.fieldType === 0 || inline.fieldType === 1))) {\n                    var previousNode = this.getPreviousTextElement(inline);\n                    if (startOffset === 0 && previousNode) {\n                        inline = previousNode;\n                    }\n                    this.characterFormat.copyFormat(inline.characterFormat);\n                }\n                else {\n                    if (!isNullOrUndefined(this.getPreviousTextElement(inline))) {\n                        this.characterFormat.copyFormat(this.getPreviousTextElement(inline).characterFormat);\n                    }\n                    else if (!isNullOrUndefined(this.getNextTextElement(inline))) {\n                        this.characterFormat.copyFormat(this.getNextTextElement(inline).characterFormat);\n                    }\n                    else {\n                        this.characterFormat.copyFormat(para.characterFormat);\n                    }\n                }\n                return true;\n            }\n            else {\n                if (index === inline.length && !isNullOrUndefined(inline.nextNode)) {\n                    this.characterFormat.copyFormat(this.getNextValidCharacterFormat(inline));\n                }\n                else if (inline instanceof TextElementBox) {\n                    this.characterFormat.copyFormat(inline.characterFormat);\n                }\n                else if (inline instanceof FieldElementBox) {\n                    this.characterFormat.copyFormat(this.getNextValidCharacterFormatOfField(inline));\n                }\n            }\n        }\n        else {\n            if (length === endPos.offset) {\n                if (inline instanceof TextElementBox || inline instanceof FieldElementBox) {\n                    this.characterFormat.copyFormat(inline.characterFormat);\n                }\n                else if (!isNullOrUndefined(inline)) {\n                    inline = this.getPreviousTextElement(inline);\n                    if (!isNullOrUndefined(inline)) {\n                        this.characterFormat.copyFormat(inline.characterFormat);\n                    }\n                }\n                else {\n                    this.characterFormat.copyFormat(para.characterFormat);\n                }\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getCharacterFormatForBlock = function (block, start, end) {\n        if (block instanceof ParagraphWidget) {\n            this.getCharacterFormat(block, start, end);\n        }\n        else {\n            this.getCharacterFormatInTable(block, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getCharacterFormatInTable = function (table, start, end) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.getCharacterFormatForSelectionCell(row.childWidgets[j], start, end);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(row, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var blockAdv = this.getNextRenderedBlock(table);\n        // //Goto the next block.\n        this.getCharacterFormatForBlock(blockAdv, start, end);\n    };\n    /**\n     * Get character format in selection\n     * @private\n     */\n    Selection.prototype.getCharacterFormatForSelectionCell = function (cell, start, end) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            this.getCharacterFormatForBlock(cell.childWidgets[i], start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getCharacterFormatInternal = function (paragraph, selection) {\n        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n            var linewidget = paragraph.childWidgets[i];\n            for (var j = 0; j < linewidget.children.length; j++) {\n                var element = linewidget.children[j];\n                if (!(element instanceof ImageElementBox || element instanceof FieldElementBox)) {\n                    selection.characterFormat.combineFormat(element.characterFormat);\n                }\n            }\n        }\n    };\n    /**\n     * Get next valid character format from inline\n     * @private\n     */\n    Selection.prototype.getNextValidCharacterFormat = function (inline) {\n        var startInline = this.getNextTextElement(inline);\n        if (isNullOrUndefined(startInline)) {\n            return inline.characterFormat;\n        }\n        var fieldBegin = undefined;\n        if (startInline instanceof FieldElementBox) {\n            if (fieldBegin.fieldType === 0) {\n                fieldBegin = startInline;\n            }\n        }\n        if (isNullOrUndefined(fieldBegin)) {\n            return startInline.characterFormat;\n        }\n        else {\n            return this.getNextValidCharacterFormatOfField(fieldBegin);\n        }\n    };\n    /**\n     * Get next valid paragraph format from field\n     * @private\n     */\n    Selection.prototype.getNextValidCharacterFormatOfField = function (fieldBegin) {\n        var startInline = fieldBegin;\n        if (HelperMethods.isLinkedFieldCharacter(fieldBegin)) {\n            if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                startInline = fieldBegin.fieldEnd;\n            }\n            else {\n                startInline = fieldBegin.fieldSeparator;\n            }\n        }\n        var nextValidInline = undefined;\n        if (!isNullOrUndefined(startInline.nextNode)) {\n            //Check the next node is a valid and returns inline.\n            nextValidInline = this.getNextValidElement(startInline.nextNode);\n        }\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            return startInline.characterFormat;\n        }\n        return nextValidInline.characterFormat;\n    };\n    /**\n     * Return true if cursor point with in selection range\n     * @private\n     */\n    Selection.prototype.checkCursorIsInSelection = function (widget, point) {\n        if (isNullOrUndefined(this.start) || this.isEmpty || isNullOrUndefined(widget)) {\n            return false;\n        }\n        var isSelected = false;\n        do {\n            if (this.selectedWidgets.containsKey(widget)) {\n                var top_4 = void 0;\n                var left = void 0;\n                if (widget instanceof LineWidget) {\n                    top_4 = this.owner.selection.getTop(widget);\n                    left = this.owner.selection.getLeft(widget);\n                }\n                else {\n                    top_4 = widget.y;\n                    left = widget.x;\n                }\n                var widgetInfo = this.selectedWidgets.get(widget);\n                isSelected = widgetInfo.left <= point.x && top_4 <= point.y &&\n                    top_4 + widget.height >= point.y && widgetInfo.left + widgetInfo.width >= point.x;\n            }\n            widget = (widget instanceof LineWidget) ? widget.paragraph : widget.containerWidget;\n        } while (!isNullOrUndefined(widget) && !isSelected);\n        return isSelected;\n    };\n    /**\n     * Copy paragraph for to selection paragraph format\n     * @private\n     */\n    Selection.prototype.copySelectionParagraphFormat = function () {\n        var format = new WParagraphFormat();\n        this.paragraphFormat.copyToFormat(format);\n        return format;\n    };\n    /**\n     * Get hyperlink display text\n     * @private\n     */\n    // tslint:disable-next-line\n    Selection.prototype.getHyperlinkDisplayText = function (paragraph, fieldSeparator, fieldEnd, isNestedField, format) {\n        var para = paragraph;\n        if (para !== fieldEnd.line.paragraph) {\n            isNestedField = true;\n            return { displayText: '<<Selection in Document>>', 'isNestedField': isNestedField, 'format': format };\n        }\n        var displayText = '';\n        var lineIndex = para.childWidgets.indexOf(fieldSeparator.line);\n        var index = para.childWidgets[lineIndex].children.indexOf(fieldSeparator);\n        for (var j = lineIndex; j < para.childWidgets.length; j++) {\n            var lineWidget = para.childWidgets[j];\n            if (j !== lineIndex) {\n                index = -1;\n            }\n            for (var i = index + 1; i < lineWidget.children.length; i++) {\n                var inline = lineWidget.children[i];\n                if (inline === fieldEnd) {\n                    return { 'displayText': displayText, 'isNestedField': isNestedField, 'format': format };\n                }\n                if (inline instanceof TextElementBox) {\n                    displayText += inline.text;\n                    format = inline.characterFormat;\n                }\n                else if (inline instanceof FieldElementBox) {\n                    if (inline instanceof FieldElementBox && inline.fieldType === 0\n                        && !isNullOrUndefined(inline.fieldEnd)) {\n                        if (isNullOrUndefined(inline.fieldSeparator)) {\n                            index = lineWidget.children.indexOf(inline.fieldEnd);\n                        }\n                        else {\n                            index = lineWidget.children.indexOf(inline.fieldSeparator);\n                        }\n                    }\n                }\n                else {\n                    isNestedField = true;\n                    return { 'displayText': '<<Selection in Document>>', 'isNestedField': isNestedField, 'format': format };\n                }\n            }\n        }\n        return { 'displayText': displayText, 'isNestedField': isNestedField, 'format': format };\n    };\n    /**\n     * Navigates hyperlink on mouse Event.\n     * @private\n     */\n    Selection.prototype.navigateHyperLinkOnEvent = function (cursorPoint, isTouchInput) {\n        var _this = this;\n        var widget = this.viewer.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget)) {\n            var hyperLinkField = this.getHyperLinkFieldInCurrentSelection(widget, cursorPoint);\n            //Invokes Hyperlink navigation events.\n            if (!isNullOrUndefined(hyperLinkField)) {\n                this.viewer.updateTextPositionForSelection(cursorPoint, 1);\n                this.fireRequestNavigate(hyperLinkField);\n                setTimeout(function () {\n                    if (_this.viewer) {\n                        _this.viewer.isTouchInput = isTouchInput;\n                        _this.viewer.updateFocus();\n                        _this.viewer.isTouchInput = false;\n                    }\n                });\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getLinkText = function (fieldBegin) {\n        var hyperlink = new Hyperlink(fieldBegin, this);\n        var link = hyperlink.navigationLink;\n        if (hyperlink.localReference.length > 0) {\n            if (hyperlink.localReference[0] === '_' && (isNullOrUndefined(link) || link.length === 0)) {\n                link = 'Current Document';\n            }\n            else {\n                link += '#' + hyperlink.localReference;\n            }\n        }\n        hyperlink.destroy();\n        return link;\n    };\n    /**\n     * Set Hyperlink content to tool tip element\n     * @private\n     */\n    Selection.prototype.setHyperlinkContentToToolTip = function (fieldBegin, widget, xPos) {\n        if (fieldBegin) {\n            if (this.owner.contextMenuModule &&\n                this.owner.contextMenuModule.contextMenuInstance.element.style.display === 'block') {\n                return;\n            }\n            if (!this.toolTipElement) {\n                this.toolTipElement = createElement('div', { className: 'e-de-tooltip' });\n                this.viewer.viewerContainer.appendChild(this.toolTipElement);\n            }\n            this.toolTipElement.style.display = 'block';\n            var l10n = new L10n('documenteditor', this.owner.defaultLocale);\n            l10n.setLocale(this.owner.locale);\n            var toolTipText = l10n.getConstant('Click to follow link');\n            if (this.owner.useCtrlClickToFollowHyperlink) {\n                toolTipText = 'Ctrl+' + toolTipText;\n            }\n            var linkText = this.getLinkText(fieldBegin);\n            this.toolTipElement.innerHTML = linkText + '</br><b>' + toolTipText + '</b>';\n            var widgetTop = this.getTop(widget) * this.viewer.zoomFactor;\n            var page = this.getPage(widget.paragraph);\n            var containerWidth = this.viewer.viewerContainer.getBoundingClientRect().width + this.viewer.viewerContainer.scrollLeft;\n            var left = page.boundingRectangle.x + xPos * this.viewer.zoomFactor;\n            if ((left + this.toolTipElement.clientWidth + 10) > containerWidth) {\n                left = left - ((this.toolTipElement.clientWidth - (containerWidth - left)) + 15);\n            }\n            var top_5 = this.getPageTop(page) + (widgetTop - this.toolTipElement.offsetHeight);\n            top_5 = top_5 > this.viewer.viewerContainer.scrollTop ? top_5 : top_5 + widget.height + this.toolTipElement.offsetHeight;\n            this.showToolTip(left, top_5);\n            if (!isNullOrUndefined(this.toolTipField) && fieldBegin !== this.toolTipField) {\n                this.toolTipObject.position = { X: left, Y: top_5 };\n            }\n            this.toolTipObject.show();\n            this.toolTipField = fieldBegin;\n        }\n        else {\n            this.hideToolTip();\n        }\n    };\n    /**\n     * Show hyperlink tooltip\n     * @private\n     */\n    Selection.prototype.showToolTip = function (x, y) {\n        if (!this.toolTipObject) {\n            this.toolTipObject = new Popup(this.toolTipElement, {\n                height: 'auto',\n                width: 'auto',\n                relateTo: this.viewer.viewerContainer.parentElement,\n                position: { X: x, Y: y }\n            });\n        }\n    };\n    /**\n     * Hide tooltip object\n     * @private\n     */\n    Selection.prototype.hideToolTip = function () {\n        this.toolTipField = undefined;\n        if (this.toolTipObject) {\n            this.toolTipObject.hide();\n            this.toolTipObject.destroy();\n            this.toolTipObject = undefined;\n            this.toolTipElement.style.display = 'none';\n        }\n    };\n    /**\n     * Return hyperlink field\n     * @private\n     */\n    Selection.prototype.getHyperLinkFieldInCurrentSelection = function (widget, cursorPosition) {\n        var inline = undefined;\n        var top = this.getTop(widget);\n        var lineStartLeft = this.getLineStartLeft(widget);\n        if (cursorPosition.y < top || cursorPosition.y > top + widget.height\n            || cursorPosition.x < lineStartLeft || cursorPosition.x > lineStartLeft + widget.paragraph.width) {\n            return undefined;\n        }\n        var left = widget.paragraph.x;\n        var elementValues = this.getFirstElement(widget, left);\n        left = elementValues.left;\n        var element = elementValues.element;\n        if (isNullOrUndefined(element)) {\n            var width = this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n            if (cursorPosition.x <= lineStartLeft + width || cursorPosition.x >= lineStartLeft + width) {\n                //Check if paragraph is within a field result.\n                var checkedFields = [];\n                var field = this.getHyperLinkFields(widget.paragraph, checkedFields);\n                checkedFields = [];\n                checkedFields = undefined;\n                return field;\n            }\n        }\n        else {\n            if (cursorPosition.x > left + element.margin.left) {\n                for (var i = widget.children.indexOf(element); i < widget.children.length; i++) {\n                    element = widget.children[i];\n                    if (cursorPosition.x < left + element.margin.left + element.width || i === widget.children.length - 1) {\n                        break;\n                    }\n                    left += element.margin.left + element.width;\n                }\n            }\n            inline = element;\n            var width = element.margin.left + element.width;\n            if (isNullOrUndefined(inline.nextNode)) {\n                //Include width of Paragraph mark.\n                width += this.viewer.textHelper.getParagraphMarkWidth(inline.line.paragraph.characterFormat);\n            }\n            if (cursorPosition.x <= left + width) {\n                //Check if inline is within a field result.\n                var checkedFields = [];\n                var field = this.getHyperLinkFieldInternal(inline.line.paragraph, inline, checkedFields);\n                checkedFields = [];\n                checkedFields = undefined;\n                return field;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Return field if paragraph contain hyperlink field\n     * @private\n     */\n    Selection.prototype.getHyperlinkField = function () {\n        if (isNullOrUndefined(this.end)) {\n            return undefined;\n        }\n        var index = 0;\n        var currentInline = this.end.currentWidget.getInline(this.end.offset, index);\n        index = currentInline.index;\n        var inline = currentInline.element;\n        var checkedFields = [];\n        var field = undefined;\n        if (isNullOrUndefined(inline)) {\n            field = this.getHyperLinkFields(this.end.paragraph, checkedFields);\n        }\n        else {\n            var paragraph = inline.line.paragraph;\n            field = this.getHyperLinkFieldInternal(paragraph, inline, checkedFields);\n        }\n        checkedFields = [];\n        return field;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getHyperLinkFields = function (paragraph, checkedFields) {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            if (checkedFields.indexOf(this.viewer.fields[i]) !== -1 || isNullOrUndefined(this.viewer.fields[i].fieldSeparator)) {\n                continue;\n            }\n            else {\n                checkedFields.push(this.viewer.fields[i]);\n            }\n            var field = this.getFieldCode(this.viewer.fields[i]);\n            field = field.trim().toLowerCase();\n            if (field.match('hyperlink ') && this.paragraphIsInFieldResult(this.viewer.fields[i], paragraph)) {\n                return this.viewer.fields[i];\n            }\n        }\n        // if (paragraph.containerWidget instanceof BodyWidget && !(paragraph instanceof WHeaderFooter)) {\n        //     return this.getHyperLinkFields((paragraph.con as WCompositeNode), checkedFields);\n        // }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getHyperLinkFieldInternal = function (paragraph, inline, fields) {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            if (fields.indexOf(this.viewer.fields[i]) !== -1 || isNullOrUndefined(this.viewer.fields[i].fieldSeparator)) {\n                continue;\n            }\n            else {\n                fields.push(this.viewer.fields[i]);\n            }\n            var fieldCode = this.getFieldCode(this.viewer.fields[i]);\n            fieldCode = fieldCode.trim().toLowerCase();\n            if (fieldCode.match('hyperlink ') && (this.inlineIsInFieldResult(this.viewer.fields[i], inline) || this.isImageField())) {\n                return this.viewer.fields[i];\n            }\n        }\n        if (paragraph.containerWidget instanceof BodyWidget && !(paragraph instanceof HeaderFooterWidget)) {\n            return this.getHyperLinkFieldInternal(paragraph.containerWidget, inline, fields);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getBlock = function (currentIndex) {\n        if (currentIndex === '' || isNullOrUndefined(currentIndex)) {\n            return undefined;\n        }\n        var index = { index: currentIndex };\n        var page = this.start.getPage(index);\n        var bodyIndex = index.index.indexOf(';');\n        var value = index.index.substring(0, bodyIndex);\n        index.index = index.index.substring(bodyIndex).replace(';', '');\n        var bodyWidget = page.bodyWidgets[parseInt(value, 10)];\n        return this.getBlockInternal(bodyWidget, index.index);\n    };\n    /**\n     * Return Block relative to position\n     * @private\n     */\n    Selection.prototype.getBlockInternal = function (widget, position) {\n        if (position === '' || isNullOrUndefined(position)) {\n            return undefined;\n        }\n        var index = position.indexOf(';');\n        var value = position.substring(0, index);\n        position = position.substring(index).replace(';', '');\n        var node = widget;\n        // if (node instanceof Widget && value === 'HF') {\n        //     //Gets the block in Header footers.\n        //     let blockObj: BlockInfo = this.getBlock((node as WSection).headersFooters, position);\n        // tslint:disable-next-line:max-line-length\n        //     return { 'node': (!isNullOrUndefined(blockObj)) ? blockObj.node : undefined, 'position': (!isNullOrUndefined(blockObj)) ? blockObj.position : undefined };\n        // }\n        index = parseInt(value, 10);\n        if (index >= 0 && index < widget.childWidgets.length) {\n            var child = widget.childWidgets[(index)];\n            if (position.indexOf(';') >= 0) {\n                if (child instanceof ParagraphWidget) {\n                    if (position.indexOf(';') >= 0) {\n                        position = '0';\n                    }\n                    return child;\n                }\n                if (child instanceof BlockWidget) {\n                    var blockObj = this.getBlockInternal(child, position);\n                    return blockObj;\n                }\n            }\n            else {\n                return child;\n            }\n        }\n        else {\n            return node;\n        }\n        return node;\n    };\n    /**\n     * Return true if inline is in field result\n     * @private\n     */\n    Selection.prototype.inlineIsInFieldResult = function (fieldBegin, inline) {\n        if (!isNullOrUndefined(fieldBegin.fieldEnd) && !isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            if (this.isExistBeforeInline(fieldBegin.fieldSeparator, inline)) {\n                return this.isExistAfterInline(fieldBegin.fieldEnd, inline);\n            }\n        }\n        return false;\n    };\n    /**\n     * Retrieve true if paragraph is in field result\n     * @private\n     */\n    Selection.prototype.paragraphIsInFieldResult = function (fieldBegin, paragraph) {\n        if (!isNullOrUndefined(fieldBegin.fieldEnd) && !isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            var fieldParagraph = fieldBegin.fieldSeparator.line.paragraph;\n            if (fieldBegin.fieldSeparator.line.paragraph === paragraph\n                || this.isExistBefore(fieldParagraph, paragraph)) {\n                var currentParagraph = fieldBegin.fieldEnd.line.paragraph;\n                return (currentParagraph !== paragraph && this.isExistAfter(fieldParagraph, paragraph));\n            }\n        }\n        return false;\n    };\n    /**\n     * Return true if image is In field\n     * @private\n     */\n    Selection.prototype.isImageField = function () {\n        if (this.start.paragraph.isEmpty() || this.end.paragraph.isEmpty()) {\n            return false;\n        }\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        var indexInInline = 0;\n        var inlineInfo = startPosition.paragraph.getInline(startPosition.offset, indexInInline);\n        var inline = inlineInfo.element;\n        indexInInline = inlineInfo.index;\n        if (indexInInline === inline.length) {\n            inline = this.getNextRenderedElementBox(inline, indexInInline);\n        }\n        inlineInfo = endPosition.paragraph.getInline(endPosition.offset, indexInInline);\n        var endInline = inlineInfo.element;\n        indexInInline = inlineInfo.index;\n        if (inline instanceof FieldElementBox && inline.fieldType === 0\n            && endInline instanceof FieldElementBox && endInline.fieldType === 1 && inline.fieldSeparator) {\n            var fieldValue = inline.fieldSeparator.nextNode;\n            if (fieldValue instanceof ImageElementBox && fieldValue.nextNode === endInline) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isTableSelected = function () {\n        var start = this.start;\n        var end = this.end;\n        if (!this.isForward) {\n            start = this.end;\n            end = this.start;\n        }\n        if (isNullOrUndefined(start.paragraph.associatedCell) ||\n            isNullOrUndefined(end.paragraph.associatedCell)) {\n            return false;\n        }\n        var table = start.paragraph.associatedCell.ownerTable.getSplitWidgets();\n        var firstParagraph = this.getFirstBlockInFirstCell(table[0]);\n        var lastParagraph = this.getLastBlockInLastCell(table[table.length - 1]);\n        return start.paragraph.associatedCell.equals(firstParagraph.associatedCell) &&\n            end.paragraph.associatedCell.equals(lastParagraph.associatedCell)\n            && (!firstParagraph.associatedCell.equals(lastParagraph.associatedCell) || (start.offset === 0\n                && end.offset === this.getLineLength(lastParagraph.lastChild) + 1));\n    };\n    /**\n     * Select List Text\n     * @private\n     */\n    Selection.prototype.selectListText = function () {\n        var lineWidget = this.viewer.selectionLineWidget;\n        var endOffset = '0';\n        var selectionIndex = lineWidget.getHierarchicalIndex(endOffset);\n        var startPosition = this.getTextPosition(selectionIndex);\n        var endPosition = this.getTextPosition(selectionIndex);\n        this.selectRange(startPosition, endPosition);\n        this.highlightListText(this.viewer.selectionLineWidget);\n        this.contextTypeInternal = 'List';\n    };\n    /**\n     * Manually select the list text\n     * @private\n     */\n    Selection.prototype.highlightListText = function (linewidget) {\n        var width = linewidget.children[0].width;\n        var left = this.viewer.getLeftValue(linewidget);\n        var top = linewidget.paragraph.y;\n        this.createHighlightBorder(linewidget, width, left, top, false);\n        this.viewer.isListTextSelected = true;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.updateImageSize = function (imageFormat) {\n        this.owner.isShiftingEnabled = true;\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        var inline = null;\n        var index = 0;\n        var paragraph = startPosition.paragraph;\n        if (paragraph === endPosition.paragraph\n            && startPosition.offset + 1 === endPosition.offset) {\n            var inlineObj = paragraph.getInline(endPosition.offset, index);\n            inline = inlineObj.element;\n            index = inlineObj.index;\n        }\n        if (inline instanceof ImageElementBox) {\n            var width = inline.width;\n            var height = inline.height;\n            inline.width = imageFormat.width;\n            inline.height = imageFormat.height;\n            imageFormat.width = width;\n            imageFormat.height = height;\n            if (paragraph !== null && paragraph.containerWidget !== null && this.owner.editorModule) {\n                var lineIndex = paragraph.childWidgets.indexOf(inline.line);\n                var elementIndex = inline.line.children.indexOf(inline);\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n                this.highlightSelection(false);\n            }\n        }\n    };\n    /**\n     * Gets selected table content\n     * @private\n     */\n    Selection.prototype.getSelectedCellsInTable = function (table, startCell, endCell) {\n        var startColumnIndex = startCell.columnIndex;\n        var endColumnIndex = endCell.columnIndex + endCell.cellFormat.columnSpan - 1;\n        var startRowindex = startCell.ownerRow.index;\n        var endRowIndex = endCell.ownerRow.index;\n        var cells = [];\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.index >= startRowindex && row.index <= endRowIndex) {\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    var cell = row.childWidgets[j];\n                    if (cell.columnIndex >= startColumnIndex && cell.columnIndex <= endColumnIndex) {\n                        cells.push(cell);\n                    }\n                }\n            }\n            if (row.index > endRowIndex) {\n                break;\n            }\n        }\n        return cells;\n        // return html;\n    };\n    /**\n     * Copies the selected content to clipboard.\n     */\n    Selection.prototype.copy = function () {\n        if (this.isEmpty) {\n            return;\n        }\n        this.copySelectedContent(false);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.copySelectedContent = function (isCut) {\n        if (isNullOrUndefined(this.owner.sfdtExportModule)) {\n            return;\n        }\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        /* tslint:disable:no-any */\n        // tslint:disable-next-line:max-line-length\n        var document = this.owner.sfdtExportModule.write(startPosition.currentWidget, startPosition.offset, endPosition.currentWidget, endPosition.offset, true);\n        /* tslint:enable:no-any */\n        if (this.owner.editorModule) {\n            this.owner.editorModule.copiedData = JSON.stringify(document);\n        }\n        var html = this.htmlWriter.writeHtml(document);\n        this.copyToClipboard(html);\n        if (isCut && this.owner.editorModule) {\n            this.owner.editorModule.handleCut(this);\n        }\n        this.viewer.updateFocus();\n    };\n    /**\n     * Copy content to clipboard\n     * @private\n     */\n    Selection.prototype.copyToClipboard = function (htmlContent) {\n        window.getSelection().removeAllRanges();\n        var div = document.createElement('div');\n        div.style.left = '-10000px';\n        div.style.top = '-10000px';\n        div.innerHTML = htmlContent;\n        document.body.appendChild(div);\n        var range = document.createRange();\n        range.selectNodeContents(div);\n        window.getSelection().addRange(range);\n        var copySuccess = false;\n        try {\n            copySuccess = document.execCommand('copy');\n        }\n        catch (e) {\n            // Copying data to Clipboard can potentially fail - for example, if another application is holding Clipboard open.\n        }\n        finally {\n            window.getSelection().removeAllRanges();\n            div.parentNode.removeChild(div);\n            this.viewer.viewerContainer.focus();\n        }\n        return copySuccess;\n    };\n    // Caret implementation starts\n    /**\n     * Shows caret in current selection position.\n     * @private\n     */\n    Selection.prototype.showCaret = function () {\n        // tslint:disable-next-line:max-line-length\n        var page = !isNullOrUndefined(this.viewer.currentPage) ? this.viewer.currentPage : this.viewer.currentRenderingPage;\n        if (isNullOrUndefined(page) || this.viewer.isRowOrCellResizing || this.owner.enableImageResizerMode && this.owner.imageResizerModule.isImageResizerVisible) {\n            return;\n        }\n        var left = page.boundingRectangle.x;\n        var right = page.boundingRectangle.width * this.viewer.zoomFactor + left;\n        if (!this.owner.enableImageResizerMode || !this.owner.imageResizerModule.isImageResizerVisible) {\n            // tslint:disable-next-line:max-line-length\n            if (this.isEmpty && (!this.owner.isReadOnlyMode || this.owner.enableCursorOnReadOnly)) {\n                var caretLeft = parseInt(this.caret.style.left.replace('px', ''), 10);\n                if (caretLeft < left || caretLeft > right) {\n                    this.caret.style.display = 'none';\n                }\n                else {\n                    this.caret.style.display = 'block';\n                }\n            }\n            else if (this.isImageSelected && !this.owner.enableImageResizerMode) {\n                this.caret.style.display = 'block';\n            }\n            else {\n                if (this.caret.style.display === 'block' || isNullOrUndefined(this)) {\n                    if (!this.viewer.isComposingIME) {\n                        this.caret.style.display = 'none';\n                    }\n                }\n            }\n        }\n        if (!isNullOrUndefined(this) && this.viewer.isTouchInput && !this.owner.isReadOnlyMode) {\n            var caretStartLeft = parseInt(this.viewer.touchStart.style.left.replace('px', ''), 10) + 14;\n            var caretEndLeft = parseInt(this.viewer.touchEnd.style.left.replace('px', ''), 10) + 14;\n            var page_1 = this.getSelectionPage(this.start);\n            if (page_1) {\n                if (caretEndLeft < left || caretEndLeft > right) {\n                    this.viewer.touchEnd.style.display = 'none';\n                }\n                else {\n                    this.viewer.touchEnd.style.display = 'block';\n                }\n                if (!this.isEmpty) {\n                    left = page_1.boundingRectangle.x;\n                    right = page_1.boundingRectangle.width * this.viewer.zoomFactor + left;\n                }\n                if (caretStartLeft < left || caretStartLeft > right) {\n                    this.viewer.touchStart.style.display = 'none';\n                }\n                else {\n                    this.viewer.touchStart.style.display = 'block';\n                }\n            }\n        }\n        else {\n            this.viewer.touchStart.style.display = 'none';\n            this.viewer.touchEnd.style.display = 'none';\n        }\n    };\n    /**\n     * To set the editable div caret position\n     * @private\n     */\n    Selection.prototype.setEditableDivCaretPosition = function (index) {\n        this.viewer.editableDiv.focus();\n        var child = this.viewer.editableDiv.childNodes[this.viewer.editableDiv.childNodes.length - 1];\n        if (child) {\n            var range = document.createRange();\n            range.setStart(child, index);\n            range.collapse(true);\n            window.getSelection().removeAllRanges();\n            window.getSelection().addRange(range);\n        }\n    };\n    /**\n     * Initializes caret.\n     * @private\n     */\n    Selection.prototype.initCaret = function () {\n        this.caret = createElement('div', {\n            styles: 'position:absolute',\n            className: 'e-de-blink-cursor e-de-cursor-animation'\n        });\n        this.viewer.viewerContainer.appendChild(this.caret);\n    };\n    /**\n     * Updates caret position.\n     * @private\n     */\n    Selection.prototype.updateCaretPosition = function () {\n        var caretPosition = this.end.location;\n        var page = this.getSelectionPage(this.end);\n        if (page) {\n            this.caret.style.left = page.boundingRectangle.x + (Math.round(caretPosition.x) * this.viewer.zoomFactor) + 'px';\n            var caretInfo = this.updateCaretSize(this.owner.selection.end);\n            var topMargin = caretInfo.topMargin;\n            var caretHeight = caretInfo.height;\n            var viewer = this.viewer;\n            // tslint:disable-next-line:max-line-length\n            var pageTop = (page.boundingRectangle.y - viewer.pageGap * (this.viewer.pages.indexOf(page) + 1)) * this.viewer.zoomFactor + viewer.pageGap * (this.viewer.pages.indexOf(page) + 1);\n            this.caret.style.top = pageTop + (Math.round(caretPosition.y + topMargin) * this.viewer.zoomFactor) + 'px';\n            if (this.owner.selection.characterFormat.baselineAlignment === 'Subscript') {\n                this.caret.style.top = parseFloat(this.caret.style.top) + (parseFloat(this.caret.style.height) / 2) + 'px';\n            }\n            if (this.viewer.isTouchInput || this.viewer.touchStart.style.display !== 'none') {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.touchStart.style.left = page.boundingRectangle.x + (Math.round(caretPosition.x) * this.viewer.zoomFactor - 14) + 'px';\n                this.viewer.touchStart.style.top = pageTop + ((caretPosition.y + caretInfo.height) * this.viewer.zoomFactor) + 'px';\n                // tslint:disable-next-line:max-line-length\n                this.viewer.touchEnd.style.left = page.boundingRectangle.x + (Math.round(caretPosition.x) * this.viewer.zoomFactor - 14) + 'px';\n                this.viewer.touchEnd.style.top = pageTop + ((caretPosition.y + caretInfo.height) * this.viewer.zoomFactor) + 'px';\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getRect = function (position) {\n        var caretPosition = position.location;\n        var page = this.getSelectionPage(position);\n        if (page) {\n            var viewer = this.viewer;\n            var left = page.boundingRectangle.x + (Math.round(caretPosition.x) * viewer.zoomFactor);\n            var pageGap = viewer.pageGap;\n            // tslint:disable-next-line:max-line-length\n            var pageTop = (page.boundingRectangle.y - pageGap * (page.index + 1)) * viewer.zoomFactor + pageGap * (page.index + 1);\n            var top_6 = pageTop + (Math.round(caretPosition.y) * viewer.zoomFactor);\n            return new Point(left, top_6);\n        }\n        return new Point(0, 0);\n    };\n    /**\n     * Gets current selected page\n     * @private\n     */\n    Selection.prototype.getSelectionPage = function (position) {\n        var lineWidget = this.getLineWidgetInternal(position.currentWidget, position.offset, true);\n        if (lineWidget) {\n            return this.getPage(lineWidget.paragraph);\n        }\n        return undefined;\n    };\n    /**\n     * Updates caret size.\n     * @private\n     */\n    Selection.prototype.updateCaretSize = function (textPosition, skipUpdate) {\n        var topMargin = 0;\n        var isItalic = false;\n        var caret;\n        var index = 0;\n        var caretHeight = 0;\n        if (this.characterFormat.italic) {\n            isItalic = this.characterFormat.italic;\n        }\n        if (textPosition.paragraph.isEmpty()) {\n            var paragraph = textPosition.paragraph;\n            var bottomMargin = 0;\n            var paragraphInfo = this.getParagraphMarkSize(paragraph, topMargin, bottomMargin);\n            topMargin = paragraphInfo.topMargin;\n            bottomMargin = paragraphInfo.bottomMargin;\n            var height = paragraphInfo.height;\n            caretHeight = topMargin < 0 ? topMargin + height : height;\n            if (!skipUpdate) {\n                this.caret.style.height = caretHeight * this.viewer.zoomFactor + 'px';\n            }\n            topMargin = 0;\n        }\n        else {\n            var inlineInfo = textPosition.currentWidget.getInline(textPosition.offset, index);\n            index = inlineInfo.index;\n            var inline = inlineInfo.element;\n            if (!isNullOrUndefined(inline)) {\n                caret = this.getCaretHeight(inline, index, inline.characterFormat, true, topMargin, isItalic);\n                caretHeight = caret.height;\n                if (!skipUpdate) {\n                    this.caret.style.height = caret.height * this.viewer.zoomFactor + 'px';\n                }\n            }\n        }\n        if (!skipUpdate) {\n            if (isItalic) {\n                this.caret.style.transform = 'rotate(13deg)';\n            }\n            else {\n                this.caret.style.transform = '';\n            }\n        }\n        return {\n            'topMargin': topMargin,\n            'height': caretHeight\n        };\n    };\n    /**\n     * Updates caret to page.\n     * @private\n     */\n    Selection.prototype.updateCaretToPage = function (startPosition, endPage) {\n        if (!isNullOrUndefined(endPage)) {\n            this.viewer.selectionEndPage = endPage;\n            if (this.owner.selection.isEmpty) {\n                this.viewer.selectionStartPage = endPage;\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                var startLineWidget = this.getLineWidgetParagraph(startPosition.offset, startPosition.paragraph.childWidgets[0]);\n                //Gets start page.\n                var startPage = this.getPage(startLineWidget.paragraph);\n                if (!isNullOrUndefined(startPage)) {\n                    this.viewer.selectionStartPage = startPage;\n                }\n            }\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Gets caret bottom position.\n     * @private\n     */\n    Selection.prototype.getCaretBottom = function (textPosition, isEmptySelection) {\n        var bottom = textPosition.location.y;\n        if (textPosition.paragraph.isEmpty()) {\n            var paragraph = textPosition.paragraph;\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var sizeInfo = this.getParagraphMarkSize(paragraph, topMargin, bottomMargin);\n            topMargin = sizeInfo.topMargin;\n            bottomMargin = sizeInfo.bottomMargin;\n            bottom += sizeInfo.height;\n            bottom += topMargin;\n            if (!isEmptySelection) {\n                bottom += bottomMargin;\n            }\n        }\n        else {\n            var index = 0;\n            var inlineInfo = textPosition.paragraph.getInline(textPosition.offset, index);\n            var inline = inlineInfo.element;\n            index = inlineInfo.index;\n            var topMargin = 0;\n            var isItalic = false;\n            // tslint:disable-next-line:max-line-length\n            var caretHeightInfo = this.getCaretHeight(inline, index, inline.characterFormat, false, topMargin, isItalic);\n            topMargin = caretHeightInfo.topMargin;\n            isItalic = caretHeightInfo.isItalic;\n            bottom += caretHeightInfo.height;\n            if (isEmptySelection) {\n                bottom -= HelperMethods.convertPointToPixel(textPosition.paragraph.paragraphFormat.afterSpacing);\n            }\n        }\n        return bottom;\n    };\n    /**\n     * Checks for cursor visibility.\n     * @param isTouch\n     * @private\n     */\n    Selection.prototype.checkForCursorVisibility = function () {\n        this.showCaret();\n    };\n    // caret implementation ends\n    /**\n     * Keyboard shortcuts\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Selection.prototype.onKeyDownInternal = function (event, ctrl, shift, alt) {\n        var key = event.which || event.keyCode;\n        if (ctrl && !shift && !alt) {\n            this.viewer.isControlPressed = true;\n            switch (key) {\n                // case 9:\n                //     event.preventDefault();\n                //     if (this.owner.acceptTab) {\n                //         this.selection.handleTabKey(false, false);\n                //     }\n                //     break;\n                case 35:\n                    this.handleControlEndKey();\n                    break;\n                case 36:\n                    this.handleControlHomeKey();\n                    break;\n                case 37:\n                    this.handleControlLeftKey();\n                    break;\n                case 38:\n                    this.handleControlUpKey();\n                    break;\n                case 39:\n                    this.handleControlRightKey();\n                    break;\n                case 40:\n                    this.handleControlDownKey();\n                    break;\n                case 65:\n                    this.owner.selection.selectAll();\n                    break;\n                case 67:\n                    event.preventDefault();\n                    this.copy();\n                    break;\n                case 70:\n                    event.preventDefault();\n                    if (!isNullOrUndefined(this.owner.optionsPaneModule)) {\n                        this.owner.optionsPaneModule.showHideOptionsPane(true);\n                    }\n                    break;\n            }\n        }\n        else if (shift && !ctrl && !alt) {\n            switch (key) {\n                case 35:\n                    this.handleShiftEndKey();\n                    event.preventDefault();\n                    break;\n                case 36:\n                    this.handleShiftHomeKey();\n                    event.preventDefault();\n                    break;\n                case 37:\n                    this.handleShiftLeftKey();\n                    event.preventDefault();\n                    break;\n                case 38:\n                    this.handleShiftUpKey();\n                    event.preventDefault();\n                    break;\n                case 39:\n                    this.handleShiftRightKey();\n                    event.preventDefault();\n                    break;\n                case 40:\n                    this.handleShiftDownKey();\n                    event.preventDefault();\n                    break;\n            }\n        }\n        else if (shift && ctrl && !alt) {\n            switch (key) {\n                case 35:\n                    this.handleControlShiftEndKey();\n                    break;\n                case 36:\n                    this.handleControlShiftHomeKey();\n                    break;\n                case 37:\n                    this.handleControlShiftLeftKey();\n                    break;\n                case 38:\n                    this.handleControlShiftUpKey();\n                    break;\n                case 39:\n                    this.handleControlShiftRightKey();\n                    break;\n                case 40:\n                    this.handleControlShiftDownKey();\n                    break;\n            }\n        }\n        else {\n            switch (key) {\n                // case 9:\n                //     event.preventDefault();\n                //     if (this.owner.acceptTab) {\n                //         this.handleTabKey(true, false);\n                //     }\n                //     break;             \n                case 33:\n                    event.preventDefault();\n                    this.viewer.viewerContainer.scrollTop -= this.viewer.visibleBounds.height;\n                    break;\n                case 34:\n                    event.preventDefault();\n                    this.viewer.viewerContainer.scrollTop += this.viewer.visibleBounds.height;\n                    break;\n                case 35:\n                    this.handleEndKey();\n                    event.preventDefault();\n                    break;\n                case 36:\n                    this.handleHomeKey();\n                    event.preventDefault();\n                    break;\n                case 37:\n                    this.handleLeftKey();\n                    event.preventDefault();\n                    break;\n                case 38:\n                    this.handleUpKey();\n                    event.preventDefault();\n                    break;\n                case 39:\n                    this.handleRightKey();\n                    event.preventDefault();\n                    break;\n                case 40:\n                    this.handleDownKey();\n                    event.preventDefault();\n                    break;\n            }\n        }\n        if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.onKeyDownInternal(event, ctrl, shift, alt);\n        }\n        if (this.owner.searchModule) {\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(this.owner.searchModule.searchHighlighters) && this.owner.searchModule.searchHighlighters.length > 0) {\n                this.owner.searchModule.searchResults.clear();\n            }\n        }\n        if (event.keyCode === 27 || event.which === 27) {\n            if (!isNullOrUndefined(this.owner.optionsPaneModule)) {\n                this.owner.optionsPaneModule.showHideOptionsPane(false);\n            }\n            if (this.owner.enableHeaderAndFooter) {\n                this.disableHeaderFooter();\n            }\n        }\n    };\n    //#region Enable or disable Header Footer\n    /**\n     * @private\n     */\n    Selection.prototype.checkAndEnableHeaderFooter = function (point, pagePoint) {\n        var page = this.viewer.currentPage;\n        if (this.isCursorInsidePageRect(point, page)) {\n            if (this.isCursorInHeaderRegion(point, page)) {\n                if (this.owner.enableHeaderAndFooter) {\n                    return false;\n                }\n                return this.enableHeadersFootersRegion(page.headerWidget);\n            }\n            if (this.isCursorInFooterRegion(point, page)) {\n                if (this.owner.enableHeaderAndFooter) {\n                    return false;\n                }\n                return this.enableHeadersFootersRegion(page.footerWidget);\n            }\n        }\n        if (this.owner.enableHeaderAndFooter) {\n            this.owner.enableHeaderAndFooter = false;\n            this.viewer.updateTextPositionForSelection(pagePoint, 1);\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isCursorInsidePageRect = function (point, page) {\n        if ((this.viewer.containerLeft + point.x) >= page.boundingRectangle.x &&\n            (this.viewer.containerLeft + point.x) <= (page.boundingRectangle.x + (page.boundingRectangle.width * this.viewer.zoomFactor))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isCursorInHeaderRegion = function (point, page) {\n        var pageTop = this.getPageTop(page);\n        var headerHeight = 0;\n        var header = page.headerWidget;\n        if (header) {\n            headerHeight = (header.y + header.height);\n        }\n        var isEmpty = header.isEmpty && !this.owner.enableHeaderAndFooter;\n        var topMargin = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin);\n        var pageHeight = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.pageHeight);\n        var height = isEmpty ? topMargin : Math.min(Math.max(headerHeight, topMargin), pageHeight / 100 * 40);\n        height = height * this.viewer.zoomFactor;\n        if ((this.viewer.containerTop + point.y) >= pageTop && (this.viewer.containerTop + point.y) <= pageTop + height) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isCursorInFooterRegion = function (point, page) {\n        var pageRect = page.boundingRectangle;\n        var pageTop = this.getPageTop(page);\n        var pageBottom = pageTop + (pageRect.height * this.viewer.zoomFactor);\n        var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n        var footerHeight = 0;\n        if (page.footerWidget) {\n            footerHeight = page.footerWidget.height;\n        }\n        var bottomMargin = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.bottomMargin);\n        var isEmpty = page.footerWidget.isEmpty && !this.owner.enableHeaderAndFooter;\n        var height = pageRect.height;\n        if (isEmpty) {\n            height = (height - bottomMargin) * this.viewer.zoomFactor;\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            height = (height - Math.min(pageRect.height / 100 * 40, Math.max(footerHeight + footerDistance, bottomMargin))) * this.viewer.zoomFactor;\n        }\n        if ((this.viewer.containerTop + point.y) <= pageBottom && (this.viewer.containerTop + point.y) >= pageTop + height) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.enableHeadersFootersRegion = function (widget) {\n        this.owner.enableHeaderAndFooter = true;\n        this.updateTextPositionForBlockContainer(widget);\n        this.shiftBlockOnHeaderFooterEnableDisable();\n        return true;\n    };\n    Selection.prototype.shiftBlockOnHeaderFooterEnableDisable = function () {\n        for (var i = 0; i < this.viewer.headersFooters.length; i++) {\n            var headerFooter = this.viewer.headersFooters[i];\n            var sectionFormat = this.owner.editor.getBodyWidgetInternal(i, 0).sectionFormat;\n            for (var _i = 0, _a = Object.keys(headerFooter); _i < _a.length; _i++) {\n                var key = _a[_i];\n                var widget = headerFooter[key];\n                if (widget.isEmpty) {\n                    this.owner.editor.shiftPageContent(widget.headerFooterType, sectionFormat);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.updateTextPositionForBlockContainer = function (widget) {\n        var block = widget.firstChild;\n        if (block instanceof TableWidget) {\n            block = this.getFirstBlockInFirstCell(block);\n        }\n        this.selectParagraph(block, true);\n    };\n    /**\n     * Disable Header footer\n     * @private\n     */\n    Selection.prototype.disableHeaderFooter = function () {\n        var page = this.getPage(this.start.paragraph);\n        this.updateTextPositionForBlockContainer(page.bodyWidgets[0]);\n        this.owner.enableHeaderAndFooter = false;\n        this.shiftBlockOnHeaderFooterEnableDisable();\n    };\n    //#endregion\n    /**\n     * @private\n     */\n    Selection.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.contextTypeInternal)) {\n            this.contextTypeInternal = undefined;\n        }\n        this.caret = undefined;\n        this.contextTypeInternal = undefined;\n        this.upDownSelectionLength = undefined;\n        this.viewer = undefined;\n        this.owner = undefined;\n    };\n    /**\n     * Navigates to the specified bookmark.\n     * @param name\n     * @param moveToStart\n     * @private\n     */\n    Selection.prototype.navigateBookmark = function (name, moveToStart) {\n        var bookmarks = this.viewer.bookmarks;\n        if (bookmarks.containsKey(name)) {\n            //bookmark start element\n            var bookmrkElmnt = bookmarks.get(name);\n            var offset = bookmrkElmnt.line.getOffset(bookmrkElmnt, 1);\n            var startPosition = new TextPosition(this.viewer.owner);\n            startPosition.setPositionParagraph(bookmrkElmnt.line, offset);\n            if (moveToStart) {\n                this.viewer.selection.selectRange(startPosition, startPosition);\n            }\n            else {\n                //bookmark end element\n                var bookmrkEnd = bookmrkElmnt.reference;\n                var endoffset = bookmrkEnd.line.getOffset(bookmrkEnd, 0);\n                var endPosition = new TextPosition(this.viewer.owner);\n                endPosition.setPositionParagraph(bookmrkEnd.line, endoffset);\n                //selects the bookmark range\n                this.viewer.selection.selectRange(startPosition, endPosition);\n            }\n        }\n    };\n    /**\n     * Selects the specified bookmark.\n     * @param name\n     */\n    Selection.prototype.selectBookmark = function (name) {\n        this.navigateBookmark(name);\n    };\n    /**\n     * Returns the toc field from the selection.\n     * @private\n     */\n    Selection.prototype.getTocField = function () {\n        var paragraph = this.start.paragraph;\n        var tocPara = undefined;\n        while ((paragraph !== undefined && this.isTocStyle(paragraph))) {\n            tocPara = paragraph;\n            paragraph = paragraph.previousRenderedWidget;\n        }\n        if (tocPara !== undefined) {\n            var lineWidget = tocPara.childWidgets[0];\n            if (lineWidget !== undefined) {\n                return lineWidget.children[0];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Returns true if the paragraph has toc style.\n     */\n    Selection.prototype.isTocStyle = function (paragraph) {\n        var style = paragraph.paragraphFormat.baseStyle;\n        return (style !== undefined && (style.name.toLowerCase().indexOf('toc') !== -1));\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getElementsForward = function (lineWidget, startElement, endElement, bidi) {\n        if (isNullOrUndefined(startElement)) {\n            return undefined;\n        }\n        var elements = [];\n        var elementIndex = lineWidget.children.indexOf(startElement);\n        while (elementIndex >= 0) {\n            for (var i = elementIndex; i > -1 && i < lineWidget.children.length; bidi ? i-- : i++) {\n                var inlineElement = lineWidget.children[i];\n                if (inlineElement.line === lineWidget) {\n                    if (inlineElement === endElement) {\n                        elements.push(inlineElement);\n                        elementIndex = -1;\n                        break;\n                    }\n                    else {\n                        elements.push(inlineElement);\n                    }\n                }\n                else {\n                    elementIndex = -1;\n                    break;\n                }\n            }\n            // inline = inline !== null && inline.NextNode !== null ? (inline.NextNode as Inline).GetNextRenderedInline() : null;\n            elementIndex = -1;\n        }\n        return elements.length === 0 ? undefined : elements;\n    };\n    // Gets the current line elements in inline reverse order from the end element.\n    /**\n     * @private\n     */\n    Selection.prototype.getElementsBackward = function (lineWidget, startElement, endElement, bidi) {\n        var elements = [];\n        var elementIndex = lineWidget.children.indexOf(startElement);\n        while (elementIndex >= 0) {\n            for (var i = elementIndex; i > -1 && i < lineWidget.children.length; bidi ? i++ : i--) {\n                var inlineElement = lineWidget.children[i];\n                if (inlineElement.line === lineWidget) {\n                    elements.push(inlineElement);\n                }\n                else {\n                    elementIndex = -1;\n                    break;\n                }\n            }\n            // inline = inline !== null && inline.NextNode !== null ? (inline.NextNode as Inline).GetNextRenderedInline() : null;\n            elementIndex = -1;\n        }\n        return elements;\n    };\n    return Selection;\n}());\nexport { Selection };\n","/**\n * Viewer Export\n */\nexport * from './viewer';\nexport * from './layout';\nexport * from './page';\nexport * from './render';\nexport * from './sfdt-reader';\nexport * from './text-helper';\nexport * from './zooming';\n","import { Dictionary } from '../../base/dictionary';\nimport { WListLevel } from '../list/list-level';\nimport { WCharacterFormat, WParagraphFormat } from '../format/index';\nimport { WBorder } from '../format/index';\nimport { PageLayoutViewer } from './viewer';\nimport { LineWidget, Rect, Widget, Margin, ParagraphWidget, BodyWidget, TextElementBox, ElementBox, ListTextElementBox, TableCellWidget, TableRowWidget, TableWidget, FieldElementBox, BlockWidget, HeaderFooterWidget, BlockContainer, BookmarkElementBox, FieldTextElementBox, TabElementBox, ImageElementBox } from './page';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar Layout = /** @class */ (function () {\n    /**\n     * viewer definition\n     */\n    function Layout(viewer) {\n        /**\n         * @private\n         */\n        this.allowLayout = true;\n        /**\n         * @private\n         */\n        this.isInitialLoad = true;\n        this.fieldBegin = undefined;\n        this.maxTextHeight = 0;\n        this.maxBaseline = 0;\n        this.maxTextBaseline = 0;\n        this.isFieldCode = false;\n        this.isRTLLayout = false;\n        /**\n         * @private\n         */\n        this.isBidiReLayout = false;\n        this.viewer = viewer;\n    }\n    /**\n     * @private\n     */\n    Layout.prototype.layout = function () {\n        // Todo: Need to handle complete document layout(relayout).\n        var page = this.viewer.pages[0];\n        var body = page.bodyWidgets[0];\n    };\n    /**\n     * Releases un-managed and - optionally - managed resources.\n     */\n    Layout.prototype.destroy = function () {\n        this.viewer = undefined;\n        this.value = undefined;\n        this.allowLayout = undefined;\n        this.isInitialLoad = undefined;\n        this.fieldBegin = undefined;\n        this.maxTextHeight = undefined;\n        this.maxBaseline = undefined;\n        this.maxTextBaseline = undefined;\n        this.isFieldCode = undefined;\n    };\n    /**\n     * Layouts the items\n     * @private\n     */\n    Layout.prototype.layoutItems = function (sections) {\n        var _this = this;\n        var page;\n        for (var i = 0; i < sections.length; i++) {\n            var section = sections[i];\n            page = this.viewer.createNewPage(section);\n            this.addBodyWidget(this.viewer.clientActiveArea, section);\n            if (this.viewer.pages.length > 1) {\n                var pageIndex = 0;\n                for (var i_1 = 0; i_1 < this.viewer.pages.length; i_1++) {\n                    var prevPage = this.viewer.pages[i_1];\n                    var prevSectionIndex = prevPage.sectionIndex;\n                    var index = section.index;\n                    if (prevSectionIndex > index || prevPage === page) {\n                        break;\n                    }\n                    pageIndex++;\n                }\n                if (pageIndex < this.viewer.pages.length - 1) {\n                    this.viewer.insertPage(pageIndex, page);\n                }\n            }\n            this.layoutSection(section, 0, this.viewer);\n        }\n        this.updateFieldElements();\n        setTimeout(function () {\n            if (_this.viewer) {\n                _this.viewer.updateScrollBars();\n                _this.isInitialLoad = false;\n            }\n        });\n    };\n    /**\n     * Layouts the items\n     * @param section\n     * @param viewer\n     * @private\n     */\n    Layout.prototype.layoutSection = function (section, index, viewer, ownerWidget) {\n        var block = section.firstChild;\n        var nextBlock;\n        do {\n            if (block instanceof TableWidget && block.tableFormat.preferredWidthType === 'Auto'\n                && !block.tableFormat.allowAutoFit) {\n                block.calculateGrid();\n            }\n            this.viewer.updateClientAreaForBlock(block, true);\n            nextBlock = this.layoutBlock(block, index);\n            index = 0;\n            this.viewer.updateClientAreaForBlock(block, false);\n            block = nextBlock;\n        } while (block);\n    };\n    /**\n     * Layouts the header footer items\n     * @param section\n     * @param viewer\n     * @private\n     */\n    Layout.prototype.layoutHeaderFooter = function (section, viewer, page) {\n        //Header layout\n        var headerFooterWidget = viewer.getCurrentPageHeaderFooter(section, true);\n        if (headerFooterWidget) {\n            var header = headerFooterWidget.clone();\n            header.page = page;\n            viewer.updateHFClientArea(section.sectionFormat, true);\n            page.headerWidget = this.layoutHeaderFooterItems(viewer, header);\n            this.updateHeaderFooterToParent(header);\n        }\n        //Footer Layout\n        headerFooterWidget = viewer.getCurrentPageHeaderFooter(section, false);\n        if (headerFooterWidget) {\n            var footer = headerFooterWidget.clone();\n            footer.page = page;\n            viewer.updateHFClientArea(section.sectionFormat, false);\n            page.footerWidget = this.layoutHeaderFooterItems(viewer, footer);\n            this.updateHeaderFooterToParent(footer);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateHeaderFooterToParent = function (node) {\n        var sectionIndex = node.page.sectionIndex;\n        var typeIndex = this.viewer.getHeaderFooter(node.headerFooterType);\n        var clone = node.clone();\n        this.viewer.headersFooters[sectionIndex][typeIndex] = clone;\n        for (var j = 0; j < clone.childWidgets.length; j++) {\n            var child = clone.childWidgets[j];\n            if (child instanceof TableWidget) {\n                this.clearTableWidget(child, false, true);\n            }\n        }\n        return clone;\n    };\n    Layout.prototype.linkFieldInHeaderFooter = function (widget) {\n        var firstChild = widget.firstChild;\n        do {\n            if (firstChild instanceof ParagraphWidget) {\n                this.linkFieldInParagraph(firstChild);\n            }\n            else {\n                this.linkFieldInTable(firstChild);\n            }\n            //tslint:disable:no-conditional-assignment\n        } while (firstChild = firstChild.nextWidget);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.linkFieldInParagraph = function (widget) {\n        for (var j = 0; j < widget.childWidgets.length; j++) {\n            var line = widget.childWidgets[j];\n            for (var i = 0; i < line.children.length; i++) {\n                var element = line.children[i];\n                if (element instanceof FieldElementBox && element.fieldType !== 0) {\n                    element.linkFieldCharacter(this.viewer);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.linkFieldInTable = function (widget) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var row = widget.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                for (var k = 0; k < cell.childWidgets.length; k++) {\n                    var block = cell.childWidgets[k];\n                    if (block instanceof ParagraphWidget) {\n                        this.linkFieldInParagraph(block);\n                    }\n                    else {\n                        this.linkFieldInTable(block);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Layouts the header footer items.\n     * @param viewer\n     * @param hfModule\n     * @private\n     */\n    Layout.prototype.layoutHeaderFooterItems = function (viewer, widget) {\n        this.viewer.updateClientAreaLocation(widget, viewer.clientActiveArea);\n        if (widget.childWidgets.length === 0) {\n            var pargaraph = new ParagraphWidget();\n            var line = new LineWidget(pargaraph);\n            pargaraph.childWidgets.push(line);\n            widget.childWidgets.push(pargaraph);\n            pargaraph.containerWidget = widget;\n        }\n        this.linkFieldInHeaderFooter(widget);\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var block = widget.childWidgets[i];\n            if (block instanceof TableWidget && block.tableFormat.preferredWidthType === 'Auto'\n                && !block.tableFormat.allowAutoFit && !block.isGridUpdated) {\n                block.calculateGrid();\n            }\n            viewer.updateClientAreaForBlock(block, true);\n            this.layoutBlock(block, 0);\n            viewer.updateClientAreaForBlock(block, false);\n        }\n        var type = widget.headerFooterType;\n        if (type === 'OddFooter' || type === 'EvenFooter' || type === 'FirstPageFooter') {\n            this.shiftChildLocation(viewer.clientArea.y - viewer.clientActiveArea.y, widget);\n        }\n        return widget;\n    };\n    /**\n     * Shifts the child location\n     * @param shiftTop\n     * @param bodyWidget\n     */\n    Layout.prototype.shiftChildLocation = function (shiftTop, bodyWidget) {\n        var widgetTop = bodyWidget.y + shiftTop;\n        var footerMaxHeight = bodyWidget.page.boundingRectangle.height - (bodyWidget.page.boundingRectangle.height / 100) * 40;\n        widgetTop = Math.max(widgetTop, footerMaxHeight);\n        shiftTop = widgetTop - bodyWidget.y;\n        bodyWidget.y = widgetTop;\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var childWidget = bodyWidget.childWidgets[i];\n            if (childWidget instanceof ParagraphWidget) {\n                childWidget.x = childWidget.x;\n                childWidget.y = childWidget.y + shiftTop;\n            }\n            else {\n                this.shiftChildLocationForTableWidget(childWidget, shiftTop);\n            }\n        }\n    };\n    /**\n     * Shifts the child location for table widget.\n     * @param tableWidget\n     * @param shiftTop\n     */\n    Layout.prototype.shiftChildLocationForTableWidget = function (tableWidget, shiftTop) {\n        tableWidget.y = tableWidget.y + shiftTop;\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var childWidget = tableWidget.childWidgets[i];\n            if (childWidget instanceof TableRowWidget) {\n                this.shiftChildLocationForTableRowWidget(childWidget, shiftTop);\n            }\n        }\n    };\n    /**\n     * Shifts the child location for table row widget.\n     * @param rowWidget\n     * @param shiftTop\n     */\n    Layout.prototype.shiftChildLocationForTableRowWidget = function (rowWidget, shiftTop) {\n        rowWidget.y = rowWidget.y + shiftTop;\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            this.shiftChildLocationForTableCellWidget(rowWidget.childWidgets[i], shiftTop);\n        }\n    };\n    /**\n     * Shifts the child location for table cell widget.\n     * @param cellWidget\n     * @param shiftTop\n     */\n    Layout.prototype.shiftChildLocationForTableCellWidget = function (cellWidget, shiftTop) {\n        cellWidget.y = cellWidget.y + shiftTop;\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                cellWidget.childWidgets[i].x = cellWidget.childWidgets[i].x;\n                cellWidget.childWidgets[i].y = cellWidget.childWidgets[i].y + shiftTop;\n            }\n            else {\n                this.shiftChildLocationForTableWidget(cellWidget.childWidgets[i], shiftTop);\n            }\n        }\n    };\n    /**\n     * Layouts specified block.\n     * @param block\n     * @private\n     */\n    Layout.prototype.layoutBlock = function (block, index, moveToLine) {\n        var nextBlock;\n        if (block instanceof ParagraphWidget) {\n            nextBlock = this.layoutParagraph(block, index);\n        }\n        else {\n            nextBlock = this.layoutTable(block, index);\n        }\n        return nextBlock.nextRenderedWidget;\n    };\n    /**\n     * Adds paragraph widget.\n     * @param area\n     */\n    Layout.prototype.addParagraphWidget = function (area, paragraphWidget) {\n        var ownerParaWidget = undefined;\n        if (paragraphWidget.isEmpty() && !isNullOrUndefined(paragraphWidget.paragraphFormat) &&\n            (paragraphWidget.paragraphFormat.textAlignment === 'Center' || paragraphWidget.paragraphFormat.textAlignment === 'Right') &&\n            paragraphWidget.paragraphFormat.listFormat.listId === -1) {\n            var top_1 = 0;\n            var bottom = 0;\n            var width = this.viewer.textHelper.getParagraphMarkWidth(paragraphWidget.characterFormat);\n            var left = area.x;\n            if (paragraphWidget.paragraphFormat.textAlignment === 'Center') {\n                left += (area.width - width) / 2;\n            }\n            else {\n                left += area.width - width;\n            }\n            paragraphWidget.width = width;\n            paragraphWidget.x = left;\n            paragraphWidget.y = area.y;\n        }\n        else {\n            paragraphWidget.width = area.width;\n            paragraphWidget.x = area.x;\n            paragraphWidget.y = area.y;\n        }\n        return paragraphWidget;\n    };\n    /**\n     * Adds line widget.\n     * @param paragraph\n     */\n    Layout.prototype.addLineWidget = function (paragraphWidget) {\n        var line = undefined;\n        line = new LineWidget(paragraphWidget);\n        line.width = paragraphWidget.width;\n        paragraphWidget.childWidgets.push(line);\n        line.paragraph = paragraphWidget;\n        return line;\n    };\n    /**\n     * Layouts specified paragraph.\n     * @private\n     * @param paragraph\n     */\n    Layout.prototype.layoutParagraph = function (paragraph, lineIndex) {\n        this.addParagraphWidget(this.viewer.clientActiveArea, paragraph);\n        this.layoutListItems(paragraph);\n        if (paragraph.isEmpty()) {\n            this.layoutEmptyLineWidget(paragraph, true);\n        }\n        else {\n            var line = lineIndex < paragraph.childWidgets.length ?\n                paragraph.childWidgets[lineIndex] : undefined;\n            while (line instanceof LineWidget) {\n                if (line.isFirstLine() && isNullOrUndefined(this.fieldBegin)) {\n                    if (!isNullOrUndefined(paragraph.paragraphFormat)) {\n                        // tslint:disable-next-line:max-line-length\n                        var firstLineIndent = -HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n                        this.viewer.updateClientWidth(firstLineIndent);\n                    }\n                }\n                line = this.layoutLine(line, 0);\n                paragraph = line.paragraph;\n                line = line.nextLine;\n            }\n        }\n        this.updateWidgetToPage(this.viewer, paragraph);\n        return paragraph;\n    };\n    Layout.prototype.clearLineMeasures = function () {\n        this.maxBaseline = 0;\n        this.maxTextBaseline = 0;\n        this.maxTextHeight = 0;\n    };\n    Layout.prototype.moveElementFromNextLine = function (line) {\n        var nextLine = line.nextLine;\n        while (nextLine instanceof LineWidget) {\n            if (nextLine.children.length > 0) {\n                var element = nextLine.children.splice(0, 1)[0];\n                line.children.push(element);\n                element.line = line;\n                break;\n            }\n            else {\n                if (nextLine.paragraph.childWidgets.length === 1) {\n                    nextLine.paragraph.destroy();\n                }\n                else {\n                    nextLine.destroy();\n                }\n                nextLine = line.nextLine;\n            }\n        }\n    };\n    Layout.prototype.layoutLine = function (line, count) {\n        var paragraph = line.paragraph;\n        if (line.children.length === 0) {\n            this.moveElementFromNextLine(line);\n        }\n        var element = line.children[count];\n        this.clearLineMeasures();\n        while (element instanceof ElementBox) {\n            this.layoutElement(element, paragraph);\n            line = element.line;\n            if (!this.isRTLLayout) {\n                element = element.nextElement;\n            }\n            else {\n                element = undefined;\n                this.isRTLLayout = false;\n            }\n        }\n        return line;\n    };\n    // tslint:disable:max-func-body-length\n    Layout.prototype.layoutElement = function (element, paragraph) {\n        var line = element.line;\n        var text = '';\n        var index = element.indexInOwner;\n        if (element instanceof FieldElementBox) {\n            if (element.fieldType === 0 && this.viewer.fields.indexOf(element) === -1) {\n                this.viewer.fields.push(element);\n            }\n            this.layoutFieldCharacters(element);\n            if (element.line.isLastLine() && isNullOrUndefined(element.nextNode) && !this.isFieldCode) {\n                if (isNullOrUndefined(element.fieldSeparator)) {\n                    this.layoutEmptyLineWidget(paragraph, false, element.line);\n                }\n                this.moveToNextLine(line);\n            }\n            else if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width > 0 && !element.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n            else if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width === 0) {\n                this.moveToNextLine(line);\n                if (line.paragraph.lastChild === line && !isNullOrUndefined(line.nextLine) &&\n                    this.viewer.clientActiveArea.height >= 0) {\n                    this.moveFromNextPage(line);\n                }\n            }\n            return;\n        }\n        if (element instanceof ListTextElementBox || this.isFieldCode || element instanceof BookmarkElementBox) {\n            if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width > 0 && !element.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n            if (element.line.isLastLine() && isNullOrUndefined(element.nextElement)) {\n                if (this.hasValidElement(line.paragraph)) {\n                    this.moveToNextLine(line);\n                }\n                else {\n                    this.layoutEmptyLineWidget(line.paragraph, false, line, false);\n                }\n            }\n            return;\n        }\n        var width = element.width;\n        if (element instanceof FieldTextElementBox) {\n            text = this.viewer.getFieldResult(element.fieldBegin, element.paragraph.bodyWidget.page);\n            if (text !== '') {\n                element.text = text;\n            }\n            else {\n                text = element.text;\n            }\n        }\n        else if (element instanceof TextElementBox) {\n            this.checkAndSplitTabOrLineBreakCharacter(element.text, element);\n            text = element.text;\n        }\n        // Here field code width and height update need to skipped based on the hidden property.\n        if (element instanceof TextElementBox) {\n            width = this.viewer.textHelper.getTextSize(element, element.characterFormat);\n            if (element.text === '\\t') {\n                element.width = this.getTabWidth(paragraph, this.viewer, index, line, element);\n            }\n        }\n        if (this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < element.height && this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            this.moveToNextPage(this.viewer, line);\n            if (element instanceof FieldTextElementBox) {\n                this.updateFieldText(element);\n            }\n            if (element.previousElement) {\n                this.cutClientWidth(element.previousElement);\n            }\n        }\n        if (width < this.viewer.clientActiveArea.width || !this.viewer.textWrap) {\n            //Fits the text in current line.\n            this.addElementToLine(paragraph, element);\n            if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width > 0 && !element.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n            else if (!element.line.isLastLine() && isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width === 0) {\n                this.moveToNextLine(line);\n                if (line.paragraph.lastChild === line && this.viewer.clientActiveArea.height >= 0) {\n                    this.moveFromNextPage(line);\n                }\n            }\n        }\n        else if (element instanceof TextElementBox) {\n            if (element.text === '\\t') {\n                var currentLine = element.line;\n                this.addSplittedLineWidget(currentLine, currentLine.children.indexOf(element) - 1);\n                this.moveToNextLine(currentLine);\n                // Recalculates tab width based on new client active area X position\n                element.width = this.getTabWidth(paragraph, this.viewer, index, element.line, element);\n                this.addElementToLine(paragraph, element);\n            }\n            else {\n                //Splits the text and arrange line by line, till end of text.\n                do {\n                    line = element.line;\n                    this.splitTextForClientArea(line, element, element.text, element.width, element.characterFormat);\n                    this.checkLineWidgetWithClientArea(line, element);\n                    if (element instanceof FieldTextElementBox) {\n                        this.updateFieldText(element);\n                    }\n                } while (element.line !== line && this.cutClientWidth(element));\n            }\n        }\n        else {\n            do {\n                line = element.line;\n                this.splitElementForClientArea(paragraph, element);\n                this.checkLineWidgetWithClientArea(line, element);\n                if (element instanceof FieldTextElementBox) {\n                    this.updateFieldText(element);\n                }\n            } while (element.line !== line && this.cutClientWidth(element));\n        }\n        if (text === '\\v' || text === '\\f') {\n            var elementIndex = line.children.indexOf(element);\n            if (elementIndex > -1) {\n                this.addSplittedLineWidget(line, elementIndex);\n            }\n        }\n        if (element.line.isLastLine() && isNullOrUndefined(element.nextElement) || text === '\\v' || text === '\\f') {\n            this.moveToNextLine(element.line);\n            if (text === '\\v' && isNullOrUndefined(element.nextNode)) {\n                this.layoutEmptyLineWidget(paragraph, true, line, true);\n            }\n            else if (text === '\\f') {\n                if (isNullOrUndefined(element.nextNode)) {\n                    this.moveToNextPage(this.viewer, element.line, true);\n                }\n                else {\n                    this.moveToNextPage(this.viewer, element.line.nextLine, false);\n                }\n            }\n        }\n    };\n    /**\n     * Return true if paragraph has valid inline\n     * @private\n     */\n    Layout.prototype.hasValidElement = function (paragraph) {\n        var line = paragraph.firstChild;\n        if (line && !isNullOrUndefined(this.viewer.selection)) {\n            var elementBox = line.children[0];\n            while (elementBox) {\n                if (elementBox instanceof FieldElementBox) {\n                    elementBox = this.viewer.selection.getNextValidElementForField(elementBox);\n                    if (!elementBox.line.paragraph.equals(paragraph)) {\n                        return false;\n                    }\n                }\n                if (elementBox instanceof TextElementBox) {\n                    return true;\n                }\n                elementBox = elementBox.nextNode;\n            }\n        }\n        return false;\n    };\n    Layout.prototype.updateFieldText = function (element) {\n        // tslint:disable-next-line:max-line-length\n        var text = this.viewer.getFieldResult(element.fieldBegin, element.paragraph.bodyWidget.page);\n        if (text !== '') {\n            element.text = text;\n            this.viewer.textHelper.getTextSize(element, element.characterFormat);\n        }\n    };\n    Layout.prototype.checkLineWidgetWithClientArea = function (line, element) {\n        if (line !== element.line || element.line === line && isNullOrUndefined(element.nextElement)\n            && !element.line.isLastLine()) {\n            this.moveToNextLine(line);\n            if (line !== element.line) {\n                this.isRTLLayout = false;\n            }\n        }\n        if (element.line !== line && this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < element.height &&\n            this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            this.moveToNextPage(this.viewer, element.line);\n        }\n        else if (element.line === line && isNullOrUndefined(element.nextElement)\n            && line.paragraph.lastChild === line && !line.isLastLine() && this.viewer.clientActiveArea.height >= 0) {\n            this.moveFromNextPage(line);\n        }\n    };\n    Layout.prototype.checkAndSplitTabOrLineBreakCharacter = function (text, element) {\n        var char = ['\\t', '\\v', '\\f'];\n        var index = HelperMethods.indexOfAny(text, char);\n        if (index > -1) {\n            var character = text[index];\n            if ((character === '\\t' && text !== '\\t') || (character === '\\v' && text !== '\\v')\n                || (character === '\\f' && text !== '\\f')) {\n                this.splitByLineBreakOrTab(this.viewer, element, index, character);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.moveFromNextPage = function (line) {\n        var nextLine = line.nextLine;\n        if (nextLine && line.paragraph.childWidgets.indexOf(nextLine) === -1) {\n            nextLine.paragraph.childWidgets.splice(nextLine.indexInOwner, 1);\n            line.paragraph.childWidgets.push(nextLine);\n            nextLine.paragraph = line.paragraph;\n        }\n    };\n    Layout.prototype.cutClientWidth = function (currentElement) {\n        this.clearLineMeasures();\n        var line = currentElement.line;\n        var width = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            width += element.width;\n            if (currentElement === element) {\n                break;\n            }\n        }\n        var splitCurrentWidget = this.viewer.clientActiveArea.width - width < 0;\n        if (!splitCurrentWidget) {\n            this.viewer.cutFromLeft(this.viewer.clientActiveArea.x + width);\n            if (currentElement.line.paragraph.paragraphFormat.textAlignment === 'Justify' &&\n                currentElement instanceof TextElementBox) {\n                this.splitTextElementWordByWord(currentElement);\n            }\n            if (isNullOrUndefined(currentElement.nextElement) && this.viewer.clientActiveArea.width > 0\n                && !currentElement.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n        }\n        else if (currentElement.previousElement) {\n            this.cutClientWidth(currentElement.previousElement);\n        }\n        return splitCurrentWidget;\n    };\n    Layout.prototype.layoutFieldCharacters = function (element) {\n        if (element.fieldType === 0) {\n            if (!this.isFieldCode && (!isNullOrUndefined(element.fieldEnd) || element.hasFieldEnd)) {\n                this.viewer.fieldStacks.push(element);\n                this.isFieldCode = true;\n                element.hasFieldEnd = true;\n            }\n        }\n        else if (this.viewer.fieldStacks.length > 0) {\n            if (element.fieldType === 2) {\n                var field = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                if (field.fieldSeparator === element && (!isNullOrUndefined(field.fieldEnd) || field.hasFieldEnd)) {\n                    this.isFieldCode = false;\n                }\n            }\n            else {\n                var field = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                if (element === field.fieldEnd) {\n                    this.viewer.fieldStacks.pop();\n                    this.isFieldCode = false;\n                }\n            }\n        }\n    };\n    /**\n     * Layouts empty line widget.\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.layoutEmptyLineWidget = function (paragraph, isEmptyLine, line, isShiftEnter) {\n        isShiftEnter = isNullOrUndefined(isShiftEnter) ? false : isShiftEnter;\n        //Calculate line height and descent based on formatting defined in paragraph.\n        var paragraphMarkSize = this.viewer.textHelper.getParagraphMarkSize(paragraph.characterFormat);\n        var maxHeight = paragraphMarkSize.Height;\n        var beforeSpacing = this.getBeforeSpacing(paragraph);\n        var lineWidget;\n        if (paragraph.childWidgets.length > 0 && !isShiftEnter) {\n            lineWidget = paragraph.childWidgets[0];\n        }\n        else {\n            lineWidget = isEmptyLine ? this.addLineWidget(paragraph) : line;\n        }\n        //isNullOrUndefined(this.viewer.currentHeaderFooter) && \n        if (this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < beforeSpacing + maxHeight\n            && this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            this.moveToNextPage(this.viewer, lineWidget);\n        }\n        //Gets line spacing.\n        var lineSpacing = this.getLineSpacing(paragraph, maxHeight);\n        var maxDescent = maxHeight - paragraphMarkSize.BaselineOffset;\n        //Calculate the bottom position of current line - max height + line spacing.\n        if (!isNaN(this.maxTextHeight)\n            && maxHeight < this.maxTextHeight) {\n            maxHeight = this.maxTextHeight;\n            maxDescent = maxHeight - this.maxTextBaseline;\n        }\n        var topMargin = 0;\n        var bottomMargin = 0;\n        var leftMargin = 0;\n        var height = maxHeight;\n        var lineSpacingType = paragraph.paragraphFormat.lineSpacingType;\n        if (lineSpacingType === 'Multiple') {\n            if (lineSpacing > maxHeight) {\n                bottomMargin += lineSpacing - maxHeight;\n            }\n            else {\n                topMargin += lineSpacing - maxHeight;\n            }\n        }\n        else if (lineSpacingType === 'Exactly') {\n            topMargin += lineSpacing - (topMargin + height + bottomMargin);\n        }\n        else if (lineSpacing > topMargin + height + bottomMargin) {\n            topMargin += lineSpacing - (topMargin + height + bottomMargin);\n        }\n        topMargin += beforeSpacing;\n        bottomMargin += HelperMethods.convertPointToPixel(paragraph.paragraphFormat.afterSpacing);\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var element = lineWidget.children[i];\n            if (element instanceof ListTextElementBox) {\n                var textAlignment = paragraph.paragraphFormat.textAlignment;\n                if (textAlignment === 'Right') { //Aligns the text as right justified.\n                    leftMargin = this.viewer.clientArea.width - element.width;\n                }\n                else if (textAlignment === 'Center') { //Aligns the text as center justified.\n                    leftMargin = (this.viewer.clientArea.width - element.width) / 2;\n                }\n                element.margin = new Margin(leftMargin, topMargin, 0, bottomMargin);\n                element.line = lineWidget;\n                lineWidget.height = topMargin + height + bottomMargin;\n            }\n        }\n        lineWidget.height = topMargin + height + bottomMargin;\n        this.viewer.cutFromTop(this.viewer.clientActiveArea.y + lineWidget.height);\n        //Clears the previous line elements from collection.     \n    };\n    /**\n     * @private\n     */\n    Layout.prototype.layoutListItems = function (paragraph) {\n        if (!this.isFieldCode) {\n            if (!isNullOrUndefined(paragraph.paragraphFormat)\n                && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)\n                && !isNullOrUndefined(this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId)) &&\n                paragraph.paragraphFormat.listFormat.listLevelNumber >= 0\n                && paragraph.paragraphFormat.listFormat.listLevelNumber < 9) {\n                this.clearListElementBox(paragraph);\n                this.layoutList(paragraph, this.viewer);\n            }\n            else if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId === -1) {\n                this.clearListElementBox(paragraph);\n            }\n        }\n    };\n    /**\n     * Layouts list.\n     * @param viewer\n     */\n    Layout.prototype.layoutList = function (paragraph, viewer) {\n        var list = viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n        viewer.updateClientWidth(-HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent));\n        var currentListLevel = this.getListLevel(list, paragraph.paragraphFormat.listFormat.listLevelNumber);\n        // if (isNullOrUndefined(currentListLevel)) {\n        //     return;\n        // }\n        var lineWidget = paragraph.childWidgets[0];\n        if (isNullOrUndefined(lineWidget)) {\n            lineWidget = new LineWidget(paragraph);\n            paragraph.childWidgets.push(lineWidget);\n        }\n        var element = new ListTextElementBox(currentListLevel, false);\n        element.line = lineWidget;\n        if (currentListLevel.listLevelPattern === 'Bullet') {\n            element.text = currentListLevel.numberFormat;\n        }\n        else {\n            element.text = this.getListNumber(paragraph.paragraphFormat.listFormat);\n        }\n        viewer.textHelper.updateTextSize(element, paragraph);\n        var moveToNextPage;\n        if (this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < element.height && this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            moveToNextPage = true;\n        }\n        viewer.cutFromLeft(viewer.clientActiveArea.x + element.width);\n        //Adds the text element to the line\n        lineWidget.children.splice(0, 0, element);\n        if (currentListLevel.followCharacter !== 'None') {\n            element = new ListTextElementBox(currentListLevel, true);\n            if (currentListLevel.followCharacter === 'Tab') {\n                element.text = '\\t';\n                var index = lineWidget.children.indexOf(element);\n                element.width = this.getTabWidth(paragraph, viewer, index, lineWidget, undefined);\n            }\n            else {\n                element.text = ' ';\n                viewer.textHelper.updateTextSize(element, paragraph);\n            }\n            viewer.cutFromLeft(viewer.clientActiveArea.x + element.width);\n            //Adds the tabSpace to the line\n            lineWidget.children.splice(1, 0, element);\n            element.line = lineWidget;\n        }\n        if (moveToNextPage) {\n            this.moveToNextPage(this.viewer, lineWidget);\n            this.cutClientWidth(element);\n            return;\n        }\n        if (currentListLevel.followCharacter !== 'None') {\n            viewer.updateClientWidth(HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent));\n        }\n    };\n    /**\n     * Adds body widget.\n     * @param area\n     * @param section\n     * @private\n     */\n    Layout.prototype.addBodyWidget = function (area, widget) {\n        var bodyWidget;\n        if (widget) {\n            bodyWidget = widget;\n        }\n        else {\n            bodyWidget = new BodyWidget();\n        }\n        bodyWidget.width = area.width;\n        bodyWidget.x = area.x;\n        bodyWidget.y = area.y;\n        // this.addSectionInDictionary(this.viewer, section, bodyWidget);\n        return bodyWidget;\n    };\n    /**\n     * Adds list level.\n     * @param abstractList\n     */\n    Layout.prototype.addListLevels = function (abstractList) {\n        for (var i = abstractList.levels.length; i < 9; i++) {\n            var listLevel = new WListLevel(abstractList);\n            var val = i % 3;\n            if (abstractList.levels[0].listLevelPattern === 'Bullet') {\n                listLevel.listLevelPattern = 'Bullet';\n                listLevel.numberFormat = val === 0 ? '\\uf0b7' : val === 1 ? '\\uf0a7' : '\\uf0d8';\n                listLevel.characterFormat.fontFamily = listLevel.numberFormat === '\\uf0a7' || '\\uf0d8' ? 'Wingdings' : 'Symbol';\n            }\n            else {\n                listLevel.listLevelPattern = this.getListLevelPattern(val);\n                listLevel.numberFormat = '%' + (i + 1).toString() + '.';\n                listLevel.startAt = 1;\n                listLevel.restartLevel = i;\n            }\n            listLevel.paragraphFormat = new WParagraphFormat(undefined);\n            listLevel.paragraphFormat.leftIndent = 48 * (i + 1);\n            listLevel.paragraphFormat.firstLineIndent = -24;\n            abstractList.levels.push(listLevel);\n        }\n    };\n    Layout.prototype.addSplittedLineWidget = function (lineWidget, elementIndex, splittedElementBox) {\n        var paragraph = lineWidget.paragraph;\n        var movedElementBox = [];\n        var lineIndex = paragraph.childWidgets.indexOf(lineWidget);\n        if (!isNullOrUndefined(splittedElementBox)) {\n            movedElementBox.push(splittedElementBox);\n        }\n        var newLineWidget = undefined;\n        //Move Next element box to temp collection\n        for (var i = elementIndex + 1; i < lineWidget.children.length; i++) {\n            movedElementBox.push(lineWidget.children[i]);\n        }\n        if (movedElementBox.length > 0) {\n            if (lineIndex === paragraph.childWidgets.length - 1) {\n                newLineWidget = new LineWidget(paragraph);\n            }\n            else {\n                newLineWidget = paragraph.childWidgets[lineIndex + 1];\n            }\n            for (var j = 0; j < movedElementBox.length; j++) {\n                movedElementBox[j].line = newLineWidget;\n            }\n            lineWidget.children.splice(elementIndex + 1, lineWidget.children.length - 1);\n            newLineWidget.children = movedElementBox.concat(newLineWidget.children);\n            if (paragraph.childWidgets.indexOf(newLineWidget) === -1) {\n                paragraph.childWidgets.splice(lineIndex + 1, 0, newLineWidget);\n            }\n        }\n    };\n    /**\n     * Adds element to line.\n     * @param element\n     */\n    Layout.prototype.addElementToLine = function (paragraph, element) {\n        this.viewer.cutFromLeft(this.viewer.clientActiveArea.x + element.width);\n        if (paragraph.paragraphFormat.textAlignment === 'Justify' && element instanceof TextElementBox) {\n            this.splitTextElementWordByWord(element);\n        }\n    };\n    /**\n     * Splits element for client area.\n     * @param element\n     */\n    Layout.prototype.splitElementForClientArea = function (paragraph, element) {\n        var line = element.line;\n        if (element.line.children.length > 0) {\n            var previousElement = element.previousElement;\n            var index = element.indexInOwner;\n            // if line widget contain only single image element box need to skip this from splitting\n            // else move element to next line\n            if (element.line.children.length > 1) {\n                if (previousElement && this.viewer.clientActiveArea.x !== this.viewer.clientArea.x) {\n                    index -= 1;\n                }\n            }\n            this.addSplittedLineWidget(element.line, index);\n        }\n    };\n    /**\n     * Splits by word\n     * @param elementBox\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitByWord = function (lineWidget, paragraph, elementBox, text, width, characterFormat) {\n        var index = this.getSplitIndexByWord(this.viewer.clientActiveArea.width, text, width, characterFormat);\n        if (index > 0 && index < elementBox.length) {\n            var indexOf = lineWidget.children.indexOf(elementBox);\n            var lineIndex = paragraph.childWidgets.indexOf(lineWidget);\n            var splittedElementBox = new TextElementBox();\n            text = text.substring(index);\n            splittedElementBox.text = text;\n            if (text[0] === ' ') {\n                var prevLength = text.length;\n                text = HelperMethods.trimStart(text); //To trim white space at starting of the text.\n                index += prevLength - text.length;\n            }\n            splittedElementBox.characterFormat.copyFormat(elementBox.characterFormat);\n            splittedElementBox.width = this.viewer.textHelper.getWidth(splittedElementBox.text, characterFormat);\n            elementBox.text = elementBox.text.substr(0, index);\n            elementBox.width -= splittedElementBox.width;\n            splittedElementBox.height = elementBox.height;\n            splittedElementBox.baselineOffset = elementBox.baselineOffset;\n            this.addSplittedLineWidget(lineWidget, indexOf, splittedElementBox);\n            this.addElementToLine(paragraph, elementBox);\n            if (elementBox.width === 0) {\n                lineWidget.children.splice(indexOf, 1);\n            }\n        }\n    };\n    /**\n     * Splits by character.\n     * @param textElement\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitByCharacter = function (lineWidget, textElement, text, width, characterFormat) {\n        var paragraph = lineWidget.paragraph;\n        // tslint:disable-next-line:max-line-length\n        var index = this.getTextSplitIndexByCharacter(this.viewer.clientArea.width, this.viewer.clientActiveArea.width, text, width, characterFormat);\n        var splitWidth = 0;\n        if (index < textElement.length) {\n            splitWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.substring(0, index), characterFormat);\n            text = text.substring(index);\n        }\n        if (splitWidth > this.viewer.clientActiveArea.width && textElement.indexInOwner > 0) {\n            this.addSplittedLineWidget(lineWidget, textElement.indexInOwner - 1);\n            return;\n        }\n        var indexOf = lineWidget.children.indexOf(textElement);\n        if (index < textElement.length) {\n            var lineIndex = paragraph.childWidgets.indexOf(lineWidget);\n            var splittedElement = new TextElementBox();\n            splittedElement.text = text;\n            textElement.text = textElement.text.substr(0, index);\n            splittedElement.characterFormat.copyFormat(textElement.characterFormat);\n            splittedElement.width = this.viewer.textHelper.getWidth(splittedElement.text, characterFormat);\n            textElement.width -= splittedElement.width;\n            splittedElement.height = textElement.height;\n            splittedElement.baselineOffset = textElement.baselineOffset;\n            lineWidget.children.splice(textElement.indexInOwner + 1, 0, splittedElement);\n            this.addSplittedLineWidget(lineWidget, indexOf);\n            this.addElementToLine(paragraph, textElement);\n            if (textElement.width === 0) {\n                lineWidget.children.splice(indexOf, 1);\n            }\n        }\n        else {\n            //Adds the last text element on inline to line elements collection. \n            this.addSplittedLineWidget(lineWidget, indexOf);\n            this.addElementToLine(paragraph, textElement);\n        }\n    };\n    /**\n     * Splits text element word by word.\n     * @param textElement\n     */\n    Layout.prototype.splitTextElementWordByWord = function (textElement) {\n        var lineWidget = textElement.line;\n        var indexOf = lineWidget.children.indexOf(textElement);\n        var text = textElement.text;\n        var format;\n        var characterUptoWs = text.trim().indexOf(' ');\n        if (characterUptoWs >= 0) {\n            lineWidget.children.splice(indexOf, 1);\n            format = textElement.characterFormat;\n            var fontSize = format.fontSize;\n            var index = textElement.length - HelperMethods.trimStart(text).length; //Trim start\n            while (index < textElement.length) {\n                index = this.getTextIndexAfterSpace(text, index);\n                if (index === 0 || index === textElement.length) {\n                    break;\n                }\n                if (index < textElement.length) {\n                    var splittedElement = new TextElementBox();\n                    var splittedText = text.substring(0, index);\n                    text = text.substring(index);\n                    if (text.substring(0, 1) === ' ') {\n                        // start of the text is trimmed and its length is reduced from text length.                        \n                        index += text.length - HelperMethods.trimStart(text).length;\n                    }\n                    splittedElement.text = splittedText;\n                    splittedElement.characterFormat.copyFormat(textElement.characterFormat);\n                    splittedElement.line = lineWidget;\n                    splittedElement.width = this.viewer.textHelper.getWidth(splittedElement.text, format);\n                    splittedElement.height = textElement.height;\n                    splittedElement.baselineOffset = textElement.baselineOffset;\n                    lineWidget.children.splice(indexOf, 0, splittedElement);\n                    textElement.text = text;\n                    textElement.width -= splittedElement.width;\n                    if (textElement.width === 0) {\n                        lineWidget.children.splice(lineWidget.children.indexOf(textElement), 1);\n                    }\n                    index = 0;\n                    indexOf++;\n                }\n            }\n            textElement.text = text;\n            lineWidget.children.splice(indexOf, 0, textElement);\n        }\n    };\n    /**\n     * Splits text for client area.\n     * @param element\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitTextForClientArea = function (lineWidget, element, text, width, characterFormat) {\n        var paragraph = lineWidget.paragraph;\n        var isSplitByWord = true;\n        var index = -1;\n        if (!(text.substring(0, 1) === ' ')) {\n            var textWidth = width;\n            var characterUptoWS = 0;\n            characterUptoWS = HelperMethods.trimEnd(text).indexOf(' ') + 1;\n            index = characterUptoWS;\n            //Checks whether text not starts with white space. If starts with white space, no need to check previous text blocks.\n            if (index > 0) {\n                textWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.slice(0, index), characterFormat);\n            }\n            if (this.viewer.clientActiveArea.width < textWidth) {\n                //Check and split the previous text elements to next line.            \n                isSplitByWord = this.checkPreviousElement(lineWidget, lineWidget.children.indexOf(element), characterFormat);\n                if (isSplitByWord) {\n                    //lineWidget = paragraph.childWidgets[paragraph.childWidgets.indexOf(lineWidget) + 1] as LineWidget;\n                    //isSplitByWord = textWidth <= this.viewer.clientActiveArea.width;\n                    return;\n                }\n            }\n        }\n        else {\n            index = 1;\n        }\n        if (width <= this.viewer.clientActiveArea.width) {\n            //Fits the text in current line.\n            this.addElementToLine(paragraph, element);\n        }\n        else if (isSplitByWord && (index > 0 || text.indexOf(' ') !== -1)) {\n            this.splitByWord(lineWidget, paragraph, element, text, width, characterFormat);\n        }\n        else {\n            this.splitByCharacter(lineWidget, element, text, width, characterFormat);\n        }\n    };\n    /**\n     * Handle tab or line break character splitting\n     * @param  {LayoutViewer} viewer\n     * @param  {TextElementBox} span\n     * @param  {number} index\n     * @param  {string} spiltBy\n     * @private\n     */\n    Layout.prototype.splitByLineBreakOrTab = function (viewer, span, index, spiltBy) {\n        // Splits tab character to separate SpanAdv\n        var inlineIndex = span.line.children.indexOf(span);\n        var value = span.text;\n        var remainder = value.substring(index);\n        var newSpan = spiltBy === '\\t' ? new TabElementBox() : new TextElementBox();\n        newSpan.line = span.line;\n        newSpan.characterFormat.copyFormat(span.characterFormat);\n        span.line.children.splice(inlineIndex + 1, 0, newSpan);\n        if (index > 0 && remainder.length === 1) {\n            newSpan.text = value.substring(index);\n            span.text = value.substring(0, index);\n        }\n        else if (index > 0) {\n            newSpan.text = spiltBy;\n            var newText = new TextElementBox();\n            newText.line = span.line;\n            newText.text = value.substring(index + 1);\n            newText.characterFormat.copyFormat(span.characterFormat);\n            span.line.children.splice(inlineIndex + 2, 0, newText);\n            span.text = value.substring(0, index);\n        }\n        else if (remainder !== '') {\n            newSpan.text = value.substring(index + 1);\n            span.text = spiltBy;\n        }\n    };\n    /**\n     * Moves to next line.\n     */\n    Layout.prototype.moveToNextLine = function (line) {\n        var paragraph = line.paragraph;\n        var paraFormat = paragraph.paragraphFormat;\n        var isParagraphStart = line.isFirstLine();\n        var isParagraphEnd = line.isLastLine();\n        var height = 0;\n        var maxDescent = 0;\n        var afterSpacing = 0;\n        var beforeSpacing = 0;\n        var lineSpacing = 0;\n        var firstLineIndent = 0;\n        this.updateLineWidget(line);\n        height = this.maxTextHeight;\n        maxDescent = height - this.maxTextBaseline;\n        //Updates before spacing at the top of Paragraph first line.\n        if (isParagraphStart) {\n            beforeSpacing = this.getBeforeSpacing(paragraph);\n            firstLineIndent = HelperMethods.convertPointToPixel(paraFormat.firstLineIndent);\n        }\n        //Updates after spacing at the bottom of Paragraph last line.\n        if (isParagraphEnd) {\n            afterSpacing = HelperMethods.convertPointToPixel(paraFormat.afterSpacing);\n        }\n        if (!this.isBidiReLayout && (paraFormat.bidi || this.isContainsRtl(line))) {\n            this.reArrangeElementsForRtl(line, paraFormat.bidi);\n            this.isRTLLayout = true;\n        }\n        if (isNaN(this.maxTextHeight)) {\n            //Calculate line height and descent based on formatting defined in paragraph.\n            var measurement = this.viewer.textHelper.measureText('a', paragraph.characterFormat);\n            height = measurement.Height;\n            maxDescent = height - measurement.BaselineOffset;\n        }\n        else {\n            height = this.maxTextHeight;\n            maxDescent = height - this.maxTextBaseline;\n        }\n        // Gets line spacing.\n        lineSpacing = this.getLineSpacing(paragraph, height);\n        if (paraFormat.lineSpacingType === 'Exactly'\n            && lineSpacing < maxDescent + this.maxBaseline) {\n            lineSpacing = maxDescent + this.maxBaseline;\n        }\n        var subWidth = 0;\n        var whiteSpaceCount = 0;\n        var textAlignment = paraFormat.textAlignment;\n        // calculates the sub width, for text alignments - Center, Right, Justify.\n        // if the element is paragraph end and para bidi is true and text alignment is justify\n        // we need to calculate subwidth and add it to the left margin of the element.\n        if (textAlignment !== 'Left' && this.viewer.textWrap && (!(textAlignment === 'Justify' && isParagraphEnd)\n            || (textAlignment === 'Justify' && paraFormat.bidi))) {\n            // tslint:disable-next-line:max-line-length\n            var getWidthAndSpace = this.getSubWidth(line, textAlignment === 'Justify', whiteSpaceCount, firstLineIndent, isParagraphEnd);\n            subWidth = getWidthAndSpace.subWidth;\n            whiteSpaceCount = getWidthAndSpace.spaceCount;\n        }\n        var addSubWidth = false;\n        var lineSpacingType = paraFormat.lineSpacingType;\n        for (var i = 0; i < line.children.length; i++) {\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var leftMargin = 0;\n            var elementBox = line.children[i];\n            // tslint:disable-next-line:max-line-length\n            var alignElements = this.alignLineElements(elementBox, topMargin, bottomMargin, maxDescent, addSubWidth, subWidth, textAlignment, whiteSpaceCount, i === line.children.length - 1);\n            topMargin = alignElements.topMargin;\n            bottomMargin = alignElements.bottomMargin;\n            addSubWidth = alignElements.addSubWidth;\n            whiteSpaceCount = alignElements.whiteSpaceCount;\n            //Updates line spacing, paragraph after/ before spacing and aligns the text to base line offset.\n            if (lineSpacingType === 'Multiple') {\n                if (lineSpacing > height) {\n                    bottomMargin += lineSpacing - height;\n                }\n                else {\n                    topMargin += lineSpacing - height;\n                }\n            }\n            else if (lineSpacingType === 'Exactly') {\n                topMargin += lineSpacing - (topMargin + elementBox.height + bottomMargin);\n            }\n            else if (lineSpacing > topMargin + elementBox.height + bottomMargin) {\n                topMargin += lineSpacing - (topMargin + elementBox.height + bottomMargin);\n            }\n            topMargin += beforeSpacing;\n            bottomMargin += afterSpacing;\n            if (i === 0) {\n                line.height = topMargin + elementBox.height + bottomMargin;\n                if (textAlignment === 'Right' || (textAlignment === 'Justify' && paraFormat.bidi && isParagraphEnd)) {\n                    //Aligns the text as right justified and consider subwidth for bidirectional paragrph with justify.\n                    leftMargin = subWidth;\n                }\n                else if (textAlignment === 'Center') {\n                    //Aligns the text as center justified.\n                    leftMargin = subWidth / 2;\n                }\n            }\n            elementBox.margin = new Margin(leftMargin, topMargin, 0, bottomMargin);\n            elementBox.line = line;\n        }\n        this.viewer.cutFromTop(this.viewer.clientActiveArea.y + line.height);\n    };\n    Layout.prototype.updateLineWidget = function (line) {\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            if (element instanceof TextElementBox || element instanceof ListTextElementBox) {\n                if (this.maxTextHeight < element.height) {\n                    this.maxTextHeight = element.height;\n                    this.maxTextBaseline = element.baselineOffset;\n                }\n                if (this.maxBaseline < this.maxTextBaseline) {\n                    this.maxBaseline = this.maxTextBaseline;\n                }\n            }\n            else if (this.maxBaseline < element.height) {\n                this.maxBaseline = element.height;\n            }\n        }\n    };\n    /**\n     * @param viewer\n     */\n    Layout.prototype.moveToNextPage = function (viewer, line, isPageBreak) {\n        var paragraphWidget = line.paragraph;\n        var index = 0;\n        if (!isNullOrUndefined(line)) {\n            index = paragraphWidget.childWidgets.indexOf(line);\n            if (index > 0 || isPageBreak) {\n                paragraphWidget.height = viewer.clientActiveArea.y - paragraphWidget.y;\n            }\n        }\n        var nextBody = this.moveBlocksToNextPage(paragraphWidget);\n        this.viewer.updateClientArea(nextBody.sectionFormat, nextBody.page);\n        this.viewer.updateClientAreaForBlock(paragraphWidget, true);\n        if (index > 0) {\n            if (line.isLastLine() && isPageBreak) {\n                return;\n            }\n            var nextParagraph = void 0;\n            if (nextBody.firstChild instanceof ParagraphWidget && nextBody.firstChild.equals(paragraphWidget)) {\n                nextParagraph = nextBody.firstChild;\n            }\n            else {\n                nextParagraph = new ParagraphWidget();\n            }\n            nextParagraph = this.addParagraphWidget(this.viewer.clientActiveArea, nextParagraph);\n            nextParagraph.index = paragraphWidget.index;\n            var insertIndex = 0;\n            for (var i = index; i < paragraphWidget.childWidgets.length; i++) {\n                var lineWidget = paragraphWidget.childWidgets[i];\n                lineWidget.paragraph = nextParagraph;\n                nextParagraph.childWidgets.splice(insertIndex, 0, lineWidget);\n                lineWidget.paragraph = nextParagraph;\n                insertIndex++;\n            }\n            nextParagraph.paragraphFormat = paragraphWidget.paragraphFormat;\n            nextParagraph.characterFormat = paragraphWidget.characterFormat;\n            paragraphWidget.childWidgets.splice(index);\n            paragraphWidget = nextParagraph;\n        }\n        else if (!isPageBreak) {\n            paragraphWidget.containerWidget.removeChild(paragraphWidget.indexInOwner);\n        }\n        if (!isPageBreak) {\n            if (nextBody.childWidgets.indexOf(paragraphWidget) === -1) {\n                nextBody.childWidgets.splice(0, 0, paragraphWidget);\n            }\n            paragraphWidget.containerWidget = nextBody;\n            this.viewer.updateClientAreaLocation(paragraphWidget, this.viewer.clientActiveArea);\n        }\n    };\n    /**\n     * Aligns line elements\n     * @param element\n     * @param topMargin\n     * @param bottomMargin\n     * @param maxDescent\n     * @param addSubWidth\n     * @param subWidth\n     * @param textAlignment\n     * @param whiteSpaceCount\n     * @param isLastElement\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.alignLineElements = function (element, topMargin, bottomMargin, maxDescent, addSubWidth, subWidth, textAlignment, whiteSpaceCount, isLastElement) {\n        if (element instanceof TextElementBox || element instanceof ListTextElementBox) {\n            var textElement = element instanceof TextElementBox ? element : undefined;\n            //Updates the text to base line offset.\n            // tslint:disable-next-line:max-line-length\n            var baselineOffset = element instanceof TextElementBox ? textElement.baselineOffset : element.baselineOffset;\n            topMargin += this.maxBaseline - baselineOffset;\n            bottomMargin += maxDescent - (element.height - baselineOffset);\n            //Updates the text to base line offset.\n            if (!isNullOrUndefined(textElement) && textAlignment === 'Justify' && whiteSpaceCount > 0) {\n                //Aligns the text as Justified.\n                var width = textElement.width;\n                var text = textElement.text;\n                if (!addSubWidth) {\n                    text = HelperMethods.trimStart(text); // trim start\n                    addSubWidth = (text.length > 0);\n                }\n                if (addSubWidth) {\n                    var spaceCount = text.length - HelperMethods.removeSpace(text).length;\n                    if (isLastElement) {\n                        spaceCount -= text.length - HelperMethods.trimEnd(text).length;\n                    }\n                    if (whiteSpaceCount < spaceCount) {\n                        width = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text, textElement.characterFormat);\n                        spaceCount = whiteSpaceCount;\n                    }\n                    if (spaceCount > 0) {\n                        textElement.width = width + subWidth * spaceCount;\n                        whiteSpaceCount -= spaceCount;\n                    }\n                }\n            }\n        }\n        else {\n            addSubWidth = true;\n            //Updates the Image/UIElement to base line offset.\n            topMargin += this.maxBaseline - element.height;\n            bottomMargin += maxDescent;\n        }\n        return { 'topMargin': topMargin, 'bottomMargin': bottomMargin, 'addSubWidth': addSubWidth, 'whiteSpaceCount': whiteSpaceCount };\n    };\n    /**\n     * Updates widget to page.\n     * @param viewer\n     * @param block\n     * @private\n     */\n    Layout.prototype.updateWidgetToPage = function (viewer, paragraphWidget) {\n        if (paragraphWidget.isInsideTable) {\n            var cellWidget = paragraphWidget.associatedCell;\n            paragraphWidget.height = viewer.clientActiveArea.y - paragraphWidget.y;\n            // if (viewer instanceof PageLayoutViewer) {\n            if (isNullOrUndefined(paragraphWidget.associatedCell) || isNullOrUndefined(paragraphWidget.associatedCell.ownerRow)\n                || isNullOrUndefined(paragraphWidget.associatedCell.ownerRow.rowFormat)) {\n                return;\n            }\n            if (paragraphWidget.associatedCell.ownerRow.rowFormat.heightType === 'Exactly') {\n                cellWidget.height = HelperMethods.convertPointToPixel(paragraphWidget.associatedCell.ownerRow.rowFormat.height);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                if ([cellWidget].length <= 1 && paragraphWidget.associatedCell.ownerRow.rowFormat.heightType === 'AtLeast') {\n                    cellWidget.height = Math.max(HelperMethods.convertPointToPixel(paragraphWidget.associatedCell.ownerRow.rowFormat.height), this.getCellContentHeight(cellWidget));\n                }\n                else {\n                    cellWidget.height = cellWidget.height + paragraphWidget.height;\n                }\n            }\n            // } else {\n            //     cellWidget.height = cellWidget.height + paragraphWidget.height;\n            // }\n            // cellWidget.childWidgets.push(paragraphWidget);\n            paragraphWidget.containerWidget = cellWidget;\n        }\n        else {\n            if (!paragraphWidget.isEndsWithPageBreak) {\n                paragraphWidget.height = viewer.clientActiveArea.y - paragraphWidget.y;\n            }\n            //Adds the paragraph widget to the Header Footer/ Body widget.\n            // this.updateWidgetsToBody(paragraphWidget, viewer, paragraphWidget);\n            //For canvas no need to render paragraph widget here. In case of div, need to render paragraph here.\n            // tslint:disable-next-line:max-line-length             \n            // this.render.renderParagraphWidget((paragraphWidget.containerWidget as BodyWidget).page, paragraphWidget);\n        }\n        if (paragraphWidget.bodyWidget instanceof HeaderFooterWidget) {\n            if (!paragraphWidget.isInsideTable) {\n                paragraphWidget.containerWidget.height += paragraphWidget.height;\n            }\n            if (this.viewer.owner.enableHeaderAndFooter && paragraphWidget.bodyWidget.headerFooterType.indexOf('Footer') !== -1) {\n                this.shiftFooterChildLocation(paragraphWidget.bodyWidget, this.viewer);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftFooterChildLocation = function (widget, viewer) {\n        var pageHeight = widget.page.bodyWidgets[0].sectionFormat.pageHeight;\n        if (widget.headerFooterType.indexOf('Footer') !== -1) {\n            var footerDistance = widget.page.bodyWidgets[0].sectionFormat.footerDistance;\n            var height = HelperMethods.convertPointToPixel(pageHeight - footerDistance);\n            var top_2;\n            if (widget.y + widget.height > height) {\n                top_2 = height - (widget.y + widget.height);\n            }\n            else if (widget.y + widget.height < height) {\n                top_2 = (widget.y + widget.height) - height;\n            }\n            if (!isNullOrUndefined(top_2)) {\n                top_2 = height - (widget.y + widget.height);\n                this.shiftChildLocation(top_2, widget);\n                viewer.clientActiveArea.y += top_2;\n            }\n        }\n    };\n    /**\n     * Checks previous element.\n     * @param characterFormat\n     */\n    Layout.prototype.checkPreviousElement = function (line, index, characterFormat) {\n        var paragraph = line.paragraph;\n        var isSplitByWord = false;\n        var lastTextElement = 0;\n        for (var i = index - 1; i >= 0; i--) {\n            var textElement = line.children[i];\n            if (textElement instanceof TextElementBox) {\n                var text = textElement.text;\n                lastTextElement = i;\n                if (text.length > 0 && text[text.length - 1] === ' ') {\n                    if (i === index - 1) {\n                        this.addSplittedLineWidget(line, index - 1);\n                        return true;\n                    }\n                    isSplitByWord = true;\n                    break;\n                }\n                else if (text === '\\t') {\n                    return false;\n                }\n                else if (text.indexOf(' ') >= 0) {\n                    isSplitByWord = true;\n                    var index_1 = text.lastIndexOf(' ') + 1;\n                    //Splits the text element by space.\n                    var splittedElement = new TextElementBox();\n                    splittedElement.text = text.substr(index_1);\n                    splittedElement.characterFormat.copyFormat(textElement.characterFormat);\n                    textElement.text = text.substr(0, index_1);\n                    this.viewer.textHelper.getTextSize(splittedElement, characterFormat);\n                    textElement.width -= splittedElement.width;\n                    textElement.height = splittedElement.height;\n                    if (textElement.width === 0) {\n                        line.children.splice(i, 1);\n                    }\n                    //Adds the text element to the line\n                    line.children.splice(i + 1, 0, splittedElement);\n                    break;\n                }\n            }\n            else if (!(textElement instanceof ListTextElementBox)) {\n                //Handled for inline images/UIelements.\n                lastTextElement = i;\n                isSplitByWord = true;\n                break;\n            }\n        }\n        if (isSplitByWord) {\n            lastTextElement++;\n            if (lastTextElement < line.children.length) {\n                var splitWidth = 0;\n                for (var i = lastTextElement; i < line.children.length; i++) {\n                    splitWidth += line.children[i].width;\n                    this.addSplittedLineWidget(line, i - 1);\n                    i--;\n                }\n                this.viewer.updateClientWidth(splitWidth);\n            }\n        }\n        return isSplitByWord;\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearListElementBox = function (paragraph) {\n        if (paragraph.childWidgets.length === 0) {\n            return;\n        }\n        var line = paragraph.childWidgets[0];\n        if (isNullOrUndefined(line.children)) {\n            return;\n        }\n        for (var i = line.children.length - 1; i > 0; i--) {\n            if (line.children[i] instanceof ListTextElementBox) {\n                line.children.splice(i, 1);\n            }\n            else {\n                break;\n            }\n        }\n        for (var i = 0; i < line.children.length; i++) {\n            if (line.children[i] instanceof ListTextElementBox) {\n                line.children.splice(i, 1);\n                i--;\n            }\n            else {\n                break;\n            }\n        }\n    };\n    /**\n     * Gets list number.\n     * @param listFormat\n     * @param document\n     * @private\n     */\n    Layout.prototype.getListNumber = function (listFormat) {\n        var list = this.viewer.getListById(listFormat.listId);\n        var levelNumber = listFormat.listLevelNumber;\n        var listLevel = this.getListLevel(list, listFormat.listLevelNumber);\n        // tslint:disable-next-line:max-line-length\n        var levelOverride = !isNullOrUndefined(list.levelOverrides) ? list.levelOverrides[levelNumber] : undefined;\n        // If LevelOverride exists and have either override list level or StartAtOverride, then only list numbering will be restarted.\n        // tslint:disable-next-line:max-line-length\n        // if (!isNullOrUndefined(levelOverride) && !(document.renderedLevelOverrides.indexOf(levelOverride) > -1) && isNullOrUndefined(levelOverride.overrideListLevel)) {\n        //     //Add List Override style\n        //     document.renderedLevelOverrides.push(list.levelOverrides.getItem(levelNumber) as WLevelOverride);\n        //     if (document.renderedLists.containsKey((list.wordDocument as WordDocument).getAbstractListById(list.abstractListId))) {\n        // tslint:disable-next-line:max-line-length\n        //         let levels: Dictionary<number, number> = document.renderedLists.get((list.wordDocument as WordDocument).getAbstractListById(list.abstractListId));\n        //         if (levels.containsKey(levelNumber)) {\n        //             levels.remove(levelNumber);\n        //         }\n        //     }\n        // }\n        this.updateListValues(list, levelNumber);\n        return this.getListText(list, levelNumber, listLevel);\n    };\n    /**\n     * Gets list start value\n     * @param listLevelNumber\n     * @param list\n     * @private\n     */\n    Layout.prototype.getListStartValue = function (listLevelNumber, list) {\n        // tslint:disable-next-line:max-line-length\n        var levelOverride = !isNullOrUndefined(list.levelOverrides) ? list.levelOverrides[listLevelNumber] : undefined;\n        if (!isNullOrUndefined(levelOverride) && isNullOrUndefined(levelOverride.overrideListLevel)) {\n            return levelOverride.startAt;\n        }\n        var listLevel = this.getListLevel(list, listLevelNumber);\n        if (isNullOrUndefined(listLevel)) {\n            return 0;\n        }\n        else {\n            return listLevel.startAt;\n        }\n    };\n    /**\n     * Updates list values.\n     * @param list\n     * @param listLevelNumber\n     * @param document\n     */\n    Layout.prototype.updateListValues = function (list, listLevelNumber) {\n        if (!this.viewer.renderedLists.containsKey(this.viewer.getAbstractListById(list.abstractListId))) {\n            var startVal = new Dictionary();\n            this.viewer.renderedLists.add(this.viewer.getAbstractListById(list.abstractListId), startVal);\n            var listLevel = this.getListLevel(list, listLevelNumber);\n            for (var i = 0; i <= listLevelNumber; i++) {\n                startVal.add(i, this.getListStartValue(i, list));\n            }\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            var levels = this.viewer.renderedLists.get(this.viewer.getAbstractListById(list.abstractListId));\n            if (levels.containsKey(listLevelNumber)) {\n                var startAt = levels.get(listLevelNumber);\n                levels.set(listLevelNumber, startAt + 1);\n                var levelNumber = listLevelNumber + 1;\n                while (levelNumber < this.viewer.getAbstractListById(list.abstractListId).levels.length) {\n                    var listLevel = this.getListLevel(list, levelNumber);\n                    // if (!isNullOrUndefined(listLevel)) {\n                    if (levels.containsKey(levelNumber) && listLevel.restartLevel > listLevelNumber) {\n                        levels.remove(levelNumber);\n                        // if (document.renderedListLevels.indexOf(listLevel) > -1) {\n                        //     document.renderedListLevels.pop();\n                        // }\n                    }\n                    // }\n                    levelNumber++;\n                }\n            }\n            else {\n                var levelNumber = listLevelNumber;\n                while (!levels.containsKey(levelNumber - 1) && levelNumber > 0) {\n                    var listLevel = this.getListLevel(list, levelNumber - 1);\n                    // if (!isNullOrUndefined(listLevel)) {\n                    levels.add(levelNumber - 1, this.getListStartValue(levelNumber - 1, list));\n                    // if (document.renderedListLevels.indexOf(listLevel) !== -1) {\n                    //     document.renderedListLevels.push(listLevel);\n                    // }\n                    // }\n                    levelNumber--;\n                }\n                var startAt = this.getListStartValue(listLevelNumber, list);\n                levels.add(listLevelNumber, startAt);\n            }\n        }\n    };\n    /**\n     * Gets list text\n     * @param listAdv\n     * @param listLevelNumber\n     * @param currentListLevel\n     * @param document\n     */\n    Layout.prototype.getListText = function (listAdv, listLevelNumber, currentListLevel) {\n        var listText = currentListLevel.numberFormat;\n        // tslint:disable-next-line:max-line-length\n        if (this.viewer.renderedLists.containsKey(this.viewer.getAbstractListById(listAdv.abstractListId))) {\n            var levels = this.viewer.renderedLists.get(this.viewer.getAbstractListById(listAdv.abstractListId));\n            var keys = levels.keys;\n            for (var i = 0; i < keys.length; i++) {\n                var levelNumber = keys[i];\n                var levelKey = '%' + (levelNumber + 1).toString();\n                var listLevel = this.getListLevel(listAdv, levelNumber);\n                if (listText.match(levelKey)) {\n                    if (levelNumber > listLevelNumber) {\n                        return '';\n                    }\n                    else if (levels.containsKey(levelNumber) && !isNullOrUndefined(listLevel)) {\n                        listText = listText.replace(levelKey, this.getListTextListLevel(listLevel, levels.get(levelNumber)));\n                    }\n                    else {\n                        listText = listText.replace(levelKey, '0');\n                    }\n                }\n            }\n        }\n        return listText;\n    };\n    /**\n     * Gets the roman letter.\n     * @param number\n     * @private\n     */\n    Layout.prototype.getAsLetter = function (number) {\n        // if (number <= 0) {\n        //     return '';\n        // }\n        var quotient = number / 26;\n        var remainder = number % 26;\n        if (remainder === 0) {\n            //If number denotes the factor of 26, then reduce quotient by 1 and set remainder as 26.\n            remainder = 26;\n            quotient--;\n        }\n        //Index of A char in the ASCII table.     \n        var letter = String.fromCharCode(65 - 1 + remainder);\n        var listValue = '';\n        while (quotient >= 0) {\n            listValue = listValue + letter.toString();\n            quotient--;\n        }\n        return listValue;\n    };\n    /**\n     * Gets list text using list level pattern.\n     * @param listLevel\n     * @param listValue\n     * @private\n     */\n    Layout.prototype.getListTextListLevel = function (listLevel, listValue) {\n        switch (listLevel.listLevelPattern) {\n            case 'UpRoman':\n                return this.getAsRoman(listValue).toUpperCase();\n            case 'LowRoman':\n                return this.getAsRoman(listValue).toLowerCase();\n            case 'UpLetter':\n                return this.getAsLetter(listValue).toUpperCase();\n            case 'LowLetter':\n                return this.getAsLetter(listValue).toLowerCase();\n            case 'Arabic':\n                return (listValue).toString();\n            case 'LeadingZero':\n                return this.getAsLeadingZero(listValue);\n            case 'Number':\n                return (listValue).toString();\n            case 'OrdinalText':\n                return (listValue).toString();\n            case 'Ordinal':\n                return (listValue).toString();\n            case 'FarEast':\n                return (listValue).toString();\n            case 'Special':\n                return (listValue).toString();\n            default:\n                return '';\n        }\n    };\n    /**\n     * Generate roman number for the specified number.\n     * @param number\n     * @param magnitude\n     * @param letter\n     */\n    Layout.prototype.generateNumber = function (number, magnitude, letter) {\n        var numberstring = '';\n        while (number >= magnitude) {\n            number -= magnitude;\n            numberstring += letter;\n            this.value = number;\n        }\n        return numberstring.toString();\n    };\n    /**\n     * Gets list value prefixed with zero, if less than 10\n     * @param listValue\n     */\n    Layout.prototype.getAsLeadingZero = function (listValue) {\n        if (listValue < 10) {\n            return '0' + listValue.toString();\n        }\n        else {\n            return listValue.toString();\n        }\n    };\n    /**\n     * Gets the roman number\n     * @param number\n     * @private\n     */\n    Layout.prototype.getAsRoman = function (number) {\n        var retval = '';\n        this.value = number;\n        retval += this.generateNumber(this.value, 1000, 'M');\n        retval += this.generateNumber(this.value, 900, 'CM');\n        retval += this.generateNumber(this.value, 500, 'D');\n        retval += this.generateNumber(this.value, 400, 'CD');\n        retval += this.generateNumber(this.value, 100, 'C');\n        retval += this.generateNumber(this.value, 90, 'XC');\n        retval += this.generateNumber(this.value, 50, 'L');\n        retval += this.generateNumber(this.value, 40, 'XL');\n        retval += this.generateNumber(this.value, 10, 'X');\n        retval += this.generateNumber(this.value, 9, 'IX');\n        retval += this.generateNumber(this.value, 5, 'V');\n        retval += this.generateNumber(this.value, 4, 'IV');\n        retval += this.generateNumber(this.value, 1, 'I');\n        return retval.toString();\n    };\n    /**\n     * Gets the list level\n     * @param list\n     * @param listLevelNumber\n     * @private\n     */\n    Layout.prototype.getListLevel = function (list, listLevelNumber) {\n        if (!isNullOrUndefined(list)) {\n            var abstractList = this.viewer.getAbstractListById(list.abstractListId);\n            if (!isNullOrUndefined(list) && abstractList.levels.length <= listLevelNumber\n                && listLevelNumber >= 0 && listLevelNumber < 9) {\n                this.addListLevels(abstractList);\n            }\n            var levelOverrideAdv = undefined;\n            var level = false;\n            level = (!isNullOrUndefined(list.levelOverrides))\n                && !isNullOrUndefined(((levelOverrideAdv = list.levelOverrides[listLevelNumber])))\n                && (!isNullOrUndefined(levelOverrideAdv.overrideListLevel));\n            if (level) {\n                return levelOverrideAdv.overrideListLevel;\n            }\n            else if (!isNullOrUndefined(abstractList) && listLevelNumber >= 0 && listLevelNumber < abstractList.levels.length) {\n                return abstractList.levels[listLevelNumber];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Gets tab width\n     * @param paragraph\n     * @param viewer\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getTabWidth = function (paragraph, viewer, index, lineWidget, element) {\n        var elementWidth = element ? this.viewer.textHelper.getTextSize(element, element.characterFormat) : 0;\n        var fPosition = 0;\n        var isCustomTab = false;\n        var tabs = paragraph.paragraphFormat.getUpdatedTabs();\n        //  Calculate hanging width\n        if (viewer.clientActiveArea.x < viewer.clientArea.x) {\n            return viewer.clientArea.x - viewer.clientActiveArea.x;\n        }\n        // Calculates tabwidth based on pageleftmargin and defaulttabwidth property\n        var position = viewer.clientActiveArea.x -\n            (viewer.clientArea.x - HelperMethods.convertPointToPixel(paragraph.paragraphFormat.leftIndent));\n        var defaultTabWidth = HelperMethods.convertPointToPixel(viewer.defaultTabWidth);\n        if (tabs.length === 0 && (position === 0 || defaultTabWidth === 0)) {\n            return defaultTabWidth;\n        }\n        else {\n            if (tabs.length > 0) {\n                for (var i = 0; i < tabs.length; i++) {\n                    var tabStop = tabs[i];\n                    var tabPosition = HelperMethods.convertPointToPixel(tabs[i].position);\n                    if ((position + elementWidth) < tabPosition) {\n                        isCustomTab = true;\n                        if (tabStop.tabJustification === 'Left') {\n                            fPosition = tabPosition;\n                            if (!isNullOrUndefined(element)) {\n                                element.tabLeader = tabs[i].tabLeader;\n                                element.tabText = '';\n                            }\n                            break;\n                        }\n                        else {\n                            var tabWidth = tabPosition - position;\n                            var width = this.getRightTabWidth(element.indexInOwner + 1, lineWidget, paragraph);\n                            if (width < tabWidth) {\n                                defaultTabWidth = tabStop.tabJustification === 'Right' ? tabWidth - width : tabWidth - width / 2;\n                            }\n                            else if (tabStop.tabJustification === 'Center' && (width / 2) < tabWidth) {\n                                defaultTabWidth = tabWidth - width / 2;\n                            }\n                            else {\n                                defaultTabWidth = tabStop.tabJustification === 'Right' ? 0 : elementWidth;\n                            }\n                            fPosition = position;\n                            if (!isNullOrUndefined(element)) {\n                                element.tabLeader = tabs[i].tabLeader;\n                                element.tabText = '';\n                            }\n                            break;\n                        }\n                    }\n                }\n            }\n            if (!isCustomTab) {\n                var diff = ((Math.round(position) * 100) % (Math.round(defaultTabWidth) * 100)) / 100;\n                var cnt = (Math.round(position) - diff) / Math.round(defaultTabWidth);\n                fPosition = (cnt + 1) * defaultTabWidth;\n            }\n            return (fPosition - position) > 0 ? fPosition - position : defaultTabWidth;\n        }\n    };\n    /**\n     * Returns the right tab width\n     * @param index - index of starting inline\n     * @param lineWidget - current line widget\n     * @param paragraph - current paragraph widget\n     */\n    Layout.prototype.getRightTabWidth = function (index, lineWidget, paragraph) {\n        var width = 0;\n        var isFieldCode = false;\n        var elementBox = lineWidget.children[index];\n        while (elementBox) {\n            if ((elementBox instanceof FieldElementBox) || (elementBox instanceof BookmarkElementBox) || isFieldCode) {\n                if (elementBox instanceof FieldElementBox) {\n                    if (elementBox.fieldType === 0) {\n                        isFieldCode = true;\n                    }\n                    else if (elementBox.fieldType === 2) {\n                        isFieldCode = false;\n                    }\n                }\n                elementBox.width = 0;\n            }\n            else {\n                this.viewer.textHelper.getTextSize(elementBox, elementBox.characterFormat);\n            }\n            if (elementBox instanceof TextElementBox && elementBox.text === '\\t') {\n                return width;\n            }\n            else {\n                width = width + elementBox.width;\n            }\n            elementBox = elementBox.nextNode;\n        }\n        return width;\n    };\n    /**\n     * Gets split index by word.\n     * @param clientActiveWidth\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    Layout.prototype.getSplitIndexByWord = function (clientActiveWidth, text, width, characterFormat) {\n        var index = 0;\n        var length = text.length;\n        while (index < length) {\n            var nextIndex = this.getTextIndexAfterSpace(text, index);\n            if (nextIndex === 0 || nextIndex === length) {\n                nextIndex = length - 1;\n            }\n            var splitWidth = width;\n            if ((nextIndex < length - 1 || (nextIndex === length - 1 && text[nextIndex - 1] === ' ')) && index !== nextIndex) {\n                splitWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.slice(0, nextIndex), characterFormat);\n            }\n            if (splitWidth <= clientActiveWidth) {\n                index = nextIndex;\n            }\n            else {\n                if (index === 0 && text[0] === ' ') {\n                    index = this.getTextIndexAfterSpace(text, 0);\n                }\n                break;\n            }\n        }\n        return index;\n    };\n    /**\n     * Gets split index by character\n     * @param totalClientWidth\n     * @param clientActiveAreaWidth\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getTextSplitIndexByCharacter = function (totalClientWidth, clientActiveAreaWidth, text, width, characterFormat) {\n        var length = text.length;\n        for (var i = 0; i < length; i++) {\n            var splitWidth = width;\n            if (i + 1 < length) {\n                splitWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.substring(0, i + 1), characterFormat);\n            }\n            if (splitWidth > clientActiveAreaWidth) {\n                if (i === 0 && splitWidth > totalClientWidth) {\n                    //Handle for cell/section having client width less than a character's width.\n                    return (length > 1 && text[1] === ' ') ? this.getTextIndexAfterSpace(text, 1) : 1;\n                }\n                return i;\n            }\n        }\n        return 0;\n    };\n    /**\n     * Gets sub width.\n     * @param justify\n     * @param spaceCount\n     * @param firstLineIndent\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSubWidth = function (lineWidget, justify, spaceCount, firstLineIndent, isParagraphEnd) {\n        var width = 0;\n        var trimSpace = true;\n        var lineText = '';\n        for (var i = lineWidget.children.length - 1; i >= 0; i--) {\n            var element = lineWidget.children[i];\n            if (element instanceof TextElementBox) {\n                var elementText = element.text;\n                lineText = elementText + lineText;\n                if (trimSpace && (elementText.trim() !== '' || elementText === '\\t')) {\n                    if (HelperMethods.endsWith(elementText)) {\n                        width += this.viewer.textHelper.measureTextExcludingSpaceAtEnd(elementText, element.characterFormat);\n                    }\n                    else {\n                        width += element.width;\n                    }\n                    trimSpace = false;\n                }\n                else if (!trimSpace) {\n                    width += element.width;\n                }\n            }\n            else {\n                lineText = 'a' + lineText;\n                trimSpace = false;\n                width += element.width;\n            }\n            if (!justify) {\n                width = Math.round(width);\n            }\n        }\n        lineText = lineText.trim();\n        spaceCount = lineText.length - HelperMethods.removeSpace(lineText).length;\n        var subWidth = (this.viewer.clientArea.width - firstLineIndent - width);\n        if (subWidth <= 0 || (spaceCount === 0 && justify && !lineWidget.paragraph.paragraphFormat.bidi)) {\n            spaceCount = 0;\n            subWidth = 0;\n        }\n        else if (justify) {\n            // For justify alignment, element width will be updated based space count value.\n            // So when the element is paragraph end, need to set space count to zero.\n            if (!isParagraphEnd && spaceCount > 0) {\n                subWidth = subWidth / spaceCount;\n            }\n            else {\n                spaceCount = 0;\n            }\n        }\n        return { 'subWidth': subWidth, 'spaceCount': spaceCount };\n    };\n    /**\n     * Gets before spacing.\n     * @param paragraph\n     * @private\n     */\n    Layout.prototype.getBeforeSpacing = function (paragraph) {\n        var beforeSpacing = 0;\n        if (paragraph.previousWidget instanceof ParagraphWidget) {\n            if (paragraph.previousWidget.paragraphFormat.afterSpacing < paragraph.paragraphFormat.beforeSpacing) {\n                // tslint:disable-next-line:max-line-length\n                beforeSpacing = paragraph.paragraphFormat.beforeSpacing - paragraph.previousWidget.paragraphFormat.afterSpacing;\n            }\n        }\n        else {\n            beforeSpacing = paragraph.paragraphFormat.beforeSpacing;\n        }\n        return beforeSpacing;\n    };\n    /**\n     * Gets line spacing.\n     * @param paragraph\n     * @param maxHeight\n     * @private\n     */\n    Layout.prototype.getLineSpacing = function (paragraph, maxHeight) {\n        if (isNullOrUndefined(paragraph.paragraphFormat)) {\n            return 0;\n        }\n        var lineSpacing = 0;\n        switch (paragraph.paragraphFormat.lineSpacingType) {\n            case 'AtLeast':\n            case 'Exactly':\n                lineSpacing = paragraph.paragraphFormat.lineSpacing;\n                break;\n            default:\n                lineSpacing = paragraph.paragraphFormat.lineSpacing * maxHeight;\n                break;\n        }\n        return lineSpacing;\n    };\n    /**\n     * Checks whether current line is first line in a paragraph.\n     * @param paragraph\n     */\n    Layout.prototype.isParagraphFirstLine = function (paragraph, line) {\n        var widget = paragraph;\n        if (isNullOrUndefined(widget.childWidgets) || widget.childWidgets.indexOf(line) === 0) {\n            //If the line elements conatins the elements from previous paragraph then need to retun false.\n            //Example scenario, Field start and field end in different paragraphs.\n            if (line.children.length > 0 && !isNullOrUndefined(paragraph.previousWidget)\n                && paragraph.previousWidget instanceof ParagraphWidget) {\n                return line.paragraph.index !== paragraph.previousWidget.index;\n            }\n            return true; //If the line elements count is zero then also need to return true.\n        }\n        return false;\n    };\n    /**\n     * Checks whether current line is last line in a paragraph.\n     * @param paragraph\n     */\n    Layout.prototype.isParagraphLastLine = function (element) {\n        var paragraph = element.line.paragraph;\n        var lastLineWidget = paragraph.childWidgets[paragraph.childWidgets.length - 1];\n        var lastInline = lastLineWidget.children[lastLineWidget.children.length - 1];\n        if (element === lastInline) {\n            // tslint:disable-next-line:max-line-length            \n            return (lastInline instanceof FieldElementBox) || ((!(lastInline instanceof TextElementBox && lastInline.text === '\\v')));\n        }\n        return false;\n    };\n    /**\n     * Gets text index after space.\n     * @param text\n     * @param startIndex\n     */\n    Layout.prototype.getTextIndexAfterSpace = function (text, startIndex) {\n        var length = text.length;\n        var index = 0;\n        index = text.indexOf(' ', startIndex) + 1;\n        var nextIndex = index;\n        if (nextIndex === 0 || nextIndex === length) {\n            return nextIndex;\n        }\n        while (text[nextIndex] === ' ') {\n            nextIndex++;\n            if (nextIndex === length) {\n                break;\n            }\n        }\n        return nextIndex;\n    };\n    //#region Table\n    /**\n     * @private\n     */\n    Layout.prototype.moveNextWidgetsToTable = function (tableWidget, rowWidgets, moveFromNext) {\n        var currentRow = moveFromNext ? rowWidgets[rowWidgets.length - 2] : rowWidgets[rowWidgets.length - 1];\n        var rowIndex = currentRow.indexInOwner;\n        var currentTable = tableWidget[tableWidget.length - 1];\n        if (moveFromNext) {\n            rowIndex += 1;\n        }\n        var nextWidgets = currentRow.containerWidget.childWidgets.splice(rowIndex);\n        for (var i = 0; i < nextWidgets.length; i++) {\n            currentTable.childWidgets.push(nextWidgets[i]);\n            nextWidgets[i].containerWidget = currentTable;\n        }\n    };\n    /**\n     * Adds table cell widget.\n     * @param cell\n     * @param area\n     * @param maxCellMarginTop\n     * @param maxCellMarginBottom\n     */\n    Layout.prototype.addTableCellWidget = function (cell, area, maxCellMarginTop, maxCellMarginBottom) {\n        //let tableCellWidget: TableCellWidget = new TableCellWidget(cell);\n        var prevColumnIndex = 0;\n        var cellspace = 0;\n        var left = 0;\n        var top = maxCellMarginTop;\n        var right = 0;\n        var bottom = maxCellMarginBottom;\n        if (!isNullOrUndefined(cell.cellFormat)) {\n            if (cell.cellFormat.containsMargins()) {\n                // tslint:disable-next-line:max-line-length\n                left = isNullOrUndefined(cell.cellFormat.leftMargin) ? HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.leftMargin) : HelperMethods.convertPointToPixel(cell.cellFormat.leftMargin);\n                right = isNullOrUndefined(cell.cellFormat.rightMargin) ? HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.rightMargin) : HelperMethods.convertPointToPixel(cell.cellFormat.rightMargin);\n            }\n            else {\n                left = HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.leftMargin);\n                right = HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.rightMargin);\n            }\n        }\n        cell.margin = new Margin(left, top, right, bottom);\n        cell.width = HelperMethods.convertPointToPixel(cell.cellFormat.cellWidth);\n        if (!isNullOrUndefined(cell.previousWidget)) {\n            // tslint:disable-next-line:max-line-length\n            prevColumnIndex = cell.previousWidget.columnIndex + cell.previousWidget.cellFormat.columnSpan;\n        }\n        // tslint:disable-next-line:max-line-length\n        cellspace = !isNullOrUndefined(cell.ownerTable) && !isNullOrUndefined(cell.ownerTable.tableFormat) ? HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing) : 0;\n        var prevSpannedCellWidth = 0;\n        if (prevColumnIndex < cell.columnIndex) {\n            // tslint:disable-next-line:max-line-length\n            prevSpannedCellWidth = HelperMethods.convertPointToPixel(cell.ownerTable.tableHolder.getPreviousSpannedCellWidth(prevColumnIndex, cell.columnIndex));\n            if (prevColumnIndex === 0) {\n                prevSpannedCellWidth = prevSpannedCellWidth - cellspace / 2;\n            }\n        }\n        cell.x = area.x + prevSpannedCellWidth + cell.margin.left;\n        cell.y = area.y + cell.margin.top + cellspace;\n        cell.width = cell.width - cell.margin.left - cell.margin.right;\n        if (cellspace > 0) {\n            cell.x += cellspace;\n            if (cell.ownerTable.tableHolder.columns.length === 1) {\n                cell.width -= cellspace * 2;\n            }\n            else if (cell.columnIndex === 0 || cell.columnIndex === cell.ownerTable.tableHolder.columns.length - 1) {\n                cell.width -= ((cellspace * 2) - cellspace / 2);\n            }\n            else {\n                cell.width -= cellspace;\n            }\n        }\n        var leftBorderWidth = HelperMethods.convertPointToPixel(TableCellWidget.getCellLeftBorder(cell).getLineWidth());\n        var rightBorderWidth = HelperMethods.convertPointToPixel(TableCellWidget.getCellRightBorder(cell).getLineWidth());\n        // update the margins values respect to layouting of borders.\n        // for normal table cells only left border is rendred. for last cell left and right border is rendred.\n        // this border widths are not included in margins.\n        cell.leftBorderWidth = !cell.ownerTable.isBidiTable ? leftBorderWidth : rightBorderWidth;\n        cell.x += cell.leftBorderWidth;\n        cell.width -= cell.leftBorderWidth;\n        var lastCell = !cell.ownerTable.isBidiTable ? cell.cellIndex === cell.ownerRow.childWidgets.length - 1\n            : cell.cellIndex === 0;\n        if (cellspace > 0 || cell.cellIndex === cell.ownerRow.childWidgets.length - 1) {\n            cell.rightBorderWidth = !cell.ownerTable.isBidiTable ? rightBorderWidth : leftBorderWidth;\n            if (!cell.ownerTable.tableFormat.allowAutoFit) {\n                cell.width -= cell.rightBorderWidth;\n            }\n        }\n        //Add the border widths to respective margin side.\n        cell.margin.left = cell.margin.left + cell.leftBorderWidth;\n        cell.margin.right = cell.margin.right + cell.rightBorderWidth;\n        //cell.ownerWidget = owner;\n        return cell;\n    };\n    /**\n     * Adds specified row widget to table.\n     * @param viewer\n     * @param tableRowWidget\n     * @param row\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.addWidgetToTable = function (viewer, tableCollection, rowCollection, row, endRowWidget) {\n        //Adds table row widget to owner table widget.\n        var tableWidget = tableCollection[0];\n        var index = tableWidget.childWidgets.length;\n        var prevWidget = undefined;\n        var rowWidgetIndex = rowCollection.indexOf(row);\n        if (rowWidgetIndex > 0) {\n            prevWidget = rowCollection[rowWidgetIndex - 1];\n            // Need to update on this further\n        }\n        else if (row.previousRenderedWidget instanceof TableRowWidget &&\n            row.previousRenderedWidget.ownerTable.equals(row.ownerTable)) {\n            // Need to update on this further\n            prevWidget = row.previousRenderedWidget;\n        }\n        if (!isNullOrUndefined(prevWidget)) {\n            tableWidget = prevWidget.containerWidget;\n            // index = tableWidget.childWidgets.length;\n            index = tableWidget.childWidgets.indexOf(prevWidget) + 1;\n            if (Math.round(row.y) !== Math.round(prevWidget.y + prevWidget.height)) {\n                var prevIndex = tableCollection.indexOf(tableWidget);\n                if (prevIndex + 1 >= tableCollection.length) {\n                    //Creates new table widget for splitted rows.\n                    this.addTableWidget(viewer.clientActiveArea, tableCollection, true);\n                }\n                tableWidget = tableCollection[prevIndex + 1];\n                index = tableWidget.childWidgets.length;\n            }\n            if (rowWidgetIndex > 0) {\n                index = 0;\n            }\n        }\n        this.updateRowHeightBySpannedCell(tableWidget, row, index);\n        this.updateRowHeightByCellSpacing(tableCollection, row, viewer);\n        //Remove widget from previous container after splitteing\n        if (row.containerWidget && row.containerWidget !== tableWidget &&\n            row.containerWidget.childWidgets.indexOf(row) !== -1) {\n            row.containerWidget.childWidgets.splice(row.containerWidget.childWidgets.indexOf(row), 1);\n        }\n        if (tableWidget.childWidgets.indexOf(row) === -1) {\n            tableWidget.childWidgets.splice(index, 0, row);\n        }\n        row.containerWidget = tableWidget;\n        tableWidget.height = tableWidget.height + row.height;\n        // Shift the widgets for Right to left directed table.\n        if (tableWidget.isBidiTable) {\n            row.shiftWidgetForRtlTable(this.viewer.clientArea, tableWidget, row);\n        }\n        if (!isNullOrUndefined(tableWidget.containerWidget)\n            && tableWidget.containerWidget.childWidgets.indexOf(tableWidget) >= 0 &&\n            !(tableWidget.containerWidget instanceof HeaderFooterWidget)) {\n            tableWidget.containerWidget.height += row.height;\n        }\n        this.updateHeightForRowWidget(viewer, false, tableCollection, rowCollection, row, false, endRowWidget);\n        viewer.cutFromTop(row.y + row.height);\n    };\n    /**\n     * Updates row height by spanned cell.\n     * @param tableWidget\n     * @param rowWidget\n     * @param insertIndex\n     * @param row\n     * @private\n     */\n    Layout.prototype.updateRowHeightBySpannedCell = function (tableWidget, row, insertIndex) {\n        var rowSpan = 1;\n        if (tableWidget.childWidgets.length === 0 || insertIndex === 0) {\n            this.updateRowHeight(row, row);\n            return;\n        }\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cellWidget = row.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            rowSpan = (isNullOrUndefined(cellWidget) || isNullOrUndefined(cellWidget.cellFormat)) ? rowSpan : cellWidget.cellFormat.rowSpan;\n            this.updateSpannedRowCollection(rowSpan, row);\n        }\n        if (!isNullOrUndefined(row.ownerTable)) {\n            for (var i = 0; i < row.ownerTable.spannedRowCollection.length; i++) {\n                if (row.ownerTable.spannedRowCollection.keys[i] === row.index) {\n                    // Back track to previous table row widgets and update it height if vertical merge ends with this row.\n                    for (var j = 0; j < insertIndex; j++) {\n                        var prevRowWidget = tableWidget.childWidgets[j];\n                        this.updateRowHeight(prevRowWidget, row);\n                    }\n                    row.ownerTable.spannedRowCollection.remove(row.ownerTable.spannedRowCollection.keys[i]);\n                    break;\n                }\n            }\n        }\n    };\n    /**\n     * Updates row height.\n     * @param prevRowWidget\n     * @param rowWidget\n     * @param row\n     */\n    Layout.prototype.updateRowHeight = function (prevRowWidget, row) {\n        var rowIndex = row.index;\n        var rowSpan = 1;\n        for (var i = 0; i < prevRowWidget.childWidgets.length; i++) {\n            var cellWidget = prevRowWidget.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            rowSpan = (isNullOrUndefined(cellWidget) || isNullOrUndefined(cellWidget.cellFormat)) ? rowSpan : cellWidget.cellFormat.rowSpan;\n            //To update Row height- if row has row span value greater than 1, need to add it in spannedRowCollection            \n            this.updateSpannedRowCollection(rowSpan, row);\n            if (rowIndex - cellWidget.rowIndex === rowSpan - 1) {\n                var mergedCellHeight = cellWidget.y + cellWidget.height + cellWidget.margin.bottom - row.y;\n                if (row.height < mergedCellHeight) {\n                    row.height = mergedCellHeight;\n                }\n            }\n        }\n    };\n    //if row has row span value greater than 1, need to add it in spannedRowCollection\n    Layout.prototype.updateSpannedRowCollection = function (rowSpan, row) {\n        if (rowSpan > 1 && !isNullOrUndefined(row.ownerTable)) {\n            //Checks the rowspan is already exist in the list\n            if (!row.ownerTable.spannedRowCollection.containsKey(row.index + rowSpan - 1)) {\n                row.ownerTable.spannedRowCollection.add(row.index + rowSpan - 1, row.index);\n            }\n        }\n    };\n    /**\n     * Updates row height by cell spacing\n     * @param rowWidget\n     * @param viewer\n     * @param row\n     */\n    Layout.prototype.updateRowHeightByCellSpacing = function (tableCollection, row, viewer) {\n        if (row.ownerTable.tableFormat.cellSpacing > 0) {\n            // In the Case of tableWidget is greater than one and rowWidget is start at the Top Position of the page. \n            // In such case we have update the row height with half of cell spacing.\n            // Remaining cases we have to update the entire hight\n            // tslint:disable-next-line:max-line-length\n            if (tableCollection.length > 1 && row.y === viewer.clientArea.y && viewer instanceof PageLayoutViewer) {\n                row.height = row.height - HelperMethods.convertPointToPixel(row.ownerTable.tableFormat.cellSpacing) / 2;\n            }\n        }\n    };\n    /**\n     * Checks whether row span is end.\n     * @param row\n     * @param viewer\n     */\n    Layout.prototype.isRowSpanEnd = function (row, viewer) {\n        var rowIndex = row.index;\n        var rowSpan = 1;\n        for (var i = 0; i < viewer.splittedCellWidgets.length; i++) {\n            var splittedCell = viewer.splittedCellWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            rowSpan = (isNullOrUndefined(splittedCell) || isNullOrUndefined(splittedCell.cellFormat)) ? rowSpan : splittedCell.cellFormat.rowSpan;\n            if (rowIndex - splittedCell.rowIndex === rowSpan - 1) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Checks whether vertical merged cell to continue or not.\n     * @param row\n     * @private\n     */\n    Layout.prototype.isVerticalMergedCellContinue = function (row) {\n        var colIndex = 0;\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            if (colIndex < cell.columnIndex) {\n                return true;\n            }\n            colIndex += cell.cellFormat.columnSpan;\n        }\n        return colIndex < row.ownerTable.tableHolder.columns.length;\n    };\n    /**\n     * Splits widgets.\n     * @param tableRowWidget\n     * @param viewer\n     * @param splittedWidget\n     * @param row\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitWidgets = function (tableRowWidget, viewer, tableCollection, rowCollection, splittedWidget, isLastRow) {\n        if (this.isFirstLineFitForRow(viewer.clientArea.bottom, tableRowWidget) && tableRowWidget.childWidgets.length > 0) {\n            splittedWidget = this.getSplittedWidgetForRow(viewer.clientArea.bottom, tableCollection, rowCollection, tableRowWidget);\n            if (viewer.splittedCellWidgets.length > 0 || splittedWidget !== tableRowWidget) {\n                if (isLastRow) {\n                    for (var i = 0; i < splittedWidget.childWidgets.length; i++) {\n                        var cell = splittedWidget.childWidgets[i];\n                        if (cell.rowIndex !== splittedWidget.index) {\n                            splittedWidget.childWidgets.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n                //Adds the splitted widget of a vertical merged cell, to next row widget in the next page.\n                this.insertSplittedCellWidgets(viewer, tableCollection, splittedWidget, tableRowWidget.indexInOwner - 1);\n            }\n        }\n        else {\n            //Adds the splitted widget of a vertical merged cell, to next row widget in the next page.\n            this.insertSplittedCellWidgets(viewer, tableCollection, splittedWidget, tableRowWidget.indexInOwner - 1);\n        }\n        return splittedWidget;\n    };\n    /**\n     * Gets splitted widget for row.\n     * @param bottom\n     * @param tableRowWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSplittedWidgetForRow = function (bottom, tableCollection, rowCollection, tableRowWidget) {\n        var splittedWidget = undefined;\n        var rowIndex = tableRowWidget.index;\n        for (var i = 0; i < tableRowWidget.childWidgets.length; i++) {\n            var cellWidget = tableRowWidget.childWidgets[i];\n            var splittedCell = this.getSplittedWidget(bottom, true, tableCollection, rowCollection, cellWidget);\n            if (!isNullOrUndefined(splittedCell)) {\n                if (splittedCell === cellWidget) {\n                    //Returns if the whole content of the row does not fit in current page.\n                    return tableRowWidget;\n                }\n                if (tableRowWidget.childWidgets.indexOf(splittedCell) !== -1) {\n                    tableRowWidget.childWidgets.splice(tableRowWidget.childWidgets.indexOf(splittedCell), 1);\n                }\n                if (i === 0 || tableRowWidget.height < cellWidget.height + cellWidget.margin.top + cellWidget.margin.bottom) {\n                    tableRowWidget.height = cellWidget.height + cellWidget.margin.top + cellWidget.margin.bottom;\n                }\n                if (isNullOrUndefined(splittedWidget)) {\n                    //Creates new widget, to hold the splitted contents.\n                    splittedWidget = new TableRowWidget();\n                    splittedWidget.containerWidget = tableRowWidget.containerWidget;\n                    splittedWidget.index = tableRowWidget.index;\n                    splittedWidget.rowFormat = tableRowWidget.rowFormat;\n                    this.updateWidgetLocation(tableRowWidget, splittedWidget);\n                    splittedWidget.height = 0;\n                    rowCollection.push(splittedWidget);\n                }\n                var rowSpan = 1;\n                // tslint:disable-next-line:max-line-length\n                rowSpan = (isNullOrUndefined(splittedCell) || isNullOrUndefined(splittedCell.cellFormat)) ? rowSpan : splittedCell.cellFormat.rowSpan;\n                if (rowIndex - splittedCell.rowIndex === rowSpan - 1\n                    && splittedWidget.height < splittedCell.height + splittedCell.margin.top + splittedCell.margin.bottom) {\n                    splittedWidget.height = splittedCell.height + splittedCell.margin.top + splittedCell.margin.bottom;\n                }\n                splittedWidget.childWidgets.push(splittedCell);\n                splittedCell.containerWidget = splittedWidget;\n            }\n        }\n        return splittedWidget;\n    };\n    /**\n     * Updates widget to table.\n     * @param row\n     * @param viewer\n     */\n    /* tslint:disable */\n    Layout.prototype.updateWidgetsToTable = function (tableWidgets, rowWidgets, row) {\n        var rowHeight = this.getRowHeight(row, [row]);\n        var viewer = this.viewer;\n        //initializing row properties with default values.\n        var isHeader = row.rowFormat.isHeader;\n        var isAllowBreakAcrossPages = row.rowFormat.allowBreakAcrossPages;\n        var heightType = row.rowFormat.heightType;\n        var cellSpacing = 0;\n        var count = 0;\n        var tableRowWidget = row;\n        var moveRowToNextTable = false;\n        if (row.ownerTable.continueHeader && !isHeader) {\n            row.ownerTable.continueHeader = false;\n        }\n        var isLastRow = false;\n        cellSpacing = (!isNullOrUndefined(row.ownerTable) && !isNullOrUndefined(row.ownerTable.tableFormat)) ? HelperMethods.convertPointToPixel(row.ownerTable.tableFormat.cellSpacing) : 0;\n        while (count < rowWidgets.length) {\n            count = rowWidgets.length;\n            if (row.ownerTable.isInsideTable || (viewer.splittedCellWidgets.length === 0 && tableRowWidget.y + tableRowWidget.height + cellSpacing <= viewer.clientArea.bottom)) {\n                this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                if (viewer.splittedCellWidgets.length > 0 && isNullOrUndefined(rowWidgets[rowWidgets.length - 1].nextRow)) {\n                    count--;\n                    isLastRow = true;\n                }\n            }\n            else {\n                //Split widget for next page\n                if (viewer.splittedCellWidgets.length > 0 && tableRowWidget.y + tableRowWidget.height <= viewer.clientArea.bottom) {\n                    var isRowSpanEnd = this.isRowSpanEnd(row, viewer);\n                    if (!isRowSpanEnd) {\n                        if (this.isVerticalMergedCellContinue(row) && tableRowWidget.y === viewer.clientArea.y) {\n                            this.insertSplittedCellWidgets(viewer, tableWidgets, tableRowWidget, tableRowWidget.indexInOwner - 1);\n                        }\n                        this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                        continue;\n                    }\n                }\n                var splittedWidget = tableRowWidget;\n                var tableWidget = tableWidgets[tableWidgets.length - 1];\n                if (rowHeight + tableRowWidget.y > viewer.clientArea.bottom) {\n                    // tslint:disable-next-line:max-line-length\n                    if (!isAllowBreakAcrossPages || (isHeader && row.ownerTable.continueHeader) || (heightType === 'AtLeast' && HelperMethods.convertPointToPixel(row.rowFormat.height) < viewer.clientArea.bottom)) {\n                        // tslint:disable-next-line:max-line-length\n                        if ((heightType === 'AtLeast' && HelperMethods.convertPointToPixel(row.rowFormat.height) < viewer.clientActiveArea.height && isAllowBreakAcrossPages) || (heightType !== 'Exactly' && tableRowWidget.y === viewer.clientArea.y) || (heightType === 'Auto' && isAllowBreakAcrossPages)) {\n                            splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                        }\n                        if (heightType === 'Exactly' && tableRowWidget.y === viewer.clientArea.y) {\n                            this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                            count++;\n                        }\n                        if (isHeader && row.ownerTable.continueHeader) {\n                            row.ownerTable.header = false;\n                            row.ownerTable.continueHeader = false;\n                            row.ownerTable.headerHeight = 0;\n                            var pages = undefined;\n                            // if (viewer instanceof PageLayoutViewer) {\n                            pages = viewer.pages;\n                            // }\n                            if (!isNullOrUndefined(pages)) {\n                                for (var i = 0; i < pages.length; i++) {\n                                    if (pages[i].repeatHeaderRowTableWidget) {\n                                        pages[i].repeatHeaderRowTableWidget = false;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    else {\n                        if ((heightType === 'Auto' || heightType === 'AtLeast') && isAllowBreakAcrossPages) {\n                            // tslint:disable-next-line:max-line-length\n                            if (!(HelperMethods.convertPointToPixel(row.rowFormat.height) > viewer.clientArea.bottom) || tableRowWidget.y === viewer.clientArea.y) {\n                                splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                            }\n                        }\n                        else if (heightType === 'Exactly' && tableRowWidget.y === viewer.clientArea.y) {\n                            this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                            count++;\n                        }\n                    }\n                }\n                else {\n                    var isInsertSplittedWidgets = false;\n                    // Splitting handled for the merged cell with allowRowBreakAcross pages. \n                    if (this.isVerticalMergedCellContinue(row) && (isAllowBreakAcrossPages ||\n                        (isInsertSplittedWidgets = tableRowWidget.y === viewer.clientArea.y))) {\n                        if (isInsertSplittedWidgets) {\n                            this.insertSplittedCellWidgets(viewer, tableWidgets, splittedWidget, tableRowWidget.indexInOwner - 1);\n                        }\n                        else {\n                            splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                        }\n                    }\n                    else if (isLastRow && !isAllowBreakAcrossPages) {\n                        splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                    }\n                }\n                //Create New table for splitted widget\n                if (!isNullOrUndefined(splittedWidget)) {\n                    if (splittedWidget !== tableRowWidget) {\n                        this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget, tableRowWidget.nextRow);\n                        //Updates the fitted table rows to current page.\n                        this.updateWidgetsToPage(tableWidgets, rowWidgets, row.ownerTable, tableRowWidget.nextRow);\n                        var index_2 = tableWidgets.indexOf(tableRowWidget.containerWidget);\n                        if (index_2 + 1 >= tableWidgets.length) {\n                            //Creates new table widget for splitted rows.\n                            this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                        }\n                        tableRowWidget = splittedWidget;\n                    }\n                    else {\n                        if (row.index > 0) {\n                            //Updates the fitted table rows to current page.\n                            this.updateWidgetsToPage(tableWidgets, rowWidgets, row.ownerTable, row);\n                            // Need to update on this further\n                            if (row.previousRenderedWidget instanceof TableRowWidget) {\n                                // Need to update on this further\n                                var prevWidget = row.previousRenderedWidget;\n                                if (HelperMethods.round(tableRowWidget.y, 2) === HelperMethods.round(prevWidget.y + prevWidget.height, 2)) {\n                                    var prevIndex = tableWidgets.indexOf(prevWidget.containerWidget);\n                                    if (prevIndex + 1 >= tableWidgets.length) {\n                                        //Creates new table widget for splitted rows.\n                                        this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                                    }\n                                }\n                                else {\n                                    //Creates new table widget for splitted rows.\n                                    this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                                }\n                            }\n                            else {\n                                //Creates new table widget for splitted rows.\n                                this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                            }\n                        }\n                        moveRowToNextTable = true;\n                        count--;\n                    }\n                    tableWidget = tableWidgets[tableWidgets.length - 1];\n                    var prevBodyWidget = undefined;\n                    if (tableWidgets.length > 1) {\n                        //Get Previous Splitted Widget container\n                        prevBodyWidget = tableWidgets[tableWidgets.length - 2].containerWidget;\n                    }\n                    else {\n                        var previousBlock = row.ownerTable.previousRenderedWidget;\n                        prevBodyWidget = previousBlock.containerWidget;\n                    }\n                    var pageIndex = 0;\n                    if (!isNullOrUndefined(prevBodyWidget)) {\n                        pageIndex = viewer.pages.indexOf(prevBodyWidget.page);\n                    }\n                    var index = row.ownerTable.containerWidget.index;\n                    var bodyWidget = void 0;\n                    var block = void 0;\n                    if (moveRowToNextTable && tableWidgets.length === 1) {\n                        block = tableWidgets[tableWidgets.length - 1];\n                    }\n                    else {\n                        block = tableWidgets[tableWidgets.length - 2];\n                    }\n                    bodyWidget = this.moveBlocksToNextPage(block);\n                    var curretTable = tableWidgets[tableWidgets.length - 1];\n                    //Move Next RowWidge to next page\n                    if (moveRowToNextTable) {\n                        // tslint:disable-next-line:max-line-length\n                        if (row.index === 0 && curretTable.containerWidget && curretTable.containerWidget.childWidgets.indexOf(curretTable) !== -1) {\n                            curretTable.containerWidget.childWidgets.splice(curretTable.containerWidget.childWidgets.indexOf(curretTable), 1);\n                        }\n                    }\n                    if (bodyWidget.childWidgets.indexOf(curretTable) !== -1) {\n                        bodyWidget.childWidgets.splice(bodyWidget.childWidgets.indexOf(curretTable), 1);\n                    }\n                    bodyWidget.childWidgets.unshift(curretTable);\n                    curretTable.containerWidget = bodyWidget;\n                    if (moveRowToNextTable && row.index > 0 || rowWidgets.length > 1) {\n                        this.moveNextWidgetsToTable(tableWidgets, rowWidgets, !moveRowToNextTable);\n                    }\n                    moveRowToNextTable = false;\n                    if (row.ownerTable.header && tableRowWidget.height < viewer.clientArea.bottom) {\n                        // if (viewer instanceof PageLayoutViewer) {\n                        viewer.currentRenderingPage.repeatHeaderRowTableWidget = true;\n                        // }\n                        //Updates table widgets location.\n                        viewer.updateClientAreaForBlock(row.ownerTable, true, tableWidgets);\n                        // tslint:disable-next-line:max-line-length\n                        //Update splitted row widget location. if header is repeated update the y position of splitted widget to header height.\n                        splittedWidget.x = splittedWidget.x;\n                        splittedWidget.y = tableWidget.y + row.ownerTable.headerHeight;\n                        // let cellspace: number = viewer instanceof PageLayoutViewer ? cellspacing / 2 : cellspacing;\n                        var cellspace = cellSpacing / 2;\n                        this.updateChildLocationForRow(tableWidget.y + row.ownerTable.headerHeight - cellspace, splittedWidget);\n                    }\n                    else {\n                        //Updates table widgets location.\n                        viewer.updateClientAreaForBlock(row.ownerTable, true, tableWidgets);\n                        // tslint:disable-next-line:max-line-length\n                        //Update splitted row widget location. if header is repeated update the y position of splitted widget to header height.\n                        splittedWidget.x = splittedWidget.x;\n                        splittedWidget.y = tableWidget.y;\n                        // let cellspace: number = viewer instanceof PageLayoutViewer ? cellspacing / 2 : cellspacing;\n                        var cellspace = cellSpacing / 2;\n                        this.updateChildLocationForRow(tableWidget.y - cellspace, splittedWidget);\n                    }\n                }\n                isLastRow = false;\n            }\n            if (isHeader && row.ownerTable.continueHeader) {\n                row.ownerTable.header = true;\n                row.ownerTable.headerHeight = rowHeight + row.ownerTable.headerHeight;\n            }\n            if (isHeader && !isNullOrUndefined(this.getHeader(row.ownerTable)) && row.index === this.getHeader(row.ownerTable).index) {\n                var headerHeight = this.getHeaderHeight(row.ownerTable, row, rowWidgets);\n                if (headerHeight > row.ownerTable.headerHeight || headerHeight > row.ownerTable.headerHeight) {\n                    row.ownerTable.headerHeight = headerHeight;\n                }\n                if (row.ownerTable.headerHeight > viewer.clientArea.height) {\n                    row.ownerTable.header = false;\n                    row.ownerTable.continueHeader = false;\n                    row.ownerTable.headerHeight = 0;\n                    var pages = viewer.pages;\n                    for (var i = 0; i < pages.length; i++) {\n                        if (pages[i].repeatHeaderRowTableWidget) {\n                            pages[i].repeatHeaderRowTableWidget = false;\n                        }\n                    }\n                }\n            }\n            if (tableWidgets.length > 2 && row.ownerTable.header && tableRowWidget.height < viewer.clientActiveArea.bottom &&\n                !viewer.currentRenderingPage.repeatHeaderRowTableWidget) {\n                viewer.currentRenderingPage.repeatHeaderRowTableWidget = true;\n            }\n        }\n    };\n    /* tslint:enable */\n    /**\n     * Gets header.\n     * @param table\n     * @private\n     */\n    Layout.prototype.getHeader = function (table) {\n        var header = undefined;\n        var flag = true;\n        table = table.getSplitWidgets()[0];\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.rowFormat.isHeader) {\n                header = row;\n            }\n            else {\n                flag = false;\n            }\n            if (!flag) {\n                break;\n            }\n        }\n        return header;\n    };\n    /**\n     * Gets header height.\n     * @param ownerTable\n     * @param row\n     */\n    Layout.prototype.getHeaderHeight = function (ownerTable, row, rowCollection) {\n        var height = 0;\n        if (row.ownerTable.childWidgets.length > 0 && ownerTable.childWidgets[0].rowFormat.isHeader) {\n            for (var i = 0; i < ownerTable.childWidgets.length; i++) {\n                var row_1 = ownerTable.childWidgets[i];\n                if (row_1.rowFormat.isHeader) {\n                    height = height + this.getRowHeight(row_1, rowCollection);\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        return height;\n    };\n    /**\n     * Updates widgets to row.\n     * @param cell\n     */\n    Layout.prototype.updateWidgetToRow = function (cell) {\n        var viewer = this.viewer;\n        //Adds table cell widget to owner row widget.\n        var rowWidget = cell.ownerRow;\n        var cellLeft = rowWidget.x;\n        if (rowWidget.childWidgets.length > 0) {\n            var lastWidget = rowWidget.childWidgets[rowWidget.childWidgets.length - 1];\n            cellLeft = lastWidget.x + lastWidget.width + lastWidget.margin.right;\n        }\n        // rowWidget.childWidgets.push(cell);\n        cell.containerWidget = rowWidget;\n        //If the row height is set as Atleast then height is set to atleast height for the first cell of the row.\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(cell.ownerRow) && cell.ownerRow.rowFormat.heightType !== 'Exactly' && HelperMethods.convertPointToPixel(cell.ownerRow.rowFormat.height) > 0 && cell.cellIndex === 0) {\n            rowWidget.height = rowWidget.height + HelperMethods.convertPointToPixel(cell.ownerRow.rowFormat.height);\n        }\n        //Add condition not cell merged vertically.\n        if (cell.cellFormat.rowSpan === 1) {\n            var cellHeight = cell.height + cell.margin.top + cell.margin.bottom;\n            if (rowWidget.height - HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing) < cellHeight) {\n                rowWidget.height = cellHeight + HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing);\n            }\n        }\n    };\n    /**\n     * Updates height for row widget.\n     * @param viewer\n     * @param isUpdateVerticalPosition\n     * @param rowWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.updateHeightForRowWidget = function (viewer, isUpdateVerticalPosition, tableCollection, rowCollection, rowWidget, isLayouted, endRowWidget) {\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellspacing = 0;\n            var cellWidget = undefined;\n            var childWidget = rowWidget.childWidgets[i];\n            // if (childWidget instanceof TableCellWidget) {\n            cellWidget = childWidget;\n            // }\n            var rowSpan = 1;\n            rowSpan = cellWidget.cellFormat.rowSpan;\n            cellspacing = HelperMethods.convertPointToPixel(cellWidget.ownerTable.tableFormat.cellSpacing);\n            if (rowSpan > 1) {\n                var currentRowWidgetIndex = rowWidget.containerWidget.childWidgets.indexOf(rowWidget);\n                // tslint:disable-next-line:max-line-length\n                var rowSpanWidgetEndIndex = currentRowWidgetIndex + rowSpan - 1 - (rowWidget.index - cellWidget.rowIndex);\n                if (viewer.clientArea.bottom < cellWidget.y + cellWidget.height + cellWidget.margin.bottom\n                    || rowSpanWidgetEndIndex >= currentRowWidgetIndex + 1) {\n                    this.splitSpannedCellWidget(cellWidget, tableCollection, rowCollection, viewer);\n                }\n                var spanEndRowWidget = rowWidget;\n                if (rowSpanWidgetEndIndex > 0) {\n                    if (rowSpanWidgetEndIndex < rowWidget.containerWidget.childWidgets.length) {\n                        var childWidget_1 = rowWidget.containerWidget.childWidgets[rowSpanWidgetEndIndex];\n                        if (childWidget_1 instanceof TableRowWidget) {\n                            spanEndRowWidget = childWidget_1;\n                            if (spanEndRowWidget === endRowWidget) {\n                                spanEndRowWidget = rowWidget;\n                            }\n                        }\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        spanEndRowWidget = rowWidget.containerWidget.childWidgets[rowWidget.containerWidget.childWidgets.length - 1];\n                    }\n                }\n                if (cellWidget.y + cellWidget.height + cellWidget.margin.bottom < spanEndRowWidget.y + spanEndRowWidget.height) {\n                    cellWidget.height = spanEndRowWidget.y + spanEndRowWidget.height - cellWidget.y - cellWidget.margin.bottom;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (isLayouted && spanEndRowWidget && (spanEndRowWidget.y !== 0 && spanEndRowWidget.height !== 0) && cellWidget.y + cellWidget.height + cellWidget.margin.bottom > spanEndRowWidget.y + spanEndRowWidget.height) {\n                    spanEndRowWidget.height = cellWidget.y + cellWidget.height + cellWidget.margin.bottom - spanEndRowWidget.y;\n                    // tslint:disable-next-line:max-line-length\n                    //Update the next rowlayout widget location. Reason for the updation is previous row height is updated when cell height is greater. So already layouted next row location has to be updated again.\n                    // if (rowWidget === spanEndRowWidget && rowWidget.nextWidget instanceof TableRowWidget) {\n                    //     let nextRow: TableRowWidget = rowWidget.nextWidget as TableRowWidget;\n                    //     // Need to update on this further\n                    //     // if (viewer.renderedElements.containsKey(nextRow)) {\n                    //     //     let nextWidget: TableRowWidget[] = viewer.renderedElements.get(nextRow) as TableRowWidget[];\n                    //     //     if (nextWidget.length > 0) {\n                    //     //         nextWidget[0].x = nextWidget[0].x;\n                    //     //         nextWidget[0].y = rowWidget.y + rowWidget.height;\n                    //     //     }\n                    //     // }\n                    // }\n                }\n            }\n            else {\n                if (cellspacing > 0) {\n                    // In the Case of tableWidget is greater than one and rowWidget is start at the Top Position of the page. \n                    // In such case we have update the cell height with half of cell spacing.\n                    // Remaining cases we have to update the entire hight\n                    // tslint:disable-next-line:max-line-length\n                    if (tableCollection.length > 1 && rowWidget.y === viewer.clientArea.y && viewer instanceof PageLayoutViewer) {\n                        cellspacing = cellspacing / 2;\n                    }\n                }\n                cellWidget.height = rowWidget.height - cellWidget.margin.top - cellWidget.margin.bottom - cellspacing;\n            }\n            this.updateHeightForCellWidget(viewer, tableCollection, rowCollection, cellWidget);\n            var widget = rowWidget.containerWidget;\n            while (widget.containerWidget instanceof Widget) {\n                widget = widget.containerWidget;\n            }\n            var page = undefined;\n            if (widget instanceof BodyWidget) {\n                page = widget.page;\n            }\n            // tslint:disable-next-line:max-line-length\n            if ((viewer instanceof PageLayoutViewer && viewer.visiblePages.indexOf(page) !== -1) || isUpdateVerticalPosition) {\n                this.updateCellVerticalPosition(cellWidget, false, false);\n            }\n            //Renders the current table row contents, after relayout based on editing.\n            // if (viewer instanceof PageLayoutViewer && (viewer as PageLayoutViewer).visiblePages.indexOf(page) !== -1) {\n            //     //Added proper undefined condition check for Asynchronous operation.\n            //     if (!isNullOrUndefined(rowWidget.tableRow) && !isNullOrUndefined(rowWidget.tableRow.rowFormat)) {\n            //         this.viewer.updateScrollBars();\n            //         //this.render.renderTableCellWidget(page, cellWidget);\n            //     }\n            // }\n        }\n    };\n    /**\n     * Updates height for cell widget.\n     * @param viewer\n     * @param cellWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.updateHeightForCellWidget = function (viewer, tableWidget, rowCollection, cellWidget) {\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof TableWidget) {\n                this.updateHeightForTableWidget(tableWidget, rowCollection, cellWidget.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * Gets row height.\n     * @param row\n     * @private\n     */\n    Layout.prototype.getRowHeight = function (row, rowCollection) {\n        var height = 0;\n        if (row.rowFormat.heightType === 'Exactly') {\n            height = row.rowFormat.height;\n        }\n        else {\n            for (var i = 0; i < rowCollection.length; i++) {\n                if (rowCollection[i] instanceof TableRowWidget) {\n                    height = rowCollection[i].height + height;\n                }\n            }\n            height = Math.max(height, row.rowFormat.height);\n        }\n        return height;\n    };\n    /**\n     * splits spanned cell widget.\n     * @param cellWidget\n     * @param viewer\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitSpannedCellWidget = function (cellWidget, tableCollection, rowCollection, viewer) {\n        var splittedCell = this.getSplittedWidget(viewer.clientArea.bottom, false, tableCollection, rowCollection, cellWidget);\n        if (!isNullOrUndefined(splittedCell)) {\n            //Adds the splitted contents of a vertical merged cell, in order preserve in next page.\n            viewer.splittedCellWidgets.push(splittedCell);\n        }\n    };\n    /**\n     * Inserts splitted cell widgets.\n     * @param viewer\n     * @param rowWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.insertSplittedCellWidgets = function (viewer, tableCollection, rowWidget, previousRowIndex) {\n        var left = rowWidget.x;\n        var tableWidth = 0;\n        tableWidth = HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableHolder.tableWidth);\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellWidget = rowWidget.childWidgets[i];\n            if (Math.round(left) < Math.round(cellWidget.x - cellWidget.margin.left)) {\n                if (this.insertRowSpannedWidget(rowWidget, viewer, left, i)) {\n                    i--;\n                    continue;\n                }\n                var length_1 = rowWidget.childWidgets.length;\n                this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, i, previousRowIndex);\n                if (length_1 < rowWidget.childWidgets.length) {\n                    i--;\n                    continue;\n                }\n            }\n            left += cellWidget.margin.left + cellWidget.width + cellWidget.margin.right;\n            if (i === rowWidget.childWidgets.length - 1 && Math.round(left) < Math.round(rowWidget.x + tableWidth)) {\n                if (this.insertRowSpannedWidget(rowWidget, viewer, left, i + 1)) {\n                    continue;\n                }\n                this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, i + 1, previousRowIndex);\n                continue;\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        // Special case: when the child widgets of row is equal to 0 then the splitted widgets in the viewer is added in the table row widgets. \n        if ((isNullOrUndefined(rowWidget.childWidgets) || rowWidget.childWidgets.length === 0) && viewer.splittedCellWidgets.length > 0) {\n            for (var j = 0; j < viewer.splittedCellWidgets.length; j++) {\n                var widget = viewer.splittedCellWidgets[j];\n                if (Math.round(left) <= Math.round(widget.x - widget.margin.left)) {\n                    if (this.insertRowSpannedWidget(rowWidget, viewer, left, j)) {\n                        j--;\n                        continue;\n                    }\n                    var count = rowWidget.childWidgets.length;\n                    this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, j, previousRowIndex);\n                    if (count < rowWidget.childWidgets.length) {\n                        j--;\n                        continue;\n                    }\n                }\n                left += widget.margin.left + widget.width + widget.margin.right;\n                if (j === rowWidget.childWidgets.length - 1 && Math.round(left) <\n                    Math.round(rowWidget.x + tableWidth)) {\n                    if (this.insertRowSpannedWidget(rowWidget, viewer, left, j + 1)) {\n                        continue;\n                    }\n                    this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, j + 1, previousRowIndex);\n                    continue;\n                }\n            }\n        }\n        if (viewer.splittedCellWidgets.length > 0) {\n            viewer.splittedCellWidgets = [];\n        }\n    };\n    /**\n     * Inserts spanned row widget.\n     * @param rowWidget\n     * @param viewer\n     * @param left\n     * @param index\n     */\n    Layout.prototype.insertRowSpannedWidget = function (rowWidget, viewer, left, index) {\n        var cellSpacing = 0;\n        if (rowWidget.ownerTable.tableFormat.cellSpacing > 0) {\n            cellSpacing = HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableFormat.cellSpacing);\n        }\n        for (var i = 0; i < viewer.splittedCellWidgets.length; i++) {\n            var splittedCell = viewer.splittedCellWidgets[i];\n            if (Math.round(left) === Math.round(splittedCell.x - splittedCell.margin.left)) {\n                rowWidget.childWidgets.splice(index, 0, splittedCell);\n                splittedCell.containerWidget = rowWidget;\n                //If the splitted cell location differs from expected location update the location of row child widgets.\n                if (splittedCell.y !== rowWidget.y + splittedCell.margin.top + cellSpacing) {\n                    this.updateChildLocationForRow(rowWidget.y, rowWidget);\n                }\n                viewer.splittedCellWidgets = [];\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Inserts empty splitted cell widgets.\n     * @param rowWidget\n     * @param left\n     * @param index\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.insertEmptySplittedCellWidget = function (currentRow, tableCollection, left, index, previousRowIndex) {\n        var tableWidget = tableCollection[tableCollection.length - 1];\n        for (var i = previousRowIndex; i >= 0; i--) {\n            var rowWidget = tableWidget.childWidgets[i];\n            var previousLeft = rowWidget.x;\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                var rowSpan = 1;\n                var cellWidget = rowWidget.childWidgets[j];\n                if (Math.round(left) === Math.round(previousLeft)) {\n                    rowSpan = (isNullOrUndefined(cellWidget) || isNullOrUndefined(cellWidget.cellFormat)) ? rowSpan :\n                        cellWidget.cellFormat.rowSpan;\n                    if (rowSpan > 1) {\n                        var emptyCellWidget = this.createCellWidget(cellWidget);\n                        currentRow.childWidgets.splice(index, 0, emptyCellWidget);\n                        emptyCellWidget.containerWidget = currentRow;\n                    }\n                    return;\n                }\n                previousLeft += cellWidget.margin.left + cellWidget.width + cellWidget.margin.right;\n            }\n        }\n    };\n    /**\n     * Gets spllited widget.\n     * @param bottom\n     * @param splitMinimalWidget\n     * @param cellWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSplittedWidget = function (bottom, splitMinimalWidget, tableCollection, rowCollection, cellWidget) {\n        var splittedWidget = undefined;\n        if (cellWidget.y + cellWidget.height > bottom - cellWidget.margin.bottom) {\n            for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n                if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                    var paragraphWidget = cellWidget.childWidgets[i];\n                    var splittedPara = this.getSplittedWidgetForPara(bottom - cellWidget.margin.bottom, paragraphWidget);\n                    if (!isNullOrUndefined(splittedPara)) {\n                        if (i === 0 && splittedPara === paragraphWidget) {\n                            //Returns if the whole content of the cell does not fit in current page.\n                            return cellWidget;\n                        }\n                        if (cellWidget.childWidgets.indexOf(splittedPara) !== -1) {\n                            cellWidget.childWidgets.splice(cellWidget.childWidgets.indexOf(splittedPara), 1);\n                            i--;\n                        }\n                        cellWidget.height -= splittedPara.height;\n                        if (isNullOrUndefined(splittedWidget)) {\n                            //Creates new widget, to hold the splitted contents.\n                            splittedWidget = this.createCellWidget(cellWidget);\n                        }\n                        splittedWidget.height += splittedPara.height;\n                        splittedWidget.childWidgets.push(splittedPara);\n                        splittedPara.containerWidget = splittedWidget;\n                    }\n                }\n                else {\n                    var tableWidget = cellWidget.childWidgets[i];\n                    var tableCol = [tableWidget];\n                    //Check for nested table.\n                    if (bottom - cellWidget.margin.bottom < tableWidget.y + tableWidget.height) {\n                        var tableHeight = tableWidget.height;\n                        // tslint:disable-next-line:max-line-length\n                        var splittedTable = this.getSplittedWidgetForTable(bottom - cellWidget.margin.bottom, tableCol, tableWidget);\n                        if (!isNullOrUndefined(splittedTable)) {\n                            if (i === 0 && splittedTable === tableWidget) {\n                                //Returns if the whole table does not fit in current page.\n                                return cellWidget;\n                            }\n                            if (cellWidget.childWidgets.indexOf(splittedTable) !== -1) {\n                                cellWidget.childWidgets.splice(cellWidget.childWidgets.indexOf(splittedTable), 1);\n                                i--;\n                                cellWidget.height -= splittedTable.height;\n                            }\n                            else {\n                                cellWidget.height -= tableHeight - tableWidget.height;\n                            }\n                            if (isNullOrUndefined(splittedWidget)) {\n                                //Creates new widget, to hold the splitted contents.\n                                splittedWidget = this.createCellWidget(cellWidget);\n                            }\n                            splittedWidget.height += splittedTable.height;\n                            splittedWidget.childWidgets.push(splittedTable);\n                            splittedTable.containerWidget = splittedWidget;\n                        }\n                    }\n                }\n            }\n        }\n        if (isNullOrUndefined(splittedWidget) && splitMinimalWidget) {\n            //Creates new widget, to hold the splitted contents.\n            splittedWidget = this.createCellWidget(cellWidget);\n        }\n        return splittedWidget;\n    };\n    /**\n     * Gets list level pattern\n     * @param value\n     * @private\n     */\n    Layout.prototype.getListLevelPattern = function (value) {\n        switch (value) {\n            case 0:\n                return 'Arabic';\n            case 1:\n                return 'UpRoman';\n            case 2:\n                return 'LowRoman';\n            case 3:\n                return 'UpLetter';\n            case 4:\n                return 'LowLetter';\n            case 5:\n                return 'Ordinal';\n            case 6:\n                return 'Number';\n            case 7:\n                return 'OrdinalText';\n            case 8:\n                return 'LeadingZero';\n            case 9:\n                return 'Bullet';\n            case 10:\n                return 'FarEast';\n            case 11:\n                return 'Special';\n            default:\n                return 'None';\n        }\n    };\n    /**\n     * Creates cell widget.\n     * @param cell\n     */\n    Layout.prototype.createCellWidget = function (cell) {\n        var cellWidget = new TableCellWidget();\n        cellWidget.cellFormat = cell.cellFormat;\n        cellWidget.index = cell.index;\n        cellWidget.rowIndex = cell.rowIndex;\n        cellWidget.columnIndex = cell.columnIndex;\n        cellWidget.containerWidget = cell.containerWidget;\n        this.updateWidgetLocation(cell, cellWidget);\n        cellWidget.margin = cell.margin;\n        cellWidget.leftBorderWidth = HelperMethods.convertPointToPixel(cell.leftBorderWidth);\n        cellWidget.rightBorderWidth = HelperMethods.convertPointToPixel(cell.rightBorderWidth);\n        return cellWidget;\n    };\n    /**\n     * Create Table Widget\n     */\n    Layout.prototype.createTableWidget = function (table) {\n        var newTable = new TableWidget();\n        if (table.header) {\n            newTable.header = table.header;\n            newTable.headerHeight = table.headerHeight;\n        }\n        newTable.index = table.index;\n        newTable.tableFormat = table.tableFormat;\n        newTable.tableHolder = table.tableHolder;\n        newTable.isGridUpdated = table.isGridUpdated;\n        return newTable;\n    };\n    /**\n     * Gets splitted widget for paragraph.\n     * @param bottom\n     * @param paragraphWidget\n     */\n    Layout.prototype.getSplittedWidgetForPara = function (bottom, paragraphWidget) {\n        var lineBottom = paragraphWidget.y;\n        var splittedWidget = undefined;\n        for (var i = 0; i < paragraphWidget.childWidgets.length; i++) {\n            var lineWidget = paragraphWidget.childWidgets[i];\n            if (bottom < lineBottom + lineWidget.height) {\n                if (i === 0) {\n                    if (lineWidget.paragraph.containerWidget instanceof TableCellWidget) {\n                        //checks first line of the page is exceed the page height\n                        if (lineWidget.paragraph.containerWidget.y === paragraphWidget.y) {\n                            lineBottom += lineWidget.height;\n                            continue;\n                        }\n                    }\n                    splittedWidget = paragraphWidget;\n                    break;\n                }\n                if (paragraphWidget.childWidgets.indexOf(lineWidget) !== -1) {\n                    paragraphWidget.childWidgets.splice(paragraphWidget.childWidgets.indexOf(lineWidget), 1);\n                    i--;\n                }\n                paragraphWidget.height -= lineWidget.height;\n                if (isNullOrUndefined(splittedWidget)) {\n                    //Creates new widget, to hold the splitted contents.\n                    splittedWidget = new ParagraphWidget();\n                    splittedWidget.characterFormat = paragraphWidget.characterFormat;\n                    splittedWidget.paragraphFormat = paragraphWidget.paragraphFormat;\n                    splittedWidget.index = paragraphWidget.index;\n                    this.updateWidgetLocation(paragraphWidget, splittedWidget);\n                    splittedWidget.height = lineWidget.height;\n                }\n                else {\n                    splittedWidget.height += lineWidget.height;\n                }\n                splittedWidget.childWidgets.push(lineWidget);\n                lineWidget.paragraph = splittedWidget;\n            }\n            lineBottom += lineWidget.height;\n        }\n        return splittedWidget;\n    };\n    /**\n     * Gets splitted table widget.\n     * @param bottom\n     * @param tableWidget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSplittedWidgetForTable = function (bottom, tableCollection, tableWidget) {\n        var rowBottom = tableWidget.y;\n        var splittedWidget = undefined;\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = undefined;\n            var childWidget = tableWidget.childWidgets[i];\n            // if (childWidget instanceof TableRowWidget) {\n            rowWidget = childWidget;\n            // }\n            var rowHeight = rowWidget.height;\n            if (bottom < rowBottom + rowHeight || !isNullOrUndefined(splittedWidget)) {\n                //ToDo: Check whether row included in vertical merge or AllowRowSplitbyPage is true, if so split row.\n                //Checks if atleast first line fits in the client area.                \n                var splittedRow = undefined;\n                var allowRowBreakAcrossPages = true;\n                if (!isNullOrUndefined(rowWidget) && !isNullOrUndefined(rowWidget.rowFormat)) {\n                    allowRowBreakAcrossPages = rowWidget.rowFormat.allowBreakAcrossPages;\n                }\n                if (allowRowBreakAcrossPages) {\n                    // tslint:disable-next-line:max-line-length\n                    splittedRow = (isNullOrUndefined(splittedWidget) && this.isFirstLineFitForRow(bottom, rowWidget)) ? this.getSplittedWidgetForRow(bottom, tableCollection, [rowWidget], rowWidget) : rowWidget;\n                }\n                if (!isNullOrUndefined(splittedRow)) {\n                    if (i === 0 && splittedRow === rowWidget) {\n                        //Returns if the whole table does not fit in current page.\n                        return tableWidget;\n                    }\n                    if (tableWidget.childWidgets.indexOf(splittedRow) !== -1) {\n                        tableWidget.childWidgets.splice(tableWidget.childWidgets.indexOf(splittedRow), 1);\n                        i--;\n                        tableWidget.height -= splittedRow.height;\n                    }\n                    else {\n                        tableWidget.height -= rowHeight - rowWidget.height;\n                    }\n                    if (isNullOrUndefined(splittedWidget)) {\n                        //Creates new widget, to hold the splitted contents.\n                        splittedWidget = this.createTableWidget(tableWidget);\n                        this.updateWidgetLocation(tableWidget, splittedWidget);\n                        splittedWidget.height = splittedRow.height;\n                    }\n                    else {\n                        splittedWidget.height += splittedRow.height;\n                    }\n                    splittedWidget.childWidgets.push(splittedRow);\n                    splittedRow.containerWidget = splittedWidget;\n                }\n            }\n            rowBottom += rowWidget.height;\n        }\n        return splittedWidget;\n    };\n    /**\n     * Checks whether first line fits for paragraph or not.\n     * @param bottom\n     * @param paraWidget\n     */\n    Layout.prototype.isFirstLineFitForPara = function (bottom, paraWidget) {\n        var lineWidget = paraWidget.childWidgets[0];\n        var cellwidget = lineWidget.paragraph.containerWidget;\n        // let document: WordDocument = undefined;\n        // if (!isNullOrUndefined(lineWidget.paragraph.currentNode) && !isNullOrUndefined(cellwidget.containerWidget)) {\n        //     document = WordDocument.getDocumentOf(lineWidget.paragraph.currentNode);\n        // }\n        //checks first line of the page is exceed the page height\n        if (this.viewer.isFirstLineFitInShiftWidgets) {\n            if (this.viewer.clientActiveArea.y === this.viewer.clientArea.y && paraWidget.y + lineWidget.height >= bottom) {\n                return true;\n            }\n        }\n        else {\n            // For nested tables,\n            if (cellwidget.ownerTable.isInsideTable) {\n                // Gets the container cell widgets, consider it as client area for the cell widget.\n                var containerCellWidget = undefined;\n                if (cellwidget.containerWidget instanceof TableRowWidget &&\n                    cellwidget.containerWidget.containerWidget instanceof TableWidget\n                    && cellwidget.containerWidget.containerWidget.containerWidget instanceof TableCellWidget) {\n                    containerCellWidget = cellwidget.containerWidget.containerWidget.containerWidget;\n                }\n                if (!isNullOrUndefined(containerCellWidget) && cellwidget.containerWidget.y === containerCellWidget.y\n                    && paraWidget.y + lineWidget.height >= bottom) {\n                    return true;\n                }\n            }\n            else if (cellwidget.containerWidget.y === this.viewer.clientArea.y && paraWidget.y + lineWidget.height >= bottom) {\n                return true;\n            }\n        }\n        return (paraWidget.y + lineWidget.height <= bottom);\n    };\n    /**\n     * Checks whether first line fits for table or not.\n     * @param bottom\n     * @param tableWidget\n     * @private\n     */\n    Layout.prototype.isFirstLineFitForTable = function (bottom, tableWidget) {\n        var rowWidget = undefined;\n        var isFit = false;\n        var childWidget = tableWidget.childWidgets[0];\n        // if (childWidget instanceof TableRowWidget) {\n        rowWidget = childWidget;\n        // }\n        if (!isNullOrUndefined(rowWidget)) {\n            isFit = this.isFirstLineFitForRow(bottom, rowWidget);\n        }\n        return isFit;\n    };\n    /**\n     * Checks whether first line fits for row or not.\n     * @param bottom\n     * @param rowWidget\n     */\n    Layout.prototype.isFirstLineFitForRow = function (bottom, rowWidget) {\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellWidget = rowWidget.childWidgets[i];\n            if (!this.isFirstLineFitForCell(bottom, cellWidget)) {\n                return false;\n            }\n        }\n        return true;\n    };\n    /**\n     * Checks whether first line fits for cell or not.\n     * @param bottom\n     * @param cellWidget\n     */\n    Layout.prototype.isFirstLineFitForCell = function (bottom, cellWidget) {\n        if (cellWidget.childWidgets.length === 0) {\n            return true;\n        }\n        if (cellWidget.childWidgets[0] instanceof ParagraphWidget) {\n            var paraWidget = cellWidget.childWidgets[0];\n            return this.isFirstLineFitForPara(bottom - cellWidget.margin.bottom, paraWidget);\n        }\n        else {\n            var tableWidget = cellWidget.childWidgets[0];\n            return this.isFirstLineFitForTable(bottom - cellWidget.margin.bottom, tableWidget);\n        }\n    };\n    /**\n     * Updates widget location.\n     * @param widget\n     * @param table\n     */\n    Layout.prototype.updateWidgetLocation = function (widget, table) {\n        table.x = widget.x;\n        table.y = widget.y;\n        table.width = widget.width;\n    };\n    /**\n     * Updates child location for table.\n     * @param top\n     * @param tableWidget\n     * @private\n     */\n    Layout.prototype.updateChildLocationForTable = function (top, tableWidget) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            rowWidget.x = rowWidget.x;\n            rowWidget.y = top;\n            this.updateChildLocationForRow(top, rowWidget);\n            top += rowWidget.height;\n        }\n    };\n    /**\n     * Updates child location for row.\n     * @param top\n     * @param rowWidget\n     * @private\n     */\n    Layout.prototype.updateChildLocationForRow = function (top, rowWidget) {\n        var spacing = 0;\n        if (rowWidget.ownerTable.tableFormat.cellSpacing > 0) {\n            spacing = HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableFormat.cellSpacing);\n        }\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellWidget = rowWidget.childWidgets[i];\n            cellWidget.x = cellWidget.x;\n            cellWidget.y = top + cellWidget.margin.top + spacing;\n            this.updateChildLocationForCell(cellWidget.y, cellWidget);\n        }\n    };\n    /**\n     * Updates child location for cell.\n     * @param top\n     * @param cellWidget\n     */\n    Layout.prototype.updateChildLocationForCell = function (top, cellWidget) {\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            cellWidget.childWidgets[i].x = cellWidget.childWidgets[i].x;\n            cellWidget.childWidgets[i].y = top;\n            if (cellWidget.childWidgets[i] instanceof TableWidget) {\n                this.updateChildLocationForTable(top, cellWidget.childWidgets[i]);\n            }\n            top += cellWidget.childWidgets[i].height;\n        }\n    };\n    /**\n     * Updates cell vertical position.\n     * @param cellWidget\n     * @param isUpdateToTop\n     * @param isInsideTable\n     * @private\n     */\n    Layout.prototype.updateCellVerticalPosition = function (cellWidget, isUpdateToTop, isInsideTable) {\n        if (cellWidget.ownerTable.containerWidget instanceof BodyWidget || isInsideTable) {\n            var displacement = this.getDisplacement(cellWidget, isUpdateToTop);\n            //Update Y position alone for the child widget of cell\n            this.updateCellContentVerticalPosition(cellWidget, displacement, isUpdateToTop);\n        }\n    };\n    /**\n     * Updates cell content vertical position.\n     * @param cellWidget\n     * @param displacement\n     * @param isUpdateToTop\n     */\n    Layout.prototype.updateCellContentVerticalPosition = function (cellWidget, displacement, isUpdateToTop) {\n        if (displacement === 0) {\n            return;\n        }\n        var location = cellWidget.y + displacement;\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                cellWidget.childWidgets[i].y = location;\n            }\n            else {\n                location = this.updateTableWidgetLocation(cellWidget.childWidgets[i], location, isUpdateToTop);\n            }\n            location = location + cellWidget.childWidgets[i].height;\n        }\n    };\n    /**\n     * Updates table widget location.\n     * @param tableWidget\n     * @param location\n     * @param isUpdateToTop\n     */\n    Layout.prototype.updateTableWidgetLocation = function (tableWidget, location, isUpdateToTop) {\n        tableWidget.y = location = location + tableWidget.topBorderWidth;\n        var cellSpacing = 0;\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            rowWidget.y = location;\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                var cellWidget = rowWidget.childWidgets[j];\n                cellWidget.y = location + cellWidget.margin.top + cellSpacing;\n                this.updateCellVerticalPosition(cellWidget, isUpdateToTop, true);\n            }\n            location = location + rowWidget.height;\n        }\n        return location;\n    };\n    /**\n     * Gets displacement.\n     * @param cellWidget\n     * @param isUpdateToTop\n     */\n    Layout.prototype.getDisplacement = function (cellWidget, isUpdateToTop) {\n        //Gets the height of row\n        var rowHeight = 0;\n        var rowWidget = cellWidget.containerWidget;\n        var padding = cellWidget.margin.top + cellWidget.margin.bottom;\n        if (!isNullOrUndefined(cellWidget.cellFormat) && cellWidget.cellFormat.rowSpan > 1) {\n            rowHeight = cellWidget.height;\n        }\n        else {\n            rowHeight = ((!isNullOrUndefined(rowWidget) ? rowWidget.height : 0) - padding);\n        }\n        //Gets the height of content within the cell\n        var cellContentHeight = this.getCellContentHeight(cellWidget);\n        //Displacement field holds the value which has reduced from rowHeight and cellContentHeight\n        var displacement = 0;\n        if (rowHeight > cellContentHeight) {\n            displacement = rowHeight - cellContentHeight;\n            if (cellWidget.cellFormat.verticalAlignment === 'Center') {\n                displacement = displacement / 2;\n            }\n            else if ((cellWidget.cellFormat.verticalAlignment === 'Top' || isUpdateToTop)) {\n                displacement = 0;\n            }\n        }\n        return displacement;\n    };\n    /**\n     * Gets cell content height.\n     * @param cellWidget\n     */\n    Layout.prototype.getCellContentHeight = function (cellWidget) {\n        if (isNullOrUndefined(cellWidget.childWidgets)) {\n            return 0;\n        }\n        var contentHeight = 0;\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                contentHeight += cellWidget.childWidgets[i].height;\n            }\n            else {\n                contentHeight += cellWidget.childWidgets[i].height;\n            }\n        }\n        return contentHeight;\n    };\n    /**\n     * Gets table left borders.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableLeftBorder = function (borders) {\n        if (!isNullOrUndefined(borders.left)) {\n            return borders.left;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Gets table right border.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableRightBorder = function (borders) {\n        if (!isNullOrUndefined(borders.right)) {\n            return borders.right;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Get table top border.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableTopBorder = function (borders) {\n        if (!isNullOrUndefined(borders.top)) {\n            return borders.top;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Gets table bottom border.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableBottomBorder = function (borders) {\n        if (!isNullOrUndefined(borders.bottom)) {\n            return borders.bottom;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Get diagonal cell up border.\n     * @param tableCell\n     * @private\n     */\n    Layout.prototype.getCellDiagonalUpBorder = function (tableCell) {\n        var diagonalUpBorder = undefined;\n        var cellBorder = undefined;\n        cellBorder = tableCell.cellFormat.borders;\n        diagonalUpBorder = cellBorder.diagonalUp;\n        return diagonalUpBorder;\n    };\n    /**\n     * Gets diagonal cell down border\n     * @param tableCell\n     * @private\n     */\n    Layout.prototype.getCellDiagonalDownBorder = function (tableCell) {\n        var diagonalDownBorder = undefined;\n        var cellBorder = undefined;\n        cellBorder = tableCell.cellFormat.borders;\n        diagonalDownBorder = cellBorder.diagonalDown;\n        return diagonalDownBorder;\n    };\n    /**\n     * Gets table width.\n     * @param table\n     * @private\n     */\n    Layout.prototype.getTableWidth = function (table) {\n        var width = 0;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowWidth = 0;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                rowWidth += HelperMethods.convertPointToPixel(cell.cellFormat.cellWidth);\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    //#region shifting\n    /**\n     * @private\n     */\n    Layout.prototype.layoutNextItemsBlock = function (blockAdv, viewer) {\n        var sectionIndex = blockAdv.bodyWidget.sectionIndex;\n        var block = blockAdv;\n        var splittedWidget = block.getSplitWidgets();\n        var nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        if (isNullOrUndefined(nextBlock) || this.viewer.blockToShift === block) {\n            this.viewer.blockToShift = undefined;\n        }\n        var updateNextBlockList = true;\n        while (nextBlock instanceof BlockWidget && nextBlock.bodyWidget.sectionIndex === sectionIndex) {\n            var currentWidget = undefined;\n            var blocks = block.getSplitWidgets();\n            currentWidget = blocks[blocks.length - 1];\n            // if (viewer.fieldEndParagraph === block) {\n            //     //Sets field end paragraph to undefined, inorder to hold reLayouting with this paragraph.\n            //     viewer.fieldEndParagraph = undefined;\n            // }\n            block = nextBlock;\n            if (viewer.blockToShift === block) {\n                viewer.blockToShift = undefined;\n            }\n            updateNextBlockList = false;\n            var nextWidget = undefined;\n            nextWidget = block.getSplitWidgets()[0];\n            // tslint:disable-next-line:max-line-length\n            if (viewer.fieldStacks.length === 0 && !isNullOrUndefined(nextWidget) && currentWidget.containerWidget === nextWidget.containerWidget\n                && (HelperMethods.round(nextWidget.y, 2) === HelperMethods.round(currentWidget.y + currentWidget.height, 2))) {\n                if (!isNullOrUndefined(viewer.blockToShift)) {\n                    viewer.blockToShift = block;\n                }\n                break;\n            }\n            updateNextBlockList = true;\n            if (viewer.owner.isShiftingEnabled && viewer.fieldStacks.length === 0) {\n                viewer.blockToShift = block;\n                break;\n            }\n            else if (isNullOrUndefined(this.viewer.owner.editorModule) || !this.viewer.owner.editorModule.isInsertingTOC) {\n                block = block.combineWidget(this.viewer);\n                var paragraph = void 0;\n                if (currentWidget.containerWidget !== block.containerWidget) {\n                    if (!(currentWidget instanceof ParagraphWidget) ||\n                        (currentWidget instanceof ParagraphWidget) && !currentWidget.isEndsWithPageBreak) {\n                        // tslint:disable-next-line:max-line-length\n                        this.updateContainerWidget(block, currentWidget.containerWidget, currentWidget.indexInOwner + 1, false);\n                    }\n                }\n                if (block instanceof TableWidget) {\n                    this.clearTableWidget(block, true, true);\n                    block.isGridUpdated = false;\n                    paragraph = this.viewer.selection.getFirstParagraphInFirstCell(block);\n                }\n                else {\n                    paragraph = block;\n                }\n                if ((this.viewer.owner.isDocumentLoaded) && this.viewer.owner.editorModule) {\n                    this.viewer.owner.editorModule.updateWholeListItems(paragraph);\n                }\n                viewer.updateClientAreaForBlock(block, true);\n                this.viewer.layout.layoutBlock(block, 0);\n                viewer.updateClientAreaForBlock(block, false);\n            }\n            splittedWidget = nextBlock.getSplitWidgets();\n            nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        }\n        if (!viewer.owner.isShiftingEnabled || this.viewer.blockToShift !== block) {\n            this.viewer.owner.editorModule.updateListItemsTillEnd(block, updateNextBlockList);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateClientAreaForLine = function (paragraph, startLineWidget, elementIndex) {\n        //Clears the line widget starting from current line.\n        var top = this.viewer.selection.getTop(startLineWidget);\n        var left = this.viewer.clientArea.x;\n        this.viewer.cutFromTop(top);\n        this.viewer.cutFromLeft(left);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.getParentTable = function (block) {\n        var widget = block;\n        while (widget.containerWidget) {\n            if (widget.containerWidget instanceof BlockContainer) {\n                return widget;\n            }\n            widget = widget.containerWidget;\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.reLayoutParagraph = function (paragraphWidget, lineIndex, elementBoxIndex, isBidi) {\n        isBidi = isNullOrUndefined(isBidi) ? false : isBidi;\n        if (this.viewer.blockToShift === paragraphWidget) {\n            this.layoutBodyWidgetCollection(paragraphWidget.index, paragraphWidget.containerWidget, paragraphWidget, false);\n        }\n        // let isElementMoved: boolean = elementBoxIndex > 0;\n        if (paragraphWidget.isInsideTable) {\n            this.isBidiReLayout = true;\n            this.reLayoutTable(paragraphWidget);\n            this.isBidiReLayout = false;\n        }\n        else {\n            this.reLayoutLine(paragraphWidget, lineIndex, isBidi);\n        }\n        if (paragraphWidget.bodyWidget instanceof HeaderFooterWidget &&\n            paragraphWidget.bodyWidget.headerFooterType.indexOf('Footer') !== -1) {\n            this.shiftFooterChildLocation(paragraphWidget.bodyWidget, this.viewer);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.reLayoutTable = function (block) {\n        //Get Top level owner of block\n        var table = this.getParentTable(block);\n        //Combine splitted table in to single table\n        var currentTable = table.combineWidget(this.viewer);\n        var bodyWidget = currentTable.containerWidget;\n        if (this.viewer.owner.enableHeaderAndFooter || block.isInHeaderFooter) {\n            block.bodyWidget.isEmpty = false;\n            bodyWidget.height -= currentTable.height;\n            // tslint:disable-next-line:max-line-length\n            this.viewer.updateHCFClientAreaWithTop(table.bodyWidget.sectionFormat, this.viewer.isBlockInHeader(table), bodyWidget.page);\n        }\n        else {\n            this.viewer.updateClientArea(bodyWidget.sectionFormat, bodyWidget.page);\n        }\n        //Clear Hieght for all the content \n        if (this.viewer.owner.isDocumentLoaded && this.viewer.owner.editorModule) {\n            var block_1 = this.viewer.selection.getFirstParagraphInFirstCell(currentTable);\n            this.viewer.owner.editorModule.updateWholeListItems(block_1);\n        }\n        this.viewer.updateClientAreaForBlock(currentTable, true);\n        //Remove border width\n        currentTable.x -= currentTable.leftBorderWidth;\n        currentTable.y -= currentTable.topBorderWidth;\n        //Update Client area for current position\n        this.viewer.cutFromTop(currentTable.y);\n        this.clearTableWidget(currentTable, true, true, true);\n        this.layoutBlock(currentTable, 0, true);\n        this.viewer.updateClientAreaForBlock(currentTable, false);\n        this.layoutNextItemsBlock(currentTable, this.viewer);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearTableWidget = function (table, clearPosition, clearHeight, clearGrid) {\n        table.height = 0;\n        if (clearGrid) {\n            table.isGridUpdated = false;\n        }\n        if (clearPosition) {\n            table.y = 0;\n            table.x = 0;\n        }\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            this.clearRowWidget(row, clearPosition, clearHeight, clearGrid);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearRowWidget = function (row, clearPosition, clearHeight, clearGrid) {\n        row.height = 0;\n        if (clearPosition) {\n            row.y = 0;\n            row.x = 0;\n        }\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            this.clearCellWidget(cell, clearPosition, clearHeight, clearGrid);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearCellWidget = function (cell, clearPosition, clearHeight, clearGrid) {\n        cell.height = 0;\n        if (clearPosition) {\n            cell.y = 0;\n            cell.x = 0;\n        }\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            if (block instanceof ParagraphWidget) {\n                if (clearHeight) {\n                    block.height = 0;\n                }\n            }\n            else {\n                this.clearTableWidget(block, clearPosition, clearHeight, clearGrid);\n            }\n        }\n    };\n    /**\n     * @param blockIndex\n     * @param bodyWidget\n     * @param block\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.layoutBodyWidgetCollection = function (blockIndex, bodyWidget, block, shiftNextWidget) {\n        if (!isNullOrUndefined(this.viewer.owner)\n            && this.viewer.owner.isLayoutEnabled) {\n            if (bodyWidget instanceof BlockContainer) {\n                var curretBlock = this.checkAndGetBlock(bodyWidget, blockIndex);\n                if (isNullOrUndefined(curretBlock)) {\n                    return;\n                }\n                if (bodyWidget instanceof HeaderFooterWidget) {\n                    bodyWidget.isEmpty = false;\n                    // tslint:disable-next-line:max-line-length\n                    this.viewer.updateHCFClientAreaWithTop(bodyWidget.sectionFormat, bodyWidget.headerFooterType.indexOf('Header') !== -1, bodyWidget.page);\n                    curretBlock.containerWidget.height -= curretBlock.height;\n                }\n                else {\n                    this.viewer.updateClientArea(bodyWidget.sectionFormat, bodyWidget.page);\n                }\n                if (blockIndex > 0) {\n                    var prevWidget = curretBlock.getSplitWidgets()[0].previousRenderedWidget;\n                    if (!(prevWidget instanceof ParagraphWidget) ||\n                        (prevWidget instanceof ParagraphWidget) && !prevWidget.isEndsWithPageBreak) {\n                        this.viewer.cutFromTop(prevWidget.y + prevWidget.height);\n                        if (curretBlock.containerWidget !== prevWidget.containerWidget) {\n                            // tslint:disable-next-line:max-line-length\n                            this.updateContainerWidget(curretBlock, prevWidget.containerWidget, prevWidget.indexInOwner + 1, false);\n                        }\n                    }\n                    else if (prevWidget instanceof ParagraphWidget && prevWidget.isEndsWithPageBreak &&\n                        prevWidget.containerWidget === curretBlock.containerWidget) {\n                        this.moveBlocksToNextPage(prevWidget);\n                    }\n                }\n                var currentParagraph = void 0;\n                curretBlock = curretBlock.combineWidget(this.viewer);\n                if (curretBlock instanceof TableWidget) {\n                    this.clearTableWidget(curretBlock, true, true);\n                    curretBlock.isGridUpdated = false;\n                    currentParagraph = this.viewer.selection.getFirstParagraphInFirstCell(curretBlock);\n                }\n                else {\n                    currentParagraph = curretBlock;\n                }\n                if ((this.viewer.owner.isDocumentLoaded) && this.viewer.owner.editorModule) {\n                    this.viewer.owner.editorModule.updateWholeListItems(currentParagraph);\n                }\n                this.viewer.updateClientAreaForBlock(curretBlock, true);\n                this.viewer.layout.layoutBlock(curretBlock, 0, true);\n                this.viewer.updateClientAreaForBlock(curretBlock, false);\n                if (shiftNextWidget) {\n                    this.shiftNextWidgets(curretBlock);\n                }\n                else {\n                    this.layoutNextItemsBlock(curretBlock, this.viewer);\n                }\n            }\n            else if (bodyWidget instanceof TableCellWidget) {\n                var table = this.viewer.layout.getParentTable(bodyWidget.ownerTable.getSplitWidgets()[0]);\n                this.reLayoutTable(bodyWidget.ownerTable);\n                this.layoutNextItemsBlock(table, this.viewer);\n            }\n        }\n    };\n    Layout.prototype.checkAndGetBlock = function (containerWidget, blockIndex) {\n        var sectionIndex = containerWidget.index;\n        while (containerWidget && containerWidget.index === sectionIndex) {\n            if (containerWidget.childWidgets.length > 0 && containerWidget.firstChild.index <= blockIndex &&\n                containerWidget.lastChild.index >= blockIndex) {\n                for (var i = 0; i < containerWidget.childWidgets.length; i++) {\n                    var block = containerWidget.childWidgets[i];\n                    if (block.index === blockIndex) {\n                        return block;\n                    }\n                }\n            }\n            if (containerWidget instanceof BodyWidget) {\n                containerWidget = containerWidget.nextRenderedWidget;\n            }\n            else {\n                break;\n            }\n        }\n        return undefined;\n    };\n    //#endregion\n    //#region Table\n    /**\n     * Layouts table.\n     * @param table\n     * @private\n     */\n    Layout.prototype.layoutTable = function (table, startIndex) {\n        table.isBidiTable = table.bidi;\n        if (!table.isGridUpdated) {\n            table.buildTableColumns();\n            table.isGridUpdated = true;\n        }\n        var tableView = [table];\n        this.addTableWidget(this.viewer.clientActiveArea, tableView);\n        this.viewer.updateClientAreaTopOrLeft(table, true);\n        var isHeader = table.childWidgets[0].rowFormat.isHeader;\n        if (table.childWidgets.length > 0) {\n            table.header = isHeader;\n            table.continueHeader = isHeader;\n            table.headerHeight = 0;\n        }\n        var row = table.childWidgets[startIndex];\n        while (row) {\n            row = this.layoutRow(tableView, row);\n            row = row.nextRow;\n        }\n        this.updateWidgetsToPage(tableView, [], table);\n        return tableView[tableView.length - 1];\n    };\n    /**\n     * Adds table widget.\n     * @param area\n     * @param table\n     * @private\n     */\n    Layout.prototype.addTableWidget = function (area, table, create) {\n        var tableWidget = table[table.length - 1];\n        if (create) {\n            tableWidget = this.createTableWidget(tableWidget);\n            table.push(tableWidget);\n        }\n        tableWidget.width = area.width;\n        tableWidget.x = area.x;\n        tableWidget.y = area.y;\n        //Update the table height of tableWidget when cell spacing has been defined. \n        if (tableWidget.tableFormat.cellSpacing > 0) {\n            tableWidget.height = tableWidget.height + HelperMethods.convertPointToPixel(tableWidget.tableFormat.cellSpacing);\n            if (!tableWidget.isBidiTable) {\n                // tslint:disable-next-line:max-line-length\n                tableWidget.leftBorderWidth = HelperMethods.convertPointToPixel(this.getTableLeftBorder(tableWidget.tableFormat.borders).getLineWidth());\n                tableWidget.rightBorderWidth = HelperMethods.convertPointToPixel(this.getTableRightBorder(tableWidget.tableFormat.borders).getLineWidth());\n            }\n            else { // Right to left direction table.\n                // tslint:disable-next-line:max-line-length\n                tableWidget.leftBorderWidth = HelperMethods.convertPointToPixel(this.getTableRightBorder(tableWidget.tableFormat.borders).getLineWidth());\n                tableWidget.rightBorderWidth = HelperMethods.convertPointToPixel(this.getTableLeftBorder(tableWidget.tableFormat.borders).getLineWidth());\n            }\n            // tslint:disable-next-line:max-line-length\n            tableWidget.topBorderWidth = HelperMethods.convertPointToPixel(this.getTableTopBorder(tableWidget.tableFormat.borders).getLineWidth());\n            tableWidget.bottomBorderWidth = HelperMethods.convertPointToPixel(this.getTableBottomBorder(tableWidget.tableFormat.borders).getLineWidth());\n            tableWidget.x += tableWidget.leftBorderWidth;\n            tableWidget.y += tableWidget.topBorderWidth;\n            tableWidget.width -= tableWidget.leftBorderWidth;\n            tableWidget.width -= tableWidget.rightBorderWidth;\n            tableWidget.height += tableWidget.bottomBorderWidth;\n        }\n        return tableWidget;\n    };\n    /**\n     * Updates widget to page.\n     * @param table\n     * @private\n     */\n    Layout.prototype.updateWidgetsToPage = function (tables, rows, table, endRowWidget) {\n        var viewer = this.viewer;\n        var tableWidget = tables[tables.length - 1];\n        if (!table.isInsideTable) {\n            this.updateHeightForTableWidget(tables, rows, tableWidget, endRowWidget);\n            if (tableWidget.childWidgets.length > 0 && tableWidget.y !== tableWidget.childWidgets[0].y) {\n                tableWidget.y = tableWidget.childWidgets[0].y;\n            }\n            // Need to update on this further\n            //Adds the table widget to owner cell widget.\n            // tslint:disable-next-line:max-line-length\n            // (viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as TableCellWidget).childWidgets.push(tableWidget);\n            // tableWidget.containerWidget = viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as BodyWidget;\n            // tslint:disable-next-line:max-line-length\n            // (viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as TableCellWidget).height = (viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as TableCellWidget).height + tableWidget.height;\n        }\n        if (table.tableFormat.cellSpacing > 0) {\n            // tslint:disable-next-line:max-line-length\n            if (tableWidget.y + tableWidget.height + HelperMethods.convertPointToPixel(table.tableFormat.cellSpacing) > viewer.clientArea.bottom && viewer instanceof PageLayoutViewer) {\n                //update the table height when split to next page. Which is equivalent Ms Word Behaviour. \n                //In Ms Word if the Table Split to next page the bottom spacing of the table will be half of the current spacing.\n                //And the Remaining space will be used in next page top of the table.\n                tableWidget.height = tableWidget.height - HelperMethods.convertPointToPixel(table.tableFormat.cellSpacing) / 2;\n            }\n            //Update the current Y position of current clientactivearea.\n            viewer.cutFromTop(tableWidget.y + tableWidget.height);\n        }\n        if (table.bodyWidget instanceof HeaderFooterWidget) {\n            table.containerWidget.height += table.height;\n            if (this.viewer.owner.enableHeaderAndFooter && table.bodyWidget.headerFooterType.indexOf('Footer') !== -1) {\n                this.shiftFooterChildLocation(table.bodyWidget, this.viewer);\n            }\n        }\n    };\n    /**\n     * Updates height for table widget.\n     * @param viewer\n     * @param tableWidget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.updateHeightForTableWidget = function (tables, rows, tableWidget, endRowWidget) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            if (rowWidget === endRowWidget) {\n                break;\n            }\n            this.updateHeightForRowWidget(this.viewer, true, tables, rows, rowWidget, true, endRowWidget);\n        }\n    };\n    //#endregion\n    //#region Row\n    /**\n     * Layouts table row.\n     * @param row\n     * @private\n     */\n    Layout.prototype.layoutRow = function (tableWidget, row) {\n        var viewer = this.viewer;\n        var rowWidgets = [row];\n        var widget = this.addTableRowWidget(viewer.clientActiveArea, rowWidgets);\n        viewer.updateClientAreaForRow(row, true);\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            this.layoutCell(cell, this.getMaxTopOrBottomCellMargin(row, 0) + row.topBorderWidth, this.getMaxTopOrBottomCellMargin(row, 1) + row.bottomBorderWidth, widget);\n        }\n        viewer.updateClientAreaForRow(row, false);\n        var rows = [row];\n        this.updateWidgetsToTable(tableWidget, rows, row);\n        return rows[rows.length - 1];\n    };\n    /**\n     * @param area\n     * @param row\n     */\n    Layout.prototype.addTableRowWidget = function (area, row) {\n        var rowWidget = row[row.length - 1];\n        rowWidget.x = area.x + rowWidget.rowFormat.gridBeforeWidth;\n        rowWidget.y = area.y;\n        rowWidget.width = area.width;\n        var borderWidth = 0;\n        if (!isNullOrUndefined(rowWidget.ownerTable) && !isNullOrUndefined(rowWidget.ownerTable.tableFormat)\n            && rowWidget.ownerTable.tableFormat.cellSpacing > 0) {\n            rowWidget.height = rowWidget.height + HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableFormat.cellSpacing);\n            //Update the table height with the border width to layout the border when the cell spacing is defined..\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                if (!isNullOrUndefined(rowWidget.childWidgets[j].cellFormat)\n                    && !isNullOrUndefined(rowWidget.childWidgets[j].cellFormat.borders)) {\n                    // tslint:disable-next-line:max-line-length\n                    var width = TableCellWidget.getCellBottomBorder(rowWidget.childWidgets[j]).getLineWidth();\n                    if (width > borderWidth) {\n                        borderWidth = width;\n                    }\n                }\n            }\n            //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n            rowWidget.bottomBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n            if (rowWidget.index > 0 && !isNullOrUndefined(rowWidget.previousWidget)) {\n                var prevRow = rowWidget.previousWidget;\n                borderWidth = 0;\n                for (var i = 0; i < prevRow.childWidgets.length; i++) {\n                    // tslint:disable-next-line:max-line-length\n                    if (!isNullOrUndefined(prevRow.childWidgets[i].cellFormat) && !isNullOrUndefined(prevRow.childWidgets[i].cellFormat.borders)) {\n                        var value = TableCellWidget.getCellBottomBorder(prevRow.childWidgets[i]).getLineWidth();\n                        if (value > borderWidth) {\n                            borderWidth = value;\n                        }\n                    }\n                }\n                //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n                rowWidget.topBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n            }\n        }\n        if (!isNullOrUndefined(rowWidget.childWidgets)) {\n            for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n                // tslint:disable-next-line:max-line-length\n                if (!isNullOrUndefined(rowWidget.childWidgets[i].cellFormat) && !isNullOrUndefined(rowWidget.childWidgets[i].cellFormat.borders)) {\n                    var value = TableCellWidget.getCellTopBorder(rowWidget.childWidgets[i]).getLineWidth();\n                    if (value > borderWidth) {\n                        borderWidth = value;\n                    }\n                }\n            }\n        }\n        //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n        rowWidget.topBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n        //Update the table height of tableWidget when cell spacing has been defined. \n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(rowWidget.ownerTable) && !isNullOrUndefined(rowWidget.ownerTable.tableFormat) && rowWidget.ownerTable.tableFormat.cellSpacing <= 0 && rowWidget.rowIndex === rowWidget.ownerTable.childWidgets.length - 1) {\n            // Update the bottom width for last row .\n            for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n                // tslint:disable-next-line:max-line-length\n                if (!isNullOrUndefined(rowWidget.childWidgets[i].cellFormat) && !isNullOrUndefined(rowWidget.childWidgets[i].cellFormat.borders)) {\n                    var value = TableCellWidget.getCellBottomBorder(rowWidget.childWidgets[i]).getLineWidth();\n                    if (value > borderWidth) {\n                        borderWidth = value;\n                    }\n                }\n            }\n            //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n            rowWidget.bottomBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n        }\n        //tableRowWidget.ownerWidget = owner;\n        return rowWidget;\n    };\n    /**\n     * Gets maximum top or bottom cell margin.\n     * @param row\n     * @param topOrBottom\n     */\n    Layout.prototype.getMaxTopOrBottomCellMargin = function (row, topOrBottom) {\n        if (isNullOrUndefined(row.childWidgets)) {\n            return 0;\n        }\n        var value = 0;\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            if (row.childWidgets.length > 0) {\n                var cell = row.childWidgets[i];\n                var cellFormat = cell.cellFormat;\n                if (cellFormat.containsMargins()) {\n                    var leftMargin = HelperMethods.convertPointToPixel(cellFormat.topMargin);\n                    var bottomMargin = void 0;\n                    if (topOrBottom === 0 && !isNullOrUndefined(cellFormat.topMargin) && leftMargin > value) {\n                        value = leftMargin;\n                    }\n                    else if (topOrBottom === 1 && !isNullOrUndefined(cellFormat.bottomMargin) &&\n                        // tslint:disable-next-line:no-conditional-assignment \n                        (bottomMargin = HelperMethods.convertPointToPixel(cellFormat.bottomMargin)) > value) {\n                        value = bottomMargin;\n                    }\n                }\n                else {\n                    var tableFormat = cell.ownerTable.tableFormat;\n                    var topMargin = HelperMethods.convertPointToPixel(tableFormat.topMargin);\n                    var bottomMargin = void 0;\n                    if (topOrBottom === 0 && topMargin > value) {\n                        value = topMargin;\n                        // tslint:disable-next-line:no-conditional-assignment \n                    }\n                    else if (topOrBottom === 1 && (bottomMargin = HelperMethods.convertPointToPixel(tableFormat.bottomMargin)) > value) {\n                        value = bottomMargin;\n                    }\n                }\n            }\n        }\n        return value;\n    };\n    //#endregion Row\n    //#region cell\n    /**\n     * Layouts cell\n     * @param cell\n     * @param maxCellMarginTop\n     * @param maxCellMarginBottom\n     */\n    Layout.prototype.layoutCell = function (cell, maxCellMarginTop, maxCellMarginBottom, owner) {\n        var viewer = this.viewer;\n        this.addTableCellWidget(cell, viewer.clientActiveArea, maxCellMarginTop, maxCellMarginBottom);\n        viewer.updateClientAreaForCell(cell, true);\n        if (cell.childWidgets.length === 0) {\n            var paragraphWidget = new ParagraphWidget();\n            paragraphWidget.characterFormat = new WCharacterFormat();\n            paragraphWidget.paragraphFormat = new WParagraphFormat();\n            paragraphWidget.index = 0;\n            var lineWidget = new LineWidget(undefined);\n            paragraphWidget.childWidgets.push(lineWidget);\n            cell.childWidgets.push(paragraphWidget);\n        }\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            viewer.updateClientAreaForBlock(block, true);\n            block.containerWidget = cell;\n            this.layoutBlock(block, 0);\n            viewer.updateClientAreaForBlock(block, false);\n        }\n        this.updateWidgetToRow(cell);\n        viewer.updateClientAreaForCell(cell, false);\n    };\n    //endregion cell\n    //#region Shifting\n    /**\n     * @private\n     */\n    Layout.prototype.shiftLayoutedItems = function () {\n        if (isNullOrUndefined(this.viewer.blockToShift) || isNullOrUndefined(this.viewer.blockToShift.containerWidget)) {\n            this.viewer.blockToShift = undefined;\n            return;\n        }\n        var block = this.viewer.blockToShift;\n        var sectionIndex = block.bodyWidget.index;\n        this.reLayoutOrShiftWidgets(block, this.viewer);\n        var updateNextBlockList = true;\n        // If flow layout, then all sections are in single page. Hence need to update till last block of last section.\n        // Todo: For page layout and section break continuous, need to handle the same.\n        var splittedWidget = block.getSplitWidgets();\n        var nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        while (nextBlock instanceof BlockWidget && nextBlock.bodyWidget.index === sectionIndex) {\n            var currentWidget = undefined;\n            var blocks = block.getSplitWidgets();\n            currentWidget = blocks[blocks.length - 1];\n            block = nextBlock;\n            updateNextBlockList = false;\n            var nextWidget = undefined;\n            blocks = block.getSplitWidgets();\n            if (block instanceof ParagraphWidget) {\n                nextWidget = blocks[0];\n            }\n            else {\n                if (block instanceof TableWidget) {\n                    nextWidget = blocks[0];\n                }\n            }\n            if (currentWidget.containerWidget === nextWidget.containerWidget\n                && (HelperMethods.round(nextWidget.y, 2) === HelperMethods.round(this.viewer.clientActiveArea.y, 2)) &&\n                isNullOrUndefined(nextWidget.nextWidget)) {\n                break;\n            }\n            updateNextBlockList = true;\n            this.reLayoutOrShiftWidgets(block, this.viewer);\n            splittedWidget = block.getSplitWidgets();\n            nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        }\n        if (this.viewer.owner.editorModule) {\n            this.viewer.owner.editorModule.updateListItemsTillEnd(block, updateNextBlockList);\n        }\n        this.viewer.blockToShift = undefined;\n        var viewer = this.viewer;\n        // if (viewer instanceof PageLayoutViewer) {\n        viewer.removeEmptyPages();\n        this.updateFieldElements();\n        viewer.updateScrollBars();\n        // }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateFieldElements = function () {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            var fieldBegin = this.viewer.fields[i];\n            if (!isNullOrUndefined(this.viewer.selection)) {\n                var fieldCode = this.viewer.selection.getFieldCode(fieldBegin);\n                if (!isNullOrUndefined(fieldCode) && fieldCode.toLowerCase().match('numpages')) {\n                    var textElement = fieldBegin.fieldSeparator.nextNode;\n                    if (!isNullOrUndefined(textElement)) {\n                        textElement.text = this.viewer.pages.length.toString();\n                        var paragraph = fieldBegin.line.paragraph;\n                        if (!isNullOrUndefined(paragraph.bodyWidget) && !isNullOrUndefined(paragraph.bodyWidget.page)) {\n                            var lineIndex = paragraph.childWidgets.indexOf(fieldBegin.line);\n                            var elementIndex = fieldBegin.line.children.indexOf(textElement);\n                            this.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Layout.prototype.reLayoutOrShiftWidgets = function (blockAdv, viewer) {\n        var reLayoutItems = false;\n        var block = blockAdv;\n        // if (block instanceof ParagraphWidget) {\n        //     reLayoutItems = viewer.renderedElements.get(block as ParagraphWidget).length === 0;\n        // } else {\n        //     reLayoutItems = viewer.renderedElements.get(block as TableWidget).length === 0;\n        // }\n        // if (reLayoutItems) {\n        //     //Handle layouting the block.\n        //     viewer.updateClientAreaForBlock(block, true);\n        //     this.layoutMod.layoutBlock(block);\n        //     viewer.updateClientAreaForBlock(block, false);\n        // } else {\n        //Handled to check client area and shift layouted widget.\n        this.shiftWidgetsBlock(block, viewer);\n        //Updates the list value of the rendered paragraph.\n        if (this.viewer.owner.editorModule) {\n            this.viewer.owner.editorModule.updateRenderedListItems(block);\n        }\n        // }\n    };\n    Layout.prototype.shiftWidgetsBlock = function (block, viewer) {\n        if (block instanceof ParagraphWidget) {\n            this.shiftWidgetsForPara(block, viewer);\n        }\n        else if (block instanceof TableWidget) {\n            this.shiftWidgetsForTable(block, viewer);\n        }\n    };\n    Layout.prototype.shiftWidgetsForPara = function (paragraph, viewer) {\n        var prevBodyObj = this.getBodyWidgetOfPreviousBlock(paragraph, 0);\n        var prevBodyWidget = prevBodyObj.bodyWidget;\n        var index = prevBodyObj.index;\n        var prevWidget = undefined;\n        for (var i = 0; i < paragraph.getSplitWidgets().length; i++) {\n            var widget = paragraph.getSplitWidgets()[i];\n            if (!isNullOrUndefined(prevWidget)) {\n                var isPageBreak = prevWidget.lastChild ? prevWidget.lastChild.isEndsWithPageBreak : false;\n                this.shiftToPreviousWidget(widget, viewer, prevWidget, isPageBreak);\n                if ((isNullOrUndefined(widget.childWidgets) || widget.childWidgets.length === 0) && !isPageBreak) {\n                    i--;\n                    continue;\n                }\n                prevWidget = undefined;\n                if (prevBodyWidget !== widget.containerWidget) {\n                    prevBodyWidget = widget.containerWidget;\n                    if (isPageBreak) {\n                        viewer.updateClientAreaByWidget(widget);\n                    }\n                }\n            }\n            if (this.isFitInClientArea(widget, viewer)) {\n                //Check whether this widget is moved to previous container widget.\n                prevWidget = widget;\n                widget.y = viewer.clientActiveArea.y;\n                viewer.cutFromTop(viewer.clientActiveArea.y + widget.height);\n                //Moves the paragraph widget to previous body widget.\n                if (!isNullOrUndefined(prevBodyWidget) && prevBodyWidget !== widget.containerWidget) {\n                    index++;\n                    if (!prevBodyWidget.lastChild.isEndsWithPageBreak) {\n                        this.updateContainerWidget(widget, prevBodyWidget, index, true);\n                    }\n                }\n                if (widget.isEndsWithPageBreak) {\n                    var nextBodyWidget = this.createOrGetNextBodyWidget(prevBodyWidget, this.viewer);\n                    nextBodyWidget = this.moveBlocksToNextPage(widget);\n                    viewer.updateClientArea(nextBodyWidget.sectionFormat, nextBodyWidget.page);\n                }\n            }\n            else {\n                var previousBlock = widget.previousRenderedWidget;\n                var isPageBreak = false;\n                if (previousBlock instanceof ParagraphWidget && previousBlock.isEndsWithPageBreak) {\n                    isPageBreak = true;\n                }\n                var isSplittedToNewPage = this.splitWidget(widget, viewer, prevBodyWidget, index + 1, isPageBreak);\n                prevWidget = undefined;\n                if (prevBodyWidget !== widget.containerWidget) {\n                    prevBodyWidget = widget.containerWidget;\n                    i--;\n                }\n                index = prevBodyWidget.childWidgets.indexOf(widget);\n                if (isSplittedToNewPage) {\n                    prevBodyWidget = paragraph.getSplitWidgets()[i + 1].containerWidget;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftTableWidget = function (table, viewer) {\n        var tables = [table];\n        this.addTableWidget(this.viewer.clientActiveArea, tables);\n        this.viewer.updateClientAreaTopOrLeft(table, true);\n        var row = table.childWidgets[0];\n        while (row) {\n            row = this.shiftRowWidget(tables, row);\n            row = row.nextRow;\n        }\n        this.updateWidgetsToPage(tables, [], table);\n        return tables[tables.length - 1];\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftRowWidget = function (tables, row) {\n        var viewer = this.viewer;\n        var rows = [row];\n        var widget = this.addTableRowWidget(viewer.clientActiveArea, rows);\n        viewer.updateClientAreaForRow(row, true);\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            this.shiftCellWidget(cell, this.getMaxTopOrBottomCellMargin(row, 0) + row.topBorderWidth, this.getMaxTopOrBottomCellMargin(row, 1) + row.bottomBorderWidth);\n        }\n        viewer.updateClientAreaForRow(row, false);\n        this.updateWidgetsToTable(tables, rows, row);\n        return rows[rows.length - 1];\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftCellWidget = function (cell, maxCellMarginTop, maxCellMarginBottom) {\n        var viewer = this.viewer;\n        this.addTableCellWidget(cell, viewer.clientActiveArea, maxCellMarginTop, maxCellMarginBottom);\n        viewer.updateClientAreaForCell(cell, true);\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            viewer.updateClientAreaForBlock(block, true);\n            if (block instanceof ParagraphWidget) {\n                this.shiftParagraphWidget(block);\n            }\n            else {\n                this.shiftTableWidget(block, viewer);\n            }\n            viewer.updateClientAreaForBlock(block, false);\n        }\n        this.updateWidgetToRow(cell);\n        viewer.updateClientAreaForCell(cell, false);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftParagraphWidget = function (paragraph) {\n        this.addParagraphWidget(this.viewer.clientActiveArea, paragraph);\n        this.viewer.cutFromTop(this.viewer.clientActiveArea.y + paragraph.height);\n        this.updateWidgetToPage(this.viewer, paragraph);\n    };\n    Layout.prototype.shiftWidgetsForTable = function (table, viewer) {\n        var prevObj = this.getBodyWidgetOfPreviousBlock(table, 0);\n        var prevBodyWidget = prevObj.bodyWidget;\n        var index = prevObj.index;\n        var isPageBreak = prevBodyWidget.lastChild.lastChild.isEndsWithPageBreak;\n        if (prevBodyWidget !== table.containerWidget) {\n            if (!isPageBreak) {\n                this.updateContainerWidget(table, prevBodyWidget, index + 1, true);\n            }\n            else {\n                viewer.updateClientArea(table.bodyWidget.sectionFormat, table.bodyWidget.page);\n            }\n        }\n        if (table.isInHeaderFooter) {\n            table.containerWidget.height -= table.height;\n        }\n        this.viewer.updateClientAreaForBlock(table, true);\n        this.updateVerticalPositionToTop(table, true);\n        var isPageLayout = viewer instanceof PageLayoutViewer;\n        var combinedTable = table.combineWidget(this.viewer);\n        this.viewer.layout.updateChildLocationForTable(combinedTable.y, combinedTable);\n        this.clearTableWidget(combinedTable, true, false);\n        this.shiftTableWidget(combinedTable, this.viewer);\n        this.updateVerticalPositionToTop(table, false);\n    };\n    Layout.prototype.updateVerticalPositionToTop = function (table, isUpdateTop) {\n        //Iterate the tableWidgets counts\n        for (var i = 0; i < table.getSplitWidgets().length; i++) {\n            var tablewidget = table.getSplitWidgets()[i];\n            //Iterate the tableWidget child items\n            for (var j = 0; j < tablewidget.childWidgets.length; j++) {\n                var rowWidget = tablewidget.childWidgets[j];\n                //Iterate the RowWidgets child items\n                for (var k = 0; k < rowWidget.childWidgets.length; k++) {\n                    var cellWidget = rowWidget.childWidgets[k];\n                    //Iterate the RowWidgets child items\n                    this.viewer.layout.updateCellVerticalPosition(cellWidget, isUpdateTop, false);\n                }\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitWidget = function (paragraphWidget, viewer, previousBodyWidget, index, isPageBreak) {\n        var firstLine = paragraphWidget.childWidgets[0];\n        var maxElementHeight = this.getMaxElementHeight(firstLine, viewer);\n        var paragraphView = paragraphWidget.getSplitWidgets();\n        var nextBodyWidget = paragraphWidget.containerWidget;\n        if (viewer.clientActiveArea.height >= maxElementHeight && !isPageBreak) {\n            var splittedWidget = undefined;\n            var widgetIndex = paragraphView.indexOf(paragraphWidget);\n            if (widgetIndex < (paragraphView.length - 1)) {\n                splittedWidget = paragraphView[widgetIndex + 1];\n                nextBodyWidget = splittedWidget.containerWidget;\n            }\n            else {\n                splittedWidget = new ParagraphWidget();\n                splittedWidget.index = paragraphWidget.index;\n                splittedWidget.characterFormat = paragraphWidget.characterFormat;\n                splittedWidget.paragraphFormat = paragraphWidget.paragraphFormat;\n                splittedWidget.width = paragraphWidget.width;\n                splittedWidget.x = paragraphWidget.x;\n                splittedWidget.y = paragraphWidget.y;\n                paragraphView.push(splittedWidget);\n            }\n            if (previousBodyWidget !== paragraphWidget.containerWidget) {\n                this.updateContainerWidget(paragraphWidget, previousBodyWidget, index, true);\n            }\n            for (var i = paragraphWidget.childWidgets.length - 1; i > 0; i--) {\n                if (this.isFitInClientArea(paragraphWidget, viewer)) {\n                    break;\n                }\n                else {\n                    var line = paragraphWidget.childWidgets[i];\n                    //Moves the line widget to next widget.\n                    this.updateParagraphWidgetInternal(line, splittedWidget, 0);\n                }\n            }\n            if (isNullOrUndefined(splittedWidget.containerWidget) && splittedWidget.childWidgets.length > 0) {\n                var y = viewer.clientActiveArea.y;\n                // tslint:disable-next-line:max-line-length\n                var clientArea = new Rect(viewer.clientArea.x, viewer.clientArea.y, viewer.clientArea.width, viewer.clientArea.height);\n                var activeArea = new Rect(viewer.clientActiveArea.x, viewer.clientActiveArea.y, viewer.clientActiveArea.width, viewer.clientActiveArea.height);\n                //Checks whether next node exists, else adds new page.\n                nextBodyWidget = this.moveBlocksToNextPage(paragraphWidget);\n                // nextBodyWidget = this.createOrGetNextBodyWidget(previousBodyWidget, viewer);\n                nextBodyWidget.childWidgets.splice(0, 0, splittedWidget);\n                nextBodyWidget.height += splittedWidget.height;\n                splittedWidget.containerWidget = nextBodyWidget;\n                if (nextBodyWidget.childWidgets.length === 1 && nextBodyWidget.firstChild instanceof ParagraphWidget &&\n                    nextBodyWidget.firstChild.equals(paragraphWidget)) {\n                    paragraphWidget.x = paragraphWidget.x;\n                    paragraphWidget.y = y;\n                    return true;\n                }\n                else {\n                    //Resetting Client area\n                    viewer.clientArea = clientArea;\n                    viewer.clientActiveArea = activeArea;\n                }\n            }\n        }\n        else {\n            nextBodyWidget = this.createOrGetNextBodyWidget(previousBodyWidget, this.viewer);\n            if (paragraphWidget.containerWidget !== nextBodyWidget) {\n                nextBodyWidget = this.moveBlocksToNextPage(paragraphWidget);\n                this.updateContainerWidget(paragraphWidget, nextBodyWidget, 0, true);\n            }\n        }\n        if (previousBodyWidget === paragraphWidget.containerWidget) {\n            paragraphWidget.y = viewer.clientActiveArea.y;\n            viewer.cutFromTop(viewer.clientActiveArea.y + paragraphWidget.height);\n        }\n        else {\n            //Updates client area based on next body widget.\n            viewer.updateClientArea(nextBodyWidget.sectionFormat, nextBodyWidget.page);\n        }\n        return false;\n    };\n    Layout.prototype.getMaxElementHeight = function (lineWidget, viewer) {\n        var height = 0;\n        // tslint:disable-next-line:max-line-length\n        if (lineWidget.children.length === 0 || ((lineWidget.children.length === 1 && lineWidget.children[0] instanceof ListTextElementBox) || (lineWidget.children.length === 2 && lineWidget.children[0] instanceof ListTextElementBox && lineWidget.children[1] instanceof ListTextElementBox))) {\n            var topMargin = 0;\n            var bottomMargin = 0;\n            height = viewer.selection.getParagraphMarkSize(lineWidget.paragraph, topMargin, bottomMargin).height;\n            height += topMargin;\n            if (lineWidget.children.length > 0) {\n                var element = lineWidget.children[0];\n                if (height < element.margin.top + element.height) {\n                    height = element.margin.top + element.height;\n                }\n            }\n        }\n        else {\n            for (var i = 0; i < lineWidget.children.length; i++) {\n                var element = lineWidget.children[i];\n                if (height < element.margin.top + element.height) {\n                    height = element.margin.top + element.height;\n                }\n            }\n        }\n        return height;\n    };\n    Layout.prototype.createOrGetNextBodyWidget = function (bodyWidget, viewer) {\n        var nextBodyWidget = undefined;\n        var pageIndex = 0;\n        pageIndex = viewer.pages.indexOf(bodyWidget.page);\n        var page = undefined;\n        var index = undefined;\n        index = bodyWidget.index;\n        if (pageIndex === viewer.pages.length - 1\n            || viewer.pages[pageIndex + 1].sectionIndex !== index) {\n            var currentWidget = new BodyWidget();\n            currentWidget.sectionFormat = bodyWidget.sectionFormat;\n            currentWidget.index = bodyWidget.index;\n            page = viewer.createNewPage(currentWidget);\n            if (viewer.pages[pageIndex + 1].sectionIndex !== index) {\n                viewer.insertPage(pageIndex + 1, page);\n            }\n            nextBodyWidget = page.bodyWidgets[0];\n        }\n        else {\n            page = viewer.pages[pageIndex + 1];\n            nextBodyWidget = page.bodyWidgets[0];\n        }\n        return nextBodyWidget;\n    };\n    Layout.prototype.isFitInClientArea = function (paragraphWidget, viewer) {\n        var lastLine = paragraphWidget.childWidgets[paragraphWidget.childWidgets.length - 1];\n        var height = paragraphWidget.height;\n        var maxElementHeight = this.getMaxElementHeight(lastLine, viewer);\n        if (lastLine.height > maxElementHeight) {\n            height -= lastLine.height - maxElementHeight;\n        }\n        return viewer.clientActiveArea.height >= height;\n    };\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.shiftToPreviousWidget = function (paragraphWidget, viewer, previousWidget, isPageBreak) {\n        for (var i = 0; i < paragraphWidget.childWidgets.length; i++) {\n            var line = paragraphWidget.childWidgets[i];\n            var maxElementHeight = this.getMaxElementHeight(line, viewer);\n            if (viewer.clientActiveArea.height >= maxElementHeight && !isPageBreak) {\n                //Moves the line widget to previous widget.\n                this.updateParagraphWidgetInternal(line, previousWidget, previousWidget.childWidgets.length);\n                i--;\n                viewer.cutFromTop(viewer.clientActiveArea.y + line.height);\n                if (isNullOrUndefined(paragraphWidget.childWidgets)) {\n                    break;\n                }\n            }\n            else {\n                var bodyWidget = previousWidget.containerWidget;\n                var nextBodyWidget = this.createOrGetNextBodyWidget(bodyWidget, viewer);\n                if (paragraphWidget.containerWidget !== nextBodyWidget) {\n                    nextBodyWidget = this.moveBlocksToNextPage(paragraphWidget);\n                }\n                if (bodyWidget !== nextBodyWidget) {\n                    this.updateContainerWidget(paragraphWidget, nextBodyWidget, 0, true);\n                }\n                //Updates client area based on next page.\n                viewer.updateClientArea(nextBodyWidget.sectionFormat, nextBodyWidget.page);\n                break;\n            }\n        }\n    };\n    Layout.prototype.updateParagraphWidgetInternal = function (lineWidget, newParagraphWidget, index) {\n        if (!isNullOrUndefined(lineWidget.paragraph)) {\n            lineWidget.paragraph.childWidgets.splice(lineWidget.paragraph.childWidgets.indexOf(lineWidget), 1);\n            lineWidget.paragraph.height -= lineWidget.height;\n            if (!isNullOrUndefined(lineWidget.paragraph.containerWidget)) {\n                lineWidget.paragraph.containerWidget.height -= lineWidget.height;\n            }\n            // tslint:disable-next-line:max-line-length\n            if (isNullOrUndefined(lineWidget.paragraph.childWidgets) || lineWidget.paragraph.childWidgets.length === 0) {\n                lineWidget.paragraph.destroyInternal(this.viewer);\n            }\n        }\n        newParagraphWidget.childWidgets.splice(index, 0, lineWidget);\n        lineWidget.paragraph = newParagraphWidget;\n        newParagraphWidget.height += lineWidget.height;\n        if (!isNullOrUndefined(newParagraphWidget.containerWidget)) {\n            newParagraphWidget.containerWidget.height += lineWidget.height;\n        }\n    };\n    Layout.prototype.shiftNextWidgets = function (blockAdv) {\n        var block = blockAdv;\n        while (block.nextWidget instanceof BlockWidget) {\n            block = block.nextWidget;\n            this.reLayoutOrShiftWidgets(block, this.viewer);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateContainerWidget = function (widget, bodyWidget, index, destroyAndScroll) {\n        if (!isNullOrUndefined(widget.containerWidget)) {\n            widget.containerWidget.childWidgets.splice(widget.containerWidget.childWidgets.indexOf(widget), 1);\n            widget.containerWidget.height -= bodyWidget.height;\n            if ((isNullOrUndefined(widget.containerWidget.childWidgets) || widget.containerWidget.childWidgets.length === 0)\n                && widget.containerWidget instanceof BodyWidget && widget.containerWidget !== bodyWidget && destroyAndScroll) {\n                var page = widget.containerWidget.page;\n                if (this.viewer.pages[this.viewer.pages.length - 1] === page &&\n                    this.viewer.visiblePages.indexOf(page) !== -1) {\n                    this.viewer.scrollToBottom();\n                }\n                if (isNullOrUndefined(page.nextPage) || page.nextPage.bodyWidgets[0].index !== widget.containerWidget.index) {\n                    widget.containerWidget.destroyInternal(this.viewer);\n                }\n            }\n        }\n        bodyWidget.childWidgets.splice(index, 0, widget);\n        bodyWidget.height += bodyWidget.height;\n        widget.containerWidget = bodyWidget;\n    };\n    Layout.prototype.getBodyWidgetOfPreviousBlock = function (block, index) {\n        index = 0;\n        var prevBodyWidget = undefined;\n        var previousBlock = block.previousRenderedWidget;\n        prevBodyWidget = (previousBlock && previousBlock.containerWidget.equals(block.containerWidget)) ?\n            previousBlock.containerWidget : block.containerWidget;\n        index = previousBlock && previousBlock.containerWidget.equals(block.containerWidget) ?\n            prevBodyWidget.childWidgets.indexOf(previousBlock) : block.containerWidget.childWidgets.indexOf(block);\n        return { bodyWidget: prevBodyWidget, index: index };\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.moveBlocksToNextPage = function (block) {\n        var body = block.bodyWidget;\n        var page = body.page;\n        var pageIndex = page.index + 1;\n        var nextPage = undefined;\n        var nextBody = undefined;\n        var insertPage = false;\n        if (this.viewer.pages.length > pageIndex) {\n            nextPage = this.viewer.pages[pageIndex];\n            if (nextPage.bodyWidgets.length === 0 || !body.equals(nextPage.bodyWidgets[0])) {\n                nextPage = undefined;\n                insertPage = true;\n            }\n            else {\n                nextBody = nextPage.bodyWidgets[0];\n                this.viewer.updateClientArea(nextBody.sectionFormat, nextBody.page);\n            }\n        }\n        if (isNullOrUndefined(nextPage)) {\n            nextBody = this.createSplitBody(body);\n            nextPage = this.viewer.createNewPage(nextBody, pageIndex);\n            if (insertPage) {\n                this.viewer.insertPage(pageIndex, nextPage);\n            }\n        }\n        //tslint:disable :no-constant-condition\n        do {\n            var lastBlock = body.lastChild;\n            if (block === lastBlock) {\n                break;\n            }\n            body.childWidgets.pop();\n            nextBody.childWidgets.splice(0, 0, lastBlock);\n            lastBlock.containerWidget = nextBody;\n            nextBody.height += lastBlock.height;\n        } while (true);\n        return nextBody;\n    };\n    Layout.prototype.createSplitBody = function (body) {\n        var newBody = this.addBodyWidget(this.viewer.clientActiveArea);\n        newBody.sectionFormat = body.sectionFormat;\n        newBody.index = body.index;\n        return newBody;\n    };\n    //endregion\n    //#region Relayout Parargaph \n    /**\n     * Relayout Paragraph from specified line widget\n     * @param paragraph Paragraph to reLayout\n     * @param lineIndex start line index to reLayout\n     * @private\n     */\n    Layout.prototype.reLayoutLine = function (paragraph, lineIndex, isBidi) {\n        if (this.viewer.owner.isDocumentLoaded && this.viewer.owner.editorModule) {\n            this.viewer.owner.editorModule.updateWholeListItems(paragraph);\n        }\n        var lineWidget;\n        if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1) {\n            lineWidget = paragraph.getSplitWidgets()[0].firstChild;\n        }\n        else {\n            lineWidget = paragraph.childWidgets[lineIndex];\n        }\n        if (!this.isBidiReLayout && (paragraph.paragraphFormat.bidi || this.isContainsRtl(lineWidget))) {\n            var newLineIndex = lineIndex <= 0 ? 0 : lineIndex - 1;\n            for (var i = newLineIndex; i < paragraph.childWidgets.length; i++) {\n                if (isBidi || !(paragraph.paragraphFormat.bidi && this.isContainsRtl(lineWidget))) {\n                    if (i === lineIndex) {\n                        continue;\n                    }\n                }\n                this.reArrangeElementsForRtl(paragraph.childWidgets[i], paragraph.paragraphFormat.bidi);\n            }\n        }\n        var lineToLayout = lineWidget.previousLine;\n        if (isNullOrUndefined(lineToLayout)) {\n            lineToLayout = lineWidget;\n        }\n        var currentParagraph = lineToLayout.paragraph;\n        var bodyWidget = paragraph.containerWidget;\n        bodyWidget.height -= paragraph.height;\n        if (this.viewer.owner.enableHeaderAndFooter || paragraph.isInHeaderFooter) {\n            paragraph.bodyWidget.isEmpty = false;\n            // tslint:disable-next-line:max-line-length\n            this.viewer.updateHCFClientAreaWithTop(paragraph.bodyWidget.sectionFormat, this.viewer.isBlockInHeader(paragraph), bodyWidget.page);\n        }\n        else {\n            this.viewer.updateClientArea(bodyWidget.sectionFormat, bodyWidget.page);\n        }\n        this.viewer.updateClientAreaForBlock(paragraph, true);\n        if (lineToLayout.paragraph.isEmpty()) {\n            this.viewer.cutFromTop(paragraph.y);\n            this.layoutParagraph(paragraph, 0);\n        }\n        else {\n            this.updateClientAreaForLine(lineToLayout.paragraph, lineToLayout, 0);\n            this.layoutListItems(lineToLayout.paragraph);\n            if (lineToLayout.isFirstLine() && !isNullOrUndefined(paragraph.paragraphFormat)) {\n                var firstLineIndent = -HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n                this.viewer.updateClientWidth(firstLineIndent);\n            }\n            do {\n                lineToLayout = this.layoutLine(lineToLayout, 0);\n                paragraph = lineToLayout.paragraph;\n                lineToLayout = lineToLayout.nextLine;\n            } while (lineToLayout);\n            this.updateWidgetToPage(this.viewer, paragraph);\n            this.viewer.updateClientAreaForBlock(paragraph, false);\n        }\n        this.layoutNextItemsBlock(paragraph, this.viewer);\n    };\n    //#endregion\n    //RTL Feature layout start\n    Layout.prototype.isContainsRtl = function (lineWidget) {\n        var isContainsRTL = false;\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            if (lineWidget.children[i] instanceof TextElementBox) {\n                isContainsRTL = lineWidget.children[i].characterFormat.bidi || lineWidget.children[i].characterFormat.bdo === 'RTL'\n                    || this.viewer.textHelper.isRTLText(lineWidget.children[i].text);\n                if (isContainsRTL) {\n                    break;\n                }\n            }\n        }\n        return isContainsRTL;\n    };\n    // Re arranges the elements for Right to left layotuing.        \n    Layout.prototype.reArrangeElementsForRtl = function (line, isParaBidi) {\n        if (line.children.length === 0) {\n            return;\n        }\n        var lastAddedElementIsRtl = false;\n        var lastAddedRtlElementIndex = -1;\n        var tempElements = [];\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            var elementCharacterFormat = undefined;\n            if (element.characterFormat) {\n                elementCharacterFormat = element.characterFormat;\n            }\n            var isRtl = false;\n            var text = '';\n            if (element instanceof BookmarkElementBox) {\n                tempElements.push(element);\n                continue;\n            }\n            if (element instanceof TextElementBox) {\n                text = element.text;\n            }\n            // The list element box shold be added in the last position in line widget for the RTL paragraph \n            // and first in the line widget for LTR paragrph.\n            if (element instanceof ListTextElementBox) {\n                isRtl = isParaBidi;\n            }\n            else { // For Text element box we need to check the character format and unicode of text to detect the RTL text. \n                isRtl = this.viewer.textHelper.isRTLText(text) || elementCharacterFormat.bidi\n                    || elementCharacterFormat.bdo === 'RTL';\n            }\n            // If the text element box contains only whitespaces, then need to check the previous and next elements.\n            if (!isRtl && !isNullOrUndefined(text) && text !== '' && text.trim() === '') {\n                var elements = line.children;\n                //Checks whether the langugae is RTL.\n                if (elementCharacterFormat.bidi) {\n                    // If the last added element is rtl then current text element box also considered as RTL for WhiteSpaces.\n                    if (lastAddedElementIsRtl) {\n                        isRtl = true;\n                        // Else, Check for next element.\n                    }\n                    else if (i + 1 < line.children.length && line.children[i + 1] instanceof TextElementBox) {\n                        text = elements[i + 1].text;\n                        isRtl = this.viewer.textHelper.isRTLText(text) || elements[i + 1].characterFormat.bidi\n                            || elements[i + 1].characterFormat.bdo === 'RTL';\n                    } // If the last added element is rtl then current text element box also considered as RTL for WhiteSpaces.\n                }\n                else if (lastAddedElementIsRtl) {\n                    isRtl = true;\n                }\n            }\n            // Preserve the isRTL value, to reuse it for navigation and selection.\n            element.isRightToLeft = isRtl;\n            //Adds the text element to the line\n            if (isRtl && elementCharacterFormat.bdo !== 'LTR') {\n                if (lastAddedElementIsRtl) {\n                    tempElements.splice(lastAddedRtlElementIndex, 0, element);\n                }\n                else {\n                    if (!isParaBidi) {\n                        tempElements.push(element);\n                    }\n                    else {\n                        tempElements.splice(0, 0, element);\n                    }\n                    lastAddedElementIsRtl = true;\n                    lastAddedRtlElementIndex = tempElements.indexOf(element);\n                }\n            }\n            else {\n                if (lastAddedElementIsRtl && element instanceof ImageElementBox) {\n                    if (elementCharacterFormat.bidi) {\n                        tempElements.splice(lastAddedRtlElementIndex + 1, 0, element);\n                    }\n                    else {\n                        tempElements.splice(lastAddedRtlElementIndex, 0, element);\n                    }\n                }\n                else {\n                    if (!isParaBidi) {\n                        tempElements.push(element);\n                    }\n                    else {\n                        if (lastAddedElementIsRtl) {\n                            tempElements.splice(0, 0, element);\n                        }\n                        else {\n                            tempElements.splice(lastAddedRtlElementIndex + 1, 0, element);\n                        }\n                        lastAddedRtlElementIndex = tempElements.indexOf(element);\n                    }\n                    lastAddedElementIsRtl = false;\n                }\n            }\n        }\n        // Clear the elemnts and reassign the arranged elements.\n        line.children = [];\n        line.children = tempElements;\n    };\n    return Layout;\n}());\nexport { Layout };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { WTableFormat, WRowFormat, WCellFormat } from '../format/index';\nimport { WParagraphFormat, WCharacterFormat, WBorder, WBorders } from '../format/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar Rect = /** @class */ (function () {\n    function Rect(x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n    }\n    Object.defineProperty(Rect.prototype, \"right\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.x + this.width;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Rect.prototype, \"bottom\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.y + this.height;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Rect;\n}());\nexport { Rect };\n/**\n * @private\n */\nvar Margin = /** @class */ (function () {\n    function Margin(leftMargin, topMargin, rightMargin, bottomMargin) {\n        this.left = leftMargin;\n        this.top = topMargin;\n        this.right = rightMargin;\n        this.bottom = bottomMargin;\n    }\n    /**\n     * @private\n     */\n    Margin.prototype.clone = function () {\n        return new Margin(this.left, this.top, this.right, this.bottom);\n    };\n    /**\n     * @private\n     */\n    Margin.prototype.destroy = function () {\n        this.left = undefined;\n        this.right = undefined;\n        this.top = undefined;\n        this.bottom = undefined;\n    };\n    return Margin;\n}());\nexport { Margin };\n/**\n * @private\n */\nvar Widget = /** @class */ (function () {\n    function Widget() {\n        /**\n         * @private\n         */\n        this.childWidgets = [];\n        /**\n         * @private\n         */\n        this.x = 0;\n        /**\n         * @private\n         */\n        this.y = 0;\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        /**\n         * @private\n         */\n        this.index = 0;\n    }\n    Object.defineProperty(Widget.prototype, \"indexInOwner\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this instanceof BodyWidget && this.page) {\n                return this.page.bodyWidgets.indexOf(this);\n            }\n            else if (this.containerWidget && this.containerWidget.childWidgets) {\n                return this.containerWidget.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"firstChild\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.childWidgets.length > 0 ? this.childWidgets[0] : undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"lastChild\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.childWidgets) {\n                return this.childWidgets.length > 0 ?\n                    this.childWidgets[this.childWidgets.length - 1] : undefined;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"previousWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (widget instanceof BodyWidget) {\n                widget = index > 0 ? widget.page.bodyWidgets[index - 1] : undefined;\n            }\n            else {\n                widget = index > 0 ? widget.containerWidget.childWidgets[index - 1] : undefined;\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"nextWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (index === -1) {\n                return undefined;\n            }\n            if (widget instanceof BodyWidget) {\n                widget = index < widget.page.bodyWidgets.length - 1 ?\n                    widget.page.bodyWidgets[index + 1] : undefined;\n            }\n            else {\n                widget = index < widget.containerWidget.childWidgets.length - 1 ?\n                    widget.containerWidget.childWidgets[index + 1] : undefined;\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"previousRenderedWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (index < 0) {\n                return undefined;\n            }\n            if (widget instanceof BodyWidget) {\n                if (index > 0) {\n                    widget = widget.page.bodyWidgets[index - 1];\n                }\n                else {\n                    var page = widget.page.previousPage;\n                    widget = page && page.bodyWidgets.length > 0 ? page.bodyWidgets[page.bodyWidgets.length - 1] : undefined;\n                }\n            }\n            else {\n                if (index > 0) {\n                    widget = widget.containerWidget.childWidgets[index - 1];\n                }\n                else {\n                    var previousContainer = undefined;\n                    if (widget.containerWidget instanceof TableCellWidget) {\n                        previousContainer = widget.containerWidget.getPreviousSplitWidget();\n                    }\n                    else if (!(widget.containerWidget instanceof TableRowWidget\n                        || widget.containerWidget instanceof HeaderFooterWidget)) {\n                        // Since cells are lay outed left to right, we should not navigate to previous row.\n                        previousContainer = widget.containerWidget.previousRenderedWidget;\n                    }\n                    while (previousContainer && previousContainer.childWidgets.length === 0) {\n                        previousContainer = previousContainer.previousRenderedWidget;\n                        if (isNullOrUndefined(previousContainer)) {\n                            break;\n                        }\n                    }\n                    widget = previousContainer && previousContainer.constructor === widget.containerWidget.constructor ?\n                        previousContainer.lastChild : undefined;\n                }\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"nextRenderedWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (index < 0) {\n                return undefined;\n            }\n            if (widget instanceof BodyWidget) {\n                if (index < widget.page.bodyWidgets.length - 1) {\n                    widget = widget.page.bodyWidgets[index + 1];\n                }\n                else {\n                    var page = widget.page.nextPage;\n                    widget = page && page.bodyWidgets.length > 0 ? page.bodyWidgets[0] : undefined;\n                }\n            }\n            else {\n                if (index < widget.containerWidget.childWidgets.length - 1) {\n                    widget = widget.containerWidget.childWidgets[index + 1];\n                }\n                else {\n                    var nextContainer = undefined;\n                    if (widget.containerWidget instanceof TableCellWidget) {\n                        nextContainer = widget.containerWidget.getNextSplitWidget();\n                    }\n                    else if (!(widget.containerWidget instanceof TableRowWidget\n                        || widget.containerWidget instanceof HeaderFooterWidget)) {\n                        // Since cells are lay outed left to right, we should not navigate to next row.\n                        nextContainer = widget.containerWidget.nextRenderedWidget;\n                    }\n                    while (nextContainer && nextContainer.childWidgets.length === 0 && !(nextContainer instanceof TableCellWidget)) {\n                        nextContainer = nextContainer.nextRenderedWidget;\n                        if (isNullOrUndefined(nextContainer)) {\n                            break;\n                        }\n                    }\n                    widget = nextContainer && nextContainer.constructor === widget.containerWidget.constructor ?\n                        nextContainer.firstChild : undefined;\n                }\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"previousSplitWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            if (widget instanceof TableCellWidget) {\n                return widget.getPreviousSplitWidget();\n            }\n            else {\n                var previous = widget.previousRenderedWidget;\n                if (widget instanceof BodyWidget && previous instanceof BodyWidget && widget.equals(previous)) {\n                    return previous;\n                }\n                else if (previous instanceof BlockWidget && widget.index === previous.index && widget.equals(previous)) {\n                    return previous;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"nextSplitWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            if (widget instanceof TableCellWidget) {\n                return widget.getNextSplitWidget();\n            }\n            else {\n                var next = widget.nextRenderedWidget;\n                if (widget instanceof BodyWidget && next instanceof BodyWidget && widget.equals(next)) {\n                    return next;\n                }\n                else if (next instanceof BlockWidget && widget.index === next.index && widget.equals(next)) {\n                    return next;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    Widget.prototype.getPreviousSplitWidgets = function () {\n        var widgets = [];\n        var widget = this.previousSplitWidget;\n        while (widget) {\n            widgets.unshift(widget);\n            widget = widget.previousSplitWidget;\n        }\n        return widgets;\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.getSplitWidgets = function () {\n        var widgets = this.getPreviousSplitWidgets();\n        var widget = this;\n        while (widget) {\n            widgets.push(widget);\n            widget = widget.nextSplitWidget;\n        }\n        return widgets;\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.combineWidget = function (viewer) {\n        var root = this;\n        var widgets = this.getSplitWidgets();\n        if (widgets.length > 1) {\n            root = widgets.shift();\n            while (widgets.length > 0) {\n                var splitWidget = widgets.shift();\n                root.combine(splitWidget, viewer);\n            }\n        }\n        if (root instanceof TableWidget) {\n            root.combineRows(viewer);\n        }\n        return root;\n    };\n    Widget.prototype.combine = function (widget, viewer) {\n        if (widget.childWidgets.length > 0) {\n            var lastChild = this.lastChild;\n            if (lastChild instanceof TableWidget) {\n                lastChild.combineWidget(viewer);\n            }\n            else {\n                var firstChild = widget.firstChild;\n                if (!(widget instanceof TableWidget) && lastChild instanceof Widget && firstChild instanceof Widget &&\n                    lastChild.index === firstChild.index) {\n                    lastChild.combine(widget.childWidgets.shift(), viewer);\n                }\n            }\n            this.addWidgets(widget.childWidgets);\n            widget.childWidgets = [];\n        }\n        widget.destroyInternal(viewer);\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.addWidgets = function (childWidgets) {\n        while (childWidgets.length > 0) {\n            var widget = childWidgets.shift();\n            if (widget instanceof LineWidget && this instanceof ParagraphWidget) {\n                widget.paragraph = this;\n                this.height += widget.height;\n            }\n            else if (widget instanceof Widget) {\n                var lastChild = this.lastChild;\n                widget.containerWidget = this;\n                widget.y = lastChild instanceof Widget ? lastChild.y + lastChild.height : this.y;\n                this.height += widget.height;\n            }\n            this.childWidgets.push(widget);\n        }\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.removeChild = function (index) {\n        if (index > -1 && index < this.childWidgets.length) {\n            this.childWidgets.splice(index, 1);\n        }\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.destroy = function () {\n        if (this.childWidgets) {\n            while (this.childWidgets.length > 0) {\n                var child = this.childWidgets.pop();\n                if (child instanceof LineWidget || child instanceof Widget) {\n                    child.destroy();\n                }\n            }\n        }\n        this.childWidgets = undefined;\n        if (this.containerWidget) {\n            this.containerWidget.removeChild(this.indexInOwner);\n        }\n        this.containerWidget = undefined;\n        // if (this.margin) {\n        //     this.margin.destroy();\n        // }\n        this.margin = undefined;\n        this.x = undefined;\n        this.y = undefined;\n        this.width = undefined;\n        this.height = undefined;\n        this.index = undefined;\n    };\n    return Widget;\n}());\nexport { Widget };\n/**\n * @private\n */\nvar BlockContainer = /** @class */ (function (_super) {\n    __extends(BlockContainer, _super);\n    function BlockContainer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        /**\n         * @private\n         */\n        _this.sectionFormatIn = undefined;\n        return _this;\n    }\n    Object.defineProperty(BlockContainer.prototype, \"sectionFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var container = this;\n            if (container instanceof BodyWidget) {\n                return container.sectionFormatIn;\n            }\n            else if (container.page) {\n                return container.page.bodyWidgets[0].sectionFormat;\n            }\n            return undefined;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (this instanceof BodyWidget) {\n                this.sectionFormatIn = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockContainer.prototype, \"sectionIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var container = this;\n            var index = 0;\n            if (container instanceof BodyWidget) {\n                index = container.index;\n            }\n            else if (container.page) {\n                index = container.page.bodyWidgets[0].index;\n            }\n            return index;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    BlockContainer.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var viewer = undefined;\n        var node = this;\n        if (node instanceof BodyWidget) {\n            hierarchicalIndex = node.index + ';' + hierarchicalIndex;\n        }\n        else {\n            if (node.headerFooterType.indexOf('Header') !== -1) {\n                hierarchicalIndex = 'H' + ';' + hierarchicalIndex;\n            }\n            else {\n                hierarchicalIndex = 'F' + ';' + hierarchicalIndex;\n            }\n        }\n        if (!isNullOrUndefined(node.page)) {\n            viewer = this.page.viewer;\n            var pageIndex = viewer.pages.indexOf(this.page);\n            return pageIndex + ';' + hierarchicalIndex;\n        }\n        return hierarchicalIndex;\n    };\n    return BlockContainer;\n}(Widget));\nexport { BlockContainer };\n/**\n * @private\n */\nvar BodyWidget = /** @class */ (function (_super) {\n    __extends(BodyWidget, _super);\n    /**\n     * Initialize the constructor of BodyWidget\n     */\n    function BodyWidget() {\n        return _super.call(this) || this;\n    }\n    /**\n     * @private\n     */\n    BodyWidget.prototype.equals = function (widget) {\n        return widget instanceof BodyWidget && widget.sectionFormat === this.sectionFormat;\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var viewer = undefined;\n        var node = this;\n        hierarchicalIndex = node.index + ';' + hierarchicalIndex;\n        if (!isNullOrUndefined(node.page)) {\n            viewer = this.page.viewer;\n            var pageIndex = viewer.pages.indexOf(this.page);\n            return pageIndex + ';' + hierarchicalIndex;\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.getTableCellWidget = function (touchPoint) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            if (this.childWidgets[i].y <= touchPoint.y\n                && (this.childWidgets[i].y + this.childWidgets[i].height) >= touchPoint.y) {\n                return this.childWidgets[i].getTableCellWidget(touchPoint);\n            }\n        }\n        var tableCellWidget = undefined;\n        if (this.childWidgets.length > 0) {\n            if (this.childWidgets[0].y <= touchPoint.y) {\n                tableCellWidget = this.childWidgets[this.childWidgets.length - 1].getTableCellWidget(touchPoint);\n            }\n            else {\n                tableCellWidget = this.childWidgets[0].getTableCellWidget(touchPoint);\n            }\n        }\n        return tableCellWidget;\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var n = 0; n < this.childWidgets.length; n++) {\n                var chilgWidget = this.childWidgets[n];\n                if (chilgWidget instanceof ParagraphWidget) {\n                    chilgWidget.destroyInternal(viewer);\n                }\n                else {\n                    chilgWidget.destroyInternal(viewer);\n                }\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                n--;\n            }\n            this.childWidgets = undefined;\n        }\n        // if (this instanceof HeaderFooterWidget && ((this as HeaderFooterWidget).currentNode ))) {\n        //     if (((this as HeaderFooterWidget).currentNode as WHeaderFooter).layoutedWidgets )) {\n        //         let index: number = ((this as HeaderFooterWidget).currentNode as WHeaderFooter).layoutedWidgets.indexOf(this);\n        //         ((this as HeaderFooterWidget).currentNode as WHeaderFooter).layoutedWidgets.splice(index, 1);\n        //     }\n        //     this.currentNode = undefined;\n        /* tslint:disable: one-line */\n        if (!isNullOrUndefined(this.page)) {\n            var index = this.indexInOwner;\n            if (this.indexInOwner > -1) {\n                this.page.bodyWidgets.splice(index, 1);\n                if (this.page.bodyWidgets.length === 0) {\n                    this.page.destroy();\n                    // }\n                }\n                else if ((this instanceof HeaderFooterWidget)\n                    && this.page.headerWidget === this) {\n                    this.page.headerWidget = undefined;\n                }\n                else if ((this instanceof HeaderFooterWidget)\n                    && this.page.footerWidget === this) {\n                    this.page.footerWidget = undefined;\n                }\n                this.page = undefined;\n            }\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.destroy = function () {\n        // if (this.sectionFormat) {\n        //     this.sectionFormat.destroy();\n        // }\n        this.sectionFormat = undefined;\n        this.page = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return BodyWidget;\n}(BlockContainer));\nexport { BodyWidget };\n/**\n * @private\n */\nvar HeaderFooterWidget = /** @class */ (function (_super) {\n    __extends(HeaderFooterWidget, _super);\n    function HeaderFooterWidget(type) {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.isEmpty = false;\n        _this.headerFooterType = type;\n        return _this;\n    }\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.getTableCellWidget = function (point) {\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.equals = function (widget) {\n        // Todo: Need to work\n        return widget instanceof HeaderFooterWidget\n            && widget.containerWidget === this.containerWidget;\n    };\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.clone = function () {\n        var headerFooter = new HeaderFooterWidget(this.headerFooterType);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var block = this.childWidgets[i].clone();\n            headerFooter.childWidgets.push(block);\n            block.index = i;\n            block.containerWidget = headerFooter;\n        }\n        headerFooter.isEmpty = this.isEmpty;\n        headerFooter.x = this.x;\n        headerFooter.y = this.y;\n        headerFooter.height = 0;\n        headerFooter.width = 0;\n        return headerFooter;\n    };\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.destroyInternal = function (viewer) {\n        this.page = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return HeaderFooterWidget;\n}(BlockContainer));\nexport { HeaderFooterWidget };\n/**\n * @private\n */\nvar BlockWidget = /** @class */ (function (_super) {\n    __extends(BlockWidget, _super);\n    function BlockWidget() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(BlockWidget.prototype, \"bodyWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            while (widget.containerWidget) {\n                if (widget.containerWidget instanceof BlockContainer) {\n                    return widget.containerWidget;\n                }\n                widget = widget.containerWidget;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"leftIndent\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var blockAdv = this;\n            if (blockAdv instanceof ParagraphWidget && blockAdv.paragraphFormat instanceof WParagraphFormat) {\n                return blockAdv.paragraphFormat.leftIndent;\n            }\n            else if (blockAdv instanceof TableWidget && blockAdv.tableFormat instanceof WTableFormat) {\n                return blockAdv.tableFormat.leftIndent;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"rightIndent\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var blockAdv = this;\n            if (blockAdv instanceof ParagraphWidget && blockAdv.paragraphFormat instanceof WParagraphFormat) {\n                return blockAdv.paragraphFormat.rightIndent;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"isInsideTable\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.containerWidget instanceof TableCellWidget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"isInHeaderFooter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.bodyWidget instanceof HeaderFooterWidget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"associatedCell\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget instanceof TableCellWidget) {\n                return this.containerWidget;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Check whether the paragraph contains only page break.\n     * @private\n     */\n    BlockWidget.prototype.isPageBreak = function () {\n        var isPageBreak = false;\n        if (this instanceof ParagraphWidget) {\n            var paragraph = this;\n            if (paragraph != null && paragraph.childWidgets.length === 1 &&\n                paragraph.firstChild.children.length === 1) {\n                var pageBreak = paragraph.firstChild.children[0];\n                isPageBreak = pageBreak.isPageBreak;\n            }\n        }\n        return isPageBreak;\n    };\n    /**\n     * @private\n     */\n    BlockWidget.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var node = this;\n        hierarchicalIndex = node.containerWidget.childWidgets.indexOf(node) + ';' + hierarchicalIndex;\n        if (!isNullOrUndefined(node.containerWidget)) {\n            if (node.containerWidget instanceof BlockWidget) {\n                return node.containerWidget.getHierarchicalIndex(hierarchicalIndex);\n            }\n            else if (node.containerWidget instanceof BlockContainer) {\n                hierarchicalIndex = node.containerWidget.getHierarchicalIndex(hierarchicalIndex);\n            }\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    BlockWidget.prototype.getIndex = function () {\n        if (this instanceof ParagraphWidget || this instanceof TableWidget) {\n            return this.containerWidget.childWidgets.indexOf(this);\n        }\n        else if (this instanceof TableRowWidget) {\n            return this.ownerTable.childWidgets.indexOf(this);\n        }\n        else if (this instanceof TableCellWidget) {\n            return this.ownerRow.childWidgets.indexOf(this);\n        }\n        return 0;\n    };\n    /**\n     * @private\n     */\n    BlockWidget.prototype.getContainerWidth = function () {\n        if (this.isInsideTable) {\n            return this.associatedCell.getCellWidth();\n        }\n        else {\n            var bodyWidget = this.bodyWidget;\n            var sectionFormat = bodyWidget.sectionFormat;\n            return sectionFormat.pageWidth - (sectionFormat.leftMargin + sectionFormat.rightMargin);\n        }\n    };\n    Object.defineProperty(BlockWidget.prototype, \"bidi\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this instanceof ParagraphWidget && this.paragraphFormat instanceof WParagraphFormat) {\n                return this.paragraphFormat.bidi;\n            }\n            if (this instanceof TableWidget && this.tableFormat instanceof WTableFormat) {\n                return this.tableFormat.bidi;\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return BlockWidget;\n}(Widget));\nexport { BlockWidget };\n/**\n * @private\n */\nvar ParagraphWidget = /** @class */ (function (_super) {\n    __extends(ParagraphWidget, _super);\n    /**\n     * Initialize the constructor of ParagraphWidget\n     */\n    function ParagraphWidget() {\n        var _this = _super.call(this) || this;\n        _this.paragraphFormat = new WParagraphFormat(_this);\n        _this.characterFormat = new WCharacterFormat(_this);\n        return _this;\n    }\n    Object.defineProperty(ParagraphWidget.prototype, \"isEndsWithPageBreak\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.childWidgets.length > 0) {\n                return this.lastChild.isEndsWithPageBreak;\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.equals = function (widget) {\n        return widget instanceof ParagraphWidget && widget.paragraphFormat === this.paragraphFormat;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.isEmpty = function () {\n        if (isNullOrUndefined(this.childWidgets) || this.childWidgets.length === 0) {\n            return true;\n        }\n        for (var j = 0; j < this.childWidgets.length; j++) {\n            var inlineElement = this.childWidgets[j];\n            for (var i = 0; i < inlineElement.children.length; i++) {\n                var inline = inlineElement.children[i];\n                if (inline.length === 0) {\n                    continue;\n                }\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox || inline instanceof BookmarkElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.getInline = function (offset, indexInInline) {\n        var inline = undefined;\n        var count = 0;\n        var isStarted = false;\n        var splittedWidget = this.getSplitWidgets();\n        for (var k = 0; k < splittedWidget.length; k++) {\n            var widget = splittedWidget[k];\n            for (var j = 0; j < widget.childWidgets.length; j++) {\n                var line = widget.childWidgets[j];\n                for (var i = 0; i < line.children.length; i++) {\n                    inline = line.children[i];\n                    if (inline instanceof ListTextElementBox) {\n                        continue;\n                    }\n                    if (!isStarted && (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                        || inline instanceof BookmarkElementBox || inline instanceof FieldElementBox\n                        && HelperMethods.isLinkedFieldCharacter(inline))) {\n                        isStarted = true;\n                    }\n                    if (isStarted && offset <= count + inline.length) {\n                        indexInInline = (offset - count);\n                        return { 'element': inline, 'index': indexInInline };\n                    }\n                    count += inline.length;\n                }\n            }\n        }\n        if (offset > count) {\n            indexInInline = isNullOrUndefined(inline) ? offset : inline.length;\n        }\n        return { 'element': inline, 'index': indexInInline };\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.getLength = function () {\n        var length = 0;\n        for (var j = 0; j < this.childWidgets.length; j++) {\n            var line = this.childWidgets[j];\n            for (var i = 0; i < line.children.length; i++) {\n                var element = line.children[i];\n                if (element instanceof ListTextElementBox) {\n                    continue;\n                }\n                length += element.length;\n            }\n        }\n        return length;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.getTableCellWidget = function (point) {\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-func-body-length\n    ParagraphWidget.prototype.getMinimumAndMaximumWordWidth = function (minimumWordWidth, maximumWordWidth) {\n        minimumWordWidth = HelperMethods.convertPointToPixel(minimumWordWidth);\n        maximumWordWidth = HelperMethods.convertPointToPixel(maximumWordWidth);\n        if (this.childWidgets.length > 0) {\n            var element = this.childWidgets[0].children[0];\n            var text = '';\n            var elements = new Dictionary();\n            var imageWidths = [];\n            // tslint:disable-next-line:no-constant-condition\n            do {\n                if (element instanceof TextElementBox && element.text !== '') {\n                    elements.add(element, text.length);\n                    text += (element.text);\n                }\n                else if (element instanceof FieldElementBox && element.fieldType === 0) {\n                    var fieldBegin = element;\n                    // tslint:disable-next-line:max-line-length\n                    if (!isNullOrUndefined(fieldBegin.fieldEnd)) {\n                        element = isNullOrUndefined(fieldBegin.fieldSeparator) ? fieldBegin.fieldEnd : fieldBegin.fieldSeparator;\n                    }\n                }\n                else if (element instanceof ImageElementBox) {\n                    imageWidths.push(element.width);\n                }\n                if (isNullOrUndefined(element) || isNullOrUndefined(element.nextNode)) {\n                    break;\n                }\n                element = element.nextNode;\n            } while (true);\n            var pattern = new RegExp('\\\\b\\\\w+\\\\b', 'g');\n            var matches = [];\n            var matchInfo = void 0;\n            //tslint:disable no-conditional-assignment\n            while (!isNullOrUndefined(matchInfo = pattern.exec(text))) {\n                matches.push(matchInfo);\n            }\n            for (var i = 0; i < matches.length; i++) {\n                var match = matches[i];\n                var width = 0;\n                text = '';\n                var matchedValue = '';\n                var wordStartIndex = 0;\n                var wordEndIndex = match.index;\n                var index = match.index;\n                for (var j = 0; j < elements.keys.length; j++) {\n                    var span = elements.keys[j];\n                    var startIndex = elements.get(span);\n                    var spanLength = span.length;\n                    if (index <= startIndex + spanLength) {\n                        wordStartIndex = index - startIndex;\n                        if (match.index + match[0].length <= startIndex + spanLength) {\n                            wordEndIndex = (match.index + match[0].length) - (startIndex + wordStartIndex);\n                        }\n                        else {\n                            wordEndIndex = spanLength - wordStartIndex;\n                            index += wordEndIndex;\n                        }\n                        text = span.text.substring(wordStartIndex, wordStartIndex + wordEndIndex);\n                        matchedValue = matchedValue + text;\n                    }\n                    if (text !== '') {\n                        width += this.bodyWidget.page.viewer.textHelper.getWidth(text, span.characterFormat);\n                    }\n                    if (matchedValue === match[0]) {\n                        break;\n                    }\n                }\n                if (width !== 0) {\n                    if (minimumWordWidth === 0 || width > minimumWordWidth) {\n                        minimumWordWidth = width;\n                    }\n                }\n            }\n            // Check the image widths present in the paragraph. Consider the maximum image width as minimum word width.\n            var imageWidth = 0;\n            if (imageWidths.length > 0) {\n                imageWidth = Math.max.apply(null, imageWidths);\n            }\n            if (minimumWordWidth === 0 || imageWidth > minimumWordWidth) {\n                minimumWordWidth = imageWidth;\n            }\n            var maximum = this.measureParagraph();\n            if (maximumWordWidth === 0 || maximum > maximumWordWidth) {\n                maximumWordWidth = maximum;\n            }\n        }\n        return {\n            'maximumWordWidth': HelperMethods.convertPixelToPoint(maximumWordWidth),\n            'minimumWordWidth': HelperMethods.convertPixelToPoint(minimumWordWidth)\n        };\n    };\n    ParagraphWidget.prototype.measureParagraph = function () {\n        var width = 0;\n        var element = this.childWidgets[0].children[0];\n        // tslint:disable-next-line:no-constant-condition\n        do {\n            if (element instanceof TextElementBox && element.text !== '') {\n                width += this.bodyWidget.page.viewer.textHelper.getWidth(element.text, element.characterFormat);\n            }\n            else if (element instanceof FieldElementBox && element.fieldType === 0) {\n                var fieldBegin = element;\n                if (fieldBegin.fieldEnd != null) {\n                    element = isNullOrUndefined(fieldBegin.fieldSeparator) ? fieldBegin.fieldEnd : fieldBegin.fieldSeparator;\n                }\n            }\n            else if (element instanceof ImageElementBox) {\n                width += element.width;\n            }\n            if (isNullOrUndefined(element) || isNullOrUndefined(element.nextNode)) {\n                break;\n            }\n            element = element.nextNode;\n        } while (true);\n        // Considered the left and right indent.\n        if (this.leftIndent > 0) {\n            width += this.leftIndent;\n        }\n        if (this.rightIndent > 0) {\n            width += this.rightIndent;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.clone = function () {\n        var paragraph = new ParagraphWidget();\n        paragraph.paragraphFormat.copyFormat(this.paragraphFormat);\n        paragraph.characterFormat.copyFormat(this.characterFormat);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var line = this.childWidgets[i];\n            var cloneLine = line.clone();\n            paragraph.childWidgets.push(cloneLine);\n            cloneLine.paragraph = paragraph;\n        }\n        paragraph.x = this.x;\n        paragraph.y = this.y;\n        paragraph.height = this.height;\n        paragraph.width = this.width;\n        return paragraph;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var i = 0; i < this.childWidgets.length; i++) {\n                var widget = this.childWidgets[i];\n                widget.destroy();\n                if (this.childWidgets.length === 1 && isNullOrUndefined(this.childWidgets[0].children)) {\n                    this.childWidgets = undefined;\n                }\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                i--;\n            }\n            this.childWidgets = undefined;\n        }\n        if (!isNullOrUndefined(this.containerWidget) && !isNullOrUndefined(this.containerWidget.childWidgets)\n            && this.containerWidget.childWidgets.indexOf(this) !== -1) {\n            this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this), 1);\n            this.containerWidget.height -= height;\n            // if ((isNullOrUndefined(this.containerWidget.childWidgets) || this.containerWidget.childWidgets.length === 0)\n            //     && this.containerWidget instanceof BodyWidget) {\n            //     // (this.containerWidget as BodyWidget).destroyInternal(viewer);\n            // }\n            this.containerWidget = undefined;\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.destroy = function () {\n        // if (this.paragraphFormat) {\n        //     this.paragraphFormat.destroy();\n        // }\n        this.paragraphFormat = undefined;\n        // if (this.characterFormat) {\n        //     this.characterFormat.destroy();\n        // }\n        this.characterFormat = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return ParagraphWidget;\n}(BlockWidget));\nexport { ParagraphWidget };\n/**\n * @private\n */\nvar TableWidget = /** @class */ (function (_super) {\n    __extends(TableWidget, _super);\n    function TableWidget() {\n        var _this = _super.call(this) || this;\n        _this.flags = 0;\n        /**\n         * @private\n         */\n        _this.leftMargin = 0;\n        /**\n         * @private\n         */\n        _this.topMargin = 0;\n        /**\n         * @private\n         */\n        _this.rightMargin = 0;\n        /**\n         * @private\n         */\n        _this.bottomMargin = 0;\n        _this.margin = new Margin(_this.leftMargin, _this.topMargin, _this.rightMargin, _this.bottomMargin);\n        _this.leftBorderWidth = 0;\n        _this.rightBorderWidth = 0;\n        _this.topBorderWidth = 0;\n        _this.bottomBorderWidth = 0;\n        _this.tableFormat = new WTableFormat(_this);\n        _this.tableHolder = new WTableHolder();\n        _this.spannedRowCollection = new Dictionary();\n        return _this;\n    }\n    Object.defineProperty(TableWidget.prototype, \"isGridUpdated\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return ((this.flags & 0x4) >> 2) !== 0;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.flags = ((this.flags & 0xFB) | ((value ? 1 : 0) << 2));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableWidget.prototype, \"continueHeader\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return ((this.flags & 0x2) >> 1) !== 0;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.flags = ((this.flags & 0xFD) | ((value ? 1 : 0) << 1));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableWidget.prototype, \"header\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return (this.flags & 0x1) !== 0;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.flags = ((this.flags & 0xFE) | (value ? 1 : 0));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableWidget.prototype, \"isBidiTable\", {\n        get: function () {\n            return ((this.flags & 0x10) >> 4) !== 0;\n        },\n        set: function (value) {\n            this.flags = ((this.flags & 0xEF) | ((value ? 1 : 0) << 4));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableWidget.prototype.equals = function (widget) {\n        return widget instanceof TableWidget && widget.tableFormat === this.tableFormat;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.combineRows = function (viewer) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            if (row.childWidgets.length === 0) {\n                row.destroy();\n                i--;\n            }\n            else {\n                row.combineCells(viewer);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.contains = function (tableCell) {\n        if (this.equals(tableCell.ownerTable)) {\n            return true;\n        }\n        while (tableCell.ownerTable.isInsideTable) {\n            if (this.equals(tableCell.ownerTable)) {\n                return true;\n            }\n            tableCell = tableCell.ownerTable.associatedCell;\n        }\n        return this.equals(tableCell.ownerTable);\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getOwnerWidth = function (isBasedOnViewer) {\n        var width = this.getContainerWidth();\n        // Left and right indents should be neglected.\n        width = width - this.leftIndent - this.rightIndent;\n        return width >= 0 ? width : 0;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getTableWidth = function () {\n        var width = 0;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var rowWidth = 0;\n            var row = this.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                rowWidth += row.childWidgets[j].cellFormat.cellWidth;\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getTableClientWidth = function (clientWidth) {\n        var tableWidth = clientWidth;\n        if (this.tableFormat.preferredWidthType === 'Point'\n            && this.tableFormat.preferredWidth > 0) {\n            tableWidth = this.tableFormat.preferredWidth;\n        }\n        else {\n            if (this.tableFormat.preferredWidthType === 'Percent'\n                && this.tableFormat.preferredWidth > 0) {\n                tableWidth = tableWidth * this.tableFormat.preferredWidth / 100;\n            }\n        }\n        return tableWidth;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getCellWidth = function (preferredWidth, preferredWidthType, containerWidth, cell) {\n        var cellWidth = preferredWidth;\n        if (preferredWidthType === 'Percent') {\n            cellWidth = (preferredWidth * containerWidth) / 100;\n        }\n        else if (preferredWidthType === 'Point') {\n            cellWidth = preferredWidth;\n        }\n        // For grid before and grid after with auto width, no need to calculate minimum preferred width.\n        else if (!isNullOrUndefined(cell)) {\n            cellWidth = cell.getMinimumPreferredWidth();\n        }\n        return cellWidth;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.fitCellsToClientArea = function (clientWidth) {\n        var tableWidth = this.getTableWidth();\n        var factor = clientWidth / tableWidth;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            row.rowFormat.gridAfterWidth *= factor;\n            row.rowFormat.gridBeforeWidth *= factor;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                row.childWidgets[j].cellFormat.cellWidth *= factor;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getTableCellWidget = function (point) {\n        var tableCellWidget = undefined;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            if (this.childWidgets[i].y <= point.y\n                && (this.childWidgets[i].y + this.childWidgets[i].height) >= point.y) {\n                tableCellWidget = this.childWidgets[i].getTableCellWidget(point);\n                break;\n            }\n        }\n        return tableCellWidget;\n    };\n    /**\n     * @private\n     */\n    //tslint:disable: max-func-body-length\n    TableWidget.prototype.calculateGrid = function () {\n        var tempGrid = [];\n        var spannedCells = [];\n        var containerWidth = this.getOwnerWidth(true);\n        var tableWidth = this.getTableClientWidth(containerWidth);\n        this.tableCellInfo = new Dictionary();\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            var rowCellInfo = new Dictionary();\n            var rowFormat = row.rowFormat;\n            var cellWidth = 0;\n            var columnSpan = row.rowFormat.gridBefore;\n            var currOffset = 0;\n            if (tempGrid.indexOf(currOffset) < 0) {\n                tempGrid.push(currOffset);\n            }\n            //Converts the row grid before width from point to twips point by 15 factor.\n            cellWidth = this.getCellWidth(rowFormat.gridBeforeWidth, rowFormat.gridBeforeWidthType, tableWidth, null);\n            currOffset += cellWidth;\n            var startOffset = parseFloat(currOffset.toFixed(2));\n            if (tempGrid.indexOf(startOffset) < 0) {\n                tempGrid.push(startOffset);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                for (var k = 0; k < spannedCells.length; k++) {\n                    if (spannedCells[k].columnIndex < columnSpan) {\n                        continue;\n                    }\n                    var rowSpan = spannedCells[k].cellFormat.rowSpan;\n                    var removeSpannedCell = true;\n                    if (spannedCells[k].columnIndex > columnSpan) {\n                        {\n                            removeSpannedCell = false;\n                            // If the cell is the last cell in the row and the row has grid after value..\n                            if (j === row.childWidgets.length - 1 && row.rowFormat.gridAfter > 0) {\n                                // tslint:disable-next-line:max-line-length\n                                cellWidth = this.getCellWidth(spannedCells[k].cellFormat.preferredWidth, spannedCells[k].cellFormat.preferredWidthType, tableWidth, null);\n                                currOffset += cellWidth;\n                            }\n                        }\n                    }\n                    else {\n                        // If the table gird alone calculted then column index of the rowspanned cell will be directly taken. \n                        // If the gird calculation is done from the UI level opearations such as resizing then table holder \n                        // will have the columns at that time we can get the column index from the table holder.\n                        //Converts the cell width from point to twips point by 15 factor.\n                        // tslint:disable-next-line:max-line-length\n                        cellWidth = this.getCellWidth(spannedCells[k].cellFormat.preferredWidth, spannedCells[k].cellFormat.preferredWidthType, tableWidth, null);\n                        currOffset += cellWidth;\n                        columnSpan = spannedCells[k].columnIndex + spannedCells[k].cellFormat.columnSpan;\n                    }\n                    if (!removeSpannedCell && j === row.childWidgets.length - 1) {\n                        removeSpannedCell = true;\n                    }\n                    if (removeSpannedCell && i - spannedCells[k].ownerRow.rowIndex === rowSpan - 1) {\n                        spannedCells.splice(k, 1);\n                        k--;\n                    }\n                }\n                // At the start of each row, we will process the row spanned cells to get the start column index.\n                // To calculate grid properly, we need the items in the spanned cells collection in the order of their column index\n                if (cell.cellFormat.rowSpan > 1) {\n                    if (spannedCells.length === 0 || spannedCells[spannedCells.length - 1].columnIndex <= columnSpan) {\n                        spannedCells.push(cell);\n                    }\n                    else {\n                        for (var m = spannedCells.length; m > 0; m--) {\n                            if (spannedCells[m - 1].columnIndex > columnSpan) {\n                                spannedCells.splice(m - 1, 0, cell);\n                            }\n                        }\n                    }\n                }\n                // Add start offset of each cell based on its index\n                if (!rowCellInfo.containsKey(cell.cellIndex)) {\n                    rowCellInfo.add(cell.cellIndex, parseFloat((currOffset - startOffset).toFixed(2)));\n                }\n                columnSpan += cell.cellFormat.columnSpan;\n                //Converts the cell width from pixel to twips point by 15 factor.\n                cellWidth = this.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, tableWidth, null);\n                currOffset += cellWidth;\n                var offset = parseFloat(currOffset.toFixed(2));\n                if (tempGrid.indexOf(offset) < 0) {\n                    tempGrid.push(offset);\n                }\n                if (j === row.childWidgets.length - 1 && rowFormat.gridAfter > 0) {\n                    cellWidth = this.getCellWidth(rowFormat.gridAfterWidth, 'Point', tableWidth, null);\n                    currOffset += cellWidth;\n                    if (tempGrid.indexOf(parseFloat(currOffset.toFixed(2))) < 0) {\n                        tempGrid.push(parseFloat(currOffset.toFixed(2)));\n                    }\n                    columnSpan += rowFormat.gridAfter;\n                }\n                // Add rowindex and its cells info for each row\n                if (!this.tableCellInfo.containsKey(row.rowIndex)) {\n                    this.tableCellInfo.add(row.rowIndex, rowCellInfo);\n                }\n            }\n        }\n        tempGrid.sort(function (a, b) { return a - b; });\n        if (tempGrid.length - 1 !== this.tableHolder.columns.length) {\n            this.updateColumnSpans(tempGrid, tableWidth);\n        }\n        this.tableCellInfo.clear();\n        this.tableCellInfo = undefined;\n    };\n    TableWidget.prototype.updateColumnSpans = function (tempGrid, containerWidth) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            if (row.rowFormat.gridBeforeWidth >= 0) {\n                row.rowFormat.gridBefore = row.getGridCount(tempGrid, undefined, -1, containerWidth);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var columnSpan = row.getGridCount(tempGrid, cell, cell.getIndex(), containerWidth);\n                if (columnSpan > 0 && cell.cellFormat.columnSpan !== columnSpan) {\n                    cell.cellFormat.columnSpan = columnSpan;\n                }\n            }\n            if (row.rowFormat.gridAfterWidth >= 0) {\n                row.rowFormat.gridAfter = row.getGridCount(tempGrid, undefined, row.childWidgets.length, containerWidth);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getMinimumAndMaximumWordWidth = function (minimumWordWidth, maximumWordWidth) {\n        this.checkTableColumns();\n        var tableWidth = this.tableHolder.getTotalWidth(0);\n        if (tableWidth > minimumWordWidth) {\n            minimumWordWidth = tableWidth;\n        }\n        if (tableWidth > maximumWordWidth) {\n            maximumWordWidth = tableWidth;\n        }\n        return { 'minimumWordWidth': minimumWordWidth, 'maximumWordWidth': maximumWordWidth };\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.checkTableColumns = function () {\n        if (this.isGridUpdated) {\n            return;\n        }\n        var isAutoFit = this.isAutoFit();\n        if (isAutoFit || this.tableHolder.columns.length === 0) {\n            this.buildTableColumns();\n        }\n        this.isGridUpdated = true;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.isAutoFit = function () {\n        var bodyWidget = this.bodyWidget;\n        if (!isNullOrUndefined(bodyWidget) && !isNullOrUndefined(bodyWidget.page)) {\n            return bodyWidget.page.viewer.layout.getParentTable(this).tableFormat.allowAutoFit;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.buildTableColumns = function () {\n        if (this.isGridUpdated) {\n            return;\n        }\n        // Clear existing columns in order to start creating columns freshly.\n        this.tableHolder.resetColumns();\n        var containerWidth = 0;\n        var tableWidth = 0;\n        var rowSpannedCells = [];\n        var isAutoWidth = this.tableFormat.preferredWidthType === 'Auto';\n        var isAutoFit = this.tableFormat.allowAutoFit;\n        // For continuous layout, window width should be considered. \n        // If preferred width exceeds this limit, it can take upto maximum of 2112 pixels (1584 points will be assigned by Microsoft Word).\n        containerWidth = this.getOwnerWidth(true);\n        tableWidth = this.getTableClientWidth(containerWidth);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            var rowFormat = row.rowFormat;\n            var columnSpan = 0;\n            var cellWidth = 0;\n            var sizeInfo = new ColumnSizeInfo();\n            var offset = 0;\n            if (rowFormat.gridBefore > 0) {\n                cellWidth = this.getCellWidth(rowFormat.gridBeforeWidth, row.rowFormat.gridAfterWidthType, tableWidth, null);\n                sizeInfo.minimumWidth = cellWidth;\n                this.tableHolder.addColumns(columnSpan, columnSpan = rowFormat.gridBefore, cellWidth, sizeInfo, offset = cellWidth);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                if (rowSpannedCells.length === 0) {\n                    cell.columnIndex = columnSpan;\n                }\n                for (var k = 0; k < rowSpannedCells.length; k++) {\n                    var rowSpannedCell = rowSpannedCells[k];\n                    if (rowSpannedCell.columnIndex < columnSpan) {\n                        cell.columnIndex = columnSpan;\n                        continue;\n                    }\n                    var rowSpan = 1;\n                    var removeSpannedCell = true;\n                    rowSpan = rowSpannedCell.cellFormat.rowSpan;\n                    if (rowSpannedCell.columnIndex > columnSpan) {\n                        cell.columnIndex = columnSpan;\n                        removeSpannedCell = false;\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        cellWidth = this.getCellWidth(rowSpannedCell.cellFormat.preferredWidth, rowSpannedCell.cellFormat.preferredWidthType, tableWidth, rowSpannedCell);\n                        sizeInfo = rowSpannedCell.getCellSizeInfo(isAutoFit);\n                        // If the table gird alone calculated then column index of the rowspanned cell will be directly taken. \n                        // tslint:disable-next-line:max-line-length\n                        // If the gird calculation is done from the UI level operations such as resizing then table holder will have the columns at that time we can get the column index from the table holder.\n                        // tslint:disable-next-line:max-line-length\n                        if (this.tableHolder.columns.length > 0) {\n                            this.tableHolder.addColumns(columnSpan, columnSpan = this.tableHolder.columns.indexOf(rowSpannedCell.ownerColumn) + rowSpannedCell.cellFormat.columnSpan, cellWidth, sizeInfo, offset += cellWidth);\n                            cell.columnIndex = columnSpan;\n                        }\n                        else {\n                            // tslint:disable-next-line:max-line-length\n                            this.tableHolder.addColumns(columnSpan, columnSpan = rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan, cellWidth, sizeInfo, offset += cellWidth);\n                            cell.columnIndex = columnSpan;\n                        }\n                    }\n                    if (!removeSpannedCell && j === row.childWidgets.length - 1) {\n                        removeSpannedCell = true;\n                    }\n                    if (removeSpannedCell && i - rowSpannedCell.ownerRow.rowIndex === rowSpan - 1) {\n                        rowSpannedCells.splice(k, 1);\n                        k--;\n                    }\n                }\n                // At the start of each row, we will process the row spanned cells to get the start column index.\n                // To calculate grid properly, we need the items in the spanned cells collection in the order of their column index\n                if (cell.cellFormat.rowSpan > 1) {\n                    if (rowSpannedCells.length === 0 || rowSpannedCells[rowSpannedCells.length - 1].columnIndex <= columnSpan) {\n                        rowSpannedCells.push(cell);\n                    }\n                    else {\n                        for (var m = rowSpannedCells.length; m > 0; m--) {\n                            if (rowSpannedCells[m - 1].columnIndex > columnSpan) {\n                                rowSpannedCells.splice(m - 1, 0, cell);\n                            }\n                        }\n                    }\n                }\n                cellWidth = this.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, tableWidth, cell);\n                sizeInfo = cell.getCellSizeInfo(isAutoFit);\n                this.tableHolder.addColumns(columnSpan, columnSpan += cell.cellFormat.columnSpan, cellWidth, sizeInfo, offset += cellWidth);\n                if (j === row.childWidgets.length - 1 && rowFormat.gridAfterWidth > 0) {\n                    cellWidth = this.getCellWidth(rowFormat.gridAfterWidth, 'Point', tableWidth, null);\n                    this.tableHolder.addColumns(columnSpan, columnSpan += rowFormat.gridAfter, cellWidth, sizeInfo, offset += cellWidth);\n                }\n            }\n        }\n        this.tableHolder.validateColumnWidths();\n        if (isAutoFit) {\n            // Fits the column width automatically based on contents.\n            this.tableHolder.autoFitColumn(containerWidth, tableWidth, isAutoWidth, this.isInsideTable);\n        }\n        else {\n            // Fits the column width based on preferred width. i.e. Fixed layout.\n            this.tableHolder.fitColumns(containerWidth, tableWidth, isAutoWidth);\n        }\n        //Sets the width to cells\n        this.setWidthToCells(tableWidth, isAutoWidth);\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.setWidthToCells = function (tableWidth, isAutoWidth) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var rw = this.childWidgets[i];\n            var rowFormat = rw.rowFormat;\n            if (rowFormat.gridBefore > 0) {\n                rowFormat.beforeWidth = this.tableHolder.getCellWidth(0, rowFormat.gridBefore, tableWidth);\n            }\n            for (var j = 0; j < rw.childWidgets.length; j++) {\n                var cell = rw.childWidgets[j];\n                // tslint:disable-next-line:max-line-length\n                cell.cellFormat.cellWidth = this.tableHolder.getCellWidth(cell.columnIndex, cell.cellFormat.columnSpan, tableWidth);\n                //By default, if cell preferred widthType is auto , width set based on table width and type is changed to 'Point'\n            }\n            if (rowFormat.gridAfter > 0) {\n                rowFormat.afterWidth = this.tableHolder.getCellWidth(0, rowFormat.gridAfter, tableWidth);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.updateProperties = function (updateAllowAutoFit, currentSelectedTable, autoFitBehavior) {\n        if (updateAllowAutoFit) {\n            this.tableFormat.allowAutoFit = autoFitBehavior !== 'FixedColumnWidth';\n        }\n        if (this !== currentSelectedTable) {\n            currentSelectedTable.updateProperties(false, currentSelectedTable, autoFitBehavior);\n            return;\n        }\n        if (autoFitBehavior === 'FixedColumnWidth') {\n            // Clear the table widths and set the preferred width for cells.\n            this.tableFormat.preferredWidth = 0;\n            this.tableFormat.preferredWidthType = 'Auto';\n            this.childWidgets.forEach(function (row) {\n                row.childWidgets.forEach(function (cell) {\n                    cell.cellFormat.preferredWidthType = 'Point';\n                    cell.cellFormat.preferredWidth = cell.cellFormat.cellWidth;\n                });\n            });\n        }\n        else if (autoFitBehavior === 'FitToWindow') {\n            // Set the preferred width for table and cells in percentage.\n            var tableWidth_1 = this.tableHolder.getTotalWidth(0);\n            this.tableFormat.leftIndent = 0;\n            this.tableFormat.preferredWidth = 100;\n            this.tableFormat.preferredWidthType = 'Percent';\n            this.childWidgets.forEach(function (row) {\n                row.childWidgets.forEach(function (cell) {\n                    if (cell.cellFormat.preferredWidthType !== 'Percent') {\n                        cell.cellFormat.preferredWidthType = 'Percent';\n                        cell.cellFormat.preferredWidth = (cell.cellFormat.cellWidth / tableWidth_1) * 100;\n                    }\n                });\n            });\n        }\n        else {\n            // Clear the preferred width for table and cells.\n            this.tableFormat.preferredWidth = 0;\n            this.tableFormat.preferredWidthType = 'Auto';\n            this.childWidgets.forEach(function (row) {\n                row.rowFormat.beforeWidth = 0;\n                row.rowFormat.gridBefore = 0;\n                row.rowFormat.gridBeforeWidth = 0;\n                row.rowFormat.gridBeforeWidthType = 'Auto';\n                row.rowFormat.afterWidth = 0;\n                row.rowFormat.gridAfter = 0;\n                row.rowFormat.gridAfterWidth = 0;\n                row.rowFormat.gridAfterWidthType = 'Auto';\n                row.childWidgets.forEach(function (cell) {\n                    cell.cellFormat.preferredWidth = 0;\n                    cell.cellFormat.preferredWidthType = 'Auto';\n                });\n            });\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getMaxRowWidth = function (clientWidth) {\n        var width = 0;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            var rowWidth = 0;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                rowWidth += this.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, clientWidth, cell);\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.updateWidth = function (dragValue) {\n        var totalPreferredWidth = this.tableHolder.getTotalWidth(0);\n        var ownerWidth = this.getOwnerWidth(true);\n        var containerWidth = this.getTableClientWidth(ownerWidth);\n        if (containerWidth <= totalPreferredWidth) {\n            if (this.tableFormat.preferredWidthType === 'Auto') {\n                this.tableFormat.preferredWidthType = 'Point';\n            }\n        }\n        if (this.tableFormat.preferredWidthType !== 'Auto') {\n            if (this.tableFormat.preferredWidthType === 'Point') {\n                this.tableFormat.preferredWidth = this.getMaxRowWidth(containerWidth);\n            }\n            else { //ToDo:Need to analyze more the Percentage calculation for table width.\n                var value = (totalPreferredWidth / ownerWidth) * 100;\n                this.tableFormat.preferredWidth = value;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.convertPointToPercent = function (tablePreferredWidth, ownerWidth) {\n        var value = 0;\n        value = (tablePreferredWidth / ownerWidth) * 100;\n        value = Math.round(value);\n        return value < 100 ? value : 100; // The value should be lesser than or equal to 100%;\n    };\n    TableWidget.prototype.updateChildWidgetLeft = function (left) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var rowWidget = this.childWidgets[i];\n            rowWidget.x = left;\n            rowWidget.updateChildWidgetLeft(left);\n        }\n    };\n    /**\n     * Shift the widgets for right to left aligned table.\n     * @private\n     */\n    TableWidget.prototype.shiftWidgetsForRtlTable = function (clientArea, tableWidget) {\n        var clientAreaX = tableWidget.x;\n        var clientAreaRight = clientArea.right;\n        var cellSpace = 0;\n        if (tableWidget.tableFormat && tableWidget.tableFormat.cellSpacing > 0) {\n            cellSpace = tableWidget.tableFormat.cellSpacing;\n        }\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            var rowX = rowWidget.x;\n            var left = clientAreaRight - (rowX - clientAreaX);\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                var cellWidget = rowWidget.childWidgets[j];\n                left = left -\n                    (cellWidget.width + cellWidget.margin.left + cellWidget.margin.right - cellWidget.rightBorderWidth + cellSpace);\n                cellWidget.updateWidgetLeft(left + cellWidget.margin.left);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.clone = function () {\n        var table = new TableWidget();\n        table.tableHolder = this.tableHolder.clone();\n        table.tableFormat.copyFormat(this.tableFormat);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i].clone();\n            table.childWidgets.push(row);\n            row.containerWidget = table;\n            row.index = i;\n        }\n        table.x = this.x;\n        table.y = this.y;\n        table.height = this.height;\n        table.width = this.width;\n        table.containerWidget = this.containerWidget;\n        return table;\n    };\n    /**\n     * @private\n     */\n    TableWidget.getTableOf = function (node) {\n        if (node instanceof WBorders) {\n            var row = TableRowWidget.getRowOf(node);\n            if (!isNullOrUndefined(row)) {\n                return row.ownerTable;\n            }\n            else if (node.ownerBase instanceof WTableFormat && node.ownerBase.ownerBase instanceof TableWidget) {\n                return node.ownerBase.ownerBase;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.fitChildToClientArea = function () {\n        var clientWidth = this.getContainerWidth();\n        if (Math.round(clientWidth) < Math.round(this.getTableWidth())) {\n            this.fitCellsToClientArea(clientWidth);\n        }\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                for (var k = 0; k < cell.childWidgets.length; k++) {\n                    if (cell.childWidgets[k] instanceof TableWidget) {\n                        cell.childWidgets[k].fitChildToClientArea();\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getColumnCellsForSelection = function (startCell, endCell) {\n        var cells = [];\n        var start = startCell.columnIndex;\n        var end = endCell.columnIndex + endCell.cellFormat.columnSpan;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var columnIndex = cell.columnIndex;\n                var columnSpan = cell.cellFormat.columnSpan;\n                if ((columnIndex + columnSpan > start && columnIndex + columnSpan < end) || (columnIndex > start && columnIndex < end)) {\n                    if (cells.indexOf(cell) < 0) {\n                        cells.push(cell);\n                    }\n                }\n                else if ((columnIndex > start && columnIndex < end && columnIndex + columnSpan < end)\n                    || (columnIndex < start && columnIndex + columnSpan > end)) {\n                    if (cells.indexOf(cell) < 0) {\n                        cells.push(cell);\n                    }\n                }\n                else if (columnIndex === start || columnIndex + columnSpan === end) {\n                    if (cells.indexOf(cell) < 0) {\n                        cells.push(cell);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * Splits width equally for all the cells.\n     * @param tableClientWidth\n     * @private\n     */\n    TableWidget.prototype.splitWidthToTableCells = function (tableClientWidth) {\n        for (var row = 0; row < this.childWidgets.length; row++) {\n            this.childWidgets[row].splitWidthToRowCells(tableClientWidth);\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.insertTableRowsInternal = function (tableRows, startIndex) {\n        for (var i = 0; i < tableRows.length; i++) {\n            var row = tableRows.splice(i, 1)[0];\n            row.containerWidget = this;\n            this.childWidgets.splice(startIndex, 0, row);\n            i--;\n        }\n        this.updateRowIndex(startIndex);\n        this.isGridUpdated = false;\n        this.buildTableColumns();\n        this.isGridUpdated = true;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.updateRowIndex = function (startIndex) {\n        for (var i = startIndex; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            row.index = i;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                row.childWidgets[j].index = j;\n                row.childWidgets[j].rowIndex = row.rowIndex;\n            }\n            startIndex++;\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getCellStartOffset = function (cell) {\n        var offset = 0;\n        if (cell && this.tableCellInfo) {\n            if (this.tableCellInfo.containsKey(cell.ownerRow.rowIndex)) {\n                var rowCellInfo = this.tableCellInfo.get(cell.ownerRow.rowIndex);\n                if (rowCellInfo.containsKey(cell.cellIndex)) {\n                    offset = rowCellInfo.get(cell.cellIndex);\n                }\n            }\n        }\n        return offset;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var j = 0; j < this.childWidgets.length; j++) {\n                var widget = undefined;\n                var childWidget = this.childWidgets[j];\n                widget = childWidget;\n                if (!isNullOrUndefined(widget)) {\n                    widget.destroyInternal(viewer);\n                }\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                j--;\n            }\n            this.childWidgets = undefined;\n        }\n        if (!isNullOrUndefined(this.containerWidget)) {\n            if (!isNullOrUndefined(this.containerWidget.childWidgets)) {\n                if (this.containerWidget.childWidgets.indexOf(this) !== -1) {\n                    this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this), 1);\n                }\n                this.containerWidget.height -= height;\n                // if ((isNullOrUndefined(this.containerWidget.childWidgets) || this.containerWidget.childWidgets.length === 0)\n                //     && this.containerWidget instanceof BodyWidget) {\n                //     // (this.containerWidget as BodyWidget).destroyInternal(viewer);\n                // }\n            }\n            this.containerWidget = undefined;\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.destroy = function () {\n        // if (this.tableFormat) {\n        //     this.tableFormat.destroy();\n        // }\n        this.tableFormat = undefined;\n        if (this.spannedRowCollection) {\n            this.spannedRowCollection.destroy();\n        }\n        this.spannedRowCollection = undefined;\n        // if (this.tableHolder) {\n        //     this.tableHolder.destroy();\n        // }\n        this.tableHolder = undefined;\n        this.flags = undefined;\n        this.leftMargin = undefined;\n        this.topMargin = undefined;\n        this.rightMargin = undefined;\n        this.bottomMargin = undefined;\n        this.headerHeight = undefined;\n        this.description = undefined;\n        this.title = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TableWidget;\n}(BlockWidget));\nexport { TableWidget };\n/**\n * @private\n */\nvar TableRowWidget = /** @class */ (function (_super) {\n    __extends(TableRowWidget, _super);\n    function TableRowWidget() {\n        var _this = _super.call(this) || this;\n        _this.topBorderWidth = 0;\n        _this.bottomBorderWidth = 0;\n        _this.rowFormat = new WRowFormat(_this);\n        return _this;\n    }\n    Object.defineProperty(TableRowWidget.prototype, \"rowIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget) {\n                return this.containerWidget.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableRowWidget.prototype, \"ownerTable\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget instanceof TableWidget) {\n                return this.containerWidget;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableRowWidget.prototype, \"nextRow\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.indexInOwner;\n            if (index > -1 && index < this.ownerTable.childWidgets.length - 1) {\n                return this.ownerTable.childWidgets[index + 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.equals = function (widget) {\n        return widget instanceof TableRowWidget && widget.rowFormat === this.rowFormat;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.combineCells = function (viewer) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cell = this.childWidgets[i];\n            cell.combineWidget(viewer);\n            if (cell.cellFormat.rowSpan === 1) {\n                var cellHeight = cell.height + cell.margin.top + cell.margin.bottom;\n                if ((this.height - this.ownerTable.tableFormat.cellSpacing) < cell.height) {\n                    this.height = this.ownerTable.tableFormat.cellSpacing + cell.height;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.getRowOf = function (node) {\n        if (node instanceof WBorders) {\n            var cell = TableCellWidget.getCellOf(node);\n            if (!isNullOrUndefined(cell)) {\n                return cell.ownerRow;\n            }\n            else if (node.ownerBase instanceof WRowFormat && node.ownerBase.ownerBase instanceof TableRowWidget) {\n                return node.ownerBase.ownerBase;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getCell = function (rowIndex, cellIndex) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cell = this.childWidgets[i];\n            if (cell.rowIndex === rowIndex && cell.index === cellIndex) {\n                return cell;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.splitWidthToRowCells = function (tableClientWidth) {\n        var cells = this.childWidgets;\n        var cellWidth = tableClientWidth / cells.length;\n        for (var cell = 0; cell < cells.length; cell++) {\n            cells[cell].cellFormat.preferredWidth = cellWidth;\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getGridCount = function (tableGrid, cell, index, containerWidth) {\n        var prevOffset = 0;\n        var width = 0;\n        var ownerTable = this.ownerTable;\n        var rowFormat = this.rowFormat;\n        if (index === -1) {\n            width = ownerTable.getCellWidth(rowFormat.gridBeforeWidth, rowFormat.gridBeforeWidthType, containerWidth, null);\n        }\n        else {\n            prevOffset += ownerTable.getCellWidth(rowFormat.gridBeforeWidth, rowFormat.gridBeforeWidthType, containerWidth, null);\n            if (index >= 0) {\n                prevOffset += ownerTable.getCellStartOffset(cell);\n            }\n            if (index < this.childWidgets.length) {\n                width = ownerTable.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, containerWidth, null);\n            }\n            else {\n                width = ownerTable.getCellWidth(rowFormat.gridAfterWidth, rowFormat.gridAfterWidthType, containerWidth, null);\n            }\n        }\n        var gridStartIndex = this.getOffsetIndex(tableGrid, prevOffset);\n        var gridEndIndex = this.getOffsetIndex(tableGrid, prevOffset + width);\n        return gridEndIndex - gridStartIndex;\n    };\n    TableRowWidget.prototype.getOffsetIndex = function (tableGrid, offset) {\n        offset = parseFloat(offset.toFixed(2));\n        var index = 0;\n        if (tableGrid.indexOf(offset) >= 0) {\n            index = tableGrid.indexOf(offset);\n        }\n        else {\n            for (var i = 0; i < tableGrid.length; i++) {\n                if (tableGrid[i] > offset) {\n                    return i;\n                }\n            }\n            index = tableGrid.length - 1;\n        }\n        return index;\n    };\n    TableRowWidget.prototype.getCellOffset = function (index, containerWidth) {\n        var prevOffset = 0;\n        var ownerTable = this.ownerTable;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cellFormat = this.childWidgets[i].cellFormat;\n            if (i === index) {\n                break;\n            }\n            prevOffset += ownerTable.getCellWidth(cellFormat.preferredWidth, cellFormat.preferredWidthType, containerWidth, null);\n        }\n        return prevOffset;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.updateRowBySpannedCells = function () {\n        var rowSpannedCells = this.getPreviousRowSpannedCells();\n        var currentRowIndex = this.rowIndex;\n        for (var i = 0; i < rowSpannedCells.length; i++) {\n            var spannedCell = rowSpannedCells[i];\n            var rowSpanEnd = spannedCell.ownerRow.rowIndex + spannedCell.cellFormat.rowSpan - 1;\n            // If current row is row span end or includes spanned cells. then, decrease the rowspan\n            if (rowSpanEnd >= currentRowIndex) {\n                spannedCell.cellFormat.rowSpan -= 1;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getPreviousRowSpannedCells = function (include) {\n        var rowSpannedCells = [];\n        var row = include ? this : this.previousWidget;\n        while (!isNullOrUndefined(row)) {\n            for (var i = 0; i < row.childWidgets.length; i++) {\n                var cell = row.childWidgets[i];\n                if (cell.cellFormat.rowSpan > 1) {\n                    rowSpannedCells.splice(0, 0, cell);\n                }\n            }\n            row = row.previousWidget;\n        }\n        return rowSpannedCells;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getTableCellWidget = function (point) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var x = Math.round(this.childWidgets[i].x);\n            if (x - this.childWidgets[i].margin.left - 1 <= point.x\n                && (x + this.childWidgets[i].width) >= point.x) {\n                return this.childWidgets[i];\n            }\n            else if (i === this.childWidgets.length - 1\n                && (this.childWidgets[i].x + this.childWidgets[i].width) + 1 <= point.x) {\n                return this.childWidgets[i];\n            }\n        }\n        var cellWidget = undefined;\n        if (this.childWidgets.length > 0) {\n            if (this.childWidgets[0].x <= point.x) {\n                cellWidget = this.childWidgets[this.childWidgets.length - 1].getTableCellWidget(point);\n            }\n            else {\n                cellWidget = this.childWidgets[0].getTableCellWidget(point);\n            }\n        }\n        return cellWidget;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getMinimumAndMaximumWordWidth = function (minimumWordWidth, maximumWordWidth) {\n        return { 'minimumWordWidth': minimumWordWidth, 'maximumWordWidth': maximumWordWidth };\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var i = 0; i < this.childWidgets.length; i++) {\n                var widget = this.childWidgets[i];\n                widget.destroyInternal(viewer);\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                i--;\n            }\n            this.childWidgets = undefined;\n        }\n        if (!isNullOrUndefined(this.containerWidget)) {\n            if (!isNullOrUndefined(this.containerWidget.childWidgets)) {\n                this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this), 1);\n                if ((isNullOrUndefined(this.containerWidget.childWidgets) || this.containerWidget.childWidgets.length === 0)\n                    && this.containerWidget instanceof TableWidget) {\n                    this.containerWidget.destroyInternal(viewer);\n                }\n                else if (this.containerWidget.containerWidget instanceof BodyWidget) {\n                    this.containerWidget.containerWidget.height -= height;\n                }\n                this.containerWidget.height -= height;\n            }\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.clone = function () {\n        var row = new TableRowWidget();\n        row.rowFormat.copyFormat(this.rowFormat);\n        row.topBorderWidth = this.topBorderWidth;\n        row.bottomBorderWidth = this.bottomBorderWidth;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cell = this.childWidgets[i].clone();\n            row.childWidgets.push(cell);\n            cell.containerWidget = row;\n            cell.index = i;\n            cell.rowIndex = this.rowIndex;\n        }\n        row.x = this.x;\n        row.y = this.y;\n        row.height = this.height;\n        row.width = this.width;\n        return row;\n    };\n    /**\n     * Updates the child widgets left.\n     * @param left\n     * @private\n     */\n    TableRowWidget.prototype.updateChildWidgetLeft = function (left) {\n        // TODO: Cell spacing calculation.\n        var spacing = 0;\n        if (this.ownerTable.tableFormat.cellSpacing > 0) {\n            spacing = this.ownerTable.tableFormat.cellSpacing;\n        }\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cellWidget = this.childWidgets[i];\n            left += spacing + cellWidget.margin.left;\n            cellWidget.x = left;\n            cellWidget.updateChildWidgetLeft(cellWidget.x);\n            left += cellWidget.width + cellWidget.margin.right;\n        }\n    };\n    /**\n     * Shift the widgets for RTL table.\n     * @param clientArea\n     * @param tableWidget\n     * @param rowWidget\n     * @private\n     */\n    TableRowWidget.prototype.shiftWidgetForRtlTable = function (clientArea, tableWidget, rowWidget) {\n        var clientAreaX = tableWidget.x;\n        var cellSpace = 0;\n        var tableWidth = 0;\n        if (tableWidget.tableFormat != null && tableWidget.tableFormat.cellSpacing > 0) {\n            cellSpace = tableWidget.tableFormat.cellSpacing;\n        }\n        tableWidth = HelperMethods.convertPointToPixel(tableWidget.getTableWidth());\n        var rowX = rowWidget.x;\n        var clientAreaRight = clientAreaX + tableWidth;\n        var left = clientAreaRight - (rowX - clientAreaX);\n        for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n            var cellWidget = rowWidget.childWidgets[j];\n            left = left - (cellWidget.width + cellWidget.margin.left + cellWidget.margin.right - cellWidget.rightBorderWidth + cellSpace);\n            cellWidget.updateWidgetLeft(left + cellWidget.margin.left);\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.destroy = function () {\n        // if (this.rowFormat) {\n        //     this.rowFormat.destroy();\n        // }\n        this.rowFormat = undefined;\n        this.rowFormat = undefined;\n        this.topBorderWidth = undefined;\n        this.bottomBorderWidth = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TableRowWidget;\n}(BlockWidget));\nexport { TableRowWidget };\n/**\n * @private\n */\nvar TableCellWidget = /** @class */ (function (_super) {\n    __extends(TableCellWidget, _super);\n    function TableCellWidget() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.rowIndex = -1;\n        _this.sizeInfoInternal = new ColumnSizeInfo();\n        _this.margin = new Margin(_this.leftMargin, _this.topMargin, _this.rightMargin, _this.bottomMargin);\n        _this.leftBorderWidth = 0;\n        _this.rightBorderWidth = 0;\n        _this.cellFormat = new WCellFormat(_this);\n        return _this;\n    }\n    Object.defineProperty(TableCellWidget.prototype, \"ownerColumn\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.ownerTable.tableHolder.columns[this.columnIndex];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"leftMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.leftMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.leftMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"topMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.topMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.topMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"rightMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.rightMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.rightMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"bottomMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.bottomMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.bottomMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"cellIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.ownerRow) {\n                return this.ownerRow.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"ownerTable\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget instanceof TableRowWidget) {\n                return this.containerWidget.ownerTable;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"ownerRow\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.containerWidget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"sizeInfo\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.sizeInfoInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.equals = function (widget) {\n        return widget instanceof TableCellWidget && widget.cellFormat === this.cellFormat;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getContainerTable = function () {\n        var table = this.ownerTable;\n        while (table instanceof TableWidget && table.associatedCell instanceof TableCellWidget) {\n            table = table.associatedCell.getContainerTable();\n        }\n        return table;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getPreviousSplitWidget = function () {\n        if (this.containerWidget instanceof TableRowWidget) {\n            var row = this.containerWidget;\n            do {\n                row = row.previousRenderedWidget;\n                if (isNullOrUndefined(row) || row.index < this.rowIndex) {\n                    break;\n                }\n                var previousCell = row.getCell(this.rowIndex, this.index);\n                if (previousCell && this.equals(previousCell)) {\n                    return previousCell;\n                }\n            } while (row);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getNextSplitWidget = function () {\n        var rowSpan = this.cellFormat.rowSpan;\n        if (this.containerWidget instanceof TableRowWidget) {\n            var row = this.containerWidget;\n            do {\n                row = row.nextRenderedWidget;\n                if (isNullOrUndefined(row) || row.index > this.rowIndex + rowSpan) {\n                    break;\n                }\n                var nextCell = row.getCell(this.rowIndex, this.index);\n                if (nextCell && this.equals(nextCell)) {\n                    return nextCell;\n                }\n            } while (row);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getTableCellWidget = function (point) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            if (this.childWidgets[i].y <= point.y\n                && (this.childWidgets[i].y + this.childWidgets[i].height) >= point.y) {\n                return this.childWidgets[i].getTableCellWidget(point);\n            }\n        }\n        var tableCellWidget = undefined;\n        if (this.childWidgets.length > 0) {\n            if (this.childWidgets[0].y <= point.y) {\n                tableCellWidget = this.childWidgets[this.childWidgets.length - 1].getTableCellWidget(point);\n            }\n            else {\n                tableCellWidget = this.childWidgets[0].getTableCellWidget(point);\n            }\n        }\n        return tableCellWidget;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.updateWidth = function (preferredWidth) {\n        if (this.cellFormat.preferredWidthType === 'Point') {\n            this.cellFormat.preferredWidth = preferredWidth;\n        }\n        else if (this.cellFormat.preferredWidthType === 'Percent') {\n            this.cellFormat.preferredWidth = this.convertPointToPercent(preferredWidth);\n        }\n        this.cellFormat.cellWidth = preferredWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getCellWidth = function () {\n        var ownerTable = this.ownerTable;\n        var containerWidth = ownerTable ? ownerTable.getTableClientWidth(ownerTable.getOwnerWidth(true)) : 0;\n        var cellWidth = containerWidth;\n        if (ownerTable && ownerTable.tableFormat.preferredWidthType === 'Auto' && ownerTable.tableFormat.allowAutoFit) {\n            cellWidth = containerWidth;\n        }\n        else if (this.cellFormat.preferredWidthType === 'Percent') {\n            cellWidth = (this.cellFormat.preferredWidth * containerWidth) / 100 - this.leftMargin - this.rightMargin;\n        }\n        else if (this.cellFormat.preferredWidthType === 'Point') {\n            cellWidth = this.cellFormat.preferredWidth - this.leftMargin - this.rightMargin;\n        }\n        // For grid before and grid after with auto width, no need to calculate minimum preferred width.\n        return cellWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.convertPointToPercent = function (cellPreferredWidth) {\n        var value = 0;\n        var clientWidth = this.ownerTable.getOwnerWidth(true);\n        var tableWidth = this.ownerTable.getTableClientWidth(clientWidth);\n        value = (cellPreferredWidth / tableWidth) * 100;\n        value = Math.round(value);\n        return value < 100 ? value : 100; // The value should be lesser than or equal to 100%;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellLeftBorder = function (tableCell) {\n        var leftBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.left)) {\n            leftBorder = cellBorder.left;\n        }\n        if (isNullOrUndefined(leftBorder)) {\n            leftBorder = tableCell.getLeftBorderToRenderByHierarchy(leftBorder, rowBorders, tableBorders);\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            leftBorder = tableCell.getLeftBorderToRenderByHierarchy(leftBorder, rowBorders, tableBorders);\n        }\n        else {\n            var prevCell = undefined;\n            if (!isNullOrUndefined(tableCell.previousWidget)) {\n                // if the border is shared then choose the border based on Conflict Resolution algorithm.\n                prevCell = tableCell.previousWidget;\n            }\n            else if ((tableCell.cellFormat.columnSpan > 1 || tableCell.columnIndex > 1) && tableCell.ownerRow.rowIndex > 0) {\n                var previousRow = tableCell.ownerRow.previousWidget;\n                while (!isNullOrUndefined(previousRow) && previousRow.childWidgets.length > 0) {\n                    for (var i = 0; i < previousRow.childWidgets.length; i++) {\n                        var prevRowCell = previousRow.childWidgets[i];\n                        if (prevRowCell.columnIndex + prevRowCell.cellFormat.columnSpan === tableCell.columnIndex) {\n                            prevCell = previousRow.childWidgets[i];\n                            break;\n                        }\n                    }\n                    if (!isNullOrUndefined(prevCell)) {\n                        break;\n                    }\n                    previousRow = previousRow.previousWidget;\n                }\n            }\n            leftBorder = tableCell.getPreviousCellLeftBorder(leftBorder, prevCell);\n        }\n        if (isNullOrUndefined(leftBorder)) {\n            leftBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return leftBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getLeftBorderWidth = function () {\n        var borderWidth = 0;\n        // Added null condition check for asynchronous loading.\n        if (this.cellFormat !== null && this.cellFormat.borders !== null) {\n            // update the margins values respect to layouting of borders.\n            // For normal table cells only left border is rendered. for last cell left and right border is rendered.\n            // this border widths are not included in margins.\n            borderWidth = TableCellWidget.getCellLeftBorder(this).getLineWidth();\n            // tslint:disable-next-line:max-line-length\n            // need to render rightBorder specifically for all the cells when the cellSpacing is greater than zero or for last cell of each row.\n        }\n        return borderWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getRightBorderWidth = function () {\n        var borderWidth = 0;\n        var ownerTable = this.ownerTable;\n        //Added null condition check for asynchronous loading.\n        if (this.cellFormat !== null && this.cellFormat.borders !== null) {\n            borderWidth = TableCellWidget.getCellRightBorder(this).getLineWidth();\n        }\n        return borderWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getCellSpacing = function () {\n        var actualCellSpacing = this.ownerTable && this.ownerTable.tableFormat ? this.ownerTable.tableFormat.cellSpacing : 0;\n        var cellSpacingToLayout = actualCellSpacing;\n        // Considers the left, right margins and border widths(only available for Layouted table) for Minimum width.\n        if (this.ownerRow.childWidgets.length === 1) {\n            cellSpacingToLayout = actualCellSpacing * 2;\n        }\n        else if (this.cellIndex === 0 || this.cellIndex === this.ownerRow.childWidgets.length - 1) {\n            cellSpacingToLayout = actualCellSpacing + (actualCellSpacing / 2);\n        }\n        else {\n            cellSpacingToLayout = actualCellSpacing;\n        }\n        return cellSpacingToLayout;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getCellSizeInfo = function (isAutoFit) {\n        var contentChanged = false;\n        // Gets the minimum preferred width for the table cell.\n        if (!this.sizeInfo.hasMinimumWidth) {\n            this.sizeInfo.minimumWidth = this.getMinimumPreferredWidth();\n        }\n        // Gets the minimum and maximum word widths.\n        if (isAutoFit) {\n            if (!this.sizeInfo.hasMinimumWordWidth || contentChanged) {\n                var size = this.getMinimumAndMaximumWordWidth(0, 0);\n                this.sizeInfo.minimumWordWidth = size.minimumWordWidth + this.sizeInfo.minimumWidth;\n                this.sizeInfo.maximumWordWidth = size.maximumWordWidth + this.sizeInfo.minimumWidth;\n            }\n        }\n        var sizeInfo = new ColumnSizeInfo();\n        sizeInfo.minimumWidth = this.sizeInfo.minimumWidth;\n        sizeInfo.minimumWordWidth = this.sizeInfo.minimumWordWidth;\n        sizeInfo.maximumWordWidth = this.sizeInfo.maximumWordWidth;\n        return sizeInfo;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getMinimumPreferredWidth = function () {\n        var defaultWidth = 0;\n        defaultWidth = this.leftMargin + this.rightMargin + this.getLeftBorderWidth() + this.getRightBorderWidth() + this.getCellSpacing();\n        return defaultWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getPreviousCellLeftBorder = function (leftBorder, previousCell) {\n        // tslint:disable-next-line:max-line-length\n        if ((isNullOrUndefined(previousCell) || (!isNullOrUndefined(leftBorder) && (leftBorder.lineStyle === 'None' && !leftBorder.hasNoneStyle)))) {\n            if (!isNullOrUndefined(leftBorder) && !(leftBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                leftBorder = this.getLeftBorderToRenderByHierarchy(leftBorder, TableRowWidget.getRowOf(leftBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(leftBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        if (isNullOrUndefined(previousCell)) {\n            return leftBorder;\n        }\n        else {\n            var prevCellRightBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(previousCell.cellFormat.borders) && !isNullOrUndefined(previousCell.cellFormat.borders.right) && previousCell.cellFormat.borders.right.lineStyle !== 'None') {\n                prevCellRightBorder = previousCell.cellFormat.borders.right;\n            }\n            if (!isNullOrUndefined(prevCellRightBorder) && prevCellRightBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(prevCellRightBorder, leftBorder);\n            }\n            else if (!isNullOrUndefined(leftBorder) && !(leftBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getLeftBorderToRenderByHierarchy(leftBorder, TableRowWidget.getRowOf(leftBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(leftBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return leftBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getBorderBasedOnPriority = function (border, adjacentBorder) {\n        // If the cell and its adjacent cell defined different borders then based on this algorithm the border choose to render.\n        // Reference link :https://msdn.microsoft.com/en-us/library/office/documentformat.openxml.wordprocessing.tablecellborders.aspx\n        if (isNullOrUndefined(border)) {\n            return adjacentBorder;\n        }\n        else if (isNullOrUndefined(adjacentBorder)) {\n            return border;\n        }\n        var borderWeight = border.getBorderWeight();\n        var adjacentBorderWeight = adjacentBorder.getBorderWeight();\n        //the border with higher wight  shall be displayed.\n        if (borderWeight === adjacentBorderWeight) {\n            //if the border is equal weight the based on the priority the border will be choosen to render.\n            var borderPriority = border.getPrecedence();\n            var adjacentBorderPriority = adjacentBorder.getPrecedence();\n            if (borderPriority === adjacentBorderPriority) {\n                //The color with the smaller brightness value shall be displayed.\n                var borderColInRGB = this.convertHexToRGB(border.color);\n                var R1 = borderColInRGB.r;\n                var G1 = borderColInRGB.g;\n                var B1 = borderColInRGB.b;\n                var adjacentBorderColInRGB = this.convertHexToRGB(adjacentBorder.color);\n                var R2 = adjacentBorderColInRGB.r;\n                var G2 = adjacentBorderColInRGB.g;\n                var B2 = adjacentBorderColInRGB.b;\n                var borderBrightness = (R1 + B1 + (2 * G1));\n                var adjacentBorderBrightness = (R2 + B2 + (2 * G2));\n                if (borderBrightness === adjacentBorderBrightness) {\n                    borderBrightness = (B1 + (2 * G1));\n                    adjacentBorderBrightness = (B2 + (2 * G2));\n                    if (borderBrightness === adjacentBorderBrightness) {\n                        if (G1 === G2) {\n                            return border;\n                        }\n                        else if (G1 > G2) {\n                            return adjacentBorder;\n                        }\n                        else {\n                            return border;\n                        }\n                    }\n                    else if (borderBrightness > adjacentBorderBrightness) {\n                        return adjacentBorder;\n                    }\n                    else {\n                        return border;\n                    }\n                }\n                else if (borderBrightness > adjacentBorderBrightness) {\n                    return adjacentBorder;\n                }\n                else {\n                    return border;\n                }\n            }\n            else if (borderPriority > adjacentBorderPriority) {\n                return border;\n            }\n            else {\n                return adjacentBorder;\n            }\n        }\n        else if (borderWeight > adjacentBorderWeight) {\n            return border;\n        }\n        else {\n            return adjacentBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getLeftBorderToRenderByHierarchy = function (leftBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(leftBorder) && (leftBorder.lineStyle !== 'None' || (leftBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(leftBorder.lineStyle === 'None' && leftBorder.lineWidth === 0 && leftBorder.color === '#000000')))) {\n            return leftBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(leftBorder) && (leftBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(leftBorder.ownerBase).columnIndex === 0) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.left)) {\n                leftBorder = tableBorders.left;\n            }\n            return leftBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.vertical) && rowBorders.vertical.lineStyle !== 'None') {\n            return leftBorder = rowBorders.vertical;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.vertical) && tableBorders.vertical.lineStyle !== 'None') {\n            return leftBorder = tableBorders.vertical;\n        }\n        else {\n            return leftBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellRightBorder = function (tableCell) {\n        var rightBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.right)) {\n            rightBorder = cellBorder.right;\n        }\n        if (isNullOrUndefined(rightBorder)) {\n            rightBorder = tableCell.getRightBorderToRenderByHierarchy(rightBorder, rowBorders, tableBorders);\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            rightBorder = tableCell.getRightBorderToRenderByHierarchy(rightBorder, rowBorders, tableBorders);\n        }\n        else {\n            var nextCell = undefined;\n            if (!isNullOrUndefined(tableCell.nextWidget)) {\n                nextCell = tableCell.nextWidget;\n            }\n            // if the border is shared then choose the border based on Conflict Resolution algorithm.\n            rightBorder = tableCell.getAdjacentCellRightBorder(rightBorder, nextCell);\n        }\n        if (isNullOrUndefined(rightBorder)) {\n            rightBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return rightBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getAdjacentCellRightBorder = function (rightBorder, nextCell) {\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(nextCell) || (!isNullOrUndefined(rightBorder) && (rightBorder.lineStyle === 'None' && !rightBorder.hasNoneStyle))) {\n            if (!isNullOrUndefined(rightBorder) && !(rightBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                rightBorder = this.getRightBorderToRenderByHierarchy(rightBorder, TableRowWidget.getRowOf(rightBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(rightBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        if (isNullOrUndefined(nextCell)) {\n            return rightBorder;\n        }\n        else {\n            var nextCellLeftBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(nextCell.cellFormat.borders) && !isNullOrUndefined(nextCell.cellFormat.borders.left) && nextCell.cellFormat.borders.left.lineStyle !== 'None') {\n                nextCellLeftBorder = nextCell.cellFormat.borders.left;\n            }\n            if (!isNullOrUndefined(nextCellLeftBorder) && nextCellLeftBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(rightBorder, nextCellLeftBorder);\n            }\n            else if (!isNullOrUndefined(rightBorder) && !(rightBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getRightBorderToRenderByHierarchy(rightBorder, TableRowWidget.getRowOf(rightBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(rightBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return rightBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getRightBorderToRenderByHierarchy = function (rightBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(rightBorder) && (rightBorder.lineStyle !== 'None' || (rightBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(rightBorder.lineStyle === 'None' && rightBorder.lineWidth === 0 && rightBorder.color === '#000000')))) {\n            return rightBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(rightBorder) && (rightBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(rightBorder.ownerBase).columnIndex === TableCellWidget.getCellOf(rightBorder.ownerBase).ownerRow.childWidgets.length - 1) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.right)) {\n                rightBorder = tableBorders.right;\n            }\n            return rightBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.vertical) && rowBorders.vertical.lineStyle !== 'None') {\n            return rightBorder = rowBorders.vertical;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.vertical) && tableBorders.vertical.lineStyle !== 'None') {\n            return rightBorder = tableBorders.vertical;\n        }\n        else {\n            return rightBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellTopBorder = function (tableCell) {\n        var topBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.top)) {\n            topBorder = cellBorder.top;\n        }\n        if (isNullOrUndefined(topBorder)) {\n            topBorder = tableCell.getTopBorderToRenderByHierarchy(topBorder, rowBorders, tableBorders);\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            topBorder = tableCell.getTopBorderToRenderByHierarchy(topBorder, rowBorders, tableBorders);\n        }\n        else {\n            var prevTopCell = undefined;\n            //ToDo: Need to analyze more to get the previous cell.\n            var prevRow = tableCell.ownerRow.previousWidget;\n            while (!isNullOrUndefined(prevRow) && prevRow.childWidgets.length > 0) {\n                for (var i = 0; i < prevRow.childWidgets.length; i++) {\n                    var prevRowCell = prevRow.childWidgets[i];\n                    if (prevRowCell.columnIndex + prevRowCell.cellFormat.columnSpan - 1 >= tableCell.columnIndex) {\n                        prevTopCell = prevRow.childWidgets[i];\n                        break;\n                    }\n                }\n                if (!isNullOrUndefined(prevTopCell)) {\n                    break;\n                }\n                prevRow = prevRow.previousWidget;\n                //If all the previous rows checked and the previous top cell is null\n                // then TableCell previus row matched column index cell is taken for border calculation.\n                if (isNullOrUndefined(prevRow) && isNullOrUndefined(prevTopCell)) {\n                    prevRow = tableCell.ownerRow.previousWidget;\n                    if (tableCell.columnIndex < prevRow.childWidgets.length) {\n                        for (var i = 0; i < prevRow.childWidgets.length; i++) {\n                            var prevRowCell = prevRow.childWidgets[i];\n                            if (prevRowCell.columnIndex === tableCell.columnIndex) {\n                                prevTopCell = prevRow.childWidgets[i];\n                                break;\n                            }\n                        }\n                        //If table cell Column index is greater than previous row cells count then last cell is taken as previous top cell.\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        prevTopCell = tableCell.ownerRow.previousWidget.childWidgets[tableCell.ownerRow.previousWidget.childWidgets.length - 1];\n                    }\n                }\n            }\n            //If the border is shared then choose the border based on Conflict Resolution algorithm.\n            topBorder = tableCell.getPreviousCellTopBorder(topBorder, prevTopCell);\n        }\n        if (isNullOrUndefined(topBorder)) {\n            topBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return topBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getPreviousCellTopBorder = function (topBorder, previousTopCell) {\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(previousTopCell) || (!isNullOrUndefined(topBorder) && (topBorder.lineStyle === 'None' && !topBorder.hasNoneStyle))) {\n            if (!isNullOrUndefined(topBorder) && !(topBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                topBorder = this.getTopBorderToRenderByHierarchy(topBorder, TableRowWidget.getRowOf(topBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(topBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        if (isNullOrUndefined(previousTopCell)) {\n            return topBorder;\n        }\n        else {\n            var prevTopCellBottomBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(previousTopCell.cellFormat.borders) && !isNullOrUndefined(previousTopCell.cellFormat.borders.bottom) && previousTopCell.cellFormat.borders.bottom.lineStyle !== 'None') {\n                prevTopCellBottomBorder = previousTopCell.cellFormat.borders.bottom;\n            }\n            if (!isNullOrUndefined(prevTopCellBottomBorder) && prevTopCellBottomBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(topBorder, prevTopCellBottomBorder);\n            }\n            else if (!isNullOrUndefined(topBorder) && !(topBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getTopBorderToRenderByHierarchy(topBorder, TableRowWidget.getRowOf(topBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(topBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return topBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getTopBorderToRenderByHierarchy = function (topBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(topBorder) && (topBorder.lineStyle !== 'None' || (topBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(topBorder.lineStyle === 'None' && topBorder.lineWidth === 0 && topBorder.color === '#000000')))) {\n            return topBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(topBorder) && (topBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(topBorder.ownerBase).ownerRow.rowIndex === 0) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.top)) {\n                topBorder = tableBorders.top;\n            }\n            return topBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.horizontal) && rowBorders.horizontal.lineStyle !== 'None') {\n            return topBorder = rowBorders.horizontal;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.horizontal) && tableBorders.horizontal.lineStyle !== 'None') {\n            return topBorder = tableBorders.horizontal;\n        }\n        else {\n            return topBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellBottomBorder = function (tableCell) {\n        var bottomBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.bottom)) {\n            bottomBorder = cellBorder.bottom;\n        }\n        if (isNullOrUndefined(bottomBorder)) {\n            // tslint:disable-next-line:max-line-length\n            bottomBorder = tableCell.getBottomBorderToRenderByHierarchy(bottomBorder, rowBorders, tableBorders); // select the left border based on heirarchy.\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            bottomBorder = tableCell.getBottomBorderToRenderByHierarchy(bottomBorder, rowBorders, tableBorders);\n        }\n        else {\n            var nextBottomCell = undefined;\n            var nextRow = tableCell.ownerRow.nextWidget;\n            if (!isNullOrUndefined(nextRow) && tableCell.columnIndex < nextRow.childWidgets.length) {\n                nextBottomCell = nextRow.childWidgets[tableCell.columnIndex];\n            }\n            //If the border is shared then choose the border based on Conflict Resolution algorithm.\n            bottomBorder = tableCell.getAdjacentCellBottomBorder(bottomBorder, nextBottomCell);\n        }\n        if (isNullOrUndefined(bottomBorder)) {\n            bottomBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return bottomBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getAdjacentCellBottomBorder = function (bottomBorder, nextBottomCell) {\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(nextBottomCell) || (!isNullOrUndefined(bottomBorder) && (bottomBorder.lineStyle === 'None' && !bottomBorder.hasNoneStyle))) {\n            if (!isNullOrUndefined(bottomBorder) && !(bottomBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                bottomBorder = this.getBottomBorderToRenderByHierarchy(bottomBorder, TableRowWidget.getRowOf(bottomBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(bottomBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        if (isNullOrUndefined(nextBottomCell)) {\n            return bottomBorder;\n        }\n        else {\n            var prevBottomCellTopBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(nextBottomCell.cellFormat.borders) && !isNullOrUndefined(nextBottomCell.cellFormat.borders.top) && nextBottomCell.cellFormat.borders.top.lineStyle !== 'None') {\n                prevBottomCellTopBorder = nextBottomCell.cellFormat.borders.top;\n            }\n            if (!isNullOrUndefined(prevBottomCellTopBorder) && prevBottomCellTopBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(bottomBorder, prevBottomCellTopBorder);\n            }\n            else if (!isNullOrUndefined(bottomBorder) && !(bottomBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getBottomBorderToRenderByHierarchy(bottomBorder, TableRowWidget.getRowOf(bottomBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(bottomBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return bottomBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getBottomBorderToRenderByHierarchy = function (bottomBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(bottomBorder) && (bottomBorder.lineStyle !== 'None' || (bottomBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(bottomBorder.lineStyle === 'None' && bottomBorder.lineWidth === 0 && bottomBorder.color === '#000000')))) {\n            return bottomBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(bottomBorder) && (bottomBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(bottomBorder.ownerBase).ownerRow.rowIndex + TableCellWidget.getCellOf(bottomBorder.ownerBase).cellFormat.rowSpan === TableCellWidget.getCellOf(bottomBorder.ownerBase).ownerTable.childWidgets.length) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.bottom)) {\n                bottomBorder = tableBorders.bottom;\n            }\n            return bottomBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.horizontal) && rowBorders.horizontal.lineStyle !== 'None') {\n            return bottomBorder = rowBorders.horizontal;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.horizontal) && tableBorders.horizontal.lineStyle !== 'None') {\n            return bottomBorder = tableBorders.horizontal;\n        }\n        else {\n            return bottomBorder;\n        }\n    };\n    TableCellWidget.prototype.convertHexToRGB = function (colorCode) {\n        if (colorCode) {\n            colorCode = colorCode.replace(/[^0-9A-â€Œâ€‹F]/gi, ''); // To remove # from color code string.\n            var colCodeNo = parseInt(colorCode, 16);\n            var r = (colCodeNo >> 16) & 255;\n            var g = (colCodeNo >> 8) & 255;\n            var b = colCodeNo & 255;\n            return { 'r': r, 'g': g, 'b': b };\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellOf = function (node) {\n        if (node instanceof WBorders) {\n            if (node.ownerBase instanceof WCellFormat && node.ownerBase.ownerBase instanceof TableCellWidget) {\n                return node.ownerBase.ownerBase;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Updates the Widget left.\n     * @private\n     */\n    TableCellWidget.prototype.updateWidgetLeft = function (x) {\n        this.x = x;\n        this.updateChildWidgetLeft(x);\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.updateChildWidgetLeft = function (left) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            this.childWidgets[i].x = left;\n            if (this.childWidgets[i] instanceof TableWidget) {\n                var tableWidget = this.childWidgets[i];\n                tableWidget.updateChildWidgetLeft(left);\n                if (tableWidget.isBidiTable) {\n                    var clientArea = new Rect(tableWidget.x, tableWidget.y, tableWidget.width, tableWidget.height);\n                    tableWidget.shiftWidgetsForRtlTable(clientArea, tableWidget);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getMinimumAndMaximumWordWidth = function (minimumWordWidth, maximumWordWidth) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var block = this.childWidgets[i];\n            var widthInfo = block.getMinimumAndMaximumWordWidth(minimumWordWidth, maximumWordWidth);\n            minimumWordWidth = widthInfo.minimumWordWidth;\n            maximumWordWidth = widthInfo.maximumWordWidth;\n        }\n        return { 'minimumWordWidth': minimumWordWidth, 'maximumWordWidth': maximumWordWidth };\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.destroyInternal = function (viewer) {\n        // let viewer: LayoutViewer = undefined;\n        // let page: Page = this.getPage();\n        // if (!isNullOrUndefined(page ))\n        //     viewer = page.viewer;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var i = 0; i < this.childWidgets.length; i++) {\n                var widget = this.childWidgets[i];\n                if (widget instanceof ParagraphWidget) {\n                    widget.destroyInternal(viewer);\n                }\n                else {\n                    widget.destroyInternal(viewer);\n                }\n                i--;\n            }\n            this.childWidgets = undefined;\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.clone = function () {\n        var cell = new TableCellWidget();\n        cell.cellFormat.copyFormat(this.cellFormat);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var block = this.childWidgets[i].clone();\n            cell.childWidgets.push(block);\n            block.containerWidget = cell;\n            block.index = i;\n        }\n        cell.leftBorderWidth = this.leftBorderWidth;\n        cell.rightBorderWidth = this.rightBorderWidth;\n        if (this.margin) {\n            cell.margin = this.margin.clone();\n        }\n        cell.columnIndex = this.columnIndex;\n        cell.x = this.x;\n        cell.y = this.y;\n        cell.height = this.height;\n        cell.width = this.width;\n        return cell;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.destroy = function () {\n        // if (this.cellFormat) {\n        //     this.cellFormat.destroy();\n        // }\n        this.cellFormat = undefined;\n        this.rowIndex = undefined;\n        this.columnIndex = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TableCellWidget;\n}(BlockWidget));\nexport { TableCellWidget };\n/**\n * @private\n */\nvar LineWidget = /** @class */ (function () {\n    /**\n     * Initialize the constructor of LineWidget\n     */\n    function LineWidget(paragraphWidget) {\n        /**\n         * @private\n         */\n        this.children = [];\n        /**\n         * @private\n         */\n        this.x = 0;\n        /**\n         * @private\n         */\n        this.y = 0;\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        this.paragraph = paragraphWidget;\n    }\n    Object.defineProperty(LineWidget.prototype, \"indexInOwner\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.paragraph && this.paragraph.childWidgets) {\n                return this.paragraph.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LineWidget.prototype, \"nextLine\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var paragraph = this.paragraph;\n            var lineIndex = this.indexInOwner;\n            if (lineIndex <= paragraph.childWidgets.length - 2) {\n                return paragraph.childWidgets[lineIndex + 1];\n            }\n            else if (paragraph.nextSplitWidget) {\n                var line = paragraph.nextSplitWidget.firstChild;\n                if (line instanceof LineWidget && line.paragraph.equals(this.paragraph)) {\n                    return line;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LineWidget.prototype, \"previousLine\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var paragraph = this.paragraph;\n            var lineIndex = this.indexInOwner;\n            var splitParagraph = paragraph.previousSplitWidget;\n            if (lineIndex > 0) {\n                return paragraph.childWidgets[lineIndex - 1];\n            }\n            else if (splitParagraph instanceof ParagraphWidget) {\n                var line = splitParagraph.lastChild;\n                if (line instanceof LineWidget && line.paragraph.equals(this.paragraph)) {\n                    return line;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LineWidget.prototype, \"isEndsWithPageBreak\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.children.length > 0) {\n                var lastElement = this.children[this.children.length - 1];\n                if (lastElement instanceof TextElementBox) {\n                    return lastElement.isPageBreak;\n                }\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    LineWidget.prototype.isFirstLine = function () {\n        var index = this.indexInOwner;\n        if (index > -1 && this.paragraph.previousSplitWidget === undefined) {\n            return index === 0;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.isLastLine = function () {\n        var index = this.indexInOwner;\n        if (index > -1 && this.paragraph.nextSplitWidget === undefined) {\n            return index === this.paragraph.childWidgets.length - 1;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getOffset = function (inline, index) {\n        if (isNullOrUndefined(inline)) {\n            return index;\n        }\n        var textIndex = index;\n        var line = inline.line;\n        var lineIndex = inline.line.paragraph.childWidgets.indexOf(inline.line);\n        var bidi = line.paragraph.bidi;\n        for (var i = !bidi ? 0 : line.children.length - 1; i > -1 && i < line.children.length; bidi ? i-- : i++) {\n            var inlineElement = line.children[i];\n            if (inline === inlineElement) {\n                break;\n            }\n            if (inlineElement instanceof ListTextElementBox) {\n                continue;\n            }\n            textIndex += inlineElement.length;\n        }\n        return textIndex;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getEndOffset = function () {\n        var startOffset = 0;\n        var count = 0;\n        for (var i = 0; i < this.children.length; i++) {\n            var inlineElement = this.children[i];\n            if (inlineElement.length === 0) {\n                continue;\n            }\n            if (inlineElement instanceof ListTextElementBox) {\n                continue;\n            }\n            if (inlineElement instanceof TextElementBox || inlineElement instanceof ImageElementBox\n                || inlineElement instanceof BookmarkElementBox || (inlineElement instanceof FieldElementBox\n                && HelperMethods.isLinkedFieldCharacter(inlineElement))) {\n                startOffset = count + inlineElement.length;\n            }\n            count += inlineElement.length;\n        }\n        return startOffset;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getInline = function (offset, indexInInline, bidi) {\n        bidi = isNullOrUndefined(bidi) ? this.paragraph.bidi : bidi;\n        var inlineElement = undefined;\n        var count = 0;\n        var isStarted = false;\n        if (this.children.length === 0) {\n            if (this.previousLine) {\n                var elementBox = this.previousLine.children[this.previousLine.children.length - 1];\n                if (elementBox instanceof TextElementBox && elementBox.text === '\\v') {\n                    inlineElement = this.previousLine.children[this.previousLine.children.length - 1];\n                    indexInInline = 1;\n                    return { 'element': inlineElement, 'index': indexInInline };\n                }\n            }\n        }\n        for (var i = !bidi ? 0 : this.children.length - 1; bidi ? i > -1 : i < this.children.length; bidi ? i-- : i++) {\n            inlineElement = this.children[i];\n            if (inlineElement instanceof ListTextElementBox) {\n                continue;\n            }\n            if (!isStarted && (inlineElement instanceof TextElementBox || inlineElement instanceof ImageElementBox\n                || inlineElement instanceof BookmarkElementBox\n                || inlineElement instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inlineElement))) {\n                isStarted = true;\n            }\n            if (isStarted && offset <= count + inlineElement.length) {\n                indexInInline = (offset - count);\n                return { 'element': inlineElement, 'index': indexInInline };\n            }\n            count += inlineElement.length;\n        }\n        if (offset > count) {\n            indexInInline = isNullOrUndefined(inlineElement) ? offset : inlineElement.length;\n        }\n        return { 'element': inlineElement, 'index': indexInInline };\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var node = this;\n        hierarchicalIndex = node.paragraph.childWidgets.indexOf(node) + ';' + hierarchicalIndex;\n        if (node.paragraph instanceof BlockWidget) {\n            return node.paragraph.getHierarchicalIndex(hierarchicalIndex);\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.clone = function () {\n        var line = new LineWidget(undefined);\n        for (var j = 0; j < this.children.length; j++) {\n            var element = this.children[j];\n            var clone = element.clone();\n            line.children.push(clone);\n            clone.line = line;\n        }\n        line.width = this.width;\n        line.height = this.height;\n        return line;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.children)) {\n            for (var i = 0; i < this.children.length; i++) {\n                this.children[i].destroy();\n            }\n            this.children = [];\n        }\n        this.children = undefined;\n        if (this.paragraph) {\n            this.paragraph.removeChild(this.indexInOwner);\n        }\n        this.paragraph = undefined;\n        this.x = undefined;\n        this.y = undefined;\n        this.width = undefined;\n        this.height = undefined;\n    };\n    return LineWidget;\n}());\nexport { LineWidget };\n/**\n * @private\n */\nvar ElementBox = /** @class */ (function () {\n    /**\n     * Initialize the constructor of ElementBox\n     */\n    function ElementBox() {\n        /**\n         * @private\n         */\n        this.x = 0;\n        /**\n         * @private\n         */\n        this.y = 0;\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        /**\n         * @private\n         */\n        this.margin = new Margin(0, 0, 0, 0);\n        /**\n         * @private\n         */\n        this.characterFormat = undefined;\n        /**\n         * @private\n         */\n        this.isRightToLeft = false;\n        this.characterFormat = new WCharacterFormat(this);\n        this.margin = new Margin(0, 0, 0, 0);\n    }\n    Object.defineProperty(ElementBox.prototype, \"isPageBreak\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this instanceof TextElementBox) {\n                return this.text === '\\f';\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldCharacter = function (viewer) {\n        if (!(this instanceof FieldElementBox)) {\n            return;\n        }\n        if (this.fieldType === 0) {\n            var fieldBegin = this;\n            if (isNullOrUndefined(fieldBegin.fieldEnd)) {\n                this.linkFieldTraversingForward(this.line, fieldBegin, fieldBegin);\n                if (viewer.fields.indexOf(fieldBegin) === -1) {\n                    viewer.fields.push(fieldBegin);\n                }\n            }\n        }\n        else if (this.fieldType === 2) {\n            var fieldSeparator = this;\n            //Links the field begin for the current separator.\n            if (isNullOrUndefined(fieldSeparator.fieldBegin)) {\n                this.linkFieldTraversingBackwardSeparator(this.line, fieldSeparator, fieldSeparator);\n            }\n            fieldSeparator.fieldBegin.fieldSeparator = fieldSeparator;\n            if (!isNullOrUndefined(fieldSeparator.fieldBegin)) {\n                //Links to field end traversing from field separator.\n                var isFieldEnd = this.linkFieldTraversingForward(this.line, fieldSeparator.fieldBegin, fieldSeparator);\n                if (isNullOrUndefined(fieldSeparator.fieldEnd) && isFieldEnd) {\n                    fieldSeparator.fieldEnd = fieldSeparator.fieldBegin.fieldEnd;\n                }\n                if (fieldSeparator.fieldEnd) {\n                    fieldSeparator.fieldEnd.fieldSeparator = fieldSeparator;\n                }\n            }\n        }\n        else {\n            var fieldEnd = this;\n            //Links the field begin and separator for the current end.\n            if (isNullOrUndefined(fieldEnd.fieldBegin)) {\n                this.linkFieldTraversingBackward(this.line, fieldEnd, fieldEnd);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldTraversingBackward = function (line, fieldEnd, previousNode) {\n        var k = line.children.length - 1;\n        if (line.children.indexOf(previousNode) > -1) {\n            k = line.children.indexOf(previousNode) - 1;\n        }\n        for (var j = k; j >= 0; j--) {\n            var childNode = line.children[j];\n            if (childNode instanceof FieldElementBox) {\n                if (childNode.fieldType === 0) {\n                    if (isNullOrUndefined(childNode.fieldEnd)) {\n                        fieldEnd.fieldBegin = childNode;\n                        if (isNullOrUndefined(childNode.fieldEnd)) {\n                            childNode.fieldEnd = fieldEnd;\n                        }\n                        if (fieldEnd.fieldSeparator && isNullOrUndefined(fieldEnd.fieldSeparator.fieldBegin)) {\n                            fieldEnd.fieldSeparator.fieldBegin = childNode;\n                            if (isNullOrUndefined(childNode.fieldSeparator)) {\n                                childNode.fieldSeparator = fieldEnd.fieldSeparator;\n                            }\n                        }\n                    }\n                    return !isNullOrUndefined(fieldEnd.fieldBegin);\n                }\n                else if (childNode.fieldType === 2 && isNullOrUndefined(childNode.fieldEnd)) {\n                    fieldEnd.fieldSeparator = childNode;\n                    childNode.fieldEnd = fieldEnd;\n                    if (!isNullOrUndefined(childNode.fieldBegin)) {\n                        fieldEnd.fieldBegin = childNode.fieldBegin;\n                    }\n                }\n            }\n        }\n        if (line.previousLine) {\n            this.linkFieldTraversingBackward(line.previousLine, fieldEnd, this);\n        }\n        else if (line.paragraph.previousRenderedWidget instanceof ParagraphWidget) {\n            var prevParagraph = line.paragraph.previousRenderedWidget;\n            // tslint:disable-next-line:max-line-length\n            this.linkFieldTraversingBackward(prevParagraph.childWidgets[prevParagraph.childWidgets.length - 1], fieldEnd, this);\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldTraversingForward = function (line, fieldBegin, previousNode) {\n        var i = 0;\n        if (line.children.indexOf(previousNode) > -1) {\n            i = line.children.indexOf(previousNode) + 1;\n        }\n        for (var j = i; j < line.children.length; j++) {\n            var node = line.children[j];\n            if (node instanceof FieldElementBox) {\n                if (node.fieldType === 1) {\n                    if (isNullOrUndefined(node.fieldBegin)) {\n                        fieldBegin.fieldEnd = node;\n                    }\n                    if (fieldBegin.fieldEnd && isNullOrUndefined(fieldBegin.fieldEnd.fieldBegin)) {\n                        fieldBegin.fieldEnd.fieldBegin = fieldBegin;\n                    }\n                    return true;\n                }\n                else if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    if (node.fieldType === 2 && isNullOrUndefined(node.fieldBegin)) {\n                        fieldBegin.fieldSeparator = node;\n                        if (!isNullOrUndefined(node.fieldEnd)) {\n                            fieldBegin.fieldEnd = node.fieldEnd;\n                            return true;\n                        }\n                    }\n                    else {\n                        return false;\n                    }\n                }\n            }\n        }\n        if (line.nextLine) {\n            this.linkFieldTraversingForward(line.nextLine, fieldBegin, this);\n        }\n        else if (line.paragraph.nextRenderedWidget instanceof ParagraphWidget) {\n            this.linkFieldTraversingForward(line.paragraph.nextRenderedWidget.childWidgets[0], fieldBegin, this);\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldTraversingBackwardSeparator = function (line, fieldSeparator, previousNode) {\n        var index = line.children.length - 1;\n        if (line.children.indexOf(previousNode) > -1) {\n            index = line.children.indexOf(previousNode) - 1;\n        }\n        for (var i = index; i >= 0; i--) {\n            var childElement = line.children[i];\n            if (childElement instanceof FieldElementBox) {\n                if (childElement instanceof FieldElementBox && childElement.fieldType === 0) {\n                    if (isNullOrUndefined(childElement.fieldSeparator)) {\n                        fieldSeparator.fieldBegin = childElement;\n                    }\n                    return !isNullOrUndefined(fieldSeparator.fieldBegin);\n                }\n            }\n        }\n        if (line.previousLine) {\n            this.linkFieldTraversingBackwardSeparator(line.previousLine, fieldSeparator, this);\n        }\n        else if (line.paragraph.nextRenderedWidget instanceof ParagraphWidget) {\n            // tslint:disable-next-line:max-line-length\n            line = line.paragraph.previousRenderedWidget.childWidgets[line.paragraph.previousRenderedWidget.childWidgets.length - 1];\n            this.linkFieldTraversingBackwardSeparator(line, fieldSeparator, this);\n        }\n        else {\n            return true;\n        }\n        return true;\n    };\n    Object.defineProperty(ElementBox.prototype, \"length\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.getLength();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"indexInOwner\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.line instanceof LineWidget && this.line.children ? this.line.children.indexOf(this) : -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"previousElement\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.indexInOwner;\n            if (index > 0 && index < this.line.children.length) {\n                return this.line.children[index - 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"nextElement\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.indexInOwner;\n            if (index > -1 && index < this.line.children.length - 1) {\n                return this.line.children[index + 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"nextNode\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.line.children.indexOf(this);\n            var lineIndex = this.line.paragraph.childWidgets.indexOf(this.line);\n            if (index < this.line.children.length - 1) {\n                return this.line.children[index + 1];\n            }\n            else if (lineIndex < this.line.paragraph.childWidgets.length - 1) {\n                return this.line.paragraph.childWidgets[lineIndex + 1].children[0];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"previousNode\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.line.children.indexOf(this);\n            var lineIndex = this.line.paragraph.childWidgets.indexOf(this.line);\n            if (index > 0) {\n                return this.line.children[index - 1];\n            }\n            else if (lineIndex > 0) {\n                var lineWidget = this.line.paragraph.childWidgets[lineIndex - 1];\n                return lineWidget.children[lineWidget.children.length - 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"paragraph\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.line) {\n                return this.line.paragraph;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ElementBox.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.line) && this.line.children && this.line.children.indexOf(this) > -1) {\n            var index = this.line.children.indexOf(this);\n            this.line.children.splice(index, 1);\n        }\n        this.line = undefined;\n        if (this.characterFormat) {\n            this.characterFormat.destroy();\n        }\n        this.characterFormat = undefined;\n        if (this.margin) {\n            this.margin.destroy();\n        }\n        this.margin = undefined;\n        this.x = undefined;\n        this.y = undefined;\n        this.width = undefined;\n        this.height = undefined;\n    };\n    /**\n     * @private\n     */\n    ElementBox.objectCharacter = String.fromCharCode(65532);\n    return ElementBox;\n}());\nexport { ElementBox };\n/**\n * @private\n */\nvar FieldElementBox = /** @class */ (function (_super) {\n    __extends(FieldElementBox, _super);\n    function FieldElementBox(type) {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.fieldType = 0;\n        /**\n         * @private\n         */\n        _this.hasFieldEnd = false;\n        _this.fieldBeginInternal = undefined;\n        _this.fieldSeparatorInternal = undefined;\n        _this.fieldEndInternal = undefined;\n        _this.fieldType = type;\n        return _this;\n    }\n    Object.defineProperty(FieldElementBox.prototype, \"fieldBegin\", {\n        get: function () {\n            return this.fieldBeginInternal;\n        },\n        set: function (field) {\n            this.fieldBeginInternal = field;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FieldElementBox.prototype, \"fieldSeparator\", {\n        get: function () {\n            return this.fieldSeparatorInternal;\n        },\n        set: function (field) {\n            this.fieldSeparatorInternal = field;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FieldElementBox.prototype, \"fieldEnd\", {\n        get: function () {\n            return this.fieldEndInternal;\n        },\n        set: function (field) {\n            this.fieldEndInternal = field;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    FieldElementBox.prototype.getLength = function () {\n        return 1;\n    };\n    /**\n     * @private\n     */\n    FieldElementBox.prototype.clone = function () {\n        var field = new FieldElementBox(this.fieldType);\n        field.characterFormat.copyFormat(this.characterFormat);\n        if (this.margin) {\n            field.margin = this.margin.clone();\n        }\n        field.width = this.width;\n        field.height = this.height;\n        return field;\n    };\n    /**\n     * @private\n     */\n    FieldElementBox.prototype.destroy = function () {\n        this.fieldType = undefined;\n        this.hasFieldEnd = undefined;\n        this.fieldBeginInternal = undefined;\n        this.fieldEndInternal = undefined;\n        this.fieldSeparatorInternal = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return FieldElementBox;\n}(ElementBox));\nexport { FieldElementBox };\n/**\n * @private\n */\nvar TextElementBox = /** @class */ (function (_super) {\n    __extends(TextElementBox, _super);\n    function TextElementBox() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.baselineOffset = 0;\n        /**\n         * @private\n         */\n        _this.text = '';\n        return _this;\n    }\n    /**\n     * @private\n     */\n    TextElementBox.prototype.getLength = function () {\n        return this.text ? this.text.length : 0;\n    };\n    /**\n     * @private\n     */\n    TextElementBox.prototype.clone = function () {\n        var span = new TextElementBox();\n        span.characterFormat.copyFormat(this.characterFormat);\n        span.text = this.text;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    /**\n     * @private\n     */\n    TextElementBox.prototype.destroy = function () {\n        this.text = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TextElementBox;\n}(ElementBox));\nexport { TextElementBox };\n/**\n * @private\n */\nvar FieldTextElementBox = /** @class */ (function (_super) {\n    __extends(FieldTextElementBox, _super);\n    function FieldTextElementBox() {\n        var _this = _super.call(this) || this;\n        _this.fieldText = '';\n        return _this;\n    }\n    Object.defineProperty(FieldTextElementBox.prototype, \"text\", {\n        get: function () {\n            return this.fieldText;\n        },\n        set: function (value) {\n            this.fieldText = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    FieldTextElementBox.prototype.clone = function () {\n        var span = new FieldTextElementBox();\n        span.characterFormat.copyFormat(this.characterFormat);\n        span.fieldBegin = this.fieldBegin;\n        span.text = this.text;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    return FieldTextElementBox;\n}(TextElementBox));\nexport { FieldTextElementBox };\n/**\n * @private\n */\nvar TabElementBox = /** @class */ (function (_super) {\n    __extends(TabElementBox, _super);\n    function TabElementBox() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.tabText = '';\n        /**\n         * @private\n         */\n        _this.tabLeader = 'None';\n        return _this;\n    }\n    /**\n     * @private\n     */\n    TabElementBox.prototype.destroy = function () {\n        this.tabText = undefined;\n        this.tabLeader = undefined;\n    };\n    /**\n     * @private\n     */\n    TabElementBox.prototype.clone = function () {\n        var span = new TabElementBox();\n        span.characterFormat.copyFormat(this.characterFormat);\n        span.tabText = this.tabText;\n        span.tabLeader = this.tabLeader;\n        span.text = this.text;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    return TabElementBox;\n}(TextElementBox));\nexport { TabElementBox };\n/**\n * @private\n */\nvar BookmarkElementBox = /** @class */ (function (_super) {\n    __extends(BookmarkElementBox, _super);\n    function BookmarkElementBox(type) {\n        var _this = _super.call(this) || this;\n        _this.bookmarkTypeIn = 0;\n        _this.refereneceIn = undefined;\n        _this.nameIn = '';\n        _this.bookmarkTypeIn = type;\n        return _this;\n    }\n    Object.defineProperty(BookmarkElementBox.prototype, \"bookmarkType\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.bookmarkTypeIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BookmarkElementBox.prototype, \"name\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.nameIn;\n        },\n        /**\n         * @private\n         */\n        set: function (name) {\n            this.nameIn = name;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BookmarkElementBox.prototype, \"reference\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.refereneceIn;\n        },\n        /**\n         * @private\n         */\n        set: function (reference) {\n            this.refereneceIn = reference;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    BookmarkElementBox.prototype.getLength = function () {\n        return 1;\n    };\n    /**\n     * @private\n     */\n    BookmarkElementBox.prototype.destroy = function () {\n        this.name = undefined;\n        this.reference = undefined;\n        this.bookmarkTypeIn = undefined;\n    };\n    /**\n     * Clones the bookmark element box.\n     * @param element - book mark element\n     */\n    /**\n     * @private\n     */\n    BookmarkElementBox.prototype.clone = function () {\n        var span = new BookmarkElementBox(this.bookmarkType);\n        span.name = this.name;\n        span.reference = this.reference;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    return BookmarkElementBox;\n}(ElementBox));\nexport { BookmarkElementBox };\n/**\n * @private\n */\nvar ImageElementBox = /** @class */ (function (_super) {\n    __extends(ImageElementBox, _super);\n    function ImageElementBox(isInlineImage) {\n        var _this = _super.call(this) || this;\n        _this.imageStr = '';\n        _this.imgElement = undefined;\n        _this.isInlineImageIn = true;\n        /**\n         * @private\n         */\n        _this.isMetaFile = false;\n        _this.isInlineImageIn = isInlineImage;\n        return _this;\n    }\n    Object.defineProperty(ImageElementBox.prototype, \"isInlineImage\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.isInlineImageIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageElementBox.prototype, \"element\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.imgElement)) {\n                this.imgElement = document.createElement('img');\n            }\n            return this.imgElement;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageElementBox.prototype, \"length\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return 1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageElementBox.prototype, \"imageString\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.imageStr;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.imageStr = value;\n            if (!isNullOrUndefined(value)) {\n                this.element.src = this.imageStr;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ImageElementBox.prototype.getLength = function () {\n        return 1;\n    };\n    /**\n     * @private\n     */\n    ImageElementBox.prototype.clone = function () {\n        var image = new ImageElementBox(this.isInlineImage);\n        image.characterFormat.copyFormat(this.characterFormat);\n        image.imageString = this.imageString;\n        image.isMetaFile = this.isMetaFile;\n        image.width = this.width;\n        image.height = this.height;\n        if (this.margin) {\n            image.margin = this.margin.clone();\n        }\n        return image;\n    };\n    /**\n     * @private\n     */\n    ImageElementBox.prototype.destroy = function () {\n        this.imgElement = undefined;\n        this.imageString = undefined;\n        this.isInlineImageIn = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return ImageElementBox;\n}(ElementBox));\nexport { ImageElementBox };\n/**\n * @private\n */\nvar ListTextElementBox = /** @class */ (function (_super) {\n    __extends(ListTextElementBox, _super);\n    function ListTextElementBox(listLevel, isListFollowCharacter) {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.baselineOffset = 0;\n        /**\n         * @private\n         */\n        _this.isFollowCharacter = false;\n        _this.listLevel = listLevel;\n        _this.isFollowCharacter = isListFollowCharacter;\n        return _this;\n    }\n    /**\n     * @private\n     */\n    ListTextElementBox.prototype.getLength = function () {\n        return this.text ? this.text.length : 0;\n    };\n    /**\n     * @private\n     */\n    ListTextElementBox.prototype.clone = function () {\n        var list = new ListTextElementBox(this.listLevel, this.isFollowCharacter);\n        list.text = this.text;\n        list.baselineOffset = this.baselineOffset;\n        if (this.margin) {\n            list.margin = this.margin.clone();\n        }\n        list.width = this.width;\n        list.height = this.height;\n        return list;\n    };\n    /**\n     * @private\n     */\n    ListTextElementBox.prototype.destroy = function () {\n        this.text = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return ListTextElementBox;\n}(ElementBox));\nexport { ListTextElementBox };\n/**\n * @private\n */\nvar Page = /** @class */ (function () {\n    /**\n     * Initialize the constructor of Page\n     */\n    function Page() {\n        /**\n         * Specifies the Bonding Rectangle\n         * @private\n         */\n        this.boundingRectangle = new Rect(96, 96, 816, 1056);\n        /**\n         * @private\n         */\n        this.repeatHeaderRowTableWidget = false;\n        /**\n         * Specifies the bodyWidgets\n         * @default []\n         * @private\n         */\n        this.bodyWidgets = [];\n        /**\n         * @private\n         */\n        this.headerWidget = undefined;\n        /**\n         * @private\n         */\n        this.footerWidget = undefined;\n        // let text: string = 'DocumentEditor';\n    }\n    Object.defineProperty(Page.prototype, \"index\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.viewer) {\n                return this.viewer.pages.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Page.prototype, \"previousPage\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.index;\n            if (index > 0) {\n                return this.viewer.pages[index - 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Page.prototype, \"nextPage\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.index;\n            if (index < this.viewer.pages.length - 1) {\n                return this.viewer.pages[index + 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Page.prototype, \"sectionIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.bodyWidgets.length > 0) {\n                return this.bodyWidgets[0].index;\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Page.prototype.destroy = function () {\n        if (this.headerWidget) {\n            if (this.viewer && this.viewer.owner.editor) {\n                this.viewer.owner.editor.removeFieldInWidget(this.headerWidget);\n            }\n            this.headerWidget.destroy();\n        }\n        this.headerWidget = undefined;\n        if (this.footerWidget) {\n            if (this.viewer && this.viewer.owner.editor) {\n                this.viewer.owner.editor.removeFieldInWidget(this.footerWidget);\n            }\n            this.footerWidget.destroy();\n        }\n        this.footerWidget = undefined;\n        this.bodyWidgets = [];\n        this.bodyWidgets = undefined;\n        if (!isNullOrUndefined(this.viewer)) {\n            if (!isNullOrUndefined(this.viewer.pages)) {\n                this.viewer.removePage(this);\n            }\n        }\n        this.viewer = undefined;\n    };\n    return Page;\n}());\nexport { Page };\n/**\n * @private\n */\nvar WTableHolder = /** @class */ (function () {\n    function WTableHolder() {\n        this.tableColumns = [];\n        /**\n         * @private\n         */\n        this.tableWidth = 0;\n    }\n    Object.defineProperty(WTableHolder.prototype, \"columns\", {\n        get: function () {\n            return this.tableColumns;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    WTableHolder.prototype.resetColumns = function () {\n        for (var i = 0; i < this.tableColumns.length; i++) {\n            this.tableColumns[i].destroy();\n        }\n        this.tableColumns = [];\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.getPreviousSpannedCellWidth = function (previousColumnIndex, curColumnIndex) {\n        var width = 0;\n        for (var i = previousColumnIndex; i < curColumnIndex; i++) {\n            width += this.tableColumns[i].preferredWidth;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.addColumns = function (currentColumnIndex, columnSpan, width, sizeInfo, offset) {\n        for (var i = this.columns.length; i < columnSpan; i++) {\n            this.columns.push(new WColumn());\n        }\n        var availableWidth = 0;\n        for (var j = currentColumnIndex; j < columnSpan; j++) {\n            availableWidth += this.columns[j].preferredWidth;\n        }\n        // If width to add is greater than preferred width, then preferred width will be increased.\n        // In case of Grid span > 1, only last grid column width will be updated.\n        var gridSpan = columnSpan - currentColumnIndex;\n        if (!(gridSpan > 1) && availableWidth < width) {\n            this.columns[columnSpan - 1].preferredWidth += (width - availableWidth);\n        }\n        if (sizeInfo.minimumWordWidth > this.columns[columnSpan - 1].minimumWordWidth) {\n            this.columns[columnSpan - 1].minimumWordWidth = sizeInfo.minimumWordWidth;\n        }\n        if (sizeInfo.maximumWordWidth > this.columns[columnSpan - 1].maximumWordWidth) {\n            this.columns[columnSpan - 1].maximumWordWidth = sizeInfo.maximumWordWidth;\n        }\n        if (sizeInfo.minimumWidth > this.columns[columnSpan - 1].minimumWidth) {\n            this.columns[columnSpan - 1].minimumWidth = sizeInfo.minimumWidth;\n        }\n        if (offset > this.columns[columnSpan - 1].endOffset) {\n            this.columns[columnSpan - 1].endOffset = offset;\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.getTotalWidth = function (type) {\n        var width = 0;\n        for (var i = 0; i < this.columns.length; i++) {\n            var column = this.columns[i];\n            width += type === 0 ? column.preferredWidth :\n                type === 1 ? column.minimumWordWidth :\n                    type === 2 ? column.maximumWordWidth : column.minimumWidth;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.isFitColumns = function (containerWidth, preferredTableWidth, isAutoWidth) {\n        // Gets total preferred width.\n        var totalColumnWidth = this.getTotalWidth(0);\n        // If auto table width, based on total column widths, minimum value will be updated.\n        if (isAutoWidth) {\n            this.tableWidth = preferredTableWidth > totalColumnWidth ? totalColumnWidth : preferredTableWidth;\n        }\n        else {\n            this.tableWidth = preferredTableWidth;\n        }\n        // If total columns width doesn't match table width, then all grid column widths will be updated by even factor.\n        // If totalColumnWidth < TableWidth, all grid columns are enlarged. Otherwise shrinked.\n        if (totalColumnWidth !== this.tableWidth) {\n            var factor = this.tableWidth / totalColumnWidth;\n            factor = isNaN(factor) ? 1 : factor;\n            for (var i = 0; i < this.columns.length; i++) {\n                var column = this.columns[i];\n                //column.PreferredWidth = factor * column.PreferredWidth;\n                if (factor * column.preferredWidth < column.minWidth) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        else {\n            return true;\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.autoFitColumn = function (containerWidth, preferredTableWidth, isAuto, isNestedTable) {\n        // Cell's preferred width should be considered until the table width fits to the container width.\n        var maxTotal = 0;\n        var minTotal = 0;\n        // For preferred width set as 0 pixels (not auto), then minimum word width only need to be considered.\n        // But currently there is no way to find any one of cell in particular column has 0 px preferred width set.\n        // If all columns are set as 0 pixels, then this will work.\n        var remainingWidthTotal = 0;\n        for (var i = 0; i < this.columns.length; i++) {\n            var column = this.columns[i];\n            maxTotal += column.preferredWidth > column.maximumWordWidth ? column.preferredWidth : column.maximumWordWidth;\n            minTotal += column.preferredWidth > column.minimumWordWidth ? column.preferredWidth : column.minimumWordWidth;\n            // tslint:disable-next-line:max-line-length\n            var preferred = column.preferredWidth === 0 ? column.minimumWordWidth : column.preferredWidth > column.minimumWordWidth ? column.preferredWidth : column.minimumWordWidth;\n            var difference = column.maximumWordWidth - preferred;\n            remainingWidthTotal += difference > 0 ? difference : 0;\n        }\n        // Try to fit maximum word width to match preferredTableWidth.\n        if (maxTotal <= preferredTableWidth) {\n            for (var i = 0; i < this.columns.length; i++) {\n                var column = this.columns[i];\n                if (column.preferredWidth < column.maximumWordWidth) {\n                    if (isNestedTable) {\n                        column.preferredWidth = column.minimumWidth + column.minimumWordWidth;\n                    }\n                    else {\n                        column.preferredWidth = column.maximumWordWidth;\n                    }\n                }\n            }\n            // If the width is defined for table(cells undefined) then fit the columns to preferred table width using FitColumns.\n            if (!isAuto) {\n                this.fitColumns(containerWidth, preferredTableWidth, isAuto);\n            }\n        }\n        else {\n            // If the table preferred table width is set, then check its greater than total minimum word width. \n            // tslint:disable-next-line:max-line-length\n            // If yes then set table preferred table width as container width. Else, check whether the total minimum word width is less than container width.\n            // If yes, then set total minimum word width as container width. Else, set the container width to container width.\n            if (!isAuto) {\n                var totalMinimumWordWidth = this.getTotalWidth(1);\n                // tslint:disable-next-line:max-line-length\n                containerWidth = preferredTableWidth < totalMinimumWordWidth ? totalMinimumWordWidth < containerWidth ? totalMinimumWordWidth : containerWidth : preferredTableWidth;\n            }\n            // Try to fit minimum word width to match preferredTableWidth or containerWidth.\n            if (minTotal <= preferredTableWidth || minTotal <= containerWidth) {\n                var availableWidth = containerWidth > preferredTableWidth ? containerWidth : preferredTableWidth;\n                availableWidth = availableWidth - minTotal;\n                for (var i = 0; i < this.columns.length; i++) {\n                    var column = this.columns[i];\n                    if (column.preferredWidth === 0) {\n                        column.preferredWidth = column.minimumWordWidth;\n                    }\n                    else {\n                        if (column.preferredWidth < column.minimumWordWidth) {\n                            column.preferredWidth = column.minimumWordWidth;\n                        }\n                        if (!isNestedTable) {\n                            var difference = column.maximumWordWidth - column.preferredWidth;\n                            difference = difference > 0 ? difference : 0;\n                            var factor = availableWidth * (difference / remainingWidthTotal);\n                            column.preferredWidth += isNaN(factor) ? 0 : factor;\n                        }\n                    }\n                }\n            }\n            else {\n                // Try to fit minimum width for each column and allot remaining space to columns based on their minimum word width.\n                var totalMinimumWordWidth = this.getTotalWidth(1);\n                var totalMinWidth = this.getTotalWidth(3);\n                if (totalMinWidth > 2112) {\n                    var cellWidth = 2112 / this.columns.length;\n                    for (var i = 0; i < this.columns.length; i++) {\n                        this.columns[i].preferredWidth = cellWidth;\n                    }\n                }\n                else {\n                    var availableWidth = totalMinWidth < containerWidth ? (containerWidth - totalMinWidth) : 0;\n                    for (var i = 0; i < this.columns.length; i++) {\n                        var column = this.columns[i];\n                        // The factor depends of current column's minimum word width and total minimum word width.\n                        var factor = availableWidth * column.minimumWordWidth / totalMinimumWordWidth;\n                        factor = isNaN(factor) ? 0 : factor;\n                        column.preferredWidth = column.minimumWidth + factor;\n                    }\n                }\n            }\n        }\n        this.tableWidth = this.getTotalWidth(0);\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.fitColumns = function (containerWidth, preferredTableWidth, isAutoWidth) {\n        // Gets total preferred width.\n        var totalColumnWidth = this.getTotalWidth(0);\n        // If auto table width, based on total column widths, minimum value will be updated.\n        if (isAutoWidth) {\n            this.tableWidth = preferredTableWidth > totalColumnWidth ? totalColumnWidth : preferredTableWidth;\n        }\n        else {\n            this.tableWidth = preferredTableWidth;\n        }\n        // If total columns width doesn't match table width, then all grid column widths will be updated by even factor.\n        // If totalColumnWidth < TableWidth, all grid columns are enlarged. Otherwise shrinked.\n        if (totalColumnWidth !== this.tableWidth) {\n            var factor = this.tableWidth / totalColumnWidth;\n            for (var i = 0; i < this.columns.length; i++) {\n                var column = this.columns[i];\n                column.preferredWidth = factor * column.preferredWidth;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.getCellWidth = function (columnIndex, columnSpan, preferredTableWidth) {\n        var width = 0;\n        for (var i = 0; i < columnSpan; i++) {\n            width += this.tableColumns[i + columnIndex].preferredWidth;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.validateColumnWidths = function () {\n        for (var i = 0; i < this.columns.length; i++) {\n            if (i === 0) {\n                if (this.columns[i].preferredWidth !== this.columns[i].endOffset) {\n                    this.columns[i].preferredWidth = this.columns[i].endOffset;\n                }\n            }\n            else {\n                // If Previous column offset + current column preferred width is less than current column offset, \n                // Then current column preferred width is set to current column offset - previous column offset.\n                if (this.columns[i - 1].endOffset + this.columns[i].preferredWidth < this.columns[i].endOffset) {\n                    this.columns[i].preferredWidth = this.columns[i].endOffset - this.columns[i - 1].endOffset;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.clone = function () {\n        var tableHolder = new WTableHolder();\n        tableHolder.tableWidth = this.tableWidth;\n        for (var i = 0; i < this.columns.length; i++) {\n            tableHolder.columns.push(this.columns[i].clone());\n        }\n        return tableHolder;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.tableColumns)) {\n            for (var i = 0; i < this.tableColumns.length; i++) {\n                var column = this.tableColumns[i];\n                column.destroy();\n            }\n        }\n        this.tableColumns = [];\n        this.tableColumns = undefined;\n        this.tableWidth = undefined;\n    };\n    return WTableHolder;\n}());\nexport { WTableHolder };\n/**\n * @private\n */\nvar WColumn = /** @class */ (function () {\n    function WColumn() {\n        /**\n         * @private\n         */\n        this.preferredWidth = 0;\n        /**\n         * @private\n         */\n        this.minWidth = 0;\n        /**\n         * @private\n         */\n        this.maxWidth = 0;\n        /**\n         * @private\n         */\n        this.endOffset = 0;\n        /**\n         * @private\n         */\n        this.minimumWordWidth = 0;\n        /**\n         * @private\n         */\n        this.maximumWordWidth = 0;\n        /**\n         * @private\n         */\n        this.minimumWidth = 0;\n    }\n    /**\n     * @private\n     */\n    WColumn.prototype.clone = function () {\n        var column = new WColumn();\n        column.preferredWidth = this.preferredWidth;\n        column.minWidth = this.minWidth;\n        column.maxWidth = this.maxWidth;\n        return column;\n    };\n    /**\n     * @private\n     */\n    WColumn.prototype.destroy = function () {\n        this.preferredWidth = undefined;\n        this.minWidth = undefined;\n        this.maxWidth = undefined;\n    };\n    return WColumn;\n}());\nexport { WColumn };\n/**\n * @private\n */\nvar ColumnSizeInfo = /** @class */ (function () {\n    function ColumnSizeInfo() {\n        /**\n         * @private\n         */\n        this.minimumWordWidth = 0;\n        /**\n         * @private\n         */\n        this.maximumWordWidth = 0;\n        /**\n         * @private\n         */\n        this.minimumWidth = 0;\n        /**\n         * @private\n         */\n        this.hasMinimumWidth = false;\n        /**\n         * @private\n         */\n        this.hasMinimumWordWidth = false;\n        /**\n         * @private\n         */\n        this.hasMaximumWordWidth = false;\n    }\n    return ColumnSizeInfo;\n}());\nexport { ColumnSizeInfo };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Rect, ImageElementBox, ParagraphWidget, ListTextElementBox, TableRowWidget, TableWidget, TableCellWidget, FieldElementBox, TabElementBox } from './page';\nimport { Layout } from './layout';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar Renderer = /** @class */ (function () {\n    function Renderer(viewer) {\n        this.isPrinting = false;\n        this.pageLeft = 0;\n        this.pageTop = 0;\n        this.isFieldCode = false;\n        this.viewer = viewer;\n    }\n    Object.defineProperty(Renderer.prototype, \"pageCanvas\", {\n        /**\n         * Gets page canvas.\n         * @private\n         */\n        get: function () {\n            if (this.isPrinting) {\n                if (isNullOrUndefined(this.pageCanvasIn)) {\n                    this.pageCanvasIn = document.createElement('canvas');\n                    this.pageCanvasIn.getContext('2d').save();\n                }\n                return this.pageCanvasIn;\n            }\n            return isNullOrUndefined(this.viewer) ? undefined : this.viewer.containerCanvas;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"selectionCanvas\", {\n        /**\n         * Gets selection canvas.\n         */\n        get: function () {\n            return isNullOrUndefined(this.viewer) ? undefined : this.viewer.selectionCanvas;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"pageContext\", {\n        /**\n         * Gets page context.\n         */\n        get: function () {\n            return this.pageCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"selectionContext\", {\n        /**\n         * Gets selection context.\n         */\n        get: function () {\n            return this.selectionCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Gets the color.\n     * @private\n     */\n    Renderer.prototype.getColor = function (color) {\n        if (color.length > 0) {\n            if (color[0] === '#') {\n                if (color.length > 7) {\n                    return color.substr(0, 7);\n                }\n            }\n        }\n        return color;\n    };\n    /**\n     * Renders widgets.\n     * @param {Page} page\n     * @param {number} left\n     * @param {number} top\n     * @param {number} width\n     * @param {number} height\n     * @private\n     */\n    Renderer.prototype.renderWidgets = function (page, left, top, width, height) {\n        if (isNullOrUndefined(this.pageCanvas) || isNullOrUndefined(page)) {\n            return;\n        }\n        this.pageContext.fillStyle = this.getColor(this.viewer.backgroundColor);\n        this.pageContext.beginPath();\n        this.pageContext.fillRect(left, top, width, height);\n        this.pageContext.closePath();\n        this.pageContext.strokeStyle = this.viewer.owner.pageOutline;\n        this.pageContext.strokeRect(left, top, width, height);\n        this.pageLeft = left;\n        this.pageTop = top;\n        if (this.isPrinting) {\n            this.setPageSize(page);\n        }\n        else {\n            this.pageContext.beginPath();\n            this.pageContext.save();\n            this.pageContext.rect(left, top, width, height);\n            this.pageContext.clip();\n        }\n        if (page.headerWidget) {\n            this.renderHFWidgets(page, page.headerWidget, width, true);\n        }\n        if (page.footerWidget) {\n            this.renderHFWidgets(page, page.footerWidget, width, false);\n        }\n        for (var i = 0; i < page.bodyWidgets.length; i++) {\n            this.render(page, page.bodyWidgets[i]);\n        }\n        if (this.viewer.owner.enableHeaderAndFooter && !this.isPrinting) {\n            this.renderHeaderSeparator(page, this.pageLeft, this.pageTop, page.headerWidget);\n        }\n        this.pageLeft = 0;\n        this.pageTop = 0;\n        this.pageContext.restore();\n    };\n    /**\n     * Sets page size.\n     * @param {Page} page\n     */\n    Renderer.prototype.setPageSize = function (page) {\n        this.pageContext.clearRect(0, 0, this.pageCanvas.width, this.pageCanvas.height);\n        this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        this.pageContext.restore();\n        this.selectionContext.restore();\n        var width = page.boundingRectangle.width;\n        var height = page.boundingRectangle.height;\n        var dpr = Math.max(1, window.devicePixelRatio || 1);\n        if (this.pageCanvas.width !== width * dpr || this.pageCanvas.height !== height * dpr) {\n            this.pageCanvas.height = height * dpr;\n            this.pageCanvas.width = width * dpr;\n            this.pageCanvas.style.height = height + 'px';\n            this.pageCanvas.style.width = width + 'px';\n            this.pageContext.globalAlpha = 1;\n            this.pageContext.scale(dpr, dpr);\n        }\n    };\n    /**\n     * Renders header footer widget.\n     * @param {Page} page\n     * @param {HeaderFooterWidget} headFootWidget\n     */\n    Renderer.prototype.renderHFWidgets = function (page, widget, width, isHeader) {\n        this.pageContext.globalAlpha = this.viewer.owner.enableHeaderAndFooter ? 1 : 0.65;\n        var cliped = false;\n        if (isHeader) {\n            var topMargin = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin);\n            var widgetHeight = Math.max((widget.y + widget.height), topMargin);\n            var headerFooterHeight = page.boundingRectangle.height / 100 * 40;\n            if (widgetHeight > headerFooterHeight) {\n                cliped = true;\n                this.pageContext.beginPath();\n                this.pageContext.save();\n                this.pageContext.rect(this.pageLeft, this.pageTop, width, this.getScaledValue(headerFooterHeight));\n                this.pageContext.clip();\n            }\n        }\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var block = widget.childWidgets[i];\n            this.renderWidget(page, block);\n        }\n        if (cliped) {\n            this.pageContext.restore();\n        }\n        this.pageContext.globalAlpha = this.viewer.owner.enableHeaderAndFooter ? 0.65 : 1;\n    };\n    Renderer.prototype.renderHeaderSeparator = function (page, left, top, widget) {\n        //Header Widget\n        var topMargin = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin);\n        var y = this.getScaledValue(Math.max((widget.y + widget.height), topMargin));\n        var pageWidth = this.getScaledValue(page.boundingRectangle.width);\n        var ctx = this.pageContext;\n        ctx.save();\n        ctx.globalAlpha = 0.65;\n        var headerFooterHeight = (this.getScaledValue(page.boundingRectangle.height) / 100) * 40;\n        //Maximum header height limit       \n        y = Math.min(y, headerFooterHeight);\n        //Dash line Separator\n        this.renderDashLine(ctx, left, top + y, pageWidth, '#000000', false);\n        var type = this.getHeaderFooterType(page, true);\n        ctx.font = '9pt Arial';\n        var width = ctx.measureText(type).width;\n        this.renderHeaderFooterMark(ctx, left + 5, top + y, width + 10, 20);\n        this.renderHeaderFooterMarkText(ctx, type, left + 10, y + top + 15);\n        if (page.footerWidget) {\n            //Footer Widget\n            var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n            // tslint:disable-next-line:max-line-length\n            var footerHeight = this.getScaledValue(page.boundingRectangle.height) -\n                this.getScaledValue(Math.max(page.footerWidget.height + footerDistance, HelperMethods.convertPointToPixel(page.footerWidget.sectionFormat.bottomMargin)));\n            //Maximum footer height limit     \n            footerHeight = Math.max((this.getScaledValue(page.boundingRectangle.height) - headerFooterHeight), footerHeight);\n            this.renderDashLine(ctx, left, top + footerHeight, pageWidth, '#000000', false);\n            type = this.getHeaderFooterType(page, false);\n            width = ctx.measureText(type).width;\n            this.renderHeaderFooterMark(ctx, left + 5, top + footerHeight - 20, width + 10, 20);\n            this.renderHeaderFooterMarkText(ctx, type, left + 10, top + footerHeight - 5);\n            ctx.restore();\n        }\n    };\n    Renderer.prototype.getHeaderFooterType = function (page, isHeader) {\n        var type;\n        type = isHeader ? 'Header' : 'Footer';\n        if (page.bodyWidgets[0].sectionFormat.differentFirstPage && this.viewer.pages.indexOf(page) === 0) {\n            type = isHeader ? 'First Page Header' : 'First Page Footer';\n        }\n        else if (page.bodyWidgets[0].sectionFormat.differentOddAndEvenPages) {\n            if ((this.viewer.pages.indexOf(page) + 1) % 2 === 0) {\n                type = isHeader ? 'Even Page Header' : 'Even Page Footer';\n            }\n            else {\n                type = isHeader ? 'Odd Page Header' : 'Odd Page Footer';\n            }\n        }\n        return type;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderDashLine = function (ctx, x, y, width, fillStyle, isSmallDash) {\n        ctx.beginPath();\n        ctx.strokeStyle = fillStyle;\n        ctx.lineWidth = 1;\n        if (isSmallDash) {\n            ctx.setLineDash([3, 2]);\n        }\n        else {\n            ctx.setLineDash([6, 4]);\n        }\n        ctx.moveTo(x, y);\n        ctx.lineTo(x + width, y);\n        ctx.stroke();\n        ctx.setLineDash([]);\n        ctx.closePath();\n    };\n    Renderer.prototype.renderHeaderFooterMark = function (ctx, x, y, w, h) {\n        ctx.beginPath();\n        ctx.fillStyle = 'lightgray';\n        ctx.fillRect(x, y, w, h);\n        ctx.strokeStyle = 'black';\n        ctx.strokeRect(x, y, w, h);\n        ctx.closePath();\n    };\n    Renderer.prototype.renderHeaderFooterMarkText = function (ctx, content, x, y) {\n        ctx.beginPath();\n        ctx.fillStyle = '#000000';\n        ctx.textBaseline = 'alphabetic';\n        ctx.fillText(content, x, y);\n        ctx.closePath();\n    };\n    /**\n     * Renders body widget.\n     * @param {Page} page\n     * @param {BodyWidget} bodyWidget\n     */\n    Renderer.prototype.render = function (page, bodyWidget) {\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var widget = bodyWidget.childWidgets[i];\n            if (i === 0 && bodyWidget.childWidgets[0] instanceof TableWidget && page.repeatHeaderRowTableWidget) {\n                // tslint:disable-next-line:max-line-length\n                this.renderHeader(page, widget, this.viewer.layout.getHeader(bodyWidget.childWidgets[0]));\n            }\n            this.renderWidget(page, widget);\n        }\n    };\n    /**\n     * Renders block widget.\n     * @param {Page} page\n     * @param {Widget} widget\n     */\n    Renderer.prototype.renderWidget = function (page, widget) {\n        if (widget instanceof ParagraphWidget) {\n            this.renderParagraphWidget(page, widget);\n        }\n        else {\n            this.renderTableWidget(page, widget);\n        }\n    };\n    /**\n     * Renders header.\n     * @param {Page} page\n     * @param {TableWidget} widget\n     * @param {WRow} header\n     * @private\n     */\n    Renderer.prototype.renderHeader = function (page, widget, header) {\n        if (isNullOrUndefined(header)) {\n            return;\n        }\n        var top = page.viewer.clientArea.y;\n        for (var i = 0; i <= header.rowIndex; i++) {\n            if (header.ownerTable.getSplitWidgets()[0].childWidgets.length === 0) {\n                return;\n            }\n            var row = header.ownerTable.getSplitWidgets()[0].childWidgets[0];\n            var headerWidget = row.clone();\n            headerWidget.containerWidget = row.containerWidget;\n            // tslint:disable-next-line:max-line-length\n            page.viewer.updateClientAreaLocation(headerWidget, new Rect(page.viewer.clientArea.x, top, headerWidget.width, headerWidget.height));\n            page.viewer.layout.updateChildLocationForRow(top, headerWidget);\n            var cell = undefined;\n            //Renders table cell outline rectangle - Border and background color.\n            for (var j = 0; j < headerWidget.childWidgets.length; j++) {\n                cell = headerWidget.childWidgets[j];\n                this.renderTableCellWidget(page, cell);\n            }\n            top += headerWidget.height;\n        }\n        if (widget.y !== top) {\n            //this.Location.Y = top;\n            page.viewer.layout.updateChildLocationForTable(top, widget);\n        }\n    };\n    /**\n     * Renders paragraph widget.\n     * @param {Page} page\n     * @param {ParagraphWidget} paraWidget\n     */\n    Renderer.prototype.renderParagraphWidget = function (page, paraWidget) {\n        var top = paraWidget.y;\n        var left = paraWidget.x;\n        for (var i = 0; i < paraWidget.childWidgets.length; i++) {\n            var widget = paraWidget.childWidgets[i];\n            this.renderLine(widget, page, left, top);\n            top += widget.height;\n        }\n    };\n    /**\n     * Renders table widget.\n     * @param {Page} page\n     * @param {TableWidget} tableWidget\n     */\n    Renderer.prototype.renderTableWidget = function (page, tableWidget) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var widget = tableWidget.childWidgets[i];\n            this.renderTableRowWidget(page, widget);\n            if (tableWidget.tableFormat.cellSpacing > 0) {\n                this.renderTableOutline(tableWidget);\n            }\n        }\n    };\n    /**\n     * Renders table row widget.\n     * @param {Page} page\n     * @param {Widget} rowWidget\n     */\n    Renderer.prototype.renderTableRowWidget = function (page, rowWidget) {\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var widget = rowWidget.childWidgets[i];\n            this.renderTableCellWidget(page, widget);\n        }\n    };\n    /**\n     * Renders table cell widget.\n     * @param {Page} page\n     * @param {TableCellWidget} cellWidget\n     */\n    Renderer.prototype.renderTableCellWidget = function (page, cellWidget) {\n        if (!this.isPrinting) {\n            if (this.getScaledValue(cellWidget.y, 2) + cellWidget.height * this.viewer.zoomFactor < 0 ||\n                this.getScaledValue(cellWidget.y, 2) > this.viewer.visibleBounds.height) {\n                return;\n            }\n        }\n        var widgetHeight = 0;\n        if (!this.isPrinting && page.viewer.owner.selection && page.viewer.owner.selection.selectedWidgets.length > 0) {\n            page.viewer.owner.selection.addSelectionHighlightTable(this.selectionContext, cellWidget);\n        }\n        this.renderTableCellOutline(page.viewer, cellWidget);\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            var widget = cellWidget.childWidgets[i];\n            var width = cellWidget.width + cellWidget.margin.left - cellWidget.leftBorderWidth;\n            this.clipRect(cellWidget.x, cellWidget.y, this.getScaledValue(width), this.getScaledValue(cellWidget.height));\n            this.renderWidget(page, widget);\n            this.pageContext.restore();\n        }\n    };\n    /**\n     * Renders line widget.\n     * @param {LineWidget} lineWidget\n     * @param {Page} page\n     * @param {number} left\n     * @param {number} top\n     */\n    Renderer.prototype.renderLine = function (lineWidget, page, left, top) {\n        if (!this.isPrinting && page.viewer.owner.selection && page.viewer.owner.selection.selectedWidgets.length > 0) {\n            page.viewer.owner.selection.addSelectionHighlight(this.selectionContext, lineWidget, top);\n        }\n        var paraFormat = lineWidget.paragraph.paragraphFormat;\n        if (lineWidget.isFirstLine() && !paraFormat.bidi) {\n            left += HelperMethods.convertPointToPixel(paraFormat.firstLineIndent);\n        }\n        if (this.viewer.owner.searchModule) {\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(page.viewer.owner.searchModule.searchHighlighters) && page.viewer.owner.searchModule.searchHighlighters.containsKey(lineWidget)) {\n                var widgetInfo = page.viewer.owner.searchModule.searchHighlighters.get(lineWidget);\n                for (var i = 0; i < widgetInfo.length; i++) {\n                    this.pageContext.fillStyle = '#ffe97f';\n                    // tslint:disable-next-line:max-line-length\n                    this.pageContext.fillRect(this.getScaledValue(widgetInfo[i].left, 1), this.getScaledValue(top, 2), this.getScaledValue(widgetInfo[i].width), this.getScaledValue(lineWidget.height));\n                }\n            }\n        }\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var elementBox = lineWidget.children[i];\n            if (elementBox instanceof FieldElementBox || this.isFieldCode ||\n                (elementBox.width === 0 && elementBox.height === 0)) {\n                if (this.isFieldCode) {\n                    elementBox.width = 0;\n                }\n                left += elementBox.width + elementBox.margin.left;\n                this.toSkipFieldCode(elementBox);\n                continue;\n            }\n            var underlineY = this.getUnderlineYPosition(lineWidget);\n            if (!this.isPrinting) {\n                if (this.getScaledValue(top + elementBox.margin.top, 2) + elementBox.height * this.viewer.zoomFactor < 0 ||\n                    this.getScaledValue(top + elementBox.margin.top, 2) > this.viewer.visibleBounds.height) {\n                    left += elementBox.width + elementBox.margin.left;\n                    continue;\n                }\n            }\n            if (elementBox instanceof ListTextElementBox) {\n                this.renderListTextElementBox(elementBox, left, top, underlineY);\n            }\n            else if (elementBox instanceof ImageElementBox) {\n                this.renderImageElementBox(elementBox, left, top, underlineY);\n            }\n            else {\n                this.renderTextElementBox(elementBox, left, top, underlineY);\n            }\n            left += elementBox.width + elementBox.margin.left;\n        }\n    };\n    Renderer.prototype.toSkipFieldCode = function (element) {\n        if (element instanceof FieldElementBox) {\n            if (element.fieldType === 0) {\n                if ((!isNullOrUndefined(element.fieldEnd) || element.hasFieldEnd)) {\n                    this.isFieldCode = true;\n                }\n            }\n            else if (element.fieldType === 2 || element.fieldType === 1) {\n                this.isFieldCode = false;\n            }\n        }\n    };\n    /**\n     * Gets underline y position.\n     * @param {LineWidget} lineWidget\n     * @private\n     */\n    Renderer.prototype.getUnderlineYPosition = function (lineWidget) {\n        var height = 0;\n        var lineHeight = 0;\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            if (lineWidget.children[i] instanceof FieldElementBox ||\n                (lineWidget.children[i].width === 0 && lineWidget.children[i].height === 0)) {\n                continue;\n            }\n            if (height < lineWidget.children[i].height + lineWidget.children[i].margin.top) {\n                height = lineWidget.children[i].margin.top + lineWidget.children[i].height;\n                lineHeight = lineWidget.children[i].height / 20;\n            }\n        }\n        return height - 2 * lineHeight;\n    };\n    /**\n     * Renders list element box\n     * @param {ListTextElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     */\n    Renderer.prototype.renderListTextElementBox = function (elementBox, left, top, underlineY) {\n        var topMargin = elementBox.margin.top;\n        var leftMargin = elementBox.margin.left;\n        var format = elementBox.listLevel.characterFormat;\n        var breakCharacterFormat = elementBox.line.paragraph.characterFormat;\n        var color = format.fontColor === '#000000' ? breakCharacterFormat.fontColor : format.fontColor;\n        this.pageContext.textBaseline = 'top';\n        var bold = '';\n        var italic = '';\n        var fontFamily = format.fontFamily === 'Verdana' ? breakCharacterFormat.fontFamily : format.fontFamily;\n        var fontSize = format.fontSize === 11 ? breakCharacterFormat.fontSize : format.fontSize;\n        // tslint:disable-next-line:max-line-length\n        var baselineAlignment = format.baselineAlignment === 'Normal' ? breakCharacterFormat.baselineAlignment : format.baselineAlignment;\n        bold = format.bold ? 'bold' : breakCharacterFormat.bold ? 'bold' : '';\n        italic = format.italic ? 'italic' : breakCharacterFormat.italic ? 'italic' : '';\n        fontSize = fontSize === 0 ? 0.5 : fontSize / (baselineAlignment === 'Normal' ? 1 : 1.5);\n        var strikethrough = format.strikethrough === 'None' ? breakCharacterFormat.strikethrough : format.strikethrough;\n        var highlightColor = format.highlightColor === 'NoColor' ? breakCharacterFormat.highlightColor :\n            format.highlightColor;\n        if (highlightColor !== 'NoColor') {\n            if (highlightColor.substring(0, 1) !== '#') {\n                this.pageContext.fillStyle = HelperMethods.getHighlightColorCode(highlightColor);\n            }\n            else {\n                this.pageContext.fillStyle = this.getColor(highlightColor);\n            }\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width), this.getScaledValue(elementBox.height));\n        }\n        this.pageContext.font = bold + ' ' + italic + ' ' + fontSize * this.viewer.zoomFactor + 'pt' + ' ' + fontFamily;\n        if (baselineAlignment === 'Subscript') {\n            topMargin += elementBox.height - elementBox.height / 1.5;\n        }\n        var text = elementBox.text;\n        var followCharacter = text === '\\t' || text === ' ';\n        if (!followCharacter && (format.bidi || elementBox.line.paragraph.paragraphFormat.bidi)) {\n            this.pageCanvas.setAttribute('dir', 'rtl');\n        }\n        this.pageContext.fillStyle = this.getColor(color);\n        // tslint:disable-next-line:max-line-length\n        this.pageContext.fillText(text, this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width));\n        if (format.underline !== 'None' && !isNullOrUndefined(format.underline)) {\n            this.renderUnderline(elementBox, left, top, underlineY, color, format.underline, baselineAlignment);\n        }\n        if (strikethrough !== 'None') {\n            this.renderStrikeThrough(elementBox, left, top, format.strikethrough, color, baselineAlignment);\n        }\n        this.pageCanvas.setAttribute('dir', 'ltr');\n    };\n    /**\n     * Renders text element box.\n     * @param {TextElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderTextElementBox = function (elementBox, left, top, underlineY) {\n        var isHeightType = false;\n        var containerWidget = elementBox.line.paragraph.containerWidget;\n        if (containerWidget instanceof TableCellWidget) {\n            isHeightType = (containerWidget.ownerRow.rowFormat.heightType === 'Exactly');\n        }\n        var topMargin = elementBox.margin.top;\n        var leftMargin = elementBox.margin.left;\n        if (isHeightType) {\n            // tslint:disable-next-line:max-line-length\n            this.clipRect(containerWidget.x, containerWidget.y, this.getScaledValue(containerWidget.width), this.getScaledValue(containerWidget.height));\n        }\n        var format = elementBox.characterFormat;\n        if (format.highlightColor !== 'NoColor') {\n            if (format.highlightColor.substring(0, 1) !== '#') {\n                this.pageContext.fillStyle = HelperMethods.getHighlightColorCode(format.highlightColor);\n            }\n            else {\n                this.pageContext.fillStyle = this.getColor(format.highlightColor);\n            }\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width), this.getScaledValue(elementBox.height));\n        }\n        var color = format.fontColor;\n        this.pageContext.textBaseline = 'top';\n        var bold = '';\n        var italic = '';\n        var fontSize = 11;\n        bold = format.bold ? 'bold' : '';\n        italic = format.italic ? 'italic' : '';\n        fontSize = format.fontSize === 0 ? 0.5 : format.fontSize / (format.baselineAlignment === 'Normal' ? 1 : 1.5);\n        this.pageContext.font = bold + ' ' + italic + ' ' + fontSize * this.viewer.zoomFactor + 'pt' + ' ' + format.fontFamily;\n        if (format.baselineAlignment === 'Subscript') {\n            topMargin += elementBox.height - elementBox.height / 1.5;\n        }\n        this.pageContext.fillStyle = this.getColor(color);\n        var scaledWidth = this.getScaledValue(elementBox.width);\n        var text = elementBox.text;\n        if (elementBox instanceof TabElementBox) {\n            var tabElement = elementBox;\n            if (tabElement.tabText === '' && !isNullOrUndefined(tabElement.tabLeader) && tabElement.tabLeader !== 'None') {\n                text = this.getTabLeader(elementBox);\n                tabElement.tabText = text;\n            }\n            else if (tabElement.tabText !== '') {\n                text = tabElement.tabText;\n            }\n        }\n        var isRTL = format.bidi || this.viewer.textHelper.isRTLText(elementBox.text);\n        text = this.viewer.textHelper.setText(text, isRTL, format.bdo, true);\n        // tslint:disable-next-line:max-line-length\n        this.pageContext.fillText(text, this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), scaledWidth);\n        if (format.underline !== 'None' && !isNullOrUndefined(format.underline)) {\n            // tslint:disable-next-line:max-line-length\n            this.renderUnderline(elementBox, left, top, underlineY, color, format.underline, format.baselineAlignment);\n        }\n        if (format.strikethrough !== 'None' && !isNullOrUndefined(format.strikethrough)) {\n            this.renderStrikeThrough(elementBox, left, top, format.strikethrough, color, format.baselineAlignment);\n        }\n        if (isHeightType) {\n            this.pageContext.restore();\n        }\n    };\n    /**\n     * Returns tab leader\n     */\n    Renderer.prototype.getTabLeader = function (elementBox) {\n        var textWidth = 0;\n        var tabString = this.getTabLeaderString(elementBox.tabLeader);\n        var tabText = tabString;\n        textWidth = this.viewer.textHelper.getWidth(tabText, elementBox.characterFormat);\n        var count = Math.floor(elementBox.width / textWidth);\n        for (var i = 0; i <= count; i++) {\n            tabText += tabString;\n        }\n        return tabText.slice(0, -1);\n    };\n    /**\n     * Returns tab leader string.\n     */\n    Renderer.prototype.getTabLeaderString = function (tabLeader) {\n        var tabString = '';\n        switch (tabLeader) {\n            case 'Dot':\n                tabString = '.';\n                break;\n            case 'Hyphen':\n                tabString = '-';\n                break;\n            case 'Underscore':\n                tabString = '_';\n                break;\n        }\n        return tabString;\n    };\n    /**\n     * Clips the rectangle with specified position.\n     * @param {number} xPos\n     * @param {number} yPos\n     * @param {number} width\n     * @param {number} height\n     */\n    Renderer.prototype.clipRect = function (xPos, yPos, width, height) {\n        this.pageContext.beginPath();\n        this.pageContext.save();\n        this.pageContext.rect(this.getScaledValue(xPos, 1), this.getScaledValue(yPos, 2), width, height);\n        this.pageContext.clip();\n    };\n    /**\n     * Renders underline.\n     * @param {ElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     * @param {string} color\n     * @param {Underline} underline\n     * @param {BaselineAlignment} baselineAlignment\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderUnderline = function (elementBox, left, top, underlineY, color, underline, baselineAlignment) {\n        var renderedHeight = elementBox.height / (baselineAlignment === 'Normal' ? 1 : 1.5);\n        var topMargin = elementBox.margin.top;\n        var underlineHeight = renderedHeight / 20;\n        var y = 0;\n        if (baselineAlignment === 'Subscript' || elementBox instanceof ListTextElementBox) {\n            y = (renderedHeight - 2 * underlineHeight) + top;\n            topMargin += elementBox.height - renderedHeight;\n            y += topMargin > 0 ? topMargin : 0;\n        }\n        else {\n            y = underlineY + top;\n        }\n        // tslint:disable-next-line:max-line-length\n        this.pageContext.fillRect(this.getScaledValue(left + elementBox.margin.left, 1), this.getScaledValue(y, 2), this.getScaledValue(elementBox.width), this.getScaledValue(underlineHeight));\n    };\n    /**\n     * Renders strike through.\n     * @param {ElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {Strikethrough} strikethrough\n     * @param {string} color\n     * @param {BaselineAlignment} baselineAlignment\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderStrikeThrough = function (elementBox, left, top, strikethrough, color, baselineAlignment) {\n        var renderedHeight = elementBox.height / (baselineAlignment === 'Normal' ? 1 : 1.5);\n        var topMargin = elementBox.margin.top;\n        if (baselineAlignment === 'Subscript') {\n            topMargin += elementBox.height - renderedHeight;\n        }\n        top += topMargin > 0 ? topMargin : 0;\n        var lineHeight = renderedHeight / 20;\n        var y = (renderedHeight / 2) + (0.5 * lineHeight);\n        var lineCount = 0;\n        if (strikethrough === 'DoubleStrike') {\n            y -= lineHeight;\n        }\n        while (lineCount < (strikethrough === 'DoubleStrike' ? 2 : 1)) {\n            lineCount++;\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left + elementBox.margin.left, 1), this.getScaledValue(y + top, 2), this.getScaledValue(elementBox.width), this.getScaledValue(lineHeight));\n            y += 2 * lineHeight;\n        }\n    };\n    /**\n     * Renders image element box.\n     * @param {ImageElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderImageElementBox = function (elementBox, left, top, underlineY) {\n        var topMargin = elementBox.margin.top;\n        var leftMargin = elementBox.margin.left;\n        var color = 'black';\n        this.pageContext.textBaseline = 'top';\n        var widgetWidth = 0;\n        var isClipped = false;\n        if (topMargin < 0 || elementBox.line.paragraph.width < elementBox.width) {\n            var containerWid = elementBox.line.paragraph.containerWidget;\n            // if (containerWid instanceof BodyWidget) {\n            //     widgetWidth = containerWid.width + containerWid.x;\n            // } else \n            if (containerWid instanceof TableCellWidget) {\n                var leftIndent = 0;\n                if (containerWid.childWidgets[0] instanceof ParagraphWidget) {\n                    var paraAdv = containerWid.childWidgets[0];\n                    leftIndent = paraAdv.paragraphFormat.leftIndent;\n                }\n                widgetWidth = containerWid.width + containerWid.margin.left - containerWid.leftBorderWidth - leftIndent;\n                isClipped = true;\n                // tslint:disable-next-line:max-line-length\n                this.clipRect(left + leftMargin, top + topMargin, this.getScaledValue(widgetWidth), this.getScaledValue(containerWid.height));\n            }\n        }\n        if (elementBox.isMetaFile) {\n            /* tslint:disable:no-empty */\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.drawImage(elementBox.element, this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width), this.getScaledValue(elementBox.height));\n        }\n        if (isClipped) {\n            this.pageContext.restore();\n        }\n    };\n    /**\n     * Renders table outline.\n     * @param {TableWidget} tableWidget\n     */\n    Renderer.prototype.renderTableOutline = function (tableWidget) {\n        var layout = new Layout(this.viewer);\n        var table = tableWidget;\n        tableWidget.width = this.viewer.layout.getTableWidth(table);\n        var border = !table.isBidiTable ? layout.getTableLeftBorder(table.tableFormat.borders)\n            : layout.getTableRightBorder(table.tableFormat.borders);\n        var lineWidth = 0;\n        //ToDo: Need to draw the borders based on the line style.\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x - tableWidget.margin.left - lineWidth / 2, tableWidget.y, tableWidget.x - tableWidget.margin.left - lineWidth / 2, tableWidget.y + tableWidget.height, lineWidth);\n        // }\n        border = layout.getTableTopBorder(table.tableFormat.borders);\n        lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x - tableWidget.margin.left - lineWidth, tableWidget.y - lineWidth / 2, tableWidget.x + tableWidget.width + lineWidth + tableWidget.margin.right, tableWidget.y - lineWidth / 2, lineWidth);\n        // }\n        border = !table.isBidiTable ? layout.getTableRightBorder(table.tableFormat.borders)\n            : layout.getTableLeftBorder(table.tableFormat.borders);\n        lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x + tableWidget.width + tableWidget.margin.right + lineWidth / 2, tableWidget.y, tableWidget.x + tableWidget.width + tableWidget.margin.right + lineWidth / 2, tableWidget.y + tableWidget.height, lineWidth);\n        // }\n        border = layout.getTableBottomBorder(table.tableFormat.borders);\n        lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x - tableWidget.margin.left - lineWidth, tableWidget.y + tableWidget.height - lineWidth / 2, tableWidget.x + tableWidget.width + lineWidth + tableWidget.margin.right, tableWidget.y + tableWidget.height - lineWidth / 2, lineWidth);\n        // }\n    };\n    /**\n     * Renders table cell outline.\n     * @param {LayoutViewer} viewer\n     * @param {TableCellWidget} cellWidget\n     */\n    // tslint:disable: max-func-body-length\n    Renderer.prototype.renderTableCellOutline = function (viewer, cellWidget) {\n        var layout = viewer.layout;\n        var borders = undefined;\n        var tableCell = cellWidget;\n        var cellTopMargin = 0;\n        var cellBottomMargin = 0;\n        var cellLeftMargin = 0;\n        var cellRightMargin = 0;\n        var height = 0;\n        var isBidiTable = cellWidget.ownerTable.isBidiTable;\n        borders = tableCell.cellFormat.borders;\n        if (cellWidget.containerWidget instanceof TableRowWidget) {\n            cellBottomMargin = cellWidget.margin.bottom - cellWidget.containerWidget.bottomBorderWidth;\n            cellTopMargin = cellWidget.margin.top - cellWidget.containerWidget.topBorderWidth;\n        }\n        cellLeftMargin = cellWidget.margin.left - cellWidget.leftBorderWidth;\n        cellRightMargin = cellWidget.margin.right - cellWidget.rightBorderWidth;\n        if (!isNullOrUndefined(tableCell.ownerRow) && tableCell.ownerRow.rowFormat.heightType === 'Exactly') {\n            height = HelperMethods.convertPointToPixel(tableCell.ownerRow.rowFormat.height) + cellTopMargin + cellBottomMargin;\n        }\n        else {\n            if (!isNullOrUndefined(tableCell.ownerRow) && [tableCell.ownerRow].length <= 1) {\n                // tslint:disable-next-line:max-line-length\n                height = Math.max(HelperMethods.convertPointToPixel(tableCell.ownerRow.rowFormat.height), cellWidget.height) + cellTopMargin + cellBottomMargin;\n            }\n            else {\n                height = cellWidget.height + cellTopMargin + cellBottomMargin;\n            }\n        }\n        this.renderCellBackground(height, cellWidget);\n        var border = !isBidiTable ? TableCellWidget.getCellLeftBorder(tableCell) : TableCellWidget.getCellRightBorder(tableCell);\n        var lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {       \n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth()); //Renders the cell left border.\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, cellWidget.x - cellLeftMargin - lineWidth, cellWidget.y - cellTopMargin, cellWidget.x - cellLeftMargin - lineWidth, cellWidget.y + cellWidget.height + cellBottomMargin, lineWidth);\n        // }\n        border = TableCellWidget.getCellTopBorder(tableCell);\n        // if (!isNullOrUndefined(border )) { //Renders the cell top border.        \n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, cellWidget.x - cellWidget.margin.left, cellWidget.y - cellWidget.margin.top + lineWidth / 2, cellWidget.x + cellWidget.width + cellWidget.margin.right, cellWidget.y - cellWidget.margin.top + lineWidth / 2, lineWidth);\n        // }\n        var isLastCell = false;\n        if (!isBidiTable) {\n            isLastCell = tableCell.cellIndex === tableCell.ownerRow.childWidgets.length - 1;\n        }\n        else {\n            isLastCell = tableCell.cellIndex === 0;\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0 || isLastCell) {\n            border = isBidiTable ? TableCellWidget.getCellRightBorder(tableCell) : TableCellWidget.getCellLeftBorder(tableCell);\n            // if (!isNullOrUndefined(border )) { //Renders the cell right border.           \n            lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x + cellWidget.width + cellWidget.margin.right - lineWidth / 2, cellWidget.y - cellTopMargin, cellWidget.x + cellWidget.width + cellWidget.margin.right - lineWidth / 2, cellWidget.y + cellWidget.height + cellBottomMargin, lineWidth);\n            // }\n        }\n        var nextRow = tableCell.ownerRow.nextWidget;\n        //Specifies the next row is within the current table widget.\n        //True means current row is not rendered at page end; Otherwise False.\n        var nextRowIsInCurrentTableWidget = false;\n        if (!isNullOrUndefined(nextRow)) {\n            var nextRowWidget = undefined;\n            // if (viewer.renderedElements.containsKey(nextRow) && viewer.renderedElements.get(nextRow).length > 0) {\n            nextRowWidget = nextRow;\n            // }\n            if (nextRowWidget instanceof TableRowWidget) {\n                // tslint:disable-next-line:max-line-length\n                if (cellWidget.containerWidget instanceof TableRowWidget && cellWidget.containerWidget.containerWidget instanceof TableWidget) {\n                    nextRowIsInCurrentTableWidget = cellWidget.containerWidget.containerWidget.childWidgets.indexOf(nextRowWidget) !== -1;\n                }\n            }\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0 || tableCell.ownerRow.rowIndex === tableCell.ownerTable.childWidgets.length - 1\n            || (tableCell.cellFormat.rowSpan > 1\n                && tableCell.ownerRow.rowIndex + tableCell.cellFormat.rowSpan === tableCell.ownerTable.childWidgets.length) ||\n            !nextRowIsInCurrentTableWidget) {\n            // tslint:disable-next-line:max-line-length\n            border = (tableCell.cellFormat.rowSpan > 1 && tableCell.ownerRow.rowIndex + tableCell.cellFormat.rowSpan === tableCell.ownerTable.childWidgets.length) ?\n                //true part for vertically merged cells specifically.\n                tableCell.getBorderBasedOnPriority(tableCell.cellFormat.borders.bottom, TableCellWidget.getCellBottomBorder(tableCell))\n                //false part for remaining cases that has been handled inside method. \n                : TableCellWidget.getCellBottomBorder(tableCell);\n            // if (!isNullOrUndefined(border )) {\n            //Renders the cell bottom border.\n            lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x - cellWidget.margin.left, cellWidget.y + cellWidget.height + cellBottomMargin + lineWidth / 2, cellWidget.x + cellWidget.width + cellWidget.margin.right, cellWidget.y + cellWidget.height + cellBottomMargin + lineWidth / 2, lineWidth);\n            // }\n        }\n        border = layout.getCellDiagonalUpBorder(tableCell);\n        // if (!isNullOrUndefined(border )) {\n        //Renders the cell diagonal up border.\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        if (lineWidth > 0) {\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x - cellLeftMargin, cellWidget.y + cellWidget.height + cellBottomMargin, cellWidget.x + cellWidget.width + cellRightMargin, cellWidget.y - cellTopMargin, lineWidth);\n            // }\n        }\n        border = layout.getCellDiagonalDownBorder(tableCell);\n        // if (!isNullOrUndefined(border )) {\n        //Renders the cell diagonal down border.\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        if (lineWidth > 0) {\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x - cellLeftMargin, cellWidget.y - cellTopMargin, cellWidget.x + cellWidget.width + cellRightMargin, cellWidget.y + cellWidget.height + cellBottomMargin, lineWidth);\n        }\n        // }\n    };\n    /**\n     * Renders cell background.\n     * @param {number} height\n     * @param {TableCellWidget} cellWidget\n     */\n    Renderer.prototype.renderCellBackground = function (height, cellWidget) {\n        var cellFormat = cellWidget.cellFormat;\n        var bgColor = cellFormat.shading.backgroundColor === '#ffffff' ?\n            cellWidget.ownerTable.tableFormat.shading.backgroundColor : cellFormat.shading.backgroundColor;\n        this.pageContext.beginPath();\n        if (bgColor !== 'empty') {\n            this.pageContext.fillStyle = this.getColor(bgColor);\n            var left = cellWidget.x - cellWidget.margin.left + cellWidget.leftBorderWidth;\n            var top_1 = cellWidget.y - HelperMethods.convertPointToPixel(cellWidget.topMargin);\n            // tslint:disable-next-line:max-line-length\n            var width = cellWidget.width + cellWidget.margin.left + cellWidget.margin.right - cellWidget.leftBorderWidth - cellWidget.rightBorderWidth;\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left, 1), this.getScaledValue(top_1, 2), this.getScaledValue(width), this.getScaledValue(height));\n            this.pageContext.closePath();\n        }\n    };\n    /**\n     * Renders single border.\n     * @param {WBorder} border\n     * @param {number} startX\n     * @param {number} startY\n     * @param {number} endX\n     * @param {number} endY\n     * @param {number} lineWidth\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderSingleBorder = function (border, startX, startY, endX, endY, lineWidth) {\n        this.pageContext.beginPath();\n        this.pageContext.moveTo(this.getScaledValue(startX, 1), this.getScaledValue(startY, 2));\n        this.pageContext.lineTo(this.getScaledValue(endX, 1), this.getScaledValue(endY, 2));\n        this.pageContext.lineWidth = this.getScaledValue(lineWidth);\n        // set line color\n        this.pageContext.strokeStyle = border.color;\n        if (lineWidth > 0) {\n            this.pageContext.stroke();\n        }\n        this.pageContext.closePath();\n    };\n    /**\n     * Gets scaled value.\n     * @param {number} value\n     * @param {number} type\n     * @private\n     */\n    Renderer.prototype.getScaledValue = function (value, type) {\n        if (this.isPrinting) {\n            return value;\n        }\n        if (isNullOrUndefined(type)) {\n            type = 0;\n        }\n        var x = value * this.viewer.zoomFactor;\n        return x + (type === 1 ? this.pageLeft : (type === 2 ? this.pageTop : 0));\n    };\n    /**\n     * Destroys the internal objects which is maintained.\n     */\n    Renderer.prototype.destroy = function () {\n        this.viewer = undefined;\n        if (!isNullOrUndefined(this.pageCanvasIn)) {\n            this.pageCanvasIn.innerHTML = '';\n        }\n        this.pageCanvasIn = undefined;\n    };\n    return Renderer;\n}());\nexport { Renderer };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WList } from '../list/list';\nimport { WListLevel } from '../list/list-level';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { WCharacterFormat, WListFormat, WParagraphFormat, WCellFormat, WTableFormat, WSectionFormat, WRowFormat } from '../format/index';\nimport { WCharacterStyle, WParagraphStyle, WTabStop } from '../format/index';\nimport { LineWidget, ParagraphWidget, ImageElementBox, BodyWidget, TextElementBox, TableCellWidget, TableRowWidget, TableWidget, FieldElementBox, HeaderFooterWidget, BookmarkElementBox, FieldTextElementBox, TabElementBox } from './page';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar SfdtReader = /** @class */ (function () {\n    function SfdtReader(viewer) {\n        /* tslint:disable:no-any */\n        this.viewer = undefined;\n        this.isPageBreakInsideTable = false;\n        this.viewer = viewer;\n    }\n    Object.defineProperty(SfdtReader.prototype, \"isPasting\", {\n        get: function () {\n            return this.viewer && this.viewer.owner.isPastingContent;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     * @param json\n     */\n    SfdtReader.prototype.convertJsonToDocument = function (json) {\n        var sections = [];\n        var jsonObject = JSON.parse(json);\n        this.parseCharacterFormat(jsonObject.characterFormat, this.viewer.characterFormat);\n        this.parseParagraphFormat(jsonObject.paragraphFormat, this.viewer.paragraphFormat);\n        if (!isNullOrUndefined(jsonObject.defaultTabWidth)) {\n            this.viewer.defaultTabWidth = jsonObject.defaultTabWidth;\n        }\n        if (!isNullOrUndefined(jsonObject.background)) {\n            this.viewer.backgroundColor = this.getColor(jsonObject.background.color);\n        }\n        if (!isNullOrUndefined(jsonObject.abstractLists)) {\n            this.parseAbstractList(jsonObject, this.viewer.abstractLists);\n        }\n        if (!isNullOrUndefined(jsonObject.lists)) {\n            this.parseList(jsonObject, this.viewer.lists);\n        }\n        if (!isNullOrUndefined(jsonObject.styles)) {\n            this.parseStyles(jsonObject, this.viewer.styles);\n        }\n        if (!isNullOrUndefined(jsonObject.sections)) {\n            this.parseSections(jsonObject.sections, sections);\n        }\n        return sections;\n    };\n    SfdtReader.prototype.parseStyles = function (data, styles) {\n        for (var i = 0; i < data.styles.length; i++) {\n            if (isNullOrUndefined(this.viewer.styles.findByName(data.styles[i].name))) {\n                this.parseStyle(data, data.styles[i], styles);\n            }\n        }\n    };\n    SfdtReader.prototype.parseStyle = function (data, style, styles) {\n        var wStyle;\n        if (!isNullOrUndefined(style.type)) {\n            if (style.type === 'Paragraph') {\n                wStyle = new WParagraphStyle();\n                wStyle.type = 'Paragraph';\n            }\n            if (style.type === 'Character') {\n                wStyle = new WCharacterStyle();\n                wStyle.type = 'Character';\n            }\n            if (!isNullOrUndefined(style.name)) {\n                wStyle.name = style.name;\n            }\n            styles.push(wStyle);\n            if (!isNullOrUndefined(style.basedOn)) {\n                var basedOn = styles.findByName(style.basedOn);\n                if (!isNullOrUndefined(basedOn)) {\n                    if (basedOn.type === wStyle.type) {\n                        wStyle.basedOn = basedOn;\n                    }\n                }\n                else {\n                    var basedStyle = this.getStyle(style.basedOn, data);\n                    var styleString = void 0;\n                    if (!isNullOrUndefined(basedStyle) && basedStyle.type === wStyle.type) {\n                        styleString = basedStyle;\n                    }\n                    else {\n                        if (wStyle.type === 'Paragraph') {\n                            styleString = JSON.parse('{\"type\":\"Paragraph\",\"name\":\"Normal\",\"next\":\"Normal\"}');\n                        }\n                        else {\n                            styleString = JSON.parse('{\"type\": \"Character\",\"name\": \"Default Paragraph Font\"}');\n                        }\n                    }\n                    this.parseStyle(data, styleString, styles);\n                    wStyle.basedOn = styles.findByName(styleString.name);\n                }\n            }\n            if (!isNullOrUndefined(style.link)) {\n                var link = styles.findByName(style.link);\n                var linkStyle = this.getStyle(style.link, data);\n                var styleString = void 0;\n                if (isNullOrUndefined(link)) {\n                    if (isNullOrUndefined(linkStyle)) {\n                        //Construct the CharacterStyle string\n                        var charaStyle = {};\n                        charaStyle.characterFormat = style.characterFormat;\n                        charaStyle.name = style.name + ' Char';\n                        charaStyle.type = 'Character';\n                        //TODO: Implement basedOn\n                        charaStyle.basedOn = style.basedOn === 'Normal' ? 'Default Paragraph Font' : (style.basedOn + ' Char');\n                        styleString = charaStyle;\n                    }\n                    else {\n                        styleString = linkStyle;\n                    }\n                    this.parseStyle(data, styleString, styles);\n                    wStyle.link = isNullOrUndefined(styles.findByName(styleString.name)) ? style.link : styles.findByName(styleString.name);\n                }\n                else {\n                    wStyle.link = link;\n                }\n            }\n            if (!isNullOrUndefined(style.characterFormat)) {\n                this.parseCharacterFormat(style.characterFormat, wStyle.characterFormat);\n            }\n            if (!isNullOrUndefined(style.paragraphFormat)) {\n                this.parseParagraphFormat(style.paragraphFormat, wStyle.paragraphFormat);\n            }\n            if (!isNullOrUndefined(style.next)) {\n                if (style.next === style.name) {\n                    wStyle.next = wStyle;\n                }\n                else {\n                    var next = styles.findByName(style.next);\n                    if (!isNullOrUndefined(next) && next.type === wStyle.type) {\n                        wStyle.next = next;\n                    }\n                    else {\n                        var nextStyleString = this.getStyle(style.next, data);\n                        if (!isNullOrUndefined(nextStyleString)) {\n                            this.parseStyle(data, nextStyleString, styles);\n                            wStyle.next = styles.findByName(nextStyleString.name);\n                        }\n                        else {\n                            wStyle.next = wStyle;\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SfdtReader.prototype.getStyle = function (name, data) {\n        for (var i = 0; i < data.styles.length; i++) {\n            if (data.styles[i].name === name) {\n                return data.styles[i];\n            }\n        }\n        return undefined;\n    };\n    SfdtReader.prototype.parseAbstractList = function (data, abstractLists) {\n        for (var i = 0; i < data.abstractLists.length; i++) {\n            var abstractList = new WAbstractList();\n            var abstract = data.abstractLists[i];\n            abstractLists.push(abstractList);\n            if (!isNullOrUndefined(abstract)) {\n                if (!isNullOrUndefined(abstract.abstractListId)) {\n                    abstractList.abstractListId = abstract.abstractListId;\n                }\n                if (!isNullOrUndefined(abstract.levels)) {\n                    for (var j = 0; j < abstract.levels.length; j++) {\n                        var level = abstract.levels[j];\n                        if (!isNullOrUndefined(level)) {\n                            var listLevel = this.parseListLevel(level, abstractList);\n                            abstractList.levels.push(listLevel);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SfdtReader.prototype.parseListLevel = function (data, owner) {\n        var listLevel = new WListLevel(owner);\n        if (data.listLevelPattern === 'Bullet') {\n            listLevel.listLevelPattern = 'Bullet';\n            listLevel.numberFormat = !isNullOrUndefined(data.numberFormat) ? data.numberFormat : '';\n        }\n        else {\n            listLevel.listLevelPattern = data.listLevelPattern;\n            listLevel.startAt = data.startAt;\n            listLevel.numberFormat = !isNullOrUndefined(data.numberFormat) ? data.numberFormat : '';\n            if (data.restartLevel >= 0) {\n                listLevel.restartLevel = data.restartLevel;\n            }\n            else {\n                listLevel.restartLevel = data.levelNumber;\n            }\n        }\n        listLevel.followCharacter = data.followCharacter;\n        this.parseCharacterFormat(data.characterFormat, listLevel.characterFormat);\n        this.parseParagraphFormat(data.paragraphFormat, listLevel.paragraphFormat);\n        return listLevel;\n    };\n    SfdtReader.prototype.parseList = function (data, listCollection) {\n        for (var i = 0; i < data.lists.length; i++) {\n            var list = new WList();\n            var lists = data.lists[i];\n            if (!isNullOrUndefined(lists.abstractListId)) {\n                list.abstractListId = lists.abstractListId;\n                list.abstractList = this.viewer.getAbstractListById(lists.abstractListId);\n            }\n            listCollection.push(list);\n            if (!isNullOrUndefined(lists.listId)) {\n                list.listId = lists.listId;\n            }\n            if (lists.hasOwnProperty('levelOverrides')) {\n                this.parseLevelOverride(lists.levelOverrides, list);\n            }\n        }\n    };\n    SfdtReader.prototype.parseLevelOverride = function (data, list) {\n        if (isNullOrUndefined(data)) {\n            return;\n        }\n        for (var i = 0; i < data.length; i++) {\n            var levelOverrides = new WLevelOverride();\n            var levelOverride = data[i];\n            levelOverrides.startAt = levelOverride.startAt;\n            levelOverrides.levelNumber = levelOverride.levelNumber;\n            if (!isNullOrUndefined(levelOverride.overrideListLevel)) {\n                levelOverrides.overrideListLevel = this.parseListLevel(levelOverride.overrideListLevel, levelOverrides);\n            }\n            list.levelOverrides.push(levelOverrides);\n        }\n    };\n    SfdtReader.prototype.parseSections = function (data, sections) {\n        for (var i = 0; i < data.length; i++) {\n            var section = new BodyWidget();\n            section.sectionFormat = new WSectionFormat(section);\n            section.index = i;\n            var item = data[i];\n            if (!isNullOrUndefined(item.sectionFormat)) {\n                this.parseSectionFormat(item.sectionFormat, section.sectionFormat);\n            }\n            if (isNullOrUndefined(item.headersFooters)) {\n                item.headersFooters = {};\n            }\n            this.viewer.headersFooters.push(this.parseHeaderFooter(item.headersFooters, this.viewer.headersFooters));\n            this.parseTextBody(item.blocks, section);\n            for (var i_1 = 0; i_1 < section.childWidgets.length; i_1++) {\n                section.childWidgets[i_1].containerWidget = section;\n            }\n            sections.push(section);\n        }\n    };\n    /**\n     * @private\n     */\n    SfdtReader.prototype.parseHeaderFooter = function (data, headersFooters) {\n        var hfs = {};\n        if (!isNullOrUndefined(data.header)) {\n            var oddHeader = new HeaderFooterWidget('OddHeader');\n            hfs[0] = oddHeader;\n            this.parseTextBody(data.header.blocks, oddHeader);\n        }\n        if (!isNullOrUndefined(data.footer)) {\n            var oddFooter = new HeaderFooterWidget('OddFooter');\n            hfs[1] = oddFooter;\n            this.parseTextBody(data.footer.blocks, oddFooter);\n        }\n        if (!isNullOrUndefined(data.evenHeader)) {\n            var evenHeader = new HeaderFooterWidget('EvenHeader');\n            hfs[2] = evenHeader;\n            this.parseTextBody(data.evenHeader.blocks, evenHeader);\n        }\n        if (!isNullOrUndefined(data.evenFooter)) {\n            var evenFooter = new HeaderFooterWidget('EvenFooter');\n            hfs[3] = evenFooter;\n            this.parseTextBody(data.evenFooter.blocks, evenFooter);\n        }\n        if (!isNullOrUndefined(data.firstPageHeader)) {\n            var firstPageHeader = new HeaderFooterWidget('FirstPageHeader');\n            hfs[4] = firstPageHeader;\n            this.parseTextBody(data.firstPageHeader.blocks, firstPageHeader);\n        }\n        if (!isNullOrUndefined(data.firstPageFooter)) {\n            var firstPageFooter = new HeaderFooterWidget('FirstPageFooter');\n            hfs[5] = firstPageFooter;\n            this.parseTextBody(data.firstPageFooter.blocks, firstPageFooter);\n        }\n        return hfs;\n    };\n    SfdtReader.prototype.parseTextBody = function (data, section) {\n        this.parseBody(data, section.childWidgets, section);\n    };\n    SfdtReader.prototype.parseBody = function (data, blocks, container) {\n        if (!isNullOrUndefined(data)) {\n            for (var i = 0; i < data.length; i++) {\n                var block = data[i];\n                if (block.hasOwnProperty('inlines')) {\n                    var writeInlineFormat = false;\n                    //writeInlineFormat = this.isPasting && i === data.length - 1;\n                    var paragraph = new ParagraphWidget();\n                    paragraph.characterFormat = new WCharacterFormat(paragraph);\n                    paragraph.paragraphFormat = new WParagraphFormat(paragraph);\n                    this.parseCharacterFormat(block.characterFormat, paragraph.characterFormat);\n                    this.parseParagraphFormat(block.paragraphFormat, paragraph.paragraphFormat);\n                    var styleObj = void 0;\n                    if (!isNullOrUndefined(block.paragraphFormat) && !isNullOrUndefined(block.paragraphFormat.styleName)) {\n                        styleObj = this.viewer.styles.findByName(block.paragraphFormat.styleName, 'Paragraph');\n                        if (!isNullOrUndefined(styleObj)) {\n                            paragraph.paragraphFormat.ApplyStyle(styleObj);\n                        }\n                    }\n                    if (block.inlines.length > 0) {\n                        this.parseParagraph(block.inlines, paragraph, writeInlineFormat);\n                    }\n                    blocks.push(paragraph);\n                    paragraph.index = i;\n                    paragraph.containerWidget = container;\n                }\n                else if (block.hasOwnProperty('rows')) {\n                    this.parseTable(block, blocks, i, container);\n                }\n            }\n        }\n    };\n    SfdtReader.prototype.parseTable = function (block, blocks, index, section) {\n        var table = new TableWidget();\n        table.index = index;\n        table.tableFormat = new WTableFormat(table);\n        if (!isNullOrUndefined(block.tableFormat)) {\n            this.parseTableFormat(block.tableFormat, table.tableFormat);\n        }\n        table.title = block.title;\n        table.description = block.description;\n        for (var i = 0; i < block.rows.length; i++) {\n            var row = new TableRowWidget();\n            row.rowFormat = new WRowFormat(row);\n            var tableRow = block.rows[i];\n            if (tableRow.hasOwnProperty('rowFormat')) {\n                this.parseRowFormat(tableRow.rowFormat, row.rowFormat);\n                this.parseRowGridValues(tableRow, row.rowFormat);\n                this.parseRowGridValues(tableRow.rowFormat, row.rowFormat);\n                row.index = i;\n                for (var j = 0; j < block.rows[i].cells.length; j++) {\n                    var cell = new TableCellWidget();\n                    cell.cellFormat = new WCellFormat(cell);\n                    row.childWidgets.push(cell);\n                    cell.containerWidget = row;\n                    cell.index = j;\n                    cell.rowIndex = i;\n                    cell.columnIndex = j;\n                    if (block.rows[i].cells[j].hasOwnProperty('cellFormat')) {\n                        this.parseCellFormat(block.rows[i].cells[j].cellFormat, cell.cellFormat);\n                    }\n                    this.isPageBreakInsideTable = true;\n                    this.parseTextBody(block.rows[i].cells[j].blocks, cell);\n                    this.isPageBreakInsideTable = false;\n                }\n            }\n            table.childWidgets.push(row);\n            row.containerWidget = table;\n        }\n        table.containerWidget = section;\n        blocks.push(table);\n        table.isGridUpdated = false;\n    };\n    SfdtReader.prototype.parseRowGridValues = function (data, rowFormat) {\n        if (!isNullOrUndefined(data.gridBefore)) {\n            rowFormat.gridBefore = data.gridBefore;\n        }\n        if (!isNullOrUndefined(data.gridBeforeWidth)) {\n            rowFormat.gridBeforeWidth = data.gridBeforeWidth;\n        }\n        if (!isNullOrUndefined(data.gridBeforeWidthType)) {\n            rowFormat.gridBeforeWidthType = data.gridBeforeWidthType;\n        }\n        if (!isNullOrUndefined(data.gridAfter)) {\n            rowFormat.gridAfter = data.gridAfter;\n        }\n        if (!isNullOrUndefined(data.gridAfterWidth)) {\n            rowFormat.gridAfterWidth = data.gridAfterWidth;\n        }\n        if (!isNullOrUndefined(data.gridAfterWidthType)) {\n            rowFormat.gridAfterWidthType = data.gridAfterWidthType;\n        }\n    };\n    // tslint:disable:max-func-body-length\n    SfdtReader.prototype.parseParagraph = function (data, paragraph, writeInlineFormat) {\n        var lineWidget = new LineWidget(paragraph);\n        for (var i = 0; i < data.length; i++) {\n            var inline = data[i];\n            if (inline.hasOwnProperty('text')) {\n                var textElement = undefined;\n                if (this.viewer.isPageField) {\n                    textElement = new FieldTextElementBox();\n                    textElement.fieldBegin = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                }\n                else if (inline.text === '\\t') {\n                    textElement = new TabElementBox();\n                }\n                else if (inline.text === '\\f' && this.isPageBreakInsideTable) {\n                    continue;\n                }\n                else {\n                    textElement = new TextElementBox();\n                }\n                textElement.characterFormat = new WCharacterFormat(textElement);\n                this.parseCharacterFormat(inline.characterFormat, textElement.characterFormat, writeInlineFormat);\n                /*�tslint:disable-next-line:max-line-length */\n                if (!isNullOrUndefined(inline.characterFormat) && !isNullOrUndefined(inline.characterFormat.styleName)) {\n                    var charStyle = this.viewer.styles.findByName(inline.characterFormat.styleName, 'Character');\n                    textElement.characterFormat.ApplyStyle(charStyle);\n                }\n                textElement.text = inline.text;\n                textElement.line = lineWidget;\n                lineWidget.children.push(textElement);\n            }\n            else if (inline.hasOwnProperty('imageString')) {\n                var image = new ImageElementBox(data[i].isInlineImage);\n                image.isMetaFile = data[i].isMetaFile;\n                image.characterFormat = new WCharacterFormat(image);\n                image.line = lineWidget;\n                lineWidget.children.push(image);\n                var imageString = HelperMethods.formatClippedString(inline.imageString).formatClippedString;\n                var isValidImage = this.validateImageUrl(imageString);\n                if (!isValidImage) {\n                    // tslint:disable-next-line:max-line-length\n                    image.imageString = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAADgAADY2Njl5eVcXFxjY2NZWVl/f3+wsLCmpqb4+PiioqKpqam7u7vV1dX2uLj2wsLhFRXzpKT3vb30sbHhCwv74+P40dH+9vbkIyO2trbBwcHLy8tsbGycnJz529v4zMzrbGzlLS3qZmblNzfrdXXoRkbvi4vvgYHlHh7CZsBOAAADpUlEQVR4nO3da1faQBSF4ekAUQlUEFs14AXxVv7/D6yaQiZx5mSEYXF2ut+PNKzyyK5diYDmR9czx34AB49C/CjE759w3jvvWr15Tdgz3atXE54f++EcIArxoxA/CvGjED8K8aMQPwrxoxA/CvGLEeZ9jPJdhfk4GyCUjb3ECGE/Q6m/q3DwfudjP0ERZYN9hKdn2hvd3+0jHJz5/kBVuTk96bbQUEjhYR9ckiikUH8UUqg/CinUH4UU6o9CCvVHIYX6o5BC/VFIof4opFB/FFKoPwop1B+FFOqPQgrjyxfjVC38Lxk9tnAxGqZqdKtSOE4GHA5/fuNJpDCtcNHbv4VqYYqPLjgfUViPQgrjozA2CptRSGF8/59w+Wrt+rr1btNna1cPzg0wwuXavncxabnX7PfHYYXzlYARvlobQZyUR9mXm+1NMEK7SSLONgcVV9vb8IQXv4J3KSeKKlxXxNCzONkeYp8AV3p9UT1+P3FWHVAsq5thhGZSEb1DrSZq7dS5HUdoLiuBZ6jORG3tCwAkNJfCUJ2Jrqe1P0ESCkMNTdSACYNDDU7UoAkDQw1P1MAJvUMVJmrwhJ6hShM1gMIvQxUnahCFjaHKEzWQQneoxR95ogZTWBuqPFEDKnSHKk/UoArdoYoTNbDC5lBDEzW4QjMpYiZqgIXG/S76JhwHK5zVVipcnkIVuv/RW/HyFKhwYhuFr6NiCmdNoDBUSGFjovJQEYXuRN9ahwoorJ8uSZenPsMTNk+X2q6jwgm/ntHL11HhhL4zenmoYEL/Gb04VCxh6KKTNFQoYfiikzBUJKF00Sk8VCChfF00OFQcYdt10dBQYYRT5xn0n9G7Q0X8GfCzNNEyZ6iPgD/HlydaVg11DfhajJaJlm2HugIUrlomWrYZKuJKHz6vHhbSM/hROdRnxNe1meuXYvW0DB6+aflYrB7dlzDiCM3N1dVN6GDhMCDhjlHYjEIK46MwNgqbUUhhfJ/vA07wO8N1vw94ONo/3e/lTpVOYfc/UyG//ZmqW52fi/FuTNW3/lZ+eguF+qOQQv1RSKH+KKRQfxRSqD8KKdQfhRTqj0IK9UchhfqjkEL9UUih/iikUH8UUqg/CmXh6Hsv3jlK+wnvD/vgkrSHMMuyu1P9ZdmuwnycDQYn+svG3n9KEUKT9zHyf6+IEWJHIX4U4kchfhTiRyF+FOJHIX4U4kchfnVhijeZa6sunCf4ZdPamteEHY5C/CjEr/vCv0ec0g+AtS1QAAAAAElFTkSuQmCC';\n                }\n                else {\n                    image.imageString = inline.imageString;\n                }\n                image.width = HelperMethods.convertPointToPixel(inline.width);\n                image.height = HelperMethods.convertPointToPixel(inline.height);\n                this.parseCharacterFormat(inline.characterFormat, image.characterFormat);\n            }\n            else if (inline.hasOwnProperty('hasFieldEnd') || (inline.hasOwnProperty('fieldType') && inline.fieldType === 0)) {\n                var fieldBegin = new FieldElementBox(0);\n                fieldBegin.hasFieldEnd = inline.hasFieldEnd;\n                this.viewer.fieldStacks.push(fieldBegin);\n                fieldBegin.line = lineWidget;\n                this.viewer.fields.push(fieldBegin);\n                lineWidget.children.push(fieldBegin);\n            }\n            else if (inline.hasOwnProperty('fieldType')) {\n                var field = undefined;\n                if (inline.fieldType === 2) {\n                    field = new FieldElementBox(2);\n                    this.fieldSeparator = field;\n                    if (this.viewer.fieldStacks.length > 0) {\n                        field.fieldBegin = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                        field.fieldBegin.fieldSeparator = field;\n                        //finds the whether the field is page filed or not\n                        var lineWidgetCount = lineWidget.children.length;\n                        if (lineWidgetCount >= 2 && (lineWidget.children[lineWidgetCount - 2] instanceof FieldElementBox)\n                            && lineWidget.children[lineWidgetCount - 2].hasFieldEnd\n                            && (lineWidget.children[lineWidgetCount - 1] instanceof TextElementBox)) {\n                            var fieldElementText = lineWidget.children[lineWidgetCount - 1].text;\n                            if (fieldElementText.match('PAGE')) {\n                                this.viewer.isPageField = true;\n                            }\n                        }\n                    }\n                }\n                else if (inline.fieldType === 1) {\n                    field = new FieldElementBox(1);\n                    //For Field End Updated begin and separator.                                      \n                    if (this.viewer.fieldStacks.length > 0) {\n                        field.fieldBegin = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                        field.fieldBegin.fieldEnd = field;\n                    }\n                    if (!isNullOrUndefined(field.fieldBegin) && field.fieldBegin.fieldSeparator) {\n                        field.fieldSeparator = field.fieldBegin.fieldSeparator;\n                        field.fieldBegin.fieldSeparator.fieldEnd = field;\n                    }\n                    //After setting all the property clear the field values\n                    this.viewer.fieldStacks.splice(this.viewer.fieldStacks.length - 1, 1);\n                    this.fieldSeparator = undefined;\n                    this.viewer.isPageField = false;\n                    this.viewer.fieldCollection.push(field.fieldBegin);\n                }\n                field.line = lineWidget;\n                lineWidget.children.push(field);\n            }\n            else if (inline.hasOwnProperty('bookmarkType')) {\n                var bookmark = undefined;\n                bookmark = new BookmarkElementBox(inline.bookmarkType);\n                bookmark.name = inline.name;\n                lineWidget.children.push(bookmark);\n                bookmark.line = lineWidget;\n                if (inline.bookmarkType === 0) {\n                    this.viewer.bookmarks.add(bookmark.name, bookmark);\n                }\n                else if (inline.bookmarkType === 1) {\n                    if (this.viewer.bookmarks.containsKey(bookmark.name)) {\n                        var bookmarkStart = this.viewer.bookmarks.get(bookmark.name);\n                        bookmarkStart.reference = bookmark;\n                        bookmark.reference = bookmarkStart;\n                    }\n                }\n            }\n        }\n        paragraph.childWidgets.push(lineWidget);\n    };\n    SfdtReader.prototype.parseTableFormat = function (sourceFormat, tableFormat) {\n        this.parseBorders(sourceFormat.borders, tableFormat.borders);\n        if (!isNullOrUndefined(sourceFormat.allowAutoFit)) {\n            tableFormat.allowAutoFit = sourceFormat.allowAutoFit;\n        }\n        if (!isNullOrUndefined(sourceFormat.cellSpacing)) {\n            tableFormat.cellSpacing = sourceFormat.cellSpacing;\n        }\n        if (!isNullOrUndefined(sourceFormat.leftMargin)) {\n            tableFormat.leftMargin = sourceFormat.leftMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.topMargin)) {\n            tableFormat.topMargin = sourceFormat.topMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.rightMargin)) {\n            tableFormat.rightMargin = sourceFormat.rightMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.bottomMargin)) {\n            tableFormat.bottomMargin = sourceFormat.bottomMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.leftIndent)) {\n            tableFormat.leftIndent = sourceFormat.leftIndent;\n        }\n        this.parseShading(sourceFormat.shading, tableFormat.shading);\n        if (!isNullOrUndefined(sourceFormat.tableAlignment)) {\n            tableFormat.tableAlignment = sourceFormat.tableAlignment;\n        }\n        if (!isNullOrUndefined(sourceFormat.preferredWidth)) {\n            tableFormat.preferredWidth = sourceFormat.preferredWidth;\n        }\n        if (!isNullOrUndefined(sourceFormat.preferredWidthType)) {\n            tableFormat.preferredWidthType = sourceFormat.preferredWidthType;\n        }\n        if (!isNullOrUndefined(sourceFormat.bidi)) {\n            tableFormat.bidi = sourceFormat.bidi;\n        }\n    };\n    SfdtReader.prototype.parseCellFormat = function (sourceFormat, cellFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            this.parseBorders(sourceFormat.borders, cellFormat.borders);\n            if (!sourceFormat.isSamePaddingAsTable) {\n                //    cellFormat.ClearMargins();\n                //else\n                this.parseCellMargin(sourceFormat, cellFormat);\n            }\n            if (!isNullOrUndefined(sourceFormat.cellWidth)) {\n                cellFormat.cellWidth = sourceFormat.cellWidth;\n            }\n            if (!isNullOrUndefined(sourceFormat.columnSpan)) {\n                cellFormat.columnSpan = sourceFormat.columnSpan;\n            }\n            if (!isNullOrUndefined(sourceFormat.rowSpan)) {\n                cellFormat.rowSpan = sourceFormat.rowSpan;\n            }\n            this.parseShading(sourceFormat.shading, cellFormat.shading);\n            if (!isNullOrUndefined(sourceFormat.verticalAlignment)) {\n                cellFormat.verticalAlignment = sourceFormat.verticalAlignment;\n            }\n            if (!isNullOrUndefined(sourceFormat.preferredWidthType)) {\n                cellFormat.preferredWidthType = sourceFormat.preferredWidthType;\n            }\n            if (!isNullOrUndefined(sourceFormat.preferredWidth)) {\n                cellFormat.preferredWidth = sourceFormat.preferredWidth;\n            }\n        }\n    };\n    SfdtReader.prototype.parseCellMargin = function (sourceFormat, cellFormat) {\n        if (!isNullOrUndefined(sourceFormat.leftMargin)) {\n            cellFormat.leftMargin = sourceFormat.leftMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.rightMargin)) {\n            cellFormat.rightMargin = sourceFormat.rightMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.topMargin)) {\n            cellFormat.topMargin = sourceFormat.topMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.bottomMargin)) {\n            cellFormat.bottomMargin = sourceFormat.bottomMargin;\n        }\n    };\n    SfdtReader.prototype.parseRowFormat = function (sourceFormat, rowFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            if (!isNullOrUndefined(sourceFormat.allowBreakAcrossPages)) {\n                rowFormat.allowBreakAcrossPages = sourceFormat.allowBreakAcrossPages;\n            }\n            if (!isNullOrUndefined(sourceFormat.isHeader)) {\n                rowFormat.isHeader = sourceFormat.isHeader;\n            }\n            if (!isNullOrUndefined(sourceFormat.heightType)) {\n                rowFormat.heightType = sourceFormat.heightType;\n            }\n            if (!isNullOrUndefined(sourceFormat.height)) {\n                rowFormat.height = sourceFormat.height;\n            }\n            this.parseBorders(sourceFormat.borders, rowFormat.borders);\n        }\n    };\n    SfdtReader.prototype.parseBorders = function (sourceBorders, destBorder) {\n        if (!isNullOrUndefined(sourceBorders)) {\n            this.parseBorder(sourceBorders.left, destBorder.left);\n            this.parseBorder(sourceBorders.right, destBorder.right);\n            this.parseBorder(sourceBorders.top, destBorder.top);\n            this.parseBorder(sourceBorders.bottom, destBorder.bottom);\n            this.parseBorder(sourceBorders.vertical, destBorder.vertical);\n            this.parseBorder(sourceBorders.horizontal, destBorder.horizontal);\n            this.parseBorder(sourceBorders.diagonalDown, destBorder.diagonalDown);\n            this.parseBorder(sourceBorders.diagonalUp, destBorder.diagonalUp);\n        }\n    };\n    SfdtReader.prototype.parseBorder = function (sourceBorder, destBorder) {\n        if (!isNullOrUndefined(sourceBorder)) {\n            if (!isNullOrUndefined(sourceBorder.color)) {\n                destBorder.color = this.getColor(sourceBorder.color);\n            }\n            if (!isNullOrUndefined(sourceBorder.lineStyle)) {\n                destBorder.lineStyle = sourceBorder.lineStyle;\n            }\n            if (!isNullOrUndefined(sourceBorder.lineWidth)) {\n                destBorder.lineWidth = sourceBorder.lineWidth;\n            }\n            if (!isNullOrUndefined(sourceBorder.hasNoneStyle)) {\n                destBorder.hasNoneStyle = sourceBorder.hasNoneStyle;\n            }\n        }\n    };\n    SfdtReader.prototype.parseShading = function (sourceShading, destShading) {\n        if (!isNullOrUndefined(sourceShading)) {\n            if (!isNullOrUndefined(sourceShading.backgroundColor)) {\n                destShading.backgroundColor = this.getColor(sourceShading.backgroundColor);\n            }\n            if (!isNullOrUndefined(sourceShading.foregroundColor)) {\n                destShading.foregroundColor = this.getColor(sourceShading.foregroundColor);\n            }\n            if (!isNullOrUndefined(sourceShading.texture) || !isNullOrUndefined(sourceShading.textureStyle)) {\n                destShading.textureStyle = !isNullOrUndefined(sourceShading.texture) ? sourceShading.texture : sourceShading.textureStyle;\n            }\n        }\n    };\n    SfdtReader.prototype.parseCharacterFormat = function (sourceFormat, characterFormat, writeInlineFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            if (writeInlineFormat && sourceFormat.hasOwnProperty('inlineFormat')) {\n                this.parseCharacterFormat(sourceFormat.inlineFormat, characterFormat);\n                return;\n            }\n            if (!isNullOrUndefined(sourceFormat.baselineAlignment)) {\n                characterFormat.baselineAlignment = sourceFormat.baselineAlignment;\n            }\n            if (!isNullOrUndefined(sourceFormat.underline)) {\n                characterFormat.underline = sourceFormat.underline;\n            }\n            if (!isNullOrUndefined(sourceFormat.strikethrough)) {\n                characterFormat.strikethrough = sourceFormat.strikethrough;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontSize)) {\n                characterFormat.fontSize = sourceFormat.fontSize;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontFamily)) {\n                characterFormat.fontFamily = sourceFormat.fontFamily;\n            }\n            if (!isNullOrUndefined(sourceFormat.bold)) {\n                characterFormat.bold = sourceFormat.bold;\n            }\n            if (!isNullOrUndefined(sourceFormat.italic)) {\n                characterFormat.italic = sourceFormat.italic;\n            }\n            if (!isNullOrUndefined(sourceFormat.highlightColor)) {\n                characterFormat.highlightColor = sourceFormat.highlightColor;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontColor)) {\n                characterFormat.fontColor = this.getColor(sourceFormat.fontColor);\n            }\n            if (!isNullOrUndefined(sourceFormat.bidi)) {\n                characterFormat.bidi = sourceFormat.bidi;\n            }\n            if (!isNullOrUndefined(sourceFormat.bdo)) {\n                characterFormat.bdo = sourceFormat.bdo;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontSizeBidi)) {\n                characterFormat.fontSizeBidi = sourceFormat.fontSizeBidi;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontFamilyBidi)) {\n                characterFormat.fontFamilyBidi = sourceFormat.fontFamilyBidi;\n            }\n            if (!isNullOrUndefined(sourceFormat.boldBidi)) {\n                characterFormat.boldBidi = sourceFormat.boldBidi;\n            }\n            if (!isNullOrUndefined(sourceFormat.italicBidi)) {\n                characterFormat.italicBidi = sourceFormat.italicBidi;\n            }\n        }\n    };\n    SfdtReader.prototype.getColor = function (color) {\n        var convertColor = color;\n        return convertColor || '#ffffff';\n    };\n    SfdtReader.prototype.parseParagraphFormat = function (sourceFormat, paragraphFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            if (!isNullOrUndefined(sourceFormat.bidi)) {\n                paragraphFormat.bidi = sourceFormat.bidi;\n            }\n            if (!isNullOrUndefined(sourceFormat.leftIndent)) {\n                paragraphFormat.leftIndent = sourceFormat.leftIndent;\n            }\n            if (!isNullOrUndefined(sourceFormat.rightIndent)) {\n                paragraphFormat.rightIndent = sourceFormat.rightIndent;\n            }\n            if (!isNullOrUndefined(sourceFormat.firstLineIndent)) {\n                paragraphFormat.firstLineIndent = sourceFormat.firstLineIndent;\n            }\n            if (!isNullOrUndefined(sourceFormat.afterSpacing)) {\n                paragraphFormat.afterSpacing = sourceFormat.afterSpacing;\n            }\n            if (!isNullOrUndefined(sourceFormat.beforeSpacing)) {\n                paragraphFormat.beforeSpacing = sourceFormat.beforeSpacing;\n            }\n            if (!isNullOrUndefined(sourceFormat.lineSpacing)) {\n                paragraphFormat.lineSpacing = sourceFormat.lineSpacing;\n            }\n            if (!isNullOrUndefined(sourceFormat.lineSpacingType)) {\n                paragraphFormat.lineSpacingType = sourceFormat.lineSpacingType;\n            }\n            if (!isNullOrUndefined(sourceFormat.textAlignment)) {\n                paragraphFormat.textAlignment = sourceFormat.textAlignment;\n            }\n            if (!isNullOrUndefined(sourceFormat.outlineLevel)) {\n                paragraphFormat.outlineLevel = sourceFormat.outlineLevel;\n            }\n            paragraphFormat.listFormat = new WListFormat();\n            if (sourceFormat.hasOwnProperty('listFormat')) {\n                this.parseListFormat(sourceFormat, paragraphFormat.listFormat);\n            }\n            if (sourceFormat.hasOwnProperty('tabs')) {\n                this.parseTabStop(sourceFormat.tabs, paragraphFormat.tabs);\n            }\n        }\n    };\n    SfdtReader.prototype.parseListFormat = function (block, listFormat) {\n        if (!isNullOrUndefined(block.listFormat)) {\n            if (!isNullOrUndefined(block.listFormat.listId)) {\n                listFormat.listId = block.listFormat.listId;\n                listFormat.list = this.viewer.getListById(block.listFormat.listId);\n            }\n            if (!isNullOrUndefined(block.listFormat.listLevelNumber)) {\n                listFormat.listLevelNumber = block.listFormat.listLevelNumber;\n            }\n        }\n    };\n    SfdtReader.prototype.parseSectionFormat = function (data, sectionFormat) {\n        if (!isNullOrUndefined(data.pageWidth)) {\n            sectionFormat.pageWidth = data.pageWidth;\n        }\n        if (!isNullOrUndefined(data.pageHeight)) {\n            sectionFormat.pageHeight = data.pageHeight;\n        }\n        if (!isNullOrUndefined(data.leftMargin)) {\n            sectionFormat.leftMargin = data.leftMargin;\n        }\n        if (!isNullOrUndefined(data.topMargin)) {\n            sectionFormat.topMargin = data.topMargin;\n        }\n        if (!isNullOrUndefined(data.rightMargin)) {\n            sectionFormat.rightMargin = data.rightMargin;\n        }\n        if (!isNullOrUndefined(data.bottomMargin)) {\n            sectionFormat.bottomMargin = data.bottomMargin;\n        }\n        if (!isNullOrUndefined(data.headerDistance)) {\n            sectionFormat.headerDistance = data.headerDistance;\n        }\n        if (!isNullOrUndefined(data.footerDistance)) {\n            sectionFormat.footerDistance = data.footerDistance;\n        }\n        if (!isNullOrUndefined(data.differentFirstPage)) {\n            sectionFormat.differentFirstPage = data.differentFirstPage;\n        }\n        if (!isNullOrUndefined(data.differentOddAndEvenPages)) {\n            sectionFormat.differentOddAndEvenPages = data.differentOddAndEvenPages;\n        }\n        if (!isNullOrUndefined(data.bidi)) {\n            sectionFormat.bidi = data.bidi;\n        }\n    };\n    SfdtReader.prototype.parseTabStop = function (wTabs, tabs) {\n        for (var i = 0; i < wTabs.length; i++) {\n            var tabStop = new WTabStop();\n            tabStop.position = wTabs[i].position;\n            tabStop.tabLeader = wTabs[i].tabLeader;\n            tabStop.deletePosition = wTabs[i].deletePosition;\n            tabStop.tabJustification = wTabs[i].tabJustification;\n            tabs.push(tabStop);\n        }\n    };\n    SfdtReader.prototype.validateImageUrl = function (imagestr) {\n        var keyStr = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n        imagestr = imagestr.replace(/[^A-Za-z0-9\\+\\/\\=]/g, '');\n        var totalLength = imagestr.length * 3 / 4;\n        if (imagestr.charAt(imagestr.length - 1) === keyStr.charAt(64)) {\n            totalLength--;\n        }\n        if (imagestr.charAt(imagestr.length - 2) === keyStr.charAt(64)) {\n            totalLength--;\n        }\n        if (totalLength % 1 !== 0) {\n            // totalLength is not an integer, the length does not match a valid\n            // base64 content. That can happen if:\n            // - the imagestr is not a base64 content\n            // - the imagestr is *almost* a base64 content, with a extra chars at the\n            // beginning or at the end\n            // - the imagestr uses a base64 variant (base64url for example)\n            return false;\n        }\n        return true;\n    };\n    return SfdtReader;\n}());\nexport { SfdtReader };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WCharacterFormat } from '../index';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar TextHelper = /** @class */ (function () {\n    function TextHelper(viewer) {\n        this.paragraphMarkInfo = {};\n        this.owner = viewer;\n        if (!isNullOrUndefined(viewer)) {\n            this.context = viewer.containerContext;\n        }\n    }\n    Object.defineProperty(TextHelper.prototype, \"paragraphMark\", {\n        get: function () {\n            return '¶';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextHelper.prototype, \"lineBreakMark\", {\n        get: function () {\n            return '↲';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TextHelper.prototype.getParagraphMarkWidth = function (characterFormat) {\n        return this.getParagraphMarkSize(characterFormat).Width;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getParagraphMarkSize = function (characterFormat) {\n        var format = this.getFormatText(characterFormat);\n        if (this.paragraphMarkInfo[format]) {\n            return this.paragraphMarkInfo[format];\n        }\n        // Gets the text element's width;\n        var width = this.getWidth(this.paragraphMark, characterFormat);\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(characterFormat);\n        var textSizeInfo = {\n            'Width': width, 'Height': textHelper.Height, 'BaselineOffset': textHelper.BaselineOffset\n        };\n        return this.paragraphMarkInfo[format] = textSizeInfo;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getTextSize = function (elementBox, characterFormat) {\n        // Gets the text element's width;\n        var textTrimEndWidth = 0;\n        var isRTL = characterFormat.bidi || this.isRTLText(elementBox.text);\n        var text = this.setText(elementBox.text, isRTL, characterFormat.bdo);\n        textTrimEndWidth = this.getWidth(text, characterFormat);\n        elementBox.width = textTrimEndWidth;\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(characterFormat);\n        elementBox.height = textHelper.Height;\n        elementBox.baselineOffset = textHelper.BaselineOffset;\n        if (elementBox.text[elementBox.text.length - 1] === ' ') {\n            textTrimEndWidth = this.getWidth(HelperMethods.trimEnd(elementBox.text), characterFormat);\n        }\n        return textTrimEndWidth;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getHeight = function (characterFormat) {\n        // Get character format property as  below predefined structure to make it easy to check and retrieve\n        // Predefined static structure `[FontName];[FontSize];bold;italic` to maintain as key in the collection \n        var key = this.getFormatText(characterFormat);\n        if (!isNullOrUndefined(this.owner.heightInfoCollection[key])) {\n            return this.owner.heightInfoCollection[key];\n        }\n        var sizeInfo = this.getHeightInternal(characterFormat);\n        this.owner.heightInfoCollection[key] = sizeInfo;\n        return sizeInfo;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getFormatText = function (characterFormat) {\n        var formatText = characterFormat.fontFamily.toLocaleLowerCase();\n        formatText += ';' + characterFormat.fontSize;\n        if (characterFormat.bold) {\n            formatText += ';' + 'bold';\n        }\n        if (characterFormat.italic) {\n            formatText += ';' + 'italic';\n        }\n        return formatText;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getHeightInternal = function (characterFormat) {\n        var textHeight = 0;\n        var baselineOffset = 0;\n        var spanElement = document.createElement('span');\n        spanElement.innerText = 'm';\n        this.applyStyle(spanElement, characterFormat);\n        var parentDiv = document.createElement('div');\n        parentDiv.style.display = 'inline-block';\n        var tempDiv = document.createElement('div');\n        tempDiv.setAttribute('style', 'display:inline-block;width: 1px; height: 0px;vertical-align: baseline;');\n        parentDiv.appendChild(spanElement);\n        parentDiv.appendChild(tempDiv);\n        document.body.appendChild(parentDiv);\n        // Sets the text element's height.\n        textHeight = spanElement.offsetHeight;\n        // Calculate the text element's baseline offset.\n        var textTopVal = spanElement.offsetTop;\n        var tempDivTopVal = tempDiv.offsetTop;\n        baselineOffset = tempDivTopVal - textTopVal;\n        document.body.removeChild(parentDiv);\n        return { 'Height': textHeight, 'BaselineOffset': baselineOffset };\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.measureTextExcludingSpaceAtEnd = function (text, characterFormat) {\n        return this.getWidth(HelperMethods.trimEnd(text), characterFormat);\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getWidth = function (text, characterFormat) {\n        if (text.match('\\v')) {\n            text.replace('\\v', this.lineBreakMark);\n        }\n        var bold = '';\n        var italic = '';\n        var fontFamily = '';\n        var fontSize = characterFormat.fontSize;\n        bold = characterFormat.bold ? 'bold' : '';\n        italic = characterFormat.italic ? 'italic' : '';\n        fontFamily = characterFormat.fontFamily;\n        fontSize = fontSize === 0 ? 0.5 : fontSize / (characterFormat.baselineAlignment === 'Normal' ? 1 : 1.5);\n        this.context.font = bold + ' ' + italic + ' ' + fontSize + 'pt' + ' ' + fontFamily;\n        return this.context.measureText(text).width;\n    };\n    TextHelper.prototype.setText = function (textToRender, isBidi, bdo, isRender) {\n        if (isNullOrUndefined(isRender)) {\n            isRender = false;\n        }\n        if (textToRender.length === 0) {\n            return '';\n        }\n        var isRtlText = isBidi;\n        if ((!isRtlText && (bdo === 'RTL')) || (isRtlText && (bdo === 'LTR'))) {\n            textToRender = HelperMethods.ReverseString(textToRender);\n        }\n        else if (isRender && isRtlText && HelperMethods.endsWith(textToRender)) {\n            var spaceCount = textToRender.length - HelperMethods.trimEnd(textToRender).length;\n            textToRender = HelperMethods.addSpace(spaceCount) + HelperMethods.trimEnd(textToRender);\n        }\n        return textToRender;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.applyStyle = function (spanElement, characterFormat) {\n        if (!isNullOrUndefined(spanElement) && !isNullOrUndefined(characterFormat)) {\n            var style = 'white-space:nowrap;';\n            if (characterFormat.fontFamily !== '') {\n                style += 'font-family:' + characterFormat.fontFamily + ';';\n            }\n            var fontSize = characterFormat.fontSize;\n            if (fontSize <= 0.5) {\n                fontSize = 0.5;\n            }\n            style += 'font-size:' + fontSize.toString() + 'pt;';\n            if (characterFormat.bold) {\n                style += 'font-weight:bold;';\n            }\n            if (characterFormat.italic) {\n                style += 'font-style:italic;';\n            }\n            spanElement.setAttribute('style', style);\n        }\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.measureText = function (text, characterFormat) {\n        // Gets the text element's width;\n        var width = this.getWidth(text, characterFormat);\n        var height = 0;\n        var baselineOffset = 0;\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(characterFormat);\n        return {\n            'Width': width, 'Height': textHelper.Height, 'BaselineOffset': textHelper.BaselineOffset\n        };\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.updateTextSize = function (elementBox, paragraph) {\n        var format = new WCharacterFormat(undefined);\n        var listCharacterFormat = elementBox.listLevel.characterFormat;\n        var breakCharacterFormat = paragraph.characterFormat;\n        format.fontSize = listCharacterFormat.fontSize === 11 ? breakCharacterFormat.fontSize : listCharacterFormat.fontSize;\n        format.fontFamily = listCharacterFormat.fontFamily === 'Verdana' ? breakCharacterFormat.fontFamily\n            : listCharacterFormat.fontFamily;\n        var bold = '';\n        var italic = '';\n        var baselineAlignment = listCharacterFormat.baselineAlignment === 'Normal' ?\n            breakCharacterFormat.baselineAlignment : listCharacterFormat.baselineAlignment;\n        bold = listCharacterFormat.bold ? 'bold' : breakCharacterFormat.bold ? 'bold' : '';\n        italic = listCharacterFormat.italic ? 'italic' : breakCharacterFormat.italic ? 'italic' : '';\n        format.baselineAlignment = baselineAlignment;\n        if (bold) {\n            format.bold = true;\n        }\n        if (italic) {\n            format.italic = true;\n        }\n        var isRTL = format.bidi || this.isRTLText(elementBox.text);\n        var text = this.setText(elementBox.text, isRTL, format.bdo);\n        elementBox.width = this.getWidth(text, format);\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(format);\n        elementBox.height = textHelper.Height;\n        elementBox.baselineOffset = textHelper.BaselineOffset;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.isRTLText = function (text) {\n        var isRTL = false;\n        if (!isNullOrUndefined(text)) {\n            for (var i = 0; i < text.length; i++) {\n                var temp = text[i];\n                if ((temp >= '\\u0590' && temp <= '\\u05ff') //Hebrew characters\n                    || (temp >= '\\u0600' && temp <= '\\u06ff') //Arabic - Urdu characters\n                    || (temp >= '\\u0750' && temp <= '\\u077f') //Arabic - Urdu characters\n                    || (temp >= '\\u08a0' && temp <= '\\u08ff') //Arabic characters\n                    || (temp >= '\\ufb50' && temp <= '\\ufdff') //Arabic - Urdu characters\n                    || (temp >= '\\ufe70' && temp <= '\\ufeff') //Arabic - Urdu characters\n                    || (temp >= '\\ua980' && temp <= '\\ua9df') //Javanese characters\n                    || (temp >= '\\u0700' && temp <= '\\u074f') //Syriac characters\n                    || (temp >= '\\u0780' && temp <= '\\u07bf') //Thaana characters\n                    || (temp >= '\\u0840' && temp <= '\\u085f') //Mandiac characters\n                    || (temp >= '\\u07c0' && temp <= '\\u07ff') //N'Ko characters\n                    || (temp >= '\\u0800' && temp <= '\\u083f') //Samaritan characters\n                    //Tifinag characters \n                    || (temp >= '\\u2d30' && temp <= '\\u2d7f')) {\n                    isRTL = true;\n                    break;\n                }\n            }\n        }\n        return isRTL;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getRtlLanguage = function (text) {\n        if (isNullOrUndefined(text) || text === '') {\n            return { isRtl: false, id: 0 };\n        }\n        if (text >= '\\u0590' && text <= '\\u05ff') {\n            return { isRtl: true, id: 1 };\n            //Arabic - Urdu characters\n        }\n        else if ((text >= '\\u0600' && text <= '\\u06ff')\n            || (text >= '\\u0750' && text <= '\\u077f')\n            || (text >= '\\u08a0' && text <= '\\u08ff')\n            || (text >= '\\ufb50' && text <= '\\ufdff')\n            || (text >= '\\ufe70' && text <= '\\ufeff')) {\n            return { isRtl: true, id: 2 };\n        }\n        else if (text >= '\\ua980' && text <= '\\ua9df') {\n            return { isRtl: true, id: 3 };\n        }\n        else if (text >= '\\u0700' && text <= '\\u074f') {\n            return { isRtl: true, id: 4 };\n        }\n        else if (text >= '\\u0780' && text <= '\\u07bf') {\n            return { isRtl: true, id: 5 };\n        }\n        else if (text >= '\\u0840' && text <= '\\u085f') {\n            return { isRtl: true, id: 6 };\n        }\n        else if (text >= '\\u07c0' && text <= '\\u07ff') {\n            return { isRtl: true, id: 7 };\n        }\n        else if (text >= '\\u0800' && text <= '\\u083f') {\n            return { isRtl: true, id: 8 };\n        }\n        else if (text >= '\\u2d30' && text <= '\\u2d7f') {\n            return { isRtl: true, id: 9 };\n        }\n        return { isRtl: false, id: 0 };\n    };\n    TextHelper.prototype.destroy = function () {\n        this.owner = undefined;\n        this.context = undefined;\n        this.paragraphMarkInfo = {};\n        this.paragraphMarkInfo = undefined;\n    };\n    return TextHelper;\n}());\nexport { TextHelper };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Dictionary } from '../../base/dictionary';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { WCharacterFormat, WParagraphFormat, WStyles } from '../format/index';\nimport { Layout } from './layout';\nimport { Renderer } from './render';\nimport { createElement, Browser } from '@syncfusion/ej2-base';\nimport { Page, Rect, ListTextElementBox, ParagraphWidget, HeaderFooterWidget } from './page';\nimport { LineWidget, TableWidget } from './page';\nimport { HelperMethods, Point } from '../editor/editor-helper';\nimport { TextHelper } from './text-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Zoom } from './zooming';\nimport { Dialog } from '@syncfusion/ej2-popups';\n/**\n * @private\n */\nvar LayoutViewer = /** @class */ (function () {\n    //#endregion\n    function LayoutViewer(owner) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.textWrap = true;\n        /**\n         * @private\n         */\n        this.currentPage = undefined;\n        this.selectionStartPageIn = undefined;\n        this.selectionEndPageIn = undefined;\n        /**\n         * @private\n         */\n        this.fieldStacks = [];\n        /**\n         * @private\n         */\n        this.splittedCellWidgets = [];\n        /**\n         * @private\n         */\n        this.tableLefts = [];\n        this.tapCount = 0;\n        this.timer = -1;\n        this.isTimerStarted = false;\n        /**\n         * @private\n         */\n        this.isFirstLineFitInShiftWidgets = false;\n        /**\n         * @private\n         */\n        this.preZoomFactor = 0;\n        /**\n         * @private\n         */\n        this.preDifference = -1;\n        /**\n         * @private\n         */\n        this.fieldEndParagraph = undefined;\n        /**\n         * @private\n         */\n        this.fieldToLayout = undefined;\n        /**\n         * @private\n         */\n        this.backgroundColor = '#FFFFFF';\n        /**\n         * @private\n         */\n        this.containerTop = 0;\n        /**\n         * @private\n         */\n        this.containerLeft = 0;\n        // Event \n        /**\n         * @private\n         */\n        this.isMouseDown = false;\n        /**\n         * @private\n         */\n        this.isSelectionChangedOnMouseMoved = false;\n        /**\n         * @private\n         */\n        this.isControlPressed = false;\n        /**\n         * @private\n         */\n        this.isTouchInput = false;\n        /**\n         * @private\n         */\n        this.useTouchSelectionMark = false;\n        /**\n         * @private\n         */\n        this.touchDownOnSelectionMark = 0;\n        /**\n         * @private\n         */\n        this.isComposingIME = false;\n        /**\n         * @private\n         */\n        this.lastComposedText = '';\n        /**\n         * @private\n         */\n        this.isCompositionStart = false;\n        /**\n         * @private\n         */\n        this.isCompositionUpdated = false;\n        /**\n         * @private\n         */\n        this.isCompositionCanceled = false;\n        /**\n         * @private\n         */\n        this.isCompositionEnd = false;\n        /**\n         * @private\n         */\n        this.prefix = '';\n        /**\n         * @private\n         */\n        this.suffix = '';\n        /**\n         * @private\n         */\n        this.fields = [];\n        /**\n         * @private\n         */\n        this.heightInfoCollection = {};\n        /**\n         * @private\n         */\n        this.defaultTabWidth = 36;\n        /**\n         * @private\n         */\n        this.lists = [];\n        /**\n         * @private\n         */\n        this.abstractLists = [];\n        /**\n         * @private\n         */\n        this.styles = new WStyles();\n        /**\n         * @private\n         */\n        this.preDefinedStyles = undefined;\n        /**\n         * @private\n         */\n        this.isRowOrCellResizing = false;\n        this.isMouseDownInFooterRegion = false;\n        this.pageFitTypeIn = 'None';\n        /**\n         * @private\n         */\n        this.fieldCollection = [];\n        /**\n         * @private\n         */\n        this.isPageField = false;\n        /**\n         * @private\n         */\n        this.mouseDownOffset = new Point(0, 0);\n        this.zoomFactorInternal = 1;\n        /**\n         * If movecaretposition is 1, Home key is pressed\n         * If moveCaretPosition is 2, End key is pressed\n         * @private\n         */\n        this.moveCaretPosition = 0;\n        /**\n         * @private\n         */\n        this.isTextInput = false;\n        /**\n         * @private\n         */\n        this.onTextInput = function (event) {\n            if (!_this.isComposingIME) {\n                event.preventDefault();\n                var text = event.data;\n                _this.owner.editor.handleTextInput(text);\n            }\n        };\n        //#region Composition Event\n        /**\n         * Fires when composition starts.\n         * @private\n         */\n        this.compositionStart = function (event) {\n            if (!Browser.isDevice && !_this.owner.isReadOnlyMode) {\n                _this.isComposingIME = true;\n                _this.positionEditableTarget();\n                if (_this.owner.editorHistory) {\n                    _this.owner.editor.initComplexHistory('IMEInput');\n                }\n            }\n            _this.isCompositionStart = true;\n        };\n        /**\n         * Fires on every input during composition.\n         * @private\n         */\n        this.compositionUpdated = function (event) {\n            if (_this.isComposingIME && !_this.owner.isReadOnlyMode) {\n                /* tslint:disable:align */\n                setTimeout(function () {\n                    _this.owner.editor.insertIMEText(_this.getEditableDivTextContent(), true);\n                }, 0);\n            }\n            _this.isCompositionUpdated = true;\n        };\n        /**\n         * Fires when user selects a character/word and finalizes the input.\n         * @private\n         */\n        this.compositionEnd = function (event) {\n            if (_this.isComposingIME && !_this.owner.isReadOnlyMode) {\n                var text = _this.getEditableDivTextContent();\n                if (text !== '') {\n                    _this.owner.editor.insertIMEText(text, false);\n                }\n                _this.isComposingIME = false;\n                _this.lastComposedText = '';\n                _this.iframe.setAttribute('style', 'pointer-events:none;position:absolute;top:-10000px');\n                _this.editableDiv.innerHTML = '';\n                if (_this.owner.editorHistory) {\n                    _this.owner.editorHistory.updateComplexHistory();\n                    if (text === '') {\n                        // tslint:disable-next-line:max-line-length\n                        //When the composition in live. The Undo operation will terminate the composition and empty text will be return from text box.\n                        //At that time the the history should be updated. Undo the operation and clear the redo stack. This undo operation will not be saved for redo operation.\n                        _this.owner.editorHistory.undo();\n                        _this.owner.editorHistory.redoStack.pop();\n                    }\n                }\n            }\n            event.preventDefault();\n            _this.isCompositionUpdated = false;\n            _this.isCompositionEnd = true;\n        };\n        // tslint:disable:no-any \n        this.onImageResizer = function (args) {\n            if (!isNullOrUndefined(_this.owner.imageResizerModule) && _this.owner.imageResizerModule.isImageResizerVisible\n                && _this.owner.imageResizerModule.isImageResizing) {\n                if (args instanceof MouseEvent) {\n                    _this.onMouseUpInternal(args);\n                }\n                else if (args instanceof TouchEvent) {\n                    _this.onTouchUpInternal(args);\n                }\n            }\n        };\n        // tslint:enable:no-any \n        this.onKeyPressInternal = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                var key = event.keyCode || event.charCode;\n                var char = '';\n                if (key) {\n                    char = String.fromCharCode(key);\n                }\n                else if (event.key) {\n                    char = event.key;\n                }\n                // tslint:disable-next-line:max-line-length\n                if (char !== 'Spacebar' && char !== '\\r' && char !== '\\b' && char !== '\\u001B' && !_this.owner.isReadOnlyMode && event.ctrlKey === false) {\n                    _this.owner.editorModule.handleTextInput(char);\n                }\n                else if (char === 'Spacebar') {\n                    _this.owner.editorModule.handleTextInput(' ');\n                }\n                event.preventDefault();\n            }\n        };\n        this.onTextInputInternal = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.owner.editorModule.onTextInputInternal(event);\n            }\n            else {\n                _this.editableDiv.innerText = '';\n            }\n        };\n        /**\n         * Fired on paste.\n         * @param {ClipboardEvent} event\n         * @private\n         */\n        this.onPaste = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.owner.editorModule.pasteInternal(event);\n            }\n            _this.editableDiv.innerText = '';\n            event.preventDefault();\n        };\n        /**\n         * Fires when editable div loses focus.\n         * @private\n         */\n        this.onFocusOut = function () {\n            if (!isNullOrUndefined(_this.selection)) {\n                if (_this.owner.contextMenuModule && _this.owner.contextMenuModule.contextMenuInstance &&\n                    _this.owner.contextMenuModule.contextMenuInstance.element.style.display === 'block') {\n                    return;\n                }\n                _this.selection.hideCaret();\n            }\n        };\n        /**\n         * Updates focus to editor area.\n         * @private\n         */\n        this.updateFocus = function () {\n            if (_this.selection) {\n                _this.editableDiv.focus();\n                _this.selection.showCaret();\n            }\n        };\n        /**\n         * Fires on scrolling.\n         */\n        this.scrollHandler = function () {\n            _this.clearContent();\n            _this.updateScrollBars();\n            var vtHeight = _this.containerTop + _this.visibleBounds.height;\n            if (vtHeight > _this.pageContainer.offsetHeight) {\n                _this.viewerContainer.scrollTop = _this.containerTop - (vtHeight - _this.pageContainer.offsetHeight);\n            }\n            var viewer = _this;\n            if (viewer instanceof PageLayoutViewer && !isNullOrUndefined(_this.owner)) {\n                _this.owner.fireViewChange();\n            }\n        };\n        /**\n         * Fires when the window gets resized.\n         * @private\n         */\n        this.onWindowResize = function () {\n            var viewer = _this;\n            var resizeTimer;\n            /* tslint:disable:align */\n            resizeTimer = setTimeout(function () {\n                if (!isNullOrUndefined(viewer.owner) && !isNullOrUndefined(viewer.owner.element)) {\n                    viewer.updateViewerSizeInternal(viewer.owner.element);\n                    viewer.updateScrollBars();\n                    if (!isNullOrUndefined(_this.selection)) {\n                        _this.selection.updateCaretPosition();\n                    }\n                    viewer.updateTouchMarkPosition();\n                    if (viewer.owner.contextMenuModule && viewer.owner.contextMenuModule.contextMenuInstance) {\n                        viewer.owner.contextMenuModule.contextMenuInstance.close();\n                    }\n                    if (resizeTimer) {\n                        clearTimeout(resizeTimer);\n                    }\n                }\n            }, 200);\n        };\n        /**\n         * @private\n         */\n        this.onContextMenu = function (event) {\n            if (_this.owner.contextMenuModule) {\n                _this.owner.contextMenuModule.onContextMenuInternal(event);\n            }\n        };\n        /**\n         * Called on mouse down.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onMouseDownInternal = function (event) {\n            if (_this.isTouchInput || event.offsetX > (_this.visibleBounds.width - (_this.visibleBounds.width - _this.viewerContainer.clientWidth))\n                || event.offsetY > (_this.visibleBounds.height - (_this.visibleBounds.height - _this.viewerContainer.clientHeight))) {\n                return;\n            }\n            if (!isNullOrUndefined(_this.selection)) {\n                _this.updateCursor(event);\n                // tslint:disable-next-line:max-line-length\n                if (_this.isLeftButtonPressed(event) && !_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && !isNullOrUndefined(_this.owner.imageResizerModule.selectedResizeElement)) {\n                    _this.owner.imageResizerModule.isImageResizing = true;\n                }\n                event.preventDefault();\n                if (!_this.isTouchInput) {\n                    _this.selection.hideCaret();\n                }\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.findFocusedPage(cursorPoint, true);\n                _this.mouseDownOffset.x = touchPoint.x;\n                _this.mouseDownOffset.y = touchPoint.y;\n                // tslint:disable-next-line:max-line-length\n                _this.isMouseDownInFooterRegion = _this.selection.isCursorInsidePageRect(cursorPoint, _this.currentPage) && _this.selection.isCursorInFooterRegion(cursorPoint, _this.currentPage);\n                _this.isSelectionChangedOnMouseMoved = false;\n                if (!_this.owner.isReadOnlyMode && (_this.owner.editorModule.tableResize.isInCellResizerArea(touchPoint) ||\n                    _this.owner.editorModule.tableResize.isInRowResizerArea(touchPoint))) {\n                    _this.selection.hideCaret();\n                    _this.isMouseDown = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                    if (_this.isLeftButtonPressed(event)) {\n                        _this.owner.editorModule.tableResize.startingPoint.x = touchPoint.x;\n                        _this.owner.editorModule.tableResize.startingPoint.y = touchPoint.y;\n                        _this.owner.editorModule.tableResize.handleResize(touchPoint);\n                    }\n                    return;\n                }\n                if (event.ctrlKey) {\n                    _this.isControlPressed = true;\n                }\n                if (_this.owner.selection.isEmpty) {\n                    _this.useTouchSelectionMark = false;\n                }\n                if (event.which === 3 && !_this.owner.selection.isEmpty\n                    && _this.selection.checkCursorIsInSelection(_this.getLineWidget(touchPoint), touchPoint)) {\n                    event.preventDefault();\n                    return;\n                }\n                _this.isTouchInput = false;\n                _this.isMouseDown = true;\n                _this.updateFocus();\n                /* tslint:disable:align */\n                _this.timer = setTimeout(function () {\n                    _this.tapCount++;\n                    if (_this.tapCount === 4) {\n                        _this.tapCount = 1;\n                    }\n                }, 200);\n            }\n        };\n        /**\n         * Called on mouse move.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onMouseMoveInternal = function (event) {\n            event.preventDefault();\n            if (!isNullOrUndefined(_this.selection)) {\n                //For image Resizing\n                if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode\n                    && _this.owner.imageResizerModule.isImageResizing) {\n                    if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n                        _this.owner.imageResizerModule.handleImageResizingOnMouse(event);\n                    }\n                    return;\n                }\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.findFocusedPage(cursorPoint, !_this.owner.enableHeaderAndFooter);\n                if (_this.isMouseDown) {\n                    if (!isNullOrUndefined(_this.currentPage)) {\n                        var xPosition = touchPoint.x;\n                        var yPosition = touchPoint.y;\n                        if (!_this.owner.isReadOnlyMode && _this.isRowOrCellResizing) {\n                            _this.owner.editorModule.tableResize.handleResizing(touchPoint);\n                        }\n                        else {\n                            if (!(_this.isTouchInput || _this.isSelectionChangedOnMouseMoved || _this.touchDownOnSelectionMark > 0)) {\n                                _this.updateTextPositionForSelection(touchPoint, 1);\n                            }\n                            if (_this.isLeftButtonPressed(event)) {\n                                event.preventDefault();\n                                var touchY = yPosition;\n                                var textPosition = _this.owner.selection.end;\n                                var touchPoint_1 = new Point(xPosition, touchY);\n                                if (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizerVisible) {\n                                    _this.owner.selection.moveTextPosition(touchPoint_1, textPosition);\n                                }\n                                _this.isSelectionChangedOnMouseMoved = true;\n                            }\n                        }\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n                if (!_this.isRowOrCellResizing && !_this.isSelectionChangedOnMouseMoved) {\n                    _this.updateCursor(event);\n                }\n                if (_this.isRowOrCellResizing) {\n                    _this.selection.hideCaret();\n                }\n            }\n        };\n        /**\n         * Fired on double tap.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onDoubleTap = function (event) {\n            if (!isNullOrUndefined(_this.selection)) {\n                _this.isTouchInput = false;\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                if (_this.selection.checkAndEnableHeaderFooter(cursorPoint, _this.findFocusedPage(cursorPoint, true))) {\n                    return;\n                }\n                // tslint:disable-next-line:max-line-length\n                if (_this.selection.isEmpty && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)) {\n                    _this.owner.selection.selectCurrentWord();\n                    _this.selection.checkForCursorVisibility();\n                    _this.tapCount = 2;\n                }\n            }\n        };\n        /**\n         * Called on mouse up.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onMouseUpInternal = function (event) {\n            event.preventDefault();\n            _this.isListTextSelected = false;\n            var cursorPoint = new Point(event.offsetX, event.offsetY);\n            var touchPoint = _this.findFocusedPage(cursorPoint, true);\n            if (!isNullOrUndefined(_this.selection)) {\n                var tapCount = 1;\n                if (!Browser.isIE) {\n                    if (event.detail > 2) {\n                        tapCount = event.detail;\n                    }\n                }\n                else {\n                    tapCount = _this.tapCount;\n                }\n                if (_this.isRowOrCellResizing) {\n                    _this.owner.editorModule.tableResize.updateResizingHistory(touchPoint);\n                }\n                if (_this.isMouseDown && !_this.isSelectionChangedOnMouseMoved\n                    && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)\n                    && (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizing)) {\n                    if (_this.touchDownOnSelectionMark === 0 && !_this.isRowOrCellResizing) {\n                        _this.updateTextPositionForSelection(touchPoint, tapCount);\n                        if (Browser.isIE && tapCount === 2) {\n                            _this.selection.checkAndEnableHeaderFooter(cursorPoint, touchPoint);\n                        }\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n                if (!isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)\n                    && (_this.owner.selection.isEmpty || _this.owner.selection.isImageSelected) &&\n                    (((event.ctrlKey && _this.owner.useCtrlClickToFollowHyperlink ||\n                        !_this.owner.useCtrlClickToFollowHyperlink) && _this.isLeftButtonPressed(event) === true))) {\n                    _this.selection.navigateHyperLinkOnEvent(touchPoint, false);\n                }\n                if (!_this.owner.isReadOnlyMode && _this.isSelectionInListText(touchPoint)) {\n                    _this.selection.selectListText();\n                }\n                // tslint:disable-next-line:max-line-length\n                if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    _this.owner.imageResizerModule.mouseUpInternal();\n                    _this.scrollToPosition(_this.owner.selection.start, _this.owner.selection.end);\n                    _this.owner.imageResizerModule.isImageResizing = false;\n                    _this.owner.imageResizerModule.updateHistoryForImageResizer();\n                }\n                // tslint:disable-next-line:max-line-length\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && !isNullOrUndefined(_this.selection.caret)) {\n                    _this.selection.caret.style.display = 'none';\n                }\n                _this.isMouseDown = false;\n                _this.isSelectionChangedOnMouseMoved = false;\n                _this.isTouchInput = false;\n                _this.useTouchSelectionMark = true;\n                _this.isControlPressed = false;\n                _this.updateFocus();\n                if (_this.isListTextSelected) {\n                    _this.selection.hideCaret();\n                }\n                if (_this.owner.enableImageResizerMode) {\n                    var imageResizer = _this.owner.imageResizerModule;\n                    imageResizer.isImageResizing = false;\n                    imageResizer.isImageMoveToNextPage = false;\n                    imageResizer.leftValue = undefined;\n                    imageResizer.topValue = undefined;\n                }\n                _this.isMouseDownInFooterRegion = false;\n            }\n        };\n        /**\n         * Fired on touch start.\n         * @param {TouchEvent} event\n         * @private\n         */\n        this.onTouchStartInternal = function (event) {\n            if (_this.selection) {\n                _this.isCompositionStart = false;\n                _this.isCompositionEnd = false;\n                _this.isCompositionUpdated = false;\n                _this.isCompositionCanceled = true;\n                _this.isTouchInput = true;\n                if (_this.isTimerStarted) {\n                    if (_this.tapCount === 1) {\n                        _this.tapCount = 2;\n                    }\n                    else {\n                        _this.tapCount = 3;\n                        _this.isTimerStarted = false;\n                    }\n                }\n                else {\n                    _this.isTimerStarted = true;\n                    _this.tapCount = 1;\n                }\n                if (event.touches.length === 1) {\n                    _this.zoomX = event.touches[0].clientX;\n                    _this.zoomY = event.touches[0].clientY;\n                    if (_this.owner.selection.isEmpty) {\n                        _this.useTouchSelectionMark = false;\n                    }\n                    _this.isMouseDown = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                    var point = void 0;\n                    if (_this.isMouseDown) {\n                        point = _this.getTouchOffsetValue(event);\n                    }\n                    point = _this.findFocusedPage(point, true);\n                    if (_this.owner.enableImageResizerMode) {\n                        var resizeObj = _this.owner.imageResizerModule.getImagePointOnTouch(point);\n                        _this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n                    }\n                    // tslint:disable-next-line:max-line-length\n                    if (_this.owner.enableImageResizerMode && !isNullOrUndefined(_this.owner.imageResizerModule.selectedResizeElement)) {\n                        _this.owner.imageResizerModule.isImageResizing = true;\n                    }\n                    var x = _this.owner.selection.end.location.x;\n                    var y = _this.selection.getCaretBottom(_this.owner.selection.end, _this.owner.selection.isEmpty) + 9;\n                    //TouchDownOnSelectionMark will be 2 when touch end is pressed\n                    _this.touchDownOnSelectionMark = ((point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20)\n                        && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20)) ? 1 : 0;\n                    if (!_this.owner.selection.isEmpty && _this.touchDownOnSelectionMark === 0) {\n                        x = _this.owner.selection.start.location.x;\n                        y = _this.selection.getCaretBottom(_this.owner.selection.start, false) + 9;\n                        //TouchDownOnSelectionMark will be 1 when touch start is pressed\n                        _this.touchDownOnSelectionMark = ((point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20)\n                            && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20)) ? 2 : 0;\n                    }\n                }\n                if (!isNullOrUndefined(_this.owner.contextMenuModule) && _this.owner.contextMenuModule.contextMenuInstance) {\n                    _this.owner.contextMenuModule.contextMenuInstance.close();\n                }\n                if (_this.touchDownOnSelectionMark || event.touches.length > 1) {\n                    event.preventDefault();\n                }\n                _this.timer = setTimeout(function () {\n                    _this.isTimerStarted = false;\n                }, 200);\n            }\n        };\n        /**\n         * Fired on touch move.\n         * @param {TouchEvent} event\n         * @private\n         */\n        this.onTouchMoveInternal = function (event) {\n            var touch = event.touches;\n            var cursorPoint;\n            if (!isNullOrUndefined(_this.selection)) {\n                // tslint:disable-next-line:max-line-length\n                if (_this.owner.editorModule && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    event.preventDefault();\n                    if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n                        _this.owner.imageResizerModule.handleImageResizingOnTouch(event);\n                        _this.selection.caret.style.display = 'none';\n                    }\n                    return;\n                }\n                if (_this.isMouseDown) {\n                    cursorPoint = _this.getTouchOffsetValue(event);\n                    var touchPoint = _this.findFocusedPage(cursorPoint, true);\n                    if (_this.touchDownOnSelectionMark > 0 /*|| !this.useTouchSelectionMark*/) {\n                        event.preventDefault();\n                        var touchY = touchPoint.y;\n                        var textPosition = _this.owner.selection.end;\n                        var touchPointer = void 0;\n                        if (touchPoint.y <= 26) {\n                            touchY -= touchPoint.y < 0 ? 0 : touchPoint.y + 0.5;\n                        }\n                        else {\n                            touchY -= 36.5;\n                        }\n                        textPosition = _this.touchDownOnSelectionMark === 2 ? _this.selection.start : _this.selection.end;\n                        touchPoint = new Point(touchPoint.x, touchY);\n                        _this.owner.selection.moveTextPosition(touchPoint, textPosition);\n                        _this.isSelectionChangedOnMouseMoved = true;\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n            }\n            if (touch.length > 1) {\n                event.preventDefault();\n                _this.isMouseDown = false;\n                _this.zoomX = (touch[0].clientX + touch[1].clientX) / 2;\n                _this.zoomY = (touch[0].clientY + touch[1].clientY) / 2;\n                // tslint:disable-next-line:max-line-length\n                var currentDiff = Math.sqrt(Math.pow((touch[0].clientX - touch[1].clientX), 2) + Math.pow((touch[0].clientY - touch[1].clientY), 2));\n                if (_this.preDifference > -1) {\n                    if (currentDiff > _this.preDifference) {\n                        _this.onPinchOutInternal(event);\n                    }\n                    else if (currentDiff < _this.preDifference) {\n                        _this.onPinchInInternal(event);\n                    }\n                }\n                else if (_this.zoomFactor < 2) {\n                    if (_this.preDifference !== -1) {\n                        if (currentDiff > _this.preDifference) {\n                            _this.onPinchInInternal(event);\n                        }\n                    }\n                }\n                else if (_this.preDifference === -1) {\n                    if (_this.zoomFactor > 2) {\n                        if (currentDiff > _this.preDifference) {\n                            _this.onPinchInInternal(event);\n                        }\n                    }\n                }\n                _this.preDifference = currentDiff;\n            }\n        };\n        /**\n         * Fired on touch up.\n         * @param {TouchEvent} event\n         * @private\n         */\n        this.onTouchUpInternal = function (event) {\n            if (!isNullOrUndefined(_this.selection)) {\n                var point = _this.getTouchOffsetValue(event);\n                var touchPoint = _this.findFocusedPage(point, true);\n                if (event.changedTouches.length === 1) {\n                    _this.zoomX = undefined;\n                    _this.zoomY = undefined;\n                    // tslint:disable-next-line:max-line-length\n                    if (_this.isMouseDown && !_this.isSelectionChangedOnMouseMoved && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)) {\n                        if (_this.touchDownOnSelectionMark === 0) {\n                            _this.updateTextPositionForSelection(new Point(touchPoint.x, touchPoint.y), _this.tapCount);\n                            if (_this.tapCount === 2) {\n                                _this.selection.checkAndEnableHeaderFooter(point, touchPoint);\n                            }\n                        }\n                        if (_this.owner.selection.isEmpty) {\n                            _this.selection.updateCaretPosition();\n                        }\n                        _this.selection.checkForCursorVisibility();\n                    }\n                    if (!isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.selection.start)\n                        && !_this.isSelectionChangedOnMouseMoved && (_this.selection.isEmpty ||\n                        _this.selection.isImageField() && (!_this.owner.enableImageResizerMode ||\n                            _this.owner.enableImageResizerMode && !_this.owner.imageResizerModule.isImageResizing))) {\n                        _this.selection.navigateHyperLinkOnEvent(touchPoint, true);\n                    }\n                    _this.isMouseDown = false;\n                    _this.touchDownOnSelectionMark = 0;\n                    _this.useTouchSelectionMark = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                }\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    _this.owner.imageResizerModule.mouseUpInternal();\n                    _this.owner.imageResizerModule.isImageResizing = false;\n                    _this.owner.imageResizerModule.isImageMoveToNextPage = false;\n                    _this.scrollToPosition(_this.owner.selection.start, _this.owner.selection.end);\n                    _this.owner.imageResizerModule.updateHistoryForImageResizer();\n                }\n                // tslint:disable-next-line:max-line-length\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && _this.isTouchInput) {\n                    _this.touchStart.style.display = 'none';\n                    _this.touchEnd.style.display = 'none';\n                }\n                // if (!this.owner.isReadOnlyMode && this.isSelectionInListText(touchPoint)) {\n                //     this.selection.selectListText();\n                // }\n                event.preventDefault();\n            }\n            _this.preDifference = -1;\n            _this.isTouchInput = false;\n            if (!_this.isTimerStarted) {\n                _this.tapCount = 1;\n            }\n            if (_this.isListTextSelected) {\n                _this.selection.hideCaret();\n            }\n        };\n        /**\n         * Fired on keyup event.\n         * @private\n         */\n        this.onKeyUpInternal = function (event) {\n            if (Browser.isDevice) {\n                if (window.getSelection().anchorOffset !== _this.prefix.length) {\n                    _this.selection.setEditableDivCaretPosition(_this.editableDiv.innerText.length);\n                }\n            }\n            if (event.ctrlKey || (event.keyCode === 17 || event.which === 17)) {\n                _this.isControlPressed = false;\n            }\n        };\n        /**\n         * Fired on keydown.\n         * @private\n         */\n        this.onKeyDownInternal = function (event) {\n            var isHandled = false;\n            var keyEventArgs = { 'event': event, 'isHandled': false, source: _this.owner };\n            _this.owner.trigger('keyDown', keyEventArgs);\n            if (keyEventArgs.isHandled) {\n                return;\n            }\n            var key = event.which || event.keyCode;\n            var ctrl = (event.ctrlKey || event.metaKey) ? true : ((key === 17) ? true : false); // ctrl detection       \n            var shift = event.shiftKey ? event.shiftKey : ((key === 16) ? true : false); // Shift Key detection        \n            var alt = event.altKey ? event.altKey : ((key === 18) ? true : false); // alt key detection\n            if (ctrl && !shift && !alt) {\n                switch (key) {\n                    case 80:\n                        event.preventDefault();\n                        _this.owner.print();\n                        isHandled = true;\n                        break;\n                    case 83:\n                        event.preventDefault();\n                        _this.owner.save(_this.owner.documentName === '' ? 'sample' : _this.owner.documentName, 'Sfdt');\n                        isHandled = true;\n                        break;\n                }\n            }\n            if (!isHandled && !isNullOrUndefined(_this.selection)) {\n                _this.selection.onKeyDownInternal(event, ctrl, shift, alt);\n            }\n            if (isHandled) {\n                event.preventDefault();\n            }\n        };\n        this.owner = owner;\n        this.pages = [];\n        this.render = new Renderer(this);\n        this.lists = [];\n        this.abstractLists = [];\n        this.characterFormat = new WCharacterFormat(this);\n        this.paragraphFormat = new WParagraphFormat(this);\n        this.renderedLists = new Dictionary();\n        this.headersFooters = [];\n        this.styles = new WStyles();\n        this.preDefinedStyles = new Dictionary();\n        this.initalizeStyles();\n        this.bookmarks = new Dictionary();\n    }\n    Object.defineProperty(LayoutViewer.prototype, \"containerCanvas\", {\n        //#region Properties\n        /**\n         * Gets container canvas.\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.containerCanvasIn)) {\n                this.containerCanvasIn = document.createElement('canvas');\n                this.containerCanvasIn.getContext('2d').save();\n            }\n            if (!isNullOrUndefined(this.pageContainer)\n                && this.containerCanvasIn.parentElement !== this.pageContainer) {\n                this.pageContainer.appendChild(this.containerCanvasIn);\n            }\n            return this.containerCanvasIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionCanvas\", {\n        /**\n         * Gets selection canvas.\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.selectionCanvasIn)) {\n                this.selectionCanvasIn = document.createElement('canvas');\n                this.selectionCanvas.getContext('2d').save();\n            }\n            if (!isNullOrUndefined(this.pageContainer)\n                && this.selectionCanvasIn.parentElement !== this.pageContainer) {\n                this.pageContainer.appendChild(this.selectionCanvasIn);\n            }\n            return this.selectionCanvasIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"containerContext\", {\n        /**\n         * Gets container context.\n         * @private\n         */\n        get: function () {\n            return this.containerCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionContext\", {\n        /**\n         * Gets selection context.\n         * @private\n         */\n        get: function () {\n            return this.selectionCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"currentRenderingPage\", {\n        /**\n         * Gets the current rendering page.\n         */\n        get: function () {\n            if (this.pages.length === 0) {\n                return undefined;\n            }\n            return this.pages[this.pages.length - 1];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"visibleBounds\", {\n        /**\n         * Gets visible bounds.\n         * @private\n         */\n        get: function () {\n            return this.visibleBoundsIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"zoomFactor\", {\n        /**\n         * Gets or sets zoom factor.\n         * @private\n         */\n        get: function () {\n            return this.zoomFactorInternal;\n        },\n        set: function (value) {\n            if (this.zoomFactorInternal !== value) {\n                this.preZoomFactor = this.zoomFactor;\n                this.zoomFactorInternal = value;\n                this.zoomModule.setZoomFactor(value);\n                this.owner.zoomFactor = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selection\", {\n        /**\n         * Gets the selection.\n         * @private\n         */\n        get: function () {\n            return this.owner.selection;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionStartPage\", {\n        /**\n         * Gets or sets selection start page.\n         * @private\n         */\n        get: function () {\n            return this.selectionStartPageIn;\n        },\n        set: function (value) {\n            this.selectionStartPageIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionEndPage\", {\n        /**\n         * Gets or sets selection end page.\n         * @private\n         */\n        get: function () {\n            return this.selectionEndPageIn;\n        },\n        set: function (value) {\n            this.selectionEndPageIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"dialog\", {\n        /**\n         * Gets the initialized default dialog.\n         * @private\n         */\n        get: function () {\n            if (!this.dialogInternal) {\n                this.initDialog(this.owner.enableRtl);\n            }\n            return this.dialogInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"dialog2\", {\n        /**\n         * Gets the initialized default dialog.\n         * @private\n         */\n        get: function () {\n            if (!this.dialogInternal2) {\n                this.initDialog2(this.owner.enableRtl);\n            }\n            return this.dialogInternal2;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"pageFitType\", {\n        /**\n         * Gets or sets page fit type.\n         * @private\n         */\n        get: function () {\n            return this.pageFitTypeIn;\n        },\n        set: function (value) {\n            this.pageFitTypeIn = value;\n            this.onPageFitTypeChanged(this.pageFitTypeIn);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    LayoutViewer.prototype.initalizeStyles = function () {\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Normal', '{\"type\":\"Paragraph\",\"name\":\"Normal\",\"next\":\"Normal\"}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 1', '{\"type\":\"Paragraph\",\"name\":\"Heading 1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 1 Char\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":12.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level1\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 2', '{\"type\":\"Paragraph\",\"name\":\"Heading 2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 2 Char\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level2\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 3', '{\"type\":\"Paragraph\",\"name\":\"Heading 3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 3 Char\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level3\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 4', '{\"type\":\"Paragraph\",\"name\":\"Heading 4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 4 Char\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level4\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 5', '{\"type\":\"Paragraph\",\"name\":\"Heading 5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 5 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level5\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 6', '{\"type\":\"Paragraph\",\"name\":\"Heading 6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 6 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level6\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Default Paragraph Font', '{\"type\":\"Character\",\"name\":\"Default Paragraph Font\"}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 1 Char', '{\"type\":\"Character\",\"name\":\"Heading 1 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 2 Char', '{\"type\":\"Character\",\"name\":\"Heading 2 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 3 Char', '{\"type\":\"Character\",\"name\":\"Heading 3 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\": \"#1F3763\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 4 Char', '{\"type\":\"Character\",\"name\":\"Heading 4 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 5 Char', '{\"type\":\"Character\",\"name\":\"Heading 5 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 6 Char', '{\"type\":\"Character\",\"name\":\"Heading 6 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Hyperlink', '{\"type\":\"Character\",\"name\":\"Hyperlink\",\"basedOn\":\"Default Paragraph Font\",\"next\":\"Normal\",\"characterFormat\":{\"fontColor\":\"#0563C1\",\"underline\": \"Single\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc1', '{\"type\":\"Paragraph\",\"name\":\"Toc1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc2', '{\"type\":\"Paragraph\",\"name\":\"Toc2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :11.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc3', '{\"type\":\"Paragraph\",\"name\":\"Toc3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :22.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc4', '{\"type\":\"Paragraph\",\"name\":\"Toc4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :33.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc5', '{\"type\":\"Paragraph\",\"name\":\"Toc5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :44.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc6', '{\"type\":\"Paragraph\",\"name\":\"Toc6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :55.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc7', '{\"type\":\"Paragraph\",\"name\":\"Toc7\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :66.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc8', '{\"type\":\"Paragraph\",\"name\":\"Toc8\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :77.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc9', '{\"type\":\"Paragraph\",\"name\":\"Toc9\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :88.0,\"afterSpacing\":5.0}}');\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.clearDocumentItems = function () {\n        this.headersFooters = [];\n        this.fields = [];\n        this.bookmarks.clear();\n        this.styles.clear();\n        this.characterFormat.clearFormat();\n        this.paragraphFormat.clearFormat();\n        this.defaultTabWidth = 36;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.getAbstractListById = function (id) {\n        if (isNullOrUndefined(this.abstractLists)) {\n            return undefined;\n        }\n        for (var i = 0; i < this.abstractLists.length; i++) {\n            var abstractList = this.abstractLists[i];\n            if (abstractList instanceof WAbstractList && abstractList.abstractListId === id) {\n                return abstractList;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.getListById = function (id) {\n        if (isNullOrUndefined(this.lists)) {\n            return undefined;\n        }\n        for (var i = 0; i < this.lists.length; i++) {\n            if (!isNullOrUndefined(this.lists[i]) && this.lists[i].listId === id) {\n                return this.lists[i];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.getListLevelNumber = function (listLevel) {\n        if (listLevel.ownerBase instanceof WLevelOverride) {\n            return listLevel.ownerBase.levelNumber;\n        }\n        else if (listLevel.ownerBase instanceof WAbstractList && !isNullOrUndefined(listLevel.ownerBase.levels)) {\n            return listLevel.ownerBase.levels.indexOf(listLevel);\n        }\n        else {\n            return -1;\n        }\n    };\n    /**\n     * Gets the bookmarks.\n     * @private\n     */\n    LayoutViewer.prototype.getBookmarks = function (includeHidden) {\n        var bookmarks = [];\n        for (var i = 0; i < this.bookmarks.keys.length; i++) {\n            var bookmark = this.bookmarks.keys[i];\n            if (includeHidden || bookmark.indexOf('_') !== 0) {\n                bookmarks.push(bookmark);\n            }\n        }\n        return bookmarks;\n    };\n    /**\n     * Initializes components.\n     * @private\n     */\n    LayoutViewer.prototype.initializeComponents = function () {\n        var element = this.owner.element;\n        if (isNullOrUndefined(element)) {\n            return;\n        }\n        var viewer = this;\n        this.optionsPaneContainer = createElement('div', {\n            className: 'e-documenteditor-optionspane'\n        });\n        element.appendChild(this.optionsPaneContainer);\n        var isRtl = this.owner.enableRtl;\n        var viewerContainerStyle;\n        if (isRtl) {\n            viewerContainerStyle = 'direction:ltr;';\n        }\n        this.viewerContainer = createElement('div', { id: this.owner.containerId + '_viewerContainer' });\n        this.viewerContainer.style.cssText = 'position:relative;backgroundColor:#FBFBFB;overflow:auto;' + viewerContainerStyle;\n        this.optionsPaneContainer.appendChild(this.viewerContainer);\n        this.viewerContainer.tabIndex = 0;\n        this.viewerContainer.style.outline = 'none';\n        this.pageContainer = createElement('div', { id: this.owner.containerId + '_pageContainer', className: 'e-de-background' });\n        this.viewerContainer.appendChild(this.pageContainer);\n        this.pageContainer.style.top = '0px';\n        this.pageContainer.style.left = '0px';\n        this.pageContainer.style.position = 'relative';\n        this.pageContainer.style.pointerEvents = 'none';\n        if (Browser.isDevice) {\n            this.createEditableDiv(element);\n        }\n        else {\n            this.createEditableIFrame();\n        }\n        if (this.owner.enableImageResizerMode) {\n            this.owner.imageResizerModule.initializeImageResizer();\n        }\n        this.updateViewerSizeInternal(element);\n        this.layout = new Layout(this);\n        this.textHelper = new TextHelper(this);\n        this.zoomModule = new Zoom(this);\n        this.initTouchEllipse();\n        this.wireEvent();\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.createEditableDiv = function (element) {\n        this.editableDiv = document.createElement('div');\n        this.editableDiv.contentEditable = 'true';\n        this.editableDiv.style.position = 'fixed';\n        this.editableDiv.style.left = '-150em';\n        this.editableDiv.style.width = '100%';\n        this.editableDiv.style.height = '100%';\n        this.editableDiv.id = element.id + '_editableDiv';\n        document.body.appendChild(this.editableDiv);\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.createEditableIFrame = function () {\n        this.iframe = createElement('iframe', {\n            attrs: {\n                'scrolling': 'no', 'src': 'javascript:false',\n                'style': 'pointer-events:none;position:absolute;top:-10000px'\n            },\n            className: 'e-de-text-target'\n        });\n        var innerHtml = '<!DOCTYPE html>'\n            + '<html><head></head>'\n            + '<body spellcheck=\"false\"style=\"background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;\" >'\n            + '<div contenteditable=\"true\" style=\"background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;\"></div>'\n            + '</body>'\n            + '</html>';\n        this.viewerContainer.appendChild(this.iframe);\n        this.iframe.contentDocument.open();\n        this.iframe.contentDocument.write(innerHtml);\n        this.iframe.contentDocument.close();\n        this.editableDiv = this.iframe.contentDocument.body.children[0];\n    };\n    /**\n     * Wires events and methods.\n     */\n    LayoutViewer.prototype.wireEvent = function () {\n        if (!isNullOrUndefined(this.selection)) {\n            this.selection.initCaret();\n        }\n        this.editableDiv.addEventListener('paste', this.onPaste);\n        if (!Browser.isDevice) {\n            this.editableDiv.addEventListener('keypress', this.onKeyPressInternal);\n            if (Browser.info.name === 'chrome') {\n                this.editableDiv.addEventListener('textInput', this.onTextInput);\n            }\n        }\n        else {\n            this.editableDiv.addEventListener('input', this.onTextInputInternal);\n        }\n        this.editableDiv.addEventListener('blur', this.onFocusOut);\n        this.editableDiv.addEventListener('keydown', this.onKeyDownInternal);\n        this.editableDiv.addEventListener('compositionstart', this.compositionStart);\n        this.editableDiv.addEventListener('compositionupdate', this.compositionUpdated);\n        this.editableDiv.addEventListener('compositionend', this.compositionEnd);\n        this.viewerContainer.addEventListener('scroll', this.scrollHandler);\n        this.viewerContainer.addEventListener('mousedown', this.onMouseDownInternal);\n        this.viewerContainer.addEventListener('keydown', this.onKeyDownInternal);\n        this.viewerContainer.addEventListener('mousemove', this.onMouseMoveInternal);\n        this.viewerContainer.addEventListener('contextmenu', this.onContextMenu);\n        this.viewerContainer.addEventListener('dblclick', this.onDoubleTap);\n        this.viewerContainer.addEventListener('mouseup', this.onMouseUpInternal);\n        window.addEventListener('resize', this.onWindowResize);\n        window.addEventListener('keyup', this.onKeyUpInternal);\n        window.addEventListener('mouseup', this.onImageResizer);\n        window.addEventListener('touchend', this.onImageResizer);\n        this.viewerContainer.addEventListener('touchstart', this.onTouchStartInternal);\n        this.viewerContainer.addEventListener('touchmove', this.onTouchMoveInternal);\n        this.viewerContainer.addEventListener('touchend', this.onTouchUpInternal);\n        if (navigator.userAgent.match('Firefox')) {\n            this.viewerContainer.addEventListener('DOMMouseScroll', this.zoomModule.onMouseWheelInternal);\n        }\n        this.viewerContainer.addEventListener('mousewheel', this.zoomModule.onMouseWheelInternal);\n    };\n    LayoutViewer.prototype.getEditableDivTextContent = function () {\n        return this.editableDiv.textContent;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.positionEditableTarget = function () {\n        var point = this.selection.getRect(this.selection.start);\n        var page = this.selection.getSelectionPage(this.selection.start);\n        var caretInfo = this.selection.updateCaretSize(this.owner.selection.start);\n        var sectionFormat = page.bodyWidgets[0].sectionFormat;\n        var left = page.boundingRectangle.x + (HelperMethods.convertPointToPixel(sectionFormat.leftMargin) * this.zoomFactor);\n        var top = point.y;\n        var pageWidth = sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin;\n        var iframeStyle = 'left:' + left + 'px;';\n        iframeStyle += 'top:' + top + 'px;';\n        iframeStyle += 'width:' + (HelperMethods.convertPointToPixel(pageWidth) * this.zoomFactor) + 'px;';\n        iframeStyle += 'height:250px;outline-style:none;position:absolute';\n        this.iframe.setAttribute('style', iframeStyle);\n        var style = 'background-color:transparent;width:100%;height:250px;padding: 0px; margin: 0px;';\n        style += 'text-indent:' + (point.x - left) + 'px;';\n        style += 'color:transparent;pointer-events:none;outline-style:none;';\n        style += 'font-size:' + (HelperMethods.convertPointToPixel(this.selection.characterFormat.fontSize) * this.zoomFactor) + 'px;';\n        style += 'font-family' + this.selection.characterFormat.fontFamily + ';';\n        style += 'overflow:hidden;text-decoration:none;white-space:normal;';\n        this.editableDiv.setAttribute('style', style);\n    };\n    /**\n     * Initializes dialog template.\n     */\n    LayoutViewer.prototype.initDialog = function (isRtl) {\n        if (!this.dialogInternal) {\n            this.dialogTarget = createElement('div', { className: 'e-de-dlg-target' });\n            document.body.appendChild(this.dialogTarget);\n            if (isRtl) {\n                this.dialogTarget.classList.add('e-de-rtl');\n            }\n            this.dialogInternal = new Dialog({\n                target: document.body, showCloseIcon: true,\n                allowDragging: true, enableRtl: isRtl, visible: false,\n                width: '1px', isModal: true, position: { X: 'center', Y: 'center' }, zIndex: 20\n            });\n            this.dialogInternal.open = this.selection.hideCaret;\n            this.dialogInternal.beforeClose = this.updateFocus;\n            this.dialogInternal.appendTo(this.dialogTarget);\n        }\n    };\n    /**\n     * Initializes dialog template.\n     */\n    LayoutViewer.prototype.initDialog2 = function (isRtl) {\n        if (!this.dialogInternal2) {\n            var target = createElement('div', { className: 'e-de-dlg-target' });\n            document.body.appendChild(target);\n            if (isRtl) {\n                target.classList.add('e-de-rtl');\n            }\n            this.dialogInternal2 = new Dialog({\n                target: document.body, showCloseIcon: true,\n                allowDragging: true, enableRtl: isRtl, visible: false,\n                width: '1px', isModal: true, position: { X: 'center', Y: 'Top' }, zIndex: 10\n            });\n            this.dialogInternal2.appendTo(target);\n        }\n    };\n    /**\n     * Clears the context.\n     * @private\n     */\n    LayoutViewer.prototype.clearContent = function () {\n        this.containerContext.clearRect(0, 0, this.containerCanvas.width, this.containerCanvas.height);\n        this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n    };\n    /**\n     * Fired when the document gets changed.\n     * @param {WordDocument} document\n     */\n    LayoutViewer.prototype.onDocumentChanged = function (sections) {\n        this.clearContent();\n        if (this.owner.editorModule) {\n            this.owner.editorModule.tocStyles = {};\n            this.owner.editorModule.tocBookmarkId = 0;\n        }\n        this.heightInfoCollection = {};\n        this.owner.isDocumentLoaded = false;\n        for (var i = 0; i < this.pages.length; i++) {\n            this.pages[i].bodyWidgets[0].destroy();\n        }\n        this.pages = [];\n        if (!isNullOrUndefined(this.renderedLists)) {\n            this.renderedLists.clear();\n        }\n        if (!isNullOrUndefined(this.owner.editorHistory)) {\n            this.owner.editorHistory.destroy();\n        }\n        this.owner.isDocumentLoaded = true;\n        this.layout.isInitialLoad = true;\n        this.layout.layoutItems(sections);\n        if (this.owner.selection) {\n            this.owner.selection.selectRange(this.owner.documentStart, this.owner.documentStart);\n        }\n        if (this.owner.optionsPaneModule) {\n            this.owner.optionsPaneModule.showHideOptionsPane(false);\n        }\n        this.owner.fireDocumentChange();\n    };\n    /**\n     * Initialize touch ellipse.\n     */\n    LayoutViewer.prototype.initTouchEllipse = function () {\n        var style = 'height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5';\n        // tslint:disable-next-line:max-line-length\n        var ellipse = ' height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;';\n        this.touchStart = createElement('div', { className: 'e-touch-ellipse', styles: style });\n        var start = createElement('div', { styles: ellipse });\n        this.touchEnd = createElement('div', { className: 'e-touch-ellipse', styles: style });\n        this.touchStart.style.display = 'none';\n        var end = createElement('div', { styles: ellipse });\n        this.touchStart.appendChild(start);\n        this.touchEnd.appendChild(end);\n        this.touchEnd.style.display = 'none';\n        this.viewerContainer.appendChild(this.touchStart);\n        this.viewerContainer.appendChild(this.touchEnd);\n    };\n    /**\n     * Updates touch mark position.\n     * @private\n     */\n    LayoutViewer.prototype.updateTouchMarkPosition = function () {\n        if (this.touchStart.style.display !== 'none' && !isNullOrUndefined(this.selection)) {\n            if (!this.selection.isEmpty) {\n                var y = this.selection.getCaretBottom(this.selection.start, false);\n                var page = this.selection.getPage(this.selection.start.paragraph);\n                var viewer = this;\n                // tslint:disable-next-line:max-line-length\n                var pageTop = (page.boundingRectangle.y - viewer.pageGap * (this.pages.indexOf(page) + 1)) * this.zoomFactor + viewer.pageGap * (this.pages.indexOf(page) + 1);\n                // tslint:disable-next-line:max-line-length\n                this.touchStart.style.left = page.boundingRectangle.x + (Math.round(this.selection.start.location.x) * this.zoomFactor - 14) + 'px';\n                this.touchStart.style.top = pageTop + ((y) * this.zoomFactor) + 'px';\n                if (!this.selection.isEmpty) {\n                    y = this.selection.getCaretBottom(this.selection.end, false);\n                    page = this.selection.getPage(this.selection.end.paragraph);\n                }\n                // tslint:disable-next-line:max-line-length\n                this.touchEnd.style.left = page.boundingRectangle.x + (Math.round(this.selection.end.location.x) * this.zoomFactor - 14) + 'px';\n                this.touchEnd.style.top = pageTop + (y * this.zoomFactor) + 'px';\n            }\n            else {\n                this.selection.updateCaretPosition();\n            }\n        }\n    };\n    LayoutViewer.prototype.isSelectionInListText = function (cursorPoint) {\n        var widget = this.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget) && widget.children[0] instanceof ListTextElementBox) {\n            var left = this.getLeftValue(widget);\n            var width = widget.children[0].width;\n            var height = widget.children[0].height;\n            if (this.isInsideRect(left, widget.paragraph.y, width, height, cursorPoint)) {\n                this.selectionLineWidget = widget;\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Check whether touch point is inside the rectangle or not.\n     * @param x\n     * @param y\n     * @param width\n     * @param height\n     * @param touchPoint\n     * @private\n     */\n    LayoutViewer.prototype.isInsideRect = function (x, y, width, height, touchPoint) {\n        if ((touchPoint.x > x && touchPoint.x <= x + width) && (touchPoint.y > y && touchPoint.y <= y + height)) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.getLeftValue = function (widget) {\n        var left = widget.paragraph.x;\n        var paragraphFormat = widget.paragraph.paragraphFormat;\n        if (this.selection.isParagraphFirstLine(widget)) {\n            if (paragraphFormat.textAlignment === 'Right') {\n                left -= HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n                left -= HelperMethods.convertPointToPixel(paragraphFormat.leftIndent);\n            }\n            else {\n                left += HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n            }\n        }\n        var element = widget.children[0];\n        if (element instanceof ListTextElementBox) {\n            left += element.margin.left;\n        }\n        return left;\n    };\n    /**\n     * Checks whether left mouse button is pressed or not.\n     */\n    LayoutViewer.prototype.isLeftButtonPressed = function (event) {\n        this.isTouchInput = false;\n        var button = event.which || event.button;\n        return button === 1;\n    };\n    /**\n     * Gets touch offset value.\n     */\n    LayoutViewer.prototype.getTouchOffsetValue = function (event) {\n        var targetElement = this.viewerContainer;\n        var offset = targetElement.getBoundingClientRect();\n        var touchOffsetValues = event.touches[0];\n        if (isNullOrUndefined(touchOffsetValues)) {\n            touchOffsetValues = event.changedTouches[0];\n        }\n        var offsetX = touchOffsetValues.pageX - offset.left;\n        var offsetY = touchOffsetValues.pageY - offset.top;\n        return new Point(offsetX, offsetY);\n    };\n    /**\n     * Fired on pinch zoom in.\n     * @param {TouchEvent} event\n     */\n    LayoutViewer.prototype.onPinchInInternal = function (event) {\n        this.preZoomFactor = this.zoomFactor;\n        var updatedZoomFactor = this.zoomFactor - 0.01;\n        if (updatedZoomFactor < 5 && updatedZoomFactor > 2) {\n            updatedZoomFactor = updatedZoomFactor - 0.01;\n        }\n        if (updatedZoomFactor < 0.1) {\n            updatedZoomFactor = 0.1;\n        }\n        this.zoomFactor = updatedZoomFactor;\n    };\n    /**\n     * Fired on pinch zoom out.\n     * @param {TouchEvent} event\n     */\n    LayoutViewer.prototype.onPinchOutInternal = function (event) {\n        this.preZoomFactor = this.zoomFactor;\n        var updatedZoomFactor = this.zoomFactor + 0.01;\n        if (updatedZoomFactor > 2) {\n            updatedZoomFactor = updatedZoomFactor + 0.01;\n        }\n        if (updatedZoomFactor > 5) {\n            updatedZoomFactor = 5;\n        }\n        this.zoomFactor = updatedZoomFactor;\n    };\n    /**\n     * Gets page width.\n     * @private\n     */\n    LayoutViewer.prototype.getPageWidth = function (page) {\n        var width = page.boundingRectangle.width;\n        return width;\n    };\n    /**\n     * Removes specified page.\n     * @private\n     */\n    LayoutViewer.prototype.removePage = function (page) {\n        if (this.currentPage === page) {\n            this.currentPage = undefined;\n        }\n        var index = this.pages.indexOf(page);\n        // if (index > -1) {\n        this.pages.splice(index, 1);\n        // }        \n        //this.removeRenderedPages();\n        var viewer = this;\n        if (!isNullOrUndefined(viewer.visiblePages)) {\n            if ((viewer.visiblePages).indexOf(page) > -1) {\n                var pageIndex = (viewer.visiblePages).indexOf(page);\n                (viewer.visiblePages).splice(pageIndex, 1);\n            }\n        }\n        //(viewer as PageLayoutViewer).visiblePages.remove(page);\n        var height = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            height = height + this.pages[i].boundingRectangle.height;\n        }\n        //Updates the vertical height.\n        height -= page.boundingRectangle.height + 20;\n        //ToDo:Update horizontal width, if removed page has max width.\n        var top = 20;\n        if (index > 0) {\n            top += this.pages[index - 1].boundingRectangle.bottom;\n        }\n        if (index !== -1) {\n            for (var i = index; i < this.pages.length; i++) {\n                //Update bounding rectangle of next pages in collection.\n                page = this.pages[i];\n                // tslint:disable-next-line:max-line-length\n                page.boundingRectangle = new Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n                top = page.boundingRectangle.bottom + 20;\n                page.repeatHeaderRowTableWidget = false;\n            }\n        }\n    };\n    // private removeRenderedPages(): void {\n    //     for (let i: number = 0; i < this.pages.length; i++) {\n    //         this.clearContainer(this.pages[i]);\n    //     }\n    // }\n    /**\n     * Updates viewer size on window resize.\n     * @private\n     */\n    LayoutViewer.prototype.updateViewerSize = function () {\n        var viewer = this;\n        var element = this.owner.getDocumentEditorElement();\n        viewer.updateViewerSizeInternal(element);\n        viewer.updateScrollBars();\n        if (!isNullOrUndefined(this.selection)) {\n            this.selection.updateCaretPosition();\n        }\n    };\n    /**\n     * Updates viewer size.\n     */\n    LayoutViewer.prototype.updateViewerSizeInternal = function (element) {\n        if (!isNullOrUndefined(element)) {\n            var rect = element.getBoundingClientRect();\n            var width = 0;\n            var height = 0;\n            height = rect.height > 0 ? rect.height : 200;\n            if (this.owner.optionsPaneModule && this.owner.optionsPaneModule.isOptionsPaneShow) {\n                var optionsRect = this.owner.optionsPaneModule.optionsPane.getBoundingClientRect();\n                width = (rect.width - optionsRect.width) > 0 ? (rect.width - optionsRect.width) : 200;\n            }\n            else {\n                width = rect.width > 0 ? rect.width : 200;\n            }\n            this.viewerContainer.style.height = height.toString() + 'px';\n            this.viewerContainer.style.width = Math.ceil(width) + 'px';\n            this.visibleBoundsIn = new Rect(0, 0, width, height);\n            this.containerCanvas.width = width;\n            this.containerCanvas.height = height;\n            this.selectionCanvas.width = width;\n            this.selectionCanvas.height = height;\n        }\n    };\n    /**\n     * Updates client area for block.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForBlock = function (block, beforeLayout, tableCollection) {\n        var leftIndent = HelperMethods.convertPointToPixel(block.leftIndent);\n        var rightIndent = HelperMethods.convertPointToPixel(block.rightIndent);\n        var bidi = block.bidi;\n        var width = 0;\n        if (beforeLayout) {\n            if (block instanceof TableWidget && tableCollection) {\n                var tableWidget = tableCollection[0];\n                this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n                this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n                //Updates the location of last item.\n                tableWidget = tableCollection[tableCollection.length - 1];\n                tableWidget.x = this.clientActiveArea.x;\n                tableWidget.y = this.clientActiveArea.y;\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                if (block instanceof TableWidget && !isNullOrUndefined(block.tableFormat)) {\n                    if (!block.isGridUpdated) {\n                        block.buildTableColumns();\n                        block.isGridUpdated = true;\n                    }\n                    var tableAlignment = this.tableAlignmentForBidi(block, bidi);\n                    if (tableAlignment !== 'Left') {\n                        var tableWidth = 0;\n                        // If the grid is calculated, we can direclty get the width from the grid.\n                        // Otherwise, calculate the width.\n                        tableWidth = HelperMethods.convertPointToPixel(block.tableHolder.getTotalWidth(0));\n                        tableWidth = tableWidth === 0 ? block.tableHolder.tableWidth === 0 ?\n                            block.getTableClientWidth(block.getOwnerWidth(false)) : block.tableHolder.tableWidth : tableWidth;\n                        // Fore resizing table, the tableholder table width taken for updated width. \n                        // Since, the columns will be cleared if we performed resizing.\n                        if (this.owner.editor && this.owner.editor.tableResize.currentResizingTable === block\n                            && this.owner.editor.tableResize.resizerPosition === 0) {\n                            tableWidth = HelperMethods.convertPointToPixel(block.tableHolder.tableWidth);\n                        }\n                        if (tableAlignment === 'Center') {\n                            leftIndent = (this.clientArea.width - tableWidth) / 2;\n                        }\n                        else {\n                            leftIndent = this.clientArea.width - tableWidth;\n                        }\n                        if (bidi) {\n                            leftIndent = leftIndent - HelperMethods.convertPointToPixel(block.leftIndent);\n                            rightIndent = leftIndent;\n                        }\n                        this.tableLefts.push(leftIndent);\n                    }\n                }\n                width = this.clientArea.width - (leftIndent + HelperMethods.convertPointToPixel(block.rightIndent));\n                this.clientActiveArea.x = this.clientArea.x = this.clientArea.x + (bidi ? rightIndent : leftIndent);\n                this.clientActiveArea.width = this.clientArea.width = width > 0 ? width : 0;\n            }\n        }\n        else {\n            // Clears table left for table with right or center alignment.\n            if (block instanceof TableWidget && !isNullOrUndefined(block.tableFormat)) {\n                var tableAlignment = this.tableAlignmentForBidi(block, bidi);\n                if (!block.isGridUpdated) {\n                    block.buildTableColumns();\n                    block.isGridUpdated = true;\n                }\n                if (tableAlignment !== 'Left' && this.tableLefts.length > 0) {\n                    leftIndent = this.tableLefts.pop();\n                    if (bidi) {\n                        rightIndent = leftIndent;\n                    }\n                }\n            }\n            width = this.clientArea.width + leftIndent + HelperMethods.convertPointToPixel(block.rightIndent);\n            this.clientActiveArea.width = this.clientArea.width = width > 0 ? width : 0;\n            this.clientActiveArea.x = this.clientArea.x = this.clientArea.x - (bidi ? rightIndent : leftIndent);\n        }\n        this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n        // tslint:disable-next-line:max-line-length\n        this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n    };\n    LayoutViewer.prototype.tableAlignmentForBidi = function (block, bidi) {\n        var tableAlignment = block.tableFormat.tableAlignment;\n        if (bidi) {\n            if (tableAlignment === 'Left') {\n                tableAlignment = 'Right';\n            }\n            else if (tableAlignment === 'Right') {\n                tableAlignment = 'Left';\n            }\n        }\n        return tableAlignment;\n    };\n    /**\n     * Updates client active area left.\n     * @private\n     */\n    LayoutViewer.prototype.cutFromLeft = function (x) {\n        if (x < this.clientActiveArea.x) {\n            x = this.clientActiveArea.x;\n        }\n        if (x > this.clientActiveArea.right && this.textWrap) {\n            x = this.clientActiveArea.right;\n        }\n        this.clientActiveArea.width = this.clientActiveArea.right > x ? this.clientActiveArea.right - x : 0;\n        this.clientActiveArea.x = x;\n    };\n    /**\n     * Updates client active area top.\n     * @private\n     */\n    LayoutViewer.prototype.cutFromTop = function (y) {\n        if (y < this.clientActiveArea.y) {\n            y = this.clientActiveArea.y;\n        }\n        if (y > this.clientActiveArea.bottom) {\n            y = this.clientActiveArea.bottom;\n        }\n        this.clientActiveArea.height = this.clientActiveArea.bottom - y;\n        this.clientActiveArea.x = this.clientArea.x;\n        this.clientActiveArea.width = this.clientArea.width;\n        this.clientActiveArea.y = y;\n    };\n    /**\n     * Updates client width.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientWidth = function (width) {\n        this.clientActiveArea.x -= width;\n        if (this.clientActiveArea.width + width > 0) {\n            this.clientActiveArea.width += width;\n        }\n        else {\n            this.clientActiveArea.width = 0;\n        }\n    };\n    /**\n     * Inserts page in specified index.\n     * @private\n     */\n    LayoutViewer.prototype.insertPage = function (index, page) {\n        if (this.pages.indexOf(page) > -1) {\n            this.pages.splice(this.pages.indexOf(page), 1);\n        }\n        this.pages.splice(index, 0, page);\n        var top = 20;\n        if (index > 0) {\n            top += this.pages[index - 1].boundingRectangle.bottom;\n        }\n        for (var i = index; i < this.pages.length; i++) {\n            //Update bounding rectangle of next pages in collection.\n            page = this.pages[i];\n            page.boundingRectangle = new Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n            top = page.boundingRectangle.bottom + 20;\n        }\n    };\n    /**\n     * Updates client area.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientArea = function (sectionFormat, page) {\n        var top = 0;\n        var headerDistance = 48;\n        var footerDistance = 48;\n        var pageHeight = HelperMethods.convertPointToPixel(sectionFormat.pageHeight);\n        var bottomMargin = HelperMethods.convertPointToPixel(sectionFormat.bottomMargin);\n        if (!isNullOrUndefined(sectionFormat)) {\n            top = HelperMethods.convertPointToPixel(sectionFormat.topMargin);\n            headerDistance = HelperMethods.convertPointToPixel(sectionFormat.headerDistance);\n            footerDistance = HelperMethods.convertPointToPixel(sectionFormat.footerDistance);\n        }\n        var isEmptyWidget = false;\n        if (!isNullOrUndefined(page.headerWidget)) {\n            isEmptyWidget = page.headerWidget.isEmpty;\n            if (!isEmptyWidget || isEmptyWidget && this.owner.enableHeaderAndFooter) {\n                top = Math.min(Math.max(headerDistance + page.headerWidget.height, top), pageHeight / 100 * 40);\n            }\n        }\n        var bottom = 0.667 + bottomMargin;\n        if (!isNullOrUndefined(page.footerWidget)) {\n            isEmptyWidget = page.footerWidget.isEmpty;\n            if (!isEmptyWidget || isEmptyWidget && this.owner.enableHeaderAndFooter) {\n                bottom = 0.667 + Math.min(pageHeight / 100 * 40, Math.max(footerDistance + page.footerWidget.height, bottomMargin));\n            }\n        }\n        var width = 0;\n        var height = 0;\n        if (!isNullOrUndefined(sectionFormat)) {\n            width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n            height = pageHeight - top - bottom;\n        }\n        if (width < 0) {\n            width = 0;\n        }\n        this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), top, width, pageHeight - top - bottom);\n        this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    };\n    /**\n     * Updates client area left or top position.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaTopOrLeft = function (tableWidget, beforeLayout) {\n        if (beforeLayout) {\n            this.clientActiveArea.y = this.clientActiveArea.y + tableWidget.topBorderWidth;\n            this.clientActiveArea.x = this.clientActiveArea.x + tableWidget.leftBorderWidth;\n        }\n    };\n    /**\n     * Updates client area for table.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForTable = function (tableWidget) {\n        this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n        this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n    };\n    /**\n     * Updates client area for row.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForRow = function (row, beforeLayout) {\n        // tslint:disable-next-line:max-line-length\n        var tableWidget = row.ownerTable;\n        if (beforeLayout) {\n            //tslint:disable:no-empty\n        }\n        else {\n            this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n            this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    /**\n     * Updates client area for cell.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForCell = function (cell, beforeLayout) {\n        // tslint:disable-next-line:max-line-length\n        var rowWidget = cell.ownerRow;\n        var cellWidget = cell;\n        if (beforeLayout) {\n            this.clientActiveArea.x = this.clientArea.x = cellWidget.x;\n            this.clientActiveArea.y = cellWidget.y;\n            this.clientActiveArea.width = this.clientArea.width = cellWidget.width > 0 ? cellWidget.width : 0;\n            if (this instanceof PageLayoutViewer) {\n                this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n            }\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n        else {\n            this.clientActiveArea.x = this.clientArea.x = cellWidget.x + cellWidget.width + cellWidget.margin.right;\n            if (rowWidget.x + rowWidget.width - this.clientArea.x < 0) {\n                this.clientActiveArea.width = this.clientArea.width = 0;\n            }\n            else {\n                this.clientActiveArea.width = this.clientArea.width = rowWidget.x + rowWidget.width - this.clientArea.x;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea.y = cellWidget.y - cellWidget.margin.top - HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing);\n            if (!cell.ownerTable.isInsideTable) {\n                this.clientActiveArea.height = this.clientArea.bottom - rowWidget.y > 0 ? this.clientArea.bottom - rowWidget.y : 0;\n            }\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    /**\n     * Updates the client area based on widget.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaByWidget = function (widget) {\n        this.clientArea.x = widget.x;\n        this.clientArea.y = widget.y;\n        this.clientActiveArea.x = widget.x;\n        this.clientActiveArea.y = widget.y;\n    };\n    //Widget\n    /**\n     * Updates client area location.\n     * @param widget\n     * @param area\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaLocation = function (widget, area) {\n        widget.x = area.x;\n        widget.y = area.y;\n        widget.width = area.width;\n    };\n    /**\n     * Updates text position for selection.\n     * @param cursorPoint\n     * @param tapCount\n     * @param clearMultiSelection\n     * @private\n     */\n    LayoutViewer.prototype.updateTextPositionForSelection = function (cursorPoint, tapCount) {\n        var widget = this.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget)) {\n            this.selection.updateTextPosition(widget, cursorPoint);\n        }\n        if (tapCount > 1) {\n            this.isMouseDown = false;\n            this.useTouchSelectionMark = false;\n            if (this.pages.length === 0) {\n                return;\n            }\n            //Double tap/triple tap selection\n            if (!isNullOrUndefined(this.currentPage) && !isNullOrUndefined(this.owner.selection.start)) {\n                if (tapCount % 2 === 0) {\n                    this.owner.selection.selectCurrentWord();\n                }\n                else {\n                    this.owner.selection.selectCurrentParagraph();\n                }\n            }\n        }\n    };\n    /**\n     * Scrolls to specified position.\n     * @param startPosition\n     * @param endPosition\n     * @private\n     */\n    LayoutViewer.prototype.scrollToPosition = function (startPosition, endPosition) {\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.isImageResizing\n            || this.isMouseDownInFooterRegion || this.isRowOrCellResizing) {\n            return;\n        }\n        var lineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, true);\n        if (isNullOrUndefined(lineWidget)) {\n            return;\n        }\n        var top = this.selection.getTop(lineWidget);\n        if (this.isMouseDown) {\n            var prevLineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, false);\n            var prevTop = this.selection.getTop(prevLineWidget);\n            if (prevLineWidget !== lineWidget && endPosition.location.y >= prevTop) {\n                lineWidget = prevLineWidget;\n            }\n        }\n        var height = lineWidget.height;\n        //Gets current page.\n        var endPage = this.selection.getPage(lineWidget.paragraph);\n        this.currentPage = endPage;\n        var x = 0;\n        var y = 0;\n        var viewer = this;\n        var horizontalWidth = 0;\n        var isPageLayout = viewer instanceof PageLayoutViewer;\n        if (isPageLayout) {\n            var pageLayout = viewer;\n            if (isNullOrUndefined(endPage)) {\n                return;\n            }\n            var pageWidth = endPage.boundingRectangle.width;\n            x = (this.visibleBounds.width - pageWidth * this.zoomFactor) / 2;\n            if (x < 30) {\n                x = 30;\n            }\n            // tslint:disable-next-line:max-line-length\n            y = endPage.boundingRectangle.y * this.zoomFactor + (this.pages.indexOf(endPage) + 1) * viewer.pageGap * (1 - this.zoomFactor);\n        }\n        var scrollTop = this.containerTop;\n        var scrollLeft = this.containerLeft;\n        var pageHeight = this.visibleBounds.height;\n        var caretInfo = this.selection.updateCaretSize(this.owner.selection.end, true);\n        var topMargin = caretInfo.topMargin;\n        var caretHeight = caretInfo.height;\n        x += (endPosition.location.x) * this.zoomFactor;\n        y += (endPosition.location.y + topMargin) * this.zoomFactor;\n        //vertical scroll bar update\n        if ((scrollTop + 20) > y) {\n            this.viewerContainer.scrollTop = (y - 10);\n        }\n        else if (scrollTop + pageHeight < y + caretHeight) {\n            this.viewerContainer.scrollTop = y + caretHeight - pageHeight + 10;\n        }\n        else {\n            this.selection.updateCaretToPage(startPosition, endPage);\n        }\n        this.selection.updateCaretToPage(startPosition, endPage);\n        var scrollBarWidth = this.viewerContainer.offsetWidth - this.viewerContainer.clientWidth;\n        if (scrollLeft > x) {\n            this.viewerContainer.scrollLeft = x - (viewer.pageContainer.offsetWidth / 100) * 20;\n        }\n        else if (scrollLeft + this.visibleBounds.width < x + scrollBarWidth) {\n            this.viewerContainer.scrollLeft = scrollLeft + (viewer.pageContainer.offsetWidth / 100) * 15 + scrollBarWidth;\n        }\n    };\n    /**\n     * Gets line widget using cursor point.\n     * @private\n     */\n    LayoutViewer.prototype.getLineWidget = function (cursorPoint) {\n        return this.getLineWidgetInternal(cursorPoint, false);\n    };\n    /**\n     * Gets line widget.\n     * @private\n     */\n    LayoutViewer.prototype.getLineWidgetInternal = function (cursorPoint, isMouseDragged) {\n        var widget = undefined;\n        if (!isNullOrUndefined(this.currentPage)) {\n            var childWidgets = void 0;\n            if (this.owner.enableHeaderAndFooter) {\n                var page = this.currentPage;\n                var pageTop = this.selection.getPageTop(page);\n                var pageBottom = page.boundingRectangle.height;\n                var headerHeight = Math.max((page.headerWidget.y + page.headerWidget.height), HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin)) * this.zoomFactor;\n                var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n                var footerHeight = (page.boundingRectangle.height -\n                    Math.max(page.footerWidget.height + footerDistance, footerDistance * 2));\n                if (isMouseDragged) {\n                    if (this.isBlockInHeader(this.selection.start.paragraph)) {\n                        childWidgets = this.currentPage.headerWidget;\n                    }\n                    else {\n                        childWidgets = this.currentPage.footerWidget;\n                    }\n                }\n                else {\n                    if (cursorPoint.y <= pageBottom && cursorPoint.y >= footerHeight) {\n                        childWidgets = this.currentPage.footerWidget;\n                    }\n                    else if ((cursorPoint.y) >= 0 && (cursorPoint.y) <= headerHeight) {\n                        childWidgets = this.currentPage.headerWidget;\n                    }\n                }\n                if (isNullOrUndefined(childWidgets)) {\n                    return undefined;\n                }\n                return this.selection.getLineWidgetBodyWidget(childWidgets, cursorPoint);\n            }\n            else {\n                for (var i = 0; i < this.currentPage.bodyWidgets.length; i++) {\n                    var bodyWidgets = this.currentPage.bodyWidgets[i];\n                    widget = this.selection.getLineWidgetBodyWidget(bodyWidgets, cursorPoint);\n                    if (!isNullOrUndefined(widget)) {\n                        break;\n                    }\n                }\n            }\n        }\n        return widget;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.isBlockInHeader = function (block) {\n        while (!(block.containerWidget instanceof HeaderFooterWidget)) {\n            if (!block.containerWidget) {\n                return false;\n            }\n            block = block.containerWidget;\n        }\n        return block.containerWidget.headerFooterType.indexOf('Header') !== -1;\n    };\n    /**\n     * Clears selection highlight.\n     * @private\n     */\n    LayoutViewer.prototype.clearSelectionHighlight = function () {\n        var canClear = true;\n        canClear = (!this.isControlPressed || !this.isMouseDown);\n        // if (this.owner.selection.selectionRanges.length > 0 && canClear) {\n        if (this.owner.selection.clearSelectionHighlightInSelectedWidgets()) {\n            this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        }\n        // } else if (!isNullOrUndefined(this.owner.selection.currentSelectionRange) && this.isMouseDown) {\n        //     this.owner.selection.currentSelectionRange.clearSelectionHighlight();\n        // }\n        //this.renderVisiblePages();\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.removeEmptyPages = function () {\n        var scrollToLastPage = false;\n        var viewer = this;\n        for (var j = 0; j < this.pages.length; j++) {\n            var page = this.pages[j];\n            if (page.bodyWidgets.length === 0 || page.bodyWidgets[0].childWidgets.length === 0) {\n                // tslint:disable-next-line:max-line-length\n                if (j === this.pages.length - 1 && viewer instanceof PageLayoutViewer && viewer.visiblePages.indexOf(this.pages[j]) !== -1) {\n                    scrollToLastPage = true;\n                }\n                this.removePage(this.pages[j]);\n                j--;\n            }\n        }\n        if (scrollToLastPage) {\n            this.scrollToBottom();\n        }\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.scrollToBottom = function () {\n        if (this.selection.start.paragraph && this.selection.start.paragraph.bodyWidget) {\n            var page = this.selection.start.paragraph.bodyWidget.page;\n            var containerHeight = this.visibleBounds.height;\n            this.viewerContainer.scrollTop = page.boundingRectangle.bottom - containerHeight;\n        }\n    };\n    /**\n     * Returns the field code result.\n     * @private\n     */\n    LayoutViewer.prototype.getFieldResult = function (fieldBegin, page) {\n        if (!isNullOrUndefined(page) && !isNullOrUndefined(this.selection)) {\n            var fieldCode = this.selection.getFieldCode(fieldBegin);\n            var fieldCodes = fieldCode.split('\\*');\n            if (fieldCodes.length > 1) {\n                var fieldCategory = fieldCodes[0].replace(/[^\\w\\s]/gi, '').trim().toLowerCase();\n                var fieldPattern = fieldCodes[1].replace(/[^\\w\\s]/gi, '').trim();\n                switch (fieldCategory) {\n                    case 'page':\n                        return this.getFieldText(fieldPattern, (page.index + 1));\n                    case 'numpages':\n                        return this.getFieldText(fieldPattern, page.viewer.pages.length);\n                    default:\n                        break;\n                }\n            }\n        }\n        return '';\n    };\n    /**\n     * Returns field text.\n     */\n    LayoutViewer.prototype.getFieldText = function (pattern, value) {\n        switch (pattern) {\n            case 'ALPHABETIC':\n                return this.layout.getAsLetter(value).toUpperCase();\n            case 'alphabetic':\n                return this.layout.getAsLetter(value).toLowerCase();\n            case 'roman':\n                return this.layout.getAsRoman(value).toLowerCase();\n            case 'ROMAN':\n                return this.layout.getAsRoman(value).toUpperCase();\n            default:\n                return value.toString();\n        }\n    };\n    /**\n     * Destroys the internal objects maintained for control.\n     */\n    LayoutViewer.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.owner)) {\n            this.unWireEvent();\n        }\n        this.pages = [];\n        this.pages = undefined;\n        this.fieldStacks = [];\n        this.fieldStacks = undefined;\n        this.splittedCellWidgets = [];\n        this.splittedCellWidgets = undefined;\n        this.fields = [];\n        this.fields = undefined;\n        if (this.layout) {\n            this.layout.destroy();\n        }\n        this.layout = undefined;\n        if (!isNullOrUndefined(this.render)) {\n            this.render.destroy();\n        }\n        this.render = undefined;\n        if (this.dialogInternal) {\n            this.dialogInternal.destroy();\n        }\n        this.dialogInternal = undefined;\n        if (this.dialogTarget && this.dialogTarget.parentElement) {\n            this.dialogTarget.parentElement.removeChild(this.dialogTarget);\n        }\n        this.dialogTarget = undefined;\n        if (!isNullOrUndefined(this.touchStart)) {\n            this.touchStart.innerHTML = '';\n        }\n        if (this.textHelper) {\n            this.textHelper.destroy();\n        }\n        this.textHelper = undefined;\n        this.touchStart = undefined;\n        if (!isNullOrUndefined(this.touchEnd)) {\n            this.touchEnd.innerHTML = '';\n        }\n        this.touchEnd = undefined;\n        if (!isNullOrUndefined(this.containerCanvasIn)) {\n            this.containerCanvasIn.innerHTML = '';\n        }\n        this.containerCanvasIn = undefined;\n        if (!isNullOrUndefined(this.selectionCanvasIn)) {\n            this.selectionCanvasIn.innerHTML = '';\n        }\n        this.selectionCanvasIn = undefined;\n        if (!isNullOrUndefined(this.editableDiv)) {\n            this.editableDiv.innerHTML = '';\n            this.editableDiv.parentElement.removeChild(this.editableDiv);\n        }\n        this.editableDiv = undefined;\n        if (!isNullOrUndefined(this.pageContainer)) {\n            this.pageContainer.innerHTML = '';\n        }\n        this.pageContainer = undefined;\n        if (!isNullOrUndefined(this.viewerContainer)) {\n            this.viewerContainer.innerHTML = '';\n        }\n        this.viewerContainer = undefined;\n        this.owner = undefined;\n        this.heightInfoCollection = undefined;\n    };\n    /**\n     * Un-Wires events and methods\n     */\n    LayoutViewer.prototype.unWireEvent = function () {\n        this.viewerContainer.removeEventListener('scroll', this.scrollHandler);\n        this.viewerContainer.removeEventListener('mousedown', this.onMouseDownInternal);\n        this.viewerContainer.removeEventListener('mousemove', this.onMouseMoveInternal);\n        if (!Browser.isDevice) {\n            this.editableDiv.removeEventListener('keypress', this.onKeyPressInternal);\n            if (Browser.info.name === 'chrome') {\n                this.editableDiv.removeEventListener('textInput', this.onTextInput);\n            }\n        }\n        else {\n            this.editableDiv.removeEventListener('input', this.onTextInputInternal);\n        }\n        this.editableDiv.removeEventListener('paste', this.onPaste);\n        this.viewerContainer.removeEventListener('contextmenu', this.onContextMenu);\n        this.editableDiv.removeEventListener('blur', this.onFocusOut);\n        this.editableDiv.removeEventListener('keydown', this.onKeyDownInternal);\n        this.editableDiv.removeEventListener('compositionstart', this.compositionStart);\n        this.editableDiv.removeEventListener('compositionupdate', this.compositionUpdated);\n        this.editableDiv.removeEventListener('compositionend', this.compositionEnd);\n        this.viewerContainer.removeEventListener('mouseup', this.onMouseUpInternal);\n        this.viewerContainer.removeEventListener('dblclick', this.onDoubleTap);\n        window.removeEventListener('resize', this.onWindowResize);\n        window.removeEventListener('keyup', this.onKeyUpInternal);\n        window.removeEventListener('mouseup', this.onImageResizer);\n        window.removeEventListener('touchend', this.onImageResizer);\n    };\n    return LayoutViewer;\n}());\nexport { LayoutViewer };\n/**\n * @private\n */\nvar PageLayoutViewer = /** @class */ (function (_super) {\n    __extends(PageLayoutViewer, _super);\n    /**\n     * Initialize the constructor of PageLayoutViewer\n     */\n    function PageLayoutViewer(owner) {\n        var _this = _super.call(this, owner) || this;\n        _this.pageLeft = 30;\n        /**\n         * @private\n         */\n        _this.pageGap = 20;\n        /**\n         * @private\n         */\n        _this.visiblePages = [];\n        if (isNullOrUndefined(owner) || isNullOrUndefined(owner.element)) {\n            return _this;\n        }\n        return _this;\n    }\n    /**\n     * Creates new page.\n     * @private\n     */\n    PageLayoutViewer.prototype.createNewPage = function (section, index) {\n        var viewer = this;\n        var yPos = this.pageGap;\n        if (this.pages.length > 0) {\n            yPos = this.pages[this.pages.length - 1].boundingRectangle.bottom + this.pageGap;\n        }\n        var page = new Page();\n        page.viewer = this;\n        // tslint:disable-next-line:max-line-length\n        var pageWidth = !isNullOrUndefined(section.sectionFormat) ? HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth) : 816;\n        // tslint:disable-next-line:max-line-length\n        var pageHeight = !isNullOrUndefined(section.sectionFormat) ? HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight) : 1056;\n        var xPos = (this.visibleBounds.width - pageWidth * this.zoomFactor) / 2;\n        if (xPos < this.pageLeft) {\n            xPos = this.pageLeft;\n        }\n        page.boundingRectangle = new Rect(xPos, yPos, pageWidth, pageHeight);\n        if (isNullOrUndefined(index)) {\n            this.pages.push(page);\n        }\n        else {\n            this.pages.splice(index, 0, page);\n        }\n        this.updateClientArea(section.sectionFormat, page);\n        page.bodyWidgets.push(section);\n        page.bodyWidgets[page.bodyWidgets.length - 1].page = page;\n        this.layout.layoutHeaderFooter(section, viewer, page);\n        this.updateClientArea(section.sectionFormat, page);\n        return page;\n    };\n    /**\n     * Updates cursor.\n     */\n    PageLayoutViewer.prototype.updateCursor = function (event) {\n        var hyperlinkField = undefined;\n        var div = this.viewerContainer;\n        var point = new Point(event.offsetX, event.offsetY);\n        var touchPoint = this.findFocusedPage(point, true);\n        var widget = this.getLineWidget(touchPoint);\n        var widgetInfo;\n        var left;\n        var top;\n        var editor = !this.owner.isReadOnlyMode ? this.owner.editorModule : undefined;\n        var isRowResize = editor ? editor.tableResize.isInRowResizerArea(touchPoint) : false;\n        var isCellResize = editor ? editor.tableResize.isInCellResizerArea(touchPoint) : false;\n        var resizePosition = '';\n        if (this.owner.enableImageResizerMode) {\n            var resizeObj = this.owner.imageResizerModule.getImagePoint(touchPoint);\n            this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n            resizePosition = resizeObj.resizePosition;\n        }\n        var lineLeft = 0;\n        if (!isNullOrUndefined(widget)) {\n            lineLeft = this.selection.getLineStartLeft(widget);\n            hyperlinkField = this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint);\n            widgetInfo = this.selection.updateTextPositionIn(widget, undefined, 0, touchPoint, true);\n            left = this.selection.getLeft(widget);\n            top = this.selection.getTop(widget);\n            this.selection.setHyperlinkContentToToolTip(hyperlinkField, widget, touchPoint.x);\n        }\n        if (!isNullOrUndefined(hyperlinkField) && (event.ctrlKey &&\n            this.owner.useCtrlClickToFollowHyperlink || !this.owner.useCtrlClickToFollowHyperlink)) {\n            div.style.cursor = 'pointer';\n            return;\n        }\n        else if (touchPoint.x >= lineLeft &&\n            event.offsetX < (this.visibleBounds.width - (this.visibleBounds.width - this.viewerContainer.clientWidth)) &&\n            event.offsetY < (this.visibleBounds.height - (this.visibleBounds.height - this.viewerContainer.clientHeight))) {\n            if (this.selection.isEmpty) {\n                div.style.cursor = 'text';\n            }\n            else {\n                div.style.cursor = this.selection.checkCursorIsInSelection(widget, touchPoint) ? 'default' : 'text';\n            }\n        }\n        else {\n            div.style.cursor = 'default';\n        }\n        if (!isNullOrUndefined(resizePosition) && resizePosition !== '') {\n            div.style.cursor = resizePosition;\n        }\n        else if (!isNullOrUndefined(widgetInfo) && widgetInfo.isImageSelected && left < touchPoint.x && top < touchPoint.y &&\n            left + widget.width > touchPoint.x && top + widget.height > touchPoint.y) {\n            div.style.cursor = 'move';\n        }\n        if (isRowResize) {\n            div.style.cursor = 'row-resize';\n        }\n        else if (isCellResize) {\n            div.style.cursor = 'col-resize';\n        }\n    };\n    /**\n     * Finds focused page.\n     * @private\n     */\n    PageLayoutViewer.prototype.findFocusedPage = function (currentPoint, updateCurrentPage) {\n        var point = new Point(currentPoint.x, currentPoint.y);\n        point.x += this.viewerContainer.scrollLeft;\n        point.y += this.viewerContainer.scrollTop;\n        for (var i = 0; i < this.pages.length; i++) {\n            var page = this.pages[i];\n            var pageTop = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.zoomFactor + this.pageGap * (i + 1);\n            var pageHeight = (page.boundingRectangle.height * this.zoomFactor) + this.pageGap;\n            var pageLeft = page.boundingRectangle.x;\n            var pageRight = ((page.boundingRectangle.right - pageLeft) * this.zoomFactor) + pageLeft;\n            if (pageTop <= point.y && pageTop + pageHeight >= point.y) {\n                if (updateCurrentPage) {\n                    this.currentPage = page;\n                }\n                point.y = (point.y - (pageTop)) / this.zoomFactor;\n                if (point.x > pageRight) {\n                    point.x = page.boundingRectangle.right;\n                }\n                else if (point.x < pageLeft) {\n                    point.x = 0;\n                }\n                else {\n                    point.x = (point.x - pageLeft) / this.zoomFactor;\n                }\n                return point;\n            }\n        }\n        return point;\n    };\n    /**\n     * Fired when page fit type changed.\n     * @private\n     */\n    PageLayoutViewer.prototype.onPageFitTypeChanged = function (pageFitType) {\n        var width = this.visibleBounds.width;\n        var height = this.visibleBounds.height;\n        var section = this.visiblePages[0].bodyWidgets[0];\n        var pageWidth = HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth);\n        var pageHeight = HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight);\n        switch (pageFitType) {\n            case 'FitOnePage':\n                if (height > 0 && pageHeight > 0) {\n                    var zoomFactor = (this.visibleBounds.height - 2 * this.pageGap - (this.pageGap - 2)) / pageHeight;\n                    if (zoomFactor === this.zoomFactor) {\n                        if (!isNullOrUndefined(this.owner.selection) && !isNullOrUndefined(this.owner.selection.start) &&\n                            !isNullOrUndefined(this.owner.selection.end)) {\n                            this.scrollToPosition(this.owner.selection.start, this.owner.selection.end);\n                        }\n                    }\n                    else {\n                        this.zoomFactor = zoomFactor;\n                    }\n                }\n                break;\n            case 'FitPageWidth':\n                if (width > 0 && pageWidth > 0) {\n                    this.zoomFactor = (this.visibleBounds.width - 80) / pageWidth;\n                }\n                break;\n            default:\n                this.zoomFactor = 100 / 100;\n                break;\n        }\n    };\n    /**\n     * @private\n     */\n    PageLayoutViewer.prototype.handleZoom = function () {\n        var prevScaleFactor = this.preZoomFactor;\n        var page = null;\n        var verticalHeight = 0;\n        var scrollToPosition = false;\n        if (this.selection && isNullOrUndefined(this.zoomX && isNullOrUndefined(this.zoomY))) {\n            var x = 0;\n            var y = 0;\n            var endPage = this.selection.getPage(this.selection.end.currentWidget.paragraph);\n            x = (this.visibleBounds.width - endPage.boundingRectangle.width * prevScaleFactor) / 2;\n            if (x < 30) {\n                x = 30;\n            }\n            // tslint:disable-next-line:max-line-length\n            y = endPage.boundingRectangle.y * prevScaleFactor + (this.pages.indexOf(endPage) + 1) * this.pageGap * (1 - prevScaleFactor);\n            var caretInfo = this.selection.updateCaretSize(this.owner.selection.end, true);\n            var topMargin = caretInfo.topMargin;\n            var caretHeight = caretInfo.height;\n            x += (this.selection.end.location.x) * prevScaleFactor;\n            y += (this.selection.end.location.y + topMargin) * prevScaleFactor;\n            if (x >= this.containerLeft && x <= this.visibleBounds.width &&\n                y >= this.containerTop && y <= this.containerTop + this.visibleBounds.height) {\n                scrollToPosition = true;\n            }\n        }\n        for (var i = 0; i < this.pages.length; i++) {\n            verticalHeight = verticalHeight + this.pages[i].boundingRectangle.height;\n        }\n        var horizontalWidth = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            if (horizontalWidth < this.pages[i].boundingRectangle.width) {\n                horizontalWidth = this.pages[i].boundingRectangle.width;\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        var height = (verticalHeight * this.zoomFactor + (this.pages.length + 1) * this.pageGap * (1 - this.zoomFactor)) - this.visibleBounds.height;\n        var horWidth = horizontalWidth * this.zoomFactor - this.visibleBounds.width;\n        if (this.visibleBounds.width - horizontalWidth * this.zoomFactor < 60) {\n            horWidth += 60;\n        }\n        //Update Vertical Scroll bar\n        if (height > 0) {\n            var value = this.containerTop;\n            if (this.visiblePages.length > 0) {\n                page = this.visiblePages[0];\n                // tslint:disable-next-line:max-line-length\n                var prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n                var zoomY = this.zoomY;\n                if (isNullOrUndefined) {\n                    zoomY = this.visibleBounds.height / 2;\n                }\n                var prevY = value + zoomY;\n                while (prevY > prevPageTop + (page.boundingRectangle.height * prevScaleFactor)) {\n                    var pageIndex = page.index + 1;\n                    if (pageIndex === this.pages.length) {\n                        break;\n                    }\n                    page = this.pages[pageIndex];\n                    // tslint:disable-next-line:max-line-length\n                    prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n                }\n                // tslint:disable-next-line:max-line-length\n                var currentY = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * this.zoomFactor + (page.index + 1) * this.pageGap\n                    + ((prevY - prevPageTop) < 0 ? prevY - prevPageTop : (prevY - prevPageTop) * (this.zoomFactor / prevScaleFactor));\n                value = currentY - zoomY;\n                zoomY = this.visibleBounds.height / 2;\n            }\n            this.viewerContainer.scrollTop = value;\n        }\n        else {\n            this.viewerContainer.scrollTop = 0;\n        }\n        // update Horizontal Scroll Bar\n        if (horWidth > 0) {\n            var value = this.containerLeft;\n            if (this.visiblePages.length > 0) {\n                if (page === null) {\n                    page = this.visiblePages[0];\n                }\n                var zoomX = this.zoomX;\n                if (isNullOrUndefined(zoomX)) {\n                    zoomX = this.visibleBounds.width / 2;\n                }\n                var prevValue = (page.boundingRectangle.width * prevScaleFactor) / page.boundingRectangle.width;\n                var prevX = value + zoomX;\n                // tslint:disable-next-line:max-line-length\n                var currentX = page.boundingRectangle.x\n                    + ((prevX - page.boundingRectangle.x) < 0 ? prevX - page.boundingRectangle.x : (prevX - page.boundingRectangle.x) * (this.zoomFactor / prevValue));\n                value = currentX - zoomX;\n                zoomX = this.visibleBounds.width / 2;\n            }\n            this.viewerContainer.scrollLeft = value;\n        }\n        else {\n            this.viewerContainer.scrollLeft = 0;\n        }\n        this.updateScrollBars();\n        if (scrollToPosition) {\n            this.scrollToPosition(this.selection.start, this.selection.end);\n        }\n    };\n    /**\n     * Gets current page header footer.\n     * @private\n     */\n    PageLayoutViewer.prototype.getCurrentPageHeaderFooter = function (section, isHeader) {\n        return this.getCurrentHeaderFooter(this.getHeaderFooterType(section, isHeader), section.index);\n    };\n    /**\n     * Get header footer type\n     * @private\n     */\n    PageLayoutViewer.prototype.getHeaderFooterType = function (section, isHeader) {\n        var type;\n        type = isHeader ? 'OddHeader' : 'OddFooter';\n        // tslint:disable-next-line:max-line-length\n        if (section.sectionFormat.differentFirstPage && (this.pages.length === 1 || this.pages[this.pages.length - 1].bodyWidgets[0].index !== section.index)) {\n            type = isHeader ? 'FirstPageHeader' : 'FirstPageFooter';\n        }\n        else if (section.sectionFormat.differentOddAndEvenPages && this.pages.length % 2 === 0) {\n            type = isHeader ? 'EvenHeader' : 'EvenFooter';\n        }\n        return type;\n    };\n    /**\n     * Gets current header footer.\n     * @param type\n     * @param section\n     * @private\n     */\n    PageLayoutViewer.prototype.getCurrentHeaderFooter = function (type, sectionIndex) {\n        if (this.headersFooters[sectionIndex]) {\n            var index = this.getHeaderFooter(type);\n            var headerFooter = this.headersFooters[sectionIndex][index];\n            if (!headerFooter) {\n                headerFooter = this.createHeaderFooterWidget(type);\n                headerFooter.isEmpty = true;\n                this.headersFooters[sectionIndex][index] = headerFooter;\n            }\n            return headerFooter;\n        }\n        else if (sectionIndex > 0) {\n            return this.getCurrentHeaderFooter(type, sectionIndex - 1);\n        }\n        return undefined;\n    };\n    PageLayoutViewer.prototype.createHeaderFooterWidget = function (type) {\n        var headerFooter = new HeaderFooterWidget(type);\n        var paragraph = new ParagraphWidget();\n        paragraph.childWidgets.push(new LineWidget(paragraph));\n        return headerFooter;\n    };\n    /**\n     * Gets header footer.\n     * @param type\n     * @private\n     */\n    PageLayoutViewer.prototype.getHeaderFooter = function (type) {\n        switch (type) {\n            case 'OddHeader':\n                return 0;\n            case 'OddFooter':\n                return 1;\n            case 'EvenHeader':\n                return 2;\n            case 'EvenFooter':\n                return 3;\n            case 'FirstPageHeader':\n                return 4;\n            case 'FirstPageFooter':\n                return 5;\n        }\n    };\n    /**\n     * Updates header footer client area.\n     * @private\n     */\n    PageLayoutViewer.prototype.updateHFClientArea = function (sectionFormat, isHeader) {\n        // tslint:disable-next-line:max-line-length\n        var width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n        if (width < 0) {\n            width = 0;\n        }\n        if (isHeader) {\n            // tslint:disable-next-line:max-line-length\n            this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), HelperMethods.convertPointToPixel(sectionFormat.headerDistance), width, Number.POSITIVE_INFINITY);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), HelperMethods.convertPointToPixel(sectionFormat.pageHeight - sectionFormat.footerDistance), width, Number.POSITIVE_INFINITY);\n        }\n        this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    };\n    /**\n     * @private\n     */\n    PageLayoutViewer.prototype.updateHCFClientAreaWithTop = function (sectionFormat, isHeader, page) {\n        this.updateHFClientArea(sectionFormat, isHeader);\n        if (!isHeader) {\n            if (page.footerWidget.y < this.clientActiveArea.y) {\n                this.clientActiveArea.y = page.footerWidget.y;\n                this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n            }\n        }\n    };\n    /**\n     * Scrolls to the specified page\n     * @private\n     */\n    PageLayoutViewer.prototype.scrollToPage = function (pageIndex) {\n        var top = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            top = this.pages[i].boundingRectangle.y - (this.pageGap / 2);\n            if (i === pageIndex) {\n                break;\n            }\n        }\n        this.viewerContainer.scrollTop = top;\n        this.updateScrollBars();\n    };\n    /**\n     * Updates scroll bars.\n     * @private\n     */\n    PageLayoutViewer.prototype.updateScrollBars = function () {\n        var height = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            height = height + this.pages[i].boundingRectangle.height;\n        }\n        var width = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            if (width < this.pages[i].boundingRectangle.width) {\n                width = this.pages[i].boundingRectangle.width;\n            }\n        }\n        var containerWidth = (width * this.zoomFactor) + (this.pageLeft * 2);\n        var containerHeight = (height * this.zoomFactor) + (this.pages.length + 1) * this.pageGap;\n        var viewerWidth = this.visibleBounds.width;\n        var viewerHeight = this.visibleBounds.height;\n        if (this.visibleBounds.width !== this.viewerContainer.clientWidth) {\n            viewerWidth -= (this.visibleBounds.width - this.viewerContainer.clientWidth);\n        }\n        else if (containerHeight > viewerHeight) {\n            viewerWidth -= this.viewerContainer.offsetWidth - this.viewerContainer.clientWidth;\n        }\n        if (containerWidth > viewerWidth) {\n            viewerHeight -= (this.visibleBounds.height - this.viewerContainer.clientHeight);\n        }\n        width = containerWidth > viewerWidth ? containerWidth : viewerWidth;\n        height = containerHeight > viewerHeight ? containerHeight : viewerHeight;\n        if (parseInt(this.pageContainer.style.width.replace('px', ''), 10) !== width ||\n            parseInt(this.pageContainer.style.height.replace('px', ''), 10) !== width) {\n            this.pageContainer.style.width = width.toString() + 'px';\n            this.pageContainer.style.height = height.toString() + 'px';\n        }\n        // if (!isNullOrUndefined(this.selection) && !this.selection.isEmpty) {\n        //     this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        // }\n        var displayPixelRatio = Math.max(1, window.devicePixelRatio || 1);\n        if (this.containerCanvas.width !== Math.floor(viewerWidth * displayPixelRatio)\n            || this.containerCanvas.height !== Math.floor(viewerHeight * displayPixelRatio)) {\n            this.containerCanvas.width = viewerWidth * displayPixelRatio;\n            this.containerCanvas.height = viewerHeight * displayPixelRatio;\n            this.containerCanvas.style.width = viewerWidth + 'px';\n            this.containerCanvas.style.height = viewerHeight + 'px';\n            this.containerContext.scale(displayPixelRatio, displayPixelRatio);\n            this.selectionCanvas.width = viewerWidth * displayPixelRatio;\n            this.selectionCanvas.height = viewerHeight * displayPixelRatio;\n            this.selectionCanvas.style.width = viewerWidth + 'px';\n            this.selectionCanvas.style.height = viewerHeight + 'px';\n            this.selectionContext.scale(displayPixelRatio, displayPixelRatio);\n        }\n        this.containerContext.globalAlpha = 1;\n        this.selectionContext.globalAlpha = 0.4;\n        for (var i = 0; i < this.pages.length; i++) {\n            var left = (width - this.pages[i].boundingRectangle.width * this.zoomFactor) / 2;\n            if (left > this.pageLeft) {\n                // tslint:disable-next-line:max-line-length\n                this.pages[i].boundingRectangle = new Rect(left, this.pages[i].boundingRectangle.y, this.pages[i].boundingRectangle.width, this.pages[i].boundingRectangle.height);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                this.pages[i].boundingRectangle = new Rect(this.pageLeft, this.pages[i].boundingRectangle.y, this.pages[i].boundingRectangle.width, this.pages[i].boundingRectangle.height);\n            }\n        }\n        this.updateScrollBarPosition(containerWidth, containerHeight, viewerWidth, viewerHeight, width, height);\n    };\n    // tslint:disable-next-line:max-line-length\n    PageLayoutViewer.prototype.updateScrollBarPosition = function (containerWidth, containerHeight, viewerWidth, viewerHeight, width, height) {\n        var left = 0;\n        var viewerHeight1 = parseFloat(this.viewerContainer.style.height);\n        var containerHeight1 = parseFloat(this.pageContainer.style.height);\n        this.containerTop = this.viewerContainer.scrollTop;\n        this.containerCanvas.style.position = 'absolute';\n        this.containerCanvas.style.top = this.containerTop.toString() + 'px';\n        this.selectionCanvas.style.position = 'absolute';\n        this.selectionCanvas.style.top = this.containerTop.toString() + 'px';\n        this.containerLeft = this.viewerContainer.scrollLeft;\n        this.containerCanvas.style.left = this.containerLeft + 'px';\n        this.selectionCanvas.style.left = this.containerLeft + 'px';\n        this.updateVisiblePages();\n    };\n    /**\n     * Updates visible pages.\n     * @private\n     */\n    PageLayoutViewer.prototype.updateVisiblePages = function () {\n        var left = 0;\n        var width = 0;\n        // Clears the container first.\n        this.visiblePages = [];\n        var height = this.visibleBounds.height;\n        var vertical = this.viewerContainer.scrollTop;\n        for (var i = 0; i < this.pages.length; i++) {\n            var page = this.pages[i];\n            var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.zoomFactor + this.pageGap * (i + 1);\n            var pageH = page.boundingRectangle.height * this.zoomFactor;\n            var left_1 = page.boundingRectangle.x;\n            var isTopFit = y >= vertical && y <= vertical + height;\n            var isBottomFit = y + pageH >= vertical && y + pageH <= vertical + height;\n            var isMiddleFit = y <= vertical && y + pageH >= vertical + height;\n            //UI Virtualization\n            if (isTopFit || isBottomFit || isMiddleFit) {\n                this.addVisiblePage(page, left_1, y);\n            }\n        }\n    };\n    /**\n     * Adds visible pages.\n     */\n    PageLayoutViewer.prototype.addVisiblePage = function (page, x, y) {\n        var width = page.boundingRectangle.width * this.zoomFactor;\n        var height = page.boundingRectangle.height * this.zoomFactor;\n        // tslint:disable-next-line:max-line-length\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.currentPage !== undefined && this.owner.imageResizerModule.currentPage === page && this.owner.imageResizerModule.isImageResizerVisible) {\n            this.owner.imageResizerModule.setImageResizerPositions(x, y, width, height);\n        }\n        this.visiblePages.push(page);\n        this.renderPage(page, x, y, width, height);\n    };\n    /**\n     * Render specified page widgets.\n     */\n    PageLayoutViewer.prototype.renderPage = function (page, x, y, width, height) {\n        this.render.renderWidgets(page, x - this.containerLeft, y - this.containerTop, width, height);\n    };\n    /**\n     * Renders visible pages.\n     * @private\n     */\n    PageLayoutViewer.prototype.renderVisiblePages = function () {\n        if (isNullOrUndefined(this.visiblePages) || this.visiblePages.length < 1) {\n            return;\n        }\n        this.clearContent();\n        for (var i = 0; i < this.visiblePages.length; i++) {\n            var page = this.visiblePages[i];\n            var width = page.boundingRectangle.width * this.zoomFactor;\n            var height = page.boundingRectangle.height * this.zoomFactor;\n            var x = page.boundingRectangle.x;\n            var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.zoomFactor + this.pageGap * (i + 1);\n            this.renderPage(page, x, y, width, height);\n        }\n    };\n    return PageLayoutViewer;\n}(LayoutViewer));\nexport { PageLayoutViewer };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar Zoom = /** @class */ (function () {\n    function Zoom(viewer) {\n        var _this = this;\n        this.onMouseWheelInternal = function (event) {\n            if (event.ctrlKey === true) {\n                event.preventDefault();\n                var pageX = event.pageX - _this.viewer.viewerContainer.offsetLeft;\n                if (pageX < _this.viewer.pageContainer.offsetWidth) {\n                    var wheel = navigator.userAgent.match('Firefox') ? event.detail < 0 : event.wheelDelta > 0;\n                    var zoomFactor = _this.viewer.zoomFactor;\n                    if (wheel) {\n                        if (zoomFactor <= 4.90) {\n                            zoomFactor += .10;\n                        }\n                        else {\n                            zoomFactor = 5.00;\n                        }\n                    }\n                    else {\n                        if (zoomFactor >= .20) {\n                            zoomFactor -= .10;\n                        }\n                        else {\n                            zoomFactor = 0.10;\n                        }\n                    }\n                    _this.viewer.zoomFactor = zoomFactor;\n                }\n            }\n        };\n        this.viewer = viewer;\n    }\n    Zoom.prototype.setZoomFactor = function (value) {\n        this.onZoomFactorChanged();\n        if (!isNullOrUndefined(this.viewer.selection)) {\n            this.viewer.selection.updateCaretPosition();\n        }\n        this.viewer.updateTouchMarkPosition();\n        if (!isNullOrUndefined(this.viewer.owner.imageResizerModule)) {\n            this.viewer.owner.imageResizerModule.updateImageResizerPosition();\n        }\n        this.viewer.owner.fireZoomFactorChange();\n    };\n    //Zoom Implementation Starts\n    Zoom.prototype.onZoomFactorChanged = function () {\n        if (this.viewer.zoomFactor > 5) {\n            this.viewer.zoomFactor = 5;\n        }\n        else if (this.viewer.zoomFactor < 0.1) {\n            this.viewer.zoomFactor = 0.1;\n        }\n        this.zoom();\n    };\n    Zoom.prototype.zoom = function () {\n        var viewer = this.viewer;\n        viewer.clearContent();\n        viewer.handleZoom();\n        viewer.updateFocus();\n    };\n    return Zoom;\n}());\nexport { Zoom };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar HtmlExport = /** @class */ (function () {\n    function HtmlExport() {\n        /* tslint:disable:no-any */\n        this.document = undefined;\n        /* tslint:disable:no-any */\n        /**\n         * @private\n         */\n        this.fieldCheck = 0;\n        /* tslint:enable:no-any */\n    }\n    /* tslint:disable:no-any */\n    /**\n     * @private\n     */\n    HtmlExport.prototype.writeHtml = function (document) {\n        this.document = document;\n        var html = '';\n        for (var i = 0; i < document.sections.length; i++) {\n            html = this.serializeSection(document.sections[i]);\n        }\n        return html;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeSection = function (section) {\n        var string = '';\n        for (var i = 0; i < section.blocks.length; i++) {\n            var block = section.blocks[i];\n            if (block.hasOwnProperty('inlines')) {\n                string += this.serializeParagraph(block);\n            }\n            else {\n                string += this.serializeTable(block);\n            }\n        }\n        return string;\n    };\n    // Serialize Paragraph \n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeParagraph = function (paragraph) {\n        var blockStyle = '';\n        var startString = undefined;\n        var isList = false;\n        var tagAttributes = [];\n        tagAttributes.push('style=\"' + this.serializeParagraphStyle(paragraph, '', isList) + '\"');\n        blockStyle += this.createAttributesTag('p', tagAttributes);\n        if (paragraph.inlines.length === 0) {\n            //Handled to preserve non breaking space for empty paragraphs similar to MS Word behavior.\n            blockStyle += '&nbsp;';\n        }\n        else {\n            blockStyle = this.serializeInlines(paragraph, blockStyle);\n        }\n        blockStyle += this.endTag('p');\n        return blockStyle;\n    };\n    //SerializeInlines\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeInlines = function (paragraph, blockStyle) {\n        var inline = undefined;\n        var i = 0;\n        while (paragraph.inlines.length > i) {\n            inline = paragraph.inlines[i];\n            if (inline.hasOwnProperty('imageString')) {\n                blockStyle += this.serializeImageContainer(inline);\n            }\n            else if (inline.hasOwnProperty('fieldType')) {\n                if (inline.fieldType === 0) {\n                    this.fieldCheck = 1;\n                    var tagAttributes = [];\n                    tagAttributes.push('style=\"' + this.serializeInlineStyle(inline.characterFormat, '') + '\"');\n                    blockStyle += this.createAttributesTag('a', tagAttributes);\n                }\n                else if (inline.fieldType === 2) {\n                    this.fieldCheck = 2;\n                }\n                else {\n                    blockStyle += this.endTag('a');\n                    this.fieldCheck = 0;\n                }\n            }\n            else {\n                var text = isNullOrUndefined(inline.text) ? '' : inline.text;\n                if (this.fieldCheck === 0) {\n                    blockStyle += this.serializeSpan(text, inline.characterFormat);\n                }\n                if (this.fieldCheck === 1) {\n                    var hyperLink = text.replace('\\\"', '');\n                    blockStyle += ' href= \\\"' + hyperLink.replace('HYPERLINK', '').trim();\n                    blockStyle += '\\\"';\n                    blockStyle += '>';\n                }\n                if (this.fieldCheck === 2) {\n                    blockStyle += text;\n                }\n            }\n            i++;\n        }\n        return blockStyle;\n    };\n    // Serialize Span\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeSpan = function (spanText, characterFormat) {\n        var spanClass = '';\n        if (spanText.indexOf('\\v') !== -1) {\n            spanClass += '<br>';\n            return spanClass.toString();\n        }\n        var tagAttributes = [];\n        this.serializeInlineStyle(characterFormat, '');\n        tagAttributes.push('style=\"' + this.serializeInlineStyle(characterFormat, '') + '\"');\n        spanClass += this.createAttributesTag('span', tagAttributes);\n        var ignoreFirstSpace = false;\n        // Todo: Need to handle it.\n        // If the text starts with white-space, need to check whether it is a continuous space.\n        // if (characterFormat.ownerBase instanceof WInline) {\n        //     let inline: WInline = (characterFormat.ownerBase as WInline);\n        //     tslint:disable:max-line-length            \n        //     if (inline instanceof WSpan && !isNullOrUndefined(inline.text) && inline.text !== '' && (inline as WSpan).text[0] === ' ') {\n        //         Check previous inline until, it has valid rendered text.\n        //         do {\n        //             inline = WInline.getPreviousTextInline((inline as WSpan));\n        //         } while (inline instanceof WSpan && !isNullOrUndefined(inline.text));\n        //     } else {\n        //         inline = undefined;\n        //     }\n        //     If current white-space is a continuation of consecutive spaces, this will be set true.\n        //     ignoreFirstSpace = inline instanceof WSpan && !isNullOrUndefined(inline.text)\n        //         && (inline as WSpan).text[(inline as WSpan).text.length - 1] === ' ';\n        // }\n        var text = this.decodeHtmlNames(spanText.toString());\n        spanClass += text;\n        spanClass += this.endTag('span');\n        return spanClass.toString();\n    };\n    //Serialize Image\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeImageContainer = function (image) {\n        var imageStyle = '';\n        var tagAttributes = [];\n        this.serializeInlineStyle(image.characterFormat, '');\n        var imageSource = '';\n        if (!isNullOrUndefined(image.imageString)) {\n            imageSource = image.imageString;\n        }\n        var width = HelperMethods.convertPointToPixel(image.width);\n        var height = HelperMethods.convertPointToPixel(image.height);\n        tagAttributes.push('width=\"', width.toString() + '\"');\n        tagAttributes.push('height=\"', height.toString() + '\"');\n        tagAttributes.push('src=\"', imageSource + '\"');\n        imageStyle += this.createAttributesTag('img', tagAttributes);\n        imageStyle += (this.endTag('img'));\n        return imageStyle.toString();\n    };\n    // Serialize Table Cell\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeCell = function (cell) {\n        var blockStyle = '';\n        var tagAttributes = [];\n        var cellHtml = '';\n        tagAttributes = [];\n        if (!isNullOrUndefined(cell.cellFormat)) {\n            //if (cell.cellFormat.shading.backgroundColor !== Color.FromArgb(0, 0, 0, 0)) {\n            tagAttributes.push('bgcolor=\"' + cell.cellFormat.shading.backgroundColor + '\"');\n            // }\n            if (cell.cellFormat.columnSpan > 1) {\n                tagAttributes.push('colspan=\"' + cell.cellFormat.columnSpan.toString() + '\"');\n            }\n            if (cell.cellFormat.rowSpan > 1) {\n                tagAttributes.push('rowspan=\"' + cell.cellFormat.rowSpan.toString() + '\"');\n            }\n            if (cell.cellFormat.cellWidth !== 0) {\n                tagAttributes.push('width=\"' + cell.cellFormat.cellWidth.toString() + '\"');\n            }\n            if (cell.cellFormat.verticalAlignment !== 'Top') {\n                tagAttributes.push('valign=\"' + cell.cellFormat.verticalAlignment.toString().toLowerCase() + '\"');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.leftMargin) && cell.cellFormat.leftMargin !== 0) {\n                cellHtml += ('padding-left:' + cell.cellFormat.leftMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.rightMargin) && cell.cellFormat.rightMargin !== 0) {\n                cellHtml += ('padding-right:' + cell.cellFormat.rightMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.topMargin) && cell.cellFormat.topMargin !== 0) {\n                cellHtml += ('padding-top:' + cell.cellFormat.topMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.bottomMargin) && cell.cellFormat.bottomMargin !== 0) {\n                cellHtml += ('padding-bottom:' + cell.cellFormat.bottomMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.borders)) {\n                cellHtml += this.serializeCellBordersStyle(cell.cellFormat.borders);\n            }\n        }\n        if (cellHtml.length !== 0) {\n            tagAttributes.push('style=\"' + cellHtml + '\"');\n        }\n        blockStyle += (this.createAttributesTag('td', tagAttributes));\n        for (var k = 0; k < cell.blocks.length; k++) {\n            var block = cell.blocks[k];\n            if (block.hasOwnProperty('rows')) {\n                blockStyle += this.serializeTable(block);\n            }\n            else {\n                blockStyle += this.serializeParagraph(block);\n            }\n        }\n        blockStyle += (this.endTag('td'));\n        return blockStyle;\n    };\n    // Serialize Table\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeTable = function (table) {\n        var html = '';\n        html += this.createTableStartTag(table);\n        for (var j = 0; j < table.rows.length; j++) {\n            html += this.serializeRow(table.rows[j]);\n        }\n        html += this.createTableEndTag();\n        return html;\n    };\n    // Serialize Row\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeRow = function (row) {\n        var html = '';\n        html += this.createRowStartTag(row);\n        for (var k = 0; k < row.cells.length; k++) {\n            html += this.serializeCell(row.cells[k]);\n        }\n        return html;\n    };\n    // Serialize Styles\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeParagraphStyle = function (paragraph, className, isList) {\n        var paragraphClass = '';\n        paragraphClass += this.serializeCharacterFormat(paragraph.characterFormat);\n        paragraphClass += this.serializeParagraphFormat(paragraph.paragraphFormat, isList);\n        return paragraphClass;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeInlineStyle = function (characterFormat, className) {\n        return this.serializeCharacterFormat(characterFormat);\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeTableBorderStyle = function (borders) {\n        var borderStyle = '';\n        borderStyle += ('border-left-style:' + this.convertBorderLineStyle(borders.left.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-left-width:' + borders.left.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-left-color:' + borders.left.color);\n        borderStyle += ';';\n        borderStyle += ('border-right-style:' + this.convertBorderLineStyle(borders.right.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-right-width:' + borders.right.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-right-color:' + borders.right.color);\n        borderStyle += ';';\n        borderStyle += ('border-top-style:' + this.convertBorderLineStyle(borders.top.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-top-width:' + borders.top.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-top-color:' + borders.top.color);\n        borderStyle += ';';\n        borderStyle += ('border-Bottom-style:' + this.convertBorderLineStyle(borders.bottom.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-Bottom-width:' + borders.bottom.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-Bottom-color:' + borders.bottom.color);\n        borderStyle += ';';\n        return borderStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeCellBordersStyle = function (borders) {\n        var borderStyle = '';\n        borderStyle = 'border:solid 1px;';\n        // Todo: handle\n        // let border: WBorder = undefined;\n        // //LeftBorder\n        // border = WCell.getCellLeftBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'left');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-left-style:none;');\n        // }\n        // //RightBorder\n        // border = WCell.getCellRightBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'right');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-right-style:none');\n        // }\n        // //TopBorder\n        // border = WCell.getCellTopBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'top');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-top-style:none');\n        // }\n        // //BottomBorder\n        // border = WCell.getCellBottomBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'bottom');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-bottom-style:none');\n        // }\n        return borderStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeBorderStyle = function (border, borderPosition) {\n        var borderStyle = '';\n        borderStyle += ('border-' + borderPosition + '-style:' + this.convertBorderLineStyle(border.lineStyle));\n        borderStyle += ';';\n        if (border.lineWidth > 0) {\n            borderStyle += ('border-' + borderPosition + '-width:' + border.lineWidth.toString() + 'pt;');\n        }\n        //if (border.color !== Color.FromArgb(0, 0, 0, 0))\n        borderStyle += ('border-' + borderPosition + '-color:' + border.color + ';');\n        return borderStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.convertBorderLineStyle = function (lineStyle) {\n        switch (lineStyle) {\n            case 'None':\n                return 'none';\n            case 'Single':\n                return 'solid';\n            case 'Dot':\n                return 'dotted';\n            case 'DashSmallGap':\n            case 'DashLargeGap':\n            case 'DashDot':\n            case 'DashDotDot':\n                return 'dashed';\n            case 'Double':\n            case 'Triple':\n            case 'ThinThickSmallGap':\n            case 'ThickThinSmallGap':\n            case 'ThinThickThinSmallGap':\n            case 'ThinThickMediumGap':\n            case 'ThickThinMediumGap':\n            case 'ThinThickThinMediumGap':\n            case 'ThinThickLargeGap':\n            case 'ThickThinLargeGap':\n            case 'ThinThickThinLargeGap':\n                return 'double';\n            case 'SingleWavy':\n                return 'solid';\n            case 'DoubleWavy':\n                return 'double';\n            case 'DashDotStroked':\n                return 'solid';\n            case 'Emboss3D':\n                return 'ridge';\n            case 'Engrave3D':\n                return 'groove';\n            case 'Outset':\n                return 'outset';\n            case 'Inset':\n                return 'inset';\n            default:\n                return 'solid';\n        }\n    };\n    // Serialize Format\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeCharacterFormat = function (characterFormat) {\n        if (!isNullOrUndefined(characterFormat.inlineFormat)) {\n            return this.serializeCharacterFormat(characterFormat.inlineFormat);\n        }\n        var propertyValue;\n        var charStyle = '';\n        if (characterFormat.bold) {\n            charStyle += 'font-weight';\n            charStyle += ':';\n            charStyle += 'bold';\n            charStyle += ';';\n        }\n        charStyle += 'font-style';\n        charStyle += ':';\n        if (characterFormat.italic) {\n            charStyle += 'italic';\n        }\n        else {\n            charStyle += 'normal';\n        }\n        charStyle += ';';\n        // Double strike through will become Single strike through while saving HTML using MS Word.\n        if (characterFormat.strikethrough === 'SingleStrike' || characterFormat.strikethrough === 'DoubleStrike') {\n            charStyle += 'text-decoration';\n            charStyle += ':';\n            charStyle += 'line-through';\n            charStyle += ';';\n        }\n        //Text Baseline Alignment\n        // tslint:disable-next-line:max-line-length\n        if (characterFormat.baselineAlignment === 'Superscript' || characterFormat.baselineAlignment === 'Subscript') {\n            charStyle += 'vertical-align';\n            charStyle += ':';\n            charStyle += characterFormat.baselineAlignment === 'Superscript' ? 'super' : 'sub';\n            charStyle += ';';\n        }\n        //Text Foreground and Background Color \n        if (!isNullOrUndefined(characterFormat.highlightColor)) {\n            charStyle += 'background-color';\n            charStyle += ':';\n            charStyle += characterFormat.highlightColor.toString();\n            charStyle += ';';\n        }\n        //Font Color\n        propertyValue = characterFormat.fontColor;\n        if (!isNullOrUndefined(propertyValue)) {\n            charStyle += 'color';\n            charStyle += ':';\n            charStyle += propertyValue;\n            charStyle += ';';\n        }\n        if (!isNullOrUndefined(characterFormat.underline) && characterFormat.underline !== 'None') {\n            charStyle += 'text-decoration';\n            charStyle += ':';\n            charStyle += 'underline';\n            charStyle += ';';\n        }\n        propertyValue = characterFormat.fontSize;\n        if (!isNullOrUndefined(propertyValue)) {\n            charStyle += 'font-size';\n            charStyle += ':';\n            charStyle += propertyValue.toString();\n            charStyle += 'pt';\n            charStyle += ';';\n        }\n        propertyValue = characterFormat.fontFamily;\n        if (!isNullOrUndefined(propertyValue)) {\n            charStyle += 'font-family';\n            charStyle += ':';\n            charStyle += propertyValue.toString();\n            charStyle += ';';\n        }\n        return charStyle.toString();\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeParagraphFormat = function (paragraphFormat, isList) {\n        if (!isNullOrUndefined(paragraphFormat.inlineFormat)) {\n            return this.serializeParagraphFormat(paragraphFormat.inlineFormat, isList);\n        }\n        var propertyValue;\n        var paraStyle = '';\n        propertyValue = paragraphFormat.textAlignment;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'text-align:' + propertyValue.toLowerCase() + ';';\n        }\n        propertyValue = paragraphFormat.beforeSpacing;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-top:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.rightIndent;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-right:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.afterSpacing;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-bottom:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.leftIndent;\n        if (isList) {\n            if (isNullOrUndefined(propertyValue)) {\n                propertyValue = -48;\n            }\n            else {\n                propertyValue -= 48;\n            }\n        }\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-left:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.firstLineIndent;\n        if (isList) {\n            if (isNullOrUndefined(propertyValue)) {\n                propertyValue = 24;\n            }\n            else {\n                propertyValue += 24;\n            }\n        }\n        if (!isNullOrUndefined(propertyValue) && propertyValue !== 0) {\n            paraStyle += 'text-indent:' + propertyValue.toString() + 'pt;';\n        }\n        propertyValue = paragraphFormat.lineSpacing;\n        if (!isNullOrUndefined(propertyValue)) {\n            if (paragraphFormat.lineSpacingType === 'Multiple') {\n                propertyValue = (propertyValue * 100).toString() + '%;';\n            }\n            else {\n                propertyValue = propertyValue.toString() + 'pt;';\n            }\n            paraStyle += 'line-height:' + propertyValue;\n        }\n        return paraStyle.toString();\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createAttributesTag = function (tagValue, localProperties) {\n        var sb = '';\n        sb += '<';\n        sb += tagValue;\n        for (var i = 0; i < localProperties.length; i++) {\n            sb += ' ';\n            sb += localProperties[i];\n        }\n        if (tagValue !== 'a') {\n            sb += '>';\n        }\n        return sb;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createTag = function (tagValue) {\n        var s = '';\n        s += '<';\n        s += tagValue;\n        s += '>';\n        return s;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.endTag = function (tagValue) {\n        var sb = '';\n        sb += '<';\n        sb += '/';\n        sb += tagValue;\n        sb += '>';\n        return sb;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createTableStartTag = function (table) {\n        var blockStyle = '';\n        var tableStyle = '';\n        var tagAttributes = [];\n        tagAttributes.push('border=\"' + '1\"');\n        if (!isNullOrUndefined(table.tableFormat)) {\n            //if (table.tableFormat.shading.backgroundColor !== Color.FromArgb(0, 0, 0, 0)) {\n            tagAttributes.push('bgcolor=\"' + table.tableFormat.shading.backgroundColor + '\"');\n            //}\n            if (table.tableFormat.leftIndent !== 0) {\n                tagAttributes.push('left-indent=\"' + table.tableFormat.leftIndent.toString() + 'pt;');\n            }\n            if (table.tableFormat.cellSpacing > 0) {\n                tagAttributes.push('cellspacing=\"' + (((table.tableFormat.cellSpacing * 72) / 96) * 2).toString() + '\"');\n            }\n            else {\n                tableStyle += ('border-collapse:collapse;');\n            }\n            tagAttributes.push('cellpadding=\"' + '0\"');\n            if (!isNullOrUndefined(table.tableFormat.borders)) {\n                tableStyle += this.serializeTableBorderStyle(table.tableFormat.borders);\n            }\n        }\n        if (tableStyle.length !== 0) {\n            tagAttributes.push('style=\"', tableStyle.toString() + '\"');\n        }\n        return blockStyle += (this.createAttributesTag('table', tagAttributes));\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createTableEndTag = function () {\n        var blockStyle = '';\n        blockStyle += (this.endTag('table'));\n        return blockStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createRowStartTag = function (row) {\n        var blockStyle = '';\n        var tagAttributes = [];\n        if (row.rowFormat.isHeader) {\n            blockStyle += (this.createTag('thead'));\n        }\n        if (row.rowFormat.height > 0) {\n            tagAttributes.push('height=\"' + row.rowFormat.height + '\"');\n        }\n        return blockStyle + this.createAttributesTag('tr', tagAttributes);\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createRowEndTag = function (row) {\n        var blockStyle = '';\n        blockStyle += (this.endTag('tr'));\n        if (row.rowFormat.isHeader) {\n            blockStyle += (this.endTag('thead'));\n        }\n        return blockStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.decodeHtmlNames = function (text) {\n        if (text === '\\t') {\n            return '&emsp;';\n        }\n        var splittedText = text.split(' ');\n        var htmlText = '';\n        if (splittedText.length > 0) {\n            htmlText = splittedText[0];\n            for (var i = 0; i < splittedText.length - 1; i++) {\n                htmlText += '&nbsp;' + splittedText[i + 1];\n            }\n        }\n        return htmlText;\n    };\n    return HtmlExport;\n}());\nexport { HtmlExport };\n","/**\n * Export Export\n */\nexport * from './word-export';\nexport * from './text-export';\nexport * from './sfdt-export';\nexport * from './html-export';\n","import { LineWidget, ParagraphWidget, BodyWidget, TextElementBox, FieldElementBox, TableRowWidget, TableCellWidget, ImageElementBox, ListTextElementBox, BookmarkElementBox } from '../viewer/page';\nimport { BlockWidget } from '../viewer/page';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { StreamWriter } from '@syncfusion/ej2-file-utils';\n/**\n * Exports the document to Sfdt format.\n */\nvar SfdtExport = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SfdtExport(owner) {\n        /* tslint:disable:no-any */\n        this.endLine = undefined;\n        this.endOffset = undefined;\n        this.endCell = undefined;\n        this.startColumnIndex = undefined;\n        this.endColumnIndex = undefined;\n        this.lists = undefined;\n        this.viewer = undefined;\n        this.document = undefined;\n        this.writeInlineStyles = undefined;\n        this.viewer = owner;\n    }\n    SfdtExport.prototype.getModuleName = function () {\n        return 'SfdtExport';\n    };\n    SfdtExport.prototype.clear = function () {\n        this.writeInlineStyles = undefined;\n        this.endLine = undefined;\n        this.lists = undefined;\n        this.document = undefined;\n    };\n    /**\n     * Serialize the data as Syncfusion document text.\n     * @private\n     */\n    SfdtExport.prototype.serialize = function () {\n        return JSON.stringify(this.write());\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.saveAsBlob = function (viewer) {\n        var streamWriter = new StreamWriter();\n        streamWriter.write(this.serialize());\n        var blob = streamWriter.buffer;\n        streamWriter.destroy();\n        var promise;\n        return new Promise(function (resolve, reject) {\n            resolve(blob);\n        });\n    };\n    // tslint:disable-next-line:max-line-length\n    /**\n     * @private\n     */\n    SfdtExport.prototype.write = function (line, startOffset, endLine, endOffset, writeInlineStyles) {\n        if (writeInlineStyles) {\n            this.writeInlineStyles = true;\n        }\n        this.lists = [];\n        this.document = {};\n        this.document.sections = [];\n        this.document.characterFormat = this.writeCharacterFormat(this.viewer.characterFormat);\n        this.document.paragraphFormat = this.writeParagraphFormat(this.viewer.paragraphFormat);\n        this.document.defaultTabWidth = this.viewer.defaultTabWidth;\n        if (line instanceof LineWidget && endLine instanceof LineWidget) {\n            // For selection\n            var startPara = line.paragraph;\n            var endPara = endLine.paragraph;\n            var startCell = startPara.associatedCell;\n            var endCell = endPara.associatedCell;\n            // Creates section\n            var bodyWidget = startPara.bodyWidget;\n            var section = this.createSection(line.paragraph.bodyWidget);\n            this.document.sections.push(section);\n            if (startCell === endCell || isNullOrUndefined(endCell)) {\n                this.endLine = endLine;\n                this.endOffset = endOffset;\n            }\n            else {\n                // Todo: Handle nested table cases\n                if (startCell instanceof TableCellWidget) {\n                    var startTable = startCell.getContainerTable();\n                    var endTable = endCell.getContainerTable();\n                    if (startTable.tableFormat === endTable.tableFormat) {\n                        this.endCell = endCell;\n                        this.endColumnIndex = this.endCell.columnIndex + this.endCell.cellFormat.columnSpan;\n                        this.startColumnIndex = startCell.columnIndex;\n                    }\n                }\n                else {\n                    this.endCell = endCell;\n                }\n            }\n            if (startCell === endCell || isNullOrUndefined(startCell)) {\n                var paragraph = this.createParagraph(line.paragraph);\n                section.blocks.push(paragraph);\n                if (!this.writeParagraph(line.paragraph, paragraph, section.blocks, line.indexInOwner, startOffset)) {\n                    // Todo:continue in next section\n                }\n            }\n            else {\n                var table = this.createTable(startCell.ownerTable);\n                section.blocks.push(table);\n                this.writeTable(startCell.ownerTable, table, startCell.ownerRow.indexInOwner, section.blocks);\n            }\n        }\n        else {\n            if (this.viewer.pages.length > 0) {\n                var page = this.viewer.pages[0];\n                if (page.bodyWidgets.length > 0) {\n                    this.writeBodyWidget(page.bodyWidgets[0], 0);\n                }\n            }\n        }\n        this.writeStyles(this.viewer);\n        this.writeLists(this.viewer);\n        var doc = this.document;\n        this.clear();\n        return doc;\n    };\n    SfdtExport.prototype.writeBodyWidget = function (bodyWidget, index) {\n        if (!(bodyWidget instanceof BodyWidget)) {\n            return true;\n        }\n        var section = this.createSection(bodyWidget);\n        this.document.sections.push(section);\n        this.writeHeaderFooters(this.viewer.headersFooters[bodyWidget.index], section);\n        if (this.writeBlock(bodyWidget.childWidgets[index], 0, section.blocks)) {\n            return true;\n        }\n        var next = bodyWidget;\n        do {\n            bodyWidget = next;\n            next = next.nextRenderedWidget;\n        } while (next instanceof BodyWidget && next.index === bodyWidget.index);\n        return this.writeBodyWidget(next, index);\n    };\n    SfdtExport.prototype.writeHeaderFooters = function (hfs, section) {\n        if (isNullOrUndefined(hfs)) {\n            return;\n        }\n        section.headersFooters.header = this.writeHeaderFooter(hfs[0]);\n        section.headersFooters.footer = this.writeHeaderFooter(hfs[1]);\n        section.headersFooters.evenHeader = this.writeHeaderFooter(hfs[2]);\n        section.headersFooters.evenFooter = this.writeHeaderFooter(hfs[3]);\n        section.headersFooters.firstPageHeader = this.writeHeaderFooter(hfs[4]);\n        section.headersFooters.firstPageFooter = this.writeHeaderFooter(hfs[5]);\n    };\n    SfdtExport.prototype.writeHeaderFooter = function (widget) {\n        if (isNullOrUndefined(widget) || widget.isEmpty) {\n            return undefined;\n        }\n        var headerFooter = {};\n        if (widget && widget.childWidgets && widget.childWidgets.length > 0) {\n            headerFooter.blocks = [];\n            this.writeBlock(widget.firstChild, 0, headerFooter.blocks);\n        }\n        return headerFooter;\n    };\n    SfdtExport.prototype.createSection = function (bodyWidget) {\n        var section = {};\n        section.sectionFormat = {};\n        section.sectionFormat.pageWidth = bodyWidget.sectionFormat.pageWidth;\n        section.sectionFormat.pageHeight = bodyWidget.sectionFormat.pageHeight;\n        section.sectionFormat.leftMargin = bodyWidget.sectionFormat.leftMargin;\n        section.sectionFormat.rightMargin = bodyWidget.sectionFormat.rightMargin;\n        section.sectionFormat.topMargin = bodyWidget.sectionFormat.topMargin;\n        section.sectionFormat.bottomMargin = bodyWidget.sectionFormat.bottomMargin;\n        section.sectionFormat.differentFirstPage = bodyWidget.sectionFormat.differentFirstPage;\n        section.sectionFormat.differentOddAndEvenPages = bodyWidget.sectionFormat.differentOddAndEvenPages;\n        section.sectionFormat.headerDistance = bodyWidget.sectionFormat.headerDistance;\n        section.sectionFormat.footerDistance = bodyWidget.sectionFormat.footerDistance;\n        section.sectionFormat.bidi = bodyWidget.sectionFormat.bidi;\n        section.blocks = [];\n        section.headersFooters = {};\n        return section;\n    };\n    SfdtExport.prototype.writeBlock = function (widget, index, blocks) {\n        if (!(widget instanceof BlockWidget)) {\n            return true;\n        }\n        if (widget instanceof ParagraphWidget) {\n            var paragraph = this.createParagraph(widget);\n            blocks.push(paragraph);\n            if (this.writeParagraph(widget, paragraph, blocks)) {\n                return true;\n            }\n        }\n        else {\n            var tableWidget = widget;\n            var table = this.createTable(tableWidget);\n            blocks.push(table);\n            if (this.writeTable(tableWidget, table, 0, blocks)) {\n                return true;\n            }\n        }\n        return false;\n    };\n    SfdtExport.prototype.writeNextBlock = function (widget, blocks) {\n        var next = widget.nextRenderedWidget;\n        if (next instanceof BlockWidget && next.containerWidget.index === widget.containerWidget.index) {\n            return this.writeBlock(widget.nextRenderedWidget, 0, blocks);\n        }\n        return false;\n    };\n    SfdtExport.prototype.writeParagraph = function (paragraphWidget, paragraph, blocks, lineIndex, start) {\n        if (isNullOrUndefined(lineIndex)) {\n            lineIndex = 0;\n        }\n        if (isNullOrUndefined(start)) {\n            start = 0;\n        }\n        var next = paragraphWidget;\n        while (next instanceof ParagraphWidget) {\n            if (this.writeLines(next, lineIndex, start, paragraph.inlines)) {\n                return true;\n            }\n            lineIndex = 0;\n            start = 0;\n            paragraphWidget = next;\n            next = paragraphWidget.nextSplitWidget;\n        }\n        return this.writeNextBlock(paragraphWidget, blocks);\n    };\n    SfdtExport.prototype.writeInlines = function (paragraph, line, inlines) {\n        var lineWidget = line.clone();\n        var bidi = paragraph.paragraphFormat.getValue('bidi');\n        if (bidi || this.viewer.layout.isContainsRtl(lineWidget)) {\n            this.viewer.layout.reArrangeElementsForRtl(lineWidget, bidi);\n        }\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var element = lineWidget.children[i];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            var inline = this.writeInline(element);\n            if (!isNullOrUndefined(inline)) {\n                inlines.push(inline);\n            }\n        }\n    };\n    SfdtExport.prototype.writeInline = function (element) {\n        var inline = {};\n        inline.characterFormat = this.writeCharacterFormat(element.characterFormat);\n        if (element instanceof FieldElementBox) {\n            inline.fieldType = element.fieldType;\n        }\n        else if (element instanceof ImageElementBox) {\n            inline.imageString = element.imageString;\n            inline.width = HelperMethods.convertPixelToPoint(element.width);\n            inline.height = HelperMethods.convertPixelToPoint(element.height);\n        }\n        else if (element instanceof BookmarkElementBox) {\n            inline.bookmarkType = element.bookmarkType;\n            inline.name = element.name;\n        }\n        else if (element instanceof TextElementBox) {\n            inline.text = element.text;\n        }\n        else {\n            inline = undefined;\n        }\n        return inline;\n    };\n    SfdtExport.prototype.writeLines = function (paragraph, lineIndex, offset, inlines) {\n        var startIndex = lineIndex;\n        var endParagraph = this.endLine instanceof LineWidget && this.endLine.paragraph === paragraph;\n        var endIndex = endParagraph ? this.endLine.indexInOwner : paragraph.childWidgets.length - 1;\n        for (var i = startIndex; i <= endIndex; i++) {\n            var child = paragraph.childWidgets[i];\n            if (this.endLine === child || (lineIndex === i && offset !== 0)) {\n                this.writeLine(child, offset, inlines);\n            }\n            else {\n                this.writeInlines(paragraph, child, inlines);\n            }\n        }\n        return endParagraph;\n    };\n    SfdtExport.prototype.writeLine = function (line, offset, inlines) {\n        var isEnd = line === this.endLine;\n        var started = false;\n        var ended = false;\n        var length = 0;\n        for (var j = 0; j < line.children.length; j++) {\n            var element = line.children[j];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            var inline = undefined;\n            length += element.length;\n            started = length > offset;\n            ended = isEnd && length >= this.endOffset;\n            if (!started) {\n                continue;\n            }\n            inline = this.writeInline(element);\n            inlines[inlines.length] = inline;\n            if (length > offset || ended) {\n                if (inline.hasOwnProperty('text')) {\n                    var startIndex = length - element.length;\n                    var indexInInline = offset - startIndex;\n                    var endIndex = ended ? this.endOffset - startIndex : element.length;\n                    inline.text = inline.text.substring(indexInInline, endIndex);\n                }\n                offset = -1;\n            }\n            if (ended) {\n                break;\n            }\n        }\n    };\n    SfdtExport.prototype.createParagraph = function (paragraphWidget) {\n        var paragraph = {};\n        paragraph.paragraphFormat = this.writeParagraphFormat(paragraphWidget.paragraphFormat);\n        paragraph.characterFormat = this.writeCharacterFormat(paragraphWidget.characterFormat);\n        paragraph.inlines = [];\n        return paragraph;\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.writeCharacterFormat = function (format, isInline) {\n        var characterFormat = {};\n        HelperMethods.writeCharacterFormat(characterFormat, isInline, format);\n        if (this.writeInlineStyles && !isInline) {\n            characterFormat.inlineFormat = this.writeCharacterFormat(format, true);\n        }\n        return characterFormat;\n    };\n    SfdtExport.prototype.writeParagraphFormat = function (format, isInline) {\n        var paragraphFormat = {};\n        paragraphFormat.leftIndent = isInline ? format.leftIndent : format.getValue('leftIndent');\n        paragraphFormat.rightIndent = isInline ? format.rightIndent : format.getValue('rightIndent');\n        paragraphFormat.firstLineIndent = isInline ? format.firstLineIndent : format.getValue('firstLineIndent');\n        paragraphFormat.textAlignment = isInline ? format.textAlignment : format.getValue('textAlignment');\n        paragraphFormat.beforeSpacing = isInline ? format.beforeSpacing : format.getValue('beforeSpacing');\n        paragraphFormat.afterSpacing = isInline ? format.afterSpacing : format.getValue('afterSpacing');\n        paragraphFormat.lineSpacing = isInline ? format.lineSpacing : format.getValue('lineSpacing');\n        paragraphFormat.lineSpacingType = isInline ? format.lineSpacingType : format.getValue('lineSpacingType');\n        paragraphFormat.styleName = !isNullOrUndefined(format.baseStyle) ? format.baseStyle.name : undefined;\n        paragraphFormat.outlineLevel = isInline ? format.outlineLevel : format.getValue('outlineLevel');\n        paragraphFormat.listFormat = this.writeListFormat(format.listFormat, isInline);\n        paragraphFormat.tabs = this.writeTabs(format.tabs);\n        paragraphFormat.bidi = isInline ? format.bidi : format.getValue('bidi');\n        if (this.writeInlineStyles && !isInline) {\n            paragraphFormat.inlineFormat = this.writeParagraphFormat(format, true);\n        }\n        return paragraphFormat;\n    };\n    SfdtExport.prototype.writeTabs = function (tabStops) {\n        if (isNullOrUndefined(tabStops) || tabStops.length < 1) {\n            return undefined;\n        }\n        var tabs = [];\n        for (var i = 0; i < tabStops.length; i++) {\n            var tabStop = tabStops[i];\n            var tab = {};\n            tab.position = tabStop.position;\n            tab.deletePosition = tabStop.deletePosition;\n            tab.tabJustification = tabStop.tabJustification;\n            tab.tabLeader = tabStop.tabLeader;\n            tabs.push(tab);\n        }\n        return tabs;\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.writeListFormat = function (format, isInline) {\n        var listFormat = {};\n        var listIdValue = format.getValue('listId');\n        if (!isNullOrUndefined(listIdValue) && listIdValue > -1) {\n            listFormat.listId = listIdValue;\n            listFormat.listLevelNumber = format.getValue('listLevelNumber');\n            if (this.lists.indexOf(format.listId) < 0) {\n                this.lists.push(format.listId);\n            }\n        }\n        return listFormat;\n    };\n    SfdtExport.prototype.writeTable = function (tableWidget, table, index, blocks) {\n        var widget = tableWidget.childWidgets[index];\n        if (widget instanceof TableRowWidget) {\n            if (this.writeRow(widget, table.rows)) {\n                return true;\n            }\n        }\n        var next = tableWidget;\n        do {\n            tableWidget = next;\n            next = tableWidget.nextSplitWidget;\n        } while (next instanceof BlockWidget);\n        return this.writeNextBlock(tableWidget, blocks);\n    };\n    SfdtExport.prototype.writeRow = function (rowWidget, rows) {\n        if (!(rowWidget instanceof TableRowWidget)) {\n            return false;\n        }\n        var row = this.createRow(rowWidget);\n        rows.push(row);\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var widget = rowWidget.childWidgets[i];\n            if (widget instanceof TableCellWidget) {\n                if (rowWidget.index === widget.rowIndex\n                    && (isNullOrUndefined(this.startColumnIndex) || widget.columnIndex >= this.startColumnIndex)\n                    && (isNullOrUndefined(this.endColumnIndex) || widget.columnIndex < this.endColumnIndex)) {\n                    if (this.writeCell(widget, row.cells)) {\n                        return true;\n                    }\n                }\n            }\n        }\n        var next = rowWidget;\n        do {\n            rowWidget = next;\n            next = rowWidget.nextRenderedWidget;\n        } while (next instanceof TableRowWidget && next.index === rowWidget.index);\n        return this.writeRow(next, rows);\n    };\n    SfdtExport.prototype.writeCell = function (cellWidget, cells) {\n        var cell = this.createCell(cellWidget);\n        cells.push(cell);\n        if (this.writeBlock(cellWidget.firstChild, 0, cell.blocks)) {\n            return true;\n        }\n        return this.endCell instanceof TableCellWidget ? this.endCell.cellFormat === cellWidget.cellFormat : false;\n    };\n    SfdtExport.prototype.createTable = function (tableWidget) {\n        var table = {};\n        table.rows = [];\n        table.grid = [];\n        for (var i = 0; i < tableWidget.tableHolder.columns.length; i++) {\n            table.grid[i] = tableWidget.tableHolder.columns[i].preferredWidth;\n        }\n        table.tableFormat = this.writeTableFormat(tableWidget.tableFormat);\n        table.description = tableWidget.description;\n        table.title = tableWidget.title;\n        return table;\n    };\n    SfdtExport.prototype.createRow = function (rowWidget) {\n        var row = {};\n        row.cells = [];\n        row.rowFormat = this.writeRowFormat(rowWidget.rowFormat);\n        return row;\n    };\n    SfdtExport.prototype.createCell = function (cellWidget) {\n        var cell = {};\n        cell.blocks = [];\n        cell.cellFormat = this.writeCellFormat(cellWidget.cellFormat);\n        cell.columnIndex = cellWidget.columnIndex;\n        return cell;\n    };\n    SfdtExport.prototype.writeShading = function (wShading) {\n        var shading = {};\n        shading.backgroundColor = wShading.backgroundColor;\n        shading.foregroundColor = wShading.foregroundColor;\n        shading.textureStyle = wShading.textureStyle;\n        return shading;\n    };\n    SfdtExport.prototype.writeBorder = function (wBorder) {\n        var border = {};\n        border.color = wBorder.color;\n        border.hasNoneStyle = wBorder.hasNoneStyle;\n        border.lineStyle = wBorder.lineStyle;\n        border.lineWidth = wBorder.lineWidth;\n        border.shadow = wBorder.shadow;\n        border.space = wBorder.space;\n        return border;\n    };\n    SfdtExport.prototype.writeBorders = function (wBorders) {\n        var borders = {};\n        borders.top = this.writeBorder(wBorders.top);\n        borders.left = this.writeBorder(wBorders.left);\n        borders.right = this.writeBorder(wBorders.right);\n        borders.bottom = this.writeBorder(wBorders.bottom);\n        borders.diagonalDown = this.writeBorder(wBorders.diagonalDown);\n        borders.diagonalUp = this.writeBorder(wBorders.diagonalUp);\n        borders.horizontal = this.writeBorder(wBorders.horizontal);\n        borders.vertical = this.writeBorder(wBorders.vertical);\n        return borders;\n    };\n    SfdtExport.prototype.writeCellFormat = function (wCellFormat) {\n        var cellFormat = {};\n        cellFormat.borders = this.writeBorders(wCellFormat.borders);\n        cellFormat.shading = this.writeShading(wCellFormat.shading);\n        cellFormat.topMargin = wCellFormat.topMargin;\n        cellFormat.rightMargin = wCellFormat.rightMargin;\n        cellFormat.leftMargin = wCellFormat.leftMargin;\n        cellFormat.bottomMargin = wCellFormat.bottomMargin;\n        cellFormat.preferredWidth = wCellFormat.preferredWidth;\n        cellFormat.preferredWidthType = wCellFormat.preferredWidthType;\n        cellFormat.cellWidth = wCellFormat.cellWidth;\n        cellFormat.columnSpan = wCellFormat.columnSpan;\n        cellFormat.rowSpan = wCellFormat.rowSpan;\n        cellFormat.verticalAlignment = wCellFormat.verticalAlignment;\n        return cellFormat;\n    };\n    SfdtExport.prototype.writeRowFormat = function (wRowFormat) {\n        var rowFormat = {};\n        rowFormat.height = wRowFormat.height;\n        rowFormat.allowBreakAcrossPages = wRowFormat.allowBreakAcrossPages;\n        rowFormat.heightType = wRowFormat.heightType;\n        rowFormat.isHeader = wRowFormat.isHeader;\n        rowFormat.borders = this.writeBorders(wRowFormat.borders);\n        rowFormat.gridBefore = wRowFormat.gridBefore;\n        rowFormat.gridBeforeWidth = wRowFormat.gridBeforeWidth;\n        rowFormat.gridBeforeWidthType = wRowFormat.gridBeforeWidthType;\n        rowFormat.gridAfter = wRowFormat.gridAfter;\n        rowFormat.gridAfterWidth = wRowFormat.gridAfterWidth;\n        rowFormat.gridAfterWidthType = wRowFormat.gridAfterWidthType;\n        return rowFormat;\n    };\n    SfdtExport.prototype.writeTableFormat = function (wTableFormat) {\n        var tableFormat = {};\n        tableFormat.borders = this.writeBorders(wTableFormat.borders);\n        tableFormat.shading = this.writeShading(wTableFormat.shading);\n        tableFormat.cellSpacing = wTableFormat.cellSpacing;\n        tableFormat.leftIndent = wTableFormat.leftIndent;\n        tableFormat.tableAlignment = wTableFormat.tableAlignment;\n        tableFormat.topMargin = wTableFormat.topMargin;\n        tableFormat.rightMargin = wTableFormat.rightMargin;\n        tableFormat.leftMargin = wTableFormat.leftMargin;\n        tableFormat.bottomMargin = wTableFormat.bottomMargin;\n        tableFormat.preferredWidth = wTableFormat.preferredWidth;\n        tableFormat.preferredWidthType = wTableFormat.preferredWidthType;\n        tableFormat.bidi = wTableFormat.bidi;\n        tableFormat.allowAutoFit = wTableFormat.allowAutoFit;\n        return tableFormat;\n    };\n    SfdtExport.prototype.writeStyles = function (viewer) {\n        var styles = [];\n        this.document.styles = [];\n        for (var i = 0; i < viewer.styles.length; i++) {\n            this.document.styles.push(this.writeStyle(viewer.styles.getItem(i)));\n        }\n    };\n    SfdtExport.prototype.writeStyle = function (style) {\n        var wStyle = {};\n        wStyle.name = style.name;\n        if (style.type === 'Paragraph') {\n            wStyle.type = 'Paragraph';\n            wStyle.paragraphFormat = this.writeParagraphFormat(style.paragraphFormat);\n            wStyle.characterFormat = this.writeCharacterFormat(style.characterFormat);\n        }\n        if (style.type === 'Character') {\n            wStyle.type = 'Character';\n            wStyle.characterFormat = this.writeCharacterFormat(style.characterFormat);\n        }\n        if (!isNullOrUndefined(style.basedOn)) {\n            wStyle.basedOn = style.basedOn.name;\n        }\n        if (!isNullOrUndefined(style.link)) {\n            wStyle.link = style.link.name;\n        }\n        if (!isNullOrUndefined(style.next)) {\n            wStyle.next = style.next.name;\n        }\n        return wStyle;\n    };\n    SfdtExport.prototype.writeLists = function (viewer) {\n        var abstractLists = [];\n        this.document.lists = [];\n        for (var i = 0; i < viewer.lists.length; i++) {\n            var list = viewer.lists[i];\n            if (this.lists.indexOf(list.listId) > -1) {\n                this.document.lists.push(this.writeList(list));\n                if (abstractLists.indexOf(list.abstractListId) < 0) {\n                    abstractLists.push(list.abstractListId);\n                }\n            }\n        }\n        this.document.abstractLists = [];\n        for (var i = 0; i < viewer.abstractLists.length; i++) {\n            var abstractList = viewer.abstractLists[i];\n            if (this.lists.indexOf(abstractList.abstractListId) > -1) {\n                this.document.abstractLists.push(this.writeAbstractList(abstractList));\n            }\n        }\n    };\n    SfdtExport.prototype.writeAbstractList = function (wAbstractList) {\n        var abstractList = {};\n        abstractList.abstractListId = wAbstractList.abstractListId;\n        abstractList.levels = [];\n        for (var i = 0; i < wAbstractList.levels.length; i++) {\n            abstractList.levels[i] = this.writeListLevel(wAbstractList.levels[i]);\n        }\n        return abstractList;\n    };\n    SfdtExport.prototype.writeList = function (wList) {\n        var list = {};\n        list.abstractListId = wList.abstractListId;\n        //list.levelOverrides = wList.levelOverrides;\n        list.listId = wList.listId;\n        return list;\n    };\n    SfdtExport.prototype.writeListLevel = function (wListLevel) {\n        var listLevel = {};\n        listLevel.characterFormat = this.writeCharacterFormat(wListLevel.characterFormat);\n        listLevel.paragraphFormat = this.writeParagraphFormat(wListLevel.paragraphFormat);\n        listLevel.followCharacter = wListLevel.followCharacter;\n        listLevel.listLevelPattern = wListLevel.listLevelPattern;\n        listLevel.numberFormat = wListLevel.numberFormat;\n        listLevel.restartLevel = wListLevel.restartLevel;\n        listLevel.startAt = wListLevel.startAt;\n        return listLevel;\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.destroy = function () {\n        this.lists = undefined;\n        this.endLine = undefined;\n        this.endOffset = undefined;\n        this.viewer = undefined;\n    };\n    return SfdtExport;\n}());\nexport { SfdtExport };\n","import { StreamWriter } from '@syncfusion/ej2-file-utils';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Exports the document to Text format.\n */\nvar TextExport = /** @class */ (function () {\n    function TextExport() {\n        this.text = '';\n        this.curSectionIndex = 0;\n        this.inField = false;\n    }\n    TextExport.prototype.getModuleName = function () {\n        return 'TextExport';\n    };\n    /**\n     * @private\n     */\n    TextExport.prototype.save = function (viewer, fileName) {\n        this.serialize(viewer);\n        var writer = new StreamWriter();\n        this.writeInternal(writer);\n        writer.save(fileName + '.txt');\n    };\n    /**\n     * @private\n     */\n    TextExport.prototype.saveAsBlob = function (viewer) {\n        this.serialize(viewer);\n        var streamWriter = new StreamWriter();\n        this.writeInternal(streamWriter);\n        var blob = streamWriter.buffer;\n        streamWriter.destroy();\n        var promise;\n        return new Promise(function (resolve, reject) {\n            resolve(blob);\n        });\n    };\n    TextExport.prototype.serialize = function (viewer) {\n        var document = viewer.owner.sfdtExportModule.write();\n        this.setDocument(document);\n    };\n    TextExport.prototype.setDocument = function (document) {\n        this.document = document;\n        this.mSections = document.sections;\n    };\n    TextExport.prototype.writeInternal = function (streamWriter) {\n        var section = undefined;\n        var sectionCount = this.document.sections.length - 1;\n        var isLastSection = false;\n        this.updateLastParagraph();\n        for (var i = 0; i <= sectionCount; i++) {\n            section = this.document.sections[i];\n            isLastSection = (i === sectionCount) ? true : false;\n            this.writeBody(streamWriter, section.blocks);\n            this.writeNewLine(streamWriter);\n            this.writeSectionEnd(section, isLastSection);\n        }\n        for (var j = 0; j <= sectionCount; j++) {\n            section = this.document.sections[j];\n            this.writeHeadersFooters(streamWriter, section);\n        }\n    };\n    /// <summary>\n    /// Writes the specified document content to the text file.\n    /// </summary>\n    TextExport.prototype.writeBody = function (streamWriter, body) {\n        var bodyItemsCount = body.length - 1;\n        var bodyItem = undefined;\n        for (var i = 0; i <= bodyItemsCount; i++) {\n            bodyItem = body[i];\n            if (bodyItem.hasOwnProperty('inlines')) {\n                var isLastPara = (bodyItem === this.lastPara) ? true : false;\n                this.writeParagraph(streamWriter, bodyItem, isLastPara);\n            }\n            else {\n                this.writeTable(streamWriter, bodyItem);\n            }\n        }\n    };\n    TextExport.prototype.writeParagraph = function (streamWriter, paragraph, isLastPara) {\n        for (var i = 0; i < paragraph.inlines.length; i++) {\n            var item = paragraph.inlines[i];\n            if (item.hasOwnProperty('fieldType')) {\n                this.inField = item.fieldType === 0;\n            }\n            else if (item.hasOwnProperty('text') && !this.inField) {\n                this.writeText(streamWriter, item.text);\n            }\n        }\n        if (!isLastPara) {\n            this.writeNewLine(streamWriter);\n        }\n    };\n    /// }\n    /// <summary>\n    /// Writes the specified table text content to the text file.\n    /// </summary>\n    TextExport.prototype.writeTable = function (streamWriter, table) {\n        for (var i = 0; i < table.rows.length; i++) {\n            var row = table.rows[i];\n            for (var j = 0; j < row.cells.length; j++) {\n                var cell = row.cells[j];\n                this.writeBody(streamWriter, cell.blocks);\n            }\n        }\n    };\n    /// <summary>\n    /// Writes the specified Header Footer text content to the text file.\n    /// </summary>\n    TextExport.prototype.writeHeadersFooters = function (streamWriter, section) {\n        var headersFooters = section.headersFooters;\n        if (isNullOrUndefined(headersFooters)) {\n            return;\n        }\n        this.writeHeaderFooter(streamWriter, section.headersFooters.header);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.footer);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.evenFooter);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.evenHeader);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.firstPageHeader);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.firstPageFooter);\n    };\n    TextExport.prototype.writeHeaderFooter = function (streamWriter, headerFooter) {\n        if (headerFooter && headerFooter.blocks) {\n            this.writeBody(streamWriter, headerFooter.blocks);\n        }\n    };\n    /// <summary>\n    /// Writes the end of the section.\n    /// </summary>\n    TextExport.prototype.writeSectionEnd = function (section, lastSection) {\n        this.curSectionIndex++;\n    };\n    TextExport.prototype.writeNewLine = function (writer) {\n        writer.writeLine('');\n    };\n    TextExport.prototype.writeText = function (writer, text) {\n        writer.write(text);\n    };\n    TextExport.prototype.updateLastParagraph = function () {\n        var cnt = this.document.sections.length;\n        var sec;\n        if (cnt > 0) {\n            sec = this.document.sections[cnt - 1];\n        }\n        if (!isNullOrUndefined(sec)) {\n            var paragraphs = [];\n            for (var i = 0; i < sec.blocks.length; i++) {\n                if (sec.blocks[i].hasOwnProperty('inlines')) {\n                    paragraphs.push(sec.blocks[i]);\n                }\n            }\n            var pCount = paragraphs.length;\n            if (pCount > 0) {\n                this.lastPara = paragraphs[pCount - 1];\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextExport.prototype.destroy = function () {\n        this.document = undefined;\n        this.lastPara = undefined;\n        this.mSections = undefined;\n        this.sections = undefined;\n    };\n    return TextExport;\n}());\nexport { TextExport };\n","import { ZipArchive, ZipArchiveItem } from '@syncfusion/ej2-compression';\nimport { XmlWriter } from '@syncfusion/ej2-file-utils';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../index';\nimport { Dictionary } from '../../index';\n/**\n * Exports the document to Word format.\n */\nvar WordExport = /** @class */ (function () {\n    function WordExport() {\n        //Part path\n        this.documentPath = 'word/document.xml';\n        this.stylePath = 'word/styles.xml';\n        this.numberingPath = 'word/numbering.xml';\n        this.settingsPath = 'word/settings.xml';\n        this.headerPath = 'word/header';\n        this.footerPath = 'word/footer';\n        //private commentsPath: string = 'word/comments.xml';\n        this.imagePath = 'word/media/image';\n        // private footnotesPath: string = 'word/footnotes.xml';\n        // private endnotesPath: string = 'word/endnotes.xml';\n        this.appPath = 'docProps/app.xml';\n        this.corePath = 'docProps/core.xml';\n        // private CustomPath: string = 'docProps/custom.xml';\n        // private FontTablePath: string = 'word/fontTable.xml';\n        this.contentTypesPath = '[Content_Types].xml';\n        // private ChartsPath: string = 'word/charts/';\n        // private DefaultEmbeddingPath: string = 'word/embeddings/';\n        // private EmbeddingPath:string = 'word\\embeddings\\';\n        // private DrawingPath:string = 'word\\drawings\\';\n        // private ThemePath: string = 'word/theme/theme1.xml';\n        // private FontsPath:string = 'word\\fonts\\';\n        // private DiagramPath:string = \"word/diagrams/';\n        // private ControlPath:string = \"word/activeX/';\n        // private VbaProject: string = 'vbaProject.bin';\n        // private VbaData: string = 'vbaData.xml';\n        // private VbaProjectPath: string = 'word/vbaProject.bin';\n        // private VbaDataPath: string = 'word/vbaData.xml';\n        // private CustomXMLPath:string = 'customXml\\';\n        //Relationship path\n        this.generalRelationPath = '_rels/.rels';\n        this.wordRelationPath = 'word/_rels/document.xml.rels';\n        // private FontRelationPath: string = 'word/_rels/fontTable.xml.rels';\n        // private CommentsRelationPath: string = 'word/_rels/comments.xml.rels';\n        // private FootnotesRelationPath: string = 'word/_rels/footnotes.xml.rels';\n        // private EndnotesRelationPath: string = 'word/_rels/endnotes.xml.rels';\n        // private NumberingRelationPath: string = 'word/_rels/numbering.xml.rels';\n        this.headerRelationPath = 'word/_rels/header';\n        this.footerRelationPath = 'word/_rels/footer';\n        // private SettingsRelationpath: string = 'word/_rels/settings.xml.rels';\n        // private VbaProjectRelsPath: string = 'word/_rels/vbaProject.bin.rels';\n        //Content type of the parts\n        this.xmlContentType = 'application/xml';\n        this.fontContentType = 'application/vnd.openxmlformats-officedocument.obfuscatedFont';\n        this.documentContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml';\n        // private TemplateContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml';\n        // private CommentsContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml';\n        this.settingsContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml';\n        // private EndnoteContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml';\n        // private FontTableContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml';\n        this.footerContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml';\n        // private FootnoteContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml';\n        // private GlossaryDocumentContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document.glossary+xml';\n        this.headerContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml';\n        this.numberingContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml';\n        this.stylesContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml';\n        this.webSettingsContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml';\n        this.appContentType = 'application/vnd.openxmlformats-officedocument.extended-properties+xml';\n        this.coreContentType = 'application/vnd.openxmlformats-package.core-properties+xml';\n        this.customContentType = 'application/vnd.openxmlformats-officedocument.custom-properties+xml';\n        this.customXmlContentType = 'application/vnd.openxmlformats-officedocument.customXmlProperties+xml';\n        this.relationContentType = 'application/vnd.openxmlformats-package.relationships+xml';\n        // private DiagramColor: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml';\n        // private DiagramData: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml';\n        // private DiagramLayout: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml';\n        // private DiagramStyle: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml';\n        // private ChartsContentType: string = 'application/vnd.openxmlformats-officedocument.drawingml.chart+xml';\n        // private ThemeContentType: string = 'application/vnd.openxmlformats-officedocument.theme+xml';\n        // private ChartDrawingContentType: string = 'application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml';\n        // private ActiveXContentType: string = 'application/vnd.ms-office.activeX+xml';\n        // private ActiveXBinContentType: string = 'application/vnd.ms-office.activeX';\n        this.tableStyleContentType = 'application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml';\n        // private ChartStyleContentType: string = 'application/vnd.ms-office.chartstyle+xml';\n        // private ChartColorStyleContentType: string = 'application/vnd.ms-office.chartcolorstyle+xml';\n        // private VbaProjectContentType: string = 'application/vnd.ms-office.vbaProject';\n        // private VbaDataContentType: string = 'application/vnd.ms-word.vbaData+xml';\n        // private MacroDocumentContentType: string = 'application/vnd.ms-word.document.macroEnabled.main+xml';\n        // private MacroTemplateContentType: string = 'application/vnd.ms-word.template.macroEnabledTemplate.main+xml';\n        // private OleObjectContentType: string = 'application/vnd.openxmlformats-officedocument.oleObject';\n        // Relationship types of document parts\n        // private AltChunkRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk';\n        // private CommentsRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments';\n        this.settingsRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings';\n        // private EndnoteRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes';\n        // private FontTableRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable';\n        this.footerRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer';\n        // private FootnoteRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes';\n        this.headerRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/header';\n        this.documentRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument';\n        this.numberingRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering';\n        this.stylesRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles';\n        // private OleObjectRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/oleObject';\n        // private ChartRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart';\n        // private ThemeRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme';\n        this.fontRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/font';\n        this.tableStyleRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles';\n        this.coreRelType = 'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties';\n        this.appRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties';\n        this.customRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties';\n        this.imageRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image';\n        this.hyperlinkRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink';\n        this.controlRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/control';\n        this.packageRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/package';\n        // private VbaProjectRelType: string = 'http://schemas.microsoft.com/office/2006/relationships/vbaProject';\n        // private VbaDataRelType: string = 'http://schemas.microsoft.com/office/2006/relationships/wordVbaData';\n        this.customXmlRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml';\n        this.customUIRelType = 'http://schemas.microsoft.com/office/2006/relationships/ui/extensibility';\n        this.attachedTemplateRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate';\n        // private ChartColorStyleRelType: string = 'http://schemas.microsoft.com/office/2011/relationships/chartColorStyle';\n        // private ChartStyleRelType: string = 'http://schemas.microsoft.com/office/2011/relationships/chartStyle';\n        // private ChartUserShapesRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartUserShapes';\n        // private ChartContentType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/package';\n        // Namespaces\n        // private PKG_namespace: string = 'http://schemas.microsoft.com/office/2006/xmlPackage';\n        this.wNamespace = 'http://schemas.openxmlformats.org/wordprocessingml/2006/main';\n        this.wpNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing';\n        this.pictureNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/picture';\n        this.aNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/main';\n        this.a14Namespace = 'http://schemas.microsoft.com/office/drawing/2010/main';\n        // private SVG_namespace: string = 'http://schemas.microsoft.com/office/drawing/2016/SVG/main';\n        this.rNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships';\n        this.rpNamespace = 'http://schemas.openxmlformats.org/package/2006/relationships';\n        this.vNamespace = 'urn:schemas-microsoft-com:vml';\n        this.oNamespace = 'urn:schemas-microsoft-com:office:office';\n        this.xmlNamespace = 'http://www.w3.org/XML/1998/namespace';\n        this.w10Namespace = 'urn:schemas-microsoft-com:office:word';\n        this.cpNamespace = 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties';\n        this.dcNamespace = 'http://purl.org/dc/elements/1.1/';\n        // private DCTERMS_namespace: string = 'http://purl.org/dc/terms/';\n        // private XSI_namespace: string = 'http://www.w3.org/2001/XMLSchema-instance';\n        this.docPropsNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/extended-properties';\n        this.veNamespace = 'http://schemas.openxmlformats.org/markup-compatibility/2006';\n        this.mNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/math';\n        this.wneNamespace = 'http://schemas.microsoft.com/office/word/2006/wordml';\n        // private DCMI_namespace: string = 'http://purl.org/dc/dcmitype/';\n        this.customPropsNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/custom-properties';\n        this.vtNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes';\n        this.chartNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/chart';\n        this.slNamespace = 'http://schemas.openxmlformats.org/schemaLibrary/2006/main';\n        //2003WML namespace\n        // private amlNamespace: string = 'http://schemas.microsoft.com/aml/2001/core';\n        this.dtNamespace = 'uuid:C2F41010-65B3-11d1-A29F-00AA00C14882';\n        this.wmlNamespace = 'http://schemas.microsoft.com/office/word/2003/wordml';\n        //2010 namespaces\n        this.w14Namespace = 'http://schemas.microsoft.com/office/word/2010/wordml';\n        this.wpCanvasNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas';\n        this.wpDrawingNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing';\n        this.wpGroupNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingGroup';\n        this.wpInkNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingInk';\n        this.wpShapeNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingShape';\n        //2013 namespaces\n        this.w15Namespace = 'http://schemas.microsoft.com/office/word/2012/wordml';\n        this.diagramNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/diagram';\n        //Encryption namespaces\n        this.eNamespace = 'http://schemas.microsoft.com/office/2006/encryption';\n        this.pNamespace = 'http://schemas.microsoft.com/office/2006/keyEncryptor/password';\n        this.certNamespace = 'http://schemas.microsoft.com/office/2006/keyEncryptor/certificate';\n        // Dls xml tags\n        this.cRelationshipsTag = 'Relationships';\n        this.cRelationshipTag = 'Relationship';\n        this.cIdTag = 'Id';\n        this.cTypeTag = 'Type';\n        this.cTargetTag = 'Target';\n        this.cUserShapesTag = 'userShapes';\n        this.cExternalData = 'externalData';\n        this.twipsInOnePoint = 20;\n        this.twentiethOfPoint = 20;\n        this.borderMultiplier = 8;\n        this.percentageFactor = 50;\n        this.emusPerPoint = 12700;\n        // private const TOC_SYMBOL:string = (char)0x01;\n        // private const FOOTNOTE_SYMBOL:string = (char)0x02;\n        // private const PAGENUMBER_SYMBOL:string = (char)0xB;\n        // private DEF_FIT_TEXT_TO_SHAPE: string = 'mso-fit-shape-to-text:t';\n        // Document tags\n        this.cConditionalTableStyleTag = 'tblStylePr';\n        this.cTableFormatTag = 'tblPr';\n        this.cTowFormatTag = 'trPr';\n        this.cCellFormatTag = 'tcPr';\n        this.cParagraphFormatTag = 'pPr';\n        this.cCharacterFormatTag = 'rPr';\n        this.packageType = 'http://schemas.microsoft.com/office/2006/xmlPackage';\n        this.relsPartPath = '/_rels/.rels';\n        this.documentRelsPartPath = '/word/_rels/document.xml.rels';\n        this.webSettingsPath = '/word/webSettings.xml';\n        this.wordMLDocumentPath = '/word/document.xml';\n        this.wordMLStylePath = '/word/styles.xml';\n        this.wordMLNumberingPath = '/word/numbering.xml';\n        this.wordMLSettingsPath = '/word/settings.xml';\n        this.wordMLHeaderPath = '/word/header';\n        this.wordMLFooterPath = '/word/footer';\n        this.wordMLCommentsPath = '/word/comments.xml';\n        this.wordMLImagePath = '/word/media/image';\n        this.wordMLFootnotesPath = '/word/footnotes.xml';\n        this.wordMLEndnotesPath = '/word/endnotes.xml';\n        this.wordMLAppPath = '/docProps/app.xml';\n        this.wordMLCorePath = '/docProps/core.xml';\n        this.wordMLCustomPath = '/docProps/custom.xml';\n        this.wordMLFontTablePath = '/word/fontTable.xml';\n        this.wordMLChartsPath = '/word/charts/';\n        this.wordMLDefaultEmbeddingPath = '/word/embeddings/';\n        this.wordMLEmbeddingPath = '/word/embeddings/';\n        this.wordMLDrawingPath = '/word/drawings/';\n        this.wordMLThemePath = '/word/theme/theme1.xml';\n        this.wordMLFontsPath = '/word/fonts/';\n        this.wordMLDiagramPath = '/word/diagrams/';\n        this.wordMLControlPath = '/word/activeX/';\n        this.wordMLVbaProject = '/vbaProject.bin';\n        this.wordMLVbaData = '/vbaData.xml';\n        this.wordMLVbaProjectPath = '/word/vbaProject.bin';\n        this.wordMLVbaDataPath = '/word/vbaData.xml';\n        // private WordMLCustomXMLPath: string = '/customXml/';\n        this.wordMLWebSettingsPath = '/word/webSettings.xml';\n        this.wordMLCustomItemProp1Path = '/customXml/itemProps1.xml';\n        // private WordMLCustomXMLRelPath: string = '/customXml/_rels/item1.xml.rels';\n        this.wordMLFootnoteRelPath = '/word/_rels/footnotes.xml.rels';\n        this.wordMLEndnoteRelPath = '/word/_rels/endnotes.xml.rels';\n        this.wordMLSettingsRelPath = '/word/_rels/settings.xml.rels';\n        this.wordMLNumberingRelPath = '/word/_rels/numbering.xml.rels';\n        this.wordMLFontTableRelPath = '/word/_rels/fontTable.xml.rels';\n        this.wordMLCustomXmlPropsRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps';\n        this.wordMLControlRelType = 'http://schemas.microsoft.com/office/2006/relationships/activeXControlBinary';\n        this.wordMLDiagramContentType = 'application/vnd.ms-office.drawingml.diagramDrawing+xml';\n        this.lastSection = false;\n        this.mRelationShipID = 0;\n        this.mDocPrID = 0;\n        this.mDifferentFirstPage = false;\n        this.mBookmarks = undefined;\n        /* tslint:enable:no-any */\n    }\n    WordExport.prototype.getModuleName = function () {\n        return 'WordExport';\n    };\n    Object.defineProperty(WordExport.prototype, \"bookmarks\", {\n        // Gets the bookmark name\n        get: function () {\n            if (isNullOrUndefined(this.mBookmarks)) {\n                this.mBookmarks = [];\n            }\n            return this.mBookmarks;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"documentImages\", {\n        // Gets the collection of images present in the document body\n        get: function () {\n            if (this.mDocumentImages === undefined) {\n                this.mDocumentImages = new Dictionary();\n            }\n            return this.mDocumentImages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"externalImages\", {\n        // Gets the collection of images present in the document body\n        get: function () {\n            if (this.mExternalLinkImages === undefined) {\n                this.mExternalLinkImages = new Dictionary();\n            }\n            return this.mExternalLinkImages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"headerFooterImages\", {\n        // Gets the collections of images present in the HeaderFooters\n        get: function () {\n            if (this.mHeaderFooterImages === undefined) {\n                this.mHeaderFooterImages = new Dictionary();\n            }\n            return this.mHeaderFooterImages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"headersFooters\", {\n        /// Gets the HeaderFooter Collection\n        get: function () {\n            if (this.mHeaderFooterColl === undefined) {\n                this.mHeaderFooterColl = new Dictionary();\n            }\n            return this.mHeaderFooterColl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    WordExport.prototype.save = function (viewer, fileName) {\n        this.serialize(viewer);\n        this.mArchive.save(fileName + '.docx').then(function (mArchive) {\n            mArchive.destroy();\n        });\n        this.close();\n    };\n    /**\n     * @private\n     */\n    WordExport.prototype.saveAsBlob = function (viewer) {\n        var _this = this;\n        this.serialize(viewer);\n        return new Promise(function (resolve, reject) {\n            _this.mArchive.saveAsBlob().then(function (blob) {\n                _this.mArchive.destroy();\n                blob = new Blob([blob], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });\n                resolve(blob);\n            });\n        });\n    };\n    /**\n     * @private\n     */\n    WordExport.prototype.destroy = function () {\n        this.clearDocument();\n        this.mRelationShipID = undefined;\n        this.mDocPrID = undefined;\n        this.mDifferentFirstPage = undefined;\n        if (this.mArchive) {\n            this.mArchive.destroy();\n            this.mArchive = undefined;\n        }\n    };\n    // Saves the word document in the stream\n    WordExport.prototype.serialize = function (viewer) {\n        /* tslint:disable:no-any */\n        var document = viewer.owner.sfdtExportModule.write();\n        this.setDocument(document);\n        this.mArchive = new ZipArchive();\n        this.mArchive.compressionLevel = 'Normal';\n        this.mVerticalMerge = new Dictionary();\n        this.mGridSpans = new Dictionary();\n        var contenttype;\n        //document.xml\n        this.serializeDocument();\n        //Styles.xml\n        this.serializeStyles();\n        //numbering.xml\n        this.serializeNumberings();\n        //theme.xml\n        // if (m_document.DocHasThemes && !isNullOrUndefined(m_document.Themes))\n        //     SerializeThemes();\n        // else\n        // this.serializeDefaultThemes();\n        //settings.xml\n        this.serializeSettings();\n        //core.xml\n        this.serializeCoreProperties();\n        //app.xml\n        this.serializeAppProperties();\n        //fontTable.xml\n        this.serializeFontTable(contenttype);\n        //custom.xml\n        // if (!isNullOrUndefined(this.wordDocument.CustomDocumentProperties) && m_document.CustomDocumentProperties.length > 0) {\n        //     SerializeCustomProperties();\n        // }\n        //Settings Relations\n        this.serializeSettingsRelation();\n        //Numbering relation if the document has picture bullet\n        // if (PictureBullets.length > 0) {\n        //     SerializeNumberingsRelation();\n        // }\n        this.serializeHeaderFooters();\n        //document relations\n        this.serializeDocumentRelations();\n        // // Add controls to archieve.\n        // if (ControlsPathNames.length > 0) {\n        //     AddControlsToZip(m_document.DocxPackage);\n        // }\n        // if (!isNullOrUndefined(m_document.CustomUIPartContainer))\n        //     AddPartContainerToArchive(m_document.CustomUIPartContainer);\n        // if (!isNullOrUndefined(m_document.CustomXMLContainer))\n        //     AddPartContainerToArchive(m_document.CustomXMLContainer);\n        //general relations\n        this.serializeGeneralRelations();\n        //[ContentTypes].xml\n        this.serializeContentTypes(contenttype);\n        // Clears the internal fields maintained for serializing.\n        this.clearDocument();\n    };\n    // Sets the document\n    WordExport.prototype.setDocument = function (document) {\n        this.document = document;\n        this.mSections = document.sections;\n        this.mLists = document.lists;\n        this.mAbstractLists = document.abstractLists;\n        this.defCharacterFormat = document.characterFormat;\n        this.defParagraphFormat = document.paragraphFormat;\n        this.defaultTabWidthValue = document.defaultTabWidth;\n        this.mStyles = document.styles;\n    };\n    // Clears the document\n    WordExport.prototype.clearDocument = function () {\n        // Owner Nodes\n        this.section = undefined;\n        this.lastSection = undefined;\n        this.blockOwner = undefined;\n        this.paragraph = undefined;\n        this.table = undefined;\n        this.row = undefined;\n        this.headerFooter = undefined;\n        this.document = undefined;\n        this.mSections = undefined;\n        this.mLists = undefined;\n        this.mAbstractLists = undefined;\n        this.defCharacterFormat = undefined;\n        this.defParagraphFormat = undefined;\n        this.defaultTabWidthValue = undefined;\n        this.mRelationShipID = 0;\n        this.mDocPrID = 0;\n        this.mDifferentFirstPage = false;\n        if (this.mHeaderFooterColl) {\n            this.mHeaderFooterColl.destroy();\n            this.mHeaderFooterColl = undefined;\n        }\n        if (this.mVerticalMerge) {\n            this.mVerticalMerge.destroy();\n            this.mVerticalMerge = undefined;\n        }\n        if (this.mGridSpans) {\n            this.mGridSpans.destroy();\n            this.mGridSpans = undefined;\n        }\n        if (this.mDocumentImages) {\n            this.mDocumentImages.destroy();\n            this.mDocumentImages = undefined;\n        }\n        if (this.mExternalLinkImages) {\n            this.mExternalLinkImages.destroy();\n            this.mExternalLinkImages = undefined;\n        }\n        if (this.mHeaderFooterImages) {\n            this.mHeaderFooterImages.destroy();\n            this.mHeaderFooterImages = undefined;\n        }\n    };\n    // Serializes the document elements (document.xml)\n    WordExport.prototype.serializeDocument = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'document', this.wNamespace);\n        this.writeCommonAttributeStrings(writer);\n        this.serializeDocumentBody(writer);\n        writer.writeEndElement(); //end of document tag\n        var archiveItem = new ZipArchiveItem(writer.buffer, this.documentPath);\n        this.mArchive.addItem(archiveItem);\n    };\n    WordExport.prototype.writeCommonAttributeStrings = function (writer) {\n        writer.writeAttributeString('xmlns', 'wpc', undefined, this.wpCanvasNamespace);\n        this.writeCustom(writer);\n        writer.writeAttributeString('xmlns', 'wp14', undefined, this.wpDrawingNamespace);\n        writer.writeAttributeString('xmlns', 'wp', undefined, this.wpNamespace);\n        writer.writeAttributeString('xmlns', 'w10', undefined, this.w10Namespace);\n        writer.writeAttributeString('xmlns', 'w', undefined, this.wNamespace);\n        this.writeDup(writer);\n        writer.writeAttributeString('xmlns', 'wne', undefined, this.wneNamespace);\n        writer.writeAttributeString('xmlns', 'wps', undefined, this.wpShapeNamespace);\n        writer.writeAttributeString('mc', 'Ignorable', undefined, 'w14 w15 wp14');\n    };\n    WordExport.prototype.writeDup = function (writer) {\n        writer.writeAttributeString('xmlns', 'w14', undefined, this.w14Namespace);\n        writer.writeAttributeString('xmlns', 'w15', undefined, this.w15Namespace);\n        writer.writeAttributeString('xmlns', 'wpg', undefined, this.wpGroupNamespace);\n        writer.writeAttributeString('xmlns', 'wpi', undefined, this.wpInkNamespace);\n    };\n    WordExport.prototype.writeCustom = function (writer) {\n        writer.writeAttributeString('xmlns', 'mc', undefined, this.veNamespace);\n        writer.writeAttributeString('xmlns', 'o', undefined, this.oNamespace);\n        writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        writer.writeAttributeString('xmlns', 'm', undefined, this.mNamespace);\n        writer.writeAttributeString('xmlns', 'v', undefined, this.vNamespace);\n    };\n    // Serializes the document body\n    WordExport.prototype.serializeDocumentBody = function (writer) {\n        writer.writeStartElement(undefined, 'body', this.wNamespace);\n        var count = this.document.sections.length;\n        for (var i = 0; i < count; i++) {\n            this.section = this.document.sections[i];\n            this.lastSection = i === count - 1;\n            this.serializeSection(writer, this.section, i === count - 1);\n            this.section = undefined;\n        }\n        writer.writeEndElement();\n    };\n    // Serializes the Section.\n    WordExport.prototype.serializeSection = function (writer, section, last) {\n        this.blockOwner = section;\n        this.serializeBodyItems(writer, section.blocks, last);\n        if (last) {\n            this.serializeSectionProperties(writer, section);\n        }\n        this.blockOwner = undefined;\n    };\n    // Serialize the section properties.\n    WordExport.prototype.serializeSectionProperties = function (writer, section) {\n        writer.writeStartElement('w', 'sectPr', this.wNamespace);\n        if (section.headersFooters) {\n            this.serializeHFReference(writer, section.headersFooters);\n        }\n        // if (IsNeedToSerializeSectionFootNoteProperties(section))\n        //     SerializeFootnoteProperties(section);\n        // if (IsNeedToSerializeSectionEndNoteProperties(section))\n        //     SerializeEndnoteProperties(section);      \n        this.serializeSectionType(writer, 'nextPage');\n        this.serializePageSetup(writer, section.sectionFormat);\n        this.serializeColumns(writer, section);\n        // this.serializeSectionProtection(section);\n        // if (section.PageSetup.VerticalAlignment !== PageAlignment.Top) {\n        //     writer.writeStartElement('vAlign', this.wNamespace);\n        //     switch (section.PageSetup.VerticalAlignment) {\n        //         case PageAlignment.Top:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'top');\n        //             break;\n        //         case PageAlignment.Middle:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'center');\n        //             break;\n        //         case PageAlignment.Justified:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'both');\n        //             break;\n        //         case PageAlignment.Bottom:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'bottom');\n        //             break;\n        //     }\n        //     writer.WriteEndElement();\n        // }\n        if (section.sectionFormat !== undefined && section.sectionFormat.differentFirstPage) {\n            writer.writeStartElement(undefined, 'titlePg', this.wNamespace);\n            writer.writeEndElement();\n        }\n        // SerializeTextDirection(section);\n        if (!isNullOrUndefined(section.sectionFormat) && section.sectionFormat.bidi) {\n            writer.writeStartElement(undefined, 'bidi', this.wNamespace);\n            writer.writeEndElement();\n        }\n        //rtlGutter\n        // SerializeDocGrid(section);\n        //printerSettings\n        writer.writeEndElement(); //end of sectPr tag\n    };\n    // Serialize the column properties of section.\n    WordExport.prototype.serializeColumns = function (writer, section) {\n        writer.writeStartElement(undefined, 'cols', this.wNamespace);\n        writer.writeAttributeString(undefined, 'equalWidth', this.wNamespace, '1');\n        writer.writeAttributeString(undefined, 'space', this.wNamespace, '0');\n        writer.writeEndElement();\n        // ColumnCollection columns = section.Columns;\n        // writer.WriteStartElement('cols', this.wNamespace);\n        // if (columns.length > 0)\n        // {\n        //     writer.WriteAttributeString('num', this.wNamespace, columns.length.ToString());\n        // }\n        // if (section.PageSetup.DrawLinesBetweenCols)\n        //     writer.WriteAttributeString('sep', this.wNamespace, '1');\n        // if (columns.OwnerSection.PageSetup.EqualColumnWidth)\n        // {\n        //     writer.WriteAttributeString('equalWidth', this.wNamespace, '1');\n        //     //When the column count is negative, MS word just reset the column's count to zero\n        //     //To avoid index out of exception, checked the columns count\n        // tslint:disable-next-line:max-line-length\n        //     writer.WriteAttributeString('space', this.wNamespace, ToString(columns.length > 0 ? columns[0].Space * this.TwentiethOfPoint : 0));\n        // }\n        // else if (columns.length > 0)\n        // {\n        //     writer.WriteAttributeString('equalWidth', this.wNamespace, '0');\n        //     foreach (Column column in columns)\n        //     {\n        //         writer.WriteStartElement('col', this.wNamespace);\n        //         writer.WriteAttributeString('w', this.wNamespace, ToString(column.Width * this.TwentiethOfPoint));\n        // tslint:disable-next-line:max-line-length\n        //         writer.WriteAttributeString('space', this.wNamespace, ToString(column.Space * this.TwentiethOfPoint));\n        //         writer.WriteEndElement();\n        //     }\n        // }\n        // writer.WriteEndElement();\n    };\n    // Serialize the page setup properties.\n    WordExport.prototype.serializePageSetup = function (writer, pageSetup) {\n        if (pageSetup !== undefined) {\n            this.serializePageSize(writer, pageSetup);\n            this.serializePageMargins(writer, pageSetup);\n        }\n        // // StartElement paperSrc (if any)\n        // if (pageSetup.FirstPageTray > 0 || pageSetup.OtherPagesTray > 0) {\n        //     writer.WriteStartElement('paperSrc', this.wNamespace);\n        //     if (pageSetup.FirstPageTray > 0) {\n        //         writer.WriteAttributeString('first', this.wNamespace, pageSetup.FirstPageTray.ToString());\n        //     }\n        //     if (pageSetup.OtherPagesTray > 0) {\n        //         writer.WriteAttributeString('other', this.wNamespace, pageSetup.OtherPagesTray.ToString());\n        //     }\n        //     writer.WriteEndElement();\n        // }\n        writer.writeStartElement(undefined, 'pgBorders', this.wNamespace);\n        // //zOrder\n        // if (pageSetup.PageBordersApplyType === PageBordersApplyType.FirstPage)\n        //     writer.WriteAttributeString('display', this.wNamespace, 'firstPage');\n        // else if (pageSetup.PageBordersApplyType === PageBordersApplyType.AllExceptFirstPage)\n        //     writer.WriteAttributeString('display', this.wNamespace, 'notFirstPage');\n        // if (pageSetup.PageBorderOffsetFrom === PageBorderOffsetFrom.PageEdge) {\n        //     writer.WriteAttributeString('offsetFrom', this.wNamespace, 'page');\n        // }\n        // //Serializing zOrder of the front page border\n        // if (!pageSetup.IsFrontPageBorder) {\n        //     writer.WriteAttributeString('zOrder', this.wNamespace, 'back');\n        // }\n        // SerializePageBorders(pageSetup.Borders);\n        writer.writeEndElement();\n        // this.serializeLineNumberType(writer, pageSetup);\n        //this.serializePageNumberType(writer, pageSetup);\n    };\n    // serialize the page size\n    WordExport.prototype.serializePageSize = function (writer, pageSetup) {\n        writer.writeStartElement(undefined, 'pgSz', this.wNamespace);\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(pageSetup.pageWidth * this.twentiethOfPoint).toString());\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'h', this.wNamespace, this.roundToTwoDecimal(pageSetup.pageHeight * this.twentiethOfPoint).toString());\n        // if (pageSetup.Orientation === PageOrientation.Landscape)\n        // {\n        //     writer.WriteAttributeString('orient', this.wNamespace, 'landscape');\n        // }\n        writer.writeEndElement();\n    };\n    // Serialize the border.\n    WordExport.prototype.serializePageMargins = function (writer, pageSetup) {\n        writer.writeStartElement(undefined, 'pgMar', this.wNamespace);\n        var marginValue = Math.round(pageSetup.topMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'top', this.wNamespace, marginValue.toString());\n        marginValue = Math.round(pageSetup.rightMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'right', this.wNamespace, marginValue.toString());\n        marginValue = Math.round(pageSetup.bottomMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'bottom', this.wNamespace, marginValue.toString());\n        marginValue = Math.round(pageSetup.leftMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'left', this.wNamespace, marginValue.toString());\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'header', this.wNamespace, this.roundToTwoDecimal(pageSetup.headerDistance * this.twentiethOfPoint).toString());\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'footer', this.wNamespace, this.roundToTwoDecimal(pageSetup.footerDistance * this.twentiethOfPoint).toString());\n        writer.writeAttributeString(undefined, 'gutter', this.wNamespace, '0');\n        writer.writeEndElement();\n    };\n    // Serialize the section type.\n    WordExport.prototype.serializeSectionType = function (writer, sectionBreakCode) {\n        writer.writeStartElement('w', 'type', this.wNamespace);\n        writer.writeAttributeString('w', 'val', this.wNamespace, sectionBreakCode); //GetSectionBreakCode(sectionBreakCode));\n        writer.writeEndElement();\n    };\n    // Serialize the heeader/footer reference.\n    WordExport.prototype.serializeHFReference = function (writer, headersFooters) {\n        var hfId = '';\n        if (headersFooters !== undefined) {\n            this.mDifferentFirstPage = this.section.sectionFormat.differentOddAndEvenPages;\n            var hf = headersFooters.firstPageHeader;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'headerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'first');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'FirstPageHeader', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.firstPageFooter;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'footerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'first');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'FirstPageFooter', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.evenHeader;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'headerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'even');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'EvenHeader', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.evenFooter;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'footerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'even');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'EvenFooter', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.header;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'headerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'default');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'OddHeader', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.footer;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'footerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'default');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'OddFooter', hfId);\n                writer.writeEndElement();\n            }\n        }\n    };\n    // Adds the header footer details to the collection.\n    WordExport.prototype.addHeaderFooter = function (hf, hfType, id) {\n        var hfColl = new Dictionary();\n        this.headersFooters.add(hfType, hfColl);\n        this.headersFooters.get(hfType).add(id, hf);\n    };\n    // Serializes the bodyItems\n    WordExport.prototype.serializeBodyItems = function (writer, blockCollection, isLastSection) {\n        for (var i = 0; i < blockCollection.length; i++) {\n            this.serializeBodyItem(writer, blockCollection[i], isLastSection);\n        }\n    };\n    // Serialize the TextBody item\n    WordExport.prototype.serializeBodyItem = function (writer, item, isLastSection) {\n        if (isNullOrUndefined(item)) {\n            throw new Error('BodyItem should not be undefined');\n        }\n        if (item.hasOwnProperty('inlines')) {\n            this.paragraph = item;\n            this.serializeParagraph(writer, item, isLastSection);\n            this.paragraph = undefined;\n        }\n        else {\n            var table = item;\n            for (var i = 0; i < table.rows.length; i++) {\n                if (table.rows[i].cells.length > 0) {\n                    this.serializeTable(writer, table);\n                    break;\n                }\n            }\n        }\n    };\n    // Serialize the paragraph\n    WordExport.prototype.serializeParagraph = function (writer, paragraph, isLastSection) {\n        if (isNullOrUndefined(paragraph)) {\n            throw new Error('Paragraph should not be undefined');\n        }\n        var sec = this.blockOwner;\n        //Need to write the Section Properties if the Paragraph is last item in the section\n        if (!isLastSection && sec.hasOwnProperty('sectionFormat')\n            && sec.blocks.indexOf(paragraph) === sec.blocks.length - 1) {\n            writer.writeStartElement('w', 'p', this.wNamespace);\n            writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n            this.serializeSectionProperties(writer, sec);\n            writer.writeEndElement();\n            writer.writeEndElement();\n        }\n        // if (paragraph.ParagraphFormat.PageBreakAfter && !IsPageBreakNeedToBeSkipped(paragraph as Entity))\n        //     paragraph.InsertBreak(BreakType.PageBreak);\n        // if (paragraph.ParagraphFormat.ColumnBreakAfter && !IsPageBreakNeedToBeSkipped(paragraph as Entity))\n        //     paragraph.InsertBreak(BreakType.ColumnBreak);\n        //Splits the paragraph based on the newline character\n        // paragraph.SplitTextRange();\n        writer.writeStartElement('w', 'p', this.wNamespace);\n        writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n        this.serializeParagraphFormat(writer, paragraph.paragraphFormat, paragraph);\n        writer.writeEndElement(); //end of pPr\n        // Serialize watermark if paragraph is the first item of Header document.\n        // EnsureWatermark(paragraph);\n        this.serializeParagraphItems(writer, paragraph.inlines);\n        writer.writeEndElement(); //end of paragraph tag.\n    };\n    // Serialize the paragraph items\n    WordExport.prototype.serializeParagraphItems = function (writer, paraItems) {\n        var previousNode = undefined;\n        var isContinueOverride = false;\n        for (var i = 0; i < paraItems.length; i++) {\n            var item = paraItems[i];\n            var isBdo = false;\n            if (item.characterFormat) {\n                isBdo = !isNullOrUndefined(item.characterFormat.bdo) && item.characterFormat.bdo !== 'None';\n                if (isBdo && !isContinueOverride) {\n                    this.serializeBiDirectionalOverride(writer, item.characterFormat);\n                    isContinueOverride = true;\n                }\n            }\n            if (isContinueOverride && !isBdo) {\n                writer.writeEndElement();\n                isContinueOverride = false;\n            }\n            if (item.hasOwnProperty('fieldType')) {\n                this.serializeFieldCharacter(writer, item);\n            }\n            else if (item.hasOwnProperty('imageString')) {\n                this.serializePicture(writer, item);\n            }\n            else if (item.hasOwnProperty('bookmarkType')) {\n                this.serializeBookMark(writer, item);\n            }\n            else {\n                this.serializeTextRange(writer, item, previousNode);\n            }\n            previousNode = item;\n        }\n        if (isContinueOverride) {\n            writer.writeEndElement();\n        }\n    };\n    WordExport.prototype.serializeBiDirectionalOverride = function (writer, characterFormat) {\n        writer.writeStartElement(undefined, 'bdo', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, characterFormat.bdo.toLowerCase());\n    };\n    // Serialize the book mark\n    WordExport.prototype.serializeBookMark = function (writer, bookmark) {\n        var bookmarkId = this.getBookmarkId(bookmark.name);\n        var bookmarkName = bookmark.name;\n        if (bookmark.bookmarkType === 0) {\n            writer.writeStartElement('w', 'bookmarkStart', this.wNamespace);\n            writer.writeAttributeString('w', 'name', this.wNamespace, bookmarkName);\n        }\n        else if (bookmark.bookmarkType === 1) {\n            writer.writeStartElement('w', 'bookmarkEnd', this.wNamespace);\n        }\n        writer.writeAttributeString('w', 'id', this.wNamespace, bookmarkId.toString());\n        writer.writeEndElement();\n    };\n    WordExport.prototype.getBookmarkId = function (name) {\n        var index = this.bookmarks.indexOf(name);\n        if (index < 0) {\n            index = this.bookmarks.length;\n            this.bookmarks.push(name);\n        }\n        return index;\n    };\n    // Serialize the picture.\n    WordExport.prototype.serializePicture = function (writer, image) {\n        if (image.width >= 0 && image.height >= 0) {\n            writer.writeStartElement(undefined, 'r', this.wNamespace);\n            this.serializeCharacterFormat(writer, image.characterFormat);\n            this.serializeDrawing(writer, image);\n            writer.writeEndElement(); //end of run element\n        }\n    };\n    // Serialize the drawing element.\n    WordExport.prototype.serializeDrawing = function (writer, image) {\n        writer.writeStartElement(undefined, 'drawing', this.wNamespace);\n        this.serializeInlinePicture(writer, image);\n        writer.writeEndElement();\n    };\n    // Serialize the inline picture.\n    WordExport.prototype.serializeInlinePicture = function (writer, image) {\n        writer.writeStartElement(undefined, 'inline', this.wpNamespace);\n        writer.writeStartElement(undefined, 'extent', this.wpNamespace);\n        var cx = Math.round(image.width * this.emusPerPoint);\n        writer.writeAttributeString(undefined, 'cx', undefined, cx.toString());\n        var cy = Math.round(image.height * this.emusPerPoint);\n        writer.writeAttributeString(undefined, 'cy', undefined, cy.toString());\n        writer.writeEndElement();\n        // double borderWidth = (double)picture.PictureShape.PictureDescriptor.BorderLeft.LineWidth / DLSConstants.BorderLineFactor;\n        // if (borderWidth > 0 && picture.DocxProps.length === 0) {\n        //     long leftTop = 0, rightBottom = 0;\n        //     picture.PictureShape.GetEffectExtent(borderWidth, ref leftTop, ref rightBottom);\n        //     m_writer.WriteStartElement('effectExtent', WP_namespace);\n        //     m_writer.WriteAttributeString('l', leftTop.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteAttributeString('t', leftTop.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteAttributeString('r', rightBottom.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteAttributeString('b', rightBottom.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteEndElement();\n        // }\n        //this.serializePicProperties(writer, image);\n        this.serializeDrawingGraphics(writer, image);\n        writer.writeEndElement();\n    };\n    WordExport.prototype.startsWith = function (sourceString, startString) {\n        return startString.length > 0 && sourceString.substring(0, startString.length) === startString;\n    };\n    // Serialize the graphics element for pictures.\n    WordExport.prototype.serializeDrawingGraphics = function (writer, picture) {\n        var id = '';\n        id = this.updateShapeId(picture);\n        // picture.ShapeId = this.getNextDocPrID();\n        // Processing picture\n        writer.writeStartElement('wp', 'docPr', this.wpNamespace);\n        writer.writeAttributeString(undefined, 'id', undefined, (this.mDocPrID++).toString());\n        // if (!isNullOrUndefined(picture.AlternativeText))\n        //     m_writer.WriteAttributeString('descr', picture.AlternativeText);\n        writer.writeAttributeString(undefined, 'name', undefined, '1'.toString());\n        // if (!string.IsNullOrEmpty(picture.Title))\n        //     m_writer.WriteAttributeString('title', picture.Title);\n        // else\n        writer.writeAttributeString(undefined, 'title', undefined, '');\n        // if (!picture.Visible)\n        //     m_writer.WriteAttributeString('hidden', '1');\n        // SerializePictureHyperlink(picture);\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'graphic', this.aNamespace);\n        writer.writeStartElement('a', 'graphicData', this.aNamespace);\n        writer.writeAttributeString(undefined, 'uri', undefined, this.pictureNamespace);\n        writer.writeStartElement('pic', 'pic', this.pictureNamespace);\n        writer.writeStartElement('pic', 'nvPicPr', this.pictureNamespace);\n        writer.writeStartElement('pic', 'cNvPr', this.pictureNamespace);\n        writer.writeAttributeString(undefined, 'id', undefined, '0');\n        writer.writeAttributeString(undefined, 'name', undefined, '');\n        writer.writeAttributeString(undefined, 'descr', undefined, '');\n        writer.writeEndElement();\n        writer.writeStartElement('pic', 'cNvPicPr', this.pictureNamespace);\n        writer.writeStartElement('a', 'picLocks', this.aNamespace);\n        writer.writeAttributeString(undefined, 'noChangeAspect', undefined, '1');\n        writer.writeAttributeString(undefined, 'noChangeArrowheads', undefined, '1');\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeStartElement('pic', 'blipFill', this.pictureNamespace);\n        writer.writeStartElement('a', 'blip', this.aNamespace);\n        if (this.startsWith(picture.imageString, 'data:image')) {\n            writer.writeAttributeString('r', 'embed', this.rNamespace, id);\n        }\n        else {\n            if (this.documentImages.containsKey(id)) {\n                //Remove the image document images collection for this particular key\n                //If the picture image data has href means MS Word contains the image in media folder as well as \n                //it is having external relationship id\n                // if (!this.startsWith(picture.imageString, 'data:image')) {\n                this.documentImages.remove(id);\n                this.externalImages.add(id, picture.imageString);\n                writer.writeAttributeString(undefined, 'link', this.rNamespace, id);\n            }\n        }\n        //End Element Blip\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'srcRect', this.aNamespace);\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'stretch', this.aNamespace);\n        writer.writeStartElement('a', 'fillRect', this.aNamespace);\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeStartElement('pic', 'spPr', this.pictureNamespace);\n        writer.writeAttributeString(undefined, 'bwMode', undefined, 'auto');\n        writer.writeStartElement('a', 'xfrm', this.aNamespace);\n        // if (picture.Rotation !== 0)\n        //     m_writer.WriteAttributeString('rot', picture.Rotation.ToString());\n        writer.writeStartElement('a', 'off', this.aNamespace);\n        writer.writeAttributeString(undefined, 'x', undefined, '0');\n        writer.writeAttributeString(undefined, 'y', undefined, '0');\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'ext', this.aNamespace);\n        var cx = Math.round((picture.width * this.emusPerPoint));\n        writer.writeAttributeString(undefined, 'cx', undefined, cx.toString());\n        var cy = Math.round((picture.height * this.emusPerPoint));\n        writer.writeAttributeString(undefined, 'cy', undefined, cy.toString());\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'prstGeom', this.aNamespace);\n        writer.writeAttributeString(undefined, 'prst', undefined, 'rect');\n        writer.writeStartElement('a', 'avLst', this.aNamespace);\n        writer.writeEndElement();\n        writer.writeEndElement();\n        //When the picture border has been added next to effect list\n        //if not, Picture border has not been preserved\n        // if (picture.HasBorder)\n        // {\n        //     if (picture.TextWrappingStyle === TextWrappingStyle.Inline && picture.IsShape)\n        //         SerializeInlineShapeLine(picture.PictureShape);\n        //     else\n        //         SerializeShapeLine(picture.PictureShape);\n        // }\n        // if (picture.DocxProps.length > 0)\n        //     SerializeDocxProps(picture.DocxProps, 'effectLst');\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n    };\n    /// Update the shape id.\n    WordExport.prototype.updateShapeId = function (picture) {\n        var id = '';\n        var tOwner = this.paragraph;\n        // Adding picture byte data to the corresponding picture collection \n        // depending on its owner subdocument\n        if (this.headerFooter) {\n            id = this.updateHFImageRels(this.headerFooter, picture);\n        }\n        else {\n            if (id === '') {\n                if (tOwner.hasOwnProperty('sectionFormat') || tOwner.hasOwnProperty('inlines')) {\n                    id = this.addImageRelation(this.documentImages, picture);\n                    // if (owner is WFootnote)\n                    // {\n                    //     if ((owner as WFootnote).FootnoteType === FootnoteType.Footnote)\n                    //         id = AddImageRelation(FootnoteImages, picture.ImageRecord);\n                    //     else\n                    //         id = AddImageRelation(EndnoteImages, picture.ImageRecord);\n                    // }\n                    // if (owner is WComment)\n                    //     id = AddImageRelation(CommentImages, picture.ImageRecord);\n                }\n            }\n        }\n        return id;\n    };\n    // Adds the image relation.\n    WordExport.prototype.addImageRelation = function (imageCollection, image) {\n        var relationId = '';\n        // if (imageCollection.ContainsValue(imageRecord)) {\n        //     foreach(string key in imageCollection.keys)\n        //     {\n        //         if (imageRecord === imageCollection[key]) {\n        //             relationId = key;\n        //             break;\n        //         }\n        //     }\n        // }\n        // else {\n        relationId = this.getNextRelationShipID();\n        imageCollection.add(relationId, image);\n        // }\n        return relationId;\n    };\n    // Update the HeaderFooter image relations.\n    WordExport.prototype.updateHFImageRels = function (hf, image) {\n        var id = '';\n        // UpdateImages(image);\n        var headerId = '';\n        var types = this.headersFooters.keys;\n        for (var i = 0; i < types.length; i++) {\n            var hfColl = this.headersFooters.get(types[i]);\n            var hfKeys = hfColl.keys;\n            for (var j = 0; j < hfKeys.length; j++) {\n                if (hfColl.get(hfKeys[j]) === hf) {\n                    headerId = hfKeys[j];\n                    var headerImages = void 0;\n                    if (this.headerFooterImages.containsKey(headerId)) {\n                        headerImages = this.headerFooterImages.get(headerId);\n                        id = this.addImageRelation(headerImages, image);\n                    }\n                    else {\n                        headerImages = new Dictionary();\n                        id = this.addImageRelation(headerImages, image);\n                        this.headerFooterImages.add(headerId, headerImages);\n                    }\n                }\n            }\n        }\n        return id;\n    };\n    // Serialize the table\n    WordExport.prototype.serializeTable = function (writer, table) {\n        if (table.rows.length <= 0) {\n            return;\n        }\n        var owner = this.table;\n        this.table = table;\n        writer.writeStartElement(undefined, 'tbl', this.wNamespace);\n        var tableFormat = table.rows[0].rowFormat;\n        this.serializeTableFormat(writer, tableFormat, table);\n        this.serializeTableGrid(writer, table);\n        this.serializeTableRows(writer, table.rows);\n        writer.writeEndElement();\n        this.table = owner;\n    };\n    // Serialize the table grid\n    WordExport.prototype.serializeTableGrid = function (writer, table) {\n        writer.writeStartElement(undefined, 'tblGrid', this.wNamespace);\n        if (table.grid.length !== 0) {\n            this.serializeGridColumns(writer, table.grid);\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the table rows\n    WordExport.prototype.serializeTableRows = function (writer, rows) {\n        if (rows.length > 0) {\n            for (var i = 0; i < rows.length; i++) {\n                var row = rows[i];\n                if (row.cells.length > 0) {\n                    this.serializeRow(writer, row);\n                }\n            }\n        }\n    };\n    // Serialize the table row\n    WordExport.prototype.serializeRow = function (writer, row) {\n        var owner = this.row;\n        this.row = row;\n        writer.writeStartElement(undefined, 'tr', this.wNamespace);\n        this.serializeRowFormat(writer, row);\n        this.serializeCells(writer, row.cells);\n        writer.writeEndElement(); //end od table row 'tr'\n        this.row = owner;\n    };\n    // Serialize the row format\n    WordExport.prototype.serializeRowFormat = function (writer, row) {\n        writer.writeStartElement(undefined, 'trPr', this.wNamespace);\n        //Serialize Row Height\n        if (row.rowFormat.height > 0) {\n            writer.writeStartElement(undefined, 'trHeight', this.wNamespace);\n            if (row.rowFormat.heightType === 'Exactly') {\n                writer.writeAttributeString('w', 'hRule', this.wNamespace, 'exact');\n            }\n            else if (row.rowFormat.heightType === 'AtLeast') {\n                writer.writeAttributeString('w', 'hRule', this.wNamespace, 'atLeast');\n            }\n            var height = this.roundToTwoDecimal(row.rowFormat.height * this.twentiethOfPoint).toString();\n            writer.writeAttributeString('w', 'val', this.wNamespace, height);\n            writer.writeEndElement();\n        }\n        var rowFormat = row.rowFormat;\n        // //Serialize 'gridBefore' element\n        var gridBefore = rowFormat.gridBefore;\n        if (gridBefore > 0) {\n            writer.writeStartElement(undefined, 'gridBefore', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, gridBefore.toString());\n            writer.writeEndElement();\n        }\n        // //Serialize 'gridAfter' element\n        var gridAfter = rowFormat.gridAfter;\n        if (gridAfter > 0) {\n            writer.writeStartElement(undefined, 'gridAfter', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, gridAfter.toString());\n            writer.writeEndElement();\n        }\n        // //Serialize 'wBefore' element \n        if (gridBefore > 0) {\n            writer.writeStartElement(undefined, 'wBefore', this.wNamespace);\n            switch (rowFormat.gridBeforeWidthType) {\n                case 'Percent':\n                    var width = this.roundToTwoDecimal(rowFormat.gridBeforeWidth * this.percentageFactor).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, width);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'pct');\n                    break;\n                case 'Point':\n                    var pointWidth = this.roundToTwoDecimal(rowFormat.gridBeforeWidth * this.twipsInOnePoint).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, pointWidth);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'dxa');\n                    break;\n            }\n            writer.writeEndElement();\n        }\n        //Serialize 'wAfter' element\n        if (gridAfter > 0) {\n            writer.writeStartElement(undefined, 'wAfter', this.wNamespace);\n            switch (rowFormat.gridAfterWidthType) {\n                case 'Percent':\n                    var width = this.roundToTwoDecimal(rowFormat.gridAfterWidth * this.percentageFactor).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, width);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'pct');\n                    break;\n                case 'Point':\n                    var pointWidth = this.roundToTwoDecimal(rowFormat.gridAfterWidth * this.twipsInOnePoint).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, pointWidth);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'dxa');\n                    break;\n            }\n            writer.writeEndElement();\n        }\n        //Serialize 'cantSplit' element \n        if (!rowFormat.allowBreakAcrossPages) {\n            writer.writeStartElement(undefined, 'cantSplit', this.wNamespace);\n            writer.writeEndElement();\n        }\n        // //Serialize 'tblHeader' element \n        if (rowFormat.isHeader) {\n            writer.writeStartElement(undefined, 'tblHeader', this.wNamespace);\n            writer.writeEndElement();\n        }\n        writer.writeEndElement();\n    };\n    // serialize the table cells\n    WordExport.prototype.serializeCells = function (writer, cells) {\n        for (var i = 0; i < cells.length; i++) {\n            this.serializeCell(writer, cells[i]);\n        }\n    };\n    // Serialize the table cell\n    WordExport.prototype.serializeCell = function (writer, cell) {\n        var owner = this.blockOwner;\n        this.blockOwner = cell;\n        writer.writeStartElement(undefined, 'tc', this.wNamespace);\n        this.serializeCellFormat(writer, cell.cellFormat);\n        if (cell.blocks.length > 0) {\n            var itemIndex = 0;\n            var item = undefined;\n            while (itemIndex < cell.blocks.length) {\n                item = cell.blocks[itemIndex];\n                this.serializeBodyItem(writer, item, false);\n                itemIndex += 1;\n            }\n        }\n        else {\n            writer.writeStartElement(undefined, 'p', this.wNamespace);\n            writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n            writer.writeStartElement(undefined, 'pStyle', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'Normal');\n            writer.writeEndElement(); //end of pStyle\n            writer.writeEndElement(); //end of pPr\n            writer.writeEndElement(); //end of P\n        }\n        writer.writeEndElement(); //end of table cell 'tc'        \n        this.blockOwner = owner;\n    };\n    // Serialize the cell formatting\n    WordExport.prototype.serializeCellFormat = function (writer, cellFormat) {\n        var cell = this.blockOwner;\n        //Get the table fomat\n        var tf = this.table.tableFormat;\n        //Get the row format\n        var rf = this.row.rowFormat;\n        writer.writeStartElement(undefined, 'tcPr', this.wNamespace);\n        //w:cnfStyle -   Table Cell Conditional Formatting\n        // SerializeCnfStyleElement(cell);\n        //w:tcW -    Preferred Table Cell Width\n        this.serializeCellWidth(writer, cell);\n        //w:hMerge -    Horizontally Merged Cell and w:vMerge -    Vertically Merged Cell\n        this.serializeCellMerge(writer, cellFormat);\n        //w:gridSpan -   Grid Columns Spanned by Current Table Cell\n        this.serializeGridSpan(writer, cell);\n        //w:tcBorders -    Table Cell Borders\n        writer.writeStartElement(undefined, 'tcBorders', this.wNamespace);\n        this.serializeBorders(writer, cellFormat.borders, 8);\n        writer.writeEndElement();\n        //w:shd -  Table Cell Shading\n        this.serializeShading(writer, cell.cellFormat.shading);\n        // //w:noWrap -   Don't Wrap Cell Content\n        // if (cellFormat.HasValue(CellFormat.TextWrapKey)) {\n        //     m_writer.WriteStartElement('noWrap', W_namespace);\n        //     if (cellFormat.TextWrap)\n        //         m_writer.WriteAttributeString('w', 'val', W_namespace, 'false');\n        //     m_writer.WriteEndElement();\n        // }\n        // //w:tcMar -  Single Table Cell Margins\n        // if (!cellFormat.SamePaddingsAsTable) {\n        //     m_writer.WriteStartElement('tcMar', W_namespace);\n        //     SerializePaddings(cellFormat.Paddings);\n        //     m_writer.WriteEndElement();\n        // }\n        //w:textDirection -   Table Cell Text Flow Direction\n        this.serializeTableCellDirection(writer, cellFormat);\n        // //w:tcFitText -  Fit Text Within Cell\n        // if (cellFormat.FitText) {\n        //     m_writer.WriteStartElement('tcFitText', W_namespace);\n        //     m_writer.WriteEndElement();\n        // }\n        // //w:hideMark \n        // if (cellFormat.HideMark) {\n        //     m_writer.WriteStartElement('hideMark', W_namespace);\n        //     m_writer.WriteEndElement();\n        // }\n        //w:vAlign -  Table Cell Vertical Alignment\n        // if (cellFormat.HasValue(CellFormat.VrAlignmentKey))\n        this.serializeCellVerticalAlign(writer, cellFormat.verticalAlignment);\n        // //w:hideMark -   Ignore End Of Cell Marker In Row Height Calculation\n        // SerializeDocxProps(tempDocxProps, 'hideMark');\n        // //w:cellIns -    Table Cell Insertion\n        // SerializeDocxProps(tempDocxProps, 'cellIns');\n        // //w:cellDel -    Table Cell Deletion\n        // SerializeDocxProps(tempDocxProps, 'cellDel');\n        // //w:cellMerge -   Vertically Merged/Split Table Cells\n        // SerializeDocxProps(tempDocxProps, 'cellMerge');\n        // if (cellFormat.OldPropertiesHash.length > 0 && !m_isAlternativeCellFormat) {\n        //     m_isAlternativeCellFormat = true;\n        //     SerializeTrackChangeProps('tcPrChange', cellFormat.FormatChangeAuthorName, cellFormat.FormatChangeDateTime);\n        //     Dictionary < int, object > oldPropertyHash = new Dictionary<int, object>(cellFormat.OldPropertiesHash);\n        //     Dictionary < int, object > propertyHash = new Dictionary<int, object>(cellFormat.PropertiesHash);\n        //     cellFormat.PropertiesHash.Clear();\n        //     cellFormat.OldPropertiesHash.Clear();\n        //     foreach(KeyValuePair < int, object > keyValue in oldPropertyHash)\n        //     cellFormat.PropertiesHash[keyValue.Key] = keyValue.Value;\n        //     SerializeCellFormat(cellFormat);\n        //     cellFormat.PropertiesHash.Clear();\n        //     foreach(KeyValuePair < int, object > keyValue in propertyHash)\n        //     cellFormat.PropertiesHash[keyValue.Key] = keyValue.Value;\n        //     foreach(KeyValuePair < int, object > keyValue in oldPropertyHash)\n        //     cellFormat.OldPropertiesHash[keyValue.Key] = keyValue.Value;\n        //     m_writer.WriteEndElement();\n        //     m_isAlternativeCellFormat = false;\n        // }\n        writer.writeEndElement();\n    };\n    // Serialize the cell width\n    WordExport.prototype.serializeCellWidth = function (writer, cell) {\n        var cf = cell.cellFormat;\n        writer.writeStartElement(undefined, 'tcW', this.wNamespace);\n        if (cf.preferredWidthType === 'Percent') {\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'pct');\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(cf.preferredWidth * this.percentageFactor).toString());\n        }\n        else if (cf.preferredWidthType === 'Point') {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(cf.preferredWidth * this.twipsInOnePoint).toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n        }\n        else {\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'auto');\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, '0');\n        }\n        writer.writeEndElement();\n    };\n    // Serialize cell merge\n    WordExport.prototype.serializeCellMerge = function (writer, cellFormat) {\n        var cell = this.blockOwner;\n        var isserialized = false;\n        var collKey;\n        var currentIndex = cell.columnIndex;\n        var cellIndex = this.row.cells.indexOf(cell);\n        var prevIndex = cellIndex > 0 ? this.row.cells[cellIndex - 1].columnIndex : cell.columnIndex;\n        if (cell.columnIndex === cellIndex) {\n            collKey = cell.columnIndex;\n            isserialized = true;\n        }\n        else {\n            isserialized = false;\n        }\n        if (!isserialized) {\n            if (cellIndex === 0) {\n                currentIndex = cell.columnIndex;\n                prevIndex = -1;\n            }\n            for (var i = prevIndex; i < currentIndex; i++) {\n                collKey = prevIndex + 1;\n                prevIndex += 1;\n                if (this.mVerticalMerge.containsKey(collKey)) {\n                    this.createMerge(writer, collKey, cell);\n                }\n            }\n        }\n        if (cellFormat.rowSpan > 1) {\n            writer.writeStartElement(undefined, 'vMerge', this.wNamespace);\n            this.mVerticalMerge.add(collKey, cellFormat.rowSpan - 1);\n            if (cellFormat.columnSpan > 1) {\n                this.mGridSpans.add(collKey, cellFormat.columnSpan);\n            }\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'restart');\n            writer.writeEndElement();\n        }\n        else if (this.mVerticalMerge.containsKey(collKey) && isserialized) {\n            this.createMerge(writer, collKey, cell);\n        }\n        else if (this.mVerticalMerge.containsKey(cellIndex + 1) && isserialized && cell.nextNode === undefined) {\n            collKey = cell.columnIndex + 1;\n            writer.writeEndElement();\n            writer.writeStartElement('w', 'p', this.wNamespace);\n            writer.writeEndElement();\n            writer.writeEndElement();\n            writer.writeStartElement(undefined, 'tc', this.wNamespace);\n            writer.writeStartElement(undefined, 'tcPr', this.wNamespace);\n            this.serializeColumnSpan(collKey, writer);\n            writer.writeStartElement(undefined, 'vMerge', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'continue');\n            writer.writeEndElement();\n            this.checkMergeCell(collKey);\n        }\n    };\n    WordExport.prototype.createMerge = function (writer, collKey, cell) {\n        this.serializeColumnSpan(collKey, writer);\n        writer.writeStartElement(undefined, 'vMerge', this.wNamespace);\n        writer.writeAttributeString('w', 'val', this.wNamespace, 'continue');\n        writer.writeEndElement();\n        writer.writeEndElement(); //end tcPr\n        writer.writeStartElement('w', 'p', this.wNamespace);\n        writer.writeEndElement();\n        writer.writeEndElement(); //end tc\n        writer.writeStartElement(undefined, 'tc', this.wNamespace);\n        writer.writeStartElement(undefined, 'tcPr', this.wNamespace);\n        this.serializeCellWidth(writer, cell);\n        this.checkMergeCell(collKey);\n    };\n    WordExport.prototype.serializeColumnSpan = function (collKey, writer) {\n        if (this.mGridSpans.keys.length > 0 && this.mGridSpans.containsKey(collKey)) {\n            writer.writeStartElement(undefined, 'gridSpan', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.mGridSpans.get(collKey).toString());\n            writer.writeEndElement();\n        }\n    };\n    WordExport.prototype.checkMergeCell = function (collKey) {\n        if ((this.mVerticalMerge.get(collKey) - 1) === 0) {\n            this.mVerticalMerge.remove(collKey);\n            if (this.mGridSpans.keys.length > 0 && this.mGridSpans.containsKey(collKey)) {\n                this.mGridSpans.remove(collKey);\n            }\n        }\n        else {\n            this.mVerticalMerge.set(collKey, this.mVerticalMerge.get(collKey) - 1);\n        }\n    };\n    // Serialize the grid span element of cell.\n    WordExport.prototype.serializeGridSpan = function (writer, cell) {\n        // int gridSpan = cell.cellFormat.GridSpan;\n        if (cell.cellFormat.columnSpan > 1) {\n            var num = cell.cellFormat.columnSpan;\n            writer.writeStartElement(undefined, 'gridSpan', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, num.toString());\n            writer.writeEndElement();\n        }\n    };\n    // Serialize the table cell direction\n    WordExport.prototype.serializeTableCellDirection = function (writer, cellFormat) {\n        // if (cellFormat..textDirection !== TextDirection.Horizontal)\n        // {\n        //     m_writer.WriteStartElement('textDirection', W_namespace);\n        //     switch (cellFormat.TextDirection)\n        //     {\n        //         case TextDirection.Horizontal:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'lrTb');\n        //             break;\n        //         case TextDirection.VerticalBottomToTop:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'btLr');\n        //             break;\n        //         case TextDirection.VerticalTopToBottom:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'tbRl');\n        //             break;\n        //         case TextDirection.HorizontalFarEast:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'lrTbV');\n        //             break;\n        //         case TextDirection.Vertical:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'tbLrV');\n        //             break;\n        //         case TextDirection.VerticalFarEast:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'tbRlV');\n        //             break;\n        //     }\n        //     m_writer.WriteEndElement();\n        // }\n    };\n    // Serialize the cell vertical alignment\n    WordExport.prototype.serializeCellVerticalAlign = function (writer, alignment) {\n        writer.writeStartElement(undefined, 'vAlign', this.wNamespace);\n        switch (alignment) {\n            case 'Top':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'top');\n                break;\n            case 'Center':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'center');\n                break;\n            default:\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'bottom');\n                break;\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the table grid columns.\n    WordExport.prototype.serializeGridColumns = function (writer, grid) {\n        for (var i = 1, count = grid.length; i < count; i++) {\n            var gridValue = Math.round(grid[i] * 20);\n            writer.writeStartElement(undefined, 'gridCol', this.wNamespace);\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, gridValue.toString());\n            writer.writeEndElement();\n        }\n    };\n    // Serialize the row formattings.\n    // Table parameter is passed for serializing table format and undefined for serializing row format.\n    WordExport.prototype.serializeTableFormat = function (writer, format, table) {\n        // if (!isNullOrUndefined(table))\n        // {\n        //     List<Stream> tempDocxProps = new List<Stream>();\n        //     for (int i = 0, cnt = table.DocxTableFormat.NodeArray.length; i < cnt; i++)\n        //         tempDocxProps.Add(table.DocxTableFormat.NodeArray[i]);\n        writer.writeStartElement(undefined, 'tblPr', this.wNamespace);\n        //     SerializeTableStlye(format);\n        //     if (format.WrapTextAround &&!((table.OwnerTextBody.Owner is WTextBox) || \n        //(table.OwnerTextBody.Owner is WComment) || (table.OwnerTextBody.Owner is WFootnote)))\n        //     {\n        //         SerializeTablePositioning(format.Positioning);\n        //         if (!format.Positioning.AllowOverlap)\n        //         {\n        //             m_writer.WriteStartElement('tblOverlap', W_namespace);\n        //             m_writer.WriteAttributeString('val', W_namespace, 'never');\n        //             m_writer.WriteEndElement();\n        //         }\n        //     }\n        //     SerializeDocxProps(tempDocxProps, 'tblStyleRowBandSize');\n        //     SerializeDocxProps(tempDocxProps, 'tblStyleColBandSize');       \n        this.serializeTableWidth(writer, table);\n        this.serializeTableAlignment(writer, table.tableFormat);\n        this.serializeCellSpacing(writer, table.tableFormat);\n        this.serializeTableIndentation(writer, table.tableFormat);\n        this.serializeTableBorders(writer, table.tableFormat);\n        this.serializeShading(writer, table.tableFormat.shading);\n        if (table.tableFormat.bidi) {\n            writer.writeStartElement(undefined, 'bidiVisual', this.wNamespace);\n            writer.writeEndElement();\n        }\n        this.serializeTblLayout(writer, table.tableFormat);\n        // this.serializeTableCellMargin(writer, table.tableFormat);\n        //     SerializeTableLook(table);\n        //         if (!isNullOrUndefined(table.Title))\n        //             SerializeTableTitle(table);\n        //         if (!isNullOrUndefined(table.Description))\n        //             SerializeTableDescription(table);\n        // }\n        // else\n        // {\n        //     SerializeCellSpacing(format);\n        //     SerializeTableIndentation(format);\n        //     SerializeTableBorders(format);\n        //     SerializeTableShading(format);\n        //     SerializeTblLayout(format);\n        //     SerializeTableCellMargin(format);\n        // }\n        // if (!isNullOrUndefined(format.OwnerBase) && format.OwnerBase is WTable\n        //   && format.OldPropertiesHash.length > 0 && !m_isAlternativeTableFormat)\n        // {\n        //     m_isAlternativeTableFormat = true;\n        //     SerializeTrackChangeProps('tblPrChange', format.FormatChangeAuthorName, format.FormatChangeDateTime);\n        //     SerializeTableTrackChanges(format, format.OwnerBase as WTable);\n        //     m_writer.WriteEndElement();\n        //     m_isAlternativeTableFormat = false;\n        // }\n        // if (!isNullOrUndefined(format.OwnerRow) && format.OldPropertiesHash.length > 0)\n        // {\n        //     SerializeTrackChangeProps('tblPrExChange', format.FormatChangeAuthorName, format.FormatChangeDateTime);\n        //     SerializeTableTrackChanges(format, undefined);\n        //     m_writer.WriteEndElement();\n        // }\n        // SerializeTblTrackChanges(format);\n        if (!isNullOrUndefined(table)) {\n            writer.writeEndElement(); //end of tblPr\n        }\n    };\n    // Serialize the table borders\n    WordExport.prototype.serializeShading = function (writer, format) {\n        // if (format.textureStyle !== 'TextureNone') {\n        writer.writeStartElement(undefined, 'shd', this.wNamespace);\n        writer.writeAttributeString(undefined, 'fill', this.wNamespace, this.getColor(format.backgroundColor));\n        if (format.foregroundColor === 'empty') {\n            writer.writeAttributeString(undefined, 'color', this.wNamespace, 'auto');\n        }\n        else {\n            writer.writeAttributeString(undefined, 'color', this.wNamespace, this.getColor(format.foregroundColor));\n        }\n        writer.writeAttributeString('w', 'val', this.wNamespace, this.getTextureStyle(format.textureStyle));\n        writer.writeEndElement();\n        // }\n    };\n    WordExport.prototype.getTextureStyle = function (textureStyle) {\n        switch (textureStyle) {\n            case 'Texture5Percent':\n            case 'Texture2Pt5Percent':\n            case 'Texture7Pt5Percent':\n                return 'pct5';\n            case 'Texture10Percent':\n                return 'pct10';\n            case 'Texture12Pt5Percent':\n                return 'pct12';\n            case 'Texture15Percent':\n            case 'Texture17Pt5Percent':\n                return 'pct15';\n            case 'Texture20Percent':\n            case 'Texture22Pt5Percent':\n                return 'pct20';\n            case 'Texture25Percent':\n            case 'Texture27Pt5Percent':\n                return 'pct25';\n            case 'Texture30Percent':\n            case 'Texture32Pt5Percent':\n                return 'pct30';\n            case 'Texture35Percent':\n                return 'pct35';\n            case 'Texture37Pt5Percent':\n                return 'pct37';\n            case 'Texture40Percent':\n            case 'Texture42Pt5Percent':\n                return 'pct40';\n            case 'Texture45Percent':\n            case 'Texture47Pt5Percent':\n                return 'pct45';\n            case 'Texture50Percent':\n            case 'Texture52Pt5Percent':\n                return 'pct50';\n            case 'Texture55Percent':\n            case 'Texture57Pt5Percent':\n                return 'pct55';\n            case 'Texture60Percent':\n                return 'pct60';\n            case 'Texture62Pt5Percent':\n                return 'pct62';\n            case 'Texture65Percent':\n            case 'Texture67Pt5Percent':\n                return 'pct65';\n            case 'Texture70Percent':\n            case 'Texture72Pt5Percent':\n                return 'pct70';\n            case 'Texture75Percent':\n            case 'Texture77Pt5Percent':\n                return 'pct75';\n            case 'Texture80Percent':\n            case 'Texture82Pt5Percent':\n                return 'pct80';\n            case 'Texture85Percent':\n                return 'pct85';\n            case 'Texture87Pt5Percent':\n                return 'pct87';\n            case 'Texture90Percent':\n            case 'Texture92Pt5Percent':\n                return 'pct90';\n            case 'Texture95Percent':\n            case 'Texture97Pt5Percent':\n                return 'pct95';\n            case 'TextureCross':\n                return 'thinHorzCross';\n            case 'TextureDarkCross':\n                return 'horzCross';\n            case 'TextureDarkDiagonalCross':\n                return 'diagCross';\n            case 'TextureDarkDiagonalDown':\n                return 'reverseDiagStripe';\n            case 'TextureDarkDiagonalUp':\n                return 'diagStripe';\n            case 'TextureDarkHorizontal':\n                return 'horzStripe';\n            case 'TextureDarkVertical':\n                return 'vertStripe';\n            case 'TextureDiagonalCross':\n                return 'thinDiagCross';\n            case 'TextureDiagonalDown':\n                return 'thinReverseDiagStripe';\n            case 'TextureDiagonalUp':\n                return 'thinDiagStripe';\n            case 'TextureHorizontal':\n                return 'thinHorzStripe';\n            case 'TextureSolid':\n                return 'solid';\n            case 'TextureVertical':\n                return 'thinVertStripe';\n            default:\n                return 'clear';\n        }\n    };\n    // Serialize the table borders\n    WordExport.prototype.serializeTableBorders = function (writer, format) {\n        var borders = format.borders;\n        // if (IsNoneBorder(borders))\n        //     return;\n        writer.writeStartElement(undefined, 'tblBorders', this.wNamespace);\n        this.serializeBorders(writer, format.borders, 8);\n        writer.writeEndElement();\n    };\n    // Serialize the borders.\n    WordExport.prototype.serializeBorders = function (writer, borders, multipler) {\n        this.serializeBorder(writer, borders.top, 'top', multipler);\n        this.serializeBorder(writer, borders.left, 'left', multipler);\n        this.serializeBorder(writer, borders.bottom, 'bottom', multipler);\n        this.serializeBorder(writer, borders.right, 'right', multipler);\n        this.serializeBorder(writer, borders.horizontal, 'insideH', multipler);\n        this.serializeBorder(writer, borders.vertical, 'insideV', multipler);\n        this.serializeBorder(writer, borders.diagonalDown, 'tl2br', multipler);\n        this.serializeBorder(writer, borders.diagonalUp, 'tr2bl', multipler);\n    };\n    // Serialize the table layout element\n    WordExport.prototype.serializeTblLayout = function (writer, format) {\n        //TODO: AUTO size property is not mapped yet\n        // if (!format.IsAutoResized)\n        // {\n        //     writer.writeStartElement(undefined, 'tblLayout', this.wNamespace);\n        //     writer.writeAttributeString(undefined, 'type', this.wNamespace, 'fixed');\n        //     writer.writeEndElement();\n        // }\n    };\n    // Serializes the Border\n    WordExport.prototype.serializeBorder = function (writer, border, tagName, multiplier) {\n        var borderStyle = border.lineStyle;\n        var sz = (border.lineWidth * multiplier);\n        var space = border.space;\n        if (borderStyle === 'Cleared') {\n            writer.writeStartElement(undefined, tagName, this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'nil');\n            writer.writeEndElement();\n            return;\n        }\n        else if ((borderStyle === 'None' && !border.hasNoneStyle) || sz <= 0) {\n            return;\n        }\n        writer.writeStartElement(undefined, tagName, this.wNamespace);\n        writer.writeAttributeString('w', 'val', this.wNamespace, this.getBorderStyle(borderStyle));\n        // if (border.color === '#000000')\n        // {\n        //     writer.writeAttributeString(undefined, 'color', this.wNamespace, 'auto');\n        // }\n        // else\n        // {\n        writer.writeAttributeString(undefined, 'color', this.wNamespace, this.getColor(border.color));\n        // }\n        writer.writeAttributeString(undefined, 'sz', this.wNamespace, this.roundToTwoDecimal(sz).toString());\n        writer.writeAttributeString(undefined, 'space', this.wNamespace, space.toString());\n        if (border.shadow) {\n            writer.writeAttributeString(undefined, 'shadow', this.wNamespace, 'on');\n        }\n        writer.writeEndElement();\n    };\n    // Get the border style as string\n    WordExport.prototype.getBorderStyle = function (borderStyle) {\n        switch (borderStyle) {\n            case 'Cleared':\n                return 'cleared';\n            case 'DashSmallGap':\n                return 'dashSmallGap';\n            case 'Triple':\n                return 'triple';\n            case 'Dot':\n                return 'dotted';\n            case 'DashDot':\n                return 'dotDash';\n            case 'DashLargeGap':\n                return 'dashed';\n            case 'DashDotDot':\n                return 'dotDotDash';\n            case 'Double':\n                return 'double';\n            case 'ThinThickSmallGap':\n                return 'thinThickSmallGap';\n            case 'ThickThinSmallGap':\n                return 'thickThinSmallGap';\n            case 'ThinThickThinSmallGap':\n                return 'thinThickThinSmallGap';\n            case 'ThickThinMediumGap':\n                return 'thickThinMediumGap';\n            case 'ThinThickMediumGap':\n                return 'thinThickMediumGap';\n            case 'ThinThickThinMediumGap':\n                return 'thinThickThinMediumGap';\n            case 'ThickThinLargeGap':\n                return 'thickThinLargeGap';\n            case 'ThinThickLargeGap':\n                return 'thinThickLargeGap';\n            case 'ThinThickThinLargeGap':\n                return 'thinThickThinLargeGap';\n            case 'Thick':\n                return 'thick';\n            case 'SingleWavy':\n                return 'wave';\n            case 'DoubleWavy':\n                return 'doubleWave';\n            case 'DashDotStroked':\n                return 'dashDotStroked';\n            case 'Engrave3D':\n                return 'threeDEngrave';\n            case 'Emboss3D':\n                return 'threeDEmboss';\n            case 'Outset':\n                return 'outset';\n            case 'Inset':\n                return 'inset';\n            // case 'None':\n            //     return 'none';\n            default:\n                return 'single';\n        }\n    };\n    // Serialize the table indentation.\n    WordExport.prototype.serializeTableIndentation = function (writer, format) {\n        writer.writeStartElement(undefined, 'tblInd', this.wNamespace);\n        var tableIndent = Math.round(format.leftIndent * this.twipsInOnePoint);\n        writer.writeAttributeString(undefined, 'w', this.wNamespace, tableIndent.toString());\n        writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n        writer.writeEndElement();\n    };\n    // Serialize the cell spacing.\n    WordExport.prototype.serializeCellSpacing = function (writer, format) {\n        if (!isNullOrUndefined(format.cellSpacing) && format.cellSpacing >= 0) {\n            writer.writeStartElement(undefined, 'tblCellSpacing', this.wNamespace);\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(format.cellSpacing * this.twentiethOfPoint).toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n            writer.writeEndElement();\n        }\n    };\n    // Serialize the table width\n    WordExport.prototype.serializeTableWidth = function (writer, table) {\n        writer.writeStartElement(undefined, 'tblW', this.wNamespace);\n        if (table.tableFormat.preferredWidthType === 'Percent') {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, (table.tableFormat.preferredWidth * this.percentageFactor).toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'pct');\n        }\n        else if (table.tableFormat.preferredWidthType === 'Point') {\n            var tableWidth = Math.round(table.tableFormat.preferredWidth * this.twipsInOnePoint);\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, tableWidth.toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n        }\n        else {\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, '0');\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'auto');\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the table alignment\n    WordExport.prototype.serializeTableAlignment = function (writer, format) {\n        writer.writeStartElement(undefined, 'jc', this.wNamespace);\n        switch (format.tableAlignment) {\n            case 'Right':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'right');\n                break;\n            case 'Center':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'center');\n                break;\n            default:\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'left');\n                break;\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the field\n    WordExport.prototype.serializeFieldCharacter = function (writer, field) {\n        writer.writeStartElement(undefined, 'r', this.wNamespace);\n        this.serializeCharacterFormat(writer, field.characterFormat);\n        writer.writeStartElement(undefined, 'fldChar', this.wNamespace);\n        var type = field.fieldType === 0 ? 'begin'\n            : field.fieldType === 1 ? 'end' : 'separate';\n        writer.writeAttributeString(undefined, 'fldCharType', this.wNamespace, type);\n        writer.writeEndElement();\n        writer.writeEndElement();\n    };\n    // Serialize the text range.\n    WordExport.prototype.serializeTextRange = function (writer, span, previousNode) {\n        writer.writeStartElement('w', 'r', this.wNamespace);\n        this.serializeCharacterFormat(writer, span.characterFormat);\n        if (span.text === '\\t') {\n            writer.writeElementString(undefined, 'tab', this.wNamespace, undefined);\n        }\n        else if (span.text === '\\v') {\n            writer.writeElementString(undefined, 'br', this.wNamespace, undefined);\n        }\n        else if (span.text === '\\f') {\n            writer.writeStartElement(undefined, 'br', this.wNamespace);\n            writer.writeAttributeString('w', 'type', this.wNamespace, 'page');\n            writer.writeEndElement();\n        }\n        else {\n            var isField = !isNullOrUndefined(previousNode)\n                && previousNode.hasOwnProperty('fieldType') && previousNode.fieldType !== 2;\n            writer.writeStartElement(undefined, isField ? 'instrText' : 't', this.wNamespace);\n            writer.writeAttributeString('xml', 'space', this.xmlNamespace, 'preserve');\n            writer.writeString(span.text);\n            writer.writeEndElement();\n        }\n        writer.writeEndElement();\n    };\n    // Serializes the paragraph format\n    WordExport.prototype.serializeParagraphFormat = function (writer, paragraphFormat, paragraph) {\n        if (!isNullOrUndefined(paragraphFormat.styleName)) {\n            writer.writeStartElement(undefined, 'pStyle', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, paragraphFormat.styleName);\n            writer.writeEndElement(); //end of pStyle\n        }\n        if (!isNullOrUndefined(paragraph)) {\n            this.serializeListFormat(writer, paragraph.paragraphFormat.listFormat);\n        }\n        else {\n            this.serializeListFormat(writer, paragraphFormat.listFormat);\n        }\n        if (paragraphFormat.bidi) {\n            writer.writeStartElement(undefined, 'bidi', this.wNamespace);\n            writer.writeEndElement();\n        }\n        this.serializeParagraphSpacing(writer, paragraphFormat);\n        this.serializeIndentation(writer, paragraphFormat);\n        this.serializeParagraphAlignment(writer, paragraphFormat.textAlignment, paragraphFormat.bidi);\n        if (!isNullOrUndefined(paragraphFormat.tabs) && paragraphFormat.tabs.length > 0) {\n            this.serializeTabs(writer, paragraphFormat.tabs);\n        }\n    };\n    // Serialize Tabs\n    WordExport.prototype.serializeTabs = function (writer, tabStops) {\n        writer.writeStartElement('w', 'tabs', this.wNamespace);\n        for (var i = 0; i < tabStops.length; i++) {\n            this.serializeTab(writer, tabStops[i]);\n        }\n        writer.writeEndElement();\n    };\n    WordExport.prototype.serializeTab = function (writer, tabStop) {\n        var position = 0;\n        writer.writeStartElement('w', 'tab', this.wNamespace);\n        if (tabStop.position === 0 && tabStop.deletePosition !== 0) {\n            position = tabStop.deletePosition * this.twentiethOfPoint;\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'clear');\n        }\n        else {\n            position = tabStop.position * this.twentiethOfPoint;\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getTabJustification(tabStop.tabJustification));\n        }\n        if (!isNullOrUndefined(tabStop.tabLeader) && (tabStop.tabLeader !== 'None')) {\n            writer.writeAttributeString('w', 'leader', this.wNamespace, this.getTabLeader(tabStop.tabLeader));\n        }\n        writer.writeAttributeString('w', 'pos', this.wNamespace, position.toString() + '');\n        writer.writeEndElement();\n    };\n    WordExport.prototype.getTabLeader = function (tabLeader) {\n        switch (tabLeader) {\n            case 'Dot':\n                return 'dot';\n            case 'Hyphen':\n                return 'hyphen';\n            case 'Underscore':\n                return 'underscore';\n            default:\n                return 'none';\n        }\n    };\n    WordExport.prototype.getTabJustification = function (tabJustification) {\n        switch (tabJustification) {\n            case 'Bar':\n                return 'bar';\n            case 'Center':\n                return 'center';\n            case 'Decimal':\n                return 'decimal';\n            case 'Left':\n                return 'left';\n            case 'List':\n                return 'num';\n            case 'Right':\n                return 'right';\n            default:\n                return 'clear';\n        }\n    };\n    // // Seraializes the pargraph list format\n    // private serializeListParagraph(writer: XmlWriter, paragraph: any): void {\n    //     if (!isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n    //         this.serializeListFormat(writer, paragraph.paragraphFormat.listFormat);\n    //     }\n    // }\n    // Serialize the list format\n    WordExport.prototype.serializeListFormat = function (writer, lf) {\n        // let pStyleName = undefined;\n        // if (lf.CurrentListStyle.IsBuiltInStyle && !isNullOrUndefined(lf.OwnerParagraph))\n        // {\n        //     pStyleName = lf.OwnerParagraph.StyleName;\n        // }\n        // int listId = GetListId(lf);\n        // if (!isNullOrUndefined(pStyleName) && string.IsNullOrEmpty(lf.LFOStyleName)) \n        // {\n        //     WordDocument doc = lf.OwnerParagraph.Document;\n        //     WParagraphStyle style = doc.Styles.FindByName(pStyleName, StyleType.ParagraphStyle) as WParagraphStyle;\n        //     if (style.ListIndex === -1)\n        //     {\n        //         ListStyle lstStyle = lf.OwnerParagraph.Document.ListStyles.FindByName(lf.CustomStyleName);\n        //         style.ListIndex = listId;\n        //         if (lstStyle.Levels.length > 1)\n        //         {\n        //             style.ListLevel = lf.ListLevelNumber;\n        //         }\n        //         pStyleName = pStyleName.Replace(' ', '');\n        //         lstStyle.Levels[lf.ListLevelNumber].ParaStyleName = pStyleName;\n        //     }\n        // }\n        // else\n        // {\n        // if (!isNullOrUndefined(lf.listId) && !isNullOrUndefined(lf.listLevelNumber)) {\n        //     this.serializeNumPr(writer, lf.listId, lf.listLevelNumber);\n        // }\n        // }\n        if (!isNullOrUndefined(lf.listId) || !isNullOrUndefined(lf.listLevelNumber)) {\n            writer.writeStartElement(undefined, 'numPr', this.wNamespace);\n            if (!isNullOrUndefined(lf.listLevelNumber) && lf.listLevelNumber !== -1) {\n                writer.writeStartElement(undefined, 'ilvl', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, lf.listLevelNumber.toString());\n                writer.writeEndElement();\n            }\n            if (!isNullOrUndefined(lf.listId) && lf.listId !== -1) {\n                writer.writeStartElement(undefined, 'numId', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, (lf.listId + 1).toString());\n                writer.writeEndElement();\n            }\n            writer.writeEndElement();\n        }\n    };\n    // // Serializes the numbering properties to the paragraph\n    // private serializeNumPr(writer: XmlWriter, listId: number, listLevel: number): void {\n    //     writer.writeStartElement(undefined, 'numPr', this.wNamespace);\n    //     if (listLevel !== -1) {\n    //         writer.writeStartElement(undefined, 'ilvl', this.wNamespace);\n    //         writer.writeAttributeString('w', 'val', this.wNamespace, listLevel.toString());\n    //         writer.writeEndElement();\n    //     }\n    //     if (listId !== -1) {\n    //         writer.writeStartElement(undefined, 'numId', this.wNamespace);\n    //         writer.writeAttributeString('w', 'val', this.wNamespace, listId.toString());\n    //         writer.writeEndElement();\n    //     }\n    //     writer.writeEndElement();\n    // }\n    WordExport.prototype.serializeParagraphAlignment = function (writer, txtAlignment, isBidi) {\n        if (isBidi) {\n            if (txtAlignment === 'Right') {\n                txtAlignment = 'Left';\n            }\n            else if (txtAlignment === 'Left') {\n                txtAlignment = 'Right';\n            }\n        }\n        if (!isNullOrUndefined(txtAlignment)) {\n            writer.writeStartElement(undefined, 'jc', this.wNamespace);\n            var alignment = void 0;\n            switch (txtAlignment) {\n                case 'Center':\n                    alignment = 'center';\n                    break;\n                case 'Right':\n                    alignment = 'right';\n                    break;\n                case 'Justify':\n                    alignment = 'both';\n                    break;\n                default:\n                    alignment = 'left';\n                    break;\n            }\n            writer.writeAttributeString('w', 'val', this.wNamespace, alignment);\n            writer.writeEndElement();\n        }\n    };\n    // Serializes the paragraph spacings\n    WordExport.prototype.serializeParagraphSpacing = function (writer, paragraphFormat) {\n        writer.writeStartElement(undefined, 'spacing', this.wNamespace);\n        // if (paragraphFormat.HasValue(WParagraphFormat.BeforeLinesKey))\n        // {\n        //     short beforeLines = (short)Math.Round(paragraphFormat.BeforeLines * DLSConstants.HundredthsUnit);\n        //     writer.WriteAttributeString('beforeLines', this.wNamespace, ToString((float)beforeLines));               \n        // }\n        // if (paragraphFormat.HasValue(WParagraphFormat.AfterLinesKey))\n        // {\n        //     short afterLines = (short)Math.Round(paragraphFormat.AfterLines * DLSConstants.HundredthsUnit);\n        //     writer.WriteAttributeString('afterLines', this.wNamespace, ToString((float)afterLines));                 \n        // }\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(paragraphFormat.beforeSpacing)) {\n            writer.writeAttributeString(undefined, 'before', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.beforeSpacing * this.twentiethOfPoint).toString());\n        }\n        //TODO:ISSUEFIX(paragraphFormat.beforeSpacing * this.twentiethOfPoint).toString());\n        // if (paragraphFormat.HasValue(WParagraphFormat.SpacingBeforeAutoKey))\n        // {\n        //     if (paragraphFormat.SpaceBeforeAuto)\n        //     {\n        //         writer.WriteAttributeString('beforeAutospacing', this.wNamespace, '1');\n        //     }\n        //     else\n        //     {\n        //         writer.WriteAttributeString('beforeAutospacing', this.wNamespace, '0');\n        //     }\n        // }\n        if (!isNullOrUndefined(paragraphFormat.afterSpacing)) {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'after', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.afterSpacing * this.twentiethOfPoint).toString());\n        }\n        //TODO:ISSUEFIX(paragraphFormat.afterSpacing * this.twentiethOfPoint).toString());\n        // if (paragraphFormat.HasValue(WParagraphFormat.SpacingAfterAutoKey))\n        // {\n        //     if (paragraphFormat.SpaceAfterAuto)\n        //     {\n        //         writer.WriteAttributeString('afterAutospacing', this.wNamespace, '1');\n        //     }\n        //     else\n        //     {\n        //         writer.WriteAttributeString('afterAutospacing', this.wNamespace, '0');\n        //     }\n        // }\n        writer.writeAttributeString(undefined, 'line', this.wNamespace, '240');\n        //TODO:ISSUEFIX((paragraphFormat.lineSpacing) * this.twentiethOfPoint).toString());\n        switch (paragraphFormat.lineSpacingType) {\n            case 'AtLeast':\n                writer.writeAttributeString(undefined, 'lineRule', this.wNamespace, 'atLeast');\n                break;\n            case 'Exactly':\n                writer.writeAttributeString(undefined, 'lineRule', this.wNamespace, 'exact');\n                break;\n            default:\n                writer.writeAttributeString(undefined, 'lineRule', this.wNamespace, 'auto');\n                break;\n        }\n        writer.writeEndElement();\n    };\n    // Serializes the paragraph indentation\n    WordExport.prototype.serializeIndentation = function (writer, paragraphFormat) {\n        writer.writeStartElement(undefined, 'ind', this.wNamespace);\n        if (!isNullOrUndefined(paragraphFormat.leftIndent)) {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'left', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.leftIndent * this.twipsInOnePoint).toString());\n        }\n        if (!isNullOrUndefined(paragraphFormat.rightIndent)) {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'right', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.rightIndent * this.twipsInOnePoint).toString());\n        }\n        if (!isNullOrUndefined(paragraphFormat.firstLineIndent)) {\n            if (paragraphFormat.firstLineIndent < 0) {\n                // tslint:disable-next-line:max-line-length\n                writer.writeAttributeString(undefined, 'hanging', this.wNamespace, this.roundToTwoDecimal(-1 * paragraphFormat.firstLineIndent * this.twipsInOnePoint).toString());\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                writer.writeAttributeString(undefined, 'firstLine', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.firstLineIndent * this.twipsInOnePoint).toString());\n            }\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the styles (styles.xml)\n    WordExport.prototype.serializeStyles = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'styles', this.wNamespace);\n        writer.writeAttributeString('xmlns', 'mc', undefined, this.veNamespace);\n        writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        writer.writeAttributeString('xmlns', 'w', undefined, this.wNamespace);\n        writer.writeAttributeString('xmlns', 'w14', undefined, this.w14Namespace);\n        writer.writeAttributeString('xmlns', 'w15', undefined, this.w15Namespace);\n        writer.writeAttributeString('mc', 'Ignorable', undefined, 'w14 w15');\n        //writes the document defaults, latent styles and default styles.\n        this.serializeDefaultStyles(writer);\n        //writes the document styles\n        this.serializeDocumentStyles(writer);\n        writer.writeEndElement(); //end of styles tag\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.stylePath);\n        this.mArchive.addItem(zipArchiveItem); //this.stylePath, styleStream, false, FileAttributes.Archive);\n    };\n    // Serializes the default styles (document default paragraph and character format)\n    WordExport.prototype.serializeDefaultStyles = function (writer) {\n        writer.writeStartElement(undefined, 'docDefaults', this.wNamespace);\n        //if (HasDefaultCharFormat())\n        //{\n        writer.writeStartElement(undefined, 'rPrDefault', this.wNamespace);\n        // if (!isNullOrUndefined(this.mDocument.characterFormat)) {\n        this.serializeCharacterFormat(writer, this.defCharacterFormat);\n        writer.writeEndElement(); // end of rPrDefault\n        // }\n        // else {\n        //     writer.writeStartElement(undefined, 'rPr', this.wNamespace);\n        //     writer.writeStartElement(undefined, 'rFonts', this.wNamespace);\n        //     if (!string.IsNullOrEmpty(m_document.StandardAsciiFont))\n        //         writer.WriteAttributeString('ascii', this.wNamespace, m_document.StandardAsciiFont);\n        //     if (!string.IsNullOrEmpty(m_document.StandardFarEastFont))\n        //         writer.WriteAttributeString('eastAsia', this.wNamespace, m_document.StandardFarEastFont);\n        //     if (!string.IsNullOrEmpty(m_document.StandardNonFarEastFont))\n        //         writer.WriteAttributeString('hAnsi', this.wNamespace, m_document.StandardNonFarEastFont);\n        //     if (!string.IsNullOrEmpty(m_document.StandardBidiFont))\n        //         writer.WriteAttributeString('cs', this.wNamespace, m_document.StandardBidiFont);\n        //     writer.WriteEndElement();\n        //     float fontSize = GetDefFontSize(m_document, WCharacterFormat.FontSizeKey);\n        //     if (fontSize !== 0f)\n        //     {\n        //         writer.WriteStartElement('sz', this.wNamespace);\n        //         writer.WriteAttributeString('val', this.wNamespace, (fontSize * 2).ToString(CultureInfo.InvariantCulture));\n        //         writer.WriteEndElement();\n        //     }\n        //     fontSize = GetDefFontSize(m_document, WCharacterFormat.FontSizeBidiKey);\n        //     if (fontSize !== 0f)\n        //     {\n        //         writer.WriteStartElement('szCs', this.wNamespace);\n        //         writer.WriteAttributeString('val', this.wNamespace, (fontSize * 2).ToString(CultureInfo.InvariantCulture));\n        //         writer.WriteEndElement();\n        //     }\n        //     writer.WriteEndElement();\n        // }\n        // writer.WriteEndElement();\n        // //}\n        writer.writeStartElement(undefined, 'pPrDefault', this.wNamespace);\n        if (!isNullOrUndefined(this.defParagraphFormat)) {\n            writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n            this.serializeParagraphFormat(writer, this.defParagraphFormat, undefined);\n            writer.writeEndElement(); //end of pPr\n        }\n        writer.writeEndElement(); //end of pPrDefault\n        // writer.WriteEndElement();\n        // SerializeLatentStyles();\n        // //Default styles\n        // if (m_document.Styles.length === 0 || isNullOrUndefined(m_document.Styles.FindByName('Normal')))\n        // {\n        //     SerializeDefaultParagraphStyle();\n        // }\n        // if (!IsDocumentContainsDefaultTableStyle())\n        // {\n        //     SerializeTableNormalStyle();\n        // }\n        // if (isNullOrUndefined(m_document.Styles.FindByName('No List')) && isNullOrUndefined(m_document.Styles.FindByName('NoList')))\n        //     SerializeNoListStyle();\n        // tslint:disable-next-line:max-line-length\n        // if (isNullOrUndefined(m_document.Styles.FindByName('Table Grid')) && isNullOrUndefined(m_document.Styles.FindByName('TableGrid')))\n        // {\n        //     SerializeTableGridStyle();\n        // }\n        // }        \n        writer.writeEndElement();\n    };\n    WordExport.prototype.serializeDocumentStyles = function (writer) {\n        for (var i = 0; i < this.mStyles.length; i++) {\n            var style = this.mStyles[i];\n            writer.writeStartElement(undefined, 'style', this.wNamespace);\n            var type = style.type === 'Paragraph' ? 'paragraph' : 'character';\n            writer.writeAttributeString('w', 'type', this.wNamespace, type);\n            writer.writeAttributeString('w', 'styleId', this.wNamespace, style.name);\n            //name\n            writer.writeStartElement(undefined, 'name', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, style.name);\n            writer.writeEndElement();\n            //basedOn\n            if (!isNullOrUndefined(style.basedOn)) {\n                writer.writeStartElement(undefined, 'basedOn', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, style.basedOn);\n                writer.writeEndElement();\n            }\n            //next\n            if (!isNullOrUndefined(style.next)) {\n                writer.writeStartElement(undefined, 'next', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, style.next);\n                writer.writeEndElement();\n            }\n            //link\n            if (!isNullOrUndefined(style.link)) {\n                writer.writeStartElement(undefined, 'link', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, style.link);\n                writer.writeEndElement();\n            }\n            if (style.type === 'Paragraph') {\n                writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n                this.serializeParagraphFormat(writer, style.paragraphFormat, undefined);\n                writer.writeEndElement();\n            }\n            // let value = (style.characterFormat as WCharacterFormat).newgetCharacterFormat();\n            this.serializeCharacterFormat(writer, style.characterFormat);\n            writer.writeEndElement(); //end of Style\n        }\n    };\n    // Serializes the Character format\n    WordExport.prototype.serializeCharacterFormat = function (writer, characterFormat) {\n        writer.writeStartElement(undefined, 'rPr', this.wNamespace);\n        if (!isNullOrUndefined(characterFormat.styleName)) {\n            writer.writeStartElement(undefined, 'rStyle', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, characterFormat.styleName);\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.fontFamily)) {\n            writer.writeStartElement(undefined, 'rFonts', this.wNamespace);\n            writer.writeAttributeString(undefined, 'ascii', this.wNamespace, characterFormat.fontFamily);\n            writer.writeAttributeString(undefined, 'hAnsi', this.wNamespace, characterFormat.fontFamily);\n            writer.writeAttributeString(undefined, 'eastAsia', this.wNamespace, characterFormat.fontFamily);\n            writer.writeAttributeString(undefined, 'cs', this.wNamespace, characterFormat.fontFamilyBidi);\n            writer.writeEndElement(); //end         \n        }\n        if (!isNullOrUndefined(characterFormat.bold)) {\n            this.serializeBoolProperty(writer, 'b', characterFormat.bold);\n        }\n        if (characterFormat.boldBidi) {\n            this.serializeBoolProperty(writer, 'bCs', characterFormat.boldBidi);\n        }\n        if (!isNullOrUndefined(characterFormat.italic)) {\n            this.serializeBoolProperty(writer, 'i', characterFormat.italic);\n        }\n        if (!isNullOrUndefined(characterFormat.italicBidi)) {\n            this.serializeBoolProperty(writer, 'iCs', characterFormat.italicBidi);\n        }\n        if (characterFormat.bidi) {\n            writer.writeStartElement(undefined, 'rtl', this.wNamespace);\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.strikethrough)) {\n            switch (characterFormat.strikethrough) {\n                case 'SingleStrike':\n                    this.serializeBoolProperty(writer, 'strike', true);\n                    break;\n                case 'DoubleStrike':\n                    this.serializeBoolProperty(writer, 'dstrike', true);\n                    break;\n                default:\n                    this.serializeBoolProperty(writer, 'strike', false);\n                    this.serializeBoolProperty(writer, 'dstrike', false);\n                    break;\n            }\n        }\n        if (!isNullOrUndefined(characterFormat.fontColor)) {\n            writer.writeStartElement(undefined, 'color', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getColor(characterFormat.fontColor));\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.fontSize)) {\n            writer.writeStartElement(undefined, 'sz', this.wNamespace);\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.roundToTwoDecimal(characterFormat.fontSize * 2).toString());\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.fontSizeBidi)) {\n            writer.writeStartElement(undefined, 'szCs', this.wNamespace);\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.roundToTwoDecimal(characterFormat.fontSizeBidi * 2).toString());\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.highlightColor) && characterFormat.highlightColor !== 'NoColor') {\n            writer.writeStartElement(undefined, 'highlight', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getHighlightColor(characterFormat.highlightColor));\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.underline) && characterFormat.underline !== 'None') {\n            writer.writeStartElement(undefined, 'u', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getUnderlineStyle(characterFormat.underline));\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.baselineAlignment)) {\n            writer.writeStartElement(undefined, 'vertAlign', this.wNamespace);\n            switch (characterFormat.baselineAlignment) {\n                case 'Subscript':\n                    writer.writeAttributeString('w', 'val', this.wNamespace, 'subscript');\n                    break;\n                case 'Superscript':\n                    writer.writeAttributeString('w', 'val', this.wNamespace, 'superscript');\n                    break;\n                default:\n                    writer.writeAttributeString('w', 'val', this.wNamespace, 'baseline');\n                    break;\n            }\n            writer.writeEndElement();\n        }\n        writer.writeEndElement(); //end of rPrChange\n    };\n    WordExport.prototype.getColor = function (color) {\n        if (color.length > 0) {\n            if (color[0] === '#') {\n                color = color.substr(1);\n            }\n            if (color.length > 6) {\n                color = color.substr(0, 6);\n            }\n        }\n        return color;\n    };\n    // Get the underline style as string\n    WordExport.prototype.getUnderlineStyle = function (underlineStyle) {\n        switch (underlineStyle) {\n            case 'DotDotDashHeavy':\n                return 'dashDotDotHeavy';\n            case 'DotDashHeavy':\n                return 'dashDotHeavy';\n            case 'DashHeavy':\n                return 'dashedHeavy';\n            case 'DashLong':\n                return 'dashLong';\n            case 'DashLongHeavy':\n                return 'dashLongHeavy';\n            case 'DotDash':\n                return 'dotDash';\n            case 'DotDotDash':\n                return 'dotDotDash';\n            case 'Dotted':\n                return 'dotted';\n            case 'DottedHeavy':\n                return 'dottedHeavy';\n            case 'Double':\n                return 'double';\n            case 'Single':\n                return 'single';\n            case 'Thick':\n                return 'thick';\n            case 'Wavy':\n                return 'wave';\n            case 'WavyDouble':\n                return 'wavyDouble';\n            case 'WavyHeavy':\n                return 'wavyHeavy';\n            case 'Words':\n                return 'words';\n            default:\n                return 'dash';\n        }\n    };\n    WordExport.prototype.getHighlightColor = function (highlight) {\n        switch (highlight) {\n            // Highlights the content with bright green (#ff00ff00) color.\n            case 'BrightGreen':\n                return 'green';\n            // Highlights the content with turquoise (#ff00ffff) color.\n            case 'Turquoise':\n                return 'cyan';\n            // Highlights the content with pink (#ffff00ff) color.\n            case 'Pink':\n                return 'magenta';\n            // Highlights the content with blue (#ff0000ff) color.\n            case 'Blue':\n                return 'blue';\n            // Highlights the content with red (#ffff0000) color.\n            case 'Red':\n                return 'red';\n            // Highlights the content with dark blue (#ff000080) color.\n            case 'DarkBlue':\n                return 'darkBlue';\n            // Highlights the content with teal (#ff008080) color.\n            case 'Teal':\n                return 'darkCyan';\n            // Highlights the content with green (#ff008000) color.\n            case 'Green':\n                return 'darkGreen';\n            // Highlights the content with violet (#ff800080) color.\n            case 'Violet':\n                return 'darkMagenta';\n            // Highlights the content with dark red (#ff800000) color.\n            case 'DarkRed':\n                return 'darkRed';\n            // Highlights the content with dark yellow (#ff808000)  color.\n            case 'DarkYellow':\n                return 'darkYellow';\n            // Highlights the content with gray 50 (#ff808080) color.\n            case 'Gray50':\n                return 'darkGray';\n            // Highlights the content with gray 25 (#ffc0c0c0) color.\n            case 'Gray25':\n                return 'lightGray';\n            // Highlights the content with black (#ff000000) color.\n            case 'Black':\n                return 'black';\n            // Highlights the content with yellow (#ffffff00) color.\n            default:\n                return 'yellow';\n        }\n    };\n    /*private toggleFirstCahar(text: string) {\n        return text.charAt(0).toLowerCase() + text.slice(1);\n    }*/\n    // Serializes the bool character format property\n    WordExport.prototype.serializeBoolProperty = function (writer, tag, value) {\n        writer.writeStartElement(undefined, tag, this.wNamespace);\n        if (!value) {\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, '0');\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the list styles and numberings (numberings.xml)\n    WordExport.prototype.serializeNumberings = function () {\n        if (this.document.lists.length === 0) {\n            return;\n        }\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'numbering', this.wNamespace);\n        this.writeCommonAttributeStrings(writer);\n        // this.serializePictureBullets(writer, this.mDocument.lists);\n        this.serializeAbstractListStyles(writer, this.document.abstractLists);\n        this.serializeListInstances(writer, this.document.lists);\n        // SerializeListOverrides(writer, this.mDocument.ridesm_document.ListOverrides);\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.numberingPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    // Serializes the abstract list styles\n    WordExport.prototype.serializeAbstractListStyles = function (writer, listStyles) {\n        for (var i = 0; i < listStyles.length; i++) {\n            var abstractList = listStyles[i];\n            writer.writeStartElement(undefined, 'abstractNum', this.wNamespace);\n            writer.writeAttributeString(undefined, 'abstractNumId', this.wNamespace, abstractList.abstractListId.toString());\n            writer.writeStartElement(undefined, 'nsid', this.wNamespace);\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, this.generateHex());\n            writer.writeEndElement();\n            for (var ilvl = 0, cnt = abstractList.levels.length; ilvl < cnt; ilvl++) {\n                this.serializeListLevel(writer, abstractList.levels[ilvl], ilvl);\n            }\n            writer.writeEndElement(); //end of abstractNum\n        }\n    };\n    // Serializes the list styles\n    WordExport.prototype.serializeListInstances = function (writer, listStyles) {\n        for (var i = 0; i < listStyles.length; i++) {\n            var list = listStyles[i];\n            writer.writeStartElement(undefined, 'num', this.wNamespace);\n            writer.writeAttributeString(undefined, 'numId', this.wNamespace, (list.listId + 1).toString());\n            writer.writeStartElement(undefined, 'abstractNumId', this.wNamespace);\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, list.abstractListId.toString());\n            writer.writeEndElement();\n            writer.writeEndElement();\n        }\n    };\n    WordExport.prototype.generateHex = function () {\n        return (Math.floor(Math.random() * (4000000000 - 270000000)) + 270000000).toString(16).toUpperCase();\n    };\n    WordExport.prototype.roundToTwoDecimal = function (num) {\n        return Math.round(num); // * 100) / 100;\n    };\n    // Serialize the list level\n    WordExport.prototype.serializeListLevel = function (writer, listLevel, levelIndex) {\n        writer.writeStartElement(undefined, 'lvl', this.wNamespace);\n        writer.writeAttributeString(undefined, 'ilvl', this.wNamespace, levelIndex.toString());\n        writer.writeStartElement(undefined, 'start', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, listLevel.startAt.toString());\n        writer.writeEndElement();\n        writer.writeStartElement(undefined, 'numFmt', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, this.getLevelPattern(listLevel.listLevelPattern));\n        writer.writeEndElement();\n        if (listLevel.restartLevel > 0) {\n            writer.writeStartElement(undefined, 'lvlRestart', this.wNamespace);\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, '0');\n            writer.writeEndElement();\n        }\n        // if (!isNullOrUndefined(listLevel.paragraphFormat)) {\n        //     string name = listLevel.ParaStyleName.Substring(0, 1).ToUpper() + listLevel.ParaStyleName.Remove(0, 1);\n        //     writer.WriteStartElement('pStyle', this.wNamespace);\n        //     writer.WriteAttributeString('val', this.wNamespace, name);\n        //     writer.WriteEndElement();\n        // }\n        // if (listLevel.IsLegalStyleNumbering) {\n        //     writer.WriteStartElement('isLgl', this.wNamespace);\n        //     writer.WriteEndElement();\n        // }\n        this.serializeLevelFollow(writer, listLevel);\n        this.serializeLevelText(writer, listLevel, levelIndex + 1);\n        // SerializeLegacyProperties(listLevel);\n        // if (listLevel.PicBulletId > 0) {\n        //     writer.WriteStartElement('lvlPicBulletId', this.wNamespace);\n        //     writer.WriteAttributeString('val', this.wNamespace, listLevel.PicBulletId.ToString());\n        //     writer.WriteEndElement();\n        // }\n        // //lvlJc\n        // if (listLevel.NumberAlignment !== ListNumberAlignment.Left) {\n        //     writer.WriteStartElement('lvlJc', this.wNamespace);\n        //     string alignment = string.Empty;\n        //     if (listLevel.NumberAlignment === ListNumberAlignment.Right) {\n        //         alignment = 'right';\n        //     }\n        //     else {\n        //         alignment = 'center';\n        //     }\n        //     writer.WriteAttributeString('val', this.wNamespace, alignment);\n        //     writer.WriteEndElement();\n        // }\n        writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n        this.serializeParagraphFormat(writer, listLevel.paragraphFormat, undefined);\n        writer.writeEndElement(); //end of pPr\n        this.serializeCharacterFormat(writer, listLevel.characterFormat);\n        writer.writeEndElement();\n    };\n    WordExport.prototype.getLevelPattern = function (levelPattern) {\n        var patternType;\n        switch (levelPattern) {\n            case 'Arabic':\n                patternType = 'decimal';\n                break;\n            case 'UpRoman':\n                patternType = 'upperRoman';\n                break;\n            case 'LowRoman':\n                patternType = 'lowerRoman';\n                break;\n            case 'UpLetter':\n                patternType = 'upperLetter';\n                break;\n            case 'LowLetter':\n                patternType = 'lowerLetter';\n                break;\n            // case 'Ordinal':\n            //     patternType = 'ordinal';\n            //     break;\n            // case 'Number':\n            //     patternType = 'cardinalText';\n            //     break;\n            // case 'OrdinalText':\n            //     patternType = 'ordinalText';\n            //     break;\n            // case 'LeadingZero':\n            //     patternType = 'decimalZero';\n            //     break;\n            // case 'Bullet':\n            default:\n                patternType = 'bullet';\n                break;\n            // case 'FarEast':\n            //     patternType = 'aiueoFullWidth';\n            //     break;\n            // case 'Special':\n            //     patternType = 'russianLower';\n            //     break;\n            // case 'None':\n            //     patternType = 'none';\n            //     break;\n        }\n        return patternType;\n    };\n    // Serializes the level text\n    WordExport.prototype.serializeLevelText = function (writer, listLevel, lvlIndex) {\n        writer.writeStartElement(undefined, 'lvlText', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, (listLevel.numberFormat));\n        writer.writeEndElement();\n    };\n    // Serialize the level follow character\n    WordExport.prototype.serializeLevelFollow = function (writer, listLevel) {\n        var fc;\n        //TODO:Type issue returns number instead of string\n        if (listLevel.followCharacter === 'Tab') {\n            fc = 'tab';\n        }\n        else if (listLevel.followCharacter === 'Space') {\n            fc = 'space';\n        }\n        else {\n            fc = 'nothing';\n        }\n        writer.writeStartElement(undefined, 'suff', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, fc);\n        writer.writeEndElement();\n    };\n    WordExport.prototype.serializeSettings = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'settings', this.wNamespace);\n        this.writeCustom(writer);\n        // writer.writeAttributeString('xmlns', 'mc', undefined, this.veNamespace);\n        // writer.writeAttributeString('xmlns', 'o', undefined, this.oNamespace);\n        // writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        // writer.writeAttributeString('xmlns', 'm', undefined, this.mNamespace);\n        // writer.writeAttributeString('xmlns', 'v', undefined, this.vNamespace);\n        writer.writeAttributeString('xmlns', 'w10', undefined, this.w10Namespace);\n        writer.writeAttributeString('xmlns', 'w14', undefined, this.w14Namespace);\n        writer.writeAttributeString('xmlns', 'w15', undefined, this.w15Namespace);\n        writer.writeAttributeString('xmlns', 'sl', undefined, this.slNamespace);\n        writer.writeAttributeString('mc', 'Ignorable', undefined, 'w14 w15');\n        // //w:writeProtection - Write Protection\n        // if (m_document.WriteProtected)\n        // {\n        //     writer.writeStartElement('w', 'writeProtection', this.wNamespace);\n        //     writer.writeAttributeString('recommended', this.wNamespace, '1');\n        //     writer.writeEndElement();\n        // }\n        //w:view - Document View Setting\n        // if (this.mDocument.ViewSetup.DocumentViewType !== DocumentViewType.PrintLayout &&\n        //   m_document.ViewSetup.DocumentViewType !== DocumentViewType.NormalLayout)\n        // {\n        //     writer.writeStartElement('view', this.wNamespace);\n        //     string viewTypeStr = string.Empty;\n        //     if (m_document.ViewSetup.DocumentViewType === DocumentViewType.OutlineLayout)\n        //     {\n        //         viewTypeStr = 'outline';\n        //     }\n        //     else if (m_document.ViewSetup.DocumentViewType === DocumentViewType.WebLayout)\n        //     {\n        //         viewTypeStr = 'web';\n        //     }\n        //     writer.writeAttributeString('val', this.wNamespace, viewTypeStr);\n        //     writer.writeEndElement();\n        // }\n        //w:zoom - Magnification Setting\n        writer.writeStartElement('w', 'zoom', this.wNamespace);\n        // switch (m_document.ViewSetup.ZoomType)\n        // {\n        //     case ZoomType.FullPage:\n        //         writer.writeAttributeString('w', 'val', this.wNamespace, 'fullPage');\n        //         break;\n        //     case ZoomType.PageWidth:\n        //         writer.writeAttributeString('w', 'val', this.wNamespace, 'bestFit');\n        //         break;\n        //     case ZoomType.TextFit:\n        //         writer.writeAttributeString('w', 'val', this.wNamespace, 'textFit');\n        //         break;\n        // default:\n        writer.writeAttributeString('w', 'val', this.wNamespace, 'none');\n        // break;\n        // }\n        writer.writeAttributeString('w', 'percent', this.wNamespace, '100');\n        writer.writeEndElement();\n        //w:displayBackgroundShape - Display Background Objects When Displaying Document\n        // if (m_document.Background.Type !== BackgroundType.NoBackground)\n        // {\n        writer.writeStartElement(undefined, 'displayBackgroundShape', this.wNamespace);\n        writer.writeEndElement();\n        // }\n        //w:defaultTabStop - Distance Between Automatic Tab Stops\n        writer.writeStartElement(undefined, 'defaultTabStop', this.wNamespace);\n        var tabWidth = Math.round(this.defaultTabWidthValue * this.twipsInOnePoint);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, tabWidth.toString());\n        writer.writeEndElement();\n        //w:evenAndOddHeaders - Different Even/Odd Page Headers and Footers        \n        if (this.mDifferentFirstPage) {\n            writer.writeStartElement(undefined, 'evenAndOddHeaders', this.wNamespace);\n            writer.writeEndElement();\n        }\n        //w:footnotePr - Document-Wide Footnote Properties and w:endnotePr - Document-Wide Endnote Properties\n        // SerializeFootnoteSettings();\n        //w:compat - Compatibility Settings\n        writer.writeStartElement(undefined, 'compat', this.wNamespace);\n        writer.writeStartElement(undefined, 'compatSetting', this.wNamespace);\n        writer.writeAttributeString(undefined, 'name', this.wNamespace, 'compatibilityMode');\n        writer.writeAttributeString(undefined, 'uri', this.wNamespace, 'http://schemas.microsoft.com/office/word');\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, '15');\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.settingsPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    WordExport.prototype.serializeCoreProperties = function () {\n        //implementation\n    };\n    WordExport.prototype.serializeAppProperties = function () {\n        //implementation\n    };\n    WordExport.prototype.serializeFontTable = function (contentType) {\n        //implementation\n    };\n    WordExport.prototype.serializeSettingsRelation = function () {\n        //implementation\n    };\n    WordExport.prototype.serializeHeaderFooters = function () {\n        this.serializeHeaderFooter('EvenFooter');\n        this.serializeHeaderFooter('EvenHeader');\n        this.serializeHeaderFooter('FirstPageFooter');\n        this.serializeHeaderFooter('FirstPageHeader');\n        this.serializeHeaderFooter('OddFooter');\n        this.serializeHeaderFooter('OddHeader');\n    };\n    // Serializes the Header/Footer\n    WordExport.prototype.serializeHeaderFooter = function (hfType) {\n        if (this.headersFooters.length === 0) {\n            return;\n        }\n        var headerFooterPath;\n        var headerFooterRelsPath;\n        if (!this.headersFooters.containsKey(hfType)) {\n            return;\n        }\n        var hfColl = this.headersFooters.get(hfType);\n        var hf = undefined;\n        for (var i = 0; i < hfColl.keys.length; i++) {\n            var id = hfColl.keys[i];\n            hf = hfColl.get(id);\n            if (hfType === 'EvenHeader' || hfType === 'FirstPageHeader' ||\n                hfType === 'OddHeader') {\n                headerFooterPath = this.headerPath + id.replace('rId', '') + '.xml';\n                headerFooterRelsPath = this.headerRelationPath + id.replace('rId', '') + '.xml.rels';\n                this.serializeHeader(hf, id, headerFooterPath, headerFooterRelsPath);\n            }\n            else {\n                headerFooterPath = this.footerPath + id.replace('rId', '') + '.xml';\n                headerFooterRelsPath = this.footerRelationPath + id.replace('rId', '') + '.xml.rels';\n                this.serializeFooter(hf, id, headerFooterPath, headerFooterRelsPath);\n            }\n        }\n    };\n    // Serialize the header part\n    WordExport.prototype.serializeHeader = function (header, id, headerFooterPath, headerFooterRelsPath) {\n        this.headerFooter = header;\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'hdr', this.wNamespace);\n        this.writeHFCommonAttributes(writer);\n        var owner = this.blockOwner;\n        this.blockOwner = header;\n        this.serializeBodyItems(writer, header.blocks, true);\n        this.blockOwner = owner;\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, headerFooterPath);\n        this.mArchive.addItem(zipArchiveItem);\n        this.serializeHFRelations(id, headerFooterRelsPath);\n        this.headerFooter = undefined;\n    };\n    // Serializes the HeaderFooter relations\n    WordExport.prototype.serializeHFRelations = function (hfId, headerFooterRelsPath) {\n        var hasHFImage = this.headerFooterImages.containsKey(hfId);\n        // let hasHFHyperlinks = HeaderFooterHyperlinks.ContainsKey(hfId);\n        // let hasHFInclPics = HeaderFooterInclPicUrls.ContainsKey(hfId);\n        // let hasHFAlternateChunks = HeaderFooterAlternateChunks.ContainsKey(hfId);\n        if (hasHFImage) { // || hasHFHyperlinks ||hasHFAlternateChunks\n            var writer = new XmlWriter();\n            writer.writeStartElement(undefined, 'Relationships', this.rpNamespace);\n            this.serializeImagesRelations(this.headerFooterImages.get(hfId), writer);\n            // if (hasHFHyperlinks)\n            //     SerializeHyperlinkRelations(stream, HeaderFooterHyperlinks[hfId]);\n            // if (hasHFAlternateChunks)\n            //     SerializeAltChunkRelations(stream, HeaderFooterAlternateChunks[hfId]);\n            // if (hasHFInclPics)\n            //     SerializeIncludePictureUrlRelations(stream, HeaderFooterInclPicUrls[hfId]);\n            // if (HFOleContainers.ContainsKey(hfId))\n            // {\n            //     AddOLEToZip(HFOleContainers[hfId]);\n            // }\n            // if (HFRelations.ContainsKey(hfId))\n            //     SerializeHFCommonRelations(stream, HFRelations[hfId]);\n            writer.writeEndElement();\n            var zipArchiveItem = new ZipArchiveItem(writer.buffer, headerFooterRelsPath);\n            this.mArchive.addItem(zipArchiveItem);\n        }\n        else {\n            return;\n        }\n    };\n    WordExport.prototype.writeHFCommonAttributes = function (writer) {\n        writer.writeAttributeString('xmlns', 'v', undefined, this.vNamespace);\n        writer.writeAttributeString('xmlns', 'w10', undefined, this.w10Namespace);\n        writer.writeAttributeString('xmlns', 'o', undefined, this.oNamespace);\n        writer.writeAttributeString('xmlns', 've', undefined, this.veNamespace);\n        writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        writer.writeAttributeString('xmlns', 'm', undefined, this.mNamespace);\n        writer.writeAttributeString('xmlns', 'wne', undefined, this.wneNamespace);\n        writer.writeAttributeString('xmlns', 'a', undefined, this.aNamespace);\n        writer.writeAttributeString('xmlns', 'pic', undefined, this.pictureNamespace);\n        writer.writeAttributeString('xmlns', 'wp', undefined, this.wpNamespace);\n        writer.writeAttributeString('xmlns', 'wpc', undefined, this.wpCanvasNamespace);\n        writer.writeAttributeString('xmlns', 'wp14', undefined, this.wpDrawingNamespace);\n        this.writeDup(writer);\n        writer.writeAttributeString('xmlns', 'wps', undefined, this.wpShapeNamespace);\n        writer.writeAttributeString('ve', 'Ignorable', undefined, 'w14 w15 wp14');\n    };\n    // Serailize the footer and its relations\n    WordExport.prototype.serializeFooter = function (footer, id, headerFooterPath, headerFooterRelsPath) {\n        this.headerFooter = footer;\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'ftr', this.wNamespace);\n        this.writeHFCommonAttributes(writer);\n        this.serializeBodyItems(writer, footer.blocks, true);\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, headerFooterPath);\n        this.mArchive.addItem(zipArchiveItem);\n        this.serializeHFRelations(id, headerFooterRelsPath);\n    };\n    WordExport.prototype.serializeDocumentRelations = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement(undefined, 'Relationships', this.rpNamespace);\n        this.serializeRelationShip(writer, this.getNextRelationShipID(), this.stylesRelType, 'styles.xml');\n        this.serializeRelationShip(writer, this.getNextRelationShipID(), this.settingsRelType, 'settings.xml');\n        // this.serializeRelationShip(writer, this.getNextRelationShipID(), this.ThemeRelType, 'theme/theme1.xml');\n        if (this.document.lists.length > 0) {\n            this.serializeRelationShip(writer, this.getNextRelationShipID(), this.numberingRelType, 'numbering.xml');\n        }\n        this.serializeHeaderFooterRelations(writer);\n        // if (HasFontTable) {\n        //     SerializeRelationShip(docRelstream, GetNextRelationShipID(), this.FontTableRelType, 'fontTable.xml');\n        // }\n        // SerializeIncludePictureUrlRelations(docRelstream, InclPicFieldUrl);\n        // //// Creating relationships for every hyperlink and image containing in the document\n        this.serializeImagesRelations(this.documentImages, writer);\n        // SerializeSvgImageRelation();\n        //this.serializeExternalLinkImages(writer);\n        // if (HasHyperlink && HyperlinkTargets.length > 0) {\n        //     SerializeHyperlinkRelations(docRelstream, HyperlinkTargets);\n        // }\n        // if (m_document.HasMacros\n        //     && IsMacroEnabled)\n        //     SerializeRelationShip(docRelstream, GetNextRelationShipID(), this.VbaProjectRelType, this.VbaProject);\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.wordRelationPath);\n        this.mArchive.addItem(zipArchiveItem);\n        this.headerFooter = undefined;\n    };\n    // Serializes the image relations\n    WordExport.prototype.serializeImagesRelations = function (images, writer) {\n        if (images.length > 0) {\n            var imagePath = '';\n            var base64ImageString = void 0;\n            var keys = images.keys;\n            for (var i = 0; i < keys.length; i++) {\n                var mImage = images.get(keys[i]);\n                base64ImageString = mImage.imageString;\n                if (isNullOrUndefined(base64ImageString)) {\n                    imagePath = this.imagePath + '/0.jpeg';\n                    this.serializeRelationShip(writer, keys[i], this.imageRelType, imagePath.replace('word/', ''));\n                }\n                else {\n                    var imageInfo = HelperMethods.formatClippedString(base64ImageString);\n                    var extension = imageInfo.extension;\n                    var formatClippedString = imageInfo.formatClippedString;\n                    imagePath = this.imagePath + keys[i] + extension;\n                    this.serializeRelationShip(writer, keys[i], this.imageRelType, imagePath.replace('word/', ''));\n                    //if (m_archive.Find(imagePath.Replace('\\\\', '/')) === -1)\n                    // {\n                    var imageBlob = new Blob([this.encodedString(formatClippedString)]);\n                    var zipArchiveItem = new ZipArchiveItem(imageBlob, imagePath);\n                    // let TestArchive = new ZipArchive();\n                    this.mArchive.addItem(zipArchiveItem);\n                    // TestArchive.save('image.zip').then(function (): void {\n                    //     TestArchive.destroy();\n                    // });\n                    // }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    WordExport.prototype.encodedString = function (input) {\n        var keyStr = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n        var chr1;\n        var chr2;\n        var chr3;\n        var enc1;\n        var enc2;\n        var enc3;\n        var enc4;\n        var i = 0;\n        var resultIndex = 0;\n        /*let dataUrlPrefix: string = 'data:';*/\n        input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, '');\n        var totalLength = input.length * 3 / 4;\n        if (input.charAt(input.length - 1) === keyStr.charAt(64)) {\n            totalLength--;\n        }\n        if (input.charAt(input.length - 2) === keyStr.charAt(64)) {\n            totalLength--;\n        }\n        if (totalLength % 1 !== 0) {\n            // totalLength is not an integer, the length does not match a valid\n            // base64 content. That can happen if:\n            // - the input is not a base64 content\n            // - the input is *almost* a base64 content, with a extra chars at the\n            // beginning or at the end\n            // - the input uses a base64 variant (base64url for example)\n            throw new Error('Invalid base64 input, bad content length.');\n        }\n        var output = new Uint8Array(totalLength | 0);\n        while (i < input.length) {\n            enc1 = keyStr.indexOf(input.charAt(i++));\n            enc2 = keyStr.indexOf(input.charAt(i++));\n            enc3 = keyStr.indexOf(input.charAt(i++));\n            enc4 = keyStr.indexOf(input.charAt(i++));\n            chr1 = (enc1 << 2) | (enc2 >> 4);\n            chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n            chr3 = ((enc3 & 3) << 6) | enc4;\n            output[resultIndex++] = chr1;\n            if (enc3 !== 64) {\n                output[resultIndex++] = chr2;\n            }\n            if (enc4 !== 64) {\n                output[resultIndex++] = chr3;\n            }\n        }\n        return output;\n    };\n    WordExport.prototype.serializeExternalLinkImages = function (writer) {\n        var imagePath = '';\n        var keys = this.externalImages.keys;\n        for (var i = 0; i < this.externalImages.keys.length; i++) {\n            this.serializeRelationShip(writer, keys[i], this.imageRelType, this.externalImages.get(keys[i]));\n        }\n    };\n    // Serializes the HeaderFooters relations to the document relations stream\n    WordExport.prototype.serializeHeaderFooterRelations = function (writer) {\n        this.serializeHFRelation(writer, 'EvenFooter');\n        this.serializeHFRelation(writer, 'EvenHeader');\n        this.serializeHFRelation(writer, 'FirstPageFooter');\n        this.serializeHFRelation(writer, 'FirstPageHeader');\n        this.serializeHFRelation(writer, 'OddFooter');\n        this.serializeHFRelation(writer, 'OddHeader');\n    };\n    // Serializes the headers footers relations.\n    WordExport.prototype.serializeHFRelation = function (writer, hfType) {\n        var headerFooterPath = '';\n        var relType;\n        if (!this.headersFooters.containsKey(hfType)) {\n            return;\n        }\n        var hfColl = this.headersFooters.get(hfType);\n        for (var i = 0; i < hfColl.keys.length; i++) {\n            var id = hfColl.keys[i];\n            if (hfType === 'EvenHeader' || hfType === 'FirstPageHeader' ||\n                hfType === 'OddHeader') {\n                headerFooterPath = 'header' + id.replace('rId', '') + '.xml';\n                relType = this.headerRelType;\n            }\n            else {\n                headerFooterPath = 'footer' + id.replace('rId', '') + '.xml';\n                relType = this.footerRelType;\n            }\n            this.serializeRelationShip(writer, id, relType, headerFooterPath);\n        }\n    };\n    // Serializes the relationship\n    WordExport.prototype.serializeRelationShip = function (writer, relationshipID, relationshipType, targetPath) {\n        writer.writeStartElement(undefined, 'Relationship', undefined);\n        writer.writeAttributeString(undefined, 'Id', undefined, relationshipID);\n        writer.writeAttributeString(undefined, 'Type', undefined, relationshipType);\n        writer.writeAttributeString(undefined, 'Target', undefined, targetPath.replace('\\\\', '/').replace('\\v', ''));\n        // tslint:disable-next-line:max-line-length\n        if (relationshipType === this.hyperlinkRelType || this.startsWith(targetPath, 'http://') || this.startsWith(targetPath, 'https://') || this.startsWith(targetPath, 'file:///')) {\n            // Uri targetUri;\n            // if ((!targetPath.StartsWith('file:///')) && Uri.TryCreate(targetPath, UriKind.Absolute, out targetUri))\n            // {\n            //     //Handled using Try catch to avoid exception if the Host name type is None because in \n            //Silverlight 'HostNameType' property is not available.\n            //     try\n            //     {\n            //         m_writer.WriteAttributeString('Target', targetUri.AbsoluteUri);\n            //     }\n            //     catch\n            //     {\n            //         m_writer.WriteAttributeString('Target', targetPath.Replace('\\\\', '/').Replace(ControlChar.LineBreak, string.Empty));\n            //     }\n            // }\n            // else\n            // {\n            //     m_writer.WriteAttributeString('Target', targetPath.Replace('\\\\', '/').Replace(ControlChar.LineBreak, string.Empty));\n            // }\n            writer.writeAttributeString(undefined, 'TargetMode', undefined, 'External');\n        }\n        writer.writeEndElement();\n    };\n    // Get the next relationship ID\n    WordExport.prototype.getNextRelationShipID = function () {\n        return 'rId' + (++this.mRelationShipID);\n    };\n    WordExport.prototype.serializeGeneralRelations = function () {\n        var writer = new XmlWriter();\n        this.resetRelationShipID();\n        writer.writeStartElement(undefined, 'Relationships', this.rpNamespace);\n        this.serializeRelationShip(writer, this.getNextRelationShipID(), this.documentRelType, this.documentPath);\n        // this.serializeRelationShip(writer, this.getNextRelationShipID(), this.AppRelType, this.appPath);\n        // this.serializeRelationShip(writer, this.getNextRelationShipID(), this.CoreRelType, this.corePath);\n        //End of Relationships tag\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.generalRelationPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    WordExport.prototype.serializeContentTypes = function (contentType) {\n        var writer = new XmlWriter();\n        writer.writeStartElement(undefined, 'Types', 'http://schemas.openxmlformats.org/package/2006/content-types');\n        //if (m_hasOleObject)\n        //{\n        //    //<Default Extension='bin' ContentType='application/vnd.openxmlformats-officedocument.oleObject'/>\n        //    SerializeDefaultContentType(contentStream, 'bin', 'application/vnd.openxmlformats-officedocument.oleObject');\n        //}\n        this.serializeDefaultContentType(writer, 'rels', this.relationContentType);\n        this.serializeDefaultContentType(writer, 'xml', this.xmlContentType);\n        // if (m_hasEmbedFonts && !string.IsNullOrEmpty(type))\n        // {\n        //     SerializeDefaultContentType(contentStream,type, this.fontContentType);\n        // }\n        if (this.documentImages.length > 0 || this.externalImages.length > 0 || this.headerFooterImages.length > 0) {\n            this.serializeDefaultContentType(writer, 'png', 'image/png');\n            this.serializeDefaultContentType(writer, 'bmp', 'image/bmp');\n            this.serializeDefaultContentType(writer, 'emf', 'image/x-emf');\n            this.serializeDefaultContentType(writer, 'wmf', 'image/x-wmf');\n            this.serializeDefaultContentType(writer, 'gif', 'image/gif');\n            this.serializeDefaultContentType(writer, 'ico', 'image/x-icon');\n            this.serializeDefaultContentType(writer, 'tif', 'image/tiff');\n            this.serializeDefaultContentType(writer, 'tiff', 'image/tiff');\n            this.serializeDefaultContentType(writer, 'jpeg', 'image/jpeg');\n            this.serializeDefaultContentType(writer, 'jpg', 'image/jpeg');\n            this.serializeDefaultContentType(writer, 'svg', 'image/svg+xml');\n        }\n        // if (m_document.HasMacros\n        //     && IsMacroEnabled && !m_isSkipBinExtension)\n        // {\n        //     SerializeDefaultContentType(contentStream, 'bin', this.VbaProjectContentType);\n        //     m_isSkipBinExtension = true;\n        // }\n        // if (m_hasOleObject)\n        // {\n        //     SerializeOleContentType(contentStream);\n        // }\n        //document.xml\n        this.serializeOverrideContentType(writer, this.documentPath, this.documentContentType);\n        // tslint:disable-next-line:max-line-length\n        //<Override PartName='/word/numbering.xml' ContentType='application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml'/>\n        // if (HasNumbering) {\n        this.serializeOverrideContentType(writer, this.numberingPath, this.numberingContentType);\n        // }\n        //Add the header/footer Alternate chunks\n        // if (HeaderFooterAlternateChunks.length > 0) {\n        //     foreach(Dictionary < string, string > item in m_headerFooterAlternateChunks.Values)\n        //     AddAlternateChunkItem(item);\n        // }\n        //styles.xml\n        this.serializeOverrideContentType(writer, this.stylePath, this.stylesContentType);\n        //settings.xml\n        this.serializeOverrideContentType(writer, this.settingsPath, this.settingsContentType);\n        //             //core.xml\n        //             SerializeOverrideContentType(contentStream, this.corePath, this.CoreContentType);\n        //             //app.xml\n        //             SerializeOverrideContentType(contentStream, this.appPath, this.AppContentType);\n        //             //custom.xml\n        //             if (!isNullOrUndefined(m_document.CustomDocumentProperties) && m_document.CustomDocumentProperties.length > 0)\n        //                 SerializeOverrideContentType(contentStream, this.CustomPath, this.CustomContentType);\n        // #if Chart\n        //             if (m_hasChart)\n        //                 SerializeChartContentType(contentStream);\n        // #endif\n        this.serializeHFContentTypes(writer);\n        // WriteXmlItemsContentTypes(contentStream);\n        //End of Types tag\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.contentTypesPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    // Serializes the HeaderFooter content types\n    WordExport.prototype.serializeHFContentTypes = function (writer) {\n        this.serializeHeaderFootersContentType(writer, 'EvenFooter');\n        this.serializeHeaderFootersContentType(writer, 'EvenHeader');\n        this.serializeHeaderFootersContentType(writer, 'FirstPageFooter');\n        this.serializeHeaderFootersContentType(writer, 'FirstPageHeader');\n        this.serializeHeaderFootersContentType(writer, 'OddFooter');\n        this.serializeHeaderFootersContentType(writer, 'OddHeader');\n    };\n    // Serializes the HeaderFooter content types.\n    WordExport.prototype.serializeHeaderFootersContentType = function (writer, headerFooterType) {\n        var contentType;\n        var partName;\n        if (!this.headersFooters.containsKey(headerFooterType)) {\n            return;\n        }\n        var hfColl = this.headersFooters.get(headerFooterType);\n        for (var i = 0; i < hfColl.keys.length; i++) {\n            var id = hfColl.keys[i];\n            if (headerFooterType === 'EvenHeader' || headerFooterType === 'FirstPageHeader' ||\n                headerFooterType === 'OddHeader') {\n                partName = this.headerPath + id.replace('rId', '') + '.xml';\n                contentType = this.headerContentType;\n            }\n            else {\n                partName = this.footerPath + id.replace('rId', '') + '.xml';\n                contentType = this.footerContentType;\n            }\n            this.serializeOverrideContentType(writer, partName, contentType);\n        }\n    };\n    // Serializes the Override content type.\n    WordExport.prototype.serializeOverrideContentType = function (writer, partName, contentType) {\n        writer.writeStartElement(undefined, 'Override', undefined);\n        writer.writeAttributeString(undefined, 'PartName', undefined, '/' + partName.replace('\\\\', '/'));\n        writer.writeAttributeString(undefined, 'ContentType', undefined, contentType);\n        writer.writeEndElement();\n    };\n    // Serializes the default content type\n    WordExport.prototype.serializeDefaultContentType = function (writer, extension, contentType) {\n        writer.writeStartElement(undefined, 'Default', undefined);\n        writer.writeAttributeString(undefined, 'Extension', undefined, extension);\n        writer.writeAttributeString(undefined, 'ContentType', undefined, contentType);\n        writer.writeEndElement();\n    };\n    // Reset the relationship id counter\n    WordExport.prototype.resetRelationShipID = function () {\n        this.mRelationShipID = 0;\n    };\n    WordExport.prototype.close = function () {\n        //Implement\n    };\n    return WordExport;\n}());\nexport { WordExport };\n","/**\n * export document editor\n */\nexport * from './base/index';\nexport * from './document-editor';\nexport * from './implementation/index';\n","/**\n * export document editor modules\n */\nexport * from './document-editor/index';\nexport * from './document-editor-container/index';\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJhcHBzL2lsby1hZG1pbi9zcmMvYXBwL2ZlYXR1cmVzL2FydGljbGVzL2FydGljbGUtY2F0YWdvcnktZm9ybS9hcnRpY2xlLWNhdGFnb3J5LWZvcm0uY29tcG9uZW50LmNzcyJ9 */\"","module.exports = \"<div class=\\\"container card shadow-lg pl-5 pr-5 md-3\\\">\\n  <form [formGroup]=\\\"articleCatagoryForm\\\" (ngSubmit)=\\\"onSubmit()\\\" novalidate>\\n    <ejs-tab id=\\\"element\\\" #tab>\\n      <e-tabitems>\\n        <e-tabitem [header]=\\\"headerText[0]\\\">\\n          <ng-template #content>\\n            <div class=\\\"row\\\">\\n              <div class=\\\"col-12  form-group \\\">\\n                <label for=\\\"catagory\\\">Article Catagory</label>\\n                <input type=\\\"text\\\" formControlName=\\\"name\\\" class=\\\"form-control\\\" id=\\\"catagory\\\"\\n                  aria-describedby=\\\"Article catagory\\\" placeholder=\\\"Article catagory\\\" />\\n                <div class=\\\"text-danger\\\" *ngIf=\\\"catagoryName.errors\\\">\\n                  <div *ngIf=\\\"catagoryName.errors['required']\\\">\\n                    Article catagory is required\\n                  </div>\\n                </div>\\n              </div>\\n              <div class=\\\"col-6\\\">\\n                <label for=\\\"country\\\">Country</label>\\n                <input type=\\\"text\\\" formControlName=\\\"country\\\" class=\\\"form-control\\\" id=\\\"country\\\"\\n                  aria-describedby=\\\"Country\\\" placeholder=\\\"Country\\\" />\\n                <div class=\\\"text-danger\\\" *ngIf=\\\"country.errors\\\">\\n                  <div *ngIf=\\\"country.errors['required']\\\">\\n                    Country is required\\n                  </div>\\n                </div>\\n              </div>\\n            </div>\\n            <div class=\\\"row\\\">\\n              <div class=\\\"col-12  form-group \\\">\\n                <ejs-uploader #defaultupload [autoUpload]='true' [allowedExtensions]=\\\"'image/*'\\\" name='fileupload'\\n                  [files]='preLoadFiles' [multiple]='false' [asyncSettings]='path'>\\n                </ejs-uploader>\\n\\n              </div>\\n            </div>\\n\\n          </ng-template>\\n        </e-tabitem>\\n        <e-tabitem [header]=\\\"headerText[1]\\\">\\n          <ng-template #content>\\n            <div formArrayName=\\\"catagoryLocales\\\">\\n              <div *ngFor=\\\"\\n                  let locale of catagoryLocales.controls;\\n                  let i = index;\\n                  let last = last\\n                \\\" [formGroup]=\\\"locale\\\">\\n                <div class=\\\"row\\\" style=\\\"position:relative;\\\">\\n                  <div class=\\\"col-12 col-sm-4 form-group\\\">\\n                    <label for=\\\"locale\\\">Language</label>\\n                    <select class=\\\"form-control\\\" #localeSelect formControlName=\\\"locale\\\" id=\\\"locale\\\">\\n                      <option *ngFor=\\\"let lang of languages; let i = index\\\" [value]=\\\"lang.ID\\\">{{ lang.name }}</option>\\n                    </select>\\n\\n                    <div class=\\\"text-danger\\\" *ngIf=\\\"locale.get('locale').errors\\\">\\n                      <div *ngIf=\\\"locale.get('locale').errors['required']\\\">\\n                        Hospital region is required\\n                      </div>\\n                    </div>\\n                  </div>\\n                  <div class=\\\"col-12 col-sm-7 form-group \\\">\\n                    <label for=\\\"catagory\\\">Article catagory name</label>\\n                    <input type=\\\"text\\\" formControlName=\\\"name\\\" class=\\\"form-control\\\" id=\\\"catagory\\\"\\n                      aria-describedby=\\\"Article catagory name\\\" placeholder=\\\"Article catagory name\\\" />\\n                    <div class=\\\"text-danger\\\" *ngIf=\\\"locale.get('name').errors\\\">\\n                      <div *ngIf=\\\"locale.get('name').errors['required']\\\">\\n                        Catagory Name is required\\n                      </div>\\n                    </div>\\n                  </div>\\n                  <div class=\\\"col-12 col-sm-1\\\">\\n                    <button type=\\\"button\\\" (click)=\\\"addLocale()\\\" *ngIf=\\\"last\\\"\\n                      [ngClass]=\\\"locale.invalid ? 'btn-warning' : 'btn-primary'\\\" [disabled]=\\\"locale.invalid\\\"\\n                      class=\\\"btn  btn-sm  btn-primary\\\">\\n                      <i class=\\\"fa fa-plus\\\"></i>\\n                    </button>\\n                    <button type=\\\"button\\\" class=\\\"btn btn-sm rounded  btn-danger\\\" (click)=\\\"deleteLocale(i)\\\">\\n                      <i class=\\\"fa fa-trash \\\"></i>\\n                    </button>\\n                  </div>\\n                </div>\\n              </div>\\n            </div>\\n            <div class=\\\"text-right\\\">\\n              <button type=\\\"button\\\" (click)=\\\"addLocale()\\\" class=\\\"btn  btn-success\\\" *ngIf=\\\"catagoryLocales.length == 0\\\">\\n                <i class=\\\"fa fa-plus \\\"></i>Add Language\\n              </button>\\n            </div>\\n          </ng-template>\\n        </e-tabitem>\\n      </e-tabitems>\\n    </ejs-tab>\\n    <button type=\\\"submit\\\" [disabled]=\\\"articleCatagoryForm.invalid\\\"\\n      [ngClass]=\\\"articleCatagoryForm.invalid ? 'btn-danger' : 'btn-success'\\\" class=\\\"btn\\\">\\n      Submit\\n    </button>\\n  </form>\\n</div>\\n\"","import { Component, OnInit, ViewEncapsulation, ViewChild } from '@angular/core';\nimport { ArticlesApiService } from '../articles-api.service';\nimport {\n  FormBuilder,\n  FormGroup,\n  Validators,\n  FormControl,\n  FormArray\n} from '@angular/forms';\nimport { ActivatedRoute } from '@angular/router';\nimport {\n  ArticleCatagory,\n  ArticleCatagoryLocaleModel\n} from '../articles-data.model';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { SystemApiService, Guid } from '../../../system-api.service';\nimport { EmitType, detach } from '@syncfusion/ej2-base';\nimport {\n  UploaderComponent,\n  FileInfo,\n  SelectedEventArgs\n} from '@syncfusion/ej2-angular-inputs';\n\n@Component({\n  selector: 'bionic-article-catagory-form',\n  templateUrl: './article-catagory-form.component.html',\n  styleUrls: ['./article-catagory-form.component.css'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class ArticleCatagoryFormComponent implements OnInit {\n  public headerText: Object = [\n    { text: 'Enlish Language (default)' },\n    { text: 'Other Languages' },\n    { text: 'File Attachments' }\n  ];\n\n  public preLoadFiles: Object[] = [\n    {\n      name: null,\n      size: null,\n      type: null\n    }\n  ];\n  public articleCatagoryForm: FormGroup;\n  public formId: string;\n  public articleCatagoryLocaleForm: FormGroup;\n  private catagoryId: number;\n  public isUpdate: Boolean;\n  public languages: any;\n  public deletedIds: number[] = [];\n  uploadInput: any;\n  public path: Object;\n\n  @ViewChild('defaultupload')\n  public defaultupload: UploaderComponent;\n\n  constructor(\n    private articleApi: ArticlesApiService,\n    private formBuilder: FormBuilder,\n    private activatedRoute: ActivatedRoute,\n    private systemApi: SystemApiService\n  ) {\n    this.createForm();\n  }\n\n  get catagoryName(): FormControl {\n    return this.articleCatagoryForm.get('name') as FormControl;\n  }\n  get catagoryLocales(): FormArray {\n    return this.articleCatagoryForm.get('catagoryLocales') as FormArray;\n  }\n\n  get country(): FormControl {\n    return this.articleCatagoryForm.get('country') as FormControl;\n  }\n  prepareFormData(): ArticleCatagory | null {\n    const articleCatagory = new ArticleCatagory();\n\n    if (this.articleCatagoryForm.valid) {\n      if (this.isUpdate && this.catagoryId) {\n        articleCatagory.article_catagory = {\n          ID: this.catagoryId,\n          name: this.catagoryName.value,\n          country: this.country.value\n        };\n      } else {\n        articleCatagory.article_catagory = {\n          name: this.catagoryName.value,\n          country: this.country.value\n        };\n      }\n\n      this.catagoryLocales.controls.forEach(element => {\n        articleCatagory.article_catagory_locale.push({\n          ID: element.value.id,\n          locale: element.value.locale,\n          name: element.value.name\n        });\n      });\n\n      this.deletedIds.forEach(element => {\n        articleCatagory.deleted_ids.article_catagory_locale.push(element);\n      });\n\n      return articleCatagory;\n    } else {\n      return null;\n    }\n  }\n\n  ngOnInit() {\n    this.catagoryId = +this.activatedRoute.snapshot.paramMap.get('catagoryId');\n\n    this.systemApi\n      .getLanguagesList()\n      .subscribe(data => (this.languages = data));\n    if (this.catagoryId) {\n      this.isUpdate = true;\n      this.articleApi\n        .getArticleCatagoryById(this.catagoryId)\n        .subscribe((data: ArticleCatagory) => this.initializeForm(data));\n    }\n  }\n\n  createForm(): void {\n    this.articleCatagoryForm = this.formBuilder.group({\n      id: [Guid.newGuid(), Validators.required],\n      name: ['', Validators.required],\n      country: ['', Validators.required],\n      catagoryLocales: this.formBuilder.array([this.generateLocaleForm()])\n    });\n  }\n\n  initializeForm(catagory: ArticleCatagory): void {\n    this.articleCatagoryForm = this.formBuilder.group({\n      name: [catagory.article_catagory.name, Validators.required],\n      country: [catagory.article_catagory.country, Validators.required],\n      catagoryLocales: this.formBuilder.array([])\n    });\n    catagory.article_catagory_locale.map(locale =>\n      this.catagoryLocales.push(this.initializeLocaleForm(locale))\n    );\n  }\n\n  initializeLocaleForm(locale: ArticleCatagoryLocaleModel): FormGroup {\n    return this.formBuilder.group({\n      id: [locale.ID, Validators.required],\n      name: [locale.name, Validators.required],\n      locale: [locale.locale, Validators.required]\n    });\n  }\n\n  generateLocaleForm(): FormGroup {\n    return this.formBuilder.group({\n      name: ['', Validators.required],\n      locale: ['', Validators.required]\n    });\n  }\n\n  deleteLocale(index: number): void {\n    const deletedControlId = this.catagoryLocales.controls[index].get('id');\n    if (deletedControlId) {\n      const conf = confirm('Are you sure you want to delete');\n\n      if (conf) {\n        this.deletedIds.push(deletedControlId.value);\n        this.catagoryLocales.removeAt(index);\n      }\n    } else {\n      this.catagoryLocales.removeAt(index);\n    }\n  }\n\n  addLocale(): void {\n    this.catagoryLocales.controls.push(\n      this.formBuilder.group({\n        locale: ['', Validators.required],\n        name: ['', Validators.required]\n      })\n    );\n  }\n\n  onFileSelect: EmitType<Object> = (args: any) => {\n    this.uploadInput = args.filesData[0].name;\n    console.log(args.filesData[0]);\n    console.log(this.articleCatagoryForm.get('image'));\n  };\n\n  onSubmit(): void {\n    this.defaultupload.upload(this.defaultupload.getFilesData());\n    const catagory = this.prepareFormData();\n\n    if (this.isUpdate) {\n      this.articleApi\n        .updateArticleCatagory(catagory)\n        .subscribe(\n          () => alert('Article updated '),\n          (error: HttpErrorResponse) => alert(error.message)\n        );\n    } else {\n      this.articleApi.createArticleCatagory(catagory).subscribe(\n        (data: any) => {\n          this.catagoryId = data;\n          this.isUpdate = true;\n        },\n        (error: HttpErrorResponse) => alert(error.message)\n      );\n    }\n  }\n}\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJhcHBzL2lsby1hZG1pbi9zcmMvYXBwL2ZlYXR1cmVzL2FydGljbGVzL2FydGljbGUtY2F0YWdvcnktdmlldy9hcnRpY2xlLWNhdGFnb3J5LXZpZXcuY29tcG9uZW50LmNzcyJ9 */\"","module.exports = \"<bionic-data-grid-view\\n  [data]=\\\"data\\\"\\n  [columnsList]=\\\"columnsList\\\"\\n  [showUpdate]=\\\"true\\\"\\n  [showDelete]=\\\"true\\\"\\n  [enableFilter]=\\\"true\\\"\\n  [enablePaging]=\\\"true\\\"\\n  [enableSearching]=\\\"true\\\"\\n  [enableSorting]=\\\"true\\\"\\n  [showColumnChooser]=\\\"true\\\"\\n  [idKey]=\\\"'ID'\\\"\\n  (deleteRecord)=\\\"deleteCatagory($event)\\\"\\n></bionic-data-grid-view>\\n\"","import { Component, OnInit, ViewEncapsulation } from '@angular/core';\nimport { ArticlesApiService } from '../articles-api.service';\nimport { ArticleCatagoryViewModel } from '../articles-data.model';\nimport { CustomGridColumns } from '@bionic/shared-component';\n\n@Component({\n  selector: 'bionic-article-catagory-view',\n  templateUrl: './article-catagory-view.component.html',\n  styleUrls: ['./article-catagory-view.component.css'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class ArticleCatagoryViewComponent implements OnInit {\n  public data: ArticleCatagoryViewModel[] = [];\n  public columnsList: CustomGridColumns[] = [\n    {\n      key: 'ID',\n      width: 30,\n      header: 'id',\n      type: 'string'\n    },\n    {\n      key: 'name',\n      header: 'Contact name',\n      type: 'string'\n    },\n    {\n      key: 'totalCount',\n      header: 'Conversations',\n      type: 'number',\n      width: 50\n    },\n\n    {\n      header: 'Added',\n      key: 'date_added',\n      type: 'date',\n      format: 'yMd',\n      visible: false,\n      width: 100\n    },\n    {\n      header: 'Updated',\n      key: 'date_updated',\n      type: 'date',\n      format: 'yMd',\n      visible: false,\n      width: 100\n    }\n  ];\n  constructor(private articleCatagoryApi: ArticlesApiService) {}\n\n  ngOnInit() {\n    this.articleCatagoryApi\n      .getArticleCatagories()\n      .subscribe((data: ArticleCatagoryViewModel[]) => (this.data = data));\n  }\n\n  deleteCatagory(data: any): void {\n    alert(data.ID);\n    this.articleCatagoryApi\n      .deleteArticleCatagory([data.ID])\n      .subscribe(() => alert('article deleted successfuly'));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport {\n  ArticleCatagoryViewModel,\n  ArticleCatagoryModel,\n  ArticleViewModel,\n  ArticleModel,\n  ArticleCatagory,\n  Article\n} from './articles-data.model';\nimport { Observable } from 'rxjs';\n\n@Injectable()\nexport class ArticlesApiService {\n  private httpBody: URLSearchParams;\n  constructor(private httpClient: HttpClient) {\n    this.httpBody = new URLSearchParams();\n  }\n\n  getArticleCatagories(): Observable<ArticleCatagoryViewModel[]> {\n    return this.httpClient.get<ArticleCatagoryViewModel[]>(`article_catagory`);\n  }\n\n  getArticleCatagoryById(id: number): Observable<ArticleCatagory> {\n    return this.httpClient.get<ArticleCatagory>(`article_catagory/${id}`);\n  }\n\n  createArticleCatagory(\n    articleCatagory: ArticleCatagory\n  ): Observable<ArticleCatagoryViewModel> {\n    return this.httpClient.post<ArticleCatagoryViewModel>(\n      `article_catagory`,\n      articleCatagory\n    );\n  }\n\n  updateArticleCatagory(\n    articleCatagory: ArticleCatagory\n  ): Observable<ArticleCatagoryViewModel> {\n    return this.httpClient.post<ArticleCatagoryViewModel>(\n      `article_catagory/update/${articleCatagory.article_catagory.ID}`,\n      articleCatagory\n    );\n  }\n\n  deleteArticleCatagory(\n    catagoryId: number[]\n  ): Observable<ArticleCatagoryViewModel> {\n    const idArr: any[] = [];\n    catagoryId.forEach(id => idArr.push({ ID: `${id}` }));\n    return this.httpClient.post<ArticleCatagoryViewModel>(\n      `article_catagory/delete`,\n      idArr\n    );\n  }\n\n  // article api maipulations\n  getArticle(): Observable<ArticleViewModel[]> {\n    return this.httpClient.get<ArticleViewModel[]>(`articles`);\n  }\n\n  getArticleById(id: number): Observable<Article> {\n    return this.httpClient.get<Article>(`articles/${id}`);\n  }\n\n  createArticle(article: Article): Observable<ArticleViewModel> {\n    return this.httpClient.post<ArticleViewModel>(`articles`, article);\n  }\n\n  updateArticle(article: Article): Observable<ArticleViewModel> {\n    return this.httpClient.post<ArticleViewModel>(\n      `articles/update/${article.article.ID}`,\n      article\n    );\n  }\n\n  deleteArticle(catagoryId: number[]): Observable<ArticleViewModel> {\n    const idArr: any[] = [];\n    catagoryId.forEach(id => idArr.push({ id: `${id}` }));\n    return this.httpClient.post<ArticleViewModel>(`articles/delete`, idArr);\n  }\n}\n","export interface ArticleModel {\n  ID?: number;\n  header: string;\n  content: string;\n  CATAGORY_ID?: number;\n}\n\nexport interface ArticleViewModel {\n  CATAGORY_ID?: number;\n  ID: number;\n  header: string;\n  content: string;\n}\n\nexport interface ArticleLocaleModel {\n  ID?: number;\n  header: string;\n  content: string;\n  locale: number;\n}\n\nexport class ArticleDeletables {\n  article_locale: number[] = [];\n}\nexport class Article {\n  image: string[] = [];\n  audios: any[] = [];\n  videos: any[] = [];\n  token: string;\n  article: ArticleModel;\n  article_locale: ArticleLocaleModel[] = [];\n  deleted_ids: ArticleDeletables = new ArticleDeletables();\n}\n\nexport interface ArticleCatagoryModel {\n  ID?: number;\n  name: string;\n  country: string;\n}\n\nexport interface ArticleCatagoryLocaleModel {\n  ID?: number;\n  name: string;\n  locale: number;\n}\n\nexport interface ArticleCatagoryViewModel {\n  id: number;\n  name: string;\n  country: string;\n  locale: string;\n  date_added: Date;\n  date_updated: Date;\n}\n\nexport class ArticleCatagoryDeletables {\n  article_catagory_locale: number[] = [];\n}\n\nexport class ArticleCatagory {\n  article_catagory: ArticleCatagoryModel;\n  article_catagory_locale: ArticleCatagoryLocaleModel[] = [];\n  deleted_ids: ArticleCatagoryDeletables = new ArticleCatagoryDeletables();\n}\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJhcHBzL2lsby1hZG1pbi9zcmMvYXBwL2ZlYXR1cmVzL2FydGljbGVzL2FydGljbGVzLWZvcm0vYXJ0aWNsZXMtZm9ybS5jb21wb25lbnQuY3NzIn0= */\"","module.exports = \"<div class=\\\"container card shadow-lg pl-5 pr-5 md-3\\\">\\n  <form [formGroup]=\\\"articleForm\\\" (ngSubmit)=\\\"onSubmit()\\\" novalidate>\\n    <ejs-tab id=\\\"element\\\">\\n      <e-tabitems>\\n        <e-tabitem [header]=\\\"headerText[0]\\\">\\n          <ng-template #content>\\n            <div class=\\\"row\\\">\\n              <div class=\\\"col-12 col-sm-6 form-group \\\">\\n                <label for=\\\"emergencyContactName\\\">Article Catagory</label>\\n                <select id=\\\"ddlelement\\\" formControlName=\\\"catagory\\\" class=\\\"form-control\\\"\\n                  placeholder=\\\"Select article catagory\\\">\\n                  <option *ngFor=\\\"\\n                      let cat of articleCatagories;\\n                      let i = index;\\n                      let last = last\\n                    \\\" [value]=\\\"cat.CATAGORY_ID\\\">\\n                    {{ cat.name }}</option>\\n                </select>\\n                <div class=\\\"text-danger\\\" *ngIf=\\\"catagory.errors\\\">\\n                  <div *ngIf=\\\"catagory.errors['required']\\\">\\n                    Article catagory is required\\n                  </div>\\n                </div>\\n              </div>\\n              <div class=\\\"col-12 col-sm-6 form-group\\\">\\n                <label for=\\\"title\\\">Article header</label>\\n                <input type=\\\"text\\\" class=\\\"form-control\\\" formControlName=\\\"title\\\" id=\\\"title\\\"\\n                  placeholder=\\\"Article header\\\" />\\n                <small id=\\\"address\\\" class=\\\"form-text text-muted\\\">Header used as article title</small>\\n                <div class=\\\"text-danger\\\" *ngIf=\\\"articleTitle.errors\\\">\\n                  <div *ngIf=\\\"articleTitle.errors['required']\\\">\\n                    Phone number is required\\n                  </div>\\n                </div>\\n              </div>\\n            </div>\\n            <div class=\\\"row\\\">\\n              <div class=\\\"col-12 form-group\\\">\\n                <label for=\\\"articleContent\\\">Article content</label>\\n                <textarea formControlName=\\\"content\\\" rows=\\\"10\\\" class=\\\"form-control\\\"></textarea>\\n              </div>\\n            </div>\\n            <div class=\\\"row\\\">\\n              <div class=\\\"col-12  form-group \\\">\\n                <ejs-uploader #defaultupload [autoUpload]='false'   (actionComplete)='actionComplete($event)' [allowedExtensions]=\\\"'image/* video/*'\\\" name='fileupload'\\n                  [files]='preLoadFiles' [multiple]='true' [asyncSettings]='path'>\\n                </ejs-uploader>\\n\\n              </div>\\n            </div>\\n          </ng-template>\\n        </e-tabitem>\\n        <e-tabitem [header]=\\\"headerText[1]\\\">\\n          <ng-template #content>\\n            <div formArrayName=\\\"articleLocales\\\">\\n              <div *ngFor=\\\"\\n                  let locale of articleLocales.controls;\\n                  let i = index;\\n                  let last = last\\n                \\\" [formGroup]=\\\"locale\\\">\\n                <div class=\\\"row\\\" style=\\\"position:relative;\\\">\\n                  <div class=\\\"col-12 col-sm-4 form-group\\\">\\n                    <label for=\\\"locale\\\">Language</label>\\n                    <select class=\\\"form-control\\\" formControlName=\\\"locale\\\" id=\\\"locale\\\">\\n                      <option *ngFor=\\\"let lang of languages; let i = index\\\" [value]=\\\"lang.ID\\\">{{ lang.name }}</option>\\n                    </select>\\n\\n                    <div class=\\\"text-danger\\\" *ngIf=\\\"locale.get('locale').errors\\\">\\n                      <div *ngIf=\\\"locale.get('locale').errors['required']\\\">\\n                        Hospital region is required\\n                      </div>\\n                    </div>\\n                  </div>\\n                  <div class=\\\"col-12 col-sm-7 form-group \\\">\\n                    <label for=\\\"title\\\">Article header</label>\\n                    <input type=\\\"text\\\" formControlName=\\\"title\\\" class=\\\"form-control\\\" id=\\\"hospital\\\"\\n                      aria-describedby=\\\"Article header\\\" placeholder=\\\"Article header\\\" />\\n                    <div class=\\\"text-danger\\\" *ngIf=\\\"locale.get('title').errors\\\">\\n                      <div *ngIf=\\\"locale.get('title').errors['required']\\\">\\n                        Article header is required\\n                      </div>\\n                    </div>\\n                  </div>\\n                  <div class=\\\"col-12 col-sm-1\\\">\\n                    <button type=\\\"button\\\" class=\\\"btn btn-sm btn-primary\\\" *ngIf=\\\"last\\\"\\n                      [ngClass]=\\\"locale.invalid ? 'btn-warning' : 'btn-primary'\\\" [disabled]=\\\"locale.invalid\\\"\\n                      (click)=\\\"addLocale()\\\">\\n                      <i class=\\\"fa fa-plus\\\"></i>\\n                    </button>\\n                    <button type=\\\"button\\\" class=\\\"btn btn-sm rounded  btn-danger\\\" (click)=\\\"deleteLocale(i)\\\">\\n                      <i class=\\\"fa fa-trash\\\"></i>\\n                    </button>\\n                  </div>\\n                </div>\\n                <div class=\\\"row\\\">\\n                  <div class=\\\"col-12 col-sm-12 form-group\\\">\\n                    <label for=\\\"articleContent\\\">Article content</label>\\n                    <textarea formControlName=\\\"content\\\" rows=\\\"10\\\" class=\\\"form-control\\\"></textarea>\\n                    <small id=\\\"address\\\" class=\\\"form-text text-muted\\\">Address of the Emergency contact.</small>\\n                    <div class=\\\"text-danger\\\" *ngIf=\\\"locale.get('content').errors\\\">\\n                      <div *ngIf=\\\"locale.get('content').errors['required']\\\"></div>\\n                    </div>\\n                  </div>\\n                </div>\\n              </div>\\n            </div>\\n            <div class=\\\"text-right\\\">\\n              <button type=\\\"button\\\" (click)=\\\"addLocale()\\\" class=\\\"btn  btn-success\\\" *ngIf=\\\"articleLocales.length == 0\\\">\\n                <i class=\\\"fa fa-plus \\\"></i>Add Language\\n              </button>\\n            </div>\\n          </ng-template>\\n        </e-tabitem>\\n      </e-tabitems>\\n    </ejs-tab>\\n    <button type=\\\"submit\\\" [disabled]=\\\"articleForm.invalid\\\"\\n      [ngClass]=\\\"articleForm.invalid ? 'btn-danger' : 'btn-success'\\\" class=\\\"btn\\\">\\n      Submit\\n    </button>\\n  </form>\\n</div>\\n\"","import { Component, OnInit, ViewEncapsulation, ViewChild } from '@angular/core';\nimport { ArticlesApiService } from '../articles-api.service';\nimport {\n  FormBuilder,\n  FormGroup,\n  Validators,\n  FormControl,\n  FormArray\n} from '@angular/forms';\nimport { ActivatedRoute } from '@angular/router';\nimport {\n  ArticleCatagoryViewModel,\n  Article,\n  ArticleLocaleModel\n} from '../articles-data.model';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { SystemApiService, Guid } from '../../../system-api.service';\nimport { UploaderComponent } from '@syncfusion/ej2-angular-inputs';\nimport { ConditionalExpr, IfStmt } from '@angular/compiler';\nimport { forEach } from '@angular/router/src/utils/collection';\n\n@Component({\n  selector: 'bionic-articles-form',\n  templateUrl: './articles-form.component.html',\n  styleUrls: ['./articles-form.component.css'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class ArticlesFormComponent implements OnInit {\n  public headerText: Object = [\n    { text: 'Enlish Language (default)' },\n    { text: 'Other Languages' },\n    { text: 'File Attachments' }\n  ];\n\n  @ViewChild('defaultupload')\n  public defaultUpload: UploaderComponent;\n\n  public preLoadFiles: Object[] = [\n    {\n      name: null,\n      size: null,\n      type: null\n    }\n  ];\n  private articleId: number;\n  public isUpdate: Boolean;\n  public articleForm: FormGroup;\n  public articleCatagories: any[] = [];\n  public languages: any;\n  public deletedIds: number[] = [];\n  path: { saveUrl: string; removeUrl: string };\n  formId: any;\n\n  constructor(\n    private articleApi: ArticlesApiService,\n    private formBuilder: FormBuilder,\n    private activatedRoute: ActivatedRoute,\n    private systemConf: SystemApiService\n  ) {\n    this.createForm();\n    this.formId = Guid.newGuid();\n    this.path = {\n      saveUrl: `http://localhost/ilo_app/backend/index.php/upload/media/english/${\n        this.formId\n      }`,\n      removeUrl:\n        'http://localhost/ilo_app/backend/index.php/upload/media_delete/article'\n    };\n  }\n\n  ngOnInit() {\n    this.articleId = +this.activatedRoute.snapshot.paramMap.get('articleId');\n    this.articleApi\n      .getArticleCatagories()\n      .subscribe(\n        (data: ArticleCatagoryViewModel[]) => (this.articleCatagories = data)\n      );\n    if (this.articleId) {\n      this.isUpdate = true;\n      this.articleApi\n        .getArticleById(this.articleId)\n        .subscribe((data: Article) => this.initializeForm(data));\n    }\n\n    this.systemConf\n      .getLanguagesList()\n      .subscribe(data => (this.languages = data));\n  }\n\n  createForm(): void {\n    this.articleForm = this.formBuilder.group({\n      catagory: ['', Validators.required],\n      title: ['', Validators.required],\n      content: ['', Validators.required],\n      articleLocales: this.formBuilder.array([])\n    });\n  }\n\n  generateLocaleForm(): FormGroup {\n    return this.formBuilder.group({\n      content: ['', Validators.required],\n      locale: ['', Validators.required],\n      title: ['', Validators.required]\n    });\n  }\n  initiLocaleForm(locale: ArticleLocaleModel): FormGroup {\n    return this.formBuilder.group({\n      id: [locale.ID, Validators.required],\n      content: [locale.content, Validators.required],\n      locale: [locale.locale, Validators.required],\n      title: [locale.header, Validators.required]\n    });\n  }\n\n  actionComplete(event: any) {\n    this.submitForm();\n  }\n  initializeForm(article: Article): void {\n    this.articleForm = this.formBuilder.group({\n      id: [article.article.ID, Validators.required],\n      catagory: [article.article.CATAGORY_ID, Validators.required],\n      title: [article.article.header, Validators.required],\n      content: [article.article.content, Validators.required],\n      articleLocales: this.formBuilder.array([])\n    });\n\n    article.article_locale.forEach(element => {\n      this.articleLocales.controls.push(this.initiLocaleForm(element));\n    });\n\n    this.defaultUpload.clearAll();\n    this.preLoadFiles = [];\n    if (article.image.length) {\n      article.image.forEach(element => {\n        this.preLoadFiles.push(element);\n      });\n    }\n\n    if (article.audios.length) {\n      article.audios.forEach(element => {\n        this.preLoadFiles.push(element);\n      });\n    }\n\n    if (article.videos.length) {\n      article.videos.forEach(element => {\n        this.preLoadFiles.push(element);\n      });\n    }\n  }\n\n  get articleTitle(): FormControl {\n    return this.articleForm.get('title') as FormControl;\n  }\n\n  get content(): FormControl {\n    return this.articleForm.get('content') as FormControl;\n  }\n  get catagory(): FormControl {\n    return this.articleForm.get('catagory') as FormControl;\n  }\n\n  get articleLocales(): FormArray {\n    return this.articleForm.get('articleLocales') as FormArray;\n  }\n\n  onSubmit(): void {\n    this.defaultUpload.upload(this.defaultUpload.getFilesData());\n  }\n\n  submitForm(): void {\n    const formData = this.prepareFormData();\n\n    if (formData) {\n      if (!this.isUpdate) {\n        this.articleApi.createArticle(formData).subscribe(\n          (data: any) => {\n            this.articleApi = data;\n            this.isUpdate = true;\n            alert('Article created successfully');\n          },\n          (error: HttpErrorResponse) => alert(error.message)\n        );\n      } else {\n        this.articleApi\n          .updateArticle(formData)\n          .subscribe(\n            () => alert('article updated successfully'),\n            (error: HttpErrorResponse) => alert(error.message)\n          );\n      }\n    }\n  }\n  prepareFormData(): Article | null {\n    const article = new Article();\n\n    if (this.articleForm.valid) {\n      if (this.isUpdate && this.articleId) {\n        article.article = {\n          content: this.content.value,\n          CATAGORY_ID: this.catagory.value,\n          header: this.articleTitle.value,\n          ID: this.articleId\n        };\n      } else {\n        article.article = {\n          header: this.articleTitle.value,\n          content: this.content.value,\n          CATAGORY_ID: this.catagory.value\n        };\n      }\n\n      this.articleLocales.controls.forEach(element =>\n        article.article_locale.push({\n          ID: element.value.id,\n          content: element.value.content,\n          header: element.value.title,\n          locale: element.value.locale\n        })\n      );\n      this.deletedIds.forEach(element => {\n        article.deleted_ids.article_locale.push(element);\n      });\n\n      article.token = this.formId;\n      return article;\n    } else {\n      return null;\n    }\n  }\n\n  addLocale(): void {\n    this.articleLocales.controls.push(this.generateLocaleForm());\n  }\n\n  deleteLocale(index: number): void {\n    const deletedControlId = this.articleLocales.controls[index].get('id');\n\n    if (deletedControlId) {\n      const conf = confirm('Are you sure you want to delete');\n\n      if (conf) {\n        this.deletedIds.push(deletedControlId.value);\n        this.articleLocales.removeAt(index);\n      }\n    } else {\n      this.articleLocales.removeAt(index);\n    }\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { ArticleCatagoryFormComponent } from './article-catagory-form/article-catagory-form.component';\nimport { ArticlesFormComponent } from './articles-form/articles-form.component';\nimport { ArticlesViewComponent } from './articles-view/articles-view.component';\nimport { ArticleCatagoryViewComponent } from './article-catagory-view/article-catagory-view.component';\n\nconst routes: Routes = [\n  { path: '', component: ArticlesViewComponent },\n  { path: 'new', component: ArticlesFormComponent },\n  { path: ':articleId/update', component: ArticlesFormComponent },\n  { path: 'catagory', component: ArticleCatagoryViewComponent },\n  { path: 'catagory/new', component: ArticleCatagoryFormComponent },\n  {\n    path: 'catagory/:catagoryId/update',\n    component: ArticleCatagoryFormComponent\n  },\n  { path: ':articleId/update', component: ArticleCatagoryFormComponent }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class ArticlesRoutingModule {}\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJhcHBzL2lsby1hZG1pbi9zcmMvYXBwL2ZlYXR1cmVzL2FydGljbGVzL2FydGljbGVzLXZpZXcvYXJ0aWNsZXMtdmlldy5jb21wb25lbnQuY3NzIn0= */\"","module.exports = \"<bionic-data-grid-view\\n  [columnsList]=\\\"columnsList\\\"\\n  [data]=\\\"data\\\"\\n  [showDelete]=\\\"true\\\"\\n  [showUpdate]=\\\"true\\\"\\n  [enableFilter]=\\\"true\\\"\\n  [enablePaging]=\\\"true\\\"\\n  [enableSearching]=\\\"true\\\"\\n  [enableSorting]=\\\"true\\\"\\n  [idKey]=\\\"'ID'\\\"\\n  [showColumnChooser]=\\\"true\\\"\\n  (deleteRecord)='deleteArticle($event)'\\n\\n></bionic-data-grid-view>\\n\"","import { Component, OnInit, ViewEncapsulation } from '@angular/core';\nimport { ArticlesApiService } from '../articles-api.service';\nimport { ArticleViewModel } from '../articles-data.model';\nimport { CustomGridColumns } from '@bionic/shared-component';\nimport { HttpErrorResponse } from '@angular/common/http';\n\n@Component({\n  selector: 'bionic-articles-view',\n  templateUrl: './articles-view.component.html',\n  styleUrls: ['./articles-view.component.css'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class ArticlesViewComponent implements OnInit {\n  public data: ArticleViewModel[] = [];\n  public columnsList: CustomGridColumns[] = [\n    {\n      key: 'ID',\n      width: 50,\n      header: 'Id',\n      type: 'string'\n    },\n    {\n      key: 'header',\n      header: 'header',\n      type: 'string'\n    },\n    {\n      header: 'Catagory Id',\n      key: 'CATAGORY_ID',\n      type: 'number',\n      visible: false,\n      width: 100\n    },\n    {\n      header: 'Added',\n      key: 'date_added',\n      type: 'date',\n      format: 'yMd',\n      visible: false,\n      width: 100\n    },\n    {\n      header: 'Updated',\n      key: 'date_updated',\n      type: 'date',\n      format: 'yMd',\n      visible: false,\n      width: 100\n    }\n  ];\n  constructor(private articleApi: ArticlesApiService) {}\n\n  ngOnInit() {\n    this.articleApi.getArticle().subscribe(data => (this.data = data));\n  }\n\n  deleteArticle(article: ArticleViewModel): void {\n    const confirmation = confirm(\n      'Are you sure you want to delete this article'\n    );\n\n    if (confirmation === true) {\n      this.articleApi\n        .deleteArticle([article.ID])\n        .subscribe(\n          () => alert('article deleted successfuly'),\n          (error: HttpErrorResponse) =>\n            alert('Failed while attempting to delete article, try again later')\n        );\n    }\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { ArticlesRoutingModule } from './articles-routing.module';\nimport { ArticleCatagoryViewComponent } from './article-catagory-view/article-catagory-view.component';\nimport { ArticleCatagoryFormComponent } from './article-catagory-form/article-catagory-form.component';\nimport { SharedComponentModule } from '@bionic/shared-component';\nimport { ArticlesFormComponent } from './articles-form/articles-form.component';\nimport { ArticlesViewComponent } from './articles-view/articles-view.component';\nimport { ArticlesApiService } from './articles-api.service';\nimport { TabModule } from '@syncfusion/ej2-angular-navigations';\nimport { DropDownListModule } from '@syncfusion/ej2-ng-dropdowns';\nimport { DocumentEditorContainerModule } from '@syncfusion/ej2-angular-documenteditor';\nimport { ToolbarService } from '@syncfusion/ej2-angular-documenteditor';\nimport { UploaderModule } from '@syncfusion/ej2-angular-inputs';\n\n@NgModule({\n  declarations: [\n    ArticleCatagoryViewComponent,\n    ArticleCatagoryFormComponent,\n    ArticlesFormComponent,\n    ArticlesViewComponent\n  ],\n  imports: [\n    UploaderModule,\n    CommonModule,\n    DropDownListModule,\n    ArticlesRoutingModule,\n    DocumentEditorContainerModule,\n    SharedComponentModule,\n    TabModule\n  ],\n  providers: [ArticlesApiService, ToolbarService]\n})\nexport class ArticlesModule {}\n"],"sourceRoot":""}